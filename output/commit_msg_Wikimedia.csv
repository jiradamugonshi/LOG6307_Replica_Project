9d6cf17-+-Removing commented stuff

e76ca2c-+-Removing unused stuff from base.pp

c3fcc69-+-Updates for hadoop and zookeeper

c92aff8-+-Commenting out kraken::config usage.  Not using this. (Yet?)

eb2e010-+-Only including Hadoop in vagrant VM by default right now.

ce8833a-+-Adding kraken configs.

2cd79f9-+-Adding java module. Including java in base.pp.

ff05fd7-+-Using apt module to install wikimedia apt repo settings

6c3a578-+-Adding apt module

4590a29-+-First commit of Kraken Vagrant VM.
e57484d614-+-airflow: allow traffic to webserver port from dse-k8s pods

f8e81de19b-+-sql/xml dumps: add role for helper worker for wikidata full history dumps

d3932e175b-+-Send output of daily account check to SRE IF alias only

9a8e81f6e4-+-decom mw135[2-7]|mw136[0-37-9]|mw137[14-90]|mw138[0-9]|mw139[0-79]|mw140[589]

aae90d8312-+-Tweak the logging settings for radosgw on cephosd servers

e250774b63-+-varnish: Conditionally monitor vcl reloads

be025fb0d9-+-Correct error in the rsyslog config for radosgw on cephosd servers

b511c1e267-+-Configure logging correctly for the radosgw service on cephosd servers

7945e7999f-+-Add support for centrally managing /var/lib/ganeti/known_hosts

8924b47f49-+-Add insetup config for new aux k8s ctrl/worker VMs

58ef801c94-+-parsoidtest: Remove duplicate role assignment

c417d9a4ad-+-Revert "profile::firewall: separate ipv4 and ipv6 in nftables BL..."

ec10bf790a-+-site: remove vrts1001 & vrts2001

77cb1cee23-+-opensearch: bump curator version to wmf5

29b374d094-+-Revert "docker_registry_ha: reduce maxentries' default to 25"

d4ed5cc8e4-+-profile::firewall: separate ipv4 and ipv6 in nftables BLOCKED_NETS

f75b57e669-+-docker_registry: Fix one more occurance of a nginx-common dep

9f7988d11c-+-docker_registry: Fix package dependency

e99d0c0ff4-+-docker_registry: Drop support for pre Bookworm

cd3550063f-+-Add parsoidtest1001 preseed and site.pp

a4a8952ac0-+-P:idp: On test host behind the load balancer, avoid exposing port 8080.

2690d25448-+-Don't pass ferm_status_restart in firewall class

12e5d07930-+-ferm: Make reload via ferm-status the default

78f7852a69-+-Revert "Temporarily disable stunnel for the Puppet 7 migration of deployment hosts"

66eeb56f54-+-Add role for wikikube-worker1240-1304

97148c7684-+-mail::smarthost: Avoid Ferm-specific syntax

8ace0b0a34-+-scap_proxy: Avoid Ferm-specific syntax

0aa8bcec9a-+-icinga: replace url checks with pingthing

518a63259d-+-vopsbot: remove systemd::service alert, replaced by alertmanager

c1ff6aa51e-+-blackbox_exporter: allow disabling gnmi and disable in cloud

060e9e993b-+-gNMI prometheus check: add specific network CA cert

ba70231f35-+-puppetdb: Move JVM config out of the puppetmaster module

515ced386d-+-docker_registry_ha: reduce maxentries' default to 25

b840afea9b-+-docker_registry_ha: configure the max entries returned for catalog reqs

0924b9f5cb-+-deployment servers: Avoid Ferm-specific syntax

89b939712d-+-Remove labswiki from HDFS imported dumps

7897b3220e-+-puppetboard: use stdlib version of to_python

81c5679724-+-P:toolforge: docker: registry: Add option to redirect domain root

ca318b65e6-+-prometheus::node_exporter: Don't exclude /var/lib/(docker|kubelet)

1be5af6a4b-+-envoy: Add support for passing an array of sets to the firewall service

241a802d2c-+-C:idm Add configuration for account blocking.

94ba072463-+-Add monitoring to network devices gRPC endpoints

ee5813f710-+-kubernetes: rename mw2427 -> wikikube-worker2127

36b5b12d7e-+-kubernetes: rename mw2426 -> wikikube-worker2126

ff198432ca-+-Make cloudcephosd1039-1041 into ceph osd nodes

2516443ca9-+-mediawiki: remove check_mw_versions

59124753f3-+-thanos-query: enable tracing

7931d652b0-+-mariadb: Disable pc1013 notifications

87936474f9-+-opentelemetry::collector: add package dependency for config file

9058c4b131-+-titan: add opentelemetry collector

19b0d1cfa5-+-mariadb: Move pc1015 configuration to master of pc3 section

d8294cd4d7-+-dnsrecursor: add optional setting of extended-resolution-errors

090907a2a5-+-hdfs: add new an-workers to insetup role

7bc126c7f5-+-Enable and scrape gNMIc api Prometheus endpoint

b32c2b919a-+-No longer include config-master on Puppet 5 frontends

a58a209c55-+-bacula::storage: Avoid Ferm-specific syntax

2c31571702-+-kubernetes: rename mw2425 -> wikikube-worker2125

5567bc4b79-+-Fix site.pp after adding new Ganeti hosts

ab73c66315-+-On Bookworm create the system user using systemd::sysuser

a8ef498d2c-+-Also move the apt::pin under the buster conditional

e7c9dc0842-+-Add ganeti1039 - ganeti1052 to site.pp

ec19940926-+-role::poolcounter::server: cleanup after Bookworm migration

c0c9f1c873-+-Enable the rclone backup schedule on db1208

a162ed6d51-+-kafka::broker: Add the external-services DNS name to the certs

bc96ba942e-+-Remove puppetmaster1001/puppetmaster2001 from tcpircbot config

ca18f2cabe-+-kubernetes: rename mw2424 -> wikikube-worker2124

12f4072697-+-profile::puppetserver: fix SHA1 path for labsprivate

6f363ff4e1-+-icinga: Enable profile::auto_restarts::service for keyholder-proxy

21dd43efa1-+-Remove puppet checkout on pybaltest

693f9b70a0-+-C:idm:deployment: Add structlog dependency.

b54ab653af-+-tftpboot: squash puppetserver log warning.

1c828e517e-+-gerrit: add acme_chief to gerrit-setup role

fef47174f5-+-pyrra: liftwing-articlequery-latency invert response_code label

afc71c5d83-+-grafana: remove obsolete check

7898f134db-+-librenms: remove obsolete checks

3532b57c84-+-idp::build: Remove duplicate repository config

7102362058-+-ferm: Use ferm-status to start ferm on diffs

7a2e9f6718-+-gerrit::proxy: ensure /var/www/ exists before files under it

a68a71d2c9-+-vrts: add required module for 6.5.10

489baa41dc-+-gerrit::proxy: fix link target for gerrit logo

1b9668dc61-+-vrts: change primary host

4ab8dbe1a9-+-alert: Ensure Prometheus Alertmanager starts at boot

0ee371d2fb-+-mariadb: remove db2129

bb8bc93156-+-purged: revert use_pki flag

96f3fd33b6-+-kerberos: remove absented checks

16935f497a-+-profile::puppetserver: correctly populate the MASTERS env variable

36ba182b88-+-Configure a bacula fileset and job for db1208

d6e1d54e41-+-ganeti: remove absented checks

aba1b28286-+-profile::firewall: Absent confd config when it is disabled

acf3e3c694-+-samplicator: remove absented check

a911ca4949-+-Render the rclone config file for db1208 postgres backups

c37aefa938-+-ferm: Allow to specify a different ferm-status command to use

7991c865f4-+-Add cloudsw to gNMIc targets

3c3254bacc-+-Remove check_procs alerts for statsd and statsv

a4f995f3ba-+-wikikube: Remove remaining hiera files and role for non stacked masters

e41fe42435-+-Decom kafka-main2005

5422de4466-+-Move the misc_crons dumper role from snapshot1017 to snapshot1016

49c650d876-+-Remove obsolete entries in site.pp

d533b31f50-+-Add rclone to db1208 for testing s3 -> local backups

0f0b1473ce-+-tftpboot: purge old files

1c86c5705f-+-profile::idp::build: Readd rsync service

966a4f60d2-+-netbox: notify dcops for uncommitted DNS changes

eb61069d45-+-prometheus::cloud: increase ceph scrape timeout

2f6e0eac86-+-corto: force directory removal

7b41b587d0-+-peopleweb: raise home dir size limit, make recipient configurable

4f4c75d518-+-wdqs categories: remove redundant ping check

21c9404dd7-+-mcrouter: remove puppet alert

22313b1e8d-+-mydumper: rename metaparam

eefc07a895-+-profile::docker_registry_ha::registry: add sslcert::dhparam

45a7f8c04a-+-statistics hosts: enable CPUWeight (cgroupsv2)

aa840ee679-+-docker_registy_ha: use python3-swiftclient on Bookworm

0b9fab1692-+-k8s::kubelet: fix deprecation warning

ce78f17280-+-Set puppet config for registry2005

3364b2d448-+-Add an explicit Hiera variable to determine the active swift ring server

a190f62038-+-Enable profile::auto_restarts::service for prometheus::pushgateway

e7c4ade263-+-mariadb: remove db2138

7d9898c3b3-+-kafka::broker: Populate cert SAN with hostname and IPs

6a8f4ba54e-+-mariadb: remove db2137

1b9f7924c8-+-mariadb: remove db2127

6f2a3f20b3-+-Don't restart(stop,start) ferm on puppet notify, use reload instead

6788c5a193-+-mariadb: remove db2125

f380c37a37-+-mariadb: remove db2124

ca7dc22cea-+-mariadb: remove db2122

4c12d5cb03-+-mariadb: remove db2121

6c0af9de1a-+-gerrit: add gerrit::proxy profile to insetup::gerrit role

7f059fb0db-+-puppet8: enable strict mode

d4129d51ad-+-envoyproxy: add route-level idle timeout for tlsproxy

3937aeff23-+-R:wmcs::db::wikireplicas remove access from cloudcumin

f2cff07d6c-+-puppetmaster::frontend|backend: Read the puppet-merge server from Hiera

95fe3f7f51-+-haproxy: re-add numa support

c9b02244bd-+-Install airflow-dags 2.9.3-py3.10-20240916 by default on all instances

5ad808071b-+-puppetserver: Pass the value of puppet_merge_server

90a50b8505-+-zuul: set statsd-exporter to relay to local statsite instance

2073435880-+-gitlab: Sync people/wmde GitLab group w/ wmde LDAP group

ea25e9e040-+-gitlab-settings: v1.7.0 for bugfix

a70188c671-+-puppet8: ensure java keystore type is binary

44067aea44-+-puppet8: ensure java ssh key type is binary

f648058010-+-puppet8: ensure dns cookie type is binary

cd09055dce-+-puppet8: ensure kerberos keytab type is binary

60ad21ef8f-+-puppet8: ensure gpg keyring type is binary

92e6c93b4c-+-wdqs: do not add categories on main and scholarly endpoints

862d817b07-+-wdqs: common module and profile should not define categories_endpoint

a61902de87-+-wdqs: fix CATEGORY_ENDPOINT env var

61b0ed1041-+-puppet8: ensure kerberos keytab type is binary

d50450521e-+-kubernetes: re-name / IP mw231[345]

9fe447a782-+-cache:haproxykafka: first stub classes to allow prometheus scraping

15ccfeffd5-+-P:ntp and nagios_core: add new command ntp_check_peer_and_stratum

8ef932c55f-+-puppet8: add explicit typecast

6e43f3b949-+-puppet8: account for unknown probe types

78b6c88e3e-+-Add wikikube-worker2117-2120 to site.pp

03f1e562c5-+-kubernetes20[59-60], mw230[1-5] -> wikikube-worker21[14-20]

1e604a6532-+-Add configuration for poolcounter100[6,7]

15cc84855c-+-kafka-main: Replace kafka-main2005 with kafka-main2010

521c7ac471-+-ci: define statsd prometheus exporter mappings for zuul

56b9427929-+-vrts: swap replica to new host

e71d6329a8-+-Add configuration for poolcounter2006

5151ab4516-+-Rename mw239[0456789] to wikikube-worker21[07-13]

9736c733fb-+-openstack: keystone: eqiad1: fix instances_ip_ranges parameter

79e645e9ff-+-keystone: hooks: create security group rule for additional instance CIDRs

fe55ffddd9-+-lists: Enable profile::auto_restarts::service for spamassassin

4804575df5-+-Decom kafka-main2004

5b60b2ef96-+-jaeger: fix typo ensure vs require

837c392b19-+-logging: add script to query for orphan traces

68ba2037cf-+-Puppet frontends: Remove obsolete manage_puppet_ca_file code

a81a6cbb31-+-kafka-main: Replace kafka-main2004 with kafka-main2009

70e9c53b20-+-Decom kafka-main2003

941bb7444b-+-mariadb: productionize db2229

27c48c4839-+-gerrit: add backup::host, gerrit::migration etc to insetup role

ac56434156-+-puppet8: ensure cassandra passwords are defined

f6e7afd175-+-P:ntp: bump retry_interval to 5 mins for NTP monitoring check

903c610b91-+-Bird::anycast - allow BFD connections from router link-local IP

906f55934c-+-P:ntp: bump monitoring check_interval to 5 mins

1502b72537-+-P:ntp: drop backward compatibility for ntp (only use ntpsec)

90d26c590c-+-lists: Set number of processes for mailman3_runner to minimum of 14

918e86fae4-+-mariadb: productionize db2238

8b5ab3bb84-+-kafka-main: Fix regex for kafka-main in codfw

b2b0c2f832-+-kafka-main: Replace kafka-main2003 with kafka-main2008

3cf854ab1a-+-Trust DSCP markings from VMs on routed ganeti hypervisors

7f107efbae-+-cache:haproxy: fixed the haproxykafka uds path

6bd1f4fdb8-+-cache:haproxy: introduce extended logging on socket for haproxykafka

308188114b-+-config_master: Explicitly configure the server for Puppet merges

2d27367f04-+-cloudceph: add coludcephmon1006 to the pool

c9223872a3-+-global_config: add the s3-eqiad-dpe external service

ba652c160f-+-httpbb: Move wikifunctions to its own test suite

8987017f98-+-Puppet agent: Remove obsolete manage_puppet_ca_file code

0cf3dd586a-+-logstash: put logging-sd100[1-4] in service

d74976fd76-+-realm.pp: drop $other_site global

3cb0be6305-+-P:tlsproxy::instance: Drop numa_networking global

68278f7164-+-profile::tlsproxy::envoy: add require for envoyproxy

7d3c4dad92-+-puppet8: drop explicity metaparams

dba4e70dcd-+-refine - bump to refinery version 0.2.49

6b0d8dc6b8-+-profile::puppetserver::configmaster: use gitpuppet for config-master

c31c51a552-+-Decom kafka-main2002

b2a7981bfd-+-puppet8: account for unknown probe types

debefa5921-+-mariadb: productionize db2237

2da16423db-+-puppet8: remove ssl_keystore_location, always set ssl_key_password

42a64d036a-+-role::puppetserver: add TLS+HTTP stack to publish SHA1 values

e7d9c9ff5b-+-mariadb: pc1017 pc2017 back to normal

1faad00785-+-mediawiki::maintenance: Remove php72 remnant

c43c0565f2-+-graphite: remove mw graphite-based alerts

7bf4b30b75-+-Revert addition of the IPv6 link-local range used in bird::anycast

bb53219a11-+-prometheus: fix analytics ceph server relabel config

0b150f8cd3-+-prometheus: fix "Configure prometheus metrics on the cephosd cluster"

736d4e93d4-+-kafka-main: Replace kafka-main2002 with kafka-main2007

3e0e4730a7-+-Use global unicast to peer from cephosd but allow LL for BFD in

8a8d9e20a4-+-Don't uninstall libnet-dns-perl when moving from ferm to nftables

2739098dd6-+-ganeti: Install bridge-utils on Bookworm

d01bcc2542-+-mx: Enable profile::auto_restarts::service for rspamd

df6fcd2f0c-+-backup: Increase the number of max volumes on the productionEqiad pool

9734c6ab26-+-vrts: fix test command path

96ea83a9d8-+-phabricator: syntax fixes for firewall::service

5cb884e59f-+-vrts: run install script on new server

4b7d032fd0-+-Add new global IPv6 private range to base firewall defs

e5dc645751-+-puppet8: avoid relying on g10k::config_file being defined

2ca87e6534-+-P:ntp: update check for configuration file changed

f54c7ee405-+-kubernetes: Rename two workers

35372ef5ee-+-ntp: standardize the use of ntpsec in the configuration as well

1d871bec7b-+-cloudgw: introduce support for multiple flat networks

6d6daa2fa4-+-kubernetes: rename mw2431 to wikikube-worker2104

e9ccdf41b4-+-Configure prometheus metrics on the cephosd cluster

cd90103411-+-prometheus::cloud: add maintaindbusers target

d4d1dffd44-+-standard_packages: Remove more obsolete packages after bullseye->bookworm update

88578984fe-+-Revert "prometheus::cloud: add maintaindbusers target"

46e2e8d749-+-standard_packages: Remove more obsolete packages after bullseye->bookworm update

438d7d87a1-+-lists: Mask mailman3 service on non-active host

edfb1593b6-+-prometheus::cloud: add maintaindbusers target

1a9eca5faa-+-mariadb: productionize db2227

1f3a2c12f0-+-logstash: put logging-sd200[1-4] in service

0a690fdb4b-+-Fix up Phabricator firewall services, part 1

6ce33171f8-+-Revert "codesearch: replace ferm::service with firewall::service"

2c27e4302f-+-Cleanup firewall::service configs for miscweb

a2d460c597-+-Cleanup firewall::service configs for aphlict

256dbe30e4-+-Create corto deployment/configuration

417c4689ee-+-Correct firewall services for releases

87cd4043cb-+-Fix firewall service definitions for CI

5d7d15fef9-+-kubernetes: rename mw2430 to wikikube-worker2103

2fb69c460d-+-planet: drop firewall rule for http from localhost

15a11a3854-+-wdqs: better isolation of categories components

164489ef50-+-rename/renumber kubernetes2034 to wikikube-worker2102

22f76eef61-+-deployment_server: Remove buster php-readline stanza

40b6064d7c-+-kubernetes: Rename mw233[2-4]

d6c22d4519-+-k8s: rename mw232[012], kubernetes2031 to wikikube-workers

979ebc89e5-+-Add the anycast VIP for radosgw to DPE Ceph servers

6d3bc365a6-+-rename/renumber kubernetes2020,2033 to wikikube-worker2093,2094

ac93396945-+-stewards: Enable profile::auto_restarts::service for rsync

77aca7d633-+-puppet8: ensure type is binary

3d0af52c64-+-grafana: Enable profile::auto_restarts::service for rsync

f4e1b3f7b5-+-kubernetes: Rename mw242[01] to wikikube-worker...

1cb37a885e-+-mariadb: productionize db2225

0a7c4b98b3-+-Temporarily disable stunnel for the Puppet 7 migration of deployment hosts

079a94cb7d-+-toolforge::prometheus: fix typo in config

fcb061472f-+-mariadb: productionize db2224

47329da0ed-+-toolforge::prometheus: keep only the metrics we use for nginx

e960f9f698-+-librenms: Enable profile::auto_restarts::service for rsync

c99f5de9b5-+-Switch acmechief1001/2001 to insetup::buster

ec282ea308-+-Rename/Renumber mw2434,2435 to wikikube-worker2089,2090

497dfd1379-+-profile::firewall::nftables_throttling: throttle connections not packets

ac036e3278-+-mariadb: productionize db2221 db2222

dd3d17d763-+-site: add insetup-gerrit role to gerrit2003, remove gerrit1004 hiera

779d33406f-+-Weekly Phabricator data for Tech News: Add recipients, tweak params

c97cc57411-+-wdqs: drop deploy_mode

34c09085b7-+-wdqs: drop run_tests crontask

f0f8a97971-+-wdqs: remove deprecated wcqs reload crontask

baa08e409a-+-tlsproxy::localssl: Remove support for cergen certs

f18c93db25-+-decommission mw2267 (no changes for mw2260)

5b2263fffa-+-cloudceph: add cloudcephmon1005

885ca6d349-+-puppet8: remove unused scap config file

f2fcfb9768-+-puppet8: mtail, check if notify is defined

ee13c98efa-+-R:codfw1dev:cloudweb: Adapt config to cloud dev.

aee7a001fd-+-[Analytics][Refine][test-cluster] Bump test cluster Refine job version

c019f90d3e-+-Rename kubernets2009,2010,2035,2054, reimage to bookworm

1897bacf0e-+-k8s: re-vlan, rename and reimage mw231[6789]

de77518bb0-+-D:apereo_cas::service allow exclusion of LDAP groups.

ae6ff88328-+-kubernetes: Rename mw2325 to wikikube-worker2079

6b23a01b2b-+-kubernetes: Set wikikube-worker2079 insetup

18a5caa930-+-global_config: define an external-services entry for mx[1-2]001.wikimedia.org

7ad692ae37-+-site: rename gerrit1004 to phab1005

d98b0394d0-+-keystone/apache: fix OIDC settings again!

8cb101b932-+-kubernetes: re-name/IP mw2260 and mw2312

4739435df5-+-P:toolforge::bastion: Re-install joe

ef9cb7a88d-+-wdqs: Remove experimental configuration

36fe450731-+-kubernetes: Rename mw240[267] to wikikube-worker...

075064da8a-+-refine_eventlogging_analytics - only refine MediaWikiPingback data

6df98ba17b-+-site: fix role for reimaged kubernetes hosts

f260d4d2d1-+-cloud: refresh conntrack values for cloudgw/neutron

7884bf2827-+-k8s: rename kubernetes20(28|55) and mw242[23] to wikikube-workers

6d98748002-+-Readd profile::idp::build to idp-test

d2a7c242f6-+-openstack: compute: set conntrack buckets values to a power of 2

f5cd82904c-+-decommission mw226[1-2].codfw.wmnet mw22[68-77]

3cf57b8982-+-openstack: compute: increase size of conntrack table

63db1111a2-+-global_config: define an external-services entry for gitlab.wikimedia.org

5cb2e0cab7-+-keystone + oidc

20e6e482e6-+-R:codfw1dev:cloudweb Add CAS IDP installation.

3b7a92b7e1-+-k8s: rename mw238[6789] to use wikikube-worker hostnames

dd21a538e5-+-icinga: add systemd::timer::job required parameters

d72a3957fa-+-icinga: remove check_etcd_mw_config_lastindex

9260b3c06b-+-Rename kubernetes2008,2027 to wikikube-worker206[67]

46520aa430-+-kubernetes: re-name/IP kubernetes20(30|57) as wikikube-worker206[45]

79cf2dcad3-+-kubernetes: Rename last appserver in eqiad

0e3ae02090-+-kubernetes: Rename last appserver in codfw

90d14fd062-+-k8s: rename mw238[345] to wikikube-worker206[012]

ea9fa2dc79-+-P:idp Reallow CAS 6.6 to be installed.

06e1d1064c-+-manifests: move new GPU hosts in eqiad from insetup to worker role

fe3262c6f3-+-Rename mw237[789] to wikikube-worker205[789]

6de1c5379a-+-k8s: rename mw2382 to wikikube-worker2056

3356047f05-+-k8s: rename mw2381 to wikikube-worker2055

631f409dd4-+-Rename mw229[567] to wikikube-worker205[234]

1246781130-+-global_config: Add pki::multirootca IPs to external-services

6db959f1be-+-site: add insetup configs for new logging-hd hosts

4421afe850-+-keystone::apache: install mod_auth_openidc package

9885b9748f-+-keystone::apache: include auth_openidc

4f4bfddaa8-+-Put cloudcephosd1036 into service

67a14d3c91-+-releases: drop java_home parameter for releases/mediawiki

c65434aa57-+-kubernetes: Rename mw2401 to wikikube-worker2051

0c1b56b5d1-+-profile::prometheus::ops: collect Puppetserver's metrics

7196d1817e-+-k8s: rename mw2380 to wikikube-worker2050

5635e0ab84-+-site.pp: prepare for idp-test2005 VM on routed Ganeti

7921518264-+-P:idp Clean up CAS 6.6 and Tomcat 9

59bc3863bb-+-maintain_dbusers: add prometheus stats

27cb2f53ea-+-mariadb: Add db2230 to test-s4

24493f93ab-+-kubernetes: re-name/IP kubernetes2029 as wikikube-worker2049

81ac53a714-+-Keystone and Apache, 2gether again

f3849b2702-+-Rename mw2295 to wikikube-worker2048

76c3e7bd8c-+-videoscaler: use ffmpeg from component

8d5d29a83f-+-Revert "vrts: add yearly ticket count"

7975adb7ec-+-Add apache to codfw1dev cloudcontrols

ff424850cd-+-Remove role::common::core_platform, s/Core Platform/ServiceOps/g

46055b9048-+-vrts: add yearly ticket count

0bc234c25f-+-toolforge:prometheus: limit ingress-nginx scrapes

74f529070f-+-toolforge:prometheus: drop metrics as early as possible

9f6394727a-+-toolforge:prometheus: only kyverno controllers expose stats

d9c15d77f4-+-Rename/Re-IP kubernetes2007 as wikikube-worker2047

5ea00569cf-+-kubernetes: re-name/IP kubernetes2026 as wikikube-worker2046

165871eaf3-+-codesearch: replace ferm::service with firewall::service

b11465862b-+-Add the matomo-plugin-customreports package to Matomo

1b1744706a-+-Rename mw2293 to wikikube-worker2045

9d3f055b16-+-Rename kubernetes2019 to wikikube-worker2044

e94ea78b7f-+-gitlab: add profile::prometheus::nft_throttling_denylist

5dba21a945-+-vrts: add ticket count metrics for different queues

06908c84dc-+-P:ntp: set time for CRITICAL alert to 2 hours (from 4) for service check

549eb9978a-+-vrts: create queries to test exporter

5d03a376c4-+-Rename mw2292 to wikikube-worker2043

be42ed47c6-+-Decom kafka-main2001

7219df70be-+-Add a matomo_plugins component to the apt private repo

525cd80b88-+-mariadb: Decommission db2114

75116040ff-+-p:m:toolforge::prometheus: drop the heaviest unused series

7fcd81582d-+-Revert "test-s4: Add two new hosts"

bea6d0b975-+-Revert "mariadb: Add db2232 to test-s4"

61f6e1b82e-+-kubernetes: re-name/IP kubernetes2025 as wikikube-worker2042

dcc9398dc5-+-Remove obsolete files for openstack v. antelope

3afdd418bd-+-gerrit/prometheus: create profile for new nft throttling exporter

53015a33a6-+-kubernetes: rename + re-IP kubernetes2018

12c431ce9c-+-prometheus: create text file export for nft throttling denylist length

ae7aaf3693-+-openstack/prometheus: remove openstack-exporter.yaml.erb

1562dbee70-+-site.pp: extend rpki host regex to 9

36802392f4-+-mariadb: Add db2232 to test-s4

53c3a4243e-+-test-s4: Add two new hosts

6e3f4a81e4-+-Add mtr to standard packages for WMF hosts

d99f0e36b0-+-prometheus: add scrape config for vrts sql exporter

597c60a9e9-+-P:idp Remove old CAS 6.6 hosts.

84385b79fa-+-Magnum: hack in fixes to sqlalchemy use

d99baa07c4-+-cinderutils: add --allow-unattended-format when preparing volumes

f256fb9130-+-profile::kubernetes::deployment_server::mariadb_master_ips: Handle no match

83fb625f2d-+-lvs2013: move A and B vlans to primary link and add new C and D vlans

a90243bc9d-+-kafka-main: Replace kafka-main2001 with kafka-main2006

4416f5f66a-+-site.pp: Split node blocks of new kafka nodes into two

1a8e168362-+-P:idp Remove CAS 6.6 test hosts.

2bb305ea2b-+-gerrit: add firewall, java, scap, mail settings to Hiera for gerrit1004

3ceef1812d-+-puppet8: add explicit typecast

5b5faef9ee-+-alert: Ensure the alert[12]002 hosts use the alerting_host role

40aac4b4b8-+-gerrit: create a temp insetup role to test java install in bookworm

caf4c6a614-+-ncmonitor: Remove duplicate sysuser creation

883c490e68-+-type Netbox::Device - make role mandatory

e7d465965b-+-Prometheus SSH probe: ignore network devices - try 2

56e8df0a97-+-Add TLS envoyproxy to the radosgw services on the DPE ceph cluster

86017a7f69-+-vrts: add from clause to query

60d364ed61-+-sql_exporter: specify column for metric

bc919df3e7-+-pontoon: clone netbox-hiera

3bf8f36925-+-Revert "gitlab: add replica hosts to Icinga"

a56ebec9a3-+-icinga: add gitlab-replica service names as monitored hosts

f3b702d718-+-gitlab: add replica hosts to Icinga

8aff581738-+-lvs2014: move A and B vlans to primary link and add new C and D vlans

30d03a1860-+-kubernetes: Rename mw2291 to wikikube-worker2040

9f93c5583d-+-Enable the correct service name for radosgw

46b971b6f6-+-add kitty-terminfo to standard packages

0c8d50de98-+-profile::netbox::data: add type for Netbox::Device

188dfbd49e-+-Netbox reports: add script ID

608b8b9ef7-+-Add radosgw services to the cephosd servers

a9d6a927b4-+-check_netbox_report.py: use venv's python

db9d6e1150-+-prometheus::ops: switch ferm::service to firewall::service

ee47db9643-+-Bump buildkitd to 0.15.2

c5cbff61cd-+-Remove old image building command for mwbuilder sudo

12c6c8edd5-+-gitlab: add option to serve a robots.txt and enable it in WMCS

88468b70c8-+-Add pbuilder hook for component/php81

b37f4c2b3d-+-Fix the absenting of this gobblin test resource

cc4332eee8-+-Add new codfw ganeti node to site.pp

0e81c67f1b-+-Absent the webrequest_frontend_rc0 gobblin job

4cc46a1018-+-Revert "gobblin: remove webrequest_frontend ingestion job."

e2ff7ed0e2-+-gobblin: remove webrequest_frontend ingestion job.

83f97f46e1-+-C:idm::deployment Add Bitu 2FA dependencies.

9099290504-+-prometheus: add oauth2-proxy for OIDC authentication

005bc698ef-+-cephadm: separate templates for zonegroup setup and rgw placement

e1e6cc679b-+-Fix typo in new wikikube-worker regex

ddd9cf98ed-+-rancid: add git directory as safe

8bde1b2ae1-+-profile::firewall::nftables_throttling: add option for burst packets

f6196773da-+-Netbox: disable rq-netbox on secondary node

94d2462c09-+-Netbox: remove prefer_ipv4 flag

f622a42f69-+-stat (dse) hosts: enable CPU performance governor

45b2c51f96-+-hiera/manifest/partman: Add configuration for new ML hosts

f3a0ee0d1a-+-site.pp: Add ml-labs machine entries for setup

40b8a1381a-+-Remove profile::netbox::scripts from Puppet

a0c3628155-+-aqs1022: provision new host for hardware refresh

6014a9634e-+-P:dns::auth::update set confd_admin_state true for all DNS boxes

ee220f3149-+-P:dns::auth::update: fix location of admin_state file

a508f74aba-+-P:dns::auth::update: maintain admin_state via confd

b0f62cc031-+-miscweb: switch firewall provider to nftables

f88258b5e1-+-vrts: remove port from connection string

888c3a8ce4-+-vrts: fix sql export param

3a2c555a0f-+-prometheus: puppetise sql_exporter

01de5bab06-+-site.pp: Move new ML GPU hosts from insetup to production

d3fc4181dd-+-Update airflow version to fix missing dependency

eb6f55beff-+-hiera/manifest/partman: Add DSE node with GPU

4e59a42ea9-+-snapshot: Remove absented cirrus dump job

88ea3694c0-+-ncmonitor: Set ignored domains configuration

2d60a0272f-+-Upgrade the default airflow version to v2.9.3

b9fb90bf31-+-Include the tuning.conf file in the postgresql configuration

96e91dc612-+-Increase analytics postgres max_connections from 100 to 200

97ddaa0f8b-+-dbproxy: mirrors hieradata

38e69a8eb0-+-Revert "vrts: change root mail alias"

e3dd301f9b-+-Netbox script proxy: set to absent

d00cd53f04-+-service::uwsgi: add $ensure variable for clean removal

dd4455849d-+-puppetmaster::gitclone: disarm pre-commit and post-commit hooks

bf7d9931a2-+-Revert^2 "Move the dump_cloud_ip_ranges etcd upload to puppetserver"

17b99fd97d-+-profile::lists: reload exim4 when the TLS material changes

ee028b27b6-+-backups: adds backup2012

58048a52c6-+-Switch the new presto nodes to the insetup role

27a88dde7f-+-Revert "phabricator: delay pages my 30 minutes to reduce alerting noise"

9dec589a59-+-ci: replace ferm::service with firewall::service for jenkinsagent

574d6b902a-+-wikistats: re-add puppetized mounting of cinder volume

ae89cbd59d-+-site.pp: move new ML hosts to insetup for imaging

fa20668ae7-+-wmcs-empty-rbd-trash: fix name of source file

c2ac27b8c0-+-cinderutils: allow floating point numbers for min_gb and max_gb

eec1836203-+-Add wmcs-empty-rbd-trash script

b1501fd1f6-+-New files, templates and manifests for OpenStack Caracal

83bc026222-+-Remove "netbox4" upgrade flag

4ae68fa09d-+-mediawiki: remove etcdconfig up-to-date check

b4e20d169a-+-Add new image building command for mwbuilder sudo

2292e2821b-+-ci: replace ferm::service with firewall::service in data_rsync

a89137983a-+-cache:benthos: remove Benthos references from cache files

01a605c0cf-+-git: remove umask from git::clone

433ce2f70b-+-hiera/manifest/partman: Add configuration for new ML hosts in codfw

63268d84b5-+-Remove Netbox 3 from MariaDB ferm ACLs

11bd9aa6d2-+-cumin: set git::clone umask to match requested file mode

4f43f5f1a7-+-Revert "Prometheus SSH probe: ignore network devices"

185a6ad976-+-Revert "Add role to type Netbox::Device::Location::BareMetal"

026ab1332b-+-Add role to type Netbox::Device::Location::BareMetal

9f63bb1ef6-+-Prometheus SSH probe: ignore network devices

e2161c6725-+-benthos: use fully qualified kafka cluster name

444f212b4b-+-webperf: use fully qualified kafka cluster names

c72b4ef510-+-benthos: add ensure support

8b01b2307f-+-Netbox prometheus: replace exporter script with plugin

e4b9dc59c1-+-Make cloudcephosd103[578] into ceph osd nodes

cb6bba2fb2-+-wdqs: add graph split type to blackbox probe alert

1f10e53315-+-ci: add new ECDSA ssh key for jenkins to connect to itself

f9db1615f1-+-ncmonitor: Enable patches, email; Set monthly

b13f1342a1-+-haproxy: various fixes

ae5fbc261f-+-haproxy: add cache_cluster parameter, needed by requestctl

f4ccad1e86-+-haproxy: fix etcd key path

bba904fe80-+-haproxy: move check command to a separate script

7aed56fcaa-+-haproxy: remove complex quoting

f637f0371b-+-cache: test requestctl rules in haproxy on cp4044

345f00fe4e-+-Add the postgresql prometheus exporter to an-db100[1-2]

0300001744-+-haproxy: add confd files for ipblock maps

a8e941e4cd-+-Postgres prom exporter: ignore queries.yaml on >= bookworm

d0a4958b6e-+-git-sync-upstream: execute the entire script as gitpuppet

9c9af0a5a7-+-wmcs: move gitlab tokens to a custom wmcs.yaml config

f60bc54df7-+-kubeadm: add helm-sudo as pair of kubectl-sudo

892d927503-+-Remove remaining references to cloudb1021

84811a387d-+-Fix error in site.pp for new analytics zookeeper hosts

078c314524-+-horizon: remove openstack client packages

72c3fba471-+-Netbox add libpq-dev package

3cad89d34a-+-wdqs: add main and scholarly role assignments

d4de0a35bd-+-gitlab: add missing parameter description in profile::gitlab

954337952f-+-gerrit: add parameter for lfs sync destination host name

4bcfc74fe6-+-nrpe::monitor_service: clarify interval is in minutes

49e6aaa254-+-external_clouds_vendors: set logging to DEBUG

0ab821e3d7-+-miscweb: replace ferm::service with firewall::service

eddc7df351-+-Bump buildkitd to 0.15.1

7454fdb1b8-+-postfix: enable smtpd_forbid_bare_newline

55cff4eb39-+-postfix: bump postfix module version

e5f1ab4754-+-mediawiki:: move cache_warmup from maintenance to tools

3c46f93f65-+-gdnsd::monitor_conf: update notes URL

832b0833b6-+-gdnsd::monitor_conf: set alert level CRITICAL

1acb16b24f-+-site: add setup roles for vrts hardware

b931ef8f80-+-cookbooks: add config for sre.switchdc.databases

4e3fe17db7-+-deployment_server: install the cache warmup script

a202f21b11-+-p:toolforge::bastion: add deprecated banner

7e77166664-+-Increase the number of Redis DB for standalone Netbox

8b3af2fe3f-+-Switch designate to the new designate rabbitmq user

d1d3ce7e6d-+-phabricator: delay pages my 30 minutes to reduce alerting noise

15113dd108-+-rsyslog: send all k8s logs to dedicated kafka topics

f5b9bfa2d8-+-site.pp: Remove deploy1002

708559e0ac-+-deploy1002: decommission

3d0fec80d0-+-cinder-volume: use cinder rabbitmq user

16f36e1c7c-+-Switch trove to the new trove rabbitmq user

78208c5d81-+-Switch cinder to the new cinder rabbitmq user

41b20063ed-+-site: add insetup configs for logging-sd hosts

5acc330741-+-cloudcumins: deploy gitlab token for tofu-infra

3f3e17c089-+-durum: switch ferm::service to firewall::service

848e89834b-+-phabricator: increase timeout for collab blackbox check

4567e17d05-+-parse[12]001: Move them to wikikube workers

520dbd7ebd-+-backups: Add backup1012

5f9dfcf7af-+-phabricator: remove git.wikimedia.org vhost, rewrites and tests

4b55f211a3-+-crm: Add another dir to www_admin grouped dirs

b0c5adfd46-+-phabricator: replace ferm::service with firewall::service

b628ffcb3c-+-scap::user: define the correct shell

08d8065039-+-admin: deprecate sre-admins

2d65a7e632-+-Switch wikikube-worker1240-1304 to insetup

6448e0d502-+-gerrit: add nft throttling on replica but don't enable yet

767ddda64e-+-admin: add dcops to the system adm POSIX group

784d893a60-+-site.pp: new thanos backends are safe to add to thanos::backend

81311f1560-+-mariadb: Move db1224 to x1

7eb5b05f4c-+-site.pp: Add hostnames for the new mw refresh

2b4b836c0a-+-gerrit: use list of replicas from hiera again, don't do puppet DB lookup

461ca5c3d6-+-releases: switch ferm::service to firewall::service

d21da2533f-+-aphlict: replace ferm::service with firewall::service

34ce6dc66d-+-site: simplify regex for doc hosts

c199ad1f62-+-prometheus: clean up legacy parameters

f96c169c72-+-prometheus: remove absented resources

07bb2f7a39-+-kubernetes: reimage 1 appserver to kubernetes

ab1e8432b5-+-karapace: cleanup after karapace100[12] were decommissioned

eeb11c69b6-+-logstash: consume k8s logs topics

e0b33b265a-+-haproxy: add ability to inject requestctl rules

91feff4823-+-haproxy: add confd_file define

a41d552e1d-+-profile::haproxy: move tls_terminator.pp to profile module

d35f34acfc-+-gitlab: fix port definition in firewall:service

65486c5792-+-postfix: prometheus ops config for mx-in boxes

99ad71b295-+-burrow: Create a runtime directory in the service definition

96e9ae6fd5-+-site: add new hardware gerrit1004 with insetup role

e4df582616-+-site: add new hardware gerrit2003 with insetup role

f60eeaba20-+-Revert "burrow: Create a runtime directory in the service definition"

5e76c81f7f-+-burrow: Create a runtime directory in the service definition

e8bd68ae88-+-P:mediawiki::php::restarts: fix no-LVS case

88dae13db2-+-Revert "Move the dump_cloud_ip_ranges etcd upload to puppetserver"

bd8626079d-+-wikistats: add systemd timer to copy backups to external cinder volume

fe633072a5-+-wikistats: temp comment out mounting of the cinder volume

14476b6f3f-+-wikistats: drop min_gb size hint for cinder volume

fee8d6ce45-+-Revert "wikistats: adjust min and max size hints for cinder volume"

c541ace8ee-+-wikistats: adjust min and max size hints for cinder volume

1da744b5d3-+-Update new cloudcephmon node to use insetup role

93c5bf5e03-+-Rename / reimage one appserver to k8s worker

06e45c84f2-+-Netbox 4: add transition flag for Redis database

fefc5009a6-+-Move the /srv/netbox/ directory creation behind netbox4 flag

44509ffd0e-+-elasticsearch: remove obsolete alerts

10d2dd48cb-+-site: add insetup for prometheus[12]00[78]

d29bd01b2d-+-Add the new presto servers to site.pp and preseed.yaml

06c876cefd-+-Netbox 4: add version flag

636878e2dd-+-profile::docker::reporter::report: add min_debian_version arg

d8f47f2518-+-Move the dump_cloud_ip_ranges etcd upload to puppetserver

84fc73127d-+-puppetmaster: set git::clone umask to match requested file mode

d5f2315ef8-+-wikistats: mount a cinder volume to store backups externally

64fb0e6bec-+-alert: Add node definitions for the alert1002 and alert2002 hosts

802084cddc-+-firewall/gitlab: add option to throttle and drop traffic using nftables

039059f18b-+-services_proxy: add idle_timeout parameter, enable in shellbox-video

4560ca3e77-+-site.pp: Put legacy api and appservers insetup

2aac4454ce-+-wdqs: add main and scholarly puppet config

c5ee0173f7-+-planet: switch firewall provider to nftables

9b2f604b8c-+-systemd::timer::job: Use TimeoutStartSec=

6a9d6d9ae4-+-role::puppetmaster::backend: allow puppetservers to connect via ssh

c8b7bffd81-+-profile::puppetmaster::frontend: allow puppetservers via ssh

6a2b7a2101-+-varnish: show better error for 429s

2822ec298f-+-imagecatalog: Remove require for data directory

cff0b9d860-+-imagecatalog: Actually comment about the uid/gid

f96c189d8b-+-imagecatalog: Force uid/gid for imagecatalog user

f2830bc789-+-imagecatalog: Vary gunicorn package on Debian version

507ff3eeb5-+-Tweak gnmic parameters to improve performance

bea2df68cc-+-openstack: opentofu: init modules before runnig plan

78a3d95142-+-Add monitoring definitions for new codfw row C/D switches

824a4001fe-+-Thanos: use new-style swift storage layout for forthcoming backends

246dfc06df-+-grafana: clone grafana-grizzly with default parameters

8d0eb33c7e-+-planet: replace ferm::service with firewall::service

d3e0c3e910-+-toolforge: remove pinning from the services node

badd6b9fdf-+-Netbox config: fix one oversight

05674341c9-+-Netbox 4: fix script path vs. extra path

bfa6bf63e2-+-Netbox 4: ACLs + breaking changes

7c7b53b863-+-kafka: use instance-based selection for kafka-kit storage metrics

b4daaae964-+-openstack: remove OpenTofu git::clone file mode

d6b9dc92b8-+-Revert "openstack: nova: Ensure libvirt is running when declaring secrets"

8438917b95-+-openstack: nova: Ensure libvirt is running when declaring secrets

64e1bc07fa-+-kubernetes: rename 4 appservers to k8s workers

b15105d20a-+-mediawiki/geoip: make loading geoip data from puppetserver optional

113f7fc280-+-Add monitoring checks for codfw row D spines

d45b9b3a4b-+-expose_agent_certs: use ssldir exclusively

57c50ad730-+-Increase the heap for the mapreduce history service on an-master1003

779721b86a-+-openstack: opentofu: git pull the repo using checkout mode

94e5c05df2-+-ncmonitor: Add public suffix list module

af53f5d01a-+-cephadm::target mask the podman-auto-update service

d2f91ad974-+-statistics: remove git::clone file mode

647133e4b7-+-logstash: add auto_offset_reset to kafka input

1d244b2a05-+-mysqld-exporter: hotfix config for es1 to es5

67b47589e1-+-crm: add gnupg to crm role

41333fe9e4-+-refinery::job::gobblin - use gobbin-wmf 1.0.2

862eba8621-+-refinery::job::test::gobblin - use gobbin-wmf 1.0.2

60505eb13c-+-varnish: add requestctl filters for cache hits

3cc6999d5d-+-p:toolforge::bastion: add helm

19c30f2bde-+-parsoid::testing: remove unused file

3fba73ac19-+-p:toolforge::bastion: cleanup tekton repo

fa23f0a92b-+-C:idm configure 2FA proxy endpoint.

e671c59e04-+-Disable produce_canary_events systemd timer

117beb78e6-+-Update refinery_version for  refine and refine_sanitize

977ce2d0f9-+-Revert^2 "wdqs: microsites for wdqs graph split"

1d73b3dd9f-+-Update refinery_version for canary_events, test refine and refine_sanitize

17801e3171-+-Phabricator: Update recipients of quarterly metrics mail

4c5378617d-+-lists: ensure list member sync only happens on the active server

306bf44d0c-+-relforge: remove non-functional TLS termination changes

949133515d-+-purged: set use_pki to true for all sites

b2af5d7e1c-+-Switch the rols of clouddb1021 to insetup::data_engineering

d73d5cf23a-+-Revert "Update the eventstreams_config_uri for canary_events"

24a585823e-+-Update the eventstreams_config_uri for canary_events

232c14f2ee-+-gitlab: switch gitlab from iptables to nftables

96b5d2b4f3-+-wdqs: enable throttling only for reqs from the CDN

767b19b77d-+-wdqs: allow to configure internal federated endpoints

d50ce10a60-+-mailman3: add missing whitespace in sync_list_members

417f881a02-+-prom-ipmi-exporter: add sel-events collector

90ea45f668-+-mailman3: defined type to sync list members, create timers for each list

1f4182ecf3-+-vrts: change root mail alias

f156967ea6-+-pyrra: add liftwing SLOs

c5ff6193af-+-Netbox 4: create customscript parent directory as well

8ac0d0b08e-+-gitlab: replace ferm::service with firewall::service

4adaeb4f07-+-Netbox 4: create parent directories

e02c27cdd9-+-gitlab: introduce log rotation settings

704579db88-+-profile::tcpircbot: allow puppetservers to contact tcpircbot

be47bcf007-+-packages_wmf.pp: Remove Buster support

596d7fceb2-+-profile::kerberos::kadminserver: allow more nodes in rsync

5faadf5782-+-profile::tcpircbot: allow inbound conn from puppetserver nodes

1a49e24d1b-+-R:idp New CAS 7 hosts.

8b612e1dc6-+-opensearch: add watermarks to instance params

0c1d778ccd-+-deployment-prep: replace deploy03 with deploy04

b0f9e780a7-+-Reimage 3 kubernetes servers to videoscalers

968da431b0-+-Bump all buildkit image tags to wmf-v0.15.0-1

2f7648414c-+-stewards: rename userdb_gitlab_token variable

a7393129c3-+-relforge: test envoyproxy

89a2d31117-+-relforge: test envoyproxy

5684871601-+-Revert "deployment::rsync: Add support for PKI"

0c8ce07ac9-+-deployment::rsync: Add support for PKI

acc1a09c85-+-service::configuration: Fix doc

7e50f739b6-+-logstash: enable normalize_labels on production

f68bcef4af-+-Netbox 4: prepare Puppet for new prod servers

a7a53c7d26-+-gerrit: remove absented clear_gerrit_logs timer job

5cb081f886-+-util/admin_scripts.pp: wmcs-pause-cloud ensure absent

c9e3f4f325-+-wmcs-cold-migrate.py: remove

c5599df6e1-+-stewards: clone user DB repo from GitLab

6c09c9d03d-+-opensearch: Enable configuration of watermark parameters

ecf662a97a-+-crm: Add lookup for civicrm branch to check out

deb89949b8-+-puppetmaster/puppetserver: remove MaxMind db product GeoIP2-Enterprise

5eb15b7783-+-class scap::scripts: Drop logstash_checker.py, phase 2

ed278546d3-+-mysqld_exporter: pull from bpo in bullseye

f8734c1697-+-webperf: Enable the statsv service at boot

b0db4aecba-+-webperf: Enable the navtiming service at boot

6b2b225b64-+-cloudcephmon100[4-6]: add to puppet

735d3b246f-+-mediawiki::httpd add APACHE_RUN_PORT to env

9ae728a3e4-+-Add safe directory settings to the prod private repo's git config

27138e6f9f-+-Revert "Puppetize the disabling of the misc dumps on snapshot1017"

025771c3a4-+-mariadb: enable pt-heartbeat monitoring through mysqld-exporter

a089bf7521-+-C:idm::deployment Add new Bitu dependencies.

61104ed6df-+-scap::scripts: absent logstash_checker.py

f5e1b3b10e-+-Revert "class scap::scripts: Drop logstash_checker.py, phase 1"

60be0c6512-+-class scap::scripts: Drop logstash_checker.py, phase 1

8c59c6688e-+-lists: Remove references to lists1001 after decommissioning

f9111089cf-+-Remove role::etcd::v3::kubernetes and hosts

44fc554923-+-elastic: test envoy TLS terminator in relforge

386503f953-+-pontoon: add frontend proxy capability to LB

bd7631f83e-+-pontoon: support puppet 7 / puppetserver and openstack API

05e96feab3-+-Revert "wdqs: microsites for wdqs graph split"

c4c2892454-+-wdqs: microsites for wdqs graph split

41c89a5cfc-+-Allow dse-k8s-worker hosts to access ceph ports

57fd439a06-+-stewards: Add Phabricator API configuration

e9cb8bc5f8-+-stewards: install python3-phabricator

6ed79ead17-+-P:dns::auth: indentation clean-up, no code change

304390c99a-+-gerrit: enable built-in log rotation

4f108aa131-+-Puppetize the disabling of the misc dumps on snapshot1017

f10160ba0d-+-haproxy,hiera: Test bwlimit per url on cp4051

0c6942a22d-+-gitlab::runner: Add buildkitd to no_proxy

b1fc437140-+-toolforge: k8s: control: install k9s

d79ba5615e-+-pc2017: Add host

c14d1e784c-+-pontoon: Remove more puppet 5 leftovers

7f0a132be4-+-site.pp: New parsercache host

3d413d53c4-+-trafficserver: Final mw-on-k8s cleanup

f41d26a430-+-trafficserver: Cleanup mw-on-k8s scripts

780c8aa09e-+-trafficserver::lua_script: Implement ensure param

b97f72fd93-+-deployment::rsync: Remove long absented resources

2f17b4654a-+-Disable auto restart of the karapace service

ea95891414-+-kubeadm: core: remove deprecated pre-defined kubelet flags

f579f6237d-+-phabricator: change "unless" command for generating git safedir config

806855b20d-+-phabricator: qualify test command for 'unless' in Exec

b2fc05f738-+-phabricator: add script to set safedir git config for deploy repo

d593df4a19-+-site: add parsoidtest section

2b8e2e7776-+-Revert "Phabricator: Add safe.directory directive"

af42c9e937-+-deployment_server: Run mwscript-cleanup as mwdeploy, not www-data

159e281ee0-+-deployment_server: Add a daily systemd timer for mwscript_cleanup

7e56e283e7-+-systemd: Expand Systemd::Timer::Interval pattern

ed1dd752c0-+-wdqs: detune blackbox checks

c772094604-+-dbbackups: Set dbprov[12]00[12] to insetup

bbc6753c5d-+-dnsbox and Wikimedia DNS: revert usage of LE's alternate chain

d09681dd49-+-dbbackups: Disable es read-only backups and reenable rw ones

696f0aeccb-+-Add an-conf100[4-6] role and partman recipe

3e962a6dab-+-Add DSCP marking options to current firewall classes

a6c322b36a-+-Routed Ganeti: add public v4 tap_ip

3acecbab46-+-site.pp: Add db22[21-40]

b91096113d-+-profile::toolforge::elasticsearch::keepalived: keepalived interface from hiera

6277bdf7c5-+-postfix: verify recipients when possible

b04d7a421b-+-postfix: override default for parent_domain_matches_subdomains

0a3631186d-+-postfix: fix use param of $trusted_networks

9e7380e206-+-P:kubernetes:node: Autorestart ferm.service

268f19b5ad-+-openstack: nova-compute: remove support for legacy NIC setup

884f0e025c-+-profile::puppetmaster::updatenetboot: update help and install targets

0930526c0d-+-thanos: increase query frontend and store cache sizes

3b920d8360-+-kubernetes: retire kubemaster100[1-2] in eqiad

6d83e1cd37-+-toolforge: prometheus: scrape kyverno metrics

2691f657bf-+-Preseed: set /32 netmask for virtual ranges

0dc8d31d46-+-dbbackups: Reenable es-readonly for one-time es5 section backup

e2167caef0-+-gitlab: use dedicated ensure for gitlab-exporter

6e1b23ce13-+-kubernetes: move 5 appservers to kubernetes

08a020a641-+-gitlab: use ensure latest when cloning the gitlab-exporter repo

2893624985-+-backup: Increase the maximum amount of volumes for es-readonly

ef1c2927a6-+-backup: Reduce the maximum amount of volumes for es-rw pools

a442f1a831-+-kubernetes: retire kubemaster200[1-2] in codfw

c40889e6e8-+-Increase scrape_timeout for gnmic prometheus to 30s

8287b714a6-+-gitlab-settings: v1.6.0 for squash commit templates

2f5d8d8115-+-profile::puppetserver::git: add an option to exclude servers

6235d4dc27-+-beta-logs: remove dlq spam mitigation

036c58be5f-+-test normalize_labels ruby script on beta

65c6834015-+-stewards-onboarder: Add gitlab API to config

330590ccc4-+-deployment_server: if guard php-readline to buster

5dbb9cff94-+-deploy1003: Assign role

76125d20d9-+-Change gnmi sampling interval and enable timestamps for prom output

7538ee52ba-+-envoy: Ensure legacy listeners point to mw-on-k8s

a26ca3db82-+-mariadb: Move db1195 to s1

befe3f1390-+-mariadb: Promote db1228 to m2 master

5af452ebd2-+-deployment_server: Add a mwscript-k8s cleanup script

e0fba5b27a-+-kubernetes: move 5 codfw api appservers to k8s workers

0404beea6a-+-Move 5 appserver to kubernetes

0dcc4c14f9-+-Add deploy1003 to site.pp

e12ec4f7e1-+-gitlab::runner: Move defaults for profile::gitlab::runner::buildkitd_* lookups

5b128a0467-+-Provide weekly Phabricator data for Tech News

b27c3a3e7f-+-cassandra: remove support for 2.x versions

5e1c5610f1-+-buildkitd/gitlab-runner: Default allowed gateway sources to empty list

86b7e3b07f-+-profile::gitlab::runner: Add defaults for some arguments

fda7852b77-+-httpbb/liftwing: Actually deploy split-out file from change 1049943

e60454e9ae-+-benthos:cache: using tcp proto for syslog messages from haproxy

000e4ab785-+-Reimage 5 appservers to kubernetes

a9576f1153-+-Add ripgrep and fd-find to standard packages

31f2f24e6a-+-vrts: query for inbound mail servers

cf9b2a12af-+-dbbackups: Disable further es backups until Monday while ongoing

51125fe974-+-prometheus::ops: Pull fifo_log_demux metrics

6bdf1b8946-+-Update ceph server firewall and permit access from dse_kubepods

95704f63c2-+-kubeadm: remove reference to PSP directory

ab3268845d-+-kubedm: absent psp directory

408664e6d2-+-Replace 'labweb' variable names with 'cloudweb'

1c0001dca8-+-dbbackups: Fix backup name conflict, disable regular backups

8602b5e1b9-+-Remove and reclaim GIDs for legacy analytics group

b8a818e5fe-+-dbbackups: Reenable es backups, also enable ro ones for archival

fb149b48e6-+-Remove irc1001/irc2001 from site.pp

3cdc6258bd-+-R:idp_test: Separate testing environment for CAS 7

a40fe5c91e-+-haproxy: add notion of trusted IP space

37a9ae3e73-+-Default Cassandra clusters back to target_version '4.x'

67a8db795a-+-Revert "Disable varnish handling of /beacon/event to decommission eventlogging backend"

6379d4fc8c-+-Disable varnish handling of /beacon/event to decommission eventlogging backend

6f816875bc-+-varnishkafka::instance - let service_unit manage service enable param

d15b046c28-+-logstash: clean up remnants of logstash200[123]

c656a7d257-+-Configurably remove varnish handling of /beacon/event

9b245b9b13-+-postfix: revert to traditional local mail setup

31f03abd1f-+-postfix: add more smtp restrictions

113da89898-+-hiera dnsbox and P:bird: remove references to ntp.anycast.wmnet

258e40bf0f-+-postfix: support for discarding select recipients

4e8d47ca55-+-Remove mention of cloudvirt200[1,2,3]-dev

6e0c63dea0-+-Revert "postfix: always send local mail to smarthosts"

f1dc80fe04-+-Move cloudvirt200[1,2,3]-dev to insetup, prepare for decom

3827d156c6-+-P:systemd::timesyncd: switch to anycast NTP peers

9296f2b0fc-+-buildkitd: Bump to version wmf-v0.14.1-3

31c28e680a-+-P:netbox: Don't show status MOTD for active hosts

6a7e5d9043-+-Phabricator: Add safe.directory directive

6986c7a223-+-gitlab: remove last reference to ldap_group_sync_user

1abe32f8f1-+-Add krb1002 to site.pp

4ff456a5bf-+-P:ntp: generate $time_acl from network::constants

4479637a24-+-dynamicproxy: Clarify error page titles

cfabddecae-+-Switch old irc hosts to insetup::buster

912911cd64-+-mariadb: Move db1228 to m2

d45e9e36d9-+-P:puppet: Remove Puppet 7 MOTD

7b7d0be4c0-+-package_builder: don't install python-all on bookworm

0508354622-+-p:prometheus::cloud: use cloudcephosd1010 instead of 1020

03e86f06bf-+-amg_gpu: fix duplicated class declaration

66e3898ee0-+-C:apereo_cas check for tomcat 10 on CAS 7 only variables.

05a221dd56-+-Scrape temporary deployment of ebpf_exporter

093c9f1e64-+-gitlab: remove unused ldap_group_sync_user

2fc52d6412-+-profile::rocm: Install ROCM SMI on k8s machines without rocm_version

d44a87f534-+-apus: service catalogue entry and lvs::realserver setup

3eb23565e4-+-hiera,openldap::replica: Enable IPIP on codfw

03152136d2-+-C:apereo_cas oauth session encryption

c08605bfcd-+-Deprecate system::role for Cloud VPS-specific roles

0541979542-+-Add a comment why puppet masters are listed for tcpircbot

94c8a8adb6-+-Move puppetdb.tuning.conf template

431332be9c-+-mediawiki: Reimage scap proxies as videoscalers

69de7c692b-+-Remove stat1004-1007 from site.pp

4789ac077c-+-Move update-netboot-image.sh to the puppetserver module

3ff7144b29-+-Netbox 4: create new script directory and enable debug

1a36771e1e-+-gitlab: add custom nginx config to block manual Trusted Runners edits

da2534afad-+-mailman3: remove buster support

5e0d9c4fd0-+-aphlict: remove duplicate sytemd timer for logrotate

2733ed1b79-+-lists: Add symlink to /var/lib/mailman3 when using different root

a4bbc3c19c-+-cassandra: Pin the proper Cassandra version for 'dev' target

790a798e0e-+-lists: Add ignore_missing_file_errors for rsync data copy

a648c5d053-+-P:bird::anycast_monitoring: add monitoring for 10.3.0.[5-7]/32

cabee8af0e-+-cloudelastic: enable IPIP for LVS

33091c145a-+-kubernetes: Reimage 6 appservers to kubernetes

e9adb5e33a-+-Remove cassandra-ca-manager

adb56ba8fd-+-swift::proxy: Limit access to swift ring sync to Puppet 7 servers

d2a74f21c2-+-Move lists1001 to insetup::buster

c87fb34086-+-wikikube: Use conftool for scap docker_pull_k8s

c0222c13bd-+-Remove mcrouter CA setup

a077acad38-+-service:uwsgi: remove scap support

c13f98a93e-+-Standalone Netbox: set redis' appendfilename

fcd55a9fe2-+-thanos: Limit access to swift ring sync to Puppet 7 servers

d83b59a7e3-+-Stop syncing swift rings on Puppet 5 frontends

d9686edc8e-+-karapace: disable the systemd service to see if errors surface

fe809d2e4e-+-P:idp Allow upgrade to Tomcat 10.

9200672de8-+-kubernetes: Reimage 6 appservers to kubernetes

a3bda0fcb2-+-Netbox: add bookworm support for DB module

4fed1628e0-+-mailman: Avoid Ferm-specific syntax

b54f5af345-+-Deprecate system::role for DE test cluster

0e7edd1c9d-+-Move moss-fe{1,2}001 back to apus cluster

aeabbfaeb1-+-Netbox 4: JOBRESULT_RETENTION -> JOB_RETENTION

8ad29c4c63-+-profile::java: Add support for Java 21

609976f32e-+-Prepare for netbox-dev

8a44870ab9-+-analytics: allow dse-k8s pod network to reach an-db1001

39012a762f-+-postfix: always send local mail to smarthosts

32b36043ca-+-lists: Update rsync module path for quickdatacopy

6204be9856-+-lists: fix invalid unit name for rsync::quickdatacopy

d9c2155558-+-stewards: Allow lists.wm.o to access the stewards rsync server

2b1b5978f9-+-gitlab-settings: correct configure-projects script path

d17a73077c-+-lists: Change lists sync to use quickdatacopy

3042cc0775-+-gitlab-settings: update tag to 1.5.0 for configure-projects

c4f9eb533f-+-gitlab-settings: use v1.4.0

09e78c3e97-+-hiera/conftool/manifest: Add ml-staging2003 as a k8s GPU host

519e67ba3e-+-gitlab-settings: add timer for configure-projects

7011b3533c-+-Remove obsolete profile::java::java_8

60992b9561-+-cas::build: Fix creation of build directory

418cd857e0-+-idp::build: Make the rsync setup depend on the OS

f3fb47e4b3-+-lists: Switch DB firewall rules to use primary host variable

94cdbe35ab-+-idp::build: Install Java 21 on Bookworm

1d1ec5439c-+-cephadm: install lvm2 on all target nodes, not just osds

2593c46a88-+-mw-irc: Fix installation of Prometheus Python client package

dc19b07da5-+-irc.w.o: Add support for Bullseye

ccf7dd275a-+-mariadb: Remove all remaining puppet references to db2102

a709555f4d-+-codesearch: fix dependencies on changing docker package name

cccf638199-+-codesearch: install docker.io if on bookworm

b52e8f2bac-+-Remove mentions of cloudvirt-wdqs100[1,2,3]

9b232f14c2-+-Fix missing wikikube-worker

3f6cc3e833-+-Prepare for decom of cloudvirt-wdqs hosts

63202f6d34-+-kubernetes: Reimage 3 appservers as kubernetes workers

d24dffc900-+-Revert "kubernetes: reimage 4 appservers to kubernetes"

a8aa702d85-+-kubernetes: reimage 4 appservers to kubernetes

3e4c457dde-+-Cleanup pbuilder hooks

98a189e550-+-kubernetes: reimage 6 appservers to kubernetes

38b40f5f5c-+-Add a build hook for Java 21

78f454ac63-+-P:openstack: designate: Only run wmcs-dnsleaks on a single cloudcontrol

eff909ff13-+-lists: Allow 'some files vanished' errors in rsync

74e3e79d39-+-profile::openldap::management: Remove support for buster

9a854c6e58-+-mwmaint: Stop including profile::openldap::management

e8cff8554b-+-nginx: Drop workaround for history Puppet bug

647f61e43c-+-Remove Pontoon support for Puppet 5 puppet masters

9039c46cbc-+-Deprecate system::role for remaining mariadb roles

da4c763072-+-Deprecate system::role for Kafka roles

35f26dd637-+-vrts_aliases: generate file as the postfix user

9cc63a8b62-+-Pass --allow-releaseinfo-change to apt-get for openstack client packages

b99226b958-+-unattended upgrades: change the Origin for openstack client libs

a1de92324a-+-dbbackups: Upgrade db1245 to MariaDB 10.6

5018280e79-+-dbbackups: Remove all production references to db2102

5c5c51e918-+-Apply openldap::maintenance role to ldap-maint* hosts

39507c05fd-+-prometheus::k8s: Keep envoy ratelimit metrics

0db375287c-+-cephadm::controller - check if management_hostname findable in netbox data

502ab2e91e-+-apus: setup for codfw apus cluster

cc6ceba2bf-+-lists: Add mailman_root parameter to mailman3 class

2ad1ee805e-+-lists: Switch mailman_root for new hosts

0124d57b7d-+-New openldap::management role

8b1e7c071a-+-profile::openldap::management: Add support for bookworm

5529a95ec6-+-Add ldap-maint[12]001 to site.pp

02ebd21aee-+-Remove old ping hosts from site.pp

80ac710792-+-mariadb::ferm_misc add mx-in{1001,2001}.wikimedia.org

6c47254363-+-postfix: mx-in add missing next hop

2c24b2fa87-+-postfix: mx-in{1001,2001} change role to postfix::mx_in

8fc5e48d44-+-openstack::clientpackages::vms::bobcat::bullseye: install 'zed' packages

3d8850a93e-+-postfix: misc postfix mx profile fixes

9c3c35896d-+-postfix: mx-in role

36632acb0d-+-lists: Add option to switch mailman root

7018d2f189-+-puppetserver::git::private: Use wrapper from puppetserver module

2e45edcba0-+-grafana: change performance testing graphite endpoint

5d41a6c48c-+-Switch the role for an-redacteddb1001 from insetup

18eeb25162-+-prometheus: nic_saturation_exporter: Depend on node-exporter

3b14a15191-+-hemlfile: export admin-ng pending diff metrics hourly

c722de8f5f-+-gitlab: bump exporter version to v1.0.11

bfc1fe9400-+-ircecho: Remove support for buster

902462a977-+-mailman: Remove ferm rule

c5de4ff7a2-+-profile::openstack::base::designate::service: Avoid Ferm-specific syntax

3306941adb-+-cephadm::controller - escape split argument

28c9f08b6e-+-lists: Remove quickdatacopy and use our own rsyncd and systemd timer

de7094b6f9-+-wmflib: correct doc string to note lvs is Optional

1c79b35593-+-cephadm: template out cephadm spec files

ddf37efa6f-+-decommission mw2281.codfw mw22[83-90].codfw.wmnet

f1c5742182-+-helmfile: remove temporary else block once resources were absented

374631244b-+-helmfile: don't schedule admin-ng diff check jobs for aliases of k8s clusters

9ec2417640-+-prometheus::blackbox_exporter: Avoid Ferm-specific syntax

a017caba63-+-profile::maps::tlsproxy: Unconditionally use PKI

f3e595c3ed-+-site.pp: New dbproxy hosts

cc51949bb4-+-Deprecate system::role for Cloud VPS-specific roles

e0bfdd5c0e-+-dump_cloud_ip_ranges: This is owned by all of SRE

d2e8910eb4-+-helmfile: set HELM environment variables for the admin-ng systemd jobs

da47bec100-+-geoip: Download GeoLite2 ASN file

4d52c1ca51-+-maxmind: Fix parameter order and document user_id/license_key defaults

5d36a40a98-+-k8s: send logs to per-cluster kafka topics

993bf6bba0-+-helmfile: fix typo in python script puppet path

75301268e2-+-deployment_server: alert on admin-ng pending changes

ee3054fbce-+-Stop sending cross check mails to sre-foundations

d8c5436caa-+-hieradata: Move cloudvirt1031 to OVS

0909b46a53-+-gitlab: set IPs for SSH blackbox check

5b008c19b3-+-gitlab: use IPv4 and IPv6 for SSH check

d1c410d727-+-gitlab: notify ssh-gitlab service when interface aliases are added

2a2c554d71-+-Remove deprecated uses_ingress option from service-proxy

c6a64da7a0-+-puppetserver syncs: also add monitoring + timeout

61e6c5c15f-+-enable monitoring+logging for puppetmaster syncs

f46a888cc2-+-Run vrts_aliases in debug mode

e01aa1580b-+-kubernetes: rename and reimage 4 servers

3005d13d34-+-realserver::ipip: Fix ferm MSS clamping rule

f18b5b3ee8-+-lvs::realserver::ipip: Provide ferm MSS clamping support

b01bc11f87-+-P:openstack: observerenv: Stop logging clouds.yaml changes

c579a7f57e-+-O:openstack: Install OpenTofu in eqiad1

255075b80d-+-global_config: expose services for all analytics mariadb hosts and masters

e31f881f59-+-Remove iegreview module

756c7a0c44-+-wmflib: add Wmflib::IP::Address::CIDR type

09ff2c7197-+-P:openstack: opentofu: Add a diff job to catch unapplied changes

4c838b3679-+-P:openstack: opentofu: Add a variable for region

f4be12d9c4-+-Revert "Temporary monitoring for scraper"

37b4706d38-+-webperf: don't hardcode php version

00b5ad4859-+-P:openstack: opentofu: Do not log changes to the env file

e35ba633d6-+-P:openstack: opentofu: Allow everyone to enter the directory

4ab71fde1e-+-gitlab: use IPv4 for SSH check temporarily

81cd803e25-+-gitlab:: add blackbox check for ssh service

db08f49291-+-P:openstack: opentofu: fix configuration

1ec4e7ab93-+-etcd::v3: Allow all nodes of an etcd cluster to connect to each other

9b767e97ef-+-Deprecate system::role for wikikube roles

61b190e2b8-+-Deprecate system::role for search roles

50e65c684c-+-Remove profile::base::use_linux510_on_buster

4948b6be93-+-P:toolforge::prometheus: Add clarification comment

9854c19371-+-P:openstack: opentofu: Fix config file location

52fee47efa-+-P:openstack: New profile for running OpenTofu for Cloud VPS

ee29ef012a-+-lists: Remove `server_uses_stunnel` option

4caaf54de1-+-dbbackups: Upgrade db1239 to MariaDB 10.6

a8f1ffe66f-+-dbbackups: Remove all puppet references for db2097, db2098, db2099

fb1b39523e-+-dbbackups: Prepare db2099 for decommission

5401766687-+-dbbackups: Prepare for db2097 decommission

afab67591a-+-dbbackups: Prepare db2098 for decommission

785633782d-+-Keystone: map toolsbeta groups and users to keystone groups and users

2591c1034b-+-lists: Add option to block incoming mail

7e5897bf15-+-docker_registry_ha: Fix nginx conf file path

083654d477-+-docker_registry_ha: Puppetize nginx config

e04967dba5-+-[geoip::data::maxmind::ipinfo]: Use GeoLite2 instead of Enterprise data

a6faf02708-+-peopleweb: fix file permission and typo in script config

5bd1c43c87-+-peopleweb: introduce script to warn about large user home dirs

13296544c1-+-ncmonitor: Add SSH credentials support

205aeeb9b6-+-ncmonitor: Temporary removal of passwords lookup

71e0582a70-+-email: add node definitions for mx-in boxen

fd06677ea6-+-Revert "Temporarily disable XML dumps on snapshot hosts"

5b0e291add-+-phab: fix ferm ensure

bf97e004db-+-phab: query for inbound mail servers

653a68b67e-+-profile::maps::tlsproxy: add SAN to CFSSL TLS cert

0f86e45720-+-Add new ping servers to site.pp

4bc7453ccb-+-Prepare stat100[4-7] for decommissioning

ec044e06bc-+-kubernetes: rename and reimage 3 api appservers, 2 appservers

996070ef0b-+-Revert "mw1358: Put back insetup::serviceops"

bcca7da832-+-lists: Update the quickdatacopy to use /var/lib/mailman3

f19284f3de-+-Add wikidata history-dumps import to hdfs job

873dd33d9a-+-cephadm: allow ssh from all mgrs to all targets

7e8ce8555a-+-role::mail::mx: tag servers with mx_in

d5fa40117f-+-wdqs: rename journal hiera var & plumb thru fully

3baed15c6e-+-Remove temporary firewall rule for WDQS graph_split

fe4fb7479c-+-mw1358: Put back insetup::serviceops

e85f2475a5-+-puppetdb: Remove 'none' from puppet reports config when adding 'puppetdb'

9c13211044-+-puppetserver 'report' enum: allow 'none' as a value

029ba6a860-+-Remove absented rsync configs for deprecated dumps

a4ea23b4c5-+-ipip: Avoid puppet errors disabling rp_filter

9d00d860d7-+-Absent the rsync configuration for deprecated misc jobs

18a1fbe209-+-kubernetes: rename and repurpose 5 api appservers as k8s workers

8415026ef5-+-cache,hiera: Enable IPIP on text@ulsfo

757576a9b3-+-interface::clsact: Fix syntax error

a0f00e9ca7-+-memcached: Remove enable_16 option

43e6e4acf1-+-docker_registry_ha: replace deprecated /-/jwks endpoint on gitlab

4a1dcf824c-+-configmaster: Enable profile::auto_restarts::service for apache/Envoy

7415ac2a97-+-Deprecate system::role for mariadb roles

fd97d77690-+-Deprecate system::role for toolforge roles

61913a2387-+-Keystone: remove hack ensuring that project_id == project_name

1ea3e2a557-+-gerrit: add parameter to toggle lfs_replica_sync

abd530825c-+-Temporarily disable XML dumps on snapshot hosts

bfd794b366-+-New cephadm::rgw role

7d66b81f32-+-ceph: ssh_keys

404454bf02-+-rsyslog kafka_shipper: use the new global_entry function

74d1e69129-+-fifo_log_demux,ATS: Support prometheus and buffer options

6e0729c81f-+-apiserver: colocate API canary with scap proxy

7d428c044d-+-site.pp: Reorganize es7 codfw hosts

6c73cc120a-+-site.pp: Reorganize es6 codfw hosts

97c9ef0372-+-site.pp: Reorganize es7 hosts

d7bc754571-+-Temporary monitoring for scraper

4f2f8d05f4-+-mx: stop ignoring VRTS alias errors

b60a2526b2-+-vrts: Stop ignoring errors from alias sync

0cfa324214-+-rsyslog: fix undef var in global entry

38d27503d0-+-dbbackups: Migrate s1 backups to MariaDB 10.6

8302882a83-+-rsyslog: include slashes in program names

579fe9baea-+-global_config: register IP/port for the datahubsearch opensearch cluster

6f455d01b6-+-rsyslog: notify receiver on cert change

08bca35f72-+-P:idp::build remove duplicate rsync restart.

30a43acbfa-+-memcached::instance: add the actual datafile in the options

a87a1a54af-+-memcached: minor fixes in class and profile

79606176e9-+-profile::elasticsearch::cirrus: Remove obsolete http2 parameter

821e67f8d3-+-core_test.pp: Add MariaDB 10.11

68199d8076-+-gitlab: bump exporter version to v1.0.10

68c1986c2f-+-Deprecate system::role for backup roles

2cf01a07a3-+-cirrus: Remove update rate alert

2a29b7e51f-+-cirrus: Restrict saneitizer to private wikis

6b433fee73-+-lists::automation: add missing spaces before line breaks

0af259cb83-+-lists::automation: double quote end text to enable interpolation

ba2f26a2ac-+-purged: set use_pki to true for cp6001 in drmrs

8ac648cae1-+-lists::automation: fix heredoc syntax, remove double quotes

8cb2715bcc-+-lists::automation: don't try to write to logfile from command

be89bb6a94-+-lists/stewards: add timer to run mailman syncmembers for stewards-l

66dcc29d17-+-Remove statistics::wmde::wdcm

3e5cbd471c-+-dns::auth::monitoring: Avoid Ferm-specific syntax

37d4e8da76-+-nginx: Add SPDX headers

709b9400c5-+-Rename kubernetes2032 to wikikube-worker2002

b59ab935e4-+-tlsproxy: Add SPDX headers

5c0033670a-+-sites.pp: fix wikikube-master1001 role definition

8b9f6b6336-+-Add wikikube-ctrl100[1-3] as master_stacked 2

7219fb9fce-+-sslcert: Add SPDX headers

24dacbe3e5-+-gitlab: bump exporter version to v1.0.9

a87ea32c50-+-openstack::base Add SPDX headers

34f138b828-+-Send account check mails to SRE IF alias

e7b66ae75c-+-core_test.pp: Remove mariadb 10.2 and 10.3

8813238113-+-kafka::mirror: Remove obsolete class parameter

06207942bd-+-aptrepo: Avoid Ferm-specific syntax

dfc5a1ac82-+-wikilabels::session: Set now-required memcached_user

0c84fcf59f-+-maps: Don't pass additional server aliases when using PKI

9c88d3968e-+-memcached: add extstore option

81d75742db-+-lists: Fix typing on ensure in mailman::web

dfe7cc1765-+-P:toolforge:redis_sentinel: set redis timeout

ea28d54bc6-+-lists: Don't include automation in standby hosts

324f6267ee-+-maps::tlsproxy: Avoid Ferm-specific syntax

bb8033b14f-+-tlsproxy::localssl: Remove support for OCSP handling

147fa6c7b3-+-maps: Add option to use PKI

b98bab4025-+-Remove profile::zookeeper::firewall::srange

8c52f3c77b-+-Reapply "openstack::bobcat: apply cloud yaml patch""

aea1063e8f-+-Deprecate system::role for initial set of WMCS roles

5e15ae5f5c-+-Deprecate system::role for Blazegraph services

5083792ed7-+-P:cumin: fix support for aliasing LVS host classes

4c4d8cea52-+-ganeti: function to generate ganeti known hosts

1f0925a3a1-+-Remove remaining references to snapshot1008

4814e3b76d-+-lists: Don't try to remove the mtail user when monitoring is absent

9bea5d0ccf-+-lists: Remove 'hasstatus => false' from mailman service

346d1b95a2-+-P:cumin: add support for aliasing LVS host classes

3ac12a032e-+-openstack: wikitech: Do not log file diff

267026620e-+-wikitech: Fix missing param for '::openstack::wikitech::web'

7af5ce8bc1-+-wikitech: Add credentials for GitLab account blocking

42cc1dd12a-+-role: delete ci_test role, not used anymore

5b1c151090-+-Switch Typha firewall config to firewall::service

0b5566f34e-+-gitlab: bump exporter version to v1.0.6

1f438f4ea4-+-cloudweb: Enable profile::auto_restarts::service for FPM

f72ef924a6-+-lists: Add lists role to list2001

e4830f2d0f-+-prometheus::ops: scrape custom gitlab exporter

63e5698598-+-kafka::mirror: Drop support for non PKI configs

1abf81c749-+-prometheus: use 'prometheus' profile for k8s certs

f567376276-+-Rename kubernetes2023 to wikikube-worker2001

3a601681a3-+-profile::parsoid::mediawiki: Don't hardcode the PHP version

412400d9a0-+-postfix: pull certs directly from acme chief

4b77207a3c-+-Revert "openstack::bobcat: apply cloud yaml patch"

fcbafc1842-+-openstack::bobcat: apply cloud yaml patch

9eb5651628-+-site: remove contint1003 - former testing machine

8bfee36292-+-O:openstack: merge net_ovs role back to the main net one

1f7c490bb6-+-Revert "graphite: blackhole MediaWiki.rest_api metrics"

d8c9fe1c87-+-profile::kafka::broker: Drop support for non PKI configs

8e6de04314-+-Add wikikube-ctrl2003 as master_stacked

aae7b79202-+-P:simplelamp2: set missing memcached_user

b832f56997-+-Add wikikube-ctrl2002 as master_stacked

375f28aaf6-+-Remove the last of the reportupdater resources in puppet

30b427bd20-+-Absent last remaining reportupdater resources

035656d080-+-P:dumps::distribution::nfs: use networks class for WMCS network ranges

8da162408b-+-Add wikikube-ctrl200[1-3] as master_stacked

e5027e149c-+-Automatically restart memcached/mcrouter on idp-test nodes

7a4425764e-+-Enable profile::auto_restarts::service for rsync/idp-test

e950c8b946-+-docker-gc: Use 1.3.0 image

d9eb2266a0-+-Add a new function to return the wiki PHP version currently in use

8e8d558628-+-arclamp: Update description for k8s values

a8e2bdea4f-+-gitlab: bump exporter version to v1.0.5

43e5268378-+-site: Move cloudnet2006-dev to OVS

dcbadfe7fb-+-P:openstack: cloudweb_mcrouter: fix setting user on codfw1dev

3c65cd216e-+-Exclude reportupdater from an-launcher1002

c9157ee446-+-site: Move cloudnet1006 to net_ovs

30aa93aab8-+-site: Move cloudnet1006 to insetup_noferm

1cbd45990c-+-appservers: 6 wikikube-ctrl to insetup before reimaging

a1b6b1a6dd-+-P:openstack: neutron: fix interface driver in eqiad1

39913a792d-+-Run Gobblin later to let time for Canary events

5a8fa6c368-+-Undeploy openldap prometheus exporter

dbaa32a21e-+-site: Move cloudnet1005 to OVS agent

fa2161fcc4-+-Pass Druid middle manager ports as port range

48d3ebbf3b-+-Add new role: kubernetes::master_stacked

3448324288-+-memcached: add memcached_user option

fd3b4024cc-+-site: Move cloudnet1005 to insetup_noferm to prep for OVS

25de3b948e-+-Remove role etcd::v3::kubernetes::staging

967612840b-+-memcached/mcrouter: remove onhost memcached

e0e19d4b50-+-P:ganeti Prometheus monitoring of ganeti noded services.

78d7d42912-+-P:idm Use account login page for monitoring.

19c92f209d-+-vrts: aesthetic code improvements

145f24941b-+-mariadb: Bump alerting for replag

e50fa77c26-+-lists: add timer to sync data from stewards hosts

b3b09b1dfb-+-cache:benthos: test for socket based activation in Benthos

41f7f0f8f2-+-lvs::realserver::ipip: Disable rp_filter without reboot

8beabb39db-+-zookeeper: fix logging on Bookworm

21c24c312b-+-postgresql: install configuration before starting the server

83387dde75-+-elastic: only alert on update rate in eqiad

812f41136d-+-logstash: test ecs 1.11.0-7 on beta-logs

9812c83409-+-stewards: make rsync server listen on IPv6 as well, not just 0.0.0.0

fb5de28cb5-+-stewards: add rsync server, let lists primary host pull data

4643e5aff2-+-lists: move definition of primary and standby host to common hiera

e2091d106f-+-postfix: prometheus ops config for mx-out boxes

01fe5b4a00-+-Remove remaining occurrences of kubernetes::staging::master role

1eea7f874b-+-Decom kubestagetcd100[123]

5700a08224-+-profile::amd_gpu: refactor configurations for k8s nodes

b780d69dbb-+-Decom kubestagemaster100[12]

e5e3574bb0-+-Add kubestagemaster100[345] as master_stacked

1c0990a228-+-Decom kubestagetcd200[123]

13f6fdb2c2-+-site.pp: Reorganize es6 hosts

9e94dcd1a1-+-site.pp: Reorganize es5 hosts

52d9b91b86-+-gerrit: fix team name for https monitor alerting

3e76ee0c27-+-Move dumps::generation::worker::dumper_misc_crons_only role

cfd2b6fcf4-+-prometheus::lvs: Fetch MSS using getsockopt()

9242ee7ab7-+-prometheus/ops: Refactor etcd scraping, fix hostnames

a6369dc090-+-prometheus/ops: Refactor etcd scraping

35fb05d929-+-O:wmcs::openstack: add eqiad1 net_ovs role

f826791ddf-+-P:openstack: neutron: add ovs config to eqiad1 profiles

1d643fbfb6-+-openstack: neutron: ovs_agent: Restart on config file change

78bf2e3366-+-P:openstack: neutron: add required control plane config for OVS

01aaf8de2d-+-gitlab: bump exporter version to v1.0.4

b707d420f0-+-graphite: blackhole MediaWiki.rest_api metrics

0f18cdd308-+-site.pp: Reorganize es5 definitions

b2efca1157-+-site.pp: Reorganize es4 definitions

e8259f6731-+-zuul: add DNS lookup for gearman server IP

abbeba26f6-+-ci: avoid hardcoded IP in Hiera, lookup contint.wikimedia.org

038674b7b3-+-Rip out code for cinder-backup

4fcb9f26b7-+-Revert "mx: Stop ignoring errors from alias sync"

40920deea2-+-mx: Stop ignoring errors from alias sync

0284f1dca7-+-pybal,wmflib: Allow toggling IPIP per site and svc

4c4e96e939-+-Remove auto restarts for containerd/docker

9b4dfe18be-+-kubernetes::master: Make etcd_urls optional

ed173e83f3-+-standard_packages: Remove more obsolete packages after buster->bullseye update

2045cb8d03-+-Zookeeper: New options for using firewall::service

8ee5446788-+-Decom kubestagemaster200[12]

fb1330dd77-+-gitlab: bump exporter version to v1.0.3

f0aaf0ff4d-+-parsoid/testing: Enable profile::auto_restarts::service for envoy

5e1177fd90-+-lists: start a class for automating certain subscriptions

baab2138e9-+-add kafka-main[12]006-10 to site.pp

57668bd968-+-pyrra: linkrecommendation: onboard slo from grizzly

735f0a6350-+-gitlab: enable custom exporter on all instances

cdffe931ee-+-hieradata: Move acme certificates to its own file

c25614b52f-+-pyrra-filesystem: set prom url to local thanos rule instance

7ba758a78a-+-gerrit::migration: Let rsync handle the firewall rules

b1e93670a2-+-prometheus::ops: Filter lvs_realserver_clamper by enabled parameters

798e8ca60e-+-Add kubestagemaster2005 as master_stacked

db515c817a-+-kubernetes: Space out ferm icinga check

7538c1d43f-+-cache: Enable IPIP encapsulation on upload@ulsfo

16aa0a7552-+-lvs: Skip ferm rules if firewall provider is not ferm

15c5fd7ab5-+-standard_packages: Remove more obsolete packages after buster->bullseye update

3aadc8b495-+-Allow systemd::timer::job to send from a custom address

fe82b38ad4-+-Inline profile::swift::proxy_tls

0ea587603e-+-Manage the directory for dumps.wikimedia.org logs on stat1011

a28d6edd9c-+-Improve dumps::web::rsync::nginxlogs management

219e14f178-+-profile::swift::proxy_tls: Use Envoy unconditionally and drop Hiera flag

371ff5de19-+-ci: Enable profile::auto_restarts::service for docker/containerd

7f38687add-+-site.pp: Clarify the status of each section

58afb99b0e-+-Add kubestagemaster2004 as master_stacked

7588cf95e4-+-Add kubestagemaster100[345]

a2e2cde9f4-+-Add the airflow profile to the statistics::explorer role

7bf8cec181-+-site.pp: Regex for es6 and es7

8f2688a94b-+-Openstack: remove obsolete files/templates/manifests for version 'zed'

48b92a81a5-+-Deprecate system::role for Cassandra services

43a2f66d50-+-squid_exporter: Remove some outdated comments

30eb273eae-+-Add kubestagemaster200[45] as insetup::serviceops

244c7966da-+-druid: Remove support for using ferm firewall definitions

dab4d8c238-+-Remove the piwik role and profile

2744cb7d01-+-Update the email address for data-engineering-alerts

f8a6f9e4b4-+-profile::frtech::kafka_certificate: Fix owner

e45b354a33-+-Add a class to Cumin hosts which generates a Kafka certificate for frtech

2d96185ad9-+-Create /srv/analytics-wmde on stat1011

de6c8c85f7-+-Move stats misc_jobs from stat1007 to stat1011

719e51b7ad-+-Move snapshot1009 to insetup::data_engineering

939106cb40-+-elasticsearch::tlsproxy: Stop passing certs to tlsproxy::localssl

370ada65d8-+-Deprecate system::role for o11y services

96e2cd771c-+-hadoop: make analytics DB password available to analytics-product user

ffe0b2499e-+-mariadb::ferm_idm: Avoid Ferm-specific syntax

553711a8d9-+-pyrra: trafficserver: onboard slo from grizzly

9b2138ae1a-+-postfix: change acme chief cert order for Postfix

6cc7c5f45d-+-Revert "prometheus: use longer-expiration pki client certs for k8s"

667d72ab74-+-Revert "postfix: chance acme chief cert order for Postfix"

079ef76506-+-postfix: chance acme chief cert order for Postfix

9acb91a48f-+-postfix: bump postfix version

c8648184a2-+-Remove references to cloudcontrol2001-dev

15dc109cf3-+-pyrra: varnish: add cluster

63ca7b96c7-+-pyrra: onboard haproxy slo from grizzly

c93d9b8af5-+-Revert "Revert "Replace cloudcontrol2001-dev with cloudcontrol2006-dev""

6cc24b5fe7-+-Revert "Replace cloudcontrol2001-dev with cloudcontrol2006-dev"

b988a43b9a-+-Replace cloudcontrol2001-dev with cloudcontrol2006-dev

22219cedda-+-site: Move cloudnet2005-dev to OVS

4545ad3e02-+-site: Move cloudnet2007/8-dev back to insetup

3c93a8fa8a-+-Drop the deprecated dumps fetcher that pulls from stat1007

63dc68e08a-+-fifo-log-demux: removed unused resources

34ed3ff9d6-+-apt-staging: Add timer for gitlab package puller job

1d1d32c6bd-+-mariadb: Upgrade db1150, db1171 and move s4, s7, s8 backups to 10.6

f18e31ba83-+-ci: include envoyproxy in ci_test role

38b333a41a-+-wdqs: remove refs to query_service::deploy::manual

28154868a6-+-Revert "fifo_log_demux,ATS: Support fifo-log-demux 0.7.3"

3ee9a54f5a-+-fifo_log_demux,ATS: Support fifo-log-demux 0.7.3

9cfb75a040-+-Druid: historical/middlemanager: New options for using firewall::service

5c183464bc-+-kubernetes: make 6 codfw api appservers k8s workers

fa34ff14d9-+-query_service: Stop installing git-fat

874398fb0c-+-query_sever::deploy::manual: Remove obsolete class

83a41abb14-+-pyrra: logstash: add generic rules workaround

7436abfeb2-+-ci: Enable profile::auto_restarts::service for envoy

ee094db313-+-pyrra: etcd: add generic rules workaround

8854fb784b-+-pyrra: varnish: workaround site grouping limitation

811d26c861-+-Stop installing git-fat also on Buster hosts

2e843fee80-+-Enable profile::auto_restarts::service for chartmuseum

9949e46a07-+-chartmuseum: Enable profile::auto_restarts::service for envoyproxy

424973c27d-+-postfix: add some recommended hardening settings

429c96d87e-+-Revert "site: provision prometheus7001 with insetup"

c79ac77f50-+-purged: add PKI cert handling

1fedc856d1-+-Revert "Update analytics import-mediawiki-dumps"

4475113434-+-global_config: add elasticearch instances

398caf5cc5-+-Stop installing git-fat on Cassandra hosts

1507a70518-+-Update analytics import-mediawiki-dumps

aa97e90807-+-Stop supporting sslcert in Profile::Pki::Provider type

de4a9af3da-+-ncredir: Remove mtail puppetization

edc07a69a3-+-elasticsearch: Remove support for sslcert SSL provider

2d7039ed3f-+-kubernetes: add 6 codfw appservers as workers

6f3e9e0d59-+-prometheus::ops: Remove ncredir job

b41c061bc5-+-Update prometheus config to reflect matomo profile change

dd4315f161-+-prometheus: use longer-expiration pki client certs for k8s

28992c7fe5-+-Enable profile::auto_restarts::service for docker/containerd

8a6bdc7c98-+-cloudweb: Enable profile::auto_restarts::service for nutcracker

76a75bd410-+-prometheus: assemble snmp.yml when updating modules

418fe23bc9-+-Make caps an optional parameter to the Ceph::Auth::ClientAuth type

78eef9b0e3-+-prometheus: use datacenters for snmp_exporter

fd68de1d2b-+-global_config: Only expose the IP of the analytics meta master

ba4f205616-+-pyrra: etcd: add namespace

860bcf31ae-+-pyrra: onboard etcd request/latency SLOs

1a46490681-+-pyrra: separate slo definitions from filesystem class

79faa922a8-+-postfix: add sasl auth header

8a98b968af-+-postfix: sasl ensure auth user matches from

6661c8f86c-+-pcc: fix delete-canceled-pcc-run-dirs timer

84313ef59c-+-add btop to standard packages for bookworm+

8f8d85e979-+-site: provision prometheus7001 with insetup

f5803e3491-+-site: add prometheus7001

3d57232d75-+-Make install7001 an installserver

5d541c18b7-+-gitlab: add option to run a custom exporter

ec87c63f97-+-wdqs: switch wdqs2023 to graph split host

5e73c8858c-+-phabricator: increase phabricator page delay to 4m

e5bc3cf3e3-+-elastic: remove backend failure check

8503219001-+-Remove entries for lsw1-a1-codfw and private1-a1-codfw

f13095cbc4-+-Make bast7001 a bastion

337f47f340-+-Use buildkit wmf-v0.13.2-1 on WMCS and trusted runners

5cb1cad22b-+-Add bast7001 to site.pp

abc4b047bd-+-Add install7001 to site.pp

4df7e09117-+-Make ganeti7004 a Ganeti node

f8e17d9428-+-Make ganeti7002 a Ganeti node

69f44af38d-+-Automate quarterly Phabricator data for WMF QLS

b4e9bd58df-+-Update the path of the readme file for commons impact metrics

5efa88a1c5-+-Change the destination directory for commons impact metrics dumps

115ed54140-+-Druid: overlord/coordinator: New options for using firewall::service

4a88044c5e-+-Make ganeti7003 as Ganeti node

a1baaecdfd-+-P:idm, add LDAP authentication dependencies.

e3a50db71f-+-Deprecate system::role for Traffic services

0325479b36-+-k8s: move 5 eqiad appservers to kubernetes

5d124a7f8f-+-Make ganeti7001 a Ganeti node

c6e18600c9-+-Add the commons impact metrics dumps fetcher and readme

66c4b15e1e-+-CloudIDM, Install Bitu for labtest

e962061948-+-lists: Add collaboration services as owner

c7692a67a7-+-cfssl::cert: Add before_services parameter

a55892b07f-+-mx-out: acmechief config

ab7c50f529-+-postfix: take mx_out boxes out of insetup

7c37bc224c-+-postfix: mx_out role

45042593b6-+-P:dns::update: specify /usr/bin/test instead of test

042c497667-+-P:dns::auth::update: add unless on authdns-local-update

d972134259-+-cephadm: new modules, profile, roles for cephadm-based Ceph clusters

fe30a86715-+-Remove the cephadm role

1abcf1cb35-+-mariadb: Productionize codfw es7 servers

092e1fb5c5-+-magru: add lvs700[1-3] and related configuration

bd41744816-+-deployment server: Run scap clean auto on a weekly basis

e395e447dd-+-elasticsearch: Configure alerts for short-lived certs

78f9eca856-+-phabricator::logmail: parameterize sender adddress for stats mails

66fc02922f-+-updateQueryServiceLag: tune the min query rate of a pooled server

1df730dc6e-+-openstack::horizon::config: notify docker service instead of Apache

df82eda7f6-+-deployment_server: stop including redis::client::python

d469f0215f-+-etcdmirror: reconfigure with full-keyspace replication

ab11781f99-+-etcdmirror::instance: absent all resources

debafc7fe6-+-deployment_server: stop installing python-gitdb, python-git

9d6f3fb8c9-+-Test a fix for the bootstrapping of mon daemons on cephosd*

5fcc770bc3-+-magru: add cp nodes text: cp700[1-8] and upload: cp70(09|1[0-6])

840105c773-+-dbbackups: Setup dbprov1006 & dbprov2006 and do s4 & s7 dumps there

7789497ced-+-apt-staging: Add access token for gitlab package puller

ff68da8d7c-+-Add ganeti700[1-4] to site.pp

6ccfba3228-+-druid::broker: Switch to firewall::service for test_analytics

5c601138c9-+-Allow the ceph-common package to create the ceph user/group

3e4c25a937-+-mariadb: Add es7 eqiad servers

8fce14be0c-+-cloudweb: Enable profile::auto_restarts::service for apache/envoy

ca6295cb19-+-Enable profile::auto_restarts::service for alertmanager-webhook-logger

59eb688b49-+-kerberos: Avoid Ferm-specific syntax

6e0fabd971-+-netbox-standalone: Enable profile::auto_restarts::service for Redis

e9ca57182d-+-arclamp: Enable profile::auto_restarts::service for Redis

d1367901e2-+-Enable profile::auto_restarts::service for Benthos instances

bdf2f48c32-+-netbox::standalone: Enable profile::auto_restarts::service for postgres

606c45e203-+-Deprecate system::role for Collaboration services (batch two)

e742d13655-+-site.pp: add cp7004

c473afafff-+-site: adding cp7003.magru.wmnet for test insetup role

abc4fe7937-+-miscweb: Enable profile::auto_restarts::service for rsync

07a4faae4f-+-site.pp: set role insetup for cp7002

0c0e175c54-+-kubernetes::master: Add stacked control plane option

95dd12bd1c-+-etcd::v3: Allow prometheus nodes to scrape etcd

b633ead36f-+-Fix the ceph osd activate command for hdd devices

069b185b17-+-P:cache::varnish::frontend: set esitest to absent by default

101df41a34-+-global_config: add analytics mariadb/postgresql instances

cd514c038a-+-Avoid divide by zero errors if ceph_disks fact is not yet available

5a8526f839-+-Fix the cephosd reimage process

c853523de2-+-valid_section.pp: Add es6 and es7

8815947616-+-mariadb: Productionize es6

d4f56c1cc2-+-Fix the cephosd server reimages

f87efee511-+-Kubernetes: Drop unused etcd_srv_name

5acd0d35e7-+-Add magru network to monitoring

3515fb4e36-+-Revert temporary monitoring for scraper

8fd6586aba-+-Add cp7001 to site.pp

190c79d11e-+-cassandra_dev: fix permissions on credentials file

43142e914b-+-cassandra_dev: rename surrogate user

cf76aafefa-+-cassandra-dev: ensure directory exists before adding files

3f2b5f0d88-+-cassandra-dev: surrogate user for cqlsh (dev access)

97e3f8a314-+-mailman: Change ownership of lists hosts to sre-collab and rename

65fc7f38d7-+-Add a basic role for ceph:cephadm

58c6bdc66d-+-Absent all report-updater jobs

660b14c4d3-+-kubestagemaster2003: Add as insetup::serviceops

10e6f16d1b-+-Only enable auto vopsbot restart on active alert host

284aa2ec4f-+-releases: Enable profile::auto_restarts::service for docker/containerd

038be309c9-+-redis: use python3-redis to support bullseye

9a86070328-+-Postfix profile

10f19c0032-+-builder: Enable profile::auto_restarts::service for rsync

cf1456145a-+-idp-build: Enable profile::auto_restarts::service for rsync

3e06f2aca1-+-Enable profile::auto_restarts::service for kadmind

235b2a66c8-+-Add an option to pass the Druid firewall settings compatible with nftables

cdc7e2d981-+-an-web: Enable profile::auto_restarts::service for rsync

1424be245c-+-Enable profile::auto_restarts::service for karapace

5fea30da38-+-Enable profile::auto_restarts::service for rsync on stat hosts

fc71be6bd7-+-Add server aliases to the cirrus/cfssl proxy config

6b08a7baaa-+-apt_staging: Enable profile::auto_restarts::service for rsync/nginx/envoy

f146a3a3f5-+-Enable profile::auto_restarts::service for vopsbot

52a152f79f-+-idm::redis: Fix name for Redis auto restart

9eb215e516-+-elastic: bring elastic110[3-7] into svc

b5c81b9026-+-Revert "prometheus: Ensure TLS certificates are provided by CFSSL"

31c8bcd0e6-+-prometheus: Ensure TLS certificates are provided by CFSSL

6e8912893c-+-vrts: fix time limit on generating aliases

13e363d1ad-+-Enable profile::auto_restarts::service for prometheus-logstash-exporter

7b610ec984-+-Enable profile::auto_restarts::service for testreduce/Envoy

baf2895307-+-P:idm Allow enable API on test server

0b7f2a6e9b-+-Stop including idp-build in the idp-test role

57ecc2c7d1-+-kubernetes: add rsyslog imfile remedy to nodes

443fca6866-+-toil: add rsyslog_imfile_remedy

aceb8d94b2-+-Enable profile::auto_restarts::service for uwsgi-bitu

e0a2dd2fde-+-Enable profile::auto_restarts::service for titan/Envoy

1819220fae-+-Revert: kubernetes::node restart rsyslog if too many fd's are blocked by inotify

34caf38169-+-Enable profile::auto_restarts::service for redis/idm

ea5783c345-+-heat: Avoid Ferm-specific syntax

397c16db6c-+-stewards: remove "recurse" parameter on private repo dir

4430663d2b-+-stewards: Mark steward repos as safe

6d41e93843-+-stewards: move pathes to parameters with lookups

9e76daa789-+-stewards: create a local git repo for user db data

7151e05bb5-+-fifo_log_demux: Create fifo iff ensure = present

b3ce67de30-+-ncredir,benthos: Provide benthos support on ncredir

b9e9930e52-+-Include job for scraper monitoring

7ca0f4481f-+-profile::benthos: Don't require kafka config

ac3ccc1db0-+-Temporary monitoring for long-running analytics client job

0dc0d6fdbd-+-kubernetes: move 5 eqiad appservers to kubernetes

060c20e10e-+-Add the verbose flag to the geoipupdate command

a66551a769-+-deployment_server: Add Cassandra to autogenerated external svcs

8f14c7ad00-+-puppetserver::wmcs: add wmf_auto_restarts timer

e48cdcee96-+-benthos/haproxy: using hiera aliases for benthos socket address

b1721a0871-+-crm: Shift http web_root and site_name to hiera lookups

4a9282d360-+-openstack: neutron: Connect OVS agents to provider networks

2114510b7c-+-Switch matomo1002 to the insetup::data_engineering role

9171376726-+-openstack: neutron: set dhcp interface driver correctly

b9de3b6152-+-P:idm Make some parameters optional.

dbf06a1254-+-O:wmcs: codfw1dev: net_ovs: install dhcp and metadata agents

ffd486dc49-+-libraryupgrader: Add missing --auto to command line

965973f815-+-graphite: avoid including multiple roles, define primary host in hiera

7d5ab1ad16-+-site.pp: add entries for two new sets of cloudcephosd hosts

add8b7bfdc-+-move elastic2088 back into production

a3edf4a1c8-+-openstack: neutron: Fix firewall driver with openvswitch

afb7ac14bd-+-kubernetes: move 4 appservers to kubernetes

8705d8f08e-+-mariadb: removes db2103

1b456d5c17-+-mariadb: removes db2105

59d97a3fab-+-mariadb: removes db2106

70f48a6bb7-+-mariadb: removes db2107

60601adb77-+-Update yarn scheduler's queues configuration

c9e95bcecd-+-mariadb: Set up dedicated cumin user

909fbc67df-+-kubernetes: move 6 appservers from codfw

d8afdfee9a-+-kubernetes::node: Remove apparmor cleanup code

ce61b6f735-+-mariadb: removes db2108

51f0940970-+-mariadb: removes db2109

d11cb30b51-+-mariadb: removes db2110

91ade543a4-+-mariadb: removes db2111

971ec0990e-+-mariadb: removes db2112

1d2954cd8c-+-dbbackups: Setup dbprov1005 as new host to send s3 and s5 backups

37131a8411-+-mariadb: removes db2113

51bdd80826-+-P:toolforge::bastion: install locales-all

8a0af8fec6-+-mariadb: removes db2119

c8debe6f58-+-mariadb: remove db2120

82af693aa8-+-P:toolforge::bastion: add rsync

91e33ebb2c-+-query_service: enable CPU performance governor for w[cd]qs

b0277fa0ea-+-realm: fix consistency for site IPs

b48874a815-+-Puppet: add magru

590ff87f77-+-apparmor::profile: Don't try to define /etc/apparmor.d resource

88c4af585a-+-kubernetes::node: Ensure apparmor profiles are loaded automatically

fb4f9909f3-+-alertmanager: Avoid Ferm-specific syntax

34977ae793-+-Install a matomo plugin on the new host

d6bf633d59-+-Only install Go from backports on bullseye-based stat hosts

52db6c17ca-+-site.pp: Reorder backup sources by server name and update comments

afb90e8b99-+-Revert "site.pp: move elastic2088 back into production"

9891526ffa-+-site.pp: move elastic2088 back into production

bd923f04a1-+-Add cloudcontrol2009 to site.pp and preseed.yaml

0b5434ae21-+-zuul: require python2.7

2d91865a45-+-Elastic: unique systemd timer name per cluster

dc1951d4a9-+-neutron/bobcat: remove an l3 conf override hack

1820d1edc0-+-elasticsearch: prevent cross cluster seed config drift

193bbacc1c-+-openstacksdk/bobcat: remove sdk hack about clouds.yaml load ordering

1bd2d37ed8-+-bobcat cinder: remove backup scheduler hack

a782b2b510-+-cinder/bobcat: remove volume_type_access hack

19144b3885-+-New files/templates for OpenStack Bobcat (2023.2)

47d45cd7d9-+-Schedule weekly purge of global_block_whitelist

d5cb7c37fb-+-icinga: use rsync::server::module auto_firewall

e666cb0c6c-+-alertmanager: fix srange for irc webhook

02e2458700-+-alertmanager: avoid ferm-specific syntax for irc webhook

6b98723372-+-Pass the Ceph cluster address as an array

42035c5c7c-+-R:idm, prepare for Bitu installation for labtestwikitech.

bfc83924f9-+-site.pp, remove redundant idp-test definition

960bfedba5-+-Remove obsolete apt::pin for buster-backports

85f94c09d3-+-beta::mediawiki_packages: Install lilypond from component

c299746be1-+-query_service: refactoring 'query_service::monitor::updater'

ad3333aa67-+-mariadb: Upgrade db2139 to MariaDB 10.6

50f432c03f-+-mariadb: Fully remove db2101 from puppet

45ede64002-+-mariadb: Remove db2101 from services

c1363d24c8-+-profile::wmcs::backup_cinder_volumes: remove remove-unhandled-backups timer

f9717ec2ea-+-analytics: refinery: add webrequest_frontend timer

63b1b0e761-+-wmflib: add magru to sites

357fe2df42-+-Only add backports on Bullseye/Bookworm

00cdd90970-+-oauth2_proxy: default to all email domains

724014b3e2-+-opensearch: skip auth for healtcheck endpoints

bcf74d8d7b-+-dbprov: Setup dbprov2005

2666b9668d-+-comments: correct typos of "top" for "to"

9e437af162-+-icinga: Avoid Ferm-specific syntax

259a8af6bf-+-Deprecate system::role for IF services (batch three)

d57045e2e6-+-postfix: prometheus exporter

49d781f441-+-otrs.conf: rename and tighten up epp type definitions

28a628f033-+-vrts: create a profile for alias generation

b43fb41bcc-+-Remove refs to decom'd cloudbackup200[12]

6d7d5c0557-+-community-crm: enable envoy

77fd1cd240-+-opensearch: bump curator version to wmf4

26dd35482e-+-kubeadm::worker: increase the limit of inotify user instances

5594066178-+-Remove remaining diamond leftovers

a0327c7414-+-Switch moss nodes away from insetup::buster

254bfb06f4-+-kubernetes::master: Forward audit logs to kafka

1234b88154-+-Prepare cloudbackup200[12] for decom

5d7435cbfd-+-Revert "purged: add PKI cert handling"

a461a13685-+-purged: add PKI cert handling

d33ad27050-+-cache: Add SPDX headers

c16b0a1a99-+-trafficserver: Add SPDX headers

75057e3cc4-+-Add public testvm200x support

606596519f-+-Use a more WMF standard mariadb configuration for Matomo

1b0fd20f82-+-kubernetes: Move 7 codfw appservers to kubernetes

395db1a90b-+-add_ip6_mapped - don't fail if the host already have a /128 address

379b19c672-+-R:idp decommision Bullseye IDP hosts.

3519182439-+-Blacklist n_gsm kernel module

ead8bda932-+-Create a new and profile for the new matomo server

23c056a7ed-+-ncredir: Set ssl_ciphersuite to strong

5190d48bf4-+-configmaster: Avoid Ferm-specific syntax

4b334a811b-+-cassandra::instance: fix PKI keystore for each instance

3275380701-+-Uninstall eject on production VMs

7f385e4d80-+-opensearch: set vhost and issuer url for dashboards sso test

2a15672987-+-P:wmcs::striker::docker: bind on 0.0.0.0 instead

38cc7ff2a7-+-P:wmcs::striker: Set the port to bind on

f23b71ab8f-+-kubernetes: move 6 eqiad api_appservers to kubernetes

6d49d8f1fb-+-hieradata: Add Striker toolsbeta instance

b6943b293c-+-docker_registry_ha: Migrate to cfssl

a90779d81a-+-opensearch: use Sensitive[String] for sso secrets

ff074deb55-+-P:wmcs::striker: add support for multiple instances

617cd82bb3-+-opensearch: fix sso support

1be51c0820-+-Use oauth2-proxy for opensearch dashboards

3a12893a9c-+-gitlab: Fix typo in systemctl timer command

d8a99b9d2b-+-C:idm::deployment Add Django REST Framework.

57369bb667-+-puppetdb::microservice: Use firewall::service

80944b2f00-+-Add a role for matomo1003

4df489af24-+-gitlab: Switch rsync command in timer to run script

c1c8f81249-+-hieradata: cloudcumin: Configure metricsinfra alertmanager instance

077c494161-+-profile::prometheus::analytics: remove old metric relabeling

87e3cb5b2e-+-alertmanager: karma: Add metricsinfra write credentials

ae3053df80-+-installserver: Avoid Ferm-specific syntax

5cf11534d8-+-P:wmcs::metricsinfra::alertmanager: add basic auth support

4152cc54f2-+-[gitlab] Add shell script to replace rsync bare commands

cbff5f215c-+-node-exporter: ignore run/credentials mountpoint

8cb39b2a6c-+-stewards: add config and export dirs, steward onboarder config

e5ed6735e1-+-wdqs: decom wdqs1025

5ef3603a9d-+-Prepare dumpsdata100[1-2] for decommissioning

f9b1a35083-+-P:wmcs::metricsinfra::haproxy: move domains to configuration

ed4d182fb7-+-P:wmcs::metricsinfra::haproxy: drop buster support

3900b43c4f-+-P:wmcs::metricsinfra::alertmanager: rename project_proxy as api_rw_proxy

edc1899013-+-mariadb: hotfix mysqld-exporter-config.yaml

037894d8ef-+-mysqld-exporter-config: simplify manual runs

fd5f2653b2-+-Deprecate system::role for Collaboration services (batch one)

28b78bcdf2-+-Tighten data type for profile::icinga::partners

a142edf3c3-+-barbican: Avoid Ferm-specific syntax

f52d2e510a-+-mx: Avoid Ferm-specific syntax

3dcdd5fc42-+-P:idp Disable Bullseye hosts.

6b6241b0be-+-Deprecate system::role for IF services (batch two)

8eb8a2c3ce-+-cinder_backups: apply codfw1dev env files for eqiad backup hosts

979271162e-+-codesearch: Allow local containers to talk to local Hound proxy

0ef188d35a-+-role:cinder_backups: include full env scripts in codfw1dev

7fc99b3465-+-email: add node definitions for mx-out boxes

9fdba1ef49-+-cassandra::instance: add the tls_use_pki_keep_old_ca parameter

411fe06ec8-+-mariadb: Prepare dbproxy installations

68393213b8-+-Revert "Uninstall eject on VMs"

961e2f9c94-+-cloud-vps instances: ensure cloud-init is forever installed

d99cf9f02e-+-Add cv and drush bin dirs to PATH on community crm

2f3a10cdac-+-gitlab: remove duplicate key type from gitlab known_hosts

ca540472f8-+-cloudceph::osd: Avoid Ferm-specific syntax

72332149d1-+-cloudceph::mon: Avoid Ferm-specific syntax

ee9e775e27-+-site.pp: Remove db2104

225b741b53-+-site.pp: cleanup restbase10[19-27]

8b23cbb0ec-+-restbase: remove decommissioned hosts restbase10[19-27]

29d58c09e2-+-logstash: provision and commission logging-hd200[123] nodes

5109bf48ac-+-Make cloudbackup200[12]-dev into codfw1dev cinder backup hosts

743cb11f6e-+-cinder backups: move schedule config from a template into hiera

1f90e642c5-+-role:cinder_backups: include full env scripts

fa1c005c35-+-aqs: Remove ferm service

c05cdad1d7-+-Decommission an-coord100[12]

b3f01741e8-+-Remove now obsolete site.pp entry

b96bb7e57b-+-containerd: export the crictl endpoint in profile.d

e3ee6dc0f4-+-k8s/apiserver: Add option to configure audit logging

22356a4320-+-Remove puppetmaster1002 from site.pp

5da7cdfb2c-+-Upgrade clouddb2002-dev to MariaDB 10.6

800ff07356-+-mariadb: removes db2100 after memory failure

4566393c68-+-elastic: rpl custom 3rdparty curator w deb default

9d3bfce711-+-elastic: move failing host elastic2088 to insetup

1fd384abdb-+-MachineVision being sunsetted

0a8d27fd16-+-Uninstall eject on VMs

8ad6b35a31-+-profile::wmcs::kubeadm::etcd: install etcd package before referencing uid

7eced4dd60-+-ldap: Pass typed data to sssd class

0255bb67a3-+-profile::pki::multirootca::monitoring: rework prometheus-client pkg

8691bd6399-+-profile::pki::multirootca::monitoring: add workaround for python3-crypto

a4344bd1b8-+-miscweb: remove profile::microsites::security

1173d5696d-+-eqiad1::cinder_backups: include observerenv rather than envscripts

a05bfec049-+-role::wmcs::openstack::eqiad1::cinder_backups: include envscripts

bac2e81225-+-elastic: Add elastic2088 back to production

b109920736-+-libraryupgrader: Create /srv/git

18aa9f91a8-+-libraryupgrader: Use Keyholder to hold the key

9a4c502d07-+-prometheus: add config for scraping apache data on miscweb and rt

22dd7fe1ca-+-libraryupgrader: Use python3-venv instead

3a9c0978c2-+-prometheus: add config for scraping apache data on doc hosts

05e4c3da72-+-libraryupgrader: add toggle for worker services

cc48364960-+-libraryupgrader: remove libup-web config

f35639fa2d-+-libraryupgrader: base_dir is not optional

54154f9ed2-+-libraryupgrader: use system docker on newer Debian versions

dac6d9116a-+-Revert "profile::wmcs::kubeadm::etcd: install etcd package before referencing uid"

6d020066a4-+-profile::wmcs::kubeadm::etcd: install etcd package before referencing uid

835643f8cc-+-MachineVision extension is sunsetted

b4409aebee-+-MachineVision being sunsetted - remove dumps scripts

60fcf15718-+-etcd:v3: Don't rely on 'etcd' group or user before installing etcd package

2d43a729a5-+-requesttracker: include prometheus::apache_exporter

643a46ab18-+-miscweb: include prometheus::apache_exporter for dashboard data

f98d31b014-+-doc: include ::profile::prometheus::apache_exporter

2bc808ba65-+-backy2: apply fix-backy2-crypto-imports on Bookworm

dd6d41de9e-+-Revert "[gitlab] Narrow scope of gitlab backup rsync commands"

8d18e483eb-+-cloudbackup: put new cloudbackup hosts into service with minimal test load

8127cb8f7f-+-opensearch: ensure cluster_wide curator job absent

4e2a85a099-+-logstash: remove configuration for logstash101[012]

24ae93eb77-+-prometheus: add config to scrape apache data from releases servers

f5a4b54a2b-+-elastic: move elastic2088 to insetup

6acafde39b-+-releases: include ::profile::prometheus::apache_exporter

4ac073f1c0-+-Revert "puppetserver: use client certs for naggen2 puppetdb"

4eaec57776-+-[gitlab] Narrow scope of gitlab backup rsync commands

39d36d8591-+-puppetserver: use client certs for naggen2 puppetdb

a962312760-+-P:toolforge::proxy: remove unused hiera keys

2b083eeb56-+-hue: remove manifests and configuration

fc02ef9b29-+-elasticsearch: remove soon-to-be-decommed codfw hosts

9bfd289d47-+-peopleweb: include ::profile::prometheus::apache_exporter

1eb9734f5a-+-kubernetes::node restart rsyslog if too many fd's are blocked by inotify

d9ecba2319-+-P:puppetserver::git: do not mark directories as safe

05e805f665-+-wdqs: add x-monitoring-query

888e160fda-+-cloudnfs: Add missing dependency

8e25c15a81-+-Update the from_address for burrow notification emails

c4f95a966a-+-openstack: Restart designate-sink after changing hooks

5391746099-+-Add rclone to the list of packages to install on backup workers

f252c1d1ed-+-Remove old toolserver_legacy code

8be74be13d-+-P:openstack: puppetserver: fix to use IPs not hostnames

887e2b1789-+-Fixes for Puppet certificate cleaning on Puppet 7

62dca21672-+-deployment_server: Add external service block for Cassandra/ml-cache

98a26ffe3e-+-site: change an-tool1009 role back to insetup

070d643e3b-+-Decommission an-tool1010.eqiad.wmnet

816523292e-+-P:spicerack: add alertmanager instance config

306fbeefa2-+-trafficserver: miscweb(security) failover to kubernetes

2017de8baf-+-logstash: introduce java_package option

c688517fdd-+-logstash: enable openjdk-17 support

8f3f0cdac9-+-maintenance: Re-remove absented MachineVision_prioritize_uncategorized job

56f3f2e96d-+-P:pybal: install pystemd package for file monitoring

b8c7ca3855-+-P:pybal: add a check to ensure Pybal service has been restarted

ece506f149-+-maintenance: Absent the MachineVision_prioritize_uncategorized job

febc22fc66-+-O:wmcs::toolforge::docker::registry: remove apt pinning

918ea79400-+-P:pybal: fix regex for peer addresses for lvs2013 and 14

d345e28020-+-MachineVision is being sunsetted, so remove job

b82b2e9a05-+-snmp: instruct libsmi with snmp-mibs-downloader path

c7131e86ad-+-services_proxy: add support for split listeners

86d5b36f20-+-deployment_server: Fix structure for redis misc external services

7f90462636-+-Update the from address of all email from refinery jobs.

563ad8e6ec-+-deployment_server: Add redis misc instances to external_services

52c798e35c-+-P:toolforge::legacy_redirector: add monitoring

4e095b3164-+-opensearch: define elasticsearch curator version for bookworm

665ac08784-+-prometheus/ops: add config for scraping apache metrics on planet servers

046ac86a36-+-P:toolforge::legacy_redirector: add www.toolserver.org

9251ffb9ae-+-mediawiki: Get rid of purge flaggedrevs

eaad74286a-+-Revert "Revert "planet: add prometheus apache exporter to role""

c336a4f56e-+-prometheus/apache_exporter: drop argument parameter

0ece9931ac-+-aqs: fix puppet compilation error

756931fea0-+-base: remove profile::base::manage_timesyncd

8deb62a9a8-+-P:toolforge::legacy_redirector: drop buster support

e1267706e2-+-profile::prometheus::k8s: restrict targets for k8s-pods-istio

00ee2723da-+-mediawiki: Absent FR purge systemd timer

1d839e100e-+-profile::prometheus::k8s: move istio metrics to a separate job

8004a57465-+-P:toolforge: fix duplicate statement

8cb11b0493-+-P:toolforge::legacy_redirector: Use Apache on Bookworm

b80bc7937c-+-P:toolforge::legacy_redirector: Drop configuration

7f6fffd8b6-+-Superset: remove all resources from puppet

fc6f12c5b7-+-P:wmcs::metricsinfra: alertmanager: fix ordering issues

86106c075f-+-global_config: fix druid and presto configuration

872fe7c7d0-+-Use a routable sender address for email from Airflow

e4cb196b97-+-kubernetes: move 6 codfw appservers to kubernetes

379d833667-+-prometheus: scrape envoy on k8s metrics with 'usedonly' (take #2)

ee9134daa7-+-Routed Ganeti: use per tap interface dhcrelay

476242601a-+-site.pp: add insetup entries for new cloudbackup200[34] hosts

91aceca868-+-global_config: fix druid historical port

4e33e4dbd7-+-global_config: rework external services data structure

8e5b242eea-+-P:toolforge::checker: do not hardcode list of etcd nodes

7777132578-+-Remove puppet references to apt1001/2001

cb539161e5-+-P:wmcs::metricsinfra: haproxy: use http-request replace-path

f10aeccdc6-+-haproxy: cloud: use package{} to install haproxy

93dc2c63f8-+-R:idp enable new Bookworm hosts.

151294614a-+-elastic: move elastic2037 to insetup

502870c2c9-+-elastic: Bring elastic2107/2108 into service

29314c3343-+-Revert "prometheus: scrape envoy on k8s metrics with 'usedonly'"

124e36631f-+-Revert "Remove unused profile"

b8dc8bc3bd-+-P:toolforge::prometheus: Fix blackbox exporter installation

f32a2d5bc8-+-prometheus: scrape envoy on k8s metrics with 'usedonly'

aafe842ec3-+-Remove unused profile

5c2fcd6383-+-puppetserver.cloud_vps: add role without stale certs check

475968ffbc-+-Also disable monitoring for AQS1

b99225f9ad-+-P:mariadb::ferm_misc Add new IDP hosts

fe4fb7a617-+-P:toolforge::k8s: haproxy: Do not start keepalived too early

44426f1fab-+-AQS1.0: disable aqs service

ccdc86f1fa-+-mediabackup::storage: Avoid Ferm-specific syntax

fa77b5ec02-+-site: Add new IDP production hosts.

d263cc1187-+-haproxy: add parameter for optional log length

0c31cba8af-+-O:puppetserver: enable openstack stale cert exporter

769adb2403-+-mariadb: Remove db2096

9bf8e8c252-+-benthos/haproxy: fix hiera lookup

457ea6a49c-+-dumps::generation::server::rsync_firewall: Avoid Ferm-specific syntax

25718bbcc1-+-puppetserver: add puppet7-facts-export-nodb.py

140e008694-+-P:toolforge::k8s::etcd: load checker hosts from PuppetDB

f4f8145b6d-+-Remove puppetmaster::backend role from puppetmaster1002

5b43c8051d-+-O:toolforge::checker: remove apt pinning

3298d68ac7-+-aptrepo: Remove obsolete migration code

4b4c43d857-+-Configure idp-test as build host

7b5b04e8d1-+-openstack: keystone: ensure keystone-admin is restarted when keystone is

3abc7657ed-+-Add a stub role to build Apereo CAS

7436494805-+-kubernetes: migrate 5 eqiad appservers to k8s workers

074fdbbc80-+-Routed Ganeti: Add v6 static route to VM

587046e717-+-benthos: switch to unix socket for performance testing

007e14d313-+-installserver: Update dbprov for reimage of dbprov[12]00[56]

114f9fd8a4-+-base: standard_packages: install fzf

8e9cf2221b-+-scap::master: add rsync server for the k8s release repo

10be4b1153-+-P:prometheus::ops Remove new LDAP hosts from Prometheus

0785a10337-+-P:toolforge::bastion: remove tekton component

6181229a5a-+-P:toolforge: move webservice CLI to the CLI profile

ce54c0b3d8-+-P:toolforge: ensure new bastions have en_US.UTF-8 locale

aa6e19ae58-+-profile::puppetserver::wmcs: include validatelabsfqdn.py script

a3f3fbc227-+-puppetserver: allow specifying an autosign script

a54bc6c8c2-+-C:tomcat Pin Tomcat9 packages for Bookworm.

5525370f60-+-P:toolforge::harbor: add back docker config

37942c13ae-+-kubeadm: Drop buster support

4fc14da886-+-P:toolforge::docker::image_builder: drop buster support

bc5ed21248-+-P:toolforge: use prometheus.svc.toolforge.org

2b5e18deb7-+-P:wmcs::services: use deb.svc.toolforge.org

8aa0ea15e5-+-logstash: provision and commision logging-hd100[123] nodes

8fcd07401e-+-dynamicproxy: fix multiple vhosts on same server

964183e2d0-+-dynamicproxy: allow specifying different certs for each zone

d78f95d153-+-dynamicproxy: add support for per-project zones

afeb563e30-+-dynamicproxy: cleanup after removing toolforge support

c4e87775a5-+-tools: add grid shutoff messages

533cc1b00a-+-O:toolforge: add role for grid-less bastions

cb16b13149-+-Remove Toolforge grid engine

6349174cbe-+-P:toolforge::proxy: drop grid engine dynamicproxy support

dd67aca4db-+-httpbb: add ores-legacy tests

53fe3daffc-+-Add Dragonfly 2p2 cache to ml-serve k8s

d61b439f46-+-Undeploy Striker from codfw1dev

5b06e70c78-+-P:puppetserver: git: mark repos dirs as safe

b3b41ed1d5-+-P:puppetserver: git: use creates for initial deploy-code

039b67467c-+-P:puppetserver: git: mark /srv/git as safe

58a1b53418-+-restbase: provision restbase1042-{a,b,c} (new)

fd84206c39-+-Revert "planet: add prometheus apache exporter to role"

d620c66378-+-prometheus: ethtool_exporter: use package{} directly

7c1cfd2bcc-+-puppetserver: link ca dir to /srv if ssldir_on_srv

a508b9af0c-+-role::ml_k8s::staging::worker: add Dragonfly

a5150ff716-+-restbase: provision restbase1041-{a,b,c} (new)

8a55ff05f8-+-P:openstack: nova: convert cloudvirt2001-dev to OVS agent

f8f002339c-+-P:idp Use Tomcat9 build for Bookworm

623882f3f0-+-wdqs: move monitoring logic into role declaration

324ad8070d-+-planet: add prometheus apache exporter to role

11713aa4f8-+-profile::puppetserver: include ssldir_on_srv arg

e6278c9afb-+-site.pp: Move wdqs1025 into test role

ed3e92815c-+-wikidough: Avoid Ferm-specific syntax

ae931c495d-+-restbase: provision restbase1040-{a,b,c} (new)

0d75f9ea34-+-P:openstack: neutron: fix VLAN names on OVS test hosts

125e992adb-+-openvswitch: use package resource for ordering

148873ba6c-+-openstack: neutron: first attempt of installing ovs-agent

3a11f3dce7-+-vrts: disable vrts-cache-cleanup timer

07a4083f0d-+-thanos backend: Avoid Ferm-specific syntax

d158b60230-+-Increase the frequency of the matomo indexing job to hourly

54fc21a8f1-+-haproxy: enable log to benthos socket

a3efa073dd-+-Move the old apt servers to insetup::buster role

04ed674cfd-+-site.pp: Add wdqs1025 host

987b3eec4d-+-phabricator: setup scap bin link in migration class

f56a547fb1-+-Allow the lilypond packages to be installed on bullseye

fff506e3eb-+-restbase: provision restbase1039-{a,b,c} (new)

8e796dccc4-+-Add missing node definition

d497c68a37-+-openstack: neutron: add API support for OVS

3df32b68aa-+-Move 6 eqiad appservers to kubernetes

ad303329b2-+-icinga: create ircecho log files

c2b234cbdc-+-profile::kafka::broker: set cert renewal at 1 month

e5d458d9c1-+-Move parse2002-parse2007 to kubernetes

5dcd25914d-+-restbase: Switch the default to mw-parsoid

3074152026-+-Add missing node definition

f5c3283655-+-Move 6 codfw appservers to kubernetes

54799acb26-+-openstack::base::pdns::recursor::service: Avoid Ferm-specific syntax

4310bb84f3-+-ldap: fix sssd socket activation on bookworm

03baf285a6-+-Sync web.xml to default template from Tomcat 10/Bookworm

5e6f156039-+-Fix resource header

cbeb1fa546-+-C:tomcat10 Sync server.xml with default from Tomcat10/Bookworm.

12ed4ca59d-+-Add an motd for the old buster reposority server

32cc5444b6-+-Move parse2008-parse2015 to kubernetes

a3cc0f966a-+-puppetserver::wmcs: pull enc_path out of the enc class

8f00a3139d-+-fifo-log-demux: Decouple service from nginx/ats

e227a1fcdb-+-puppetserver: add ssldir_on_srv param for cloud-vps

da2dc3a5ce-+-role::puppetserver::cloud_vps_project: remove firewall config

f71285d4f2-+-profile::puppetserver::wmcs: parametrize a few hiera settings

7e05308723-+-Move lvs2011 from private1-a-codfw to private1-a2-codfw vlan

9999bf22d7-+-webperf: move statsv metrics to prometheus 'ext' only

9d789bbecb-+-cache: start using benthos on single host for haproxy log parsing

0635b59094-+-eqiad1::pdns: remove check_dns alerts

8ae08b945b-+-[vrts] Remove vrts1002 reverences

0d0883a7e2-+-wdqs: Distinguish between public and internal monitoring

021e82a460-+-mariadb: add all missing hosts from T355422

16de4f6cf9-+-icinga: Set log group to 'nagios' to resolve permission conflicts

4cd7b80794-+-eqiad: Move all but 1 parsoid node to kubernetes

72d4eb2288-+-Revert "[vrts] Remove ticket-test.wm.o and vrts1002"

b16bf05f43-+-[vrts] Remove ticket-test.wm.o and vrts1002

841f5d559d-+-restbase: provision restbase1038-{a,b,c} (new)

87c0265399-+-mariadb: add db2217

a9cec01523-+-P:toolforge: image_builder: refresh for bookworm

ab8980308f-+-Install conntrack via profile::firewall

0f16a2f55b-+-mariadb: Decommission db2117

7feb253ae1-+-puppetboard: Avoid Ferm-specific syntax

71948a0ada-+-ci_test: include profile::firewall in test role

a39fe81517-+-ci_test: add profile::ci::website to allow deployments

938652a41e-+-elastic: move elastic2107 and 2108 back to insetup

562ce444ea-+-admin: Flatten $user_list before joining

94c96b305a-+-Move 5 codfw parsoid servers to kubernetes

c24d283d77-+-airflow: Remove ferm_srange

5b7a09fec5-+-dns::auth: move all service state management to confd

afba523778-+-P:openstack: rabbitmq: use firewall::service

0810a2fd43-+-P:openstack: rabbitmq: remove cinder-backups term

7fa145d4b9-+-restbase: provision restbase1037-{a,b,c} (new)

ca57b56a08-+-elastic: add elastic2088-2109 to production role

90cde15aa4-+-Pass firewall range in profile::firewall syntax for remaining Airflow hosts

4003c0f0bb-+-Revert "pybal: do not install from component"

984a3b452e-+-Move 8 eqiad parsoid servers to kubernetes

f393ec6ba3-+-site.pp: remove old etherpad1003 host

a13eef5a30-+-Move 5 eqiad appservers to kubernetes

9a117c7750-+-openstack: neutron: fix ordering

143fc3aa50-+-O:wmcs: codfw1dev: net_ovs: add base neutron config

6981fafde0-+-Remove an-tool1005 and associated hieradata

5cb4f5a14f-+-cumin: fix insetup role report mapping

d0cb7d91cf-+-Move 6 codfw appservers to kubernetes

97b2643d6b-+-Add new role for OVS cloudnet

d4e685880d-+-P:openstack: rabbitmq: restrict clustering ports

2e3a0f2f59-+-openstack: neutron: manage ml2 plugins directory

d2c8ecc2e2-+-mariadb: Decommission db2118

ee02ed8031-+-ci: add profile::ci::httpd to ci_test role

b3eb19e308-+-contint: create ci_test role for zuul-only and apply on contint1003

368976cd4f-+-Move 3 appservers to kubernetes

1e03d8c8e6-+-P:wmcs: ntp: generate ACLs via network class

f22a89bb87-+-Move 6 eqiad appservers to kubernetes

f09087f902-+-Remove unused eqiad1 cinder backup role

ff70c73063-+-P:openstack: rabbitmq: remove cloud-hosts term

20cf1ad314-+-P:openstack: rabbitmq: remove cloudcontrol term

65ded838fe-+-mariadb: Remove db1118

c98da11bc9-+-Move lvs2012 from private1-b-codfw to private1-b2-codfw vlan

1e84ef66fd-+-P:dns::auth::update: explicitly create service state directory

93cf93712c-+-P:dns::auth: add support for depooling services via confd/confctl

b64216507e-+-P:prometheus: fix etherpad scraping

c008bf8b93-+-prometheus::ops: monitor active etherpad instance only

45feac515a-+-Sync context.xml to default template from Tomcat 10/Bookworm

9d336271e6-+-C:tomcat10 New modules for Tomcat10

6740b9e9de-+-P:wmcs::cloudgw: make virt_floating an array

5ceacce67f-+-jenkins: add security patch bot token to releases instance

40b9d4d642-+-airflow: Add option to pass the firewall settings via firewall::service

4623d5375a-+-P:analytics: gitconfig: rely on http_proxy hiera variable

c8f331c7fe-+-thanos: revert to standard logging level

f730a08eef-+-Revert "C:tomcat Allow users to specify which version of Tomcat to install."

fc1b75b31e-+-site.pp: fix wdqs duplicate role assignment

4425e7dd5c-+-Update analytics sqoop jobs

c62ebfedba-+-mariadb: Productionize db2218

15d2b6d73c-+-P:dns::auth::update: move authdns-update state to confd

7c93856b54-+-Rename victorops-analytics to victorops-data-platform

747bc2493c-+-standard_packages: Remove more obsolete packages after buster->bullseye update

047df326f6-+-profile::base: Allow running without cron installed

7f1e0df77c-+-udp2log::instance: Avoid Ferm-specific syntax

b40bc191f9-+-P:openstack: rabbitmq: remove designate_hosts entirely

2d038844d0-+-airflow::instance: Pass web server port as an integer

3b5533e712-+-P:wmcs::backup_cinder_volumes: avoid race condition

a237e4af8c-+-Update analytics mediawiki_dumps_import

4fca2797b4-+-P:pki::multirootca::monitoring Fix script path.

eef96c62c4-+-C:tomcat Allow users to specify which version of Tomcat to install.

a829c5506c-+-site: apply etherpad role on both eqiad and codfw

5d4339b820-+-idp::build: Remove explicit dependency on openjdk-11-jdk-headless

0d917d47eb-+-wdqs: loosen up regex for blackbox check

bebc0ea726-+-phabricator: add scap::user setup to migration profile

7a992438e4-+-wdqs: Add blackbox http checks for SPARQL endpoint

28debd66eb-+-Revert "site: replace contint1003 with contint1004"

2a348bc39b-+-Remove unused PAWS classes

4805bd26e3-+-OpenStack Designate: move from cloudservices to cloudcontrols in eqiad

b41851d6e9-+-P:pki::multirootca::monitoring Collect metrics from intermediate.

97f189464d-+-Remove debmonitor1002/2002 from site.pp

87902652dc-+-udp2log::instance: Use Stdlib::Port for the port

c3f65b94d2-+-thanos: ship tool to analyze query apache access logs

867be51408-+-P:IDP New Bookworm IDP servers.

6f6ff3bfda-+-thanos: limit query length in frontend

73c04e3b15-+-P:kerberos::kdc absent Icinga check

098b036906-+-P:kerberos::replication absent Icinga check

0de2dff3de-+-Routed Ganeti: move the tap v4 IP to Hiera

dcc59fa5c4-+-Update the contacts for an-redacteddb1001

5f57413648-+-icinga: delete monitoring class for planet

852ea27c14-+-site: replace contint1003 with contint1004

10724fa66e-+-Revert "wdqs: add blackbox check for query.wikidata.org"

ac3a7d1920-+-wdqs: add blackbox check for query.wikidata.org

851d2cc0b8-+-P:dns::auth::update: remove redundant conftool_prefix

5365271d62-+-P:dns::auth::update: update authdns-update for new confctl changes

c7fb1d8f24-+-site: add contint1003 with insetup::collab role

c35d1be53d-+-P:dns::auth::upate: absent confd management of ferm rules

0bf9d1ead9-+-P:dns::auth::update: revert to using ferm rules from Puppet

dde0ecf5dd-+-P:dns::update::account: add .ssh/config file

9b6414602e-+-P:dns::auth:: switch confd .ssh/config back to Puppet

ea92a61666-+-haproxy: configure extended logging (preparatory for Benthos)

3281e5dd68-+-dumps::nfs: Avoid Ferm-specific syntax

1143e9067d-+-etherpad: fix exporter override and clear ExecStart first

c530478ac8-+-pontoon: Avoid Ferm-specific syntax

a8b0af417f-+-P:idp Force Tomcat to use the default Java installation.

d437413441-+-C:puppetmaster::monitoring Disable Icinga merge check.

5e5995cd00-+-restbase: provision restbase1036-{a,b,c} (new)

0b4eee5f5c-+-deployment_server: Add mwscript_k8s

2b1df784b4-+-etherpad: disable auto restart when etherpad is stopped

047917b95d-+-P:puppetdb: microservice: add ensure to auto_restarts

dc27ad04a8-+-Remove toolschecker grid engine checks

cb8c21ef22-+-Remove cumin1001 from Puppet

e04fef71aa-+-kubernetes: move all remaining eligible codfw jobrunners to k8s

4dd1672e05-+-rsyslog: add maxmessagesize to -receiver

5256b9c61a-+-etherpad: disable exporter auto restart when exporter is stopped

1645f4e0d8-+-restbase: provision restbase1035-{a,b,c} (new)

7db8377504-+-kubernetes: move all remaining eligible eqiad jobrunners to k8s

78c8f920a8-+-etherpad: make exporter and blackbox checks configurable

e2574b637b-+-Make apt2002 a repository server

e271297eb6-+-openstack: nova: compute: depend on the ceph config file being deployed

88dcb1ad1d-+-Absent some reportupdater systemd-timer jobs

d249b6c17d-+-restbase: provision restbase1034-{a,b,c} (new)

7707b14401-+-add an-redacteddb1001 to site.pp

dd3cba35ec-+-etcd: disable the diff output for client config with passwords

c07dfa5fcb-+-Drop obsolete motd for cumin1001

eb3b869293-+-toolforge: k8s: Do not log secrets to Puppet log

621142c63a-+-openstack: nova-compute: persist compute node id

56dfcb6487-+-puppetdb: Avoid Ferm-specific syntax

9f1f4f5f18-+-profile::mariadb::wmf_root_client: Remove cumin1001 from allow list

27a1bca350-+-cloudelastic: decom cloudelastic100[1-4]

e8965b9610-+-P:cache::haproxy: add boolean to install component/haproxy26

9d08a40da3-+-site: add etherpad role to etherpad1004

be6c5226b2-+-Remove cumin1001 from alertmanager config and tcpircbot config

37ff0842ca-+-kubernetes: migrate 5 appservers to k8s workers

e7cba02f91-+-db2194: Move it to s3

801b94a1cf-+-mariadb: Place db2169 in s6

87e8aa8187-+-Fix role

0cea5efa02-+-Remove cluster::management role from cumin1001

d8d770e579-+-site.pp: Add db2171 to s5

088939beb2-+-mariadb: Place db2171 in s5

0e2e0f9521-+-airflow: change max_active_runs_per_dag back to 3

27c4166478-+-mariadb: Move db2170 to s1

e041a11910-+-mariadb: Move db2138 to s2

fce03101c5-+-mariadb: Move db2137 to s4

e43dda858c-+-grafana::loki: Avoid Ferm-specific syntax

0da650d3c4-+-mariadb: Move db2167 to s8

651fcd1857-+-mariadb: Place db2168 in s7

d4ae164dec-+-mariadb: Move db1213 to s5

b11a0f728a-+-mariadb: Place db1246 in s2

986a09c153-+-mariadb: Move db1244 to s4

ec2f811f9f-+-mariadb: Move db1170 to s7

94ceaadc8b-+-cassandra: install cqlsh-{id} symlink

a44995ca17-+-kubernetes: make 4 eqiad appservers k8s workers

3b8bcfe2a0-+-Fix 'wmfcloud' in comments

0985ab4734-+-etherpad: install mariadb server in wmcs

ac24b3c90a-+-P:puppetboard absent Icinga checks for PuppetBoard.

440defe49d-+-P:netbox monitoring not required on systemd timer.

e1c58035f7-+-P:puppetdb::microservice absent uwsgi Icinga check.

eca7aee68f-+-cloudelastic: Complete cloudelastic1005's migration

8b38a8dc56-+-nagios_common/planet: remove check_lastmod check, script and config

0fd80e59a9-+-cloudelastic: Begin private IP migration for cloudelastic1005

b0e385735c-+-cloudelastic: Complete cloudelastic1006's migration

f97c25b35c-+-graph_split: don't alert on updater absence

232a536860-+-cloudelastic: Begin private IP migration for cloudelastic1006

93d7acf88a-+-cassandra: install git-fat to satisfy scap requirement

9065ae157d-+-ncmonitor: Remove useless apt-get require

b0aab846e5-+-puppetdb: Use the nginx certs

044b682f51-+-phabricator,etherpad: fix some puppet-lint warnings

1a34a8cb6b-+-thanos: run Thanos components in a systemd slice

003d11eb1b-+-etherpad: add $service_ensure parameter

d80fc32fc1-+-etherpad: add data types to parameters

c682334fc8-+-Create a dedicated role for routed Ganeti

0c3d316aa3-+-Routed Ganeti: enable IPv6 forwarding

7d681c2b7b-+-P:toolforge::prometheus: prevent toolsbeta from paging

985a838fe1-+-cloudelastic: Complete cloudelastic1007's migration

0b290fc25c-+-cloudelastic: Begin private IP migration for cloudelastic1007

440c75aad3-+-puppetserver: don't fail setting up rsync_module

3b509fb26d-+-Make puppetserver2003 a Puppet server

d75bd642a5-+-openstack: overhaul the floating IP updater

f3ad251fbb-+-kubernetes: make 5 codfw appservers kubernetes workers

2ddb03f474-+-P:spicerack: support wmcs cookbook repo in test-cookbook

7a4baef5f2-+-D:service::uwsgi Parse the Icinga disable flag to uwsgi:app.

be9e2acf49-+-P:ganeti: Remove Icinga memory monitoring.

943a0f662c-+-C:puppetmaster::monitoring Absent Icinga monitoring

f56f7d5cc2-+-P:puppet::client_bucket remove monitoring.

9cc99e5506-+-puppetserver: Also install the tool to update netboot images on puppet servers

5d292a3b4c-+-P:kerberos::kadminserver absent Icinga check

1c0a91b7f3-+-C:external_cloud_vendors add owner to systemd timer.

1a1db86099-+-phabricator: re-activate public dump job

f9653da4eb-+-P:dns::recursor: small change to experiment with Gerrit

1d7c261434-+-hue: uninstall hue from an-test-ui as it's being deprecated

1d6dd24e6c-+-Revert "grafana: temp disable rsync stunnel for puppet7 migration"

817c32b64a-+-grafana: Enable stunnel for Loki data transfer

ec36d438fd-+-puppetdb: allow both secret() and source for site key material

01f40abe58-+-site.pp: remove sessionstore200[1-3] (decommissioned)

035d9f7bbc-+-sessionstore: decommission sessionstore200[1-3]

cc7f701219-+-puppetserver: add Puppet CA custom name and SANs

bfbd685023-+-postgresql: use 'systemd reload' for pgreload

1d5a6d66ce-+-multirootca: depend on cfssl when generating CRLs

b9953d69a1-+-kubernetes: fix typo in host glob

ee53ce82e3-+-kubernetes: move 5 mw hosts to kubernetes workers

8b3c21036f-+-P::installserver::proxy Blackbox monitoring

5e7e9dc1cd-+-D:uwsgi::app Allow disabling of monitoring.

afbfae8ba2-+-ncmonitor: Fix misspelling of nonexistent home dir

ea208197c5-+-Add module for ncmonitor

a0c5e9de57-+-site: update etherpad VM 2001 to 2002

c63026922e-+-site: add etherpad2001 with insetup role

39406f0659-+-ci: Avoid Ferm-specific syntax

5897f9482e-+-package_builder: add hook for building HAProxy 2.6 component

53da2e1a7d-+-profile: enforce opensearch plugin repository on apt hosts

b063fc9a42-+-rsyslog: have rsyslog create its own files

efbfb6afa5-+-mariadb: decom db1133

2484a14920-+-mariadb: removes db1139

4086403fb4-+-mariadb: removes db1144 db1149

1993c0a4a9-+-mariadb: removes db1135

f49f5306b7-+-mariadb: removes db1145

67ff2f428c-+-mariadb: removes db1140

e5a6876494-+-mariadb: removes db1146

8d06473f67-+-profile: absent check_systemd_state

3f4c5ea521-+-ulogd: Make class ensurable

629f1497d8-+-cloudelastic: Complete cloudelastic1008's migration

e4950199d4-+-puppet: do not log diff for private keys

053c5b3f1c-+-[phabricator] Ignore 'some files vanished' error for phab repos rsync

91759edbbf-+-site: add etherpad1004 with insetup-role

bf45ec2ab4-+-grafana: Prevent race condition by excluding 'wal' directory in Loki sync

9e9578dbff-+-Remove site.pp entry for old Puppetboard hosts

38aef74643-+-Add puppetserver2003 to site.pp

9008fb42e2-+-network: rename labs_networks as cloud_networks

f62be17938-+-Change all role contacts for Data Engineering -> Data Platform

71ab8b59a7-+-P:package_builder: Limit TCP check to IPv4

4eacf632d5-+-mariadb: revert db2194

d8329caac3-+-mariadb: Decommission db1124

f862aa5f2a-+-profile: use undef default for active and standby host defaults

dfa89314ae-+-Update contactgroups for analytics => team-data-platform icinga checks

ce48104213-+-P:openstack: horizon: do not install mod_wsgi

84d16c720b-+-wikitech: remove redundant php-ldap package

c146c4d65b-+-wikitech: remove python-mysqldb

e41432a20d-+-Add icinga configuration to notify the Data Platform SRE team

8345958e98-+-nrpe: cleanup check_systemd_unit_state

599b5d3a3c-+-P:wmcs::cloudgw: do not NAT traffic to cloud-internal networks

e1c95b5c4c-+-nrpe: absent systemd_scripts

2fb8155e96-+-profile: remove Icinga-based systemd unit failed check

c229b42e17-+-mediawiki: Remove Ferm-specific syntax from firewall definitions

fad223f8a6-+-nrpe: remove monitor_systemd_unit_state

499564243f-+-thanos: enable request debug for query / query-frontend

de7e5527d4-+-icinga: use systemd::timer::job for 'update-etcd-mw-config-lastindex'

0099bf46f3-+-ferm::filter_log: Make ensurable

d3349ecb82-+-debmonitor: Remove legacy cert handling

2376f914e0-+-interface::ipip: Create ipip[6]0 devices as auto

dad7659651-+-sessionstore: provision sessionstore2006 (new)

017fe91f9a-+-cloudelastic: Begin private IP migration for cloudelastic1008

5f6496efbe-+-sessionstore: provision sessionstore2005 (new)

75c89b9825-+-sessionstore: provision sessionstore2004 (new)

8f54040804-+-wikistats: symlink deploy script into PATH

9596fbf8b5-+-Bring two new stat servers into service

41c261424e-+-P:httpbb: migrate tests from cumin1001 to cumin1002

a1caadf6a6-+-grafana: Ensure Loki data is synchronized across instances

c6a50e4d16-+-systemd::unit: clean up ownership file

a0bb5955d1-+-P:openstack: radosgw: move to firewall::service

c2f3cfc16e-+-kubernetes: make 5 appservers k8s workers

b4c69ec708-+-network: make cloud_private_networks per_site

77ee87ab40-+-etcd: remove nrpe::monitor_systemd_unit_state

e822043005-+-mediawiki: remove nrpe::monitor_systemd_unit_state

303c4e9abb-+-docker_registry: remove nrpe::monitor_systemd_unit_state

fe131d7ae1-+-chartmuseum: remove nrpe::monitor_systemd_unit_state

c83154a1c2-+-confd: remove nrpe::monitor_systemd_unit_state

9753624bbb-+-Update data-engineering-postgresql bacula job defaults

afd32c62e2-+-P:wmcs: cloud_private_subnet: add route to private instance networks

ce97372be9-+-network: rename 'labs' in data to 'cloud'

d65fa04a85-+-[DPE Postgres] Only backup the latest postgres dump file

c0a8eaaf98-+-mariadb: remove nrpe::monitor_systemd_unit_state

3f56a2b400-+-network::constants: use 'cloud' where possible

0619850172-+-profile: remove absented statsd hosts entry

a1c4c25214-+-graphite: remove nrpe::monitor_systemd_unit_state

b3239c8ae3-+-envoy: remove nrpe::monitor_systemd_unit_state

074188ff67-+-Removed refs to openstack version 'yoga'

3f90f7f35e-+-cloudelastic: Complete cloudelastic1009's migration

3b0d66a8b7-+-site.pp: remove decommissioned restbase hosts

1a6c9d13ee-+-Remove EOL restbase hosts

9605242213-+-site.pp: remove EOL sessionstore hosts

b74cdaa1ba-+-sessionstore: remove EOL hosts

288a8ce48f-+-cassandra: remove nrpe::monitor_systemd_unit_state

b40ae89abe-+-cache: remove nrpe::monitor_systemd_unit_state

739a15c60b-+-mariadb: will test converting instances

b4cf2f6441-+-hdfs: Assign the right role to new hadoop workers

f884e14d8d-+-D:prometheus::blackbox::check::tcp allow specifying runbook.

3b97345d1b-+-libraryupgrader: migrate repo to gitlab

2944bcddae-+-Allow pdns to query designate-mdns on private interfaces

df5cbb2d15-+-cloudelastic: Begin private IP migration for cloudelastic1009

ba4cdf3466-+-Yet further attempt to fix memcached port for designate

7b1b327eee-+-Designate: replace mcrouter as part of designate services

7cbfc44712-+-OpenStack Designate: move from cloudservices to cloudcontrols in codfw1dev

06763bffb6-+-Move mw api servers to kubernetes workers

726d7b1d2a-+-site.pp: clean up mw*, no functional change

6f9e9db7c8-+-P:etcd: generate wiki replica pool accounts

1d093380dc-+-mariadb: pooling db1244 db1246, prepare db1235

cd1d67184c-+-kubernetes: make 3 appservers kubernetes workers

fa2eef013b-+-Update default airflow_version and remove overrides

3f06a5ea7f-+-debmonitor: Remove support for old deployment method

806d613813-+-C:samplicator Icinga monitoring is not required.

b671be6d62-+-mariadb: Remove db1106

041d5bd7dd-+-cloudelastic: stop issuing certs for soon-to-be defunct FQDNs

17cce9790f-+-vrts: enable connection pooling

7291ed4dd1-+-ci: fetch tags for git mirrors

6590658058-+-kubernetes: make 3 appservers kubernetes workers

2f3d53a85e-+-interface: add explicit Augeas lens

3856376af3-+-Move prometheus inside paws cluster

4f35d7a61d-+-mariadb: migrate core multi-instances nodes

4c67f08b7c-+-P:debmonitor::server templates are content, not source.

69fda308d2-+-P:debmonitor::server enable django/uwsgi logging.

aa254dfb9e-+-P:openstack: neutron: use cloud-private for memcached access

5ef10c88b7-+-Enable the presto nested data feature by default on superset

4a5e3bfd53-+-Switch old debmonitor nodes to insetup::buster

c9c72e5e9c-+-logstash: stop consuming the full mediawiki accesslog topics

bef981b4ed-+-logging::collector: add mw accesslog sampling by benthos

8e39364d9d-+-Revert "cloudelastic: stop issuing certs for soon-to-be defunct FQDNs"

18270746da-+-cloudelastic: stop issuing certs for soon-to-be defunct FQDNs

18293c8a4e-+-postgresql: add explicit Augeas lens

cbbbcdeba9-+-P:toolforge::mailrelay: ARC sign outbound mail

86f9fd0282-+-netboxdb: change bacula settings for DB backup

9af3d7a4e9-+-netboxdb: increase local backup retention

9a06ab149d-+-P:debmonitor::server Do not embed the fqdn of an instance in rules.

0f0ae4cd73-+-P:url_downloader absent Icinga check.

9467be5008-+-hadoop:httpd: Avoid Ferm-specific syntax

b421f55376-+-P:debmonitor::server client HEAD check is on port 443.

c403fde75a-+-kubernetes: make 3 api_appservers kubernetes workers

9654596adc-+-Routed Ganeti: fix nftables bug

29802f0a8d-+-Routed Ganeti: rollback global v6 forwarding

32442d2558-+-Enable forwarding more broadly and fix nftables bug

74abc063d1-+-P:debmonitor::server rework debmonitor http monitoring.

3353bb9832-+-sessionstore: provision sessionstore1006 (new)

c1035efa72-+-sessionstore: provision sessionstore1005 (new)

a789e366e0-+-sessionstore: provision sessionstore1004 (new)

7c87fa61ef-+-exim4: Allow installing from component

ac18107097-+-P:toolforge: mailrelay: workaround Exim 4.94 taints

5c8c442cb8-+-cloudelastic: Add migration canary to cloudelastic cluster

51ca2cb0e2-+-kubernetes: make 3 api_appservers kubernetes workers

f247794c67-+-kubernetes: make 5 jobrunners kubernetes workers

4ad6a2ddec-+-[gerrit] Add rsync job for lfs sync

9b7b8a36be-+-Enable the presto_nested_data feature on superset-next

e195dbfe99-+-P:debmonitor::server link uwsgi app ini

47171a44b1-+-Also make debmonitor1003 a debmonitor host

0cc1adf794-+-Add sretest2005 to partman/site.pp

312bec3efe-+-P:debmonitor::server Correct uwsgi configuration on WMCS.

abd36ce830-+-phabricator: fix team name in smtp monitoring check

0d216d21a9-+-phabricator: fix typo in python3-pymysql package name

3f0f7a0ec9-+-phabricator: tools: install python3-pymsql for public_task_dump.py

704d4a0067-+-contint: Remove obsolete firewall rules

c5d08a4b30-+-Fix casing of Mediawiki to MediaWiki

52fa98eb0e-+-Revert "hue: rename python-snappy apt dependency"

eb0e3f5b25-+-hue: rename python-snappy apt dependency

acb187750e-+-kubernetes: make 5 jobrunners kubernetes workers

9e258e4f7f-+-P:debmonitor::server install Debmonitor from package.

d3579fa63a-+-puppet::agent: Remove path condition for /run/puppet/disabled

6d2a5e73de-+-ganeti/rapi: Relax permissions for rapi directory

78f77aeb36-+-ganeti: Create /var/lib/ganeti/rapi in Puppet

1cd1e62696-+-Puppet: Routed Ganeti support

b03500e70b-+-mariadb: Decommission db1134

8b239133ae-+-cloudelastic: config changes for migration canary

7ebc680173-+-ganeti: Stop using transition package

4bde098312-+-logstash: consume from mediawiki accesslog sampled topics

76952b2f47-+-Move cloudrabbit1001/2 to private vlan

6d5bb0a283-+-Install debmonitor-server on bookworm

7353a56aa2-+-mariabdb::monitor_memory: Also update update name in dependency

789242e1dc-+-mariadb::monitor_memory: Update package name

9952113976-+-rabbitmq: fix order of invalidate_rabbitmq_guest_account

67c26cdeeb-+-Bring cloudrabbit1003 in service as a new cluster

9dfa0747ab-+-Fold linux44 into the regular wmf kmod::blacklist

c57c68e24d-+-Revert "udp2log: Replace ferm rules with firewall::service"

765abd29dc-+-udp2log: Replace ferm rules with firewall::service

563d34abe1-+-Remove long-absented resource

8375fe2f75-+-disable_tool: remove the archive_db stage from the cron host

5daf1ba3d5-+-disable_tool: remove the archive_db stage from the cron host

e9a974b245-+-mediabackups: Setup backup1011, backup2011 as new media storage hosts

34fa5f5740-+-Revert "dbbackups: Create temporary fileset for dbprov for dbbackups archival"

4fe0caed5e-+-Remove sysctl settings to override defualt IP frag buffer sizes

448b2ab300-+-Bird: move firewall and default neighbor to module

796cfab564-+-fifo-log-demux: Update project homepage

34c451bedd-+-dbbackups: Create temporary fileset for dbprov for dbbackups archival

bd46b26de0-+-dnsrecursor: forward_zones for wikimedia.org, too

af1b50f9aa-+-kubernetes: move more jobrunner hosts to workers

2bff112d52-+-Make ganeti1038 a Ganeti node

57f38bb29a-+-P:wmcs::kubeadm: worker: support containerd separate volume

f12fc41889-+-graphite: remove mw edit failures graphite alerts

c91fdf8c63-+-site: predefine logging-hd100[123] insetup role

b0b7b1ac62-+-P:lvs::configuration: replace labsproject with wmcs_project

be30b0e9cd-+-cassandra: reconfigure 'dev' target_version for a 4.x release

50ff7dc10d-+-wdqs graph-split: enable microsite

c63de67255-+-P:lvs: set monitoring enabled for IPIP-related services

9c550af0c7-+-[phabricator] Remove public task dump task timer

5fb9040cd0-+-Make ganeti1037 a Ganeti node

6f5eab624d-+-Deprecate system::role for ML services

104ff8cccf-+-P:openstack: nova: use cloud-private for memcached access

fb622b659d-+-mediawiki::cgroup: Enable v1 cgroups on bullseye

6e4f04df93-+-P:openstack: galera: migrate to firewall

bc4ea017ad-+-P:openstack: galera: always use cloud-private

618e4ba8db-+-site: Add cloudrabbit1003 as insetup

56133ba992-+-Fix the hostname for the wikishared password on superset

cc283946dc-+-Revert "vrts: test delaying blackbox::check::http"

a90183e546-+-[phabricator] Use python3 for task dump script

c7874543c0-+-kubernetes: reclaim eqiad jobrunner hosts

8d240e5562-+-Galera: open 4567 to UDP

cb529f866d-+-global_config: list IPs of hadoop master/workers and kerberos nodes

a1519e5c22-+-db1134: Temporary place in m2

e4241859b1-+-P:toolforge: move hba to grid-specific bastion profile

ab3895ce24-+-openstack: remove spreadcheck, absented

d556fb7239-+-Make ganeti1036 a ganeti node

34c3cdfeab-+-aptrepo,haproxy: Allow installing HAProxy 2.8 on bullseye

cf9711d5de-+-vrts: test delaying blackbox::check::http

5d4f901c1e-+-archiva: fix 400s when proxying requests with spaces in the URL

5111aa2025-+-P:openstack: keystone: use cloud-private for memcached access

29059c15a0-+-icinga: remove ldap-icinga remnants

0fa71c9ef8-+-pontoon: include profile::monitoring in base

a0b71f31d6-+-icinga: remove legacy check_nagios_paging

815bfb959e-+-profile::openstack::codfw1dev::db: Convert ferm::rule into firewall::service

289f52cc56-+-Deprecate system::role for IF services (batch one)

1a1eb803bb-+-Revert "phabricator: temp add scap user creation in phab migration class"

98586a0e4b-+-phabricator: temp add scap user creation in phab migration class

201fe58d47-+-phabricator: switch phab1004 back to production role

436bd8306c-+-phabricator: switch phab1004 to migration role for syncing data

440efb0280-+-Galera: switch codfw1dev nodes to replicate on private address

563e556a63-+-phabricator: delete unused repo sync class after test

59a51ec442-+-phabricator: clean up repo sync class after test

fb1f59a628-+-Galera: switch codfw1dev clustering to private IPs

7906f62a42-+-phabricator: repo-sync test, use a machine in other DC

40770d1f09-+-cloudelastic: bring cloudelastic10[07-10] into svc

30d22fb4da-+-failoid: Remove system::role

e3fb1142c4-+-P:openstack: placement: use cloud-private for memcached access

fc8c3b8b60-+-P:openstack: glance: use cloud-private for memcached access

4a162a9f8a-+-P:openstack::cinder: use cloud-private for memcached access

dbf59287cd-+-wdqs graph-split: disable microsite

2bc7bf81ac-+-profile::realserver::ipip: Start tcp-mss-clamper on system boot

4b787d84f6-+-profile::lvs: Start ipip-multiqueue-optimizer on system boot

d69f997d02-+-phabricator: fix source host for repo sync test

8d7138ffad-+-phabricator: temp test of repo syncing, using gitlab2003 spare host

d46bf19759-+-k8s topology labels: add row to rack transition

c6e0441ea5-+-puppetserver: move ::generators from puppetmaster

58dccdfa42-+-kubernetes: make 3 eqiad jobrunners k8s workers

8b40b2bd1d-+-prometheus::blackbox::check: make for parameter configurable

a6ca00669b-+-miscweb/microsites: remove profile::microsites::design

e3531db806-+-P:openstack::heat: use cloud-private for memcached access

8a2a5bcb29-+-Make ganeti1035 a Ganeti node

8fdebbbd41-+-P:openstack::magnum: use cloud-private for memcached

b300b7eab2-+-[gerrit] Refactor classes to specify an active host

f71ecddca3-+-grafana: deploy puppet dashboards as grafana/grafana

bf5ef7f86f-+-acme_chief: Avoid Ferm-specific syntax

4dbdc3c5d3-+-dragonfly::dfdaemon: Avoid Ferm-specific syntax

ddcf7103cc-+-grafana: chown rsync'd files

cbcf30a5fb-+-grafana: temp disable rsync stunnel for puppet7 migration

996c73dc41-+-P:toolforge::mailrelay: reject mail not using Toolforge domains

37ac9399b6-+-site.pp: Add es10[35-40]

b6fe88ddc5-+-microsites: create experimental microsite for WDQS graph split

86f6e8df3b-+-microsites: simplify query service UI configuration

83df40eba3-+-thanos::rule: set reload service to stopped

5d7fbf632e-+-grafana: add dashboard datasource usage (graphite) exporter

eb1f2c7ded-+-klaxon: bookworm/gunicorn compat

122a588380-+-P:openstack: nova::compute: increase max conntrack table size

4e443a71e1-+-aptrepo: Drop one more deb822 check

5ac2778ac1-+-mariadb: Remove unused variable

e36b2f8cf0-+-kubernetes: make 4 codfw jobrunner hosts k8s workers

be0b16d033-+-aptrepo: Don't apply deb822 validation on uploaders file

8b38c34b07-+-Configure ACLs for reprepro upload queue

359e8f6006-+-P:toolforge::checker: remove webservice checks

d235791f04-+-site.pp: Add new hosts

44800049ea-+-phabricator: add script/timer to create tarballs of home dirs

d4c87714f5-+-Move mw api servers to kubernetes workers

06d9fa256e-+-phabricator: auto-sync /srv/repos between servers

7545184c1e-+-kubernetes: make jobrunner mw1460 a kubernetes worker

edc6417690-+-Remove remaining references to dbstore100[35]

9e67fde4ee-+-miscweb/microsites: move monitoring of design to monitoring profile

76ac2bf0b6-+-P:openstack: nova::compute: include certificate chain

053961b21a-+-P:openstack: nova::compute: restart libvirt api after changing TLS certs

25c286dcbe-+-thanos: add bucket query tools

5925621864-+-clouddumps: Avoid Ferm-specific syntax

09d0470622-+-rsync: Remove support for auto_ferm and rename auto_nft

76463a50a8-+-Set the old namenodes to be insetup

31289e22eb-+-graphite: Avoid Ferm-specific syntax

6b63bc9bb6-+-Revert "Create initial stub role for logging-hd and configure for Puppet 7"

e790eea93e-+-phabricator: use quickdatacopy for automatic home dir sync

77e66b3b6b-+-Remove puppet references for druid1004_6

830656a34f-+-dologmsg: standardize logging format

795bc27d03-+-wdqs-test: Enable PKI

3d681aadad-+-Fix inconsequential typos

c4f7cb76b6-+-P:mail::smarthost: support DKIM dual-signing

584b326361-+-spark3: enable event logging and history server integration for all spark jobs

1899a3facc-+-toolforge: wheel of misfortune: remove redundant defaults

05265d3c60-+-gerrit: add trailing slash to gerrit.canonicalWebUrl

b070146aeb-+-Clean up the temporary changes for debugging T354413

3fd74a13b3-+-Bring an-master1004 into service as a hadoop::standby

da777a35eb-+-phabricator: avoid duplicate lists of servers in migration class

4f63d098f2-+-phabricator: avoid duplicate lists of servers in Hiera

a55ffdd5c3-+-mariadb: remove grants and firewall rules for dbproxy1018/9

3b9722510b-+-site: remove dbproxy1018/9

94f9a22b9d-+-Move dbproxy1018/9 to insetup

c9deab03bb-+-kubernetes::node: Blacklist wdat_wdt kernel module

8917482898-+-kmod::blacklist: Allow also rmmoding modules

dd80ddabce-+-stewards: remove umask parameter from git::clone

7945bfd042-+-prometheus::k8s: Fix labeldrop actions

8f5756382a-+-P:toolforge::prometheus: add pint alert linter

2ad65eb980-+-swift: Switch rsync service to use firewall::service

5ceacb53cc-+-Bring an-master1003 into service as a hadoop::master

6a8cf736ed-+-Remove puppet references to testreduce1001

5c03c77d80-+-nftables: On Buster install nftables and libnftnl from backports

b7b255889c-+-rsync::quickdatacopy: Remove use_generic_firewall and auto_ferm_ipv6 flags

abcca2651b-+-Remove mentions of ganeti-test1001/2 and 2004

e658b26d73-+-es20[35-40]: Insetup

593a0a1c98-+-s/unssuported/unsupported

628593ae8d-+-cloudservices: include observer env

a50a2fcec4-+-phabricator: move data syncing related code to separate profile

05c37a9b09-+-cloudservices: include openstack envscripts

28c9144577-+-openstack designate: fix path to wmcs-dnsleaks for prometheus metric

0b6b1e765a-+-wmcs-dnsleaks: Add prometheus metric

cdadc5bba4-+-Rename wmcs-novastats-dnsleaks to wmcs-dnsleaks

a19b63703e-+-mediamoderation: Switch to using all.dblist

15914a0d0f-+-restbase: partitioning and insetup for restbase10[34-42]

37475246da-+-Revert "P:toolforge::mailrelay: rewrite maintainers in Python"

7288bcbb33-+-[vrts] Adjust restart and oom policy for clamav and vrts services

1f650955d7-+-P:toolforge::mailrelay: rewrite maintainers in Python

1663ff3e78-+-deployment servers: Set safe.directory in general

b041f1c675-+-C:bigtop::hadoop switch to new topology script.

6a58efdc0a-+-prometheus::k8s: Drop id label from cadvisor metrics

f2aa9ab651-+-deployment servers: Switch rsync service to use firewall::service

9eafa34f2b-+-phabricator: move prometheus smtp check to monitoring class

7f7fba6427-+-phabricator: move logmail to a separate profile to simplify main profile

c060eea186-+-alerting: replace serviceops-collab with new team name

321f21cc41-+-mw1377: change role to insetup

ea0266624b-+-O:mariadb::proxy::replicas: remove LVS realserver profile

707748dde9-+-profile::toolforge::nfs_disable_tool: install mariadb-client

2845a11eba-+-TEMPORARY for debugging T354413: kubernetes::node

5a98c711c8-+-restbase: set production role and add config for restbase2035

e4bd612a02-+-TEMPORARY role for debugging T354413 for mw1377

a9b4c5cdeb-+-P:toolforge::mailrelay: double-sign mail with RSA DKIM keys

cc53b98f04-+-P:wmcs: wikireplicas: remove cloudproxy

6d6dc6f4ca-+-P:openldap: convert to firewall::service

3974fcc5db-+-toolforge::docker::registry: Switch rsync service to use firewall::service

2b247042c5-+-P:openstack::designate: use cloud-private for memcached

8245dfe1db-+-P:debmonitor::server check host for CDN.

5fca197b69-+-vrts: auto-restart apache2 on-failure

e99f9a59b4-+-clamav: add systemd override, enable restart on-failure

c6814a466e-+-C:puppetmaster::monitoring labs/private uses master branch.

32c71b67d3-+-P:debmonitor::server Add Prometheus Blackbox monitoring

9e89ced25c-+-admin: allow using security key backed SSH keys

c5e6d30729-+-prometheus: validate check Prometheus instance

9edd0251d5-+-C:puppetmaster::monitoring missing execute bit on script.

f8e6ebd9da-+-C:puppetmaster::monitoring Reenable Prometheus data collection.

5e1b78d159-+-C:puppetmaster::monitoring disable timers

1e647d9d5d-+-C:puppetmaster::monitoring Prometheus stats for Puppetmerge.

acbbb278d6-+-cloud: disable statsite in cloud

5f8a8beb42-+-Revert "TEMPORARY role for debugging T354413 for mw1377"

1dd53c2379-+-services_proxy: Support tracing

cfb94133c6-+-TEMPORARY role for debugging T354413 for mw1377

7d37f84535-+-restbase: set production role and add config for restbase2034

b56faa975d-+-mwmaint: Switch rsync service to use firewall::service

e60a8b1191-+-elastic: test out elastic2087 puppet 7

50220b6d8d-+-releases: Switch rsync service to use firewall::service

981caf4cd6-+-mw1377: change role to insetup for debugging

e67972b83d-+-keystone: Switch rsync service to use firewall::service

2ae1814c03-+-rancid/librenms: Switch rsync service to use firewall::service

d89cdb2661-+-aptrepo:rsync: Switch rsync service to use firewall::service

c2401dae78-+-rsyslog::receiver: Switch rsync service to use firewall::service

14cc5fde05-+-rsyslog::receiver: Remove support for buster

077569a147-+-Revert "Set MW API servers to insetup to fix failed reimage"

d037cd5fcf-+-idm: Avoid Ferm-specific syntax

2f700c83bb-+-pki::multirootca: Merge custom profiles on top of default_profiles

5cb0bb0990-+-profile::prometheus::rsyncd: Switch rsync service to use firewall::service

2e26dedf41-+-prometheus::migration: Switch rsync service to use firewall::service

336bb0b2df-+-Set MW API servers to insetup to fix failed reimage

d7fffc7e65-+-doc: Switch rsync service to use firewall::service

7bfebfee25-+-peopleweb: Switch rsync service to use firewall::service

d2beb0f1fd-+-Move mw api servers to kubernetes workers

04d6f459b9-+-mwlog: Switch rsync service to use firewall::service

c3e73f122d-+-grafana: Switch rsync service to use firewall::service

d8020708fb-+-Bring dbstore1009 into service

dea2fc88ec-+-vtrs: Switch rsync service to use firewall::service

1cdbf61125-+-Correct typo in cumin1001 warning message

b6ee9bc987-+-phabricator: Switch rsync service to use firewall::service

5a8a268e7c-+-Make cuminx002 warning more-visible

4b0ad35d5a-+-doc: Switch rsync services to use firewall::service

29b7d9dbbd-+-lists: Switch rsync service to use firewall::service

9a51b82d7d-+-aptrepo:migration: Switch rsync service to use firewall::service

a998c38ff7-+-wdqs: graph split hosts don't need categories

69d6f53c28-+-graphite::production: Switch rsync service to use firewall::service

6e401e5cf5-+-statistics::explorer::misc_jobs: Switch rsync service to use firewall::service

7d57bdb118-+-Add a comment which clarifies the purpose of the kadmin rsync setup

877549ab60-+-statistics::rsyncd: Switch rsync service to use firewall::service

95a9ea1798-+-kerberos::kdc: Switch rsync service to use firewall::service

acde909022-+-an-web: Switch rsync service to use firewall::service

353607e44b-+-aptrepo::staging: Switch rsync service to use firewall::service

b677959666-+-C:puppetmaster::monitoring Blackbox monitoring

e4ca314d5f-+-gitlab: Switch rsync service to use firewall::service

f6bb7d7c07-+-os-reports: Switch rsync service to use firewall::service

0bcf37eb4a-+-Bring dbstore1008 into service

1930b5c213-+-rsync::quickdatacopy: Add support for creating nftables-compatible firewall

311900f74c-+-Galera haproxy: fix handling of primary_host

441f36ed99-+-keystone haproxy: increase server timeout for admin service to 10m

1b9ad9b5be-+-RESTBase: Hardcode no_worker patch to stop OOM

69a7270930-+-envoy: Make tracing configuration clearer

8127c7e1d1-+-pyrra: reload pyrra-filesystem and thanos-rule on cfg change

a621ae9699-+-restbase: set production role and add config for restbase2033

7d8a5929ea-+-tlsproxy::envoy: Allow specifying a percentage to be traced

c64c78ae54-+-mediawiki canaries: Include opentelemetry::collector

78cdfc2278-+-wdqs: decom wdqs100[6-8]

506decc27e-+-Revert "restbase: set production role and add config for restbase2033"

f135e15d4b-+-wdqs: Work around systemd unit failures

87834fed23-+-restbase: set production role and add config for restbase2033

1facd300e1-+-Add PYTHONPATH to the airflow-scheduler command

f87c0eee27-+-[Analytics] Activate metrics for all Airflow instances

3bf9e31163-+-Start scraping airflow metrics from all instances

30da9bced3-+-oauth2_proxy: update probe definition

012a5abaac-+-Add MediaModeration module and support for running updateMetrics

83e8f9e01e-+-kubernetes::master: Drop absent resource

0b57cdc8c7-+-wdqs: bring wdqs10[17-21] online

0ed1cbbb83-+-phabricator: remove sshd config for git-ssh service

bf4fd90e33-+-phabricator: remove support for separate git-ssh IP behind LVS

f00eb3e80f-+-Install community_civicrm on crm role

65817512e2-+-wdqs: Add Accept: header to LDF endpoint check

9afdf9bf1e-+-query_service: force TLS for monitoring for search-platform team

cd2b6a774d-+-mariadb::service chmod override file

a259fd50b8-+-Fix insetup role for restbase203[3-5]

5026637006-+-prometheus-blackbox: Expose ability to add arbitrary headers

c0bc3cbfdc-+-pyrra: onboard varnish-requests as pilot SLO

2262031274-+-wdqs ldf: remove useragent param

0cad84d0f9-+-rsync::server: Add support for creating nftables-compatible firewall services

4fa414703a-+-Bump refine_sanitize refinery version to pickup fix for T349121

3e1eb17d32-+-On cumin1001 print a MOTD to use a different host

7888ffede7-+-Remove lists1003 from site.pp

76e3f05be3-+-site/cumin: rename insetup role for collaboration services

6c7548f6d3-+-roles/hieradata: rename serviceops-collab team

3da9c7511e-+-[toolsdb] fix override syntax

7ee3c1c037-+-P:toolforge::prometheus: add recording rules for k8s cluster capacity

8a0336c8f4-+-[toolsdb] Use jemalloc to prevent memory issues

13072477d0-+-wdqs: New LDF endpoint check

65b3c311ee-+-yarn: configure Apache to only listen to port 80

f4734731f9-+-base::cuminunpriv: Avoid Ferm-specific syntax

d15edcb673-+-C:puppetmaster::monitoring remove blackbox check

de26aae705-+-C:puppetmaster::monitoring use FQDN for blackbox

21723874f8-+-spark3: set the spark history server domain for analytics-hadoop

1049f125cd-+-tlsproxy::envoy: Only pass an srange if not an empty array

e4cb7afc26-+-Update the refinery version used by the refine production jobs

638ec47cf1-+-C:puppetmaster::monitoring Add Prometheus monitoring

c7d65ad2a7-+-prometheus::snmp_exporter: Avoid Ferm-specific syntax

a8019fb9d6-+-librenms: Avoid Ferm-specific syntax

10ec978ddb-+-pki: fix rename of intermediates

954e2816be-+-pki: rename intermediates to prevent aux.pem cloning on Windows

e9af17df9f-+-lists: rename repo templates to be compatible with Windows

2bbbde0513-+-admin: add spec test for hashuser

a634b16c44-+-Revert "Revert "microsites/query_service: enable TLS when monitoring commons-query""

bdd29ea9d5-+-planet: remove support for buster

8af13746cb-+-memcached: provide the CA cert when listening to TLS

ebd7a4d387-+-kubernetes::master: Switch blackbox check to paging

ad600e4031-+-deployment_server: revert temporary cleanup patch now that cleanup is done

8952d050ba-+-kube_private: fix path to obsolete spark-history private data directories

e7b33e7e52-+-[apt-staging] Swap content for source in file directive

9a2b00f4cd-+-kube_private: cleanup obsolete spark-history private data directories

d856329bfa-+-[apt-staging] Deploy gitlab-package-puller script

6f2a35ded8-+-Remove ID for gnmic user

0a36447f63-+-pyrra::filesystem::config: propagate ensure to the file resource

2d187453e7-+-Create /var/lib/atlas

6578a81094-+-site.pp: Add acmechief1002

534bd246e5-+-wdqs: remove ldf check

4862c8753f-+-wdqs: decom wdqs10[09-10]

cb021641a3-+-site: remove buster VMs from planet regex

a3f5cbb7b1-+-profile::pyrra::filesystem: remove Lift Wing Pilot

ce82992bbf-+-mariadb: decommission hosts

1ed5dd0a5f-+-Add cumin1002 to list of DB root clients

88d88a9657-+-mariadb: productionize db1234 db1249

dea7da39c6-+-Create initial stub role for logging-hd and configure for Puppet 7

b83de537f9-+-Mark profile::homer::private_git_peer as optional

a21222c94e-+-homer: Fix typo in parameter name

3f155338cf-+-Apply cluster::management role to cumin1002

4eaaa0de38-+-homer: Add profile option to disable homer for a given host

5cb2f6f3af-+-kubernetes::master Fix logic for certificate_expiry_days

b2888de30e-+-Add cumin1002 to puppet

01e4723766-+-elastic: slightly simplify site.pp

dfcbbb573b-+-restbase: set production role and add config for restbase2032

4ff7bc112c-+-kubernetes::master Fix syntax error concatenating strings

0eed8ed0b7-+-kubernetes::master Group blackbox checks per cluster

bbd7921fd1-+-kubernetes::master Add blackbox checks for kube-apiserver

8aa7101676-+-kubernetes::master Add blackbox checks for kuber-apiserver

e56f390b3d-+-mariadb: decommission db1128 db1129 db1147

543352e99a-+-spark3: add option to specify spark history server address to yarn

21f1b94a6e-+-Revert "[yarn] Add the option to configure the spark history server address"

bd51fc7cfd-+-mariadb: productionize db1232, db1233, db1248

3aac277fb2-+-P:toolforge::checker: remove kubernetes node readiness check

a388aa611a-+-[yarn] Add the option to configure the spark history server address

3b38c89aca-+-C:idm:deployment restart Bitu on configuration changes.

b5d8935f79-+-modules/amd_rocm: Pull firmware-amd-graphics from bpo for Bullseye

63a5d97469-+-Add AMD GPU configuration to ml-staging2001

e7d7b30908-+-P:openstack: nova: fix file path

afa8e68612-+-phabricator: add dedicated blackbox check for collab team and severity task

0a83159bfe-+-P:openstack: nova: add script to run console commands

c113e7e475-+-varnishkafka::instance - Add ensure param

15f1312cfd-+-openstack: spreadcheck: remove in favour of server groups

c61e4e3569-+-add sessionstore100[4-6] to site.pp

65a9059e9b-+-mariadb db1137 → db1237

951f4b712a-+-mariadb: add db1226

0d2281022e-+-An an option to configure the event log storage location for all spark jobs

33af1f117c-+-parsoid::testing: Avoid Ferm-specific syntax

32a7f8cc3f-+-mariadb: db1129 → db1229

69e90b1c3d-+-mariadb: db1128 → db1228

d9f69f9963-+-alertmanager: add sink notifications capability

db082cc8a7-+-Initial checkin of community_civicrm module

a60d58af2e-+-wdqs: Try icinga-based check instead of blackbox

8983530f12-+-query_service: duplicate monitoring checks for sre-collab team

470fc3065c-+-restbase: set production role and add config for restbase2031

e4594196b2-+-Add testhost2001 to site.pp

4cbe42ec45-+-P:mail: use wmcloud.org instead of wmflabs.org in envelopes

3819207208-+-netops: prometheus::hosts: also probe ipv6 if available

e0a7b702cb-+-wikikube: put kubernetes10[59-62] in production

d650c14b3c-+-swift: write to local files and ban before centrallog

03fe4a66eb-+-mariadb: remove db1141 db1142 db1143

aa7a569fed-+-mariadb: decommission db1138

1bf5f9c2bd-+-disable_tool: use the gitlab repository

596b15abda-+-klaxon: Ensure the klaxon user has a home directory

a270773be4-+-keystone fernet_keys: remove old absent section

c575a3ad55-+-wdqs: simplify ldf endpoint check

888c07fcde-+-ircecho: Migrate the ircecho script from Python 2 to Python 3

256ee7e908-+-gerrit: Avoid Ferm-specific syntax

83e346e60b-+-wdqs: remove extraneous insetup role

68dfa2ff37-+-wdqs: move params from body to path

f8bb62bfb1-+-miscweb: Notify search platform for sites they own

f2c319cfef-+-wdqs: add ldf endpoint logic

52f987402b-+-wdqs: monitor ldf endpoint

d197e6faf2-+-miscweb: Avoid Ferm-specific syntax

3251d607a9-+-doc: Avoid Ferm-specific syntax

c3803450eb-+-Add new sessionstore node to site.pp and preseed.yaml

4179a80e89-+-Rename ceph to cephosd

ce79091313-+-add kubernetes10[59-62] to site.pp

d6a5236ce2-+-apt_repo: move hiera data into module, to allow for validation

25af1dd547-+-Add ganeti103[5-8] to site.pp

93ce240aec-+-Revert "microsites/query_service: enable TLS when monitoring commons-query"

8bd176450f-+-restbase: set production role and add config for restbase2030

1c45fd89f3-+-Revert "wdqs: monitor ldf endpoint"

ee690afb5b-+-wdqs: monitor ldf endpoint

86f8673ca2-+-Fix syntax for drop rule

d640af7c2b-+-nftables requestctl: Some tweaks and fixes

cb0d830f93-+-Fix handling of Ferm's 00_defs_requestctl when changing firewall provider

8474fd9b86-+-docker_pkg: install convenience symlink

001fe6bae3-+-Update the refinery version used by the refine test jobs

060067be06-+-mariadb: Decommission db1119

55f784788b-+-Keystone: add logic to manage credential keys

3c0348a74b-+-deployment-prep: Switch mwlog01 to mwlog02

66fb8c8525-+-microsites/query_service: enable TLS when monitoring commons-query

464e16f1be-+-planet: add ensure parameter allowing to disable update jobs

c130b61bd0-+-wdqs: open firewall rules for graph_split

eeb8e083d5-+-P:wmcs::instance: adjust syslog handling

f701e31bac-+-vrts: add v6.4.5 required packages

0bc01a1128-+-restbase: set production role and add config for restbase2029

98350d2dff-+-ganeti: Remove non-PKI code for RAPI access

dd91c815f5-+-piwik::dataase: Avoid Ferm-specific syntax

9b9cf6cb41-+-Revert "wdqs: Monitor LDF endpoint"

a9efd4d05b-+-Revert "wdqs: Improve regex for ldf check"

b630aaa9ee-+-firewall::service: spelling fixes, add missing parameter comments

6b349d989b-+-wdqs: Improve regex for ldf check

9a50d5b75d-+-wdqs: Monitor LDF endpoint

03c925425e-+-wikifunctions: Drop beta monitoring

f77ea33248-+-Bring an-coord1004 into service as a hadoop coordinator

e5039cc6eb-+-Include the profile::lvs::realserver profile on the dse-k8s-roles

acac3e0357-+-Move mw api servers to kubernetes workers

24a015a005-+-C:netbox switch Netbox-Next to use plain OIDC

c02e23643c-+-site.pp: db1119 will be decommissioned

0d5d11dbac-+-Revert "mariadb: Promote db1119 to m5 master"

9f73e59415-+-restbase: set production role and add config for restbase2028

76070f08df-+-peopleweb: fix typo after ferm->firewall change

aabf84edb3-+-peopleweb: replace ferm::service with firewall::service

3911d3b6cc-+-etherpad: replace ferm::service with firewall::service

1ec34448c9-+-vrts: Avoid Ferm-specific syntax

cc0a24f919-+-prometheus::sysctl: Support configurable sysctls

ec5a1c98a3-+-lvs::realserver::ipip: Check that TCP MSS clamping is working

0869226856-+-quarry: use github remote

d5cf0fcde0-+-centralserver: reintroduce tls-remedy for centralserver

2b15a607f9-+-Bring an-coord1003 into service as a hadoop coordinator

2036d2a734-+-mariadb: add db2194 to multiinstance pool

5c48b9bac1-+-prometheus: exclude timer units from systemd collector

b75d570d12-+-prometheus: re-introduce distro-specific node-exporter arguments

c38f1d2882-+-analytics::postgresql: Avoid Ferm-specific syntax

a1c67b8248-+-statistics::web: Avoid Ferm-specific syntax

e4e56d7871-+-archiva: Update outdated comments

0f9672de26-+-Remove analytics_cluster::hadoop::client role

099dee9386-+-P:url_downloader add blackbox exporter.

bcf4196141-+-Move mw api servers to kubernetes workers

eb13c49959-+-k8s: allow setting prometheus retention in cluster definition

78285d7a0c-+-parsercachepurging.pp: Increase retention back to 30 days

413e1dbd5d-+-mariadb: Promote db1119 to m5 master

10ab406de5-+-wdqs: remove ldf endpoint monitoring

7b9891c218-+-wdqs: fix blackbox check for ldf endpoint

69b056f9ba-+-wdqs: Add blackbox check for LDF endpoint

286bab86fd-+-Add new ceph node to site.pp and apt_repo.yaml

5894a5f72c-+-Promote rdb1013 to master, drop rdb1009, rdb1010

9f218a270b-+-docker_registry: Don't add control planes as authorized nodes

9fe6fe0da6-+-mediabackup: Update mediabackups to use new TLS CA and prepare for 0.2.0

e1e5871460-+-O:prometheus: provision cloud instance in codfw

9fd7199635-+-P:prometheus::cloud: get openstack exporter from puppetdb

99b4c6c120-+-Remove flerovium from site.pp

54a7a36da0-+-Move new ganeti hosts to insetup::infrastructure_foundations

fb1eca9b72-+-Update CentralAuth login failures metric

a7ebff9e1e-+-mariadb: Move db1119 to m5

919291b819-+-Revert "mariadb: Promote db1119 to m3 master"

e6ffdfdb31-+-Add new elastic nodes to site.pp

dfa956869c-+-elastic: prepare new hosts elastic110[3-7]

e0554c91b1-+-miscweb: remove wdqs ldf endpoint check

ddd57a7cc1-+-phabricator: turn deploy script into template, support for php7.4-fpm

b22882593f-+-rabbitmq: don't include openstack client packages

273f0c8fb0-+-profile::pyrra::filesystem: use histogram count for LW latency pilot

9fa2eee0e2-+-mediawiki::php: Set php-common version dependent on OS

6011dbcb24-+-profile::pyrra::filesystem: add Lift Wing SLO latency use case

7f40255a9b-+-P:cache::haproxy: make http_proxy optional

ccfade676d-+-Add a unit-test that validates the structure of the preseed hieradata

1c45a66119-+-mariadb: Remove db1126

b6287ed7c2-+-rdb101[34]: Set them up as redis misc replicas

94ebeea1e5-+-ceph::server: Avoid Ferm-specific syntax

b250cdb7f3-+-wikikube: put kubernetes20[57-60] in production

d41693e7b0-+-gerrit : Avoid Ferm-specific syntax

681b8b39c9-+-mariadb: Promote db1119 to m3 master

b22f8996c0-+-Add new kubernetes node to site.pp

a11023dd44-+-Add new ganeti nodes to site.pp

4686d3f512-+-phabricator: if distro newer than buster, use python3-mysqldb

617cf73d18-+-miscweb: change wdqs ldf endpoint blackbox check

570a690e8e-+-P:dns::auth::update: add support for generating .ssh/config via confd

5b215b25f2-+-P:dns::auth::update: add support for authdns-update hosts via confd

a8c338861c-+-P:dns::auth::update: add support for setting ferm rules via confd

1409d97258-+-flink-zk: Activate codfw hosts

a81871445f-+-profile::pyrra::filesystem: fix lift wing pilot

2ec6641406-+-profile::syslog::remote: Add support for pki

33ca0700a0-+-syslog::centralserver: use mTLS for blackbox check

1fc2daf44e-+-profile::syslog::remote: create variables for cert and key

0991bf22d9-+-profile::rsyslog::syslog: refactor base::remote_syslog to a profile

4266ad66a1-+-lvs: Use profile::base::enable_rp_filter

a81a4f3c5b-+-P:wmcs: disable systemd icinga alerts

a5a32c11d6-+-Revert "admin: update admin modules so users without sshkeys get nologin shell"

ec94f8c087-+-admin: update admin modules so users without sshkeys get nologin shell

5d84fbd07d-+-prometheus::ops: Fix lvs_realserver_clamper config

9e48b92e0d-+-scap3: stop defaulting deployment_group to 'wikidev'

df5d34224d-+-profile::pyrra::filesystem: reduce scope of the Lift Wing's pilot

21fa33b455-+-P:base::production: move system::role to profile::base::production

caacab569a-+-fix-staging-perms: set group name from Puppet

91c0937ee8-+-C:statistics::compute: correct user param

eb37928851-+-base::sysctl: Allow disabling rp_filter

b390827ebf-+-Revert "P:httpbb: check for basicauth_credentials using defined"

5e7214b592-+-realserver::ipip,ncredir: Move IP[6]IP[6] ferm rules to ipip profile

c56cedd0a6-+-karapace: Avoid Ferm-specific syntax

5f2a4ed98c-+-decom cp1075-1090

39e2491b32-+-ncredir: Fix ncredir_ipip ferm rule saddr

6137c74ae8-+-R:icingamonitor::elasticsearch::cirrus_settings_check

56d2d031db-+-P:httpbb: check for basicauth_credentials using defined

879793cbf7-+-admin::get_users: add function to get a list of configured users

791352b037-+-lvs::balancer: Limit ipip-mq-optimizer prometheus endpoint reachability

0863bffd07-+-wikitech: remove port 80 ferm rule

84639539b5-+-Add new logging-hd nodes to site.pp and apt_repo.yaml

227d0097fe-+-Add new elastic nodes to site.pp

c235d6ceab-+-profile::openstack::base::puppetmaster::frontend: Avoid Ferm-specific syntax

ad04df68ea-+-P:scap::dsh: add documentation

41222ce50b-+-ldap: client: auto-restart sssd-nss on failure

6e98b063db-+-openstack::cinder::user: Switch to systemd::sysuser

0845888d27-+-miscweb: fix typo in wdqs ldf endpoint check

f70c555aee-+-P:envoy::builder: disable timer logging

bead755078-+-P:tcpircbot: delete a previoulsy absented resource

a455115a0b-+-puppetserver::rsync_module: pass the ca_server

5977125a9f-+-ganeti/pki: Allow configuring an SSL chain file

00b7d267e2-+-merge_cli: drop old absent resource

803e2ce963-+-Revert "puppet-merge: add prometheus metrics"

3416038dca-+-ganeti/pki: Use chained cert

af6b066851-+-puppet-merge: add prometheus metrics

254d408fad-+-bacula: only export resources if we have puppetdb support

6dfcb6675e-+-ncredir: Allow IPIP/IP6IP6 inbound traffic

a171b9d613-+-cloudnfs: refactor configuration

c0ed63bf31-+-ganeti: Drop explicit require in pki query

59879d1140-+-Use separate /etc/ganeti/ssl directory if using PKI

c5eff06b7c-+-Add new restbase node to site.pp and apt_repo.yaml

1a7cfc5abd-+-miscweb: resolve wdqs ldf endpoint to wdqs1015

02e222c4e5-+-miscweb: Add wdqs ldf blackbox check

548513a473-+-site: add planet[12]003 to planet role

647939a8e7-+-P:tcpircbot: fix minor style violations

6b8235e13f-+-interface::ipip: /etc/network/interfaces order issues (take #2)

1fa6e08d8b-+-interface::ipip: Fix /etc/network/interfaces up order

4de53a9398-+-interface::clsact: Fix unless cmd

264854a75f-+-Revert "query_service: add monitoring for ldf endpoint"

1f6fc93fed-+-Add support to write out blocked networks from requestctl

ce8ccd5144-+-ncredir: Enable IPIP encapsulation on ulsfo

742036d906-+-lvs,pybal: Deploy ipip-multiqueue-optimizer for IPIP enabled balancers

80eeedf0db-+-rsyslog: fix duplicate conf declaration in netdev_kafka_relay

5ce66200d6-+-profile: Provide a lvs::realserver::ipip profile

ecdd65ee93-+-P:openstack: nova: try including the chain in cacert.pem instead

f8587352ee-+-rsyslog: move netdev_kafka_relay to rsyslog-receiver

57600e9ee5-+-P:openstack: nova: include puppet ca chain for libvirtd

64f38c4e2c-+-dbbackups: Remove quotes from sudo command due to sudoers flattening

1c43f11227-+-query_service: add monitoring for ldf endpoint

f16f1bd1a0-+-Pass RAPI key/cert depending on whether configured for PKI or not

92e128e1e0-+-prometheus: fix storage_retention_size for k8s

b9fa45b0c8-+-prometheus: use per-instance retention hiera variables

5f209f0670-+-interface: new define for managing routing rules

f86835674b-+-interface::route: add support for cloud-private bgp routes

32b1b45b40-+-interface: new define for managing routing table names

de5c027243-+-dbbackups: Execute the checks under the new Unix user backupcheck

593519ff3e-+-dbbackups: Unify configuration of checks and prepare for 0.8.4

4c788a30b8-+-prometheus: remove unused parameter

9443e47237-+-ganeti: Add option to enable PKI-based RAPI cert

b7d3dc15e1-+-rsyslog: get ::conf to notify the correct instance

b79c86d7ea-+-Add new Hiera option to be used to selectively test defs_from_etcd on nftables

7d05df8e4c-+-interface: attempt to resolve ordering issues with tagged interfaces

640af0365e-+-profile::mediawiki::php: Remove support for PHP 7.2

f8b5c13d41-+-mariadb: Promote db1195 to m2 master

9cb6563e52-+-P:puppetserver::git: add wrapper for using git as gitpuppet

a9ec7304ad-+-puppetserver: use deploy script on initial setup

46f158236d-+-tlsproxy::envoy allow setting stream_idle_timeout, 180s for swift

fdee293e21-+-mariadb: replace db1147 by db1247 on s4

ca2300a422-+-interface::ipip: Fix absenting

aa6c1cdd61-+-interface::manual: Fix absenting

e9748fef74-+-rsyslog: move centrallog to ossl

492e487618-+-Remove all remaining references to oozie and clean up

dfd24bc77e-+-network: update WMCS network data

d48a42e264-+-P:puppetserver: enable CA monitoring

7d4dc87f40-+-mariadb: notification toggle on dbhosts

228f033a0a-+-Generate subnet DHCP configuration

c0d6f5a96f-+-Remove oozie configuration from core hadoop configuration files

a3bb29c67d-+-Revert "rsyslog: deploy netdev_kafka_relay to rsyslog-receiver"

d39813f0ff-+-rsyslog: deploy netdev_kafka_relay to rsyslog-receiver

b11a5f5e17-+-Correct insetup role for lists1004

eb7cb33122-+-interface: fix absenting of post_up_command

4fcaa57431-+-mariadb: new host on S8

2548438d79-+-mariadb: add a new host on s1

8cf155c243-+-prometheus: fetch from rsyslog-receiver exporter

38cf933172-+-Fix Matomo TagManager functionality

ecf0b00d14-+-rsyslog: ship a separate 'receiver' instance

10129f9f67-+-mariadb: add a new host on s2

b185356d10-+-rsyslog_exporter: move to a define

a416fb5868-+-rsyslog: support alternative base in ::conf

0927c63aa8-+-varnishkafka: move to rsyslog::conf

6afac9c354-+-mariadb: add a new host to s3

6f017779b3-+-rsync: do not included config for absented modules

63dfc865e1-+-mediawiki::packages: Drop python-pil

23113265b0-+-mariadb: Promote db1119 to m2 master

21a41b966a-+-puppetserver: use a symlink to swap in new code

30b76587c8-+-apt-staging: unbreak rsync puppetry

1b18665fb7-+-site: add planet[12]003 with insetup role

f6c4ac2446-+-g10k: spelling

a74733797c-+-doc: move rsync auth secrets to new location to unbreak puppet

6ea053bb71-+-prometheus: Add a default rsyslog destination for all sites

4414c43069-+-cloudlb: explicitely bind openstack mysql to ip

3192489a7c-+-pybal: do not install from component

f7c3eb56a9-+-airflow: change max_active_runs_per_dag back to 1

ce0d3b009c-+-rsync: ensure daemon is started after config

49a6a865ca-+-puppet:agent: change error to warning

923122aeeb-+-Move mw appservers to kubernetes workers

f643d4d697-+-cloudlb: wikireplicas: fix frontend filename

5182df7436-+-Add wiki replicas to cloudlb

a23d7a004c-+-P:wmcs: wikireplicas: allow access from cloudlb

fead13f650-+-Revert "prometheus: update to request testing certs from pki"

88d99db400-+-prometheus: update to request testing certs from pki

d2f628337d-+-docker::reports: change ownership of base rebuild job

097613a9b6-+-interface: Add a clsact helper

ac7f764ef5-+-interface: Allow creating IPIP interfaces w/o an endpoint

a6c2fad604-+-pybal,wmflib::service: Add ipip_encapsulation flag on lvs

f5f3a666a3-+-Revert "centrallog: update tls_netstream_driver to use ossl"

e3e3d2c01d-+-Add alert for CirrusSearch reported memory issues

88c06bd9bb-+-refine - Put SpecialMuteSubmit and FeaturePolicyViolation in exclude list

f676f81219-+-java: update certificate name

9ea2eea7e9-+-bacula: Increase the amount of maximum volumes for regular backups to 140

7d44b1fb52-+-realm.pp: drop ntp_peers

fe4ba119cd-+-Stop refining SpecialMuteSubmit events

f839f82045-+-eventlogging: Remove obsolete FeaturePolicyViolation schema

9c25fd5be1-+-realm: drop mail_smarthost global

07a25c0a73-+-vtrs: update vrts to use configure smarthosts

9877351736-+-phabricator: convert to pull from profile::mail::default_mail_relay

588d22e283-+-airflow: convert to pull from profile::mail::default_mail_relay

d02a61c403-+-mail::default_mail_relay: update to have a smarthosts parameter

3558239974-+-centralserver: probe syslog receiver with client auth

36068d8330-+-centralserver: remove icinga tls listener check

79390e574d-+-centralserver: remove tls_remedy

3d12f59df9-+-mediawiki::packages: Clean up absented packages

deca7e2fdb-+-realm.pp: drop wikimail_smarthost global

ead63bc1c2-+-sanitarium_multiinstance: over private_wiki and private_tables vars to hiera

cbbd8be52e-+-swift: migrate one node to envoy for TLS termination

08b5820c4b-+-dbbackups: Update config for mysql backup monitoring

b084b87443-+-prometheus: node_puppet_agent: improve debugging abilities

332fa22c11-+-centrallog: update tls_netstream_driver to use ossl

64ac3e6088-+-base: switch rsyslog tls_netstream_driver to ossl

ce10104ec2-+-Remove the oozie integration from hue

c4fb216b06-+-Add LoginNotify cron job

696bffe377-+-puppetserver: remove log spam from user home dir sync

913ba909fe-+-acme-chief: Mask acme-chief.service on passive nodes

632530417d-+-Clean up additional ORES leftovers

07bd2eeb03-+-prometheus-puppet-agent-stats: this timer sometime fails

1747deb01c-+-Remove beta-prometheus

7fef6588f2-+-profile: adjust oidc probe name

a41f590515-+-oauth2_proxy: add blackbox checks

a434b13e48-+-realm.pp: remove old comments

ffee266e87-+-mariadb: add a new host on s5

081e767aef-+-realm.pp: drop use_puppetdb global

6882ce0c65-+-Add wiki replica backends to conftool

5b93b5284f-+-pcc:clean_reports:

59c6069122-+-Send metrics from Airflow analytics test

7050764d0f-+-mariadb: add a new host to s6

f94bb02907-+-Configure the analytics prometheus instance to start scraping airflow

56f71c51d4-+-kubernetes::global_config: add listener for mw on k8s transition

fe63f01c2e-+-mariadb: replace db1143 with 1243

7668f74532-+-thanos: disable auth_cas when running in OIDC SSO mode

e6534605bc-+-testreduce: Reduce innodb_buffer_pool_size to 4G

14ccd193de-+-simplelap: avoid hardcoded PHP version string

ca73d55c01-+-planet: Update for rawdog v3 on bookworm

f2e4ca28a8-+-puppetserver::g10k: Ensure the control repo exists before we run g10k

b8b2fbcf70-+-phabricator: install python3-phabricator if bullseye or newer

d334780fff-+-Fix an issue with the matomo TagManager configuration

75591e7d76-+-piwik: avoid hardcoded PHP version string

95d129f681-+-sslcert: use concat to generate trusted_ca

3851d3b8ad-+-Clean up ores configs not used anymore

8e3708ddc5-+-mariadb: prepare copy of db1142 to db1242

ca64047c45-+-Fix the location of the matomo config override file

0c21527000-+-puppetserver: make rsync config more flexible

1c4512d92b-+-Configure Matomo's TagManager to write to existing tmpdir

9bc943b02d-+-dbbackups: Update mysql CA for content and metadata backups

e341c96a70-+-O:puppetserver: create role for per-project puppet server

e24c294a47-+-profile::prometheus::ops: remove ORES Redis configs

294275700a-+-profile::httpbb: remove ores_test configs

7dd0d313c2-+-Switch moss nodes to role::insetup::buster

dc40175d70-+-Remove ORES roles and configs

6105b542ac-+-Extend Wmflib::Team type with Fundraising Tech

75c3cab3e3-+-Apply crm role to crm2001

d680ba4cc2-+-Create a new initial role for crm hosts

92c8ee3eea-+-Adapt VM name

8f333df4a5-+-mariadb: Move db1119 to m2

6d7a78c795-+-wmflib: add function to return PHP version based on distro version

b64b5fd297-+-update site.pp and partition info for new an-workers

8254377b66-+-puppetserver: only create '/var/lib/puppet/server' when needed

dad708e278-+-puppetserver: create a necessary parent dirs

e656183b63-+-mediawiki: Add missing frequency param to the purge_temporary_accounts job

53df6a3c7d-+-logstash: beta-logs to use current w3creportingapi template

9bb9658b9c-+-decommission: db1136

d6f3f8fe04-+-Add crm1001 to site.pp

3532cbc927-+-Automatically generate autoinstall subnet DHCP config files

559ee1b684-+-puppetserver: cache code

f2c16a4dcd-+-puppetserver: change ssldir to a concat fragment

4966046c0c-+-cassandra: remove references to graphite

dee3708734-+-P:ldap::client: updated outdated comment

506cf6bd66-+-mariadb: add db1241 and prepare db1141 retirement

ada517b105-+-site: remove references to cloudmetrics hosts

d64f8c3069-+-Add a prometheus_instance parameter to prometheus::statsd_exporter

3ef757ede6-+-mariadb: Promote db1164 to m1 master

f8ec44acb5-+-Revert "profile::pyrra::filesystem: improve/fix lift wing pilot"

b15cc331a8-+-cloudelastic: switch new hosts back to insetup

52440a5b46-+-cloudelastic: bring cloudelastic10[07-10] into svc

5e905894fa-+-Stop applying oozie profiles in most places

72b5c4f599-+-Remove the oozie client

cd269f9bed-+-Stop oozie server and remove some resources

619e7bf430-+-mariadb: decommission db1130

7c6fb0166f-+-decommission: removing db1127 from eqiad

4727447b38-+-Clean up hadoop coordinator roles by removing analytics_meta DB

a28c00db59-+-canary_events - bump refinery-job to version to pick up retry logic

bca90bfa40-+-Refinery job - bump jar versions for refine and test refine

7a57108f16-+-Remove mentions of decom'd cloudvirts

c822d85e91-+-Add kubernetes2054 to codfw wikikube cluster

c03eee95ff-+-profile::pyrra::filesystem: improve/fix lift wing pilot

d502c4a470-+-remote_syslog: force rsyslog-openssl on buster

344aa80438-+-acme_chief: remove backwards compat

d98caa671a-+-insetup::unowned: Fix name of firewall profile

13c8c30604-+-Correct insetup role for lists2001

7b4a19b109-+-Generate the netboot.cfg file to avoid typos impacting everyone

551e0b2f4d-+-Clean up cn=ops from mod_auth_cas config for o11y

c5dfc1e670-+-thanos: add oidc support via oauth2-proxy

7a649563f0-+-oauth2_proxy: new module

190b94eb8f-+-phabricator::main: add support for PHP versions other than 7.3

66e5af96e4-+-phabricator/httpd: add support for bullseye/bookworm PHP versions

ad26be5493-+-site/hiera: remove decom'ed phab-test1001

84e4d40c8c-+-nftables::service: Ensure we correctly check for ipv4 and ipv6 ips

b1382dd108-+-mediawiki: Run expireTemporaryAccounts.php daily

02b09ffd5d-+-profile::pyrra::filesystem: add Lift Wing pilot

ed7facb5e2-+-search-loader: remove references to search-loader[12]001

543372415c-+-Switch phab-test1001 to insetup::buster

890a838fde-+-P:bird::anycast: migrate to nftables

f9ce636999-+-wmcs::kubeadm: migrate to trusted ca path

df26a3c46b-+-toolforge: update to use trsuted ca path

4d262f0671-+-openstack: update to use multiroot CA

5d0627f552-+-P:openstack: galera: fix firewall port

7ce2727e25-+-cloudlb: haproxy: migrate to firewall::service

bcd1952b0e-+-mariadb: add db1238 and prepare db1138 retirement

7a85497aba-+-Add dedicated insetup role for Buster

611430360f-+-mariadb: Promote db1119 to m1 master

fb9dcbcb18-+-Revert "refine - bump to refinery version 0.2.25 to pick up JsonSchemaConverter change"

9aee09d773-+-Prepare cloudvirt1025-1030 for decom

05031d7f33-+-prometheus: add build and envvars api metrics

960cce151e-+-refine - bump to refinery version 0.2.25 to pick up JsonSchemaConverter change

afaa007d64-+-[apt_repo] Ensure that parent directories of basedir exist

5b66f2ec7c-+-Add mediamoderation_scan to $private_tables

4585db623e-+-varnish: only listen on a single, local TCP port

f3ff66dd45-+-varnish: remove TCP monitoring

8c9d520ec6-+-[apt-staging] Fix apt_staging.yaml, add envoy config and pki

83aa0157f0-+-Re-generate the skein certificates during business days

bff112b851-+-scap: remove references to cloudmetrics1003/4

b330e081af-+-C:prometheus::ethtool_exporter suppress logging

e267ea2f7f-+-etcd: update to use shared SSL CA

9ea8bd092e-+-Revert "etcd: update to use shared SSL CA"

4538b18a1a-+-etcd: update to use shared SSL CA

b9237c9d40-+-Put new cloudvirts (cloudvirt1062-1067) online

9386ddb77b-+-dynamicproxy: simplify redis replication code

1d3ad22237-+-Add sretest1004

16a9aa12ee-+-[apt-staging] Add rsync endpoint for ci->apt pipeline

57968eeaff-+-icinga: Remove unnecessary python-phabricator Python2 dependency

1a24082aa7-+-hiera: re-order new cp hosts in eqiad

4f88ca7063-+-pontoon: add pki to o11y

55b9bec2f1-+-haproxy: remove dbproxy1017 from production

f9887e10f6-+-test/refine - update refinery jar version for analytics test cluster refine job

b626f408cd-+-P:openstack: trove: use cloud-private for memcached in eqiad1

cb1b1a70fc-+-P:openstack: keystone: sync fernet keys over cloud-private

f063af4970-+-gitlab_runner: Migrate to new runner registration scheme

64a72794a5-+-thanos: Avoid Ferm-specific syntax

e9bb2869a1-+-P:base enable ethtool data collection

581213815d-+-alertmanager: add alerts-triage on /triage

98a43b9c1b-+-wmcs-backup: also remove expired backups via delete-expired

880f425921-+-stewards: use git:clone parameters to share repo among several users

ca2652d921-+-openstack::glance::service: Switch to systemd::sysuser

292e361bd0-+-stewards: add git::clone of stewards/onboarding-system from gitlab

8a7b73c965-+-aqs: add .../aqs/deploy/src/ to Environment

e79b99e482-+-Revert "Revert "airflow-wmde: Place airflow1007 in airflow-wmde role""

92b843103a-+-Revert "Revert "airflow-wmde: Add wmde service user to the Yarn production queue""

cf83c6cb92-+-mariadb: update to use shared SSL CA

cdec99b127-+-Revert "Revert "airflow-wmde: configure wmde airflow instance""

ef5a6c87fd-+-varnishkafka: update SSL CA to use shared CA

58d2a0bc2c-+-nftables: notify correct service resource

5ace99a608-+-puppet: move puppet run to files

09983c6753-+-profile:k8s::deployment_server::mediawiki: switch php catchall

eaac65365a-+-stewards: fix package name for python3-requests-oauthlib

81e9d83cf9-+-stewards: create initial role and profile

1904c2193d-+-wmcs-backup: second attempt to add cleanup timers

b29e1e7bf3-+-puppetserver: don't run puppet merge on puppet7 infrastuctre

dd97aa0632-+-site/netboot: add special VMs for stewards

a3c90067c0-+-puppet::agent: add ability to disable puppet timer

9094351727-+-Fix: make sure to enable skein certificate renewal on airflow launchers

9d0fa14cbb-+-openstack: replace openstack_controllers variable

90396a86b6-+-mediawiki: Add purge cronjob for pc4

c04f2129b9-+-airflow: update SSL certs to use combined CA

102ba3e086-+-Tidy up analytics.pp whitespace

4653747056-+-puppetdb: update to use shared SSL CA

12685db752-+-netbox: update to use shared CA

646998f9fb-+-pontoon: deal with empty hosts in public_lb

ec9e662e98-+-backup_cinder_volumes: cleanup  (including old backups for deleted volumes)

4a7c6f46eb-+-Revert "wikistats:wikia: pause updates while changes are made to table"

29cc0985e7-+-P:openstack:codfw1dev enable prom exporter

0ee521c6d0-+-Enable monthly skein certificate renewal on airflow launchers

45287c4636-+-C:prometheus::ethtool_exporter add -skip-no-link option

79e314733b-+-Renew skein certificate every month via systemd timers

15737807db-+-Remove unused profile::pki::server

2fbd42ad0a-+-pki: notify apache when the cert is refreshed

fc5ddbb22c-+-httpd: use a variable for service_name

9791ffb90f-+-grafana: Avoid Ferm-specific syntax

7d7628f6b0-+-acmechief_host: drop this value as a global

63fe4503c6-+-Create a new role for analytics_cluster::mariadb and assign it

0ea342cc1a-+-docker::gc: Add timeout parameter

a886fa9153-+-wikistats:wikia: pause updates while changes are made to table

636b23b613-+-[apt-staging] Add apt_staging role to new staging vm

3aaff1d3ad-+-Provide a script to determine whether a given Puppet node can be swithed to nft

74938c321a-+-openstack: neutron: remove unnecessary refreshonly

65eab72228-+-P:openstack::base: fix project_grants ordering

e0b208b83c-+-acme_chief: Make http_proxy optional

c4435db02d-+-profile::ci::php Also add the icu67 component following what was done for prod

a8e995d960-+-P:openstack: fix fernet key rotation in codfw1dev

a0086b7805-+-P:openstack: drop firewall rules made obsolete by cloudlb

901e88d57c-+-prometheus: ipmi_exporter: remove absented resources

f2b075b447-+-prometheus: mysqld_exporter: fix puppet ordering issue

7ff2d97745-+-haproxy: enable healthcheck-dedicated backend

c7d365b755-+-prometheus: ipmi_exporter: add explicit dependency for sudo rule

7b6374ba78-+-haproxy: remove multiple backends choice

8b878d5168-+-dnsdist: update dnsdist.conf.erb for 1.8.x

6d79fe4d5d-+-openstack: add wrapper for the common patch pattern

abe38eebc2-+-P:openstack: galera: fix ordering issue

0679e57b00-+-rsync: add explicit dependency on the package

3492ec2343-+-base: add explicit dependency on rasdaemon

43b9d2e9c9-+-Setup rsync between apt1001/apt1002

3ee17b1b2e-+-mariadb: clone db1136 to db1236

2896dc5369-+-[apt-staging] Add apt-staging host for CI pipeline

f0fbefd037-+-docker::builder: switch systemd timer to our new script

78839931a9-+-systemd: allow passing source to a unit

ba4b692ad4-+-diffscan: fix state for multiple instances

6c4cb23990-+-bastion: Avoid Ferm-specific syntax

9ef9333a0e-+-P:diffscan: add scan for WMCS infrastructure addresses

29c408d5d5-+-P:diffscan: add support for configuring multiple instances

6d8baede8a-+-diffscan: add support for multiple instances

8908170f7f-+-kubeadm: add required config for containerd

d4e718bc0a-+-kubeadm: containerd: add kernel modules and config

070708a20a-+-kubeadm: only install containerd.io with docker

63193c3643-+-netbox: Avoid Ferm-specific syntax

af83e17d0c-+-docker::builder: fix image location

692c6de9d5-+-docker::builder: add ssh script

de4ba0e4b4-+-docker::builder: add system to properly perform a weekly update

b305da2f80-+-RT: Avoid Ferm-specific syntax

bb32d76346-+-logstash: add uri_host field to w3creportingapi template

8b36a097e7-+-Add new cloudclontrol and cloudnet to site.pp and netboot.cfg

8fbb9c578e-+-pybaltest: Avoid Ferm-specific syntax

8807f6d01e-+-package_builder: Avoid Ferm-specific syntax

a58f99bfc1-+-Fix puppet error by providing the openssl absolute path

3886a04cf0-+-Fix typo in unless condition

7deb1f075d-+-mariadb: db1131 decomission

49b4d26a77-+-Convert the Skein private key to the PKCS#8 format

051ceb9017-+-etcd::client::globalconfig: switch to wmf-ca-certificate

1570d947a1-+-cfssl::ocsp: use client mtls certs if present

319d075935-+-Generate an RSA 4096-encrypted private key for Skein

c4384d97de-+-pki::multirootca: Add parameter so pki can generate its certs

189a349038-+-Enable the management of the skein certificate via Puppet

0d236f7d69-+-P:pki: use wmf-ca-certificates

c6f126900e-+-P:monitoring remove remainders of check_eth.

688983f9c4-+-search-loader: removed unneeded package dep

e8aff82050-+-profile::mediawiki::common: set default histogram buckets

189a87b049-+-profile::mediawiki::common: include prometheus statsd_exporter

f8c1dd2333-+-openstack: nova: add a dependency on libvirt-clients

4abcb9918a-+-puppet::agent: correct white space in motd

0c09194e54-+-puppet7: Add a motd to inform users a host has been migrated to puppet7

84c94b0c8b-+-search-loader: Bring new hosts into service

b4f7f4edc1-+-search-loader: use default system python

24b34578a6-+-mariadb: add a new host (db1230)

923a0dee86-+-Revert "realm: use puppet7 acmechief when on puppet7"

7ba1ecaffa-+-realm: use puppet7 acmechief when on puppet7

480b29dd8f-+-prometheus: require replica_label to be set

405cd1ef11-+-aptrepo: set Auto-Submitted header on reprepro change emails

404f2d9e0c-+-P:monitoring remove remnants of checkpuppetrun

1947f85b8c-+-site.pp: Add acmechief2002

331443ba2b-+-P:openstack: fix openstack_exporter host hiera key name

11782e4473-+-arclamp: Avoid Ferm-specific syntax

0ce088ff92-+-O:wmcs::monitoring: drop role

1b4523b1f8-+-P:wmcs: drop graphite manifests

35aff1381f-+-P:wmcs::prometheus: drop profile

6f324dae59-+-P:alertmanager: drop cloudmetrics hosts

8dca9efbb0-+-prometheus: ipmi_exporter: add dependency on package

7726f6ff54-+-site: Re-image cloudmetrics hosts as insetup

09ecc43267-+-nftables::service: Fix file name variable

254c3d4131-+-Revert "Fix puppet on cloudvirt-wdqs* until they have been moved"

cf8c568de0-+-PCC::clean_reports: allow reports to stick around for 90 days

eb9a63dbd3-+-profile::contacts: update so the _role_contact has not been sanitised

52c377f697-+-systemd::unit: rename unit to name

3b1ef53069-+-docker::reporter: route k8s alerts to service ops

ec388d85e9-+-firewall: Allow ferm::service to accept an empty list for ranges

ba56daa928-+-httpbb: set ServiceOps as the team owner for httpbb jobs

62cb01df25-+-mariadb: Remove sustained lag monitoring from misc dbs

f5417eea4b-+-tlsproxy::envoy: check for NotUndef instead of falsy

23ddcadae4-+-firewall: allow empty sranges

a593c9bb90-+-Revert "[quickdatacopy] Fix default selector for ignore_missing_file_errors"

e77e94ba30-+-[quickdatacopy] Fix default selector for ignore_missing_file_errors

a39874abb9-+-rsync::quickdatacopy: ignore_missing_file_errors should not be optional

a51bff0d8d-+-systemd::service: Add service owner parameter

ea8fd662cb-+-contacts: add new type for WMF sre teams

068a81cd5f-+-profile::tlsproxy::envoy: Add support for passing nft firewall definitions

92d1b7459f-+-Unconditionally install kafka-kit on kafka brokers are they all run on Bullseye

df87a3c93e-+-[quickdatacopy] Add success_exit_status option to rsync::quickdatacopy

8abf329999-+-[systemd/timer] Add optional SuccessExitStatus argument to timer services

406dac02f7-+-Revert "P:puppetserver: Add profile to create puppet-prometheus_..."

acd3f9b4cf-+-Remove obsolete profile::nftables::basefirewall

d878544739-+-profile::piwik::database: Enforce type for port

6808a338d4-+-backup::host: Avoid Ferm-specific syntax

0495a73761-+-bacula::director: Avoid Ferm-specific syntax

b4727b6b8b-+-Add a Hiera option to enable ICU67 component

9800418585-+-Reduce LibreNMS syslog retention to 15 days

347a0b3716-+-idp::memcached Avoid Ferm-specific syntax

b5a3f4e3db-+-site.pp: cleanup decommissioned restbase hosts

e8ea1f2a31-+-Decommission restbase1018

fb5386b682-+-Decommission restbase1017

5fe25d4f98-+-puppet::agent: allow 'false' for certificate_revocation

6c6be6b16a-+-sretest: remove old test

c544f1054b-+-puppet: allow to override certificate_revocation even on puppet7

619a03f184-+-Decommission restbase1016

647d9475c3-+-puppet::agent: allow to disable certificate revocation

1d6e78ca91-+-apereo_cas: remove recurse on log dir.

cf049e4439-+-acme_chief: add new puppet intermediate CA to list of trusted clients

cce4b7d487-+-pki: remove trailing quote

7ca48670f0-+-pki: remove leading whitespace

b0a9de5861-+-Ensure that alluxio cache directories are present for presto

b55332105d-+-profile::pki::multirootca: Add initial CRL

7170514b9d-+-profile::pki::multirootca: allow port 80 from mgmt

434e3a40c4-+-hiera: added new cp hosts in eqiad

278778e8d7-+-puppet_compiler: bump version

be8850925e-+-puppet_compier: its buster that needs the backport

073e763db7-+-wmflib::compile_redirects: convert to modern API

eb31e46f78-+-P:wmcs::kubeadm: install containerd on bookworm

de30e7ffdf-+-P:wmcs::kubeadm: rely on iptables-nft on bookworm

764a3d1d23-+-jobrunner: increase open files limit

5124c1037d-+-alertmanager: ship amtool.yml for AM api access

50dddb50a8-+-Decommission restbase2012

c4468d093f-+-profile::tlsproxy::envoy fix docstring typo

cc41753149-+-prometheus: add cloud replica label

d8cc6052d5-+-prometheus: enable pint for 'cloud' instance

13ca08d4c9-+-prometheus: enable thanos upload for cloud instance

e92815f10f-+-graphite: migrate configparse to new puppet API

e78739a8ef-+-cas: improve error messages

1cc0db5246-+-mariadb: Replace db1127 with db1227

28fd2e87aa-+-mariadb: Productionize pc1016, pc2016

8d14e71e56-+-pyrra: add logstash-requests detail

f572ee4a4c-+-firewall::service: Remove notrack sanity check now that it's implemented

54f7035f23-+-alertmanager: allow api access for alertmanagers hosts too

9b0e327f91-+-nftables::service Write out notrack rules for services skipping conntrack

3c77ccd494-+-puppet_compiler: add typing_extensions

fc59bcd3cd-+-Drop kafka-jumbo100[1-6].eqiad.wmnet from the puppet site

bf14109153-+-Setup a prerouting chain in the base table to exempt traffic from conntrack

d9da464b2a-+-P:cloudceph: cleanup firewall rules

30706b02e2-+-Define environment variables to ease the use of prometheus-metricsfetcher

25966e8bda-+-Remove the need for the analytics-meta database to require java

8fd9151d02-+-P:openstack::pdns::auth: make pdns web server listen on all IPs

6a8efd3472-+-Update the email address used for refine-test systemd jobs

3340650a1a-+-mariadb: add s6 replacement for db1131 (db1231)

a38358b622-+-Fix issues with multiple spark shufflers specific to version 3.1

2e11336a4e-+-prometheus: switch alerts to cloud prometheus

f0b544b2c5-+-firewall: Fix interval of metrics export

8e7343f478-+-P:toolforge: provision root sudo policy via here

e7b1f45b5d-+-Add textfile exporter for nftables check

becf53204c-+-backy2: add log rotation

a54a9e578d-+-puppet_compiler: add hack to fall back to pson

4754287151-+-P:toolforge: docker: enable --delete for the registry rsync

ea556ac344-+-toolsdb_replica_cnf: Remove firewall rules

b3d0140458-+-sretest: drop user group

c44881ff42-+-kubeadm: drop default

5062f4a65f-+-sretest: Add file to test binary content

30da51fb04-+-thanos: update reload endpoint to reflect updated web prefix

5b089096af-+-mariadb: Move db1119 to m1

7b72bee073-+-pyrra::filesystem: remove [] from slo definition

272e3087ec-+-elastic: make request latency alerts more granular

6a22e5df7e-+-vrts: add new required packages v6.3.4

677ce952e4-+-pyrra: add logstash requests slo

8862fcc9bb-+-pyrra::filesystem::config: add pyrra filesystem operator config manager

c1983fa8bd-+-C:prometheus::ethtool_export Add ethtool exporter.

4973e2d65d-+-puppet_compiler: bump version

a41d33228a-+-P:monitoring absent Incinga check_eth.

e4f1a195f9-+-Publish metrics reflecting skein certificate expiry

5634750104-+-thanos: reverse-proxy /rule to rule-hosts

84dff1e4f3-+-thanos: allow thanos-rule to serve /rule

24d2fba544-+-spicerack: enable distributed locking in production

1b3a001dc2-+-Include two new temp codfw sretest hosts in site.pp

5fca0fd1fb-+-add db1229 to site.pp

49c6617c4a-+-pyrra::filesystem: correct config permissions

8562eb5f93-+-pyrra: add prometheus external url

f0eb93552b-+-Revert "airflow-wmde: Add wmde service user to the Yarn production queue"

3d4c3124c2-+-Revert "airflow-wmde: configure wmde airflow instance"

e4bcc5d9c6-+-Revert "airflow-wmde: Place airflow1007 in airflow-wmde role"

c678553ed2-+-airflow-wmde: Add wmde service user to the Yarn production queue

8bfcebfb28-+-base,ssl: Add digicert-2023 unified public certs and RSA intermediate

0f80d43167-+-phabricator: remove redirector & config

f45067ca98-+-nginx: make /etc/nginx depend on the package

b78307bddf-+-Fix the name of the spark yarn shuffler packages

070ca2ae4c-+-Fix typo on yarn-spark-shuffle package name

71964023df-+-docker_registry_ha::web: drop support for using puppet_certs

939131747f-+-Revert "Remove kafka-jumbo100[1-6] from puppet"

f05f4f08e7-+-Remove kafka-jumbo100[1-6] from puppet

f2f7f28b99-+-P:monitoring Puppet runs are now monitored by Prometheus.

69a20ca965-+-airflow-wmde: Place airflow1007 in airflow-wmde role

3504ea5150-+-airflow-wmde: configure wmde airflow instance

8358407f6b-+-alertmanager::api: enable POST logging

02b776b0b8-+-arclamp::redis: double maxmemory

22a895845c-+-prometheus: add redis_arclamp to redis jobs

ac06858c6e-+-arclamp: add redis exporter and prom scrape config

181c25922b-+-security: use concat to construct access.conf

629a005631-+-Make it easier to use topicmappr reblance

3808b67706-+-add cp11[00-15] to site.pp

0383666341-+-radosgw: Enforce header name and CSP

51479c2e22-+-profile::parsoid::rt_server: Fix quotes

db1015eaa9-+-search-loader: Move bullseye hosts back to insetup

706e0e0a9d-+-Add a define to run periodic metric checks

53ab46336c-+-Add puppet elements for newly added switches.

a900195698-+-testreduce: Set innodb_buffer_pool_size to 4.6G

44e8c4f858-+-gerrit: make gerrit ssh key more DRY

da6c3eafd0-+-metricsinfra.alertmanager: add victorops and paging route

3298b61537-+-wdqs: fix graph split cyclical dependency

5560cefc34-+-wdqs: bring graph split hosts into service

6ef8d6e6d6-+-wdqs: Set up graph_split hosts

c865d09ea9-+-Support configuring the spark3 defaults with the default shuffler

3229ed4187-+-Support multiple spark yarn shufflers in parallel

a6a0a25eee-+-wmcs::cloudlb: add cloud_production profile

464ef7fdf2-+-cassandra: add utility wrapper & instance symlinks for sstableutil

ad0c22da1c-+-P:wmcs::novaproxy: enable keepalived for HA

dd9ebb6266-+-profile::statistics::explorer::ml: change owner of published dir

6e250374fa-+-dnsrecursor: remove need to run labs-ip-alias-dump twice

54f2aba378-+-aptrepo: Create /srv/private/junos in Puppet

a95546bb3e-+-profile::statistics::explorer::ml: rename script to model-upload

27a8ed1fd7-+-profile::prometheus::k8s: fix (part 2) k8s-pods-kserve's label drop

cd1b359890-+-helmfile: Cleanup chart pull timer

a72cec21a8-+-gitlab_runner: block dockerhub on Trusted Runners

253e2efff2-+-Revert "profile::prometheus::k8s: fix drop label rule for k8s-pods-kserve"

3452062c5e-+-profile::prometheus::k8s: fix drop label rule for k8s-pods-kserve

563129b435-+-profile::prometheus::k8s: drop unused labels for k8s-pods-kserve

1c9ebed239-+-add stat1011 to autoinstall and site.pp

17824f42c1-+-Assign apt_repo role to apt1002

ec1752b106-+-hiera: announce ns1 IP from bird (codfw)

063690ebfa-+-P:IDM Enable logging of remote IPs.

7e663de5d6-+-druid: Bring druid1011.eqiad.wmnet into service

ed69652c6d-+-P:idm Provide callback to test system.

e79de2d49e-+-Fix mariadb restart behaviour on testreduce

695dac1cd7-+-P:monitoring remove remnants of dpkg monitoring

2881ecee45-+-idp: Avoid Ferm-specific syntax

b4ef93e7ff-+-opensearch: disable shard size check on logging opensearch

8cef8a5ddc-+-P:monitoring Cleanup after cpu_freq removal.

820f62014a-+-P:spicerack: parametrize cookbook dependencies

6da09fce1b-+-aptrepo::rsync: Don't setup rsync for empty list of secondary servers

559d13356c-+-P:monitoring handle Puppet error on missing source.

7a8b35da33-+-P:monitoring absent dpkg monitoring from icinga.

4616845a69-+-C:prometheus::node_dpkg_success

c7b30bd6a7-+-P:monitoring remove check_cpufreq check from Icinga

2d996339c5-+-gitlab: use one sshkey for gitlab and remove suffix

74ac27332d-+-pdns_server: rename privilege for bookworm

ed61ba3272-+-wmflib: Add monkey patching

2b6ec2842d-+-profile::prometheus::k8s: fix k8s-pods-kserve settings

b0d99e4f51-+-profile::prometheus::k8s: add k8s-pods-kserve config

5275e09e86-+-P:prometheus::cloud: make openstack deployment a parameter

dbe99104df-+-visualdiff: Switch to systemd::sysuser

7af9e1ab57-+-prometheus: use openstack_exporter_host in prometheus cloud

9234ba5b06-+-debmonitor: Avoid Ferm-specific syntax

dac7a2168c-+-Set KbdInteractiveAuthentication/ChallengeResponseAuthentication per OS

f6c5a50d84-+-prometheus: add 'cloud' instance

16ea44e5ef-+-openldap: Avoid Ferm-specific syntax

1c008fdc37-+-testreduce: Auto-restart parsoid-rt server/client and mariadb on failures

503bce2948-+-Change ganeti-test2004's role to ganeti_test

009412ec59-+-neutron-api: standardize service name to 'neutron-api' rather than '-server'

aced47d78a-+-Add kubernetes2054 to site.pp

8d0d3e6e07-+-config_master: add an installer directory

71fb960125-+-P:toolforge: remove obsolete config files

41bbdda4f4-+-puppet agent: protect against a missing client bucket path

bd6e177e92-+-prometheus-postgres-exporter: install configs before service

7c7d4a7a83-+-ganeti-test2004: add to Puppet

dcd5374b68-+-Remove profile::ganeti::ganeti3 option

62f082556c-+-Install kafka-kit-prometheus-metricsfetcher on kafka brokers

d6156299c4-+-profile::statistics::explorer: ensure /srv/published/wmf-ml-models

5562e227e6-+-Add new apt servers to site.pp

3a090ae883-+-correct roles for an-master1003,4

e0330666c4-+-puppetdb: avoid creating database users via dbconfig

3f518edbd5-+-os_updates: make class ensurable

17b79fe960-+-postgresql: fix ordering on a new install

365b561562-+-puppetdb: add ability to configure db_ro_host

f0c945ed75-+-openstack::clientpackages::antelope::buster: typo correction

dee1309200-+-cloudgw: don't declare the vrf-interface

c366a12420-+-scap: Avoid Ferm-specific syntax

81c7faac32-+-cloudgw: reorder post-up commands and other fixes

13755c80f8-+-cloudgw: create the vrf-cloudgw device via static file

8d58f8f393-+-puppetdb: move bookworm db's to puppetdb role

ec6af22407-+-wmcs: cloudgw: rename resource to avoid clash

025cebe312-+-cloudgw: move routes out of keepalived into interfaces

f00c14bd78-+-cloudgw: add an IPv4 address for each node in the cloudgw <-> neutron subnet

9426112ee7-+-cloudgw: refactor interfaces setting to use the base module

3b8bbe6936-+-pupetboard: move to puppetboard role

0e531f8c16-+-Blacklist exfat

0a5333660f-+-puppetdbquery: drop module

9943949e1b-+-puppetdbquery: remove all refrences to query_resources

e40b2c6524-+-prometheus::cluster_config: sort targets

791d316021-+-prometheus::pdu_config: update to use wmflib::puppetdb_query

601d9f4c63-+-redis::slave: switch to puppetdb_query

f769e7bc5b-+-prometheus::redis_exporter_config: update to use puppetdb_query

649f2dcd4c-+-prometheus::jmx_exporter_config: update to use wmflib::puppetdb_query

5c9bac899a-+-prometheus::resource_config: update to use wmflib::puppetdb_query

90d3d41842-+-prometheus::class_config: convert to wmflib::puppetdb_query

673621ea9c-+-mirrors: Avoid Ferm-specific syntax

3321c2acec-+-prometheus: switch to wmflib::get_clusters

bdb1b24200-+-P:prometheus::ops: convert to using wmflib::get_clusters

0e1e45558e-+-wmflib::get_clusters: create a puppet version of get_clusters

f2ed97780f-+-site.pp: Remove ORES machines (real and VMs)

eb08793223-+-druid: Bring druid1010.eqiad.wmnet into service

abc3768857-+-gerrit: remove duplicate $gerrit_site definition

d5cc9210f5-+-Reinstate absented package list bullseye without ISC libraries

e2674adda6-+-Neutron: update init script for api service in Antelope

31b75a6c3a-+-openstack admin scripts: remove wmcs-ceph-migrate

bbd87f00c9-+-add cloudvirt10[62-67] to site.pp and netboot.cfg

4c9d4b770d-+-corrected an-master100[3-4] in site.ppi

70850ab85d-+-P:mw::deployment::server: Don't alert for train-presync

aad00f66a2-+-correct an-master1003,4 in site.pp

79b646e9f4-+-icinga::toollabs: page if toolschecker is down

ce26f9ff44-+-P:wmcs::cloudgw: fix routing table references

fc85382a61-+-P:dumps::distribution::ferm: pass array directly do ferm::service

d196fb1e2f-+-aptrepo: install zip on aptrepo servers

0614a0dfd5-+-cloudgw: refactor to set up routes independently from keepalived

98269ec887-+-rabbitmq: Avoid Ferm-specific syntax

a345d00f21-+-ci: manage cinder volume on Castor instance

8694813fa3-+-elastic: remove elastic10[48-52] from site.pp

c0c13537f2-+-profile: enable wal on grafana sqlite db

5a8aff7d94-+-dumps: replace WMCS paging Icinga check with Blackbox probe

c778417945-+-add an-master100(3,4) to site.pp

cef6adfe46-+-thanos-rule: add pyrra filesystem operator output dir to search path

d44e77b115-+-wmflib: clarify 'params' service::probe parameter

0a311fed8c-+-P:toolforge: install toolforge-builds-cli

f32f954c32-+-Revert "wmflib::get_clusters: create a puppet version of get_clu..."

bbf7045ef9-+-Revert "P:prometheus::ops: convert to using wmflib::get_clusters"

68e49b2c7e-+-Revert "prometheus: switch to wmflib::get_clusters"

0d441abd1a-+-prometheus: switch to wmflib::get_clusters

df71c87459-+-P:prometheus::ops: convert to using wmflib::get_clusters

de59f3cbc2-+-wmflib::get_clusters: create a puppet version of get_clusters

799702a004-+-thanos: remove thanos components from thanos::frontend role

78fe058b64-+-Remove profile::cloudceph::client::rbd_glance

8ee9d30ef3-+-radosgw: include a few missing pieces for eqiad1

bd71bc9026-+-Add radosgw apis to eqiad1

a2b1c77b4a-+-radosgw: remove a duplicate firewall rule

4e328b73f8-+-ntp: lower the warning and critical thresholds for check_ntp_peer

30327644f0-+-puppetserver: puppet to the prometheus-node-exporter user if needed

c53b728f84-+-P:puppetserver: Add profile to create puppet-prometheus_reporter config

b96cd0b89d-+-purged: parametrize purged frontend and backend address

55e1a376bb-+-dnsbox: add ntp.anycast.wmnet as the anycasted NTP address

3ff0a59a67-+-Add Auto-Submitted: auto-generated to I/F scripts using mail

8fba1f2c51-+-scap::dsh::group: switch from query_nodes to puppetdb_query

dbb75d46ff-+-druid: update to use puppetdb_query instead of query_classes

fe5536ee4a-+-rsyslog: update code to support cfssl and puppet

620ccf87b8-+-druid: Bring druid1009.eqiad.wmnet into service

f85815ee85-+-site: Put cloudcontrol1006 back into service

25ae5393be-+-maps: remove per-host healthchck

718120c310-+-wmcs: instance: install isc-dhcp-client

f124721fee-+-Revert "standard_packages: Remove more obsolete packages after buster->bullseye update"

29113b0934-+-Only install ppolicy.schema with OpenLDAP < 2.5

900db7c282-+-thanos::httpd: include rewrite module

274acd4ddf-+-traffic hosts: use broader regexes everywhere

2a783d7cc1-+-webperf: Avoid Ferm-specific syntax

8f03b7b762-+-docker:registry::web: Add documentation

eb5c438744-+-docker_registry_ha::web: add docker_registry_ha

7c7338856c-+-Services: Remove pybal/LVS entry for ORES

5020dbd429-+-P:mediawiki::maintenance: CampaignEvents periodic

9778880244-+-P:mariadb::ferm_wmcs: cleanup unused rules

d1a3b928bd-+-P:mariadb: drop special firewall rules from m5 servers

80eb7f7de6-+-P:mediawiki::periodic_job: Add splay parameter

ce5669b524-+-dragonfly::supernode: Avoid Ferm-specific syntax

1b40543e75-+-Remove config option for challenge response auth

612fa61e21-+-standard_packages: Remove more obsolete packages after buster->bullseye update

482bf2f4f7-+-gitlab: use static name in failover backup, increase concurrency

c08402f982-+-openstack: rename openstack_controllers to memcached_nodes

65067ec30d-+-Cleanup remains of haproxy-on-cloudcontrol

1e9fcc70f5-+-varnish: allow PURGE requests also from dedicated socket

c6730cd03a-+-puppet::expose_certs: automatically include the ca chain on puppet7

2d3d67b186-+-Render an environment file for kafka-kit to reduce manual toil

aad0ad56d4-+-Take cloudcontrol1006 out of service

86917b1c9a-+-firewall: Also move the sysctl under the manage_nf_conntrack conditional

b16adc86ba-+-rsyslog: update to use pki certificates

c3df24bf86-+-[kafka] Install kafka-kit on bullseye/bookworm brokers

3c52b7f094-+-airflow-wmde: Remove statsd analytics-wmde user

4a3f5fcd03-+-add mossbe1003 to site.pp

f811f90e6f-+-role::kafka::jumbo: exclude kafka-jumbo100[1-6] from Mirror Maker

1d45a4e10b-+-C:idm::deployment ensure that rq service is enabled for git installs

b91ada8416-+-maintain-dbusers: just log to stdout

4d17b0adca-+-cloudgw: refresh puppet namespace

9a7cffbd71-+-cloudgw: Remove profile::openstack::base::cloudgw::firewall_profile

204c57d50d-+-Switch main cloudgw hosts to profile::firewall

4492255c21-+-haproxy: Add support for filter bwlim-(in|out)

a4b9e0b186-+-puppetboard-next: drop domain as services have now been migrated

3a9c2d8ce7-+-puppetserver: we use the backup profile for backups

ae5c3a85e5-+-puppetserver: add backups

5808bd4255-+-backups: Add new filesets for puppetservers

92859677bb-+-clouwgw: Update ordering for the variant using profile::firewall

c3187d4dac-+-Switch cloudgw/codfw1dev to profile::firewall

e3e20fe703-+-galera: Fix some ordering issues

0b1be02827-+-P:toolforge::instance: decrease priority of access rule

ed21967c19-+-dnsrecusor: Remove labs-ip-alias-dump icinga check

b143df359a-+-superset: Disable Prometheus scraping for superset metrics

b01a9cb09a-+-prometheus: Enable selective scraping for Prometheus

5a34dcb43c-+-add new lists server lists1004

d00a739ea1-+-site.pp: Fix number of cloudelastic hosts

806225fdb7-+-cloudelastic: Add new hosts into site.pp

33781203c5-+-cloudservices2004-dev: switch ldap backend to mdb

661fb5d9f4-+-cache: add netmap file for known-clients from requestctl

baa48509fd-+-cloud_management: remove unneeded tokens, profiles

0bf2803c30-+-zuul: replace zuul-gearman.py by gearman-tools

fef39c1344-+-phabricator: add configuration for the remote aphlict server

84dbf9e5a6-+-site.pp: use puppetserver not puppetmaster for puppetserver1003

241ee3b29f-+-prometheus: Prevent Prometheus from scraping certain statsd-exporters

4f628571d4-+-site.pp: migrate puppetserver to puppetserver role

3a065693b1-+-pdns: eliminate pdns::query_local_address in hiera

e38359a5a1-+-pdns: eliminate profile::openstack::base::pdns::auth::listen_on

6c683ba7d8-+-designate/pdns: refactor a bunch of address settings

cc6cd91e5b-+-linuxbridge: Switch to ensure_packages()

b1bbc25ee8-+-profile::cumin::cloud_target: Avoid Ferm-specific syntax

f2488e08a6-+-site.pp: correct typo

815e1c2463-+-site.pp: rename puppetmasters[12]004

589545d1a2-+-firewall: Add explicit check for provider == 'none'

68f422696b-+-site.pp: move puppetmasters[12]004 back to insetup

953171ab4c-+-site.pp: puppetdb[12]002 migrate to insetup::infrastructure_foundations

a0bb9f1035-+-site.pp: puppetboard[12]002 move top insetup::infrastructure_foundations

10cfbf9ae4-+-Don't include the OpenLDAP exporter on Bookworm

2559023a90-+-restbase: disable per-host icinga checks

d029a7f3b3-+-service: allow disabling icinga checks for 'node'

f0bdfb8e96-+-interface: ensure vlan package is installed when running command

0d8af3c70d-+-Configure ldap-rw1001/2001 as LDAP servers

957485a058-+-ipmi: ensure directory exists for package

780e2c0cb8-+-gitlab: remove deprecated grafana feature

aa0b477da8-+-Revert "openstack: Temp exclude cloud-private from cloudcontrol1007"

9e8b872637-+-standard_packages: Remove Python 3.7 packages after buster->bullseye update

bcdc13c85e-+-openstack: Temp exclude cloud-private from cloudcontrol1007

5a5a7e81bd-+-site: re-assign role for cloudcontrol1007

5520b7cb92-+-elastic: standardize eqiad & codfw p95 metrics

c55b0160e7-+-elastic: don't alert p95 if request volume low

1e60b5a5e4-+-Revert "elastic: don't alert p95 if request volume low"

9af8b6a572-+-elastic: don't alert p95 if request volume low

618e9652d9-+-puppetserver: add comment on avoiding perma-diff for /var/lib/puppet/ssl

401c3fbf79-+-wikistats: drop some updates

3862cb88fe-+-package_builder: add piuparts package

0ea89f7127-+-prometheus: add option to configure probe-specific params

9d56962770-+-apt: fix use of alternative mirror

f3a0b96b97-+-httpd: ensure mod commands are available

9bb5dd8a1f-+-nginx: add toggle for mounting lib on tmpfs vol

eed47acb2d-+-puppetdb prometheus exporter: in a container listen on all interfaces

8592684525-+-pki: disable mysql specific scripts when using sqlite

3e6682aadf-+-new  node T342660

bdde9b9b57-+-dispatch: remove puppetization

0cdd002d56-+-icinga/nagios: remove check_ores*

ee43b2e3e9-+-cloudlb: remove unused firewall rule

f06add8cf6-+-P:openstack::galera: drop nrpe process check

f8622f4ce9-+-icinga: Drop monitoring for *.wmcloud.org certificate

4a94364b07-+-P:openstack::pdns::recusor: cleanup remains from old setup

9d4f362610-+-puppet_compiler: roll back to 2.5.6

18a6735dbe-+-hieradata: remove more cloudmetrics1003 references

d52234cddd-+-kubernetes::node: Reserve CPU resources for system daemons

78dd42dce1-+-prometheus::k8s: Drop puppet class names

63046d2cce-+-site.pp: fix typo for new kubernetes hosts

cf0864f448-+-kubernetes: add kubernetes10[27-56] to wikikube

6492834a02-+-prometheus::k8s: Discover calico-felix targets from k8s api

ced8c094b5-+-k8s: Fix dependencies for resources requiring kube user

e5d1b97312-+-firewall: Default provider to none

0006cb8ba1-+-pdns_server: make the webserver address configurable

268e18c6f0-+-P:wmcs::prometheus: fix openstack-exporter

bba817ef0d-+-Move os-reports to the puppetdb host(s)

b838b9097e-+-puppet_compiler: bump version to 2.5.7

5dd6600a72-+-Add new apt-staging host to insetup role

60c827ca1f-+-Define a script in charge of checking the kafka broker in sync status

6a83221b9d-+-P:wmcs::cloud_private_subnet: fix typos

8f7ede552e-+-Fix puppet on cloudvirt-wdqs* until they have been moved

aa923015a2-+-sync-gitlab-group-with-ldap: Use --yes flag

9b64ac97d0-+-firewall: add 'none' provider

a95d69b3c0-+-prometheus: use alias rather than service_name when present

71438cf50a-+-P:wmcs::metricsinfra: add config for custom blackbox scraping

0e4842a6bb-+-systemd::timer::job: improve documentation to ensure path_exists

be8fa98270-+-P:installserver::proxy: move templates under profile/

08daf75b4a-+-P:icinga: move files under profile/

ff5c61b109-+-wikikube: put the new codfw nodes in production

508d779055-+-docker_registry_ha: fetch the list of nodes from the static list

24abccc0c6-+-C:idm::deployment update UWSGI base path to fit repo layout.

a9e18388eb-+-Remove most references to cloudcontrol1007

26bbf8597a-+-C:idm::deployment Create staticfiles directory

d2b12945f7-+-dynamicproxy: use a mariadb backend

2c8143766e-+-C:idm:jobs Use bitu command for systemd jobs.

5eca3fc925-+-Revert "Add new servers db1226-33"

07e4ddcdaf-+-Add new servers db1226-33

c33fc9057f-+-profile::service_proxy::envoy: rename uses_ingress to sets_sni

129eac5c4e-+-prometheus::k8s: Scape scheduler and controller-manager

8a80f23e35-+-k8s: Scrape controller-manager and scheduler metrics

5b801269ee-+-O:wmcs::openstack::instance_backups: enable cloud-private

76c4a95303-+-Connect eqiad1 cloudvirts to cloud-private

52ca320a0f-+-pki::multirootca: fix typo

aea36b533a-+-dispatch::web: correct /usr/local/bin/dispatch ensure

fceb57c189-+-dispatch::web: add ensure param and ensure => absent

a1dd2c6265-+-C:IDM Rework git install to function with new repo layout.

a1f55f3064-+-cloudlb: add hack to grant cloudcontrol1006/7 database access

cd6169a311-+-conntrackd: Add explicit check

0ee66277aa-+-thanos: load allowmethods httpd module

9ae988b6d9-+-envoyproxy: make sure 'envoy' user exists on log directory creation

4dd7fbe840-+-kubernetes: Make control_plane_class_name mandatory

791202faa0-+-openstack: eqiad1: services: enable cloud-private for cloudservices1005

0061df72de-+-dbbackups: Fix bug on config directory path: defaults -> default

a878b380cd-+-openstack: eqiad1: pdns: recursor: fix list of pdns hosts

3754855131-+-dbbackups: Separate ensure file and 'ensure' job as followup to 51607b8

02d81a404c-+-cloudservices1005: prepare for reimage and back into service

51607b8767-+-dbbackups: Add new check (focused on ES) of long running backups

0a728cdc01-+-C:idm::redis bind to both IPv4 and IPv6

9df710b8c0-+-add pki1002 to T342892

616641a483-+-growthexperiments: Run listTaskCounts for all task types

cc18ac4b7f-+-Update refinery-job jar version for analytics jobs

2dd7409a6d-+-Remove mention of an-test-client1001

cd0042fa29-+-Configure kafka-jumbo1015.eqiad.wmnet

e06277aacb-+-Configure kafka-jumbo1014.eqiad.wmnet

00c52e90c6-+-Configure kafka-jumbo1013.eqiad.wmnet

faa615faeb-+-Configure kafka-jumbo1012.eqiad.wmnet

973624c5d5-+-Configure kafka-jumbo1011.eqiad.wmnet

04aadf2903-+-idm::redis: Avoid Ferm-specific syntax

5fc569866e-+-miscweb/microsites: remove static-codereview resources

6fef8944ed-+-Switch netboxdb to firewall::service

1d33698a33-+-varnish: unify vsl_size to new default

013842a592-+-varnish mem: unify global default

92111e457d-+-m:openstack::clientpackages*: add patch to the list of packages

37bb5733c8-+-conntrackd: Switch to ensure_packages()

4ba3c161da-+-openstack: eqiad1: pdns: refactor monitor checks

537d61273f-+-Add initial support to move cloudgw to profile::firewall using the nft provider

b0ddfe1704-+-P:IDM Add mysql Python driver

59902e1f0e-+-openstack: fix source path for cli patch

e7e65f0dc6-+-openstack: apply the patch to override cloud.yaml on the cli

52a1c79649-+-miscweb/microsites: move monitoring of static-codereview to monitoring profile

4bba32ae59-+-gitlab: Fix Gemfile.local permissions and use absolute path in gitlab.rb

1c0c9634e3-+-netbox: Avoid Ferm-specific syntax

9317375537-+-P:idm fix log file path.

65ea85265a-+-kubernetes::master: Cleanup absent cergen resource

d1847cc295-+-kubernetes::master: Remove the use of cergen certs from apiserver

467112c096-+-wdqs: decom wdqs100[3,4]

860be4d311-+-cassandra: remove cassandra/twcs deployment

8b1109df77-+-dbstore insetup role adjustment

a62e09014c-+-add dbstore1008-1009 to site.pp

2341c3303a-+-Fix kafka-jumbo node regular expression

38d100f623-+-P:IDM Ensure that logs are created with correct permissions.

c1f62c3fad-+-kubernetes::master: Switch to PKI for SA signing

b8f5098375-+-Move Ganeti to firewall::service

67b66fcd39-+-dbutils: introduce statement define

2e7b0d8a67-+-Configure kafka-jumbo1010.eqiad.wmnet

d4d2b8e699-+-prometheus: let assemble-config write snmp.yml

b2acdd2d37-+-prometheus: fix old reference to prometheus-snmp-exporter-config

388292638f-+-prometheus: use assemble-config for snmp-exporter

99be5b9257-+-librenms: refactor ensure_packages

6ba12d05b2-+-librenms: use timer name in journal

2713435a99-+-librenms: fix permissions on logs and 'lnms'

f7c65e7a7e-+-graphite: Remove temporary blackhole for wanobjectcache hex-like stats

de79da1465-+-kubernetes::master: Switch to PKI for SA signing

1fe722e959-+-Put cloudvirt200[4-6]-dev into service

b4f0ac592b-+-wdqs: bring wdqs20[3-5] into service

f1991ce73a-+-Sync ldap/ops into GitLab repos/sre group (v2)

866f3c5d9b-+-search-loader: Move new VMs into prod role

f249c29907-+-rancid: fix log dir permissions

11f88e0de2-+-Sync ldap/ops into GitLab repos/sre group

a6e1b80522-+-site.pp: add new search-loader hostnames

9fa76566b2-+-ganeti: Avoid Ferm-specific syntax

dec557db79-+-P:idm enable bitu uwsgi application

6fcf677a95-+-P:idm move directory creation.

7d7ba7de19-+-firewall::service: Fix logic error in passing srange/drange to nftables

9253ac2b64-+-Revert "ganeti: Avoid Ferm-specific syntax"

fc4dc8e419-+-P:idm allow for installation via Debian packages.

d4c9ad8240-+-ganeti: Avoid Ferm-specific syntax

852c49298f-+-prometheus::nginx_exporter: manage nginx status site

ed41ae3dc3-+-dynamicproxy: improve connection error pages

c380fc40d9-+-nginx::status_site: allow multiple instances

93e0102176-+-Enable cumin hosts to reach the opensearch API on logstash clusters

397a7d834d-+-Remove debian::codename::require::min() checks for Buster

5801cd3634-+-vrts: apply role and setup hiera values

acd1eb0314-+-kubernetes::master: control-plane components should use the local api

9de7aa381a-+-k8s::apiserver: Use a separate systemd service for safe restarts

058edf5e2d-+-new backup node kubernetes10[27-56]

f0b63f634d-+-Drop the rsync migration setup for testreduce

8becfb36b8-+-varnish:common: add bookworm version for Python

4b9422a274-+-Remove scripts for cross-region migration

521987ff5f-+-[openstack] bridge-utils config in bookworm

0302b23ae8-+-[toolsdb] Remove unused primary/secondary roles

ab6acbc956-+-P:wmcs: unify toolsdb profiles

0402508c76-+-titan: move pyrra off thanos role

ba6cd490e0-+-cloudservices1004: decomission

874b733a34-+-nftables::set: Align names with the resource title and nftables::input

1d71a9e090-+-Register hadoop workers an-worker-1149->1156.eqiad.wmnet

b05b4e7115-+-prometheus: allow external management of blackbox modules

1820a2f819-+-Pass ensure->present to the nftables class if selected

2f8884fde5-+-site: apply role to titan hosts

43f095c90e-+-Routinator: tmpfs, bump the maximum number of inodes

b06fbc7948-+-Add titan100[1-2} site.pp

7b177cd16b-+-wmf_sink: don't assume project_name == project_id

4d8f454e09-+-superset: Move superset metrics to statsd-exporter

ca48aad39f-+-profile::prometheus::statsd_exporter: add support for empty mappings

8f282ebd54-+-ferm: Move more files under the service check conditional

1652686fc1-+-gitlab: add default_project_features parameter to profile

eef9507034-+-noc: remove profile, module

a7f5437d78-+-noc: remove from role::maintenance

7c01bc25b2-+-ferm: Add force true to force dir removal

1a238c36d1-+-firewall: only create stub file in the present changes

44d0c14b96-+-firewall: move requestctl logic outside of the ferm block

0c39ca6c8c-+-ganeti: Avoid Ferm-specific syntax

71b73cb35b-+-kubernetes::master: Validate SA tokens with the certs of all masters

b8ab347828-+-icinga: drop tools.wmflabs.org monitoring

2b948e0774-+-icinga: drop toolforge.org cert monitor

68106d3509-+-P:toolforge::checker: remove ToolsDB R/W check

02b79394d6-+-P:wmcs::metricsinfra: add missing trailing slash to url

4f20a32142-+-Pass down the ensure to the requestctl settings

f016e4f3c2-+-Use a single ensure for managing the nftables state

c4dd2b1445-+-openstack: use stock mariadb on bookworm

d74a9b55ff-+-designate-sink: don't install python2 versions of our sink plugins

241686078c-+-wmfkeystonehooks: don't install python2 versions

911a4ba0e9-+-designatemakedomain: don't install for python2

4205b1ea72-+-Galera: allow installing debian-hosted packages for Bookworm or later

69129cbcc2-+-ceph::common: allow bookworm and later versions

c88459515f-+-P:cumin::master: drop puppet constant change check

af1cbac736-+-puppetmaster: add pupetserveres back to git private

bcbd5ed306-+-puppetserver: correct ssl dir permissions

110a50dea3-+-puppetserver: fix ssl permissions

64db1c37de-+-puppetmaster::servers: remove puppetservers from puppetmaster::servers hash

eee7eb489b-+-Add new LDAP replicas

aafe033887-+-P:puppetserver: fix reports location

7de80057df-+-Decom furud

58892dc031-+-Adapt transition code for ferm -> nftables

7e386c9d7a-+-wdqs-internal: switch wdqs1016 from public to internal role

56d8001905-+-Provide zookeeper hosts in helmfile defaults

02d765764a-+-Revert "Start Blazegraph from systemd unit, without runBlazegraph.sh"

a4658134ef-+-Start Blazegraph from systemd unit, without runBlazegraph.sh

21ad063cac-+-[openstack] Add Zed manifests for Bookworm

3ad1166c9f-+-[openstack] Replace OS version in new manifests

04577d4f77-+-puppetserver: drop the puppetserver hiera key and use puppetdb

14c7d386a0-+-Clean up some cruft from past experiments

fc3b077139-+-puppetserver::git: ensure we create the user directory

fe74fa464a-+-puppetserver: only clean reports dir if dir exists

3cffa9bdd4-+-systemd::timer: add support for ConditionalPathExists

a76583a51c-+-stie.pp: move server to puppetserver role

1cb92722f5-+-nftables::service: keep port as undef if its undef

92808e8d46-+-nftables::service: improve error reporting

2d02de81b5-+-puppetserver::wmcs: correct parameter name

2a5cbb1503-+-nftables::service: Make the port optional

95c15d9117-+-P:prometheus::ops: add ensure filter for envoy

f23a8741a8-+-flink-zk: Use insetup::search_platform role

eab903104a-+-nftables_base_sets: Skip NETWORK_INFRA for now

6728fae439-+-firewall::service Check for presence of srange/drange in the nftables path

5a145e7a45-+-wmflib::hosts2ips:  Add new function

a9b21a02cc-+-prometheus: fix arclamp profile

0d3b99d88c-+-nft base sets: Read additional host groups from Hiera

8c1bd6b7b9-+-prometheus: drop unused resources

b80541e16c-+-Fix rsync config

c992b1cb62-+-testreduce: Setup rsync for data transfer

5d3a81b2b2-+-Add Phabricator reference

46b828cb35-+-prometheus: convert and to lower case

bc5b3f64df-+-puppetdb: add a motd to inform users that theses serveres are no longer live

54c22f0a33-+-debian: Remove support for Stretch and update spec tests

3a3a44e171-+-ferm: add ensure support to the ferm class

7e755928c6-+-eqiad ganeti test setup

ccf988847f-+-flink-zk: Move codfw hosts back to insetup

31f5fbfb2d-+-P:cyberbot: add bookworm support

39d0b29084-+-mariadb::packages_client: Remove obsolete OS check

b28469ee3a-+-Revert "ganeti-test100[12]: assign ganeti-test role"

09a43a02b2-+-ganeti-test100[12]: assign ganeti-test role

7195dd71fe-+-Remove visualdiff client/server from testreduce role

e5413e5304-+-standard_packages: Remove more obsolete packages after buster->bullseye update

a08d27f228-+-site: set proper role for durum300[34]

30937679bf-+-Add temp ganeti-test hosts

fb95bc970b-+-openstack: encapi: drop legacy ports

bde5a6addd-+-Fix use of more than one src/dst sets

c0a3bbb8fe-+-puppetmaster: add parameter to change the port that puppetdb runs

ba137fe0ca-+-site.pp: Split wikikube workers per DC

3aed1ca225-+-confd: Only notify the current instance

692415cd45-+-P:wmcs::kubeadm: remove version defaults

eb29301f48-+-openstack: Remove a bunch of Icinga checks

2ccc6a04a5-+-confd: -prefix from confd cli to confd::file instances

530fa91525-+-Remove bast4004/bast5003/bast6002

b932e0a9b0-+-cloudlb: haproxy: mysql: expose tcp port to cloud-private networks only

ce96906839-+-Simplify IPMI check

00dc62104b-+-prometheus mysqld_exporters: Remove support for stretch

984675ed25-+-Remove obsolete OS conditionals

a47772124f-+-librenms: Add PHP version for Debian Bookworm hosts

e63a7c7f1b-+-gitlab: project_features > default_projects_features

0e93ce1b06-+-Correct sysctl value for net.ipv4.tcp_min_snd_mss

648277f476-+-Add parsoid::testreduce role to testreduce1002

06d31f6390-+-icinga: Don't tie wikitech-static alerts to cloudweb hosts

622e6a220a-+-Additional antelope updates for stretch

15924fa656-+-profile::simplelamp2: Remove obsolete OS check

4fd6e2d80f-+-Update comment

9bddb68cb2-+-Remove bast4004/bast5003/bast6002 as bastions

a5d96468f5-+-package_builder: Clean up lintian setup

4be0650b60-+-Revert "Start Blazegraph from systemd unit, without runBlazegraph.sh"

8571dc9cd4-+-Start Blazegraph from systemd unit, without runBlazegraph.sh

d27f60fd77-+-gitlab: Remove swift configs and return gitlab1003 to restore group

8969c86621-+-miscweb/microsites: remove wikiworkshop and research resources

d8cc66d476-+-replica_cnf_api: add envvars backend

02b97ff409-+-miscweb/microsites: move monitoring of research pages to monitoring profile

0d9816eb87-+-prometheus: drop 'cluster' for gnmi job

f737bee91a-+-prometheus: fix gnmi relabel

35e8f899b8-+-Add testreduce1002

9c8a1de1af-+-Revert "ferm: add ensure support to the ferm class"

d75847a379-+-Move WMCS haproxy scrapes to WMCS prometheus instance

2600aed753-+-ferm: add ensure support to the ferm class

e2e8d98ab9-+-mariadb: Move db1119 to s1

7b750d1c66-+-openstack: eqiad1: pdns: use modern recursor setting for cloudservices1006

a473603528-+-Modify Juniper ZTP script used during initial provision

3760fa0cc8-+-Prometheus: gnmi re-label fix

1927e894d5-+-Prometheus: scrape gNMIc endpoints

4186ea62a3-+-gNMI: collect data from core routers

8615061617-+-C:idm:deployment link to runbook.

bcbf0e3329-+-gitlab: Support loading of local gems

f4c47cfa64-+-Fix comments

0275a5d84e-+-Stop building stretch images and update monitoring for the docker registry

761ffa6083-+-icinga: Remove PAWS certificate check

6e1899335a-+-icinga: remove PAWS check

0d4229b521-+-trafficserver: Allow configuring transaction_active_timeout_in

571cfa4a39-+-P:wikidough: add a require on the acmechief setup

975ee2cdaa-+-stie.pp: move server back to insetup

6cc03f4c5f-+-Fix hadoop-yarn log aggregation compression

9f763dccfe-+-gnmi: remove require for wmf-ca-certificates.crt

233a5b8347-+-php: Remove obsolete check

c0926a6a77-+-gnmi: Add require on files

5eb76e59af-+-Add gNMI based telemetry collection using gNMIc

fc8b65b557-+-P:IDM Update blackbox URL

34cbd3e15b-+-Remove now obsolete check given all Stretch VMs are gone

e6b069a240-+-cumin: update cumin host to use the puppetdb-micro service

75f077f427-+-P:idm fix blackbox monitoring

80ceaa7a4d-+-cloudservices1006: prepare service

f396531025-+-mariadb::packages_wmf: Remove support for Stretch

832b72f6cc-+-Allow MGMT_NETWORKS connect to apt server private server on 8080

2145421a70-+-aphlict : Avoid Ferm-specific syntax

48396c965f-+-etcd: Remove obsolete check

5eb3921522-+-cloudcephosd: Remove Ferm-specific syntax

e190da4b96-+-openstack: Remove obsolete client classes

223c2cc62a-+-uwsgi: Remove support for stretch

3148fc3fd1-+-mariadb: Upgrade db1225 to mariadb 10.6 (and generate 10.6 backups)

c0f34f729a-+-Add cloudservices1006 to site.pp

12bf7aa691-+-New files/templates for OpenStack Antelope (2023.1)

e5efe85254-+-vrts: add test VM

b59b478cff-+-nftables: fix port statement generation

ede8b9eab8-+-site.pp: move puppetserver1002 to puppetserver role

b20176ee19-+-kernel_report: small script to generate reboots task

3177b79d4a-+-cumin::master: add missing docs

de95e5c335-+-SSH cloud access: Remove support for Stretch

5061711e50-+-Remove comment references to EOLed distros

1b29e8979a-+-java: Remove now obsolete warning

a94a75b38a-+-mariadb: Comments to clarify db1118 situation

3628fd2529-+-wdqs1005: Disable notifications and remove from lvs

1431a1e3bb-+-p:grafana: pass the envoyproxy::enable to autorestart

97fe4d452b-+-Remove haveged

9ac88bc0ce-+-mariadb: Move db1118 to m2

af5ace0f68-+-puppetserver: puppetmaster1006 has been renamed to puppetserver1002

1613f01ca1-+-haproxy: Simplify systemd wrapper

aec2c6d39f-+-webperf,arclamp: Rename to clarify as separate roles

64b78c0a22-+-icinga: remove obsolete gerrit checks

08aa01b9af-+-Add moss-be2003 to site.pp

d44cb51fed-+-Fix typo in reference to new ztp_juniper class for aptrepo

c7c49bfbc9-+-Modify install and apt server config to support Juniper ZTP via HTTP

28fcdee16d-+-new bastions in ulsfo/eqsin/drmrs

e6e69212c4-+-wdqs: Add allowlist.txt

f734ddd997-+-puppetserver: ensure correct ordering when using an intermediate cert

2279a861cc-+-firewall::service: Replace whitespace in resource title with underscores

5225ec1322-+-mediawiki::php: Remove check

b67f7a6c7d-+-profile::environment: Simplify environment variable export

6c1e795657-+-firewall::service: Create an nftables::service when using the nft provider

f36af20d23-+-doc: rename user for rsyncing docs

1c39ad4436-+-os-reports: Remove Stretch, add stub entry for Bullseye

278cd6a969-+-statsite: Remove support for stretch

7870e9ee4a-+-Make nftables::service types more compatible

e22dea26bd-+-Update various comments

0aa6bc9b6b-+-Puppet: remove all mentions of knams

92b0462508-+-C:bigtop::hadoop Fix script path

7a685d4ba9-+-Convert the monitoring/prometheus ferm rules to a firewall::service

765863b3b8-+-C:bigtop::hadoop ensure net-topology script is installed.

0619769e0e-+-C:bigtop::hadoop move net-topology.py to files.

96f53c6288-+-P:terraform: don't serve BUSL licensed Terraform versions

e65b60b0eb-+-varnish: parameterize fe cache mem reservation

937cd04dbc-+-icinga: Add notification when purging nagios resources

1c78d69086-+-Add new kubernetes node to site.pp

ef7d7fbf35-+-jwt_authorizer: reflect changes to accept multiple issuers

bbb0eb7558-+-deployment_server/helmfile: Don't define admin_service_dir twice

e822814eeb-+-deployment_server/helmfile: Write admin_services_secrets to files

bc6a89e533-+-deployment_server::helmfile: Iterate over clusters groups first

0476305b0d-+-Make firewall logging conditional on ferm and rename the profile

52978637f1-+-gitlab: Add locking to backups

63fa2afda6-+-k8s::proxy: Start kube-proxy after ferm

582461c535-+-ferm::service: make port optional so we can use port_range

4e8c005c00-+-Revert "query_service: let puppet manage whitelist"

c90e9fac06-+-query_service: move allowlist file resource

b74004c39f-+-query_service: Set correct path for allowlist in blazegraph.pp

db7f6606a9-+-query_service: let puppet manage whitelist

b7eb97f900-+-site: remove older references to doh300[34]

55f0a922af-+-puppetserver::rsync: fix dir and ferm rule

0c5421c8fa-+-site: add wikidough VMs for esams

a4952a24d9-+-puppetserver::rsync: open firwall port

10f063f95d-+-realm.pp: add comments about updating mediawiki-config

7c450465af-+-profile::swift:fetch_rings: ensure we create directories

f7772f8d20-+-Add additional sets for monitoring/prometheus hosts

71c3ca699a-+-firewall: Add SSH rules in firewall-agnostic form

bbec669fe9-+-smart: Simplify check for hpsa

4172da4b08-+-swift/thanos: allow puppetservers to also pull swift rings

2f797a0ae4-+-interface::route: Make interface mandatory

bf60a21890-+-P:cloudceph::osd: explicitly set the interface and make route persist

6eec15508a-+-Retain yarn logs for 60 days and compress with gzip

da7cd1dbdd-+-puppetserver::volatile: we need to ensure if *not* empty

cac36deb4e-+-puppetserver::volatile: ony update conftool on puppetmasters

cd34a95223-+-Add a nftables::file::service define to install a custom nftables input rule

4069b3dc10-+-puppetserver::volatile: pass through correct private repo path

5a72904bcd-+-external_clouds_vendors: add way top specify the private repo

c5db8da8c5-+-standard_packages: Remove support for stretch

d055e8c9b5-+-firewall::service/firewall::client: Fix function name for dump_params()

eadd7a02e9-+-Revert "benthos::instance: remove unused parameter port"

081f63c224-+-puppetserver: add volatile config

87dcc97f53-+-puppetmaster::fetch_swift_rings: rename profile

23158edd36-+-benthos: stop using strings as configuration

27d6553331-+-apt: Remove support for Stretch

7a04d49e91-+-benthos::instance: remove unused parameter port

d81abbcc5a-+-confd: create run_dir via tmpfile

6fed93742b-+-firewall::service: Use correct type for port range

5be190b769-+-Add wdqs202[3-5] to site.pp and netboot.cfg

6d62499e59-+-interface::noflow: add optional parameter for pre-up

ab84c9c6d5-+-backy2: make postgres data dir configurable.

93bc96c9a2-+-site: change kubernetes::worker regex to include ex-thumbor hosts

93c3343d08-+-Esams: update PDUs in monitoring

a67ae0a92b-+-Extend the firewall::service shim with checks for legacy syntax

0d5ef3bae9-+-prometheus::haproxy_exporter: Remove support for stretch

fe52ca4420-+-Update the default user role in Superset to be 'WMF Analyst'

a0e769fb62-+-Enable profile::auto_restarts::service for ipmiseld

4d25c0fd04-+-confd: Explicitly require directory for systemd cleanup timer

b6bb36d507-+-kubernetes::node: Don't reserve CPUs for system

91bd2ea21c-+-thumbor: remove thumbor server configuration

89bea08a4b-+-Add a Firewall::Portrange define

0e1b8d2f1a-+-k8s: Reserve system resources on k8s workers

77ca87ee81-+-wmcs-backups: correct commandline for volume backup

131402da3e-+-Make bast3007 a bastion

73bee1ea75-+-Revert "Start Blazegraph from systemd unit, without runBlazegraph.sh"

046101ead2-+-site: reimage ncredir300[34] to proper role

b65c4a033e-+-Remove all mentions of old-esams, replace with new esams

0187e09dd6-+-site.pp: use correct hostname for doh300[34]

0ac00661f8-+-Add doh300[34]

c9a405e9ca-+-Add durum300[34] to site.pp

9e2d526939-+-puppetserver: switch to useing ca_server instead of enable_ca

5f83072f2a-+-Start Blazegraph from systemd unit, without runBlazegraph.sh

2e8f64dcfc-+-P:puppetserver: add support for extra_mounts

1fa5faf52e-+-puppetserver: Add support for defining additional mount points

0ce28a2d1d-+-Add ncredir300[34]

d82e010f15-+-releases jenkins: allow Scap to disable services on secondary hosts

bf7ae65ffd-+-configmaster: pass puppet_ca_server via vhost settings

fa390de138-+-p:tlsproxy::envoy: pass through the ensure option

a16a99cb13-+-P:config-master: proixy_sha1 variable needs to be added to vhost_settings

b130a77ba0-+-puppetmaster: stop creating the volatile/misc folder

218e9d467e-+-Out with prometheus3002, in with prometheus3003

3be146d79e-+-ncredir300x: decommission hosts in esams

daf2829ffa-+-Make install3003 the new install server for esams

d6fd0ef183-+-lvs300[5-7]: decommission old esams hosts

e36d2ecf42-+-Remove esams hosts prior to knams migration

c69264fa41-+-P:pybal: update bgp-peer-address for asw1-b*27-esams

535fc8a91a-+-New install server for new esams

6ea4008457-+-Remove bast3006/ping3003 from site.pp

68e84b0517-+-Remove bastion role from bast3006 (will be replaced by bast3007)

0f325091f2-+-Revert "role::wmcs::monitoring: pass through the ensure option"

46f4e63981-+-role::wmcs::monitoring: pass through the ensure option

c3e480869f-+-Apply ganeti role to ganeti3006/3008

4ea5a3b1bb-+-toolforge: add deployer module with the secrets

a66886a9c4-+-gitlab: remove cas support

127a237731-+-esams: add new LVS secondary host, lvs3010

6aeab4d08f-+-esams: add new LVS high-traffic1 host, lvs3008

9b21f3dac0-+-contint2001: puppet cleanup post decom

121c124ffe-+-Assign ganeti role to BY27 cluster hosts

f94ba14578-+-esams: add new LVS high-traffic2 host, lvs3009

52953855b4-+-Add new-esams network infra to monitoring

3017315a7c-+-Add site.pp entries for new Ganeti nodes in knams

a67930e486-+-nftables::file: Expand prefix to three digits

932324c858-+-Class gitlab: Use gitlab-settings v1.3.0

a808e87803-+-Add insetup variant for undefined ownership

655d296a10-+-realm.pp fix new esams range

678047e2db-+-realm: update subnets for knams migration

3812c66749-+-site.pp: add new cp notes in esams

073cf968a7-+-bird: create dummy anycast-prefix files

46770aa1d4-+-Add / update network definitions to include new esams ranges

6d2932646e-+-airflow-wmde: Add wmde airflow instance to insetup role

3e4143ebb1-+-gitlab: Add default value for thanos swift key

971e61cccd-+-Revert "prometheus::ops: add demo node exporter job for SONiC"

0b13ee514d-+-backup_cinder_volumes: install the right config file!

66db1b8bba-+-backup_cinder_volumes: Install OpenStack client packages

e2330c6555-+-Convert cloudbackup200[12] from cinder-backup nodes to backy2 nodes

1d57457b12-+-backy2: split out the instance backup logic into a separate profile

dfae981850-+-profile: drop istio-proxy deprecated field warnings

0f3f73a763-+-backy2: make backup dir configurable

59d5da1639-+-dnsrecursor: update authdns address

e40800f2f0-+-bird: recursively manage the log file

158dcf19d1-+-durum: add explicit require on acme_chief cert for nginx

c452436bf9-+-site.pp: Drop top level domain names: .wmnet .org

1fb13383af-+-config-master: add conftool::client

3624c65c9b-+-nginx: ensure we manage the nginx buffer directory before mountint

10d21bf81d-+-firewall: Ship a base profile for the nftables provider

7c6712a309-+-confd: use a timer to clean old files instead of tidy

b40ebc3fde-+-netbox: expand device schema to include optional platform

c4ebe3ae14-+-cloudlb: allow access to haproxy stats from prometheus

72a49493e3-+-prometheus: fix typo in job name

0162339739-+-Revert "confd: use a timer to clean old files instead of tidy"

708834f655-+-confd: use a timer to clean old files instead of tidy

e42ee91d9f-+-configmaster: add python3-conftool

812f49df96-+-firewall: Make more Ferm-specific setup conditional to the ferm provider

0a04c9e158-+-Routinator: use tmpfs for cache directory

57c84df1fc-+-Add the lockfile-progs package required by hdfs-balancer

1362767d3f-+-Add base nftables sets which are equivalent to the main Ferm macros

1ab1d4617b-+-query_service: install git-fat

d63a31fb1a-+-bird: add dependency for bird.conf on bird2 package

6d8c4f2029-+-Use the libmysql-java component on bullseye as well

d4f7f3d9fb-+-dev env: cadvisor exporter, in container env listen on all interfaces

3ba99bc7c4-+-gitlab: Add missing options for objectstore and extract swift key

9b51af8790-+-tlsproxy::envoy: improve docs

587c8ed71b-+-Don't install python-is-python3 to presto servers

ad32330d69-+-P:bird::anycast: use systemd::sysuser for creating the bird user

b6592cf212-+-prometheus: gather stats from haproxy for openstack and cloudlb

6c3a98b06d-+-bird: drop support for buster

6ef6d35edd-+-zookeeper: Avoid Ferm-specific syntax

db61161f62-+-profile::mirrors::serve: Remove Ferm-specific syntax

403f8d9467-+-haproxy_exporter: allow setting as absent

6de1ffb25f-+-Revert "P:bird::anycast: require anycast setup on the bird class"

23be0ae54e-+-gitlab: Configure object storage for gitlab1003 on Swift

574783904a-+-P:bird::anycast: require anycast setup on the bird class

ecd681d3a1-+-Revert "Revert "Correct the role for the new hadoop workers""

db373d59e5-+-site.pp: Add db12[26-33]

f33b0f1207-+-site.pp: Remove db1119 from s1

bb579602c0-+-Revert "Correct the role for the new hadoop workers"

11ddf81196-+-mariadb: Move db1119 to m3

5c0148e985-+-Correct the role for the new hadoop workers

377d9c6b6b-+-Add backy2 class to codfw1dev cinder-backup nodes

920c0007fc-+-replica_cnf_api: refactor to use multiple backends

49a62ba95f-+-bird::anycast_hc: re-add validate_cmd

e802654ef9-+-bird::anycast_hc: temporarily remove validate_cmd

97d920128d-+-gitlab: enable ldap group sync on active GitLab server

33f0dfa965-+-Revert "cache: move vendor proxy lookup to cluster_fe_ratelimit"

add72ddb72-+-cache: move vendor proxy lookup to cluster_fe_ratelimit

4d7c3d771e-+-Remove unused file for horizon scap deploy

16cb2b1fce-+-flink-zk: Add hostnames for CODFW cluster

193b69d2b7-+-cache: load ip reputation data and add request header

7342c939c6-+-P:wmcs::graphite: disable incoming metrics

8523cbb254-+-dispatch: prune old docker images

bbdcc2fbc8-+-profile::cache::base: add netmapper file for proxies

98ad22292b-+-ip_reputation_vendors: add datadir

c67e33d148-+-ip_reputation_vendors: re-enable timer

5e7cc16850-+-ip_reputation_vendors: temoprarily disable the timer

378b7294a2-+-ip_reputation_vendors: remove conditional define

2ac37f8413-+-puppetmaster::frontend: fetch ip reputation data

9d5b264dd3-+-xhgui: remove 'xhgui' module, role and profile

ccd3a36aa5-+-vrts: add /var/log/clamav/{clamav,freshclam}.log to rsyslog

ccebdd75f8-+-Add new bastions to site.pp

041dc29006-+-ganeti: Avoid Ferm-specific syntax

2c3babc8ab-+-site.pp: New hosts db12[34-49]

7ce8853fc7-+-Add lists2001 to site.pp and netboot.cfg

e331cbd092-+-pyrra-filesystem: add package require for file resource

8b3a7b1fc2-+-pyrra-filesystem: ensure config directory

cdb4f00d00-+-pyrra: deploy to thanos-fe hosts

85721aa762-+-profile::pyrra::filesystem: add profile

1262780fff-+-profile::pyrra::api: create profile

f5879c309f-+-pyrra: add pyrra::(api|filesystem) modules

c4d5c228dd-+-aptrepo: Pass ports without Ferm-specific service identifiers

d59230580c-+-wikifunctions: Add view rewrite rule for mw-on-k8s

e45ba7edbf-+-Kerberos: Pass firewall settings in tool-agnostic form

0aca945bdf-+-installserver: Avoid Ferm-specific syntax

c37f349912-+-flink-zk: Enable prometheus scrapes

56125ca6c7-+-Add titan to site.pp and netboot

653beedf01-+-mediawiki::logging: MaxMessageSize unit is lowercase

2940884df1-+-mediawiki::logging: k8s syslog max message size

8af18d97e1-+-profile: remove jmxtrans mention from zookeeper, obsolete

9515688a25-+-Rename mw149[7-8] to kubernetes102[5-6]

81cec2ef4e-+-PCC: Pass ports without ferm-specific service constants

bb84a3fe68-+-cassandra: Pass ports in firewall-agnostic format

ccd3da5c3e-+-docker_registry_ha: Remove Ferm-specific syntax

4a9d503e39-+-site: Add pc101[56] as in setup

ccb5e232c4-+-mediawiki::wancache: add the wikifunctions pools and routes

e4b6564f71-+-mw-on-k8s: add wikifunction pools

79bf37a16a-+-rename role::wmcs::openstack::eqiad1::labweb to ::cloudweb

c4144d6e96-+-Horizon: switch eqiad1 to a docker-based 2023.1 Horizon deploy

a2156730c2-+-orchestrator: Remove ferm-specific syntax

8339c07cc3-+-ntp: Remove Ferm-specific syntax

df74890770-+-graphite: Pass port without Ferm-specific syntax

ad143474e4-+-ferm::service: Fix handling of multiple ports

62c338fd35-+-site.pp: Add db21[88-95]

ff03f9e4d2-+-site.pp: Add pc2015, pc2016 to puppet

774ad0cc99-+-Add new cloud nodes to site.pp and netboot.cfg

20df266974-+-configmaster: add support to proxy the puppet sha1 files

265dc82865-+-config_master: add docs

dbf4019f57-+-O:config_master: add httpd profile

9b7f52bc6d-+-site.pp: move config-master hosts to config-master role

a6b2a9505b-+-O:config_master: Add new role for config-master

1f6576416a-+-config-master: Add role::insetup to new config masters

609651b371-+-noc: Pass ports without ferm-specific service constants

be86acff4e-+-httpd: Add a profile for loading httpd

12409ca736-+-fifo-log-demux: Add socat as companion package

aa265d79a3-+-gitlab: Use gitlab-settings v1.2.0

098b2861af-+-Wikifunctions sqoop job: Add missing commandline elements

4a87bb7a58-+-Remove db1108 as it is being decommissioned

724b4f398f-+-Remove an-airflow1003 and its role from puppet

1776196df3-+-Revert "tcpircbot: use same nickname for both bots"

00f745f099-+-tcpircbot: use same nickname for both bots

ce2d740267-+-Upgrade the analytics_product airflow instance to version 2.6.3

1156da001e-+-tcpircbot: add another port for cloud IRC logging

e0e897ef78-+-Revert "keystone: hack to reject all new non-alphanumerical project or domain names"

468e10f6b5-+-Update airflow sqlalchemy URI for all airflow instances

0d6ddafcc2-+-prometheus::ops: Add liberica demo exporter

187cc1929a-+-Move Ferm::Protocol to wmflib (as generic Wmflib::Protocol)

dff84409c1-+-Rename Ferm::Hosts type to Wmflib::Firewall::Hosts and move to wmflib

cc248b538d-+-network::constants: define mw_appserver_networks_private for cloud-vps

bb3a954c44-+-Revert "profile::urldownloader: define towikimedia on deployment-prep"

e642564a7c-+-profile::urldownloader: define towikimedia on deployment-prep

bed3e3c07a-+-profile::docker::runner: don't configure ferm

52ec33bbb9-+-ssh::known_hosts: add new known_hosts functions

816cab8b6f-+-mariadb: Switch s3 and s6 from db1140, db1225

0557558db9-+-D:apereo_cas::service support FLAT profiles.

eab3ec309e-+-mariadb: Upgrade db2097 to use mariadb 10.6 package

a14efb0594-+-Create puppet scripting for sqooping Wikifunctions tables

7f37769734-+-motd: correct path

edec439b2f-+-motd: Add motd indicating services which need restarting

464819e1f5-+-puppetserver: Add a file to track when a service restart or reload is

8739bf7fb3-+-puppetserver: make notifying configurable

5a44b413f9-+-geoip: drop GeoIP2-Anonymous-IP from syncing

e031218a02-+-geoip: Add docs and fix lint issues

920c5ebccf-+-wmcs: cloud_private_subnet: fail if DNS records cannot be resolved

660a40be05-+-flink-zk: Initiate new flink::zookeeper role

62cad0729e-+-releases: Add final chown to /srv/patches quickdatacopy

9415beadba-+-mariadb: Move s6 from db2141 to db2097 and drop s1 & add x1

48e3546699-+-eqiad1: cloudnet: enable cloud-private subnet

8c10f7ed8c-+-releases: Change ownership of /srv/patches after chown

0822c6f817-+-releases: Change owner on /srv/patches after rsync

ea59f45679-+-xhgui: Remove xhgui1001 and xhgui1002 node definitions

8d89fb5b14-+-wikistats::httpd: also support bookworm

8a593d61df-+-wmflib::php_version: allow 8.2

dbad52372c-+-wikistats: support bookworm

6042dc55c5-+-P:parsoid::vd_client: Don't try to restart if stopped

0246e064fe-+-Horizon/docker: another move from 8081 to 8084

a1208987fc-+-horizon/docker: move to port 8084

72e9f4c48b-+-Horizon/docker: fix bind mount typo

3b1e05dd91-+-horizon/docker: fix (maybe) the namespace and image name

cca22231ed-+-Horizon: add docker_deploy profile

6840237a40-+-keystone: fix name of patch file

4946317bea-+-keystone: hack to reject all new non-alphanumerical project or domain names

7253ae5cf2-+-docker service: support a list of arbitrary bind mounts

08f3ae1767-+-trafficserver: add gateway routing script, route device-analytics

74180ef067-+-deployment: Support making k8s deploys db section aware

8fe4834d18-+-mediawiki: remove PHP7 icinga checks

e2c3d34a87-+-Kubernetes: add support for deployment apparmor profiles

71d17feeb4-+-Stop repeatedly disabling write cache on cephosd servers

4a91f8a18b-+-Install the ceph-volume and hdparm packages on cephosd servers

0344c7cf23-+-bacula: Increase the number of max volumes for production pool

6987c1dbce-+-profile::kafka::broker: fix settings passed to the confluent class

927c5c2c80-+-decom wdqs200[4-6]

ebfb23ce34-+-Horizon: split config into a separate class

b2388dfbc3-+-apache: Add 'view_urls' rewrite for /view URLs, enable on Beta Cluster

2a54660a12-+-vrts: enable blackbox check on active_host only

53dbc74fbf-+-clouceph: mon: enable more client networks

01fdcebfa3-+-Fix the cephosd activate exec resources

10c0588e0a-+-base: wrap up cadvisor rollout

5254fc4853-+-cumin::unprivmaster: Test using puppetdbapi-next

ae58f25888-+-Use different WWN values for SAS HDDs and SSDs for cephosd servers

6de6b078c0-+-Revert "vrts: change blackbox http check"

a2e609c2fd-+-vrts: change blackbox http check

7f0f06596d-+-kubernetes::master: Fix confd template as keys start with /

1bfc7304d9-+-Fix the wwn of sas drives used for the cephosd servers

a6901dd5fc-+-kubernetes::master: etcd_servers list being created to late

e2d46fa1a2-+-confd::instance: Allow to specify multiple backend hosts

b489a8c1f7-+-add rdb101[3-4] site.pp

a3a86fb95c-+-spicerack: Add config file for MySQL/MariaDB

15ec37b14d-+-Disable the ceph fsid mismatch check

8429410c20-+-kubernetes::master: Add confd config writing all sa certs

db8a398dd2-+-confd::instance: support prefix in non-main instances

777d930270-+-openstack: admin_scripts: install mariadb-client from the galera repo

267a8e009f-+-Fix the cephosd fsid mismatch check

d93ff6d064-+-conftool::state: use confd::default_instance

edd43a2321-+-confd: allow running multiple instances

4591a9250a-+-kubernetes: Add etcd srv names to clusterconfig structure

4bcb4ce2a0-+-kubernetes::master: Publish service-account cert to etcd

7eceba2904-+-openstack: eqiad1: control: fix typo in cloud_private include

a11ebb00dc-+-openstack: eqiad1: don't deploy haproxy to cloudcontrol1005

970efb2541-+-ssh::publich_fingrprints: also link .ecdsa  file

160ad09086-+-eqiad1: cloudcontrol1005: load cloud-private

6efb8ea2bf-+-cloudcontrol1005: add role with new domain

fa506b5bf0-+-Run the ceph osd execs with the shell provider

809abc58d2-+-wdqs: fix missing entry in site.pp

f2e35a970b-+-gitlab: make sure ldap_group_sync_user is created first

6db178c80f-+-Stop repeatedly disabling the write cache on cephosd servers

a5313e2244-+-Remove references to releases1002/releases2002 for decom

5471da1cb1-+-dnsrecursor: allow configuring the webserver loglevel

954a8d39a5-+-Run LDAP group sync periodically on gitlab replicas

ab3fde0f9b-+-Do not attempt to use hdparm on nvme drives for cephosd servers

2e5cb49055-+-mediawiki: Reduce the frequency of flaggedrevs updates

28cbb94d97-+-Get rid of swiftrepl

d671e0acb4-+-proifile::puppetdb::microservice: add allowed_roles

b6ac8f3965-+-Fix the device name when running parted on cephosd servers

3eb4e5d8ea-+-ceph: Add puppet management of OSDs on new ceph cluster

205f7feeb8-+-conftool-data: temp add more capacity to parsoid eqiad

dcf2432f78-+-gitlab: auto link existing users with OIDC

64456ec9eb-+-noc: stop using script to populate database data URIs

2c262c1a28-+-dns::recursor: filter out undef value

ed5029929f-+-swap in dumpsdata1007 as the new fallback xml dumps nfs share

9c50677a45-+-ssh: switch to using the same file we use in production

44ae8db7f1-+-netbox: actully use puppetdb_microservice_fqdn

845e979e61-+-netbox: drop pupetdb_host as its not used

676ac19af8-+-netbox: make the puppetdb microservic domain configurable

eb3d5cdfa2-+-puppetdb::microservice: add -next domain

fd20a58465-+-durum: remove redundant whitespace in durum::common

74be8a42d3-+-haproxy: Add option to disable keepalive on port 80

b44908cd4b-+-puppetboard: add port

e0424bae05-+-Install MariaDB to db1208

dc5bcc72c0-+-puppetboard: should point to production and not use saml

a680713e93-+-Update refine jobs with new var version

187b5be149-+-puppetboard: create a new site for puppetboard-next

74b297a951-+-realm: Add two new private tables of CheckUser

dcd269300e-+-puppetboard: update main site to support service -next

03b09dbcd8-+-deployment_server::global_config: Use symlinks for cluster aliases

2b71e70159-+-puppetserver: use FQDN in metric

d6ddb6f39f-+-translationnotifications: brown paper bag fix

b5c8755fcc-+-mediawki::maintenance::translationnotifications: fix calendar defintions

cf8cd96a67-+-TranslationNotifications: Run UnsubscribeInactiveUsers periodically

e8448cadb9-+-puppetserver: drop monitoring profile and handle jmx in modules

607b483de7-+-Restrict buildkitd frontend gateway and allowed sourced on trusted runners

d805e89abf-+-puppetserver: add jmx config

990c4beadb-+-Use buildkit wmf-v0.11-8 on WMCS and trusted runners

19ffef27ca-+-puppetserver: Add jmx exporter

0f31b98df8-+-cassandra: transition 3.11.14 from 'dev' to '3.x'

ec9a68e15e-+-puppetserver: Add jmx exporter

6f0e075dc8-+-puppetserver: Add conftool::master

5975dffcb1-+-make sure certain systemd jobs run only on the primary xml dumps NFS shares

b3b7c0e3aa-+-base: bump cadvisor rollout to 80%

ab3c510bb0-+-nftables: spec: introduce service tests

ad041fbde9-+-prometheus: fix duplicate declaration for statsd_exporter

4fc0f07793-+-prometheus: create /etc/prometheus when needed

a5f32020f4-+-New role: titan

52c060d673-+-Revert "cassandra: uninstall cassandra-twcs deployment repository"

b8ecedb805-+-cassandra: uninstall cassandra-twcs deployment repository

0d26f56e01-+-rsyslog::receiver: update docs and add types

28447a0964-+-dnsrecursor: remove redundant parameter install_from_component

06e7846a2d-+-flink-zk: Provision hostnames for new ZK cluster

cca1dc8050-+-Uninstall Diamond everywhere

370ac1fed9-+-openstack: nova fullstack: updated harcoded access to the list of controllers

0b93687519-+-eqiad1: decomission cloudcontrol1005.wikimedia.org

d3b6fd9d74-+-wikireplicas: relocate some hardcoded data into hiera

06e398e93c-+-base: bump cadvisor rollout to 45% in eqiad/codfw

0d8fc9cc00-+-udp2log: run mw-log-cleanup after logrotate

fc67c6487c-+-buildkitd: Fix gckeepstorage units

04df273bf6-+-Add python3-cryptography to cookbooks

55aace1b91-+-zookeeper: prepare for new zk cluster

d661e2eee8-+-P:toolforge:prometheus: scrape maintain-kubeusers metrics

0ab61fec25-+-Change analytics_test airflow to use an-test-client1002

fb3af454c2-+-Revert "gitlab: set userinfo_endpoint in client_options:"

c8dac317da-+-gitlab: set userinfo_endpoint in client_options:

027737d111-+-hiera: add silent-drop directives for http frontend

ff7fd332ae-+-labs_lvm: add `.sh` extension to shell scripts

196c5c24b2-+-kubernetes::master: admin.conf on control-plane should use the local api

e561f1386e-+-cfssl::cert: Add support for notifying multiple services

e6ac04e436-+-microsites: add monitoring for statictendril site for retired services

5ad4cc5185-+-planet: the HTTPS_PROXY itself is accessed via http

710fa2841f-+-dynamicproxy: api: fix file location

7e3c106fb4-+-mariadb::config::client: allow configuring default database

8af829f401-+-dynamicproxy: move api files to api/ folder

3cf9a1b026-+-dynamicproxy: remove proxygetter

828feb9899-+-P:mariadb::cloudinfra: add web proxy database/grants

7234261f36-+-etcd-discovery: restart etcd after config change

c66fb2ea1d-+-Magnum: allow configuration of etcd discovery service host

719b75e2a9-+-Add puppet role and profile for etcd_discovery service

50b428b4ae-+-P:openstack: open eqiad1 magnum api to the public

b182dd6d54-+-P:openstack: move magnum fw rules to haproxy profile

45f585546c-+-k8s::apiserver: Implement kube-apiserver reload

1e68c0d846-+-envoy: Absent monitor_systemd_unit_state for envoyproxy

a108753c4a-+-envoy: Remove envoy_runtime_vars nagios check

ffb7c21c8a-+-Add a new nftables::service define

07ff910a2f-+-prometheus: refactor alerts-deploy to pick up k8s clusters

38350c8f45-+-prometheus: Condense metric_relabel_configs into one

ada3602baf-+-codesearch: Switch to systemd::sysuser

9eb8cb35fa-+-prometheus: Collect runtime metrics from envoy (ops and k8s)

e90efcce3d-+-P:sretest Test httppaswd function

065ae7acf6-+-puppetmaster: move source scripts under the puppetserver name space

e4a13fa9d8-+-envoy: Absent check for zero runtime changes

2b7fcf3b43-+-envoy: Limit the total number of active connections

131e8ee8ad-+-webperf: Set XHGUI_PDO_INITSCHEMA=false to avoid 'CREATE TABLE' fatal

71f8bd7a20-+-miscweb: remove static_tendril classes and files

12302b525b-+-planet: quoting, style guide fixes

4548cd67c0-+-Add a second karapace VM

cf2627a55a-+-Revert "trafficserver: add gateway routing script, route device-analytics on cp2037"

cd1ce1c0b9-+-P:wmcs: metricsinfra: fix command usage

c23251145a-+-profile::java: Remove support for Stretch

bb66756c93-+-mirrors: Add monitoring for mirrors

aa40517a68-+-trafficserver: add gateway routing script, route device-analytics on cp2037

d37c2e7f05-+-mediawiki::repl: allow execution from everyone

21f7a265e9-+-make dumpsdata1003 the new misc dumps active nfs share

9e04cefba5-+-puppetserver: correct typo

366b1eb8fc-+-extdist: Remove pre-bullseye support

53f76859d4-+-puppet_compiler: load class { '::sslcert::dhparam': }

9ca3daaf89-+-puppet_compiler: drop recurse.

7881254993-+-puppet_compiler: ensure we link the yaml dir before initiating other dirs

d32799a0ca-+-pcc: dont recurse directories

789d94e17c-+-puppet::agent: configure srv_domain based on site

ab9dfa14e2-+-puppet::agent: add support for srv records

0502ec048d-+-P:ntp: update the stale conf file check intervals

f67f42729a-+-puppetd::site: Add a way to open the firewall

5a6bb6b1f8-+-Puppetserver: correct typo

e237b72121-+-puppeserver: support submit_only urls

7c8df305d2-+-pupetboard::bookworm: Enable client authentication

e581e3d376-+-uwsgi::app: add ability to configure the systemd user and group

8322d476c9-+-uwsgi::app: update docs

165d2c5a8a-+-puppetboard: add docs

03433907be-+-deployment_server: add REPL for mw-debug

80345f00f7-+-analytics: remove puppet references for analytics[1058-1069]

e9704bc8e2-+-rsyslog::kubernetes: Drop variable assigments used during migration

801f25a029-+-kubernetes::node: Drop variable assigments used during migration

61fff1d334-+-kubernetes::master: Drop variable assigments used during migration

c24b492910-+-calico::kubernetes: Drop variable assigments used during migration

a9f7eeef0d-+-vrts: rename otrs_aliases to vrts_aliases

af68366981-+-P:ntp: do not use global variables

3922d8c7a6-+-releases: fix quoting of ensure parameter

5015a5481e-+-vrts: fix quoting of ensure parameter

a4a5d89414-+-wikistats: fix quoting for ensure parameter

505597cd19-+-phabricator: fix quoting for ensure parameter

d8562d3f11-+-gerrit: fix quoting for ensure parameter

3d27e83b4f-+-microsites: fix quoting style for ensure parameter

822a97c3e3-+-P:ntp: increase interval for checking stale ntp.conf file

0044f57d8f-+-Create spark3 local directory

4457464708-+-Revert "trafficserver: add gateway routing script, route device-analytics"

a36d0b5552-+-trafficserver: add gateway routing script, route device-analytics

92a416b133-+-java::version: add support for openjdk-17

09356c1cf4-+-puppetmaster::puppetdb::cilent: updatre submit only port to 8443

4096a16d58-+-P:toolforge::prometheus: add pod_name label

e431cefbd4-+-nginx: manage nginx directory

7ccec0c34e-+-cloudlb1001/1002: add role

8a04f7eff6-+-puppetdb::site: secret needs to be content not source

defbdae212-+-puppetdb: Add ability to configure secondary proxies

065f68d4aa-+-haproxy: fix variable type and better naming

cd66a0e3c3-+-wmcs: cloud_private_subnet: introduce per-rack vlan_id support

5a4ef38cb8-+-haproxy: support different actions for tls and http frontend

81a56c4b78-+-xhgui: Decommission xhgui1002 and xhgui2002 hosts to deploy xhgui in webperf1003

62aeb4f2d3-+-webperf: Provision XHGui directly on performance.wikimedia.org (take 2)

1da1c6b0d6-+-Revert "webperf: Provision XHGui directly on performance.wikimedia.org"

4855031937-+-P:dns::recursor: automatically generate resolv.conf for DNS hosts

24f5b9cba5-+-webperf: Add missing PHP memory_limit setting

2dc58c9374-+-webperf: Provision XHGui directly on performance.wikimedia.org

2daefc13f9-+-P:systemd::timesyncd: automate generation of ntp_servers list

c344166c2a-+-Revert "haproxy: support different actions for tls and http frontend"

842d845d95-+-haproxy: support different actions for tls and http frontend

b452aafbd4-+-puppetmaster::puppetdb: allow users to configure ssl_verify_client

bb39277e3a-+-puppetmaster::puppetdb: add documentation

2f958c2090-+-wmcs: cloud_private_subnet: introduce per-rack cloudsw gw support

799814f610-+-contint: rm git safe.directory for dev-images

a3ddf19173-+-contint: build dev-images with a system user

4891176391-+-puppetdb::app: fix docs

e6cc06152a-+-gitlab: sync all configured providers

d6b70b9fb0-+-webperf: Enable `recurse_submodules` for performance/docroot clone

53500ff885-+-puppetdb: add classification back

2468fa366a-+-wikidough: Add SPDX headers

b75a57708d-+-pupetserver::git: Ensure we build the git repo if using init

d5facd4327-+-pupetserver::git: ensure we build all parent directories

5a859cbbce-+-puppetdb2003: move to new role

96801bc415-+-P:toolforge: redis: drop unused profile

7b7103b226-+-deployment: Use rsync::quickdatacopy, enable encryption

7610f7b464-+-ipuppetserver::g10k: dont recurse cache directory

ba05479fd1-+-keepalived: migrate to apt::package_from_bpo

82d5990b91-+-dynamicproxy: api: migrate python3-flask-sqlalchemy to apt::package_from_bpo

d56455df3a-+-apt: add package_from_bpo define

3ed6de4adf-+-Allow cloudcumin hosts to connect to wm-bot

aac92ecf96-+-contint: parameterize the docker lvm disk size

2d7d2f14ec-+-P:hive::client move beeline script to files.

f3bdaa40ad-+-profile::base: add boolean to manage timesyncd

1aa754022b-+-ssh: support listening on multiple ports

d8eb0c3c6f-+-P:toolforge: mail: DKIM sign outgoing mail

55d9063848-+-pki-root: fix lookup argument

5f9d4ae705-+-P:pki::client: make mutual_tls_add_puppet_ca the default behaviour

505f055abe-+-dynamicproxy: api: fix apt pinning type

f27854fa72-+-dynamicproxy: api: install newer version of python3-flask-sqlalchemy

b1489833f1-+-Add profile::lvs::realserver to kubestagemaster (#2)

74092b8091-+-P:pki::client: add ability to concat the CA file with agent certs

cad3b5f0ca-+-varnish: Remove http/https redirection

930eba43be-+-P:toolforge: use toolforge.org as primary mail domain

b501ee806f-+-vrts: replace OTRS in Wikitech monitoring notes URLs

9907148637-+-apt: Ensure sources.list is updated before apt-get update

d63b664c30-+-site.pp: Add kubestagemaster[12]002

5c9e3ee0a9-+-galera: allow to set a different local node name / address

c9841d9c59-+-wmcs: cloud-private: store FQDN in hiera

3a225d7142-+-swift: roll object_expirer into cluster_info (remove profile)

7f1392cbca-+-Designate/pdns: allow designate and pdns hosts to access mdns for axfr

e96df5f5f6-+-Designate/pdns: allow designate hosts to access the pdns rest api

ca7a98657d-+-wdqs: Add and replace hosts

2e283618b9-+-cloud-vps pdns: include designate hosts as allowed api clients

b036d77f05-+-cassandra_dev: remove (temp) packages used in debugging

143ba30f0d-+-profile::memcached::instance: allow to specify srange

ba13030fff-+-query_service: align all hiera configuration to the same order

587b4d9193-+-Add kubestagemaster[12]002

4139391186-+-durum: Add SPDX headers

d349a1b6f4-+-miscweb: lower certificate_expiry_days to 9 days

c777fe9c2d-+-conftool: Add more servers to jobrunner cluster

c59a02af39-+-puppedb1003: migrate to new infrastructure

20bd207ca3-+-Remove urldownloader role from old buster servers

ac20465d3f-+-pki::client: use the wmf-ca-certificats bundle for ca auth

89e88c221c-+-Revert "trafficserver: add lua script for gateway routing"

5bb39abc3d-+-trafficserver: add lua script for gateway routing

6307086803-+-puppetserver: add ssh known_hosts entries for new puppetserver

0ed3288b20-+-Revert "puppetserver: add ssh known_hosts entries for new puppetserver"

aa6dd43d9d-+-puppetmaster: Correct config path

b2b949783c-+-puppetserver::git: add operations/private

779249d614-+-puppetserver: add ssh known_hosts entries for new puppetserver

dd4c69f8cd-+-dbbackups: Change s4 and s5 eqiad backup sources to db1150 and db1216

d6eecb7bdd-+-profile::local_dev::docker_publish: /srv/dev-images is safe directory

e2f4f05403-+-zuul: remove mode/umask from config git clone

0e896baeca-+-Remove the remaining reference to an-test-coord1002

ca46812f19-+-cloudcontrols: update host selection for single cloudcontrol

bd203bf4a6-+-Configure an-test-coord1002 to be a spare system

f2cdf23ef1-+-parsoid-vd: Don't try to restart it

b696feff2c-+-gdnsd: Switch to systemd::sysuser

ec7d60a0df-+-cache: Setting port 80 as default redirection port in haproxy

0c816dd126-+-Add 'git_tag' argument to git::clone

e6dd4b575c-+-puppetserver: add labs private repo

120c800c0f-+-merge_cli: Make the paths a parameter and add them to a config file

e0595fcdf3-+-merge_cli: migrate puppetmasteres to module version of merge_cli

1a2ee08531-+-Revert "trafficserver: add lua script for gateway routing"

f21aad0ff2-+-Revert "deployment: Use rsync::quickdatacopy, enable encryption"

3d3469a01e-+-deployment: Use rsync::quickdatacopy, enable encryption

073957ebec-+-trafficserver: add lua script for gateway routing

23fbfeb6a8-+-nftables: Also write out empty sets if no ipv4 or ipv6 addresses are present

6bc2b9feaa-+-xhgui: Add node definitions for xhgui1002 and xhgui2002

36c0517fc9-+-stdlib: upgrade to v8.6.2

a812da36c8-+-puppetserver: authorise puppet server to upload files

e68f36167c-+-vrts::web: replace OTRS with VRTS in comments

e22a5a9660-+-ssh::server: define $aliases before using it

43b4241c2f-+-Revert "merge_cli: Make the paths a parameter and add them to a config file"

35ca3bd477-+-merge_cli: Make the paths a parameter and add them to a config file

548feb2f56-+-urldownloader: Switch $towikimedia to $mw_appserver_networks_private

fd200e0a14-+-dev env: sshd, allow for user CA based auth

48e71570eb-+-wmcs: prometheus: increase scrape frequency for openstack APIs

9fc7095f9e-+-network: Split $mwappserver_networks to public/private

e946726171-+-urldownloader: Simplify wikimedia variable

4ca2b41b7d-+-puppetserver: Add support for providing hardcoded list of servers

20801d7bd1-+-ferm: Allow passing sets to an srange or drange

82975786a9-+-puppetserver: add pcc facts upload functionality

2b868992ff-+-puppetserver: open up firewall rules

f9eb4102fe-+-doc: grant access to Jenkins releases instances

d8e656ac51-+-mariadb: Productionize dbproxy1027

a470cd6753-+-mariadb: Productionize dbproxy1026

a2305ed1f3-+-puppet:agent: force certificate_revocation leaf on puppet7

1f7db9929f-+-network: Narrow down what mw_appserver_networks means

462a060e60-+-cumin: Properly set connect_timeout

ae599e626a-+-url_downloader: Remove the esams entries marked TODO

f26a14d29e-+-cassandra::instance: use the instance's fqdn as TLS PKI CN

5b3919ec25-+-tlsproxy::envoy: update support for profile::tlsproxy::envoy::services

5798321f3e-+-mariadb: Productionize dbproxy1025

759a67faa2-+-cassandra::instance::monitoring: move cql check to Prometheus for PKI

a484fce9b9-+-mariadb: Productionize dbproxy1023

c5b29389ea-+-mariadb: Productionize dbproxy1024

eeb3da20be-+-refinery::job::canary_events - use spark to launch, bump to version 0.2.17

8a1e65e692-+-P:bird::anycast_healthchecker: allow binding to multiple services

5b3be97ffc-+-cassandra: add both fqdn and cassandra to sni

b09d57a1d7-+-O:dnsbox: clean-up dnsbox role and dns::recursor

af679ffd7e-+-releases: Revert "releases: Add motd warning about upcoming host change"

4c3017329b-+-D:apereo_cas::service fix group membership validation

0b54d3b001-+-debian: add bookworm as a valid codename

cf77300189-+-aptly: clean up code style

0ee042ac70-+-cassandra::instance::monitoring: add 'cassandra' as servername

4480f992ba-+-cassandra::instance: add CN:cassandra to all PKI certs

6796feb721-+-pdns_server: db_backup: fix grant statement order

27d05f8ecc-+-Remove krb2001 from Puppet

86f187c8fe-+-Add missing types to ferm::service

2156e61734-+-cloudservices2005-dev: give it proper role and name

f22b2ea7d3-+-cassandra::instance::monitoring: remove wrong servername

2ba2fad73b-+-mariadb: Move db1118 to m3

2d8cc83c71-+-pdns_server: db_backups: avoid <<< redirection

b0576e44da-+-openstack: pdns: add grants for DB backups

655619eea2-+-cassandra::instance::monitoring: fix tcp alert

410553d3d0-+-cassandra: add support for shorter TLS cert expiry checks

c2af3db257-+-releases: Fix alert for releases-jenkins

5d61e6cf0b-+-dbbackups: Fix small logical backup for no-stats-file case

7e6073b75b-+-dbbackups: Make backups statistics optional

a29d8aab6d-+-openstack: pdns: add backup for the database

eee3708de0-+-profile::cassandra: add hiera option for the TLS keystore password

da6ef8db6d-+-role::ml_cache::storage: use pki truststore

e059724b3a-+-cassandra: add initial support for PKI TLS certs to 4.x

d3eeb8d793-+-wmcs: Configure sudo not to prompt for passwords (take 3)

19195dc88a-+-Revert "wmcs: Configure sudo not to prompt for passwords (take 2)"

1a3dd99dc1-+-wmcs: Configure sudo not to prompt for passwords (take 2)

6d515542d6-+-Revert "wmcs: Configure sudo not to prompt for passwords"

cc18d05bcd-+-wmcs: Configure sudo not to prompt for passwords

d76e432c62-+-P:quarry::base: fix file permissions

94526d39b2-+-releases: Add motd warning about upcoming host change

70b229b062-+-puppetserver: fix config perms

2e81e30883-+-idp: use groups for the groups attribute when doing OIDC

33f2d40284-+-vrts: post decom cleanup

eb6bf7fbbe-+-dev env, ssh::server: create /run/ssh dir

659271c8f6-+-dev env, ssh::client: create /etc/ssh dir

33d86823dd-+-puppetserver::ca: add trailing newline

16a574a822-+-webperf: Enable `logToSyslogCee` option for Excimer UI

4ec46f15ab-+-Switch all uses priority of ferm::service to numeric values

644d8cd5c4-+-P:netbox reconfigure to used OIDC

aae34fb81f-+-ferm::service: Fix sprintf to pad zeros

74d5ad6039-+-openldap: main-acls.erb: support keystone hosts without AAAA

7eeb772bbd-+-Use sprintf() to build the config file

9910e8f992-+-gerrit: use default job defaults for home dir backup

52ec80a6c3-+-Revert "site: use phab-test1002 instead of phab-test1001"

d8b96a623e-+-site: use phab-test1002 instead of phab-test1001

8a052c0019-+-site: add phab-test1001.eqiad.wmnet, temporarily

9727a16736-+-gerrit: remove gerrit1001 from site and gerrit2001 hiera data

0e9bac3ce7-+-phabricator: add /home to Bacula backups

79621278be-+-site: remove decom'ed people.wikimedia.org backends

c115ab9c29-+-gerrit: backup /home on gerrit servers in Bacula

4e416dcaa9-+-site: add buster people VMs to insetup role for decom

63386accf2-+-microsites: delete transparency.wikimedia.org classes

7e30165088-+-git::clone: Fix -B parameter

49a44ebaf0-+-beta: avoid erasing extensions when already present

99ffda469d-+-dev env: rsyslog exporter, in container env listen on all interfaces

1fc85f1c25-+-haproxy: Let set port 80 timeouts via hiera

29aecf1d4f-+-miscweb: move probes for transparency to profile::microsites::monitoring

0743aa07c5-+-git::clone: Add types docs and minor updates

278661c173-+-dbbackups: Make mydumper backup template path configurable

ccf1987836-+-git::clone: add support for alternate remotes

3f20858d6f-+-git::clone: use = not ==

c707c24768-+-git::clone: Handle changes to origin URL and/or branch

2efe5cc1cb-+-pontoon: fix typo

e243a3759b-+-Add a type to the protocol used in a Ferm service

7108dedf07-+-C:idm:deployment notify client on Redis reconfig

f77848963b-+-site.pp: Remove dbproxy1022 from insetup

b84eb4fd8f-+-gitlab: remove gitlab_default_can_create_group setting

e1c09a8a06-+-dbproxy1022: Productionize

ffcdb3ed89-+-merge_cli: fix source paths

07aa0117ac-+-puppetserver: add merge_cli as a seperate module

8c0a2201f6-+-puppetserver: use sudo to run g10k from post-merge

fe60e097de-+-puppetserver: Add code to create gitpuppet user

bf2e619e64-+-P:openstack: use dnsquery::resolve

05754d22f1-+-cloudlb: firewall: use new ferm syntax

df8a44b58e-+-Migrate refine_sanitize to spark3.

f50de205a7-+-cassandra: use python3 as python

8a2eb3193c-+-puppetserver: increase memory in production

0c4b4e2fd3-+-P:prometheus::pdns_rec_exporter: remove obsolete profile

d8c8c08549-+-puppetserver::ca: puppetise the CA

4dd2f96f50-+-dev env: Add param to disable puppet agent timer

794ff494c1-+-puppetserver: Add private repo configurations

d7815fec3b-+-P:dns::recursor: remove obsolete buster conditional

3bb9f4c301-+-[ImageSuggestions] Process suggestions via job queue rather than sync

0327006225-+-vrts: otrs1001 decom

e3a86df500-+-P:toolforge::bastion: install envvars-cli

4b05f6e32b-+-root_pki: add support for creating rsa intermediates

e4d3a81d4d-+-Tighten type

4e37c284ef-+-registry: Add nginx logs to rsyslog

83bc8a9988-+-ferm: Allow passing the port in a more structured way

db9959fe26-+-cloudservices: codfw1dev: enable LDAP backups

8b47f93b59-+-core_test.pp: Remove MariaDB 10.1

613426b16e-+-packages_wmf.pp: Remove stretch support

102045bed9-+-packages_wmf.pp: Add bookworm support

60fe732b80-+-dnsrecursor: use an array for query_local_address

0bc4fbc550-+-Test Refine_sanitize migration to spark3.

ad2b6b99c9-+-dnsrecursor: follow up on query-local-address changes

b9c9d8a90b-+-Provided a dedicated KDC logrotate config and fix service reload

403c028172-+-C:idm::deployment switch MariaDB driver.

ec9115e7a2-+-dnsrecursor: introduce query-local-address parameter

d79774f01c-+-openstack: designate: prevent chicken-egg problems with puppetmaster FQDN

2cb0fe02c7-+-profile::base: add param to not manage resolv.conf

116026b6de-+-make snapshot101[67] temporary testbed hosts

1cf10730a1-+-eqiad1 cumin master: include observer project in config

d04e1e0856-+-magnum: Have podman limit size of logs

2d326fe961-+-cinderutils: stop provisioning old filename on bookworm

a9015fcbc9-+-nova-fullstack: stop using labsdnsconfig

c61982cbe0-+-openstack: base: pdns: auth: service: fix ferm typo

dbd32627dd-+-openstack: eqiad1: pdns: auth: also drop IPv6 references

b78c129799-+-openstack: pdns: auth: service: drop IPv6 support

9b15761eb6-+-Remove more cloud stretch support

e5e6d159c9-+-Revert the change in jar version for refine_sanitize

34037463f8-+-deployment_server: set user.email and user.name in git config

73955c90ef-+-Allow MGMT ranges to make TFTP requests to install server

d402a51659-+-Add an-worker11[49-56] to site.pp and netboot.cfg

a9e39ae168-+-refine_sanitize - Fix typo in spark_submit path

17fc76fee8-+-refine - parameterize spark_submit and use spark2 for RefineSanitize

eb4fbd0edb-+-refine_test - Use trailing / for schema base uris

b39c778139-+-refine - Use trailing / for schema base uris

56f0d14215-+-Remove reference to absent ::druid_load classes

639ec198ce-+-Move spark_jobs from spark2 to spark3

54d72d16ca-+-query_service: fix logging configuration for wdqs updater

d72f75945e-+-cassandra: do not hardcode monitoring ports

939611ce2b-+-query_service: migrate WDQS to profile::java

bc26ada988-+-apt: ensure profile::apt is applied before packages.

5c3732ca3a-+-dev env: add a basic puppet enc

646dbca01d-+-Use refinery v0.2.16 in refine jobs.

47a9f46e4d-+-openstack: pdns: recursor: make it listen in the right address

a7ed221744-+-openstack: pdns: recursor: drop IPv6 support

05bb3575d4-+-doc: Clean up leftover bits from switch to quickdatacopy

c957285300-+-openstack: codfw1dev: pdns: use modern auth server for forward zones

2325df6b50-+-jenkins: add doc rsync password to releases instance

a51a2ca74a-+-cloudservices2004-dev: fix role

fefd6efee5-+-cloudservices2004-dev: fix typo in role assignment

4adb780224-+-cloudservices2004-dev: put into service with new setup

65c86c24df-+-Add a define to declare an nftables set in Puppet

72f9e2b47c-+-Correctly locate firewall type for IDM.

52929d7036-+-vrts: failing over to vrts1001

49beab5cdb-+-openstack: codfw1dev: services: add support for BGP public IPv4 addresses

f51e22c0f9-+-Revert "dev env: don't manage resolv.conf"

6903564db4-+-Allow IDM mariadb access, ferm rules.

f9ced284a3-+-Allow the IDMs on access m5's dbproxy

cdc9da950a-+-gitlab: make oauth client identifier configurable

d2b25fa270-+-Allow the IDMs to access m5

4847b83b11-+-P:mariadb: allow wikitech to connect to es*

b1065e9d0d-+-P:IDM Switch production server to MariaDB

1639db5a82-+-Update role in site.pp for  cloudcephosd1035-1040

cada20518a-+-site: add microsites::peopleweb to new people VMs

3a85004ce1-+-site: add people1004/people2003 with insetup role

b5e63aaf68-+-Add snapshot101[67] to site.pp with role insetup

a784849f0c-+-Add snapshot101[67]

18c8021837-+-phabricator: Add second recipient for quarterly/yearly metrics emails

f36d45a6e1-+-openstack: codfw1dev: designate: fix pdns query-local-adress

191e3edb13-+-Revert "apt: ensure profile::apt is applied before packages."

6450d83687-+-apt: ensure profile::apt is applied before packages.

d9f3aee975-+-dev env: don't manage resolv.conf

f320be6a5d-+-dev env: nrpe listen on all interfaces in a container

fb7e227a9f-+-dev env: avoid kernel tweaks when in a container

39f9d5cfb0-+-lvs: remove lvs::monitor_services

f926ab7e3e-+-pdns_server: make default-soa-content configurable

030af50b47-+-tshark: drop debconf::seen

963a1f5f96-+-doc: Switch sync between nodes to rsync::quickdatacopy

89c9a90f88-+-bird: prune unmanaged anycast-healthchecker checks

9c47271ad8-+-Revert "tlsproxy::localssl: drop class"

715b4e1c1a-+-Prometheus: fetch FastNetMon metrics

a0e2563e55-+-Disable multihop BGP for cloud hosts connected directly to cloudsw

cced220874-+-tlsproxy::localssl: drop class

ec8281d960-+-haproxy: Provide a custom error message for plaintext requests

56123f3ee9-+-phabricator: try to fix month range format for quartely timer

1f09eb52f9-+-Add sretest1003 to site.pp and netboot.cfg

1cf3f6c9e9-+-Revert "Revert "Automate quarterly Phabricator metrics for Tech Community Newsletter""

42b41db9fe-+-ldap: inline yamlconfig

72216c1c71-+-profile::cache::kafka::certificate: fix pki cert path

a0eba0d9ee-+-wmcs prometheus: include 'OPENSTACK->CLOUD' in prometheus config

ea5df8d894-+-labs_boostrapvz: Remove class

26588069dd-+-clouds.yaml: remove keystoneadmin section

753d80a6f5-+-openstack: puppetmaster: frontend: remove IPv6 support

82d5b4761e-+-openstack::clientpackages::vms::common: don't install ebtables

04bbcca3ed-+-cloud: cleanup labsdnsconfig usage

48e91b0712-+-vrts: use variables in rsyncquickdatacopy

7cf6a5c7b2-+-Build Bookworm base image

d8378594b7-+-Create additional nftables directories

852123a7c4-+-P:puppet::agent: add script to locate unmanaged files

d13d324413-+-P:bookworm: prepare apt repo for toolforge

5d7a9bea82-+-aptly::client: configure unattended-upgrades

5b2d4742a1-+-P:toolforge::apt_pinning: remove sssd pinning

eb65ae2984-+-P:toolforge::apt_pinning: remove unused pinnings

67d55e183b-+-profile::cache::kafka::certificate: fix client PKI config

dbebec6a6c-+-package_builder: fix -security repo name on modern distros

d52aee3f19-+-Revert "Automate quarterly Phabricator metrics for Tech Community Newsletter"

0c2f9e3d1a-+-Automate quarterly Phabricator metrics for Tech Community Newsletter

4b72bfb401-+-Automate yearly Phabricator metrics for wikitech-l

548196194a-+-phabricator: add support for month parameter in logmail class

c0e4582c38-+-Add snapshot101[6-7] to site.pp and netboot.cfg

5d5ff28bcb-+-dev env: Add role::puppetserver::dev

7404eaf6e3-+-dev env: add an insetup role for container builds

0b4944245a-+-initramfs::script: ensure initramfs-tools is installed

3bf457802d-+-wmflib::dir::mkdir_p: exclude FHS dirs

b099c98b3f-+-profile::cache::kafka::certificate: use root instead of the kafka user

d7ab87f880-+-openstack: designate: auth: allow configuring ips to listen on

1e83c7ae7a-+-openstack: designate: recursor: add new BGP VIP

735590ba03-+-pdns_server: allow listening on multiple addresses

e6fc58bc90-+-pdns_server: require bullseye

7391157ae4-+-Revert "Revert "lvs2014: commission new LVS host (codfw hardware refresh)""

869059d976-+-cloudservices: codfw1dev: refresh VIPs

569ee5a3fd-+-Fully manage /etc/nftables/ in Puppet

cc6ae13f64-+-Add pki-root1002 to site.pp

aa54329909-+-Add backup101[0-1] site.pp and netboot.cfg

c20f6aedf9-+-site: fix typo in gerrit1001 role assignment

3791b473d9-+-site: remove gerrit1001 from gerrit role, rm hiera host data

8205c47568-+-Stop using local storage on cloudvirt1028

16239095aa-+-abstract-wikipedia alert: Increase timeout from 10s to 180s

64796c543c-+-Revert "lvs2014: commission new LVS host (codfw hardware refresh)"

63d6e689f7-+-for testing of dumps nfs shares, add conf files for other types of dumps

3cb9a90b7d-+-Fix typo in stipe.pp for puppetmaster1006

a6bf1f8ef3-+-Add puppetmaster1006 to site.pp

6f09711fd1-+-lvs2014: commission new LVS host (codfw hardware refresh)

9ac784dd87-+-puppetdb: add abiliity to override the ca_content

6a0a427e61-+-puppet::agent: update the force_puppet7 flag

408436e14e-+-apt::repository: remove conflicting .list files from bookworm /etc/apt

c867ee4ab5-+-refine - Exclude 3 deleted old EventLogging schemas from being refined

b5b8466d1d-+-Remove cloudsw2-c8-eqiad from monitoring

711eeaf29a-+-glance: hack the rbd driver in glance_store to fix snapshotting

ecee645d1f-+-udp2log: add 6to4 relay

97258065f9-+-puppetserver::g10k: force dir removal

d109641045-+-Revert "puppetserver: support puppet agent5"

20b1aa834b-+-puppetserver: support puppet agent5

489004fb6e-+-puppetserver::g10k: Call g10k from the puppetserver class

a10f1efe18-+-puppetserver: add hiera defaults

9d8404934d-+-puppetserver: Add puppetserver role

2238b1c5a4-+-puppetdb: add puppetserver hosts to puppetdb

a807dc8d41-+-ferm: Add types and docs to ferm::client

7122140e63-+-C:idm:jobs enable Bitu timers

69cead0dc3-+-Allow setting a separate LDAP DN for Bitu LDAP access

0e651d2a6c-+-analytics refinery: add a data purge job for webrequest_sampled_live

15145b3af1-+-profile::cache::kafka: add support for PKI

9778d71851-+-Revert "Revert "varnishkafka: add catch all systemd unit""

db7d3d90e1-+-lvs2010: decommission host for codfw hardware refresh

5a1d975180-+-wmflib: update dump_params and add filter_params

20d3c66ad2-+-webperf: Fix /excimer/ POST restriction in prod too

9ddc4bc194-+-mwlog: upgrade logrotate and use ignoreduplicates

9ce76afee1-+-openstack: codfw1dev: cloudnet: enable cloud-private subnet

4671767913-+-openstack: rabbitmq: add rule for cloud-private

faa9f79b8a-+-site.pp: Add definition for puppetserver

8fda996b9f-+-site.pp: drop pupetmasters[12]005

593bfefd1b-+-releases: clone repos/releng/release from gitlab

62c6ed5fab-+-toolserver_legacy: Remove exim4 service

c925996b2f-+-Revert "varnishkafka: add catch all systemd unit"

37f57a0f03-+-varnishkafka: add catch all systemd unit

06a0aac558-+-C:idm:deployment restart services on reconfiguration

5e58cd9c1f-+-base: bump cadvisor rollout to 20% in eqiad/codfw

92bf9cb638-+-webperf: Fix /excimer/ POST restriction

a0d0f57702-+-gitlab: Change regex match for blackbox check

879eb9b9c0-+-cloud-vps VMs: don't install py2 mwopenstackclients on py3 distros

25abad7365-+-miscweb: remove sitemaps profile from role

301048e807-+-vrts: separate install & ugprade vrts scripts

497709642c-+-P:wikidough: update location of nrpe::plugin for check

a99651bd99-+-lists: Use stock mailman3 on bookworm

2f96b2dd85-+-eventlogging: remove CentralNoticeTiming

935fda18f4-+-P:ntp: add python3-pystemd package

73470d0dca-+-ntp: do not restart the ntp service on conf change

1d6aefef33-+-apt::repository: fix ensurable

984ac2953b-+-toolforge: add the common config file for clis

5da51c675d-+-lvs2013: commission new LVS host (codfw hardware refresh)

342a6b4b8f-+-Revert "openstack: rabbitmq: simplify cloud-private-subnet firewalling support"

97358adebe-+-firewall: add basic firewall class

46233b8326-+-cloud_private_subnet: persist static routes

8cabe6f6eb-+-openstack: rabbitmq: simplify cloud-private-subnet firewalling support

0219ea18e8-+-puppetserver::git: make ensureable

c5cb221318-+-cloudvirt: codfw1dev: add cloud_private_subnet

3a8971555e-+-Remove option to manage sources.list

e2d2d38769-+-idm: Mask the generic uwsgi service

22f387f4df-+-opensearch_dashboards: remove alerting and observability plugins

bf78083dbc-+-prometheus: add external swagger checks to all sites

e9f1205d7d-+-Use same php version for doc and integration websites

a341831ca8-+-bookworm: improve deb822 puppet warning

3c523978bc-+-bookworm: Change to deb822 format for sources.list

1bc4ac782e-+-puppetserver: subtract keys rather than passing to dump_params

bca594451c-+-puppetserver: add additional config options

3ad98dc9b6-+-don't export resources when wmflib::have_puppetdb() is false

bed4d6d294-+-safe-service-restart: use failover i13n

09bc641f62-+-java: ensure wmf-certificates is installed, when required

4f8e09ece2-+-puppetserver: hiera type defs

075304e0ff-+-wikidata maxlag maint script: use new pybal VIPs

0d3dceed02-+-Remove wmflib hack for logoutd scripts on Stretch

4ff1ff0d96-+-lvs2009: decommission host for codfw hardware refresh

5f2b849d0f-+-Cloud: Remove support for Stretch

ca48a10496-+-Update kubernetes nodes with GPU settings

43b593230d-+-interface::route: add persist option

47f82c1202-+-pybal: configure failover i13n IPs

8a71f15563-+-firewall: update copmments to mention profile::firewall

cd7f0c7db1-+-openstack: nova: api: cleanup unused network constant

6b21a452fd-+-base::firewall: remove the old firewall classes

74b4d889c7-+-wmcs::firewall: use profile::firewall

20b97df637-+-profile::base::firewall: move to profile::firewall

52ccf4bb6d-+-contint: set Jenkins agent username from hiera

a6ceec841a-+-contint: Jenkins slave > agent

6d796decdd-+-webperf: Remove remnants of coal and coal-web

8f9ffc5bcf-+-prometheus: drop k8s pods-related metrics from cadvisor in 'ops'

d876993dda-+-gerrit/bacula: adjust Gerrit file paths to be backed up

423607081d-+-httpbb/site: remove sitemaps tests and comment

e883c30ef4-+-ntp: revamp and refresh our "tos" options a bit

26aa65a3ed-+-ntp: avoid DC-specific data in peering code

afb46a8742-+-P:wmcs::instance: drop stretch-backports config

83d76d6ace-+-sudo: remove sudoldap support

b1ef811aed-+-ldap: Drop stretch support

44f4404bc9-+-puppetserver: fix permadiff on $ssl_dir

078e6309c6-+-ferm: Ensure iptables is installed before configuring alternatives

731ebea682-+-Also apply url downloader role to remaining Bullseye hosts

bf2f43cbcc-+-Remove KDC role from krb2001

a7978ca72c-+-debmonitor: Use wmflib::dir::mkdir_p()

f87e7c552c-+-debmonitor: Handle the deployment directory if not using scap

824684e645-+-microsites: remove bienvenida.wikimedia.org, migrated to k8s

5e3ca634e7-+-Bitu: Add an alert for the front page

db353bd09c-+-debmonitor: Install Debian Django packages on Bookworm

6c90da81c6-+-swift: remove support for pre-bullseye

8406ecc7d4-+-Cloud VPS: Remove support for stretch in various roles

9c3db78d6e-+-C:IDM Remove absent systemd services.

7cfa638c6c-+-rabbitmq: Change node names to use the cname service name

6a5fc48f3a-+-prometheus: fix swagger job relabel configs

773f5cb275-+-prometheus: re-enable swagger jobs from service catalog

9dd283cdff-+-hieradata: upgrade cassandra-dev2002 to Cassandra 4.1

23eac0b0cd-+-kubernetes: Set default service_node_port_range to 30000-32767

af93beb966-+-fix typo for cloudswift100[1-2] in site.pp

99a2dfc7d4-+-opensearch_dashboards: fix package name typo

5cc489321a-+-swift: Remove stretch support

3851d60ce8-+-C:idm::deployment rename OIDC service variable.

466a1a814b-+-Switch ganeti_test to profile::firewall

a6bcf15a2b-+-Switch debmonitor to profile::firewall

dcca15badb-+-P:cumin::cloud_targets: use array for srange

84997d1d5a-+-ferm::service: allow passing array of hosts

fb37375371-+-firewall: Surround srange with braces

62f82f47f4-+-proffile::firewall: create new firewall profile

145960fcac-+-kubernetes: Remove infrastructure_users static token file

fb4f6406c4-+-kubernetes: Remove infrastructure_users static token file

39cdefa6c0-+-prometheus::k8s: Unconditionally use client certs

b0e41cf18f-+-cloudcontrol2004-dev: put it into service with new IP address

44a6b37b36-+-Revert "releases: Ensure rsync jobs get removed on the non-active machine"

68077d7a4f-+-prometheus: ensure absent invalid swagger targets file

ca138f4c1a-+-releases: Ensure rsync jobs get removed on the non-active machine

b558d863dd-+-prometheus: disable new swagger job

c7fa173c5c-+-prometheus: remove invalid cluster key

2fc6097bfc-+-prometheus: generate swagger targets from service catalog

f62ee60931-+-opensearch: add disable_security_plugin to instanceparams

8b2eaf2e3e-+-hieradata: upgrade cassandra-dev2001 to Cassandra 4.1

81882cb7d5-+-Make dumpsdata1006 the nfs primary for xmldumps and dumpsdata1005 a spare

d4112134fa-+-prometheus::k8s Reload prometheus on certificate change

9531627616-+-dnsrecursor: add reverse DNS for cloud-private

32ec79dc1b-+-prometheus::k8s Make client certs readably by prometheus

28344a3fe8-+-prometheus::k8s Fix removal of bearer_token_file

6f21d28ea7-+-Apply puppet role to new releases hosts

89bc5d15b3-+-prometheus::k8s switch staging-codfw to client cert auth

ca40442e61-+-prometheus::k8s: Use kubernetes::clusters_defaults

3c2ddb9247-+-gitlab: use sshkey for git-ssh public keys

92cffee2e0-+-profile::calico::kubernetes: Address potentially undefined variable

f0a58e5c9a-+-logster: remove classes

476193b4df-+-P:toolforge::proxy: remove absented logster resources

28ad4fd4be-+-Revert "swift: disable free inode btree at mkfs time"

00e41cb161-+-codfw1dev: remove traces of cloudcontrol2004-dev.wikimedia.org

972093b311-+-microsites: move blackbox checks to dedicated monitoring profile

b994e03b53-+-microsites: remove annualreport, migrated to k8s

9838bb0d5c-+-Ensure /etc/kubernetes/pki has proper permissions

795e15bbd9-+-Setup debmonitor2003 as bookworm debmonitor VM

00e40b9831-+-profile::imagecatalog: Fix permissions for client certs

82e14556f7-+-Fix owner of admin kubeconfig certs

b4f0938516-+-profile::imagecatalog migrate from user token to client cert

ba9fe91756-+-deployment_server: Create k8s configs with pki certs

25ac4aeece-+-cassandra: add support for version 4.1.1

e0383977c5-+-Changes from hard-coded list of hosts in doc module

cb6a0f363c-+-create mount point dir for dumps test nfs share

2e8f976c19-+-Rename nfs_settings dir to nfs_testing and move nfs test files into nfs test dir

7534413c84-+-Dumps: move the nfs share test conf to the right location

0a6fb1e112-+-service: Disable monitors for wikireplicas

0051499404-+-cloudcontrol2005-dev: enable puppet role

e90daf5b6c-+-Gitlab: Support OIDC alongside CAS for OmniAuth in Gitlab

e3642ed02a-+-cloud_private: route the whole cloud public IPv4 space to cloudsw

8e1bf0f9e0-+-spicerack: add test-cookbook script

c11e400e3d-+-firewall: drop block_abuse_nets parameter

88d04a4df1-+-Remove profile::kubernetes::deployment_server from role::releases

bd44188994-+-Make kubernetes::clusters the central place for k8s config

f648bf26ea-+-prometheus: remove 'global' instance references

7fa3ff2a21-+-debmonitor::server: Add bookworm support

dd2d566d0d-+-miscweb: set ipv4 and port for 15 and annual blackbox check

e732b82e2c-+-prometheus: don't enable server when absenting

5966a3995f-+-profile: start cadvisor rollout in eqiad/codfw

7c42194db6-+-prometheus: don't add empty targets

3bf78c3dbf-+-prometheus: de-provision 'global' instance

14f23387fb-+-cloud_private_subnet::bgp: set up route lookup rule only for /32 VIPs

e9141f89fa-+-cloudcontrol2005-dev: move to the new network setup

f55c439f32-+-cloud_private_subnet: split BGP code into separate profile

1c1dfebc00-+-puppetboard: add add new role and config for new puppetdb hosts

18b5d8cb35-+-Revert "Revert "Revert "miscweb: set ipv4 and ipv6 for 15 and annual blackbox check"""

caecc379ba-+-mwlog: remove redis instance

5e279e95f2-+-Revert "Revert "miscweb: set ipv4 and ipv6 for 15 and annual blackbox check""

949ad2a540-+-profile: add ensure for prometheus::cadvisor

9a1c116b76-+-gitlab: make sure rsync jobs run after backup

58fa7ac85c-+-puppetmaster2004: also set command_broadcast

8b33c2b655-+-puppetmaster: fix puppetdb_submit_only_hosts

a0a988a50f-+-conftool: Add more servers to the jobrunner problem

6594ac880d-+-C:IDM Ensure service restart on git update

f49d7324a0-+-Revert "miscweb: set ipv4 and ipv6 for 15 and annual blackbox check"

e6a548bdd3-+-miscweb: set ipv4 and ipv6 for 15 and annual blackbox check

4ca43b961d-+-backy2: include python3-psycopg2

fd62cdeb59-+-backy2: Prepare for switch to postgres backend

c4906ff608-+-analytics: Remove extra check on webrequest _SUCCESS files on HDFS

202a334fec-+-profile::configmaster: dump a json data structure of the pools

b770527327-+-puppetdb: Add support for submit_only_server_urls

dec71924d3-+-puppetmaster::common: fix lint errors and docs

6ab0f013d4-+-udp2log: update to take account of systemd updates

0b5a020f8b-+-profile::kafka::{broker,mirror}: simplify dependencies

b515874438-+-doc: allow gitlab runners to publish docs only through `doc-gitlab`

d0fe26b44c-+-add documentation on commands to run for testing new dumps nfs shares

0ba5efca9f-+-profile: ensure varnish-aggregate-client-status-codes absent

873b4fb548-+-microsites: remove http blackbox monitor for 15.wikipedia.org

044523ed53-+-gerrit: remove lfs_dir parameter, use hardcoded new default

8bda244c6d-+-microsites: remove 15.wikipedia.org

bd911151ca-+-ssh: do not try to ca sign host keys if ca is not available

1c75648c02-+-profile::kafka::mirror: add support for PKI certificate

a5f2516cce-+-Revert "Bounce keyholder-proxy when keyholder-auth.d group -> key..."

fab2795ce1-+-udp2log: Add docs, validation and tidy up

c70d360a8a-+-Bounce keyholder-proxy when keyholder-auth.d group -> key mapping changes

a7fc48aa4c-+-base::firewall: remove absented resource

efd82d9b37-+-cfssl::cert: allow users to override the mode of the outdir

dbf23954b9-+-jenkins: switch to fixed uid/gid 924

3ac4529b84-+-Add nginx logs for docker-registry host to rsyslog

642419d1f8-+-add a custom xml dumps config file for testing new nfs shares

30c4b20fb9-+-Puppet additions for ssw1-e1-eqiad

e883ad20eb-+-Create entry for new releases hosts

815841e639-+-introduce a script to create output dirs on xml dumps test nfs shares

f31d6deea5-+-prometheus: add 'ensure' for ::server

4e9ad4e11b-+-icinga: remove swift alerts, moved to alertmanager

00e104e9e8-+-Move doc-gitlab rsync endpoint to doc1002 (primary)

91b458782e-+-Use the spark3 shuffle jars to yarn on a test host

4147458429-+-mariadb: Decommission db1122

bfec8c906f-+-prometheus: clean up eventgate prometheus alerts

e60fe567be-+-Set mariadb-client to pull the right version

6af42e4c0e-+-Create stat user home directory

f49edbda04-+-Create the jupyter notebook config folder

221222a9cc-+-httpbb: add tests for planet.wikimedia.org

1db795e4a6-+-Remove references to labstore100[45]

b30db9b874-+-varnishkafka: remove absented logster integration

af54ff8133-+-Add debmonitor[12]003 to site.pp

3f5588cd4d-+-profile: fix cadvisor deployment to PoPs

c2361d6a50-+-profile: rollout cadvisor to PoPs

28f0065c34-+-cadvisor: disable percpu and cpuLoad metric classes

086e1951af-+-mariadb: Decommission db1121

9c298c0ab6-+-mariadb: Promote es2020 to es4 master

c26b2a9858-+-httpbb: fix path to test file for RT

1245318b61-+-httpbb: add tests for rt.wikimedia.org

123d4f3282-+-httpbb: add tests for etherpad.wikimedia.org

f977f8479e-+-httpbb: add tests for CI, https://integration.wikimedia.org

f37e6a580a-+-httpbb: add tests for gerrit and gerrit-replica

11f1a951cb-+-httpbb: add simple test for VRTS

767341ef7d-+-httpbb: add simple tests for gitlab.wikimedia.org

c1adbea316-+-pybal/lvs: remove backward compatibility for buster

19098e7401-+-Puppet additions to bring ssw1-f1-eqiad under management

1e8769ae36-+-Remove bast2002 from site.pp

71b7cd5115-+-Drop Boost packages from legacy package removal list for Bookworm

167509ea96-+-zuul: switch to fixed uid/gid 923

0e37afa0e9-+-move nova-fullstack test to cloudcontrol2005-dev and cloudcontrol1007

abc095637d-+-codfw1dev: move nova-fullstack test to cloudcontrol2005-dev

f5cf974744-+-create custom db list files for testing of nfs shares for xml dumps

c71fb0fc09-+-add nfs tester to dumps worker (snapshot) testbed role

a291be0514-+-Add dump user subdirectories to support testing of new dumps nfs shares

4f60175c84-+-prometheus: don't fail on unknown blackbox probe type

96329b1f32-+-cadvisor: add explicity metrics enable

fb1eff823d-+-cloud_private_subnet: allow hiera overrides of the nic used for the vlan

3e95e92be6-+-Remove db1112 from puppet

b705ee9beb-+-cloudservices: codfw1dev: enable cloud-private subnet

400cd1b3d8-+-produce_canary_events - revert bump of refinery-job version

43d1ac1535-+-produce_canary_events - fix refinery-job to use shaded jar

88e39fbd8d-+-Bump refinery version for produce_canary_events job

2329fc5a70-+-Bring stat1009 into service

8b317570da-+-toolforge: fix typo in config key

3d51139a59-+-toolforge_cli: add api gateway url and builds endpoint

701466f4c8-+-Modify runtime of html dumps rsync to secondary host

c632cbcb51-+-logrotate: update description in override

f29153ad11-+-prometheus: add the named port scraping option to all clusters

e895e2e85c-+-prometheus/k8s: fix annotation name

8d074b6a43-+-prometheus/k8s: add selective scraping of ports in staging

20e0d7724e-+-mariadb: Decommission db1115

cda600f379-+-remove wmcs-backup-instances script, no longer used

28409d4ece-+-gerrit: allow masking the service and do so on gerrit1001

2759efd8a1-+-keystone: service: allow cloud-private supernet

55d4dff29e-+-dns2006: add Puppet role and DNS/NTP configs

b6671ff58f-+-Obsolete profile::python37

dc8a1d7345-+-trafficserver: actually carry over the config file

4896e307b5-+-role::webperf::profiling_tools: add redis instance for arclamp

5aadb52b66-+-Add the refinery-cache directory to the git safe list

55e4dee080-+-vrts1001: Switch to insetup::serviceops_collab

5cb5dc219f-+-Revert "Revert "dns2005: add Puppet role and DNS/NTP configs""

546da09116-+-envoyproxy: Migrate from access_log_path field to FileAccessLog API

9808ee1326-+-cache::haproxy: Fix missing socket variable

72c6a1f04d-+-cache::haproxy: Set nbthreads on the first global section

e93dbc6106-+-docker::baseimages: skip building bookworm

cf2f80ea1c-+-mediawiki: Add auto_prepend_file to PHP config_cli (take 2)

a62b7e2613-+-site.pp: Update sanitarium master for s4

dcbb69481d-+-doc: temporary config for docs publishing from gitlab

71ea7d58ac-+-Revert "dns2005: add Puppet role and DNS/NTP configs"

0f4d6dce49-+-dns2005: add Puppet role and DNS/NTP configs

f36a33038f-+-site: revert vrts2001 role post re-image

16b39c2c79-+-docker::baseimages: support bookworm

b22edc7ead-+-profile::arclamp::redis: introduce/move arclamp redis config to profile

df09d0d938-+-gitlab: make sure letsencrypt extention is disabled

b715442796-+-install_server: convert dhcpd.conf to template

294a54fb54-+-installserver: enable ZTP for network devices

bcb6882da8-+-Remove db1123

013e27a0cc-+-P:toolforge::proxy: uninstall toolsweblogster

3886ad09fa-+-insetup::traffic: properly handle LVS case

ebfe27ccec-+-Revert "Revert "lvs2012: commission new LVS host (codfw hardware refresh)""

5d20bedfd0-+-Revert "O:traffic: Add lvs::kernel_config during insetup to allow reimages"

bc26fbbe0f-+-openstack: db: use dnsquery::lookup

f840a70225-+-Openstack galera/mariadb grants: allow access via haproxy nodes

8558bf60aa-+-P:opesntack::pdns: remove manual forwarding rules for wikimedia.cloud

68cb924f55-+-Add cloudswift100[1-2] to site.pp and netboot.cfg

b74a2423e1-+-puppetserver: add puppetserver module

59d5ced917-+-firewall: Remove kafka_brokers_analytics

c23afd06c6-+-wmcs::firewall: add a way to block addresses in wmcs

13ed72d66a-+-Remove python-is-python3 package from hadoop bullseye hosts

a4f21aa8a0-+-Add configs to spark-defaults.conf to enable Iceberg.

1ce41b74f3-+-gerrit: remove leftover absent http config

1e595c7177-+-wdqs: Activate wdqs2021

6ae8ec39df-+-Remove db1110

6d01268cd5-+-benthos::instance: add --skip-env-var-check to lint

e619567c94-+-admin: make admin::kerberos_users more generic

d044d1a0ec-+-O:traffic: Add lvs::kernel_config during insetup to allow reimages

976b87f898-+-Revert "toolforge_cli: add api gateway url and builds endpoint"

acac706824-+-toolforge_cli: add api gateway url and builds endpoint

f938df9914-+-Place airflow1006 in airflow role

7c374821df-+-Configure product analytics airflow instance

dfff28d652-+-Remove bastion role from bast2002

e2682619bd-+-Revert "lvs2012: commission new LVS host (codfw hardware refresh)"

72fb341011-+-cloudlb: haproxy: drop support for IPv6

3b0aa42c71-+-lvs2012: commission new LVS host (codfw hardware refresh)

c2ef192910-+-dumps::distribution::ferm: update to resolve hosts in puppetmaster

9da2b513ee-+-gitlab: refactor omniauth providers to a data structure

e46fbab151-+-gitlab: omniauth_sync_profile_attributes shuold be a list

8abf904cdf-+-cloudgw: fix cloud_filter configuration

e760476b3c-+-cloudlb: drop force_ipv6 param to lookup as its currently borked

ff1cd0ca02-+-cloudgw: enable general perimetral firewall

1c3b23e647-+-cloudlb: use dnsquery::lookup()

866c04b484-+-openstack: keystone: install the /etc/keystone/domains directory

833874c7a6-+-Remove db1113 from puppet

44bb3295d9-+-site: add thanos-fe[12]004

58c8e3e79c-+-cloudcontrol2001-dev: give it proper role

1127532da3-+-mariadb: Promote db1212 to s3 sanitarium master

34694d0cc0-+-docker_registry_ha: remove unused cache::nodes ref

88e6eda61a-+-clouds.yaml: further fixes to support system scope sections

70b7ce411b-+-clouds.yaml: specify system_scope for special system sections

48fe3a8f90-+-Add cloudcontrol2001-dev with role insetup

8cb0eeabff-+-P::ldap::client::labs: drop support for production

4df91b20c3-+-Don't expose sensitive config to Airflow UI users.

c82535fff5-+-site: change vrts2001 role

48bb2a0057-+-airflow: decommission an-airflow1001

8087824732-+-cloudcontrol2001-dev: introduce cloudlb support

945faf777b-+-coal: Uninstall from webperf role and start decom

9bc429f1db-+-lvs2008: decommission host for codfw hardware refresh

88069cf296-+-webperf: enable libapache2-mod-php7.4 on profile::webperf::site

c9d8c5697f-+-gitlab: enable and run partial backups daily

39202845a6-+-P:toolforge: webservice: set public_domain config

ba2f220195-+-[gitlab/runner] Add basic pool/depool commands

f1671afd4e-+-cloudgw: merge eqiad/codfw dmz_cidr configuration

4b392cb4bc-+-P:toolforge: merge jobs_framework_cli to toolforge_cli

5e212bf9b2-+-ci: rm gitcache absented timers

3c8b74ac0c-+-ci: add a couple extensions to git cache

680d9fdd6f-+-ci: use an array to manage gitcache repos

00965514be-+-ci: daily update all git cache repositories

aadc368a7b-+-Add ldap-rw[12]001 to site.pp

91ba836640-+-service::node: Remove use_nodejs10

02b16b5ae3-+-P:wmcs::toolserver_legacy: convert icinga checks to blackbox probes

fa9d0cf749-+-mariadb: Promote db1215 to zarcillo master

73dee5ca22-+-site|install: add vrts1001 insetup

d825f6419c-+-Rearrange py2/py3 versions of mwopenstackclients.py

86ae88b5e6-+-Revert "Revert "lvs2011: commission new LVS host (codfw hardware refresh)""

2fe1cbe83b-+-dns2004: add Puppet role and DNS/NTP configs

03504ec3c1-+-toolforge: add tekton metrics to prometheus

984c0e0bca-+-cloud-private: refresh domain

99204424b7-+-cloud_private_subnet: add support for return traffic to public VIPs if using BGP

f4fc8aeb17-+-apt: unattendedupgrades: upgrade osbpo packages too

50b8b961d8-+-kubeadm: install certificates before trying to use them

6d0c049b42-+-prometheus::server: properly purge rules_path

9c3686ea1f-+-Revert "prometheus::server: fix target and rule purge rules"

abe2dfe5e7-+-P:toolforge: actually install toolforge-cli package

ad19d1213c-+-P:toolforge::k8s::client: remove toolforge-webservice link

2041849df2-+-P:toolforge: fix toolforge-cli config file location

7ae5701877-+-prometheus::server: fix target and rule purge rules

be89cc3b9b-+-Move duplicity check for apt keyrings to !defined

eaed359c60-+-nfs-exportd service: subscribe to clouds.yaml

2696fe88e6-+-remove references to cloudvirt1023 and cloudvirt1024

0691bb84fd-+-Remove references to cloudvirt1019 and 1020

1b61533a62-+-clod_private_subnet: fix BGP neighbors

e04b1db886-+-Revert "Revert "Revert "P:wmcs::prometheus: set openstack scrape_interval to 4m"""

3b9dc78a77-+-cloudlb: fix BGP IP address

7f1a2d5256-+-profile::bird::anycast: allow setting the BGP IP address from the profile

45dc690528-+-fastnetmon: Remove absented Icinga resource

a9838b3631-+-labstore: avoid paging for iowait/throughput alerts

b22cd10dbf-+-Revert "lvs2011: commission new LVS host (codfw hardware refresh)"

da208f9a8f-+-kafkamon: cleanup buster classes

8c609e7445-+-pontoon: install dhcp client

5b6cfa3b93-+-lvs2011: commission new LVS host (codfw hardware refresh)

0521355ab3-+-kafkamon: cut over to bullseye exporters

56c3abc6f7-+-Revert "Revert "P:wmcs::prometheus: set openstack scrape_interval to 4m""

cf9c24e70a-+-mariadb: Remove puppet entries for db1114

075ba7c6f6-+-Revert "mariadb: Remove puppet entries for db1114"

6c3723e40e-+-mariadb: Remove puppet entries for db1114

f2e6b9ef9f-+-Assign bastion role to bast2003

894f76b385-+-site.pp: decommision test-reimage2001

721f10500d-+-Increase number of retries for html dumps download

9e2f14da44-+-puppet_compiler: bump version

1f22683c0f-+-cloud_private_subnet: support using FQDNs instead of hardcoded IP addresses

ed85e155e3-+-lvs2007: decommission host for codfw hardware refresh

e435709b45-+-apt: drop files from the puppet source

1e7ed87d04-+-prometheus: Synchronize only the /srv/prometheus directory when migrating data

32b5b9b75b-+-Use signed-by to include the Wikimedia repo starting with Bookworm

4de16d8f14-+-Use signed-by to in apt::package_from_component on Bookworm

3bbfe2932f-+-toolschecker: update list of expected etcd nodes

49431f7851-+-Remove unused labstore code

88b842efa2-+-apt::repository: Don't assume all repository keys are ASCII-armored

8043200131-+-ipmi: remove check_ipmi_sensor, moved to Prometheus

77387c19b9-+-mariadb: Remove puppet entries for db1111

870b463f11-+-mariadb: Move db1110 to m3

5b3cd09e51-+-site.pp: Decommission db1117

262ca83a7b-+-Add python-all to make pybal buildable on build2001

68b4dd6708-+-Add new codfw lvs nodes to site.pp

ad4ab48903-+-kafkamon: transition to firewall definition

a61a3580e7-+-prometheus: Add UID/GID mappings support for promethus data sync

69e607c796-+-make snapshot101[45] temporary testbed hosts

f6a12fdc8c-+-Make Refinery deploys compatible with CVE-2022-24765 fix

63dbd939cf-+-analytics: Add purge job for webrequest data loss reports

efc97c191b-+-apt::repository: use signed-by instead of apt-key

c0dae6ef26-+-P:ldap::client: split config and utils to a separate profile

3ede553696-+-Partially revert "Remove unused role and profile for wmcs project-..."

cc11275729-+-Create /root/.config/openstack before putting clouds.yaml in it

6d27720115-+-Remove unused role and profile for wmcs project- and home- nfs servers

d62e56ca5a-+-observerenv: include in both global and root-local clouds.yaml

14657bfc27-+-OpenStack observerenv: Add global clouds.yaml file with observer creds

03b3f3a6ba-+-P:wmcs::metricsinfra: install blackbox exporter

58b6cc3d5b-+-openstack: envscript: update default port

4f35c7ce53-+-openstack: envscript: do not set a default for clouds_file

b7263cf25d-+-P:toolforge::prometheus: reformat http definition

64878b1d98-+-p:toolforge::prometheus: add rewrite module

367532c602-+-amd_rocm: fix package declaration on bullseye

c5b5209c1e-+-gerrit: do not monitor the replica

eefee4dd63-+-gerrit: accept 200 in addition to 302 and 404 in monitoring

306d43dab6-+-gerrit: accept http status 404 in blackbox http monitor, for now

d9712ec37f-+-gerrit: expect http status 302 from / in blackbox monitoring

226ff184db-+-gerrit: follow_redirects in blackbox::http monitoring

9183179581-+-gerrit: add Prometheus blackbox https monitoring

9cd707f0d6-+-envscripts: fix novaobserver domain IDs

243a263866-+-OpenStack: add a clouds.yaml file for environment setup

32390cefd3-+-opensearch: add disable_security_plugin option

4ec23a8c7c-+-wmflib: Add Maglev Hashing (mh) to supported types

1ef7d02342-+-haproxy: Add haproxy 2.7 to the list of versions

05a16614d4-+-P:toolforge::prometheus: redirect webroot properly

7eabfdb57c-+-P:toolforge::prometheus: set team: wmcs on alerts

010bace179-+-toolforge: add pingthing to prometheus

3c1b6372a6-+-prometheus::ops: add demo node exporter job for SONiC

b428ff9cdf-+-prometheus: Show transfer progress when migrating data

9f1d29fe0e-+-kafkamon: add bullseye role and node assignments

6d79a1bc93-+-vendor_modules: update dnsquery module

509d94e535-+-cassandra: update 'dev' version to 3.11.14

dd0e02850d-+-Stop installing ruby-safe-yaml

4eacacf123-+-debian::codename::compare: allow passing explicit codename

4264b237a1-+-httpd: always use systemd

87d6971a57-+-package_builder: add hooks for bookworm

a2d86848f1-+-git-sync-upstream: add support for gituser and alternate base directories

6e5b988b0e-+-Adapt sources.list for bookworm

df72d2ff96-+-prometheus::blackbox::check::http: allow passing alert data

c4cb087845-+-cassandra-dev: enable prometheus metrics

aaddda8e1a-+-profile: ensure several dashboards plugins are absent

6323629bc8-+-profile::amd_gpu: add support for the K8s device plugin on DSE

9be2c69253-+-mariadb::generic_server: change default datadir path

1311cfaa2f-+-hdfs_tools - Remove reference to non existent profile::analytics::hdfs_tools

a41ce523a2-+-sretest: Don't include opentelemetry-collector on bookworm

f6b71bd6cc-+-install to secure erase cp501[3456]

d43fcdb7fc-+-prometheus: Add support for syncing data between Prometheus hosts

c3f4008c71-+-detect_rabbit_partition: make executable

5e181d5c08-+-rabbitmq: add a single-purpose metric to detect network partition

db409f0586-+-spicerack: install python3-aiohttp

883f1f661a-+-prometheus: delete migrated eventgate alerts

a6afebc221-+-toolforge: Use shard name 'toolsdb' in profile::wmcs::services::toolsdb_*

3268d2e866-+-P:IDM Enable Wikimedia Global Account linking.

337fde1dea-+-gitlab: add ferm rule for certbot on WMCS

81b779d8a0-+-site.pp: These hosts are bullseye

e64e7c4bb4-+-site: add gerrit prod role to gerrit1003

0e8c5d996d-+-gerrit: make the lfs data path configurable

1133a12bad-+-hdfs_rsync - Remove absented

d430561089-+-hdfs_rsync - ensure old renamed systemd timers and script are absent

5e48bd3e22-+-hdfs_rsync job fixes

46f6545a97-+-mc-wf100[12]: Add memcached role

24c0c27461-+-kafka-logging: assign kafka::logging role to kafka-logging100[12]

3ed58e5fa0-+-thanos-fe: proper insetup Puppet roles to machine

a9f74b682d-+-Refactor dumps::web::fetches::analytics::job

3ba84e2203-+-varnish: Allow disabling port 80

ef45337d3a-+-P:idm Compare IDM redis master on FQDN

1e95124e2e-+-backup: add /srv/gerrit/data to fileset for gerrit repos

e65af7dd45-+-gerrit: add /srv/gerrit/data/lfs to dirs managed by puppet

8fe15eadbc-+-Don't add debian-debug for Stretch hosts

1d03958f45-+-No longer use mirrors.debian.org on Stretch hosts

5fb0652efe-+-Stop building stretch baseimage

954b5d5247-+-builder: drop stretch

1f6614440d-+-P:mediawiki::common: Remove deploy check_dsh_group

9b4ce8cc3b-+-puppet::agent: rename the enable_puppet7 flag

ce3bda1930-+-tlsproxy: Fix Nginx reload when cfssl certs get renewed

62d4da8763-+-cache::haproxy: Support http --> https redirection

4ef087ce9e-+-phabricator: add parameter for db_datadir in cloud and use default path

a0c55d9780-+-wdqs: correct profile logic

fabcc4ed63-+-phorge: add parameter for db_datadir and use default path

48ea461c57-+-wdqs: use newer java profile for wdqs

3a93ec57cc-+-Add bast2003 to site.pp

b1ebd92625-+-cassandra: add de-init to systemd unit file

b5e30df1b2-+-gerrit: replace Icinga monitoring with Prometheus, ssh port 29418

c1271724b5-+-wdqs: activate wdqs2022

8b8beb9538-+-replace puppet::config with concat

5bce15d634-+-varnish: bump size of varnish shared memory log to 160M

5fbd524bcb-+-Add Product analytics airflow instance

4e9fba72ca-+-amd_gpu: add udev rules to bypass the 'render' group

6534b6df18-+-gitlab: add script to create fs and raid for backup partition

d2f741ae49-+-Add the perccli utility to the new Ceph servers

e81e792f6e-+-Add dns200[4-6] to site.pp and netboot.cfg

19cae4ac7e-+-P:lists:monitoring: Raise process count for uwsgi

aee313ac60-+-site.pp: Fix typo

ddf8f8e7f6-+-site.pp: Remove insetup from db1213

a9c64dd3bf-+-site.pp: Add db1213 to s5 and s6

b52317b5fc-+-lists: Bump the number worker processes to 4

dc4dee4c4e-+-Revert "Move cloudvirtlocal1001 back to 'insetup'"

75a3b32f06-+-labstore: remove most monitoring classes

d983baf37d-+-labstore: stop provisioning backup keys

28ab5fe9cb-+-labstore: delete backup related classes

ad69afb89f-+-O:wmcs::nfs: remove primary_backup::tools and related classes

993a1da1d6-+-P:toolforge::checker: remove showmount check

e7ef30b9bb-+-O:wmcs::nfs: remove primary_backup::misc and related classes

79f8ebb7f0-+-Add new backup node to site.pp

3d0f82929d-+-kafka-logging: bring up kafka-logging1005 with node id 1005

1a5bb289f7-+-kafka-logging: stop kafka service on kafka-logging1002

c120293a27-+-Revert "Stop the YARN queues temporarily to facilitate switch maintenance"

0d1ec65ded-+-mariadb: Remove final references to db1116 & db1102

47b86f382b-+-Stop the YARN queues temporarily to facilitate switch maintenance

dc6fa9683e-+-P:ssh::ca: do not call secret() with undef

07a70a82b1-+-ssh: add support for using a CA for host keys

9762e12c53-+-mariadb: Move db1102, db1116 to spares

df724287f0-+-ssh: extract enabled key types to a parameter

f651765b7e-+-mariadb: Decommission db1109

cfa5fb49ad-+-mariadb: Productionize db1219

6027c651ae-+-gerrit::migration: ensure gerrit review_site dir exists

e4bdf81173-+-OpenStack envscripts: replace UNDEF with UNSET

e3c183f8ae-+-OpenStack env scripts: different script names for new env scripts

20ae7c1204-+-Openstack envscripts.pp: create additional scripts for system and domain scope

dc1df06ca6-+-openstack::util::envscript: allow caller to specify domain_ids

932e0c6644-+-C:squid Squid logs are managed by rsyslog

fb78f8ef47-+-logrotate::rule: allow post_rotate to accept multiple lines

050279cccc-+-openstack: encapi: open up write access

44c0e6dbf7-+-Add an in place Debian upgrade script

c55b5a5371-+-P:url_downloader move syslog info

1108887061-+-Revert "Place an-worker1132 back into the insetup role"

90bece007a-+-P:url_downloader move squid access to separate file.

e4ff4b5bc6-+-Swift: start rclone job earlier

5e26c7d672-+-[gitlab/ssh] Only recurse if the directory is to be removed

8be21e4c44-+-Place an-worker1132 back into the insetup role

799832ef56-+-dbbackups: Setup db1216 as the new backup source instead of db1116

7c6349516a-+-mariadb: Productionize db1212

9156e46941-+-mariadb: Decommission db1100

75e415151b-+-Install ruby-sorted-set on Bookworm

7b7bc78c40-+-Add cloudbackup2001 as a second cinder-backup host

15708d7dae-+-cinder-backup: fix path to manager.py patch file, again

3a47b87864-+-cinder-backup: fix path to manager.py patch file

f6707f19d9-+-cinder-backups: patch to support multiple backends

ac7b3db373-+-prometheus: Apply prometheus::pop role to prometheus5002

3db5d55ae5-+-prometheus: Apply prometheus::pop role to prometheus6002

a56746f329-+-prometheus: Apply prometheus::pop role to prometheus4002

818ffeb3dd-+-Remove outdated references to pybal-test200[12]

c418076e91-+-Nova/cloudvirtlocal: force replacement of /var/lib/nova/instances

e5690383f2-+-Move cloudvirtlocal1001 back to 'insetup'

f173c34e22-+-mariadb: Remove db1120 from puppet

1f30aa5ef2-+-analytics: Prepare removal of systemd_timer check_webrequest_partitions

90b3f8faa7-+-webperf: fix puppet on arclamp*

0536d7a17b-+-Remove obsolete pinning after recent toolsdb migration

7d67831a5d-+-site.pp: Add db1217

6c2f5305d8-+-mariadb: Remove db1107 from puppet

de059d1fc1-+-wdqs: remove query-preview microsite

8b1d3c515a-+-doc: upgrade php from 7.3 to 7.4

2e79442654-+-mariadb: Setup db1225 as a replacement for db1102

39ef79f6aa-+-vrts: do not use /srv/sqldata as mariadb datadir (cloud, devtools)

be77377f8e-+-cloudvirtlocal: move instance dir to /srv/instances

657a67d87f-+-cloudvirtlocal: link nova instances dir to /srv

52305a656c-+-Make cloudvirtlocal100[1-3] into actual cloudvirts

4cba3a4e4c-+-profile::kafka::{broker,mirror}: refactor TLS settings

75c1bf7433-+-Fix hostname for new cloudvirtlocal hosts

55f01ee0e3-+-ci: indicate which server is the control server via a hiera param

a7d43a06e9-+-ci: rename ci::master role to ci

331833263a-+-cache::haproxy: Enable coredump configuration

284565930b-+-aptrepo: Drop kubernetes 1.21 components

72e0183b3b-+-maintain_dbusers: move all the files under service

50578081bb-+-P:toolforge::prometheus: scrape harbor metrics

1b17d54648-+-mariadb: Productionize db1217

31f19c1a79-+-amd_rocm: add support for Debian Bullseye

6d13e32654-+-site.pp: Productionize db1214

431cbd5ee4-+-Install Puppet 5.5 on Bookworm

81200c6c8c-+-C:httpd move htcacheclean to httpd class

d6c9ef4c41-+-Add a disable_tool job to a cloudcontrol

db2734f484-+-prometheus: Apply prometheus::pop role to prometheus3002

1fbd896788-+-site: add role(gerrit::migration) to gerrit1003 and fix code

e838d531a4-+-profile::toolforge::grid::exec_environ: use ensure_packages on pymysql

24bd5a0e27-+-Add profile::toolforge::nfs_disable_tool

6aa0d6c61f-+-profile::toolforge::disable_tool: include python3-pymysql

2b791fe8b5-+-profile::toolforge::disable_tool: fix a couple of param names

f829cd8563-+-Add database config for disable_tool process

22b4912cc9-+-buildkitd: Isolate build container user/process/network namespaces

a438d7bef4-+-Create a separate Hiera variable of KDCs specifically for use in client config

4946d4add9-+-Rename cadvisor_exporter to cadvisor

6c17646cb6-+-Add keys for sshd-gitlab from the secrets repo

c4ceaf0d3b-+-role::dse_k8s::worker: add AMD GPU support

a72960d248-+-aptrepo: import AMD ROCm 5.4 to bullseye-wikimedia

5965fa78be-+-mariadb: Place db1223 into s3

e82aaffe1e-+-kartotherian: Stop passing use_nodejs10

eefcd8bc6c-+-core_test.pp: Add mariadb 11.1 package

928813b5fb-+-cloud_private_subnet: add route to public IPv4 range

e255b801c5-+-alerting-host: toggle auto-restart for ircecho/icinga-am on failover

cdbbff1465-+-scap: block Scap deployments on inactive deployment hosts

5cc95d1cd4-+-mariadb: Productionize db1221

a0c3a5a5ac-+-P:httpbb: Remove absented httpbb_kubernetes_hourly

793f502dba-+-P:httpbb: Fix wrong test directory

87370cb73d-+-P:httpbb: Add monitoring for kubernetes services

af0c9b06a8-+-aqs: Remove use_nodejs10

df811ad0b4-+-mariadb: Productionize db1210

3b2a0acc41-+-miscweb: remove iegreview profile from role/hiera/tests

5998a02bb7-+-Initial puppet setup for cloudvirtlocal100[1-3]

8d58ccdbc8-+-base::standard_packages: remove isc-dhcp-client

f1f9cf059b-+-::analytics::refinery::job::druid_load: absent remaining jobs

26ccb32705-+-site.pp: Productionize db1215

9831bc5bdd-+-P:netbox: add consumers for prefixes and net devices

9f2a41300a-+-site.pp: Productionize db1222

5cdf85d1d9-+-Revert "packages_wmf.pp: Remove support for stretch"

316e88c059-+-contint: Jenkins master > controller

aecb141b89-+-ceph: Allow setting a crush location hook for the rack

6093eea8bf-+-mariadb: Productionize db1218

b3654a5c86-+-mariadb: Decommission db1103

9adcf42523-+-packages_wmf.pp: Remove support for stretch

7a6ab923aa-+-site/miscweb: remove miscweb1002, switch rsync source to miscweb1003

48b11ba0b0-+-Revert "sessionstore: assign values to net.ipv4.conf.all.arp_{ignore,announce}"

ae6ec291d5-+-sessionstore: assign values to net.ipv4.conf.all.arp_{ignore,announce}

301a223ff7-+-iegreview: remove blackbox::http monitoring

1bdf4d8815-+-P:netbox:host rename netbox host to netbox device

3767e4adc4-+-kafka-logging: bring up kafka-logging1004 with node id 1004

3ffba65c46-+-kafka-logging1001: update role

1ae1cef7db-+-kafka-logging: stop kafka services on kafka-logging1001

322911b036-+-site.pp: Remove insetup role from db1224

08969bcd79-+-mariadb: Productionize db1224

e4f95f72b8-+-mariadb: Productionize db1211

c652ddd339-+-mariadb: Productionize db1209

80e2d6d862-+-mariadb: Decommission db1101

c659971cf9-+-mariadb: Move db1183 to s5

6920a6eb64-+-Remove direct NFS backup logic from cloudbackup2002

ed49bf4f20-+-osm: remove unuseud shapefile_import class

7e615071b2-+-P:wmcs: remove osmdb classes

a98b5c41bd-+-swift: add ms-fe101[3-4] as new Swift proxy nodes

24f8cb2b25-+-modules::profile::manifests::airflow.pp: add plugins_folder path

a973f845d2-+-zuul::merger: Fix up checks

486478766d-+-zuul-merger: Make auto restart dependent on whether service is enabled or not

614d5c7ddf-+-Revert "mediawiki::scap: force creation of the symlink when enabled"

07ec83025d-+-zuul: disable monitoring for disabled merger service

d46186bfbe-+-simplelamp2: change default mariadb datadir to /var/lib/mysql/

f16434758c-+-mediawiki::scap: force creation of the symlink when enabled

5375f5026b-+-mediawiki::scap: Ensure Exec['fetch_mediawiki'] resource always exists

94f896ea37-+-mariadb: Add db1220 to x1

5c282aea45-+-Revert "Add new db nodes to site.pp"

cf009a1f3f-+-mariadb: db1207 remove from insetup

1f1242ef3e-+-mariadb: Productionize db1207

a385eb128b-+-P:toolforge::k8s::etcd: load list of control nodes from PuppetDB

3ef4d4573e-+-squid: Add support for hourly log rotation

c3eada805a-+-Also add component/pybal for pybaltest hosts

71acf36b02-+-mediabackups: Add static console port for easier remote management

5b4f9a8c47-+-P:wmcs::kubeadm: checker is a toolforge-specific feature

38ccc36193-+-mariadb: Decommission db1104

13c8bfe226-+-gitlab: Fix listen_https typo

acb6fd46b3-+-Revert "scap: block Scap execution on inactive deployment hosts"

0a5edcbbb7-+-scap: block Scap execution on inactive deployment hosts

dc732728bc-+-miscweb/site: remove miscweb2002 from site

e6eb2e9791-+-logstash: restore logstash index patch level

7252c5eed9-+-Pass enforce_policy_scope and enforce_new_policy_defaults to cinder-backup

542a790cc7-+-gitlab: Disable listening on port 80

f62357d3e3-+-spicerack: add the transferpy package

c3e59aac1a-+-squid: add compress

e8927122bd-+-squid: update squid to use logrotate::rule

0ed61595d7-+-squid: add docs and small refactor

1d8a7e84f9-+-logrotate: add support for hourly

31f011a677-+-OpenStack: adopt new scoped tokens and policy rules in codfw1dev

4e90a9f43c-+-Revert "Stop Hadoop Yarn queues to ease network maintenance"

8babb13e3d-+-O:aphlict: update to use profile::logrotate to configure hourly

313a1d7497-+-logrotate: add logrotate profile

220bb9c6c9-+-Stop Hadoop Yarn queues to ease network maintenance

ded360bbf3-+-P:toolforge::prometheus: add probe for coredns pods

e24c1d4256-+-logrotate: add coumentations and fix up spec tests

909df1f377-+-maintain_dbusers: update config with host+port

f1f622a0be-+-labstore1004: park in an 'insetup' role until we're ready to decom

baee59810c-+-etherpad: remove process monitoring

073ead120e-+-alertmanager: switch data.retention unit to hours

1507b83002-+-alertmanager: manage data.retention option

08ae844779-+-profile::wmcs::nfsclient: move toolforge nodes to the new NFS server

df6bfe745c-+-noc: Fix alertmanager severity

91a8f1724b-+-toolforge: fix included profile class path

6056d6b7bd-+-toolforge: add k8s bastion with toolforge config

46e0939098-+-profile::hue: restart envoy only when CAS is enabled

e4aebe3c2c-+-profile: let check_dpkg write prometheus stats

aed770ab89-+-cloudlb: introduce BGP setup by means of bird

54bbdbb6bf-+-microsites: add monitor for os-reports.wikimedia.org

880a1f110f-+-microsites: add monitor for https://15.wikipedia.org

efee74985e-+-prometheus: Add the prometheus Bullseye node definitions

aa53d6b3bd-+-Revert "wmcs backups: stop nfs backups, add a second cinder-backup node"

f8137b6db4-+-wmcs backups: stop nfs backups, add a second cinder-backup node

3da7a339f5-+-prometheus: Add the prometheus3002 node definition

48457011f0-+-Fix typo on role for thanos-fe1004

a227d022aa-+-update thanos-fe1004 entry in site.pp

69d2dc9688-+-cloudceph: add the location info to the hosts

f8bd97b6ad-+-systemd::unmask: change the default of refreshonly

a6401f17b9-+-Revert "P:url_downloader send Squid access logs to Logstash"

539fbf71e3-+-mariadb: Promote db1164 to m1 master

48a900e66b-+-purged: Don't specify the kafka compression codec

e23b8f4f5c-+-database-backups: Provision db1150 with s4 and s3 sections

d76a17de28-+-k8s rsyslog: Use client cert instead of token

bb567b710e-+-vrts: replace Icinga with Prometheus for SMTP monitoring

5be63871dd-+-miscweb: move simplestatic.erb out of role/templates/apache/sites/

38a7ddc237-+-noc: replace Icinga with Prometheus monitoring

5881f85685-+-updating site.pp and netboot with new gerrit1003

177d8ab056-+-Add new db nodes to site.pp

d0c358d96a-+-logstash: remove eventgate response_body field

798a7235aa-+-phabricator: replace Icinga with Prometheus for SMTP monitoring

f8371ce540-+-P:puppet::agent: allow to add a seed to the time the agent runs

730898ce2a-+-harbor: use external url for the proxies

6721b7137b-+-thumbor: Switch all summaries to histograms

09d8728556-+-pybal: don't install python3-requests on bullseye hosts

e9464d3d3f-+-superset: fix typo in file path

23bd9a5610-+-superset: add static html for requestctl

0dae9a9be7-+-trafficserver: make routing to mw on k8s more manageable

73af182a52-+-profile: remove hardcoded statsd.eqiad.wmnet

5e7168c8c2-+-microsites: do not expect 301 for commons-query.wikimedia.org

bdefddde33-+-microsites: commons-query.wm.org only works on port 80/http

8581714e46-+-microsites: for transparency.wikimedia.org expect HTTP 302, not 301

709d3812ef-+-microsites: do not use TLS when monitoring commons-query.wikimedia.org

78376cec42-+-ci::master: add parameter to enable/disable monitoring of jenkins/httpd

24b1c24040-+-site: remove superfluous insetup role for contint2002

a111beb528-+-site: add contint2002 to ci::master role

23d6e79543-+-microsites: add monitoring for security.wikimedia.org

e94211af79-+-microsites: add monitoring for WDQS and CDQS UI sites

aa9c95c668-+-microsites: add monitor for transparency/transparency-archive site

7e6bbae0a4-+-microsites: add monitor for sitemaps.wikimedia.org

e47ede5b16-+-pybal: install prometheus-client from component

dbe89b6623-+-P:lvs: do not enable legacy vlan names for bullseye

b4d439160c-+-maintain_dbusers: Remove unused param and adapt to best practices

898bfe319c-+-maintain_dbusers: move out of nfs to services

ad02d61fa3-+-pybal: add conditional for Python{2,3} packages

6f47b2f204-+-pybal: install pybal from component in bullseye

946977733a-+-releases: rename new blackbox check for jenkins login page

362d543f92-+-profile: remove edac alerts

b574df319a-+-icinga: remove widespread puppet agent alerts

76e9a554d3-+-Add aphlict role to new vm host

fa6ac158f7-+-k8s: Remove deprecated topology annotaions

8c244569ef-+-netbox: add git safe.directory to netbox's src

2700c08d66-+-aphlict: force unmask of logrotate service with refreshonly false

cc74cd65f4-+-Revert "statsd: move writes to graphite2004"

2eb7d44e03-+-Revert "graphite: check graphite2004"

4df4fd669d-+-C:idm::jobs ensure correct settings are used.

8a9136f71f-+-k8s FERM: allow gateway and infra ranges by default

b127bf3a3b-+-aphlict: pass ensure flags to logrotate timer

8d7467fa4b-+-k8s: Remove 1.16 related code (v2)

280c401a2d-+-C:idm::jobs absent permission sync.

b2a01de2d1-+-P:url_downloader send Squid access logs to Logstash

04c1eb7e54-+-releases-jenkins: replace Icinga with Prometheus monitoring

f4d22e5f9c-+-Remove Eventlogging prometheus-based Icinga checks

0a507dade2-+-deployment_server: ensure Docker is installed

698f797212-+-P:ldap::bitu: Also add the group dn

ce2cbc93b3-+-P:ldap::bitu: make the group configurable

239915883a-+-O:cluster::management: add ldap::bitu profile to cluster::management

8a0191791a-+-Revert "Disable job submission to YARN queues to faciliatate maintenance"

2e935e963b-+-cpufrequtils: fix systemctl call

b7f67cb752-+-cpufrequtils: ensure that cpufrequtils is reloded on governor change

69994056e0-+-Disable job submission to YARN queues to faciliatate maintenance

d680740bd6-+-Adds php and apache logs for doc machines

405034b273-+-Revert "k8s: Remove 1.16 related code"

7e1a87e02d-+-k8s: Remove 1.16 related code

a9eac038be-+-Deprecate oozie services on bullseye

fde58bce13-+-P:docker::prune_old_images: Fix type

2095fb8174-+-P:kubernetes::node: Use performance governor

e5b2152e91-+-statsd: move writes to graphite2004

466dcde838-+-graphite: check graphite2004

2d9e7aa47f-+-k8s: Use storage-driver instead of storage_driver

03c5da5710-+-etherpad: replace Icinga with Prometheus monitoring

fd10e1d678-+-releases: remove Icinga monitoring

ab6a3b58aa-+-peopleweb: replace Icinga with Prometheus monitoring

fb0b73e29f-+-doc: Reserve UID/GID for the doc-uploader system user

2efce2b734-+-Assign insetup role to new aphlict vm

c167150476-+-Remove puppet references to cloudvirt1017, 1021, and 1022

8ad5d5f006-+-zuul: fix up service enable and ensure

a55d2196eb-+-Revert "deployment_server: ensure Docker is installed"

304197943e-+-deployment_server: ensure Docker is installed

dd705a9dca-+-Revert "idm: remove auto restart for apache-htcacheclean"

54487ba44a-+-idm: remove auto restart for apache-htcacheclean

8cd247386a-+-Revert "Mark cloudvirt1017, 1021 and 1022 as spare systems."

bca335472c-+-Mark cloudvirt1017, 1021 and 1022 as spare systems.

10c80703aa-+-dumps: properly absent enterprise timers

58a12c3baf-+-k8s: Force docker storage-driver to overlay2

50ef9e0c88-+-k8s: Make profile::kubernetes::pki::intermediate mandatory

5906da7b80-+-k8s: Force to be explicit about k8s and calico versions

910dd9d2e5-+-Add setting to make /srv/mediawiki -> /srv/mediawiki-staging on deploy servers

17becba4a4-+-Remove l10nupdate support

50b4176b08-+-Allow E_DEPRECATED logs to be shown on php-fpm in doc machines

8475a103cc-+-mediawiki::tlsproxy::yaml_defs: add error page to envoy

7e8c950fb7-+-mediawiki::errorpage: rationalize usage

0f9ca98731-+-mariadb: Promote db1101 to m1 master

2ae3079a87-+-mariadb: Move db1179 to x1

9637dc1289-+-doc: Add role::doc to doc2002

010574c9fd-+-Revert "maintenance: temp allow rsyncing home dir to miscweb"

6725e9a525-+-miscweb/static_rt: replace Icinga with Prometheus monitoring

34fd1fe9b3-+-mtail: Update defaults for bookworm

11feac29ed-+-apache2: Use systemd provider

a912422d5c-+-ceph::firewall: osd_cluster_addrs is not define

75f93c5fdc-+-bookworm: Update spamassassin daemon name

0b149753f8-+-bookworm: use default mtail pkg

d694b989c4-+-Disable the package installed systemd timer for logrotate

e2d283a780-+-P:contact: Add cluseter to role_owner metric

1f3bad876d-+-systemd: minor refactor

73c0886890-+-Cassandra: Install python-is-python2 on Bullseye

0819881a3c-+-profile::tlsproxy::envoy: fix margins in errorpage

e21562c540-+-Add new PDU's in row E-F[5-8]

691626b628-+-doc: Add the doc2002 node definition

4ab2be6843-+-doc: Add role::doc to doc1003

6867ad7b36-+-lists: Change role of lists1003

53fbe9b978-+-miscweb/static_codreview: fix string expected by http blackbox monitor

630894e4d0-+-miscweb: wikiworkshop, change monitor to check redirect target

794de78ff3-+-rt: Remove some old migration cruft

af4be35919-+-miscweb: add monitor for research.wikimedia.org

2194312953-+-miscweb: add monitor for wikiworkshop.org

acb2dc81f1-+-miscweb/static-codereview: add prometheus monitor, remove icinga monitor

166a7910c4-+-Remove Icinga prometheus check for irc-echo messages

fd13f8fc40-+-Add irc1002 to site.pp

3b58400f4b-+-Fix NRPE check when running under Python 3

554e7dff9d-+-Fix typo in systemctl command

fb44bbe0c5-+-Assign mw_rc_irc role to irc2002

a9493caa0d-+-Add irc2002

9936c0920d-+-prometheus: Track systemd service restarts on >= bullseye

329a9013a9-+-Move udpmixircecho to Python 3 for Bullseye hosts

acc0292a7e-+-miscweb: move os_reports httpd template to profile/microsites/

8e0af31729-+-miscweb: move transparency httpd site templates out of role/apache

d8526bb6d5-+-doc: Add the doc1003 node definition

10c374ecc5-+-lists: new server to test bookworm functionality

7dc891ba1f-+-mediawiki::errorpage: allow avoiding percentage sizes.

7820d2f002-+-Revert "Add a dborch vm for testing the bullseye upgrade"

b298fc745f-+-envoyproxy::tls_terminator: allow returning an HTML error page

98a23384a2-+-P:monitoring: drop check for filesystem_avail_bigger_than_size

10b977565a-+-Enable OSPF check by default for l3 switch mgmt interfaces

5472711dc4-+-Revert "mariadb/ferm.pp: Add dborch1002 to the firewall rules"

c09ec0a86e-+-Revert "ferm.pp: Add dborch1002"

67ecfe1b13-+-maps: remove OSM Synchronisation Lag alerts

f0884a546d-+-prometheus::ipmi_exporter: update config to use inbuilt sudo option

a492215005-+-Provision the revised Swift dashboard

a9d3720f72-+-mariadb/ferm.pp: Add dborch1002 to the firewall rules

ae963c0e31-+-P:mail::mx: drop smtp_ldap_password

24acb2620d-+-ferm.pp: Add dborch1002

e9932cdbbb-+-Revert "ferm.pp: Add dborch1002 to the firewall rules"

2bc410135b-+-ferm.pp: Add dborch1002 to the firewall rules

119b7634d9-+-Allow hive on bullseye to install and use the correct packages

4dfd194b5c-+-Add a component/pybal and respective build hook

0123795a30-+-Make Python2 removal on Bullseye configurable

fe22964bc1-+-Add a dborch vm for testing the bullseye upgrade

2b32ca94ab-+-Add hadoop-test-client

af1f474e82-+-P:contact: Add fix for unowned roles

84e79b0344-+-ipmi: add configuration for ipmiseld

261fd8fa97-+-P:contacts: add role owner metric

641c0a0d8f-+-dbbackups: Setup db1145 as a backup source replacement for db1150

a347abfce9-+-ipmi-blackbox exporter fix

f94a9f12cc-+-ipmi_exporter: add managed config file

3ead0ba134-+-wmflib::argparse: allow specifying a different separator

f329b19ba2-+-maps: remove tilerator and cassandra

50f452e6e2-+-P:contacts: fixup lint

fd3fa90aae-+-dse-k8s: authorize pods to connect to pki.discovery.wmnet:8443

a25bff4095-+-profile::kafka::mirror: default to use pki migration settings

0dde3bfae7-+-prometheus: remove k8s cache not updating alert

ce49e6de5b-+-Omit anaconda-wmf packages from bullseye onwards

3abf152455-+-haproxy: Allow specifying maxconn per backend

de992e10bb-+-graphite::alerts: add alert on mediawiki account creation failures

b4ead1c26e-+-P:monitoring: add docs and fix liniting errors

8674e9f18b-+-profile::cache::purge: move purged to a new CA bundle

a47fdb78b4-+-Unprovision the "swift" dashboard

20961a61bb-+-scap.pp: Update comment about /etc/profile.d/mediawiki.sh

ced932dcab-+-Fix scap::dsh::group -> scap::dsh::groups (hiera) comments

4ce8757ca1-+-site: add miscweb role to miscweb2003

612337a137-+-miscweb: use http::mod_conf to add authnz_ldap module

e3a1a08767-+-miscweb: use php7.4 if on bullseye

0edb4527ef-+-miscweb: remove custom source line from httpd::mpm

a6e3051b63-+-miscweb: add httpd::mpm directory to httpd class

573fb9aa2f-+-site: add miscweb1003 to miscweb role

a35a276ab1-+-cuminunpriv: Remove old buster code

26a35ae25e-+-Remove dumpsdata1005 from the list of spare servers

748d7a0ccc-+-Omit Python 3.7 in the analytics cluster after bullseye

a1fe809300-+-kafka: broker replica lag alert moved to AM

219a7f553d-+-cuminunpriv: No need for component/spicerack on Bullseye

f99292e344-+-Fix override to pass full directory

f8313a15a9-+-Add systemd override to allow KDC to write to it's log file

ed46714bb3-+-benthos: notify service on env change

fbe9da500a-+-profile::mediawiki::deployment::server: Don't pass HELM_* vars to train presync

4fe8660132-+-Make krb2002 a KDC

09d560e14e-+-Make dumpsdata1005 the nfs primary for xmldumps and dumpsdata1003 a spare

8961b9fb81-+-docker::gc: update configuration to use latest version of images

4c5cf9e0f9-+-Revert "docker::gc: update configuration to use latest version of images"

141662bcdf-+-deployment_server: clean up older images using systemd timer

f50c75e6fd-+-docker::gc: update configuration to use latest version of images

c3d915533f-+-iegreview: body_regex_matches needs to be array, not string

144a93c3bc-+-iegreview: add http blackbox monitor

599ffff6b0-+-miscweb: adjust monitoring for annual.wikimedia.org to check /2017/

2685f8ae08-+-miscweb: add monitoring for bienvenida.wikimedia.org

dca5a3f2af-+-miscweb: add monitoring for annual.wikimedia.org

6ff17e214e-+-site: add miscweb1003/miscweb2003 with role insetup::serviceops_collab

e24550141e-+-harbor: don't use https, use web proxies instead

60819848a2-+-[tbs.harbor] Clean up admin pwd management

01732d984a-+-Adding ms-fe1013-4 and thanos-fe1004 to site.pp

5795d50e4c-+-Netbox: introduce support for validators

30f71554da-+-dnsrecursor: drop support for buster and pdns-recursor < 4.6

7b3e6603b3-+-netbox: fix minor lint issues and add test

bd9f9a193e-+-auditd: remove obsolete buster code

b6b53236d8-+-cloud_private_subnet: don't use CIDR for gateway parameter in static route

e29f99ba8e-+-cloud_private_subnet: add route to other similar subnets

133867c225-+-Assign mediawiki roles to mw2420-mw2451

12997c8787-+-mariadb: Decommission db1105

aa5cce4ec8-+-mariadb: Move db1106 to s1

7376dffcc1-+-Revert "mariadb: Promote db1106 to m5 master"

a07d4ddbcf-+-miscweb: limit http monitoring for design.wm.org to IPv4

9317ed4819-+-requesttracker: limit http monitoring to IPv4, for now

df96f2787f-+-miscweb: add monitoring for design.wikimedia.org

0d142cf447-+-openstack: basic bookworm classes

e1462c810d-+-auditd: update location of audisp syslog.conf

9bff1bfab9-+-profile::analytics::cluster::packages::statistics: improve go deployment

b68bc3cb80-+-[tbs.harbor] Fix wrong paths for Harbor certs

c2ff1b5c94-+-profile::analytics::cluster::packages::statistics: use golang-go

93852d44b1-+-profile::analytics::cluster::packages::statistics: fix golang install

6b65657966-+-profile::analytics::cluster::packages::statistics: add golang

44a1f179cc-+-maintain_dbusers: remove icinga alert, we'll use the default one

b157924db1-+-profile::kafka::broker::monitoring: remove under replicated icinga check

1081e08328-+-cloudlb: introduce cloud-private IP address

62c005cd4c-+-mariadb: Promote db1106 to m5 master

64e40814e1-+-thanos: exclude promql/rate pint check

6ab26d2377-+-thanos: add pint for thanos-rule

8bea415971-+-Update status_matches to be array, not int

c6737f39ef-+-wmcs: move maintaindbusers to cloudcontrols

115aec5de0-+-Fix the srange format for the ceph servers srange

24bc45192e-+-Fix an error with the ceph::server::firewall profile.

220327751b-+-pki2001: remove last refrences to pki2001

388e50a79b-+-site.pp: move pki2001 to insetup::infrastructure_foundations

853ef90789-+-pki: move to spare::system

5a492aea74-+-Configure the new ceph servers with mon and mgr daemons

73743d2cea-+-Modify maintain-dbusers.py to call the rest-api service

31380bbf28-+-cloudlb: give them proper role

1cc807ae4d-+-Add blackbox http check for rt.wikimedia.org

d501585541-+-calico/kubernetes: Replace calico cni and ctl tokens with client certs

1d3eb37cd2-+-calico/kubernetes: Replace istio_cni_token with client cert

de6ff4f6bf-+-releases-jenkins: don't force TLS when monitoring port 8080

8ede4f51f4-+-releases-jenkins: expect status code 401 or 403

f07119680a-+-Add dummy 'config_deploy_vars' for aphlict

0f3396390e-+-releases: limit monitoring of releases-jenkins to active server

eae9f72eb9-+-Move default kubernetes version to 1.23

992beed971-+-cfssl/cert: Allow to absent cert resources

e7155ce1ab-+-site.pp: fix style violations

7791d3c33a-+-P:rsyslog: manage /etc/logrotate.d/rsyslog

15cc81dab4-+-slapd: correct module loading

11b97792ca-+-mwdebug_deploy: remove configuration

0a8bb28099-+-mwdebug_deploy: clean up physical resources from target hosts

8855c7d934-+-hadoop:hdfs: fully remove FSImage nrpe check file age alert

8dc82c2719-+-mariadb: Move db1106 to m5

ca3626c0d8-+-pki::multirootca: Add PKI prefix to blackbox checks

6734437477-+-site.pp: ensure rule for pki does not match rpki

5a570ed4a7-+-hadoop::hdfs: remove nrpe check file age on FSImage

0d075eda9c-+-Apply url_downloader role to urldownloader2004

1c12bf417f-+-site.pp: Add dbproxy10[22-27] insetup

15641ccd74-+-releases: add monitor for releases-jenkins.wikimedia.org

1245a0ba72-+-Add cloudlb200[23] to site.pp and netboot.cfg

9441371abc-+-pki2002: move pki server to pki role

cfa2f1f6c2-+-Puppet additions for new network device cloudsw1-b1-codfw

5b0dc90d93-+-Add the aphlict config on aphlict2001.codfw

8d86b83093-+-ldap: move ldap lookup_options to common.yaml

f80626aa15-+-gitlab_runner: add optional docker registry proxy to runners

9d1c337d86-+-peopleweb: ensure each user automatically gets a public_html dir

bce35e3d96-+-dns::auth: deprecate role and update site.pp

ddf70e4a12-+-[toolsdb] Update config file but keep old one

924e1f106c-+-mariadb: Promote db1176 to m5 master

7cb4e7376f-+-slapd: Add support to configure MDB storage backend

181ae235bd-+-Add urldownloader100[34] to site.pp

e9abf81849-+-pki: use body_raw for check

97faa4166d-+-blackbox: allow sending raw bodies:

b26bc4fbd4-+-promethus: move expose ssl certs to prometheus::ops

7337d9177f-+-pki: Add blackbox tests for pki services

44beb9aa30-+-P:blackbox_exporter: update client auth checks to use local certs

2ecd74e83f-+-profile::calico::kubernetes: set new istio-cni defaults

e2825b0d44-+-Fix service name

5491d6d2a7-+-logstash: Stop apache2-htcacheclean.service via Puppet

dba52cec1f-+-vrts: copy data to passive host

4e99acc63a-+-acmechief: Ensure rsync is installed

d2b8c5822c-+-thumbor: temporarily disable Scap deployment

d0de126b09-+-kernel-purge: enable

ac6fa7618f-+-Fix service name in auto restart

adcac9d9a6-+-wmflib: Add post to http methods

9e9a9767f9-+-Install spark3 and conda-analytics on all analytics cluster airflow nodes

914004e2cf-+-profile::kubernetes::client: Switch to k8s 1.23

46225c46da-+-Add kubernetes102[3,4] to the wikikube-eqiad cluster 1/3

1e551aa20a-+-Add SPDX headers to additional DE profiles

a23572d6ba-+-mariadb: Move db1101 to m1

3fa97a0e36-+-hadoop: automate refresh of exclude nodes in NN and RM

8347d95705-+-mariadb: Decommission db2093

5e1dc641b8-+-hadoop: decrease log retention from 40d to 14d

b33978baf7-+-search-airflow: add analytics sql replica creds

2c8c679e08-+-Adding new cloudcephosd hosts to site.pp insetup::nofirm

cf7fd2060b-+-smart: override unit to make systemd wait longer

65f0ce3074-+-Disable all gobblin jobs to allow for HDFS maintenance

398ef677d0-+-libraryupgrader: Switch to systemd::sysuser

80ea44b00b-+-IDM: Enable profile::auto_restarts::service for apache2-htcacheclean

678fee2be9-+-arclamp: Enable profile::auto_restarts::service for apache2-htcacheclean

1e8fab21c7-+-Split out a new class for phabricator::config

c39db3ddf3-+-P:idm deployment no longer needs production variable.

d77feb4c72-+-P:IDM Minor fixes and restructure.

7d599530a1-+-Enable profile::auto_restarts::service for Apache/IDM

cb8865ce1a-+-nagios: remove obsolete command check_all_memcached.php

b07a09466a-+-mariadb: Move db1101 to m3

39d40b438b-+-mariadb: Remove db2095

5696ee4d46-+-Ship custom /etc/logrotate.d/rsyslog on KDC hosts

389e8a14e4-+-Purge unused kernels on boot

1d8a0a805a-+-harbor: Add robot accounts info

a6e5069fab-+-clouddumps: Enable profile::auto_restarts::service for rsyncd

8febac3791-+-toolforge: kubeadm: drop calico deployment

b4cd0b26f8-+-Revert "P:phabricator::aphlict: Set deploy_root as git safe.dir"

7e2edae1df-+-Revert "P:phabricator::aphlict: git safe.dir"

971df06c69-+-P:phabricator::aphlict: git safe.dir

a32ab2ede1-+-metricsinfra: don't use /cloud path prefix for prometheus

3aefb4f281-+-P:phabricator::aphlict: Set deploy_root as git safe.dir

c9e1988c83-+-P:releases:mediawiki: Fix /srv/patches ownership

dee8404839-+-mariadb: Decommission db2094

dacfe7acd5-+-Revert "releases: ensure rsync timers are removed when switching backends"

e3931ec5ff-+-releases: ensure rsync timers are removed when switching backends

be36f2a2aa-+-prometheus: update pdnsrec job for bullseye upgrade of dnsrec hosts

6216ee8791-+-Openstack codfw1dev: remove the local cinder code from cloudvirts

06f64b7888-+-harbor: move to epp template for the config file

3508953895-+-apt: update the motd so its not to big

3591d29783-+-kerberos: update the motd so its not to big

ae94431141-+-puppet: update log rotate to call /usr/lib/rsyslog/rsyslog-rotate

9b23df9c77-+-wdqs: decom wdqs200[1-3]

31291b2731-+-maintain_dbusers: seperate config from code changes

1fae636b7a-+-dbbackups: Add parallel as a dependency of mini_loader.sh

58c8e58fec-+-dbbackups: Moving the recovery working prototype/hack into production

5f00d8d7c7-+-profile: add pint source for analytics/ext/services

b45eb89636-+-lvs::realserver: Ensure we have at least one real ip address

d6d6e34cd8-+-toolsdb_replica_cnf: configure if we want to redirect to https

2f082f2188-+-toil: restart opensearch-dashboards every wednesday

d0145622d9-+-prometheus: add pint source for k8s

c4c5c7a595-+-klaxon: update to use systemd::job::timer

dca8785c55-+-systemd::timer::job: add more parameters

85e0956a74-+-klaxon: add docs

f43998c7b7-+-labstore1004: allow incoming HTTP connections from cloudcontrol servers

cf041c3a98-+-servie::docker: ensure we remove directories

9c45ad8f17-+-dispatch::web: fix documentation

184b440fe9-+-kubeadm: drop wmcs-k8s-secret-for-cert

5e04448101-+-Update airflow conf compatibility with airflow 2.5.0 connect postgresql

23dedc2893-+-aptrepo::rsync: refactor to fix issues

f23630f3b2-+-Add dumpsdata1006 and dumpsdata1007 as spare dumps hosts and rsync pullers

e3c139b572-+-phabricator config: add gitlab_api_key

67fe5c62a4-+-contint: regroup common firewalling rules

3d388363f0-+-profile: move phatality resources from module to profile

5f35818252-+-aptrepo: fix linting issues and docs

457d07ff33-+-prometheus: scrape pint

2aa6fed39e-+-P:toolforge::k8s::haproxy: drop standalone jobs ingress

452d227a4c-+-puppet::agent: Add external facts directory

df5ee82b99-+-P:toolforge: use api gateway for jobs cli

0a2040a6e2-+-P:acme_chief::cloud: support multiple passives

2aced160e7-+-mariadb: Move db1176 to m5

bd36c25aff-+-prometheus: add pint source to ops

0a08e4e670-+-prometheus: update pint listen port

7572dde834-+-prometheus: add pint support

d34229676d-+-acme_chief: support several passive hosts

aaeeed566f-+-prometheus: refactor blackbox configuration

23d7a91869-+-Install pbuilder hook for ICU67 component

d513c47ca8-+-site.pp: Remove db2187 as insetup

ff5cdba81a-+-mariadb: Productionize db2187

7db6d6a71e-+-make dumpsdata1004 the xmlfallback host, with dumpsdata1001 as xml spare

adf286d3a0-+-Switch deployment server to deploy2002.codfw.wmnet

380cc97dd3-+-check_private_data.pp: Let's make it daily

8f2a58850a-+-gitlab::rsync: ensure we remove old jobs when promoting a server to active

d2f8830f87-+-mariadb: Productionize db2185

f7f98335d3-+-P:toolforge::prometheus: deploy alert rules from GitLab

eda9c6a11f-+-P:toolforge::prometheus: add monitoring for cert-manager

7c52301c61-+-gitlab: enable restore for replicas, disable on active_host

05edb9a5ab-+-base:standard_packages: uses ensure => running, not started

f8e469eb13-+-standard_packages: also manage the rasdaemon  service

fd7b38b5ee-+-puppet_compiler: bump version

cae45e20cf-+-puppet: update firewall rules for cloudcontrol1005

f80bd7d447-+-mariadb: Productionize db2186

3311226c98-+-peopleweb: add bacula file set srv-org-wikimedia

23ead79bac-+-scap: add required Python3 venv package

5aa2a72afd-+-P:toolforge::k8s::haproxy: add api gateway load balancer

a87dc7dc44-+-P:toolforge::k8s::haproxy: remove support for hash node list

d0fcc05bbf-+-Add dumpsdata1004 and dumpsdata1005 as spare dumps hosts and rsync pullers

63af9a290e-+-Blacklist f2fs

f29615e435-+-realm.pp: Add private tables

0094664e1f-+-Ad new ms-fe and thanos-fe node to site.pp

44b518f9bb-+-mediawiki-cache-warmup: Rewrite in Python

01e7bdea78-+-P:toolforge::k8s::haproxy: allow simplifying the backend array

ed3b759dbe-+-prometheus: Explaining prometheus.io/port annotation

e8220c65dc-+-Revert "ci::firewall: allow http monitoring from prometheus hosts"

f038684d49-+-Add new wdqs node to site.pp and netboot.cfg

e71433bebb-+-Update dns for paws prometheus

1b0a7f5fac-+-cloud-vps: purge leaked VM images, daily

592e3d705a-+-growthexperiments: Run refreshPraiseworthyMentees daily

0a95f7c2e5-+-Deal with variant/custom mismatches in more places

3ad9e33193-+-nginx: Drop require for the nginx package

f668d10c19-+-Adjust monitoring for KDC processes if worker threads are in use

58bd82227e-+-Extend profile::nginx with support for new Nginx packaging layout

74f7f84a09-+-idm::jobs: Adapt auto restart to only run of idm-rq is active/present

0fe8f9a9d4-+-Deploy analytics-refinery to search airflow instance

977f13c334-+-site: differentiate between both serviceops teams for insetup roles

fc405b5882-+-prometheus: update ensure_packages for node_gdnsd (bullseye)

baa0836c84-+-sre:check_user: make namley_api_key optional

4f3945c817-+-P:sre::check_user: add support for namely API

9e5ee09744-+-Enable profile::auto_restarts::service for nginx on durum

e7c90ec6e6-+-apereo_cas: update to use dnsquery functions for lookups

0fce35a435-+-apereo_cas: Add missing docs and fix lint issues

2865b36883-+-wmflib::dns_lookup: switch to dnsquery::lookup

2f8d647348-+-dnsquery: Add dnsquery module to vendor_modules

f73f94b2cf-+-presto: remove - in the cluster name used in node.environment

6205f09f14-+-P:idm move OIDC endpoint to variable.

b73c8775e2-+-fix(presto): fix typo from node.enviroment to node.environment

810c5a8cb4-+-Fix condition for including haveged

eceb203962-+-ci: set port 1443 for https monitoring

3869cc01c6-+-ci::firewall: allow http monitoring from prometheus hosts

1658f89896-+-ci::firewall: allow monitoring hosts to check http on contint*

48ada88cc6-+-doc: fix hostname used in http::blackbox monitoring

a9307e05bf-+-profile: Re-enable grafana db sync post 9.x upgrade

19b9dcb826-+-Remove FLoC headers

e064697e06-+-[cloudceph.client.rbd_backy] Fix wrong reduce call

84c0184ae6-+-Add kubernetes202[3,4] to the wikikube-codfw cluster

10726a7ef9-+-C:idm::deployment Redis binding and ports

fdc119f32f-+-Set ferm access for redis

ce880232ea-+-C:idm::deployment missing comma in Ferm rule

daf62c636c-+-C:idm::deployment use Redis password

209c0e83a4-+-alerts: Allow customizing the git repository info

540d1808d6-+-node_pinger: use jumbo frames

23dc927046-+-gitlab: allow rsync between replicas

740d5e5bec-+-P:idm configure production IDM

a61306a9cc-+-gitlab: Remove net.core.somaxconn sysctl

e5b4cb308a-+-Don't create a second disk through lvm

fd9a9e0a07-+-Adapt KDC monitoring to dynamic KDC worker count

cf07889442-+-Tweak scalability of KDC requests (v2)

088cb79094-+-Revert "Tweak scalability of KDC requests"

689e6ce4b5-+-Tweak scalability of KDC requests

ae6b5b268f-+-P:ldap:bitu add missing aux ldap group.

40b7b29c14-+-cloud-vps vm backup: don't run purge job until backup job completes

e503195712-+-phorge: add parameter and value for the repo path

f756334f28-+-phorge: install php-apcu and python3-pygments

af8918f801-+-phorge: install php-zip and php-gd packages

a1c571d722-+-trafficserver: Remove restart count icinga alert

31e881640f-+-ADd db218[567] to site.pp

f3ba666438-+-Add new VMs

7669f8bb53-+-Update model for ps1-a8-codfw

f6cf23cbc5-+-kubernetes: Pass the cergen service-account key to controller-manager

0b87577fa7-+-gitlab: add restore script not all hosts

735cecab34-+-fix(presto): create pkcs12 server file with intermediate certificate

511e448018-+-kubernetes: Continue to use the cergen cert for service-account signing

756fe1dfa9-+-gitlab: merge gitlab-restore scripts

74fb1d561b-+-integration: add blackbox::check::http monitor

5572776c5b-+-P:planet: Fix prometheus blackbox check

6ec2db39dc-+-P:dns::recursor: set webserver port to 9199

639f9e60e0-+-dnsrecursor: enable webserver for bullseye installation of pdns-rec

3077ef2a58-+-configmaster: Add a switch to enable the nda subdirectory

111a69259a-+-P:spicerack: Add discovery/authdns.yaml config

4abddbca12-+-tlsproxy::localssl: fix cfssl usage

45b97c8b84-+-feat(kerberos): add feature to rely on tcp first to query kdc

15677ee6eb-+-puppet: improvements to replica_cnf_api functional tests

b0290536bd-+-jenkins: fix directory in sudo rule

2562228a1e-+-Add puppet role to new aphlict VM

2567dfcdf9-+-Do not install spark2 on bullseye or later

4f17104bd7-+-P:httpbb: Fix httpbb_kubernetes_hourly presence

b23cce244f-+-alertmanager: tweak default incident text/description

1d612076bf-+-icinga: Use check_ssl_http_letsencrypt for wmfusercontent.org

dfb1ae3003-+-P:httpb: Make PCC happy

fca8509a78-+-P:IDM Configure production VMs

0aa77dac50-+-doc: add blackbox::check::http monitor

69a2262dd0-+-ci: move lists of contint hosts to hieradata/common.yaml

f9bcde2699-+-P:dns::auth::update: remove trailing slash for git safe.directory

58de2779f7-+-P:dns::auth::update: add safe.directory for gdnsd bootstrapping

078f2773e9-+-P:dns::recursor: skip installation of prometheus-pdns-rec-exporter

f11e24a381-+-quickdatacopy: Add option to show progress during transfer

a941541872-+-centrallog: Show transfer progress when using quickdatacopy

37202e4f46-+-C:IDM Add timers and background workers.

02b7503258-+-gitlab_runner: Set pull_policy = ["always", "if-not-present"] on WMCS runners

18a341280a-+-Remove further files related to removed pybal health checks

b514737aaf-+-Kubernetes masters: include profile::kubernetes::client

19a13f7b41-+-Remove role::spare::system

64fc014cbd-+-bird: remove validate_cmd (possibly temporary; debugging reimaging)

5096cb3f28-+-Remove the ores::base class from the analytics cluster

5589017156-+-k8s::package: Ensure the apt component is registered first

3d12db2fae-+-rsync: remove rsync::server::wrap_with_stunnel

149b0d9e7b-+-profile::etcd::v3: add discovery SAN record on bullseye

a825bf3033-+-swift::ring_manager: Only enable auto restart on active ring manager nodes

1e2f1c0814-+-mediawiki: drop pybal-check user

1932143bdd-+-Add insetup puppet role for aphlict vm in codfw

14e206a747-+-Fix the bigtop::jdbc class on bullseye

215517aecd-+-swift::ring_manager: Enable profile::auto_restarts::service for rsyncd

2b33088a3b-+-Fix a compilation error in bigtop::mysql_jdbc

6c46251015-+-Try libmariadb-java with sqoop on bullseye

bf6bc478a0-+-Add binder to the kernel module block list

d132550bf3-+-Remove testvm6001

edbeace2c1-+-fix(presto): create intermediate ${data_dir}/var fodler

ad9a4fa72d-+-mariadb: Decommission db1099

8ef3a3ac6d-+-planet: add blackbox::check::http monitor

2eb76a7837-+-serviceops-collab: switch alert severity to 'task' globally

11b9f5b88d-+-Add new mw node to site.pp

84dc9e9221-+-dnsrecursor: update template to prepare for bullseye upgrade

249e3fdee0-+-Remove single contact feature

2610014ec0-+-postgresql::user: need to also include the escape in the final command

cb7144f40b-+-vrts: enable/disable daemon depending on active host

65957a27b9-+-postgresql::user: add trailing \'

83381194c5-+-P:puppetmaster::frontend: remove certificate NRPE check

3d6b572ebd-+-postgresql::user: Check some password is set for a user

d9158b8462-+-P:wmcs::services::toolsdb_replica_cnf: don't manage the directories

dd265df32f-+-wmcs vm backups: don't email when the backup service flaps

30971b8e47-+-bgpalerter: Pass through RPKI config

ae2fa8c709-+-netbox: add python_deploy::venv

00092a0bfd-+-Add safe.directory directives for the puppet master

3ce73282b3-+-kubeadm: provision .kube/config in root home directory

967489410c-+-puppetmaster: add prometheus metrics for cert expiration

a01a79150b-+-use lbzip2 instead of bzcat to decompress blocks in parallel

21323253f2-+-Remove Puppet references to install[12]003

cc71a5ca49-+-eventlogging: drop absented check_eventlogging_jobs file

77c52e7278-+-P:environment: roll out no proxy config to all hosts

66e380da69-+-opensearch: add aliases to dashboards vhost

6ceed0a98c-+-P:idm split IDM into staging and prod.

14fdbf786c-+-mariadb: Promote db1164 to m1 master

342ae17373-+-fix(presto): ensure log folder has appropriate right

a5b3212f62-+-Reapply puppetdb role

07820eff26-+-opensearch: reverse-proxy access to opensearch API

da3b9ae133-+-Peering News: add splay and change run time

74d00b20a4-+-feat(presto): add gc logs

ff24b3b2ad-+-phabricator: stop/disable/mask phd based on phabricator_server setting

681ba4ad3d-+-phabricator: pass through phd_service_enable parameter

d41769cfac-+-phabricator: add phd_service_enable parameter

b91383b868-+-phabricator: set phd_service_ensure to 'masked'

4e9e7620c7-+-cloud: openstack: add kolla-ansible evaluation recipe

1d8ae311fe-+-Remove previously absent timers from analytics data_purge

0b84d0d50f-+-Update analytics data purge for webrequest_actor

c0c78888e6-+-Reapply puppetdb role

fcb96fd76c-+-analytics::refinery::job::druid_load.pp: remove absented jobs

e10afda603-+-aptrepo: remove gitlab package for buster

1bdb618c07-+-configmaster: add a cpoy of the ferm requestctl definitions to nda

f5eb8d5124-+-Remove Puppet references for install[3456]001

19b8755093-+-mariadb: Decommission db1098

8e0dda74cd-+-Neutron: define db_name for the common database template

689af16ff6-+-OpenStack: Standardize and templatize database 'config' section

d020e06c2b-+-analytics::refinery::job::druid_load.pp: Absent 3 jobs to migrate

62eed6f545-+-Try running docker before the base firewall rules are added

c4e8afa600-+-statsd_proxy: add ipv6 relay

d989b05769-+-puppet: modify role::wmcs::nfs::primary for replica_cnf api

1ac7cfe304-+-puppet: adapt replica_cnf_api to python3.5

3167750f62-+-phabricator: create phd home directory on service start

14ca9ee030-+-Reset puppetdb1003/2003 to insetup

1b23cf4198-+-Adds 'before' directive to docker::network in gitlab runner setup

84ee6af891-+-Remove installserver role from install1003

1d32cbfd51-+-opensearch_dashboards: enforce memory limit

6fe037fba1-+-Enable profile::auto_restarts::service for Arclamp

4b07dc3828-+-mariadb: Move db1164 to m1

2f0da1a439-+-mariadb: Promote db1159 to m3 mater

952bd810d9-+-Backy2 backup jobs: don't email on failure

d4bbd1c32f-+-profile: disable grafana db sync ahead of 9.x upgrade

71fa91c694-+-Revert "contint: remove obsolete firewall rules from labs"

09311e629d-+-phorge: install php-mbstring, php-curl and php-mysql modules

3749427c99-+-phorge: move httpd setup to profile and don't call it apache

f80bebcc1d-+-cloudgw: introduce additional route for VIPs

93a59ba2a2-+-cloudgw: consolidate extra floating IP routes

389d5b433c-+-Revert "P:monitoring: Absent hardcoded statsd host entry"

9d323d5933-+-Assign installserver role to install1004

9442561995-+-Netbox: add support for central Redis

aa765e2fca-+-arclamp: Remove rsync::quickdatacopy

3e7ad400ee-+-mariadb: Decommission db1096

1309317f00-+-cinder::volume: include 'tgt' package on hosts

8467a53660-+-Add new mw node to site.pp

1a694b9767-+-phorge: separate install pathes for phorge and arcanist

d7e6dcbcdb-+-logstash: update ecs to 1.11.0-6

3bcc09fda0-+-Cinder-volume lvm: clarify backend type/name confusion

e85c91cd7c-+-phorge: add httpd Directory snippet, git clone arcanist

cd98d89fe0-+-cinder-volume: make lvm volume group configurable via hiera

b10c03fd5d-+-phorge: add minimal apache site, add class parameters for docroot et al

533948d672-+-Add cinder-volume nodes to cinder grant and fw rules.

04033c0ae2-+-phorge: list of apache modules needs to be an array

8ed93f3d12-+-Configure search platform airflow 2 instance

3d9ea1820a-+-Add a new role for cloudvirt nodes with a cinder/lvm client.

b5e0758d3f-+-phorge: create role/profile to install LAMP and git clone phorge

d66d14d6ab-+-openstack::cinder::volume: Pass $version down to the config module

5633fc5ade-+-Move cinder-volume into its own class and profile

0f6e710758-+-eventlogging: Remove obsoleted navtiming schemas

7eb77274da-+-replica_cnf_web: add functional tests

82db5469a9-+-wmcs: changes to api service to manage toolforge replica.my.cnf

d202144538-+-Split cinder-volume.conf out from cinder.conf

b5a1e705dc-+-postgresql::user: fix filter statement

0b5647e21e-+-Drop installserver role from install6001

e54dbeb8dd-+-Add testvm6001

52e792aa54-+-Remove Puppet references to theemin

47bf190fe0-+-postgres::user: add hostname support to postgres user define

c55137bae7-+-postgrers::user::hba: drop hba_label and use title instead

5f8a3f5336-+-Assign installserver role to install6002

6a7dfc5dc9-+-profile::statistics::explorer::ml: add opencl packages

ad058e1718-+-mariadb: Promote db1164 to m3 master

d66fd82ff3-+-Remove unused files for OpenStack version 'xena'

92edbbab7e-+-P:monitoring: Absent hardcoded statsd host entry

55c544c7d1-+-configmaster: Cleanup disc_desired_state

0c2811822d-+-postgresql::user: add documentation and fix minor lint errors

a05633c168-+-jenkins: enable Scap3 deployment for active releases instance

e1047aa3e6-+-configmaster: Remove disc_desired_state.py

a697efe12b-+-varnish: support differential privacy

0e972d2033-+-dbbackups: Add a way to disable mydumper runs and reschedule them

a9b01a4577-+-extdist: remove integration/composer.git

de30af6612-+-Revert "Request high-entropy Sec-CH-UA* client hints"

f7970f2998-+-icinga: remove mediawiki alerts

a7bee83181-+-Remove ferm rules for Pybal health checks

d4d7316e59-+-jenkins: hardcode proxy values in sudo rule

6506f4928c-+-configmaster: add conftool-state mediawiki.yaml file to config-master

4f340c0d22-+-jenkins: modify sudo rule to allow passing proxy configuration

265d9944fc-+-Remove installserver role from install5001

3bdb90845c-+-Revert "varnish: support differential privacy"

ee9a7d4184-+-varnish: support differential privacy

a99953e909-+-Assign installserver role to install5002

7c197b52cd-+-elasticsearch: service depends on tmpfile

164bdff0d8-+-elasticsearch: move to /run

49ae7a3493-+-Add bookworm to pbuilder setup

0108469191-+-profile::httpbb: fix liftwing paths

2513f1dda3-+-jenkins: use Scap3 deployment for releases instances

1c6af4bbe4-+-Remove installserver role from install4001

8a5d5a18a5-+-httpbb: add tests for liftwing (prod/staging)

87e8f1da8c-+-Setup install4002 as install server

46199b425d-+-Rotate aphlict logs either daily, or when they reach 1G

b1d90d3e54-+-varnish: Fix python3-nacl dependency order issue

f9df1711de-+-varnish: Generate a DP subkey daily

a8e7c5e31c-+-C:IDM parse static dir to deployment.

ea3dc400e7-+-P:IDM Configure OIDC and LDAP.

9df70a813d-+-Remove installserver role from install3001

9e868d94ce-+-opensearch: service depends on tmpfile

bc500d3da9-+-opensearch: move to /run/

18a3a61170-+-Apply installserver role to install3002

c3f44e6675-+-C:idm::deployment collect static files

735e678466-+-rsyslog: allow subject name validation

a59dc09931-+-dumps::web::fetches::kiwix: splay rsyncs so we don't overload the kiwix server

214808cc4f-+-Remove bast3005/bast5002 from Puppet

2972ba9154-+-Remove installserver role from install2003

21c9be0557-+-Add /var/log/mail.{log,info,err,warn} to rsyslog

a85a477998-+-P:wmcs::metricsinfra::grafana: configure data sources

8def5a997b-+-P:wmcs::metricsinfra: add haproxy config for grafana

f10e5fe45d-+-P:metricsinfra: add profile and role for a Grafana server

27d56f643e-+-Revert "elastic: add udp_json_logback_compat_profile"

c8fe7d0549-+-elastic: add udp_json_logback_compat_profile

b6b55c1f67-+-etherpad: use correct port number for blackbox monitoring

4b17cc7121-+-releases: fix IP family parameter name in blackbox http check

1bd6ada0b3-+-releases: add blackbox::check::http monitor

efb39f93ed-+-Define dse_kubepod_networks in network constants and in ferm defs

e1fdbc5991-+-apereo_cas: move merge strategy to lookup_options

7600839707-+-jenkins: remove redundant class parameter

2e4d4c3c80-+-Apply role::installserver to install2004

7a33c82bda-+-mariadb: Move db1164 to m3

09dcbd20e2-+-mariadb: Promote db1195 to m2 master

fe3fd8a1ac-+-etherpad: fix ip_family name, ip4 not ipv4

d4a7e3a858-+-etherpad: fix typo in blackbox::check class parameter name

e60de69d64-+-etherpad: add blackbox::check::http monitor

0b5108b4ca-+-role, profile: remove elasticsearch role and supporting profile

16b6862298-+-httpbb: Enable --retry_on_timeout so intermittent latency doesn't alert

6c51a8f5ed-+-Rabbitmq: use OpenStack bpo packages for rabbit

1fe8a2632f-+-Remove service toggle for TFTP

47b1bc8b34-+-Send vrts httpd logs to rsyslog

67b50e3b15-+-Revert "mediawiki: Add auto_prepend_file to PHP config_cli"

4eb65881d2-+-Remove bast3004/bast6001

dbc5c2854a-+-P:toolforge::grid: install python3-mwparserfromhell

bb4d645af9-+-mediawiki: Add auto_prepend_file to PHP config_cli

25353d9775-+-kubernetes: Increase inotify limits

19f96e92f5-+-Remove bast4003

dd3c23a270-+-mariadb: Centralize and change wikiadmin user grants

c4f3e2380f-+-P:wmcs::services: simplify toolsdb pinning

e383981aa4-+-bacula: Increase the maximum number of volumes on es-rw backups to 250

a811ec10ea-+-site.pp: Move db1195 to m2

45b5ae8b89-+-Enable profile::auto_restarts::service for etherpad-lite

a014081931-+-phabricator: ensure phd uid/gid can not be changed

619999a911-+-cassandra-dev: install siege for testing

feb0db9db1-+-P:wmcs::services: adjust toolsdb pinning

aac1e073c7-+-cassandra-dev: install docker.io package for local testing

348f9ddbfd-+-Remove puppet refs to clouddb2001-dev

66e4cd367a-+-gerrit: listen on all ports, DROP requests to host

9b84d3deb8-+-Remove role::openldap_corp and related profiles/templates

4ba0bcafd1-+-Remove Puppet references for ldap-corp1001/2001

8e8da287a9-+-Disable old bastions

4e9bb6408f-+-D:apereo_cas::service: Missing s on groups

1cd4d1e3b4-+-gitlab_runner: add separate ensure for docker::network

c977c32140-+-cloud-vps pdns recursor: drastically shorten max_negative_ttl

e43da9417b-+-Move clouddb2001-dev to spare

196a711dcd-+-valid_section: update a comment reflect that labtestwiki has moved

a3fbb5e67a-+-wikidough: add some colour to HAL

7fd0f7eeee-+-cloudgw2001-dev: rename server to cloudlb2001-dev

00ae8baf8d-+-confd: ensure python package

6f9ee921ca-+-firewall: Add requestctl support to ferm globaly

57c31e5db0-+-P:firewall: use fully qualified confd prefix

d164d393c8-+-confd::file: allow to specify fully qualified prefix

89e3c74ef5-+-maps: Bootstrap tile storage based on prod objects

3ada1a5a8d-+-Revert "firewall: Add requestctl support to ferm globaly"

a8e9ba71bb-+-firewall: Add requestctl support to ferm globaly

d15809f018-+-Enable profile::auto_restarts::service for bgpalerter

b314dbe06c-+-Revert "firewall: Add requestctl support to ferm globaly"

203eed6b43-+-firewall: Add requestctl support to ferm globaly

2372cfbddd-+-C:apereo_cas fix missing hash

a257a0fd0e-+-D:apereo_cas::service: Map memberOf to OIDC

df3f6c7bc8-+-gerrit: make Apache wait for network-online.target

fb4d7414cb-+-puppet: Add SPDX headers

d565ab2811-+-Revert "firewall: Add requestctl support to ferm globaly"

c397ccbde0-+-firewall: Add requestctl support to ferm globaly

24f4fd1410-+-flowspec1001: remove everything

a801368068-+-Add new hosts to site.pp

55e9d91e02-+-Rename ceph profiles to cloudceph

2d4a821a2e-+-dbbackups: Optimize execution time and delay backups

baa51c624e-+-Rename installserver role

52bd03b240-+-fix nova-metadata firewall rules

e49090882a-+-mariadb: Promote db1176 to m1 master

a07384921b-+-centrallog: Sync centrallog1001 to centrallog1002

f098573854-+-centrallog: apply role::syslog::centralserver on centrallog instances

ff018761cb-+-mariadb: remove grants and settings for racktables db

10bdf8ce82-+-motd: use colored message

7224001859-+-motd: allow coloured messages and use red for sre-sandbox

2a9d07df46-+-motd: add parameter to pass through messages to motd

f1c01db3fa-+-openstack: nova: metadata: allow haproxy backend connections

13869467b3-+-Stop using profile::contact

365aa7667b-+-openstack::haproxy::site: don't provision backend FW rules

dbbc21400c-+-puppetdb: No longer use the component on booworm

1111f68b12-+-mariadb: Promote db1196 to sanitarium master in s1

04e4c1aa76-+-Enable profile::auto_restarts::service for nfs.mountd

eb2cc42e33-+-Enable profile::auto_restarts::service for blkmapd

e594987be3-+-Enable profile::auto_restarts::service for nfs-idmapd

a1738268d6-+-Enable profile::auto_restarts::service for rpcbind

6783360461-+-logstash: enable ecs 1.11.0-5 in production

5b6a6e0e33-+-Include python3-tenacity in openstack client packages

f6a6c29626-+-mwopenstackclients3: Add a bunch of retrying

776ee06140-+-logstash: deploy ecs 1.11.0-5 and enable in beta

1a6d2c2f3b-+-racktables: delete profile and entire module

e11706cd74-+-Revert "jenkins: add remaining config for Scap3 deployment"

10b34a50d5-+-jenkins: add remaining config for Scap3 deployment

dd7c17bbca-+-profile::base: fix hiera key name for tls_client_auth

c040459b7a-+-postgres: set the postgress method based on the pgversion

e186f1086e-+-puppet: install puppet-module-puppetlabs-augeas-core on puppet >= 6

c633d348a2-+-Migrate service definitions to CasRegisteredService

2b95febf1e-+-puppetdb: add auth.conf file

39b9840ba5-+-postgres: use = to check password instead of distinct from

9c34bf93b4-+-postgress: update password check to use grep 1

db82f6c4ff-+-Remove old ping hosts

50826ecb72-+-D:apereo_cas::service Allow OIDC to define release policies

5e9a89d1f4-+-P:ssh::server: fix stretch compat

2c798376f1-+-thumbor: add and use haproxy healthz lvs check

873a62c41c-+-site.pp: Add db1206 as sanitarium master

d1ee21b763-+-site.pp: Add db1106 to s1

19ac3c7a4b-+-mariadb: Move db1176 to m1

beb96cf621-+-gitlab: exclude shell scripts and other backups from rsync jobs

a1b5b152cf-+-role: remove kibana7_ecs role

446610a053-+-miscweb: remove racktables profile from miscweb role

64b329198d-+-rspamd: vendor github.com/oxc/puppet-rspamd

17487fc038-+-idp: remove config for racktables

00baa13657-+-tlsproxy: Remove nginx_tune_for_media

3ef6bf1e2e-+-wdqs: mount NFS to new hosts

3e4b105863-+-ldap: move ssh-key-ldap-lookup directly to ssh module

6c6ec10ea1-+-gitlab: stop using "latest" backup name

39a0eab213-+-acme-chief: Restrict challenge type to valid ones

6387925d89-+-Remove openldap_corp role from ldap-corp*

4697af1a1a-+-role, profile: remove logstash(7) role and hiera config

f34e81b458-+-new servers druid10[09-11] adding basic install info

8873ef508a-+-trafficserver/cache::text: remove racktables

3450bd8980-+-tlsproxy:ssl: Remove ssl_ecdhe_curve

8288354b7e-+-tlsproxy: Remove ssl_dyn_rec support

c273cb60e3-+-openstack: neutron: keepalived_state_change.py to avoid debug log flood

183b5dbb4f-+-site: assign logging::opensearch::data role to logstash103[67]

50925df63f-+-prometheus::wmcs_scripts: deleted unused class

63bc461769-+-P:prometheus::beta: swap prometheus-labs-targets with a puppetdb query

a1d5a4f601-+-P:gitlab::runner: Enforce Wmflib::POSIX::Variables type for environment

b24cea0321-+-Gitlab runners: Use gckeepstorage buildkitd setting to manage storage

f751e739a0-+-memcached: Add SPDX headers

ed985e27ee-+-kafka-logging: add kafka-logging200[45] to codfw cluster

05aa5b7bb5-+-site.pp: update LVS hosts in ulsfo

2b54b9ffdb-+-P:wmcs::kubeadm::control: monitor cert expiration

eda92631d4-+-Decom webperf[12]004

7072ac96e8-+-site: apply webperf::profiling_tools to arclamp2001

fabbdc0c45-+-site: remove insetup::observability role from logstash203[67]

e7e4ea7479-+-profile: clean up legacy apifeatureusage class

59e869968b-+-deployment_server: Migrate tools/release to gitlab

dd3678ae20-+-gerrit: split user and application directories

5e5a3a2b06-+-gerrit: remove Gerrit:AuthType Puppet type

3cd3771019-+-gerrit: remove maintenance mode parameter

ecb89f7b78-+-site: add vrts role to vrts2001

bc95585844-+-vrts: add vrts2001 hieradata and database port

230ba91e14-+-peopleweb: ensure rsync service is stopped on passive host

b0a22331b5-+-webperf: update rsync source/dest with the new reality

c1629841eb-+-Add a systemd timer to clean up old data related to image_suggestions

0f3506037e-+-Horizon: replace puppetized maintenance mode flag with file check

c6ba6a363e-+-logstash: Fix typo in mediawiki.httpd.accesslog

f6f5a79e03-+-site: apply webperf::profiling_tools to arclamp1001

cfeb458ede-+-bastions: Remove scap:dsh

907140d856-+-gerrit: remove /srv/gerrit/jvmlogs

171b5ac85a-+-dbbackups: Setup dbprov1004, dbprov2004 as empty dbprov

cd91ef824e-+-P:logstash::production: mediawiki-php-fpm-slowlog

7c1e28faf0-+-Add new bastions in esams/eqsin/drmrs

7153e3429b-+-Alerts: stop alerting on thumb number mismatch

99948b651c-+-systemd: send ::syslog output to remote destination

7de22b5034-+-arclamp: move to EnvironmentFile for generate/compress jobs

6f5e097cd0-+-webperf: use rsync::quickdatacopy for arclamp data

cfd70d73a2-+-Cleanup bastion role

222e83188a-+-Make bast4004 a bastion

d8b1425256-+-quarry: Add SPDX headers

ba2083cc3c-+-peopleweb: only have rsync auto_restart service on active server

9ad3d4fbdf-+-prometheus: Generate varnish params file

6e3e496462-+-prometheus: Properly set old script as absent

67867d314c-+-varnish: Revert export of Prometheus params

736a0e7ba9-+-Add new an-coord and an-mariadb to site.pp and netboot.cfg

c4ad44a48d-+-swift: make storage servers also conftool clients

057d5d3413-+-swift: add swift::rclone

3eb9827e2d-+-swift: disable swifrepl timer job

abaa7774c5-+-ssh::server: add validate_cmd to sshd_config

cba7ddeeec-+-ssh: update match_config data structure

c290528de6-+-C:idm::deployment Add TLS termination.

3d21b4d369-+-varnish: Template out thread pool settings

399e494178-+-icinga:Update legal check to link to wikitech and add legal contact

8f3ef7227f-+-ssh: add new match_config parameter

0bd46739ed-+-ipsec: remove ipsec role and the strongswan module

aca3aed1b9-+-environment: add no_proxy config directly to environment

3fd1071730-+-prometheus: recording rules for CPU benchmark.

7857399699-+-bgpalerter: remove bgpalerter service we get one from the deb package

371bd8ddd7-+-postgresql::user: No longer compare password hashes on Bookworm and later

ae1e82b7fc-+-Add untrusted/customer/parked prefixes to bgpalerter

6c14134170-+-Make sure cloud_cumin public key is evaluated

631eecb0e9-+-Add ping[123]003

d4f657bacb-+-icinga: Add BeautifulSoup4 python dependency for check_legal

31f623e820-+-swift: move accounts_keys to common hiera global_account_keys

3e28f2d720-+-Add bast5003

9fe9721571-+-Revert "P:memcached::memkeys: install memkeys only if on buster"

17982acc4a-+-package_builder::pbuilder_hook: Manage the hook directory with Puppet

4adf00c86d-+-librenms: assert data type for globally reserved UID

55d7520433-+-Remove all legacy_vip entries

4e2c58e000-+-bgpalerter: 1/2 a day to track down a missing 's' :@

bb3cefde98-+-P:openstack::galera: add missing @resolve

d503042952-+-statistics: assert new data type for globally reserved UIDs

bb5c1ad485-+-Replace 'yoga' with 'zed' in a zed manifest

2acff3773a-+-Trove: Patch a trove/dns bug.

f5e4ca0538-+-scap: assert data type for UIDs

163e76fa60-+-P:memcached::memkeys: install memkeys only if on buster

ba0a2fded6-+-bgpalerter: use wss/https for websocket connection

3e58bb7f73-+-Add bast3006/bast4004/bast6002 to Puppet

37ca65758c-+-memcached: minor fix for bullseye installation #2

b9f5dff3af-+-P:bgpalerter: make sure we create the sysuser before calling the class

2abe916857-+-O:rpkivalidator: add bgpalerter to rpki servers

f6893e6174-+-memcached: minor fix for bullseye installation

23624e7318-+-site: Remove retired mc* hosts

b4d9f2d46c-+-C:idm::deployment Add missing package

f86f294804-+-Add SPDX headers for various IF profiles

225da47e98-+-role:IDM assign IDM role to test VM.

7f02c6e210-+-cache::base: move wikimedia and wmcs domains to global level

bf036a05e4-+-Add SPDX headers to various base/IF profiles

084053d547-+-Limit the installed hooks for sid

50958e56d3-+-bgpalerter: move authorizationHeader to ris section

a0197bcd43-+-aux_k8s::worker: Include P::lvs::realserver

96ecd100f4-+-docker::baseimages: inject no_proxy config to rebuild job

795b80a9b3-+-bgpalerter: add profile

022afeb120-+-bgpalerter: add authorizationHeader and use yml vs yaml extension

e3e4396daa-+-package_builder: Also install the hooks for sid

c67c268624-+-cassandra: Remove support for stretch

3818174982-+-os-reports: Switch to systemd::sysuser

74e2f3a633-+-httpbb: add tests for phabricator, git, bugzilla

58b09d1431-+-phabricator: use specific data type for UIDs

29586a85fd-+-mariadb: Adjust new eqiad hosts

b5114638a7-+-admin: split system user data type into local and global

a3e796e13d-+-profile::openldap::client: Stop including ldap::client::utils

ab6663d7c5-+-mediawiki::mcrouter::yaml_defs: adapt to new values structure

85a755195a-+-Decom puppetdb-test2001

db284bafb0-+-Still support Stretch for Python LDAP includes

255d4ad9ee-+-httpd: add flag to wait for network-online.target

e8921be878-+-systemd: ensure we only create the override directory once

0cb1486e0b-+-Fix up package list after ldapsupportlib removal

1f1328faf4-+-varnish: Export runtime params for Prometheus

baf9ba1a21-+-errorpage: Send a comment on browsersec errors

e2690b3333-+-phabricator: have vcs system user in group vcs and phd

7ce517e8de-+-phabricator: use systemd::sysuser to create vcs user

1a4638df20-+-Correct the description for insetup::data_engineering

c17117dcd8-+-maps: remove redis

56e55745b8-+-P:mediawiki::mcrouter_wancache: add gutter pools for /*/mw-wan keys

1cacd70f0d-+-redis: Add SPDX headers

47ec27e282-+-P:spicerack: add python-gitlab package

47f152f4f7-+-standard_packages: Remove multiarch-support on bullseye hosts

9b6632dae1-+-idm-test: Add Ganeti VM for IDM test/demo deployment.

c888ab6e98-+-C:ldap::client::utils remove ldapsupportlib

df224604f2-+-docker::gc: fix syntax for volume-filter

3221b39a57-+-Make gitlab-runner cache volumes eligible for docker-gc

ef6b9b3fa2-+-admin: add data types to validate UIDs

8a7649360c-+-bgpalerter: update binary path

c245e7c2d5-+-bgpalerter: manage installing package

74cf3f88ec-+-Trove: remove a hack that's no longer needed

5a0134fbad-+-OpenStack nova: install genisoimage

dbfe168208-+-Remove since-deleted dstat plugin dir

88888bac76-+-phabricator::vcs: comment out warning about empty listen address

178d5c7023-+-phabricator: remove vcs_addresses parameter and warnings

a4f3edc567-+-peopleweb: Enable profile::auto_restarts::service for rsync

4db9659480-+-people: Enable profile::auto_restarts::service for Envoy

490a6f77b2-+-Turnilo: Enable profile::auto_restarts::service for Envoy

10d90d5442-+-P:cache::envoy: drop profile as its no longer used

84a5c9f9fb-+-O:installserver::light: Update ACL to be based on roles

e2462940a4-+-IDP: Enable profile::auto_restarts::service for Envoy

3fe8ecf43c-+-postgresql::user: Add support for bookworm

9d304b5028-+-P:mediawiki::mcrouter_wancache minor refactoring

8d6985936c-+-Enable profile::auto_restarts::service for Prometheus Redis exporters

6df4042e23-+-Puppet: Remove nutcracker and multi-dc redis

c9216e8d95-+-mariadb: Productionize db1176 into s1

1a11bba8f1-+-phabricator: solve dependency cycle for sysyser phd

42e4358f6c-+-phabricator: dedupe phd user creation

d393c6bb49-+-train-presync: Pass -Dfull_image_build:True to scap stage-train

ae2c34dac1-+-phabricator: update pattern to support old tickets like T1

5434879463-+-webperf/site: Enable profile::auto_restarts::service for Envoy

0e31c37d70-+-openstack: horizon: use the enc api to update git data

d80b6e910c-+-openstack: designate: use the enc api to update git data

83fab228ec-+-systemd: only create the override directory once

438d196d42-+-Enable profile::auto_restarts::service for graphite/Envoy

9f21731c77-+-phabricator: Add type for task validation

7bb69256eb-+-Drop old wikilabels database roles

e8596ba4a7-+-peering_news: fix typo and add spec test

80e79c6ab9-+-mariadb: Productionize db2151

e4a9db8830-+-Update the role used for the cephosd servers

ae1b8e2da7-+-monitoring: update monitoring files to dynamically discover config

e0a2d4e347-+-prometheus: bump scrape timeout for webperf

a263f3ba20-+-Peering news: minor improvments and bug fixes

d2040d0c64-+-Mask uwsgi on puppetdb hosts

953cf08069-+-Add Peering News to Puppet

b11becda77-+-Only add auto restart for rsync for the primary releases server

81f8b8e80a-+-Add manifest for OpenStack Barbican version 'Zed'

e6efc95d9c-+-Add manifest for OpenStack Magnum version 'zed'

95f1478383-+-Add manifest for Openstack Heat version 'zed'

906bd50aa9-+-Add manifest for OpenStack Trove version 'zed'

6c2796bc7c-+-Add manifests for OpenStack Neutron version 'zed'

df43484fe8-+-Add manifests for OpenStack Keystone version 'zed'

796814f679-+-Add manifest for OpenStack Glance version 'zed'

780ced1a04-+-Add manifests for OpenStack cinder version 'zed'

13a7cd2785-+-Add manifests for OpenStack nova version 'zed'

ffe5bfe5cd-+-Add manifest for openstack placement service version 'zed'

63e781afda-+-Add manifest for OpenStack designate version 'zed'

372bbb3b26-+-Add package manifests for OpenStack version 'zed'

ceced9373f-+-P:grafana: stop provisioning home dashboard

3e15677fc5-+-spicerack: drop the empty check

1ef2d13e66-+-openstack: encapi: perform git updates server-side

851b47521e-+-kafka_config: set a real string for default api_version

a9eca45c70-+-k8s: Add the ClusterIP of kubernetes.default.cluster.local to cert

649d60cdc1-+-netbox: Switch to systemd::sysuser

e9aa5d49d4-+-grafana: move dashboard config to a new define

d31e11b520-+-core_test.pp: Add wmf-mariadb110

4720019b0d-+-Enable profile::auto_restarts::service for kpropd

fc426054b5-+-P:grafana: make the logo file customizable

fd7d7f66f0-+-decom graphite1004

2bb2c99bf0-+-P:grafana: move some profile declarations to roles

b92269fe59-+-P:kubernetes::mediawiki_runner: Copy GeoIP data

dbe419d318-+-realm.pp: Add two new tables to private

326c0031a6-+-P:logstash::production: mediawiki-http-accesslog

a3c49a5fa3-+-P:openstack::codfw1dev::designate: fix copy-paste typo

50de2b2047-+-mariadb: Decommission db1176 & db2151 to spare; remove mediabackupstemp

77fc4283af-+-adding pdus for racks f[1-4]

15090ca6b4-+-imposm: Ship rsyslog/lograte rules and make it quiet

cee85036dc-+-Disable the presto server on the 10 new hosts

0e8ad5082b-+-os-reports: Add owner overrides

cf4c9f3c4a-+-Add vendored module bodgit/puppet-postfix

0621f8e207-+-Add a Puppetfile to track vendored modules

069aea064a-+-rsync: Fix a typo

b27f6a080a-+-cloudlb: haproxy: support 3 firewalling options

9aa1837d62-+-dbbackups: Set minimum database backup size to 10 000 bytes

a7627e1f04-+-C:ldap::client::utils absent ldapsupportlib

4250715710-+-Decommissioning restbase-dev cluster

814accf74b-+-apreo_cas: Bypass the approval prompt

972d82582d-+-aereo_cas: add addtional OIDC parameteres

920c281ccb-+-idp01: fix allowed_delage logic

0bd7849927-+-Add buster data to https://os-reports.wikimedia.org

0fc9eccb6b-+-idp: fix hiera data

7c31955331-+-P:idp::standalone: fix vhost name

039e126abb-+-idp01: disable mod_cas on django site

c2c9a4cfc0-+-hive: Add SPDX headers

e80e9adcb6-+-lists: Add SPDX headers

21401044c3-+-piwik: Enable profile::auto_restarts::service for Envoy

b608d70ffd-+-an-web: Enable profile::auto_restarts::service for Envoy

62e85a1c76-+-oozie: Add SPDX headers

a2580fa240-+-apereo_cas: Add OIDC service to cloud instance

f2adc88193-+-apereo_cas: add OidcRegisteredService service support

eac387ff38-+-apereo_cas::services: drop mfa-u2f support

d77677bed3-+-puppet_compiler: manage symlink to output dir

1880d6055e-+-vrts: Enable vrts profile::auto_restarts::service for Envoy

b875a5da9e-+-elasticsearch: Enable profile::auto_restarts::service for Prometheus exporter

aee1fa06aa-+-C:ldap::management Update add-ldap-groups

15cad4c46e-+-Make ganeti4007 a Ganeti node

5a4f9978a5-+-site.pp: Set db1207-db122 to spare

47ed5936f4-+-site.pp: Add new hosts

a53d449ad3-+-site: assign role logging::opensearch::data to logstash203[67]

a8cf4844fa-+-cloud cumin: fix authorized keys for cumin

911efc0a60-+-spicerack: refactor puppetization

46d167fa2b-+-metricsinfra: use epp templates

5c82608a43-+-cumin::cloud_master: configure openstack backend

07ce71a868-+-mirrors: Enable profile::auto_restarts::service for rsyncd

73a0e34408-+-P:metricsinfra: add thanos rule

19fc545703-+-wmflib: function to get the ips for all hosts in a specific resource

e250ce1a44-+-puppet_compiler: bump version

051b867d02-+-acmechief/ncredir: Add SPDX headers

4fa32600ff-+-vrts / doc / etherpad / planet: Add SPDX headers

f00625bfa3-+-nutcracker: Add SPDX headers

77296891e0-+-analytics::cluster: Add SPDX headers

2d734f842d-+-cumin::cloud_master: add openstack dependencies

bf3aa2c11f-+-nginx: let puppet pick the correct provider

107e3625ab-+-Fix missing script in HDFS usage dataset pipeline

763cfffee5-+-site.pp: Remove db1206 testing

5123c180b1-+-orchestrator: Add SPDX headers

202faaa044-+-Revert "vrts: add vrts2001 values and add database port in config"

0af7f96b62-+-vrts: add vrts2001 values and add database port in config

fff98c0649-+-openstack::nova: Add SPDX headers

ad518b4593-+-labs_bootstrapvz: Remove support for stretch

e58e8c605d-+-OpenStack: remove Wallaby config

8564758923-+-ganeti4007 insetup role

2ea8811b77-+-Etherpad: Enable profile::auto_restarts::service for Envoy

c8ea32bab2-+-cloudcumin: use the webproxy to connect to Cloud

5296e3f7d2-+-Puppetboard: Enable profile::auto_restarts::service for Envoy

f03482ee02-+-cloudlb: haproxy: specify acme-chief certificate

98aa183c89-+-cloudlb: haproxy: service: fix typo in srange specification

ce75ee7372-+-P:installserver::proxy: add ability to proxy ssh ports

e631087f99-+-cache::kafka: Add SPDX headers

ebe0c3f584-+-lvs: Add SPDX headers

e31734922d-+-openstack/codfw1dev: Add SPDX headers

33afff8910-+-cloudcumin: actually allow ssh from the masters

e4bba92167-+-cloudcumin: use the puppetdb microservice

208f55e214-+-cloudlb: introduce role skeleton

270223638c-+-base::cloud_production: introduce new profile

1af5bb9e70-+-C:idm::deployment fqdn -> service_fqdn

0f3b3b6c1b-+-C:idm::deployment add RQ and database settings.

8906dc0584-+-Remove ganeti5003 from Puppet

2b69107a9b-+-C:idm::deployment fix logging configuration

ab8f5465c6-+-puppetmaster: temp absent new puppet cleanup timers

bb60b66ac1-+-profile::openstack::base::nutcracker: merge in profile::mediawiki::nutcracker

289eef47ba-+-httpbb: Run hourly tests from the cumin hosts against mw-on-k8s

d797729c34-+-cloud-vps puppet: rework git config safe.dir definition

6d4fe685e5-+-cloud-vps puppet: allow multiple users to access our puppet git checkout

a02437f06e-+-wdqs: allow mounting clouddumps share from wdqs2009

458a57bc14-+-toolforge: add missing /etc/toolforge dir

e9216830b9-+-puppetmasters: cache cleanup

f0494f98a6-+-Revert "mediawiki: remove prometheus-nutcracker-exporter auto restart"

b0c6ad4d1d-+-wdqs: add nofail to NFS mount options

1479328641-+-Wmflib: add port range type validator

452014c240-+-mediawiki: remove prometheus-nutcracker-exporter auto restart

c5b856ef14-+-Make puppetdb[12]003 puppetdb nodes

c33ccd2563-+-Fix systemd syntax in hadoop-namenode-backup-fetchimage

300d59f8c5-+-Add initial support for webauthn

3125a3e54e-+-tools-webservice: create /etc/toolforge/webservice.yaml with puppet

8e8bbae4b8-+-rsyslog: use ensure_resource for package_from_component

44a9c44841-+-profile::spicerack: Stop writing Redis sessions data

220fdc2816-+-P:IDM Fix minor configuration issues.

a20a38fdc1-+-Redis sessions: Goodbye

428feb3925-+-mariadb: Setup new definitive databases for mediabackups & bacula

4d05483467-+-Don't install quickstack on Bookworm, revisit later

6a6d2354ad-+-Add wmcs::openstack::eqiad1::virt_ceph to new cloudvirts

ead227d7ee-+-cloudweb: putting nutcracker.pp back as cloudweb hosts were using it

8baac19356-+-mediawiki: Goodbye Nutcracker

719ce79061-+-cumin::cloud_master: introduce new profile

bc7153ed6b-+-Adding logstash1036-37 to site.pp and netboot cfg

eebde223d5-+-k8s: Keep deprecated failure-domain.beta.* labels around in 1.23

a5a182adb5-+-Backing up HDFS FSImage to HDFS on Monday morning

c3b71b8b5b-+-mwdebug_deploy: remove resources from deployment server

e8ab828aba-+-mariadb: innodb_change_buffering status

fa9711df22-+-Mount labstore to wcqs/wdqs instance for dumps reload

6723d90a23-+-Configure new cassandra-dev cluster

1813f0283f-+-rsyslog::receiver: fix cert_file when used with acme certs

dc8d4331da-+-site: remove contint1001 after decom

6d812bc11c-+-grafana: Explicitly set default theme to light

efece2506f-+-kubernetes: Use netbox data to populate topology labels

372f94cd39-+-k8s: Remove authz_mode hiera key

ee7fe6a6be-+-k8s: Add support for PKI with k8s >= 1.23

5c01237ee8-+-P:openldap::management Install and configure bitu-ldap

f330c977a9-+-Enable profile::auto_restarts::service for Apache on VRTS

29b7b049d3-+-Update the superset config to identify the cache types correctly

6c5ac3a3fc-+-Add two new cache configuration parameters for superset 1.5.2

79e2597553-+-ci/bacula: remove duplicate backup set

58e40beaeb-+-gerrit: script to report on git gc durations

c9fbd7f36b-+-P:gitlab::runner: Add environment variable for kokkuri

79b1e43cbc-+-aphlict: Enable profile::auto_restarts::service for envoyproxy

4e46a7cf43-+-miscweb: Enable profile::auto_restarts::service for Envoy

5b2165427b-+-profile::openstack::base::galera::node: add a missing ) in a ferm rule

0832ad1a26-+-remote syslog: allow hiera config of rsyslog TLS CA

a94ad7448b-+-rsyslog: allow specifying a hiera-defined certfile

5364981d4d-+-P:openstack::placement: add explicit firewall rules for haproxy_nodes

354a522843-+-P:openstack::galera: add explicit firewall rules for haproxy_nodes

4f3c74c7b8-+-systemd::timer: only validate intervals if the timer is present

85d6369057-+-P:openstack::nova: metadata: add explicit firewall rules for haproxy_nodes

c9a52383a7-+-P:openstack::neutron: add explicit firewall rules for haproxy_nodes

c2c7cbd769-+-P:openstack::magnum: add explicit firewall rules for haproxy_nodes

d52e6bad34-+-P:openstack::heat: add explicit firewall rules for haproxy_nodes

35fedfb3b9-+-P:openstack::barbican: add explicit firewall rules for haproxy_nodes

424fe7990b-+-P:openstack::radosgw: add explicit firewall rules for haproxy_nodes

a550949c0c-+-P:openstack::trove: add explicit firewall rules for haproxy_nodes

cf8b0ce180-+-P:openstack::cinder: add explicit firewall rules for haproxy_nodes

c88a8ae48d-+-P:openstack::glance: add explicit firewall rules for haproxy_nodes

35930aeb39-+-P:openstack::keystone: add explicit firewall rules for haproxy_nodes

bf80f08680-+-P:openstack::designate: update firewall rules for haproxy_nodes

7a29e6f883-+-rsyslog: add support for openssl netstream driver

0d41ff2b98-+-C:ldap::management remove python3-bitu-ldap.

37d3b63cfb-+-deployment servers: Enable profile::auto_restarts::service for Envoy

c9e8ba2a97-+-pki: Allow to override the default expiry per intermediate

781f388c94-+-kubeadm: Declare /etc/kubernetes directory resource directly

a999670fea-+-profile::cumin: use bool2str to simplify code

60da5479d5-+-C:ldap::client::utils rollback updated LDAP tools

b97aa711c1-+-cumin: add an audit report for insetup servers

70ff70ef6b-+-superset: deploy python3-gevent of bullseye

052bbf7e5b-+-C:ldap::client::utils Rewrite add-ldap-group

c95236fcd2-+-ldap:management rewrite modify-mfa to use Bitu.

3ae09ca161-+-Make ganeti5007 a Ganeti node

b4ba83e131-+-puppetdb: restart through systemd if service dies

d685ca9468-+-puppet_compiler: bump version

402c40a7a0-+-cfssl::cert: add documntation and fix linting

0155042e98-+-Make ganeti5006 a ganeti node

7676e317e9-+-Rename codfw restbase-dev nodes to cassandra-dev

609c65d29c-+-certspotter: temporarily disable certspotter (and the systemd timer)

2c69d0f3a5-+-Remove remaining Puppet references to ganeti5002 (decommed)

f4cc06edd2-+-site.pp: role::test for test-reimage2001.

1f1e676ee0-+-site: Productionise mc2039 too

0ac764b45d-+-site: Productionise mc20[39-55]

b81307d8be-+-P:mediawiki::php:monitoring: Retry opcache probe

6573e1a22a-+-prometheus: Enable profile::auto_restarts::service for Envoy

ab46f78ff0-+-Make ganeti5005 a Ganeti node

51e3d58e69-+-phabricator: rm code from before system user was created with systemd

b45ed269f9-+-phabricator: Add SPDX headers

31c251c888-+-doc: Enable profile::auto_restarts::service for Envoy

43d0d20800-+-wdqs: Bring wdqs20[09,10,11,12] online

9face1ca07-+-lvs5006: set as secondary LVS and remove lvs5003 (decomm)

7f6215e039-+-gerrit: raise H2 compaction time

482e33aacf-+-Revert "ci::master: hack to bootstrap new server contint1002"

e946a52778-+-ci::master: hack to bootstrap new server contint1002

edee03d6b0-+-lvs5006: commission new LVS host (eqsin hardware refresh)

4a02250cfe-+-contint: add ci::master to contint1002

c6f6a2554a-+-netmon: Remove rsync quickdatacopy failover restrictions

071288aa70-+-lvs5005: set as high-traffic2 primary LVS and remove lvs5002 (decomm)

f705e4181a-+-Fix typo for sretest2002 node in site.pp

c63afea58e-+-updating role

94f6523979-+-updateing site.pp for kubernetes servers to change role to insetup::serviceops

08473debd2-+-Enable profile::auto_restarts::service for Apache/FPM/Envoy on mwmaint/noc

ce288dbf5d-+-search: drop search-drop-query-clicks systemd timer (2/2)

a869a71e9a-+-Promote Cassandra 3.11.13 to '3.x' (aka stable)

bdbc2d425d-+-lvs5005: commission new LVS host (eqsin hardware refresh)

fc98a524be-+-analytics::refinery: Add SPDX headers

95b8af3f58-+-Enable profile::auto_restarts::service for Superset

c56009076a-+-yarn: Enable profile::auto_restarts::service for Envoy

343af81dd2-+-hue: Enable profile::auto_restarts::service for Envoy

c701a95a7d-+-superset: Enable profile::auto_restarts::service for Envoy

0291603fd0-+-package_builder: Don't fail on cleanup jobs

1f2e95b173-+-cloudcumin: setup the 2 new VMs

36dc0f2f9a-+-cluster::cloud_management: create new role

616302cc6b-+-Add an-presto1008-1015 to presto cluster

8db9f52318-+-base: remove support for plaintext remote syslog

a421157ad2-+-C:systemd::syslog: Do not filebucket logfiles

2383635821-+-C:vopsbot: Notify service on config change

c79d085081-+-Enable profile::auto_restarts::service for Burrow

7e59ffa519-+-site.pp: Clarify db1206 isn't production ready

de52d54909-+-Adding kubernetes1023/1024 to site.pp

665d58f667-+-Adding cephosd servers to site.pp insetup role

60bc2e867e-+-adding eqsin ganeti

17fab457c8-+-Add new sretest codfw node to site.pp and netboot.cfg

07f4664181-+-search: drop search-drop-query-clicks systemd timer (1/2)

0f1fb4a967-+-exim: Disable IPv6 on mail hosts on cloud vms

3fccffbf20-+-P:mediawiki::deployment::server: set helm env

6a982c1bf0-+-maps: remove tilerator::regen

ed81cc4d99-+-Add python-is-python3 package

ffa2049fa0-+-icinga: move mgmt_parents to icinga

be95447a60-+-site: remove phab1001

009efea662-+-site/phabricator: fix insetup role name which is now team specific

2bf287f925-+-rsyslog: allow specifying TLS client auth settings and filename property

207bacae9b-+-phabricator: remove production role from phab1001

2a8ab69313-+-cp5016: decommission hosts (eqsin hardware refresh)

6a8a6442cf-+-cp5015: decommission hosts (eqsin hardware refresh)

82bdb6e0ab-+-cp5012, cp5014: decommission hosts (eqsin hardware refresh)

22f838a9b7-+-cp5011, cp5013: decommission hosts (eqsin hardware refresh)

4e8ba1f90c-+-zuul: Add SPDX headers

ca0ed4b2bb-+-calico / dragonfly: Add SPDX headers

bb0c2c569d-+-mediawiki::maintenance::campaignevents: meta

d8468122e1-+-uwsgi: Add support for bookworm

5c6fcb2b16-+-icinga: decom mgmt monitoring

1b8acafba0-+-envoy: Add SPDX headers

2ab655712e-+-presto: Add SPDX headers

39fe4fbbe8-+-postgresql::server: Add bookworm support

489297fa83-+-lvs5004: set as high-traffic1 primary LVS and remove lvs5001 (decomm)

c03e20616e-+-profile::pybal: expand the lvs hostname regexen.

9614b0499a-+-netmon: Open LibreNMS port for netmon2002.

cf046dcd04-+-Revert "Revert "lvs5004: commission new LVS host (eqsin hardware refresh)""

f6a617c755-+-P:dns::auth::update: increase git clone timeout

946f9c2d43-+-harbor: fix interpolation in onlyif detecting compose

ea50819813-+-Add an-presto1007 to presto cluster

2860aabd52-+-ldap:client:utils remove outdated ldaplist util.

b2c3915084-+-mwdebug_deploy: remove deployment timer

f56b6c7c33-+-Remove ganeti5001 from Puppet

a7ab0d0226-+-site.pp: db1132 is no longer special

c624cdd1e8-+-mariadb: Add db1206 to s1

82984eb938-+-Revert "lvs5004: commission new LVS host (eqsin hardware refresh)"

78a07930d7-+-site: remove old appservers

6873f12ce4-+-varnish: Remove unused dstat plugins

36a76e7054-+-snapshot: Parallelize cirrus dumps by db shard

0567c7bc67-+-lvs5004: commission new LVS host (eqsin hardware refresh)

5492e07359-+-growthexperiments: Use min edit limit for user impact refresh

0bfc0f8fe9-+-P:cache::haproxy: harden systemd unit

be1c67235b-+-idp::standalone: correct permissions

ad1f72d659-+-Add new cloudvirt node to site.pp

bac601c5ed-+-idp::standlone: corrcet file name

bca32f699f-+-idp::standalone: config is not a hash

2aba2f2ddb-+-idp::standalone: correct name of local_settings

1ec58ca676-+-idp::standalon: use production value for oidc_endpoint

7a251df7c0-+-idp::standalon: Add OIDC config

31fccceb6d-+-Promote the aqs_next role to be aqs

5ef7b10a41-+-idp::standalone: add django oidc app

d25de37e46-+-postgresql: Add bookworm support

2b2d181358-+-kube-env: Move environments and services to config

65a4e074f8-+-Add an-presto1006 to presto cluster

d050033b94-+-Make ganeti5004 a Ganeti node

ecbbc11cf1-+-harbor: ensure that it's started

d328877191-+-toolforge harbor: update certs with acmechief

5c4a65dcad-+-harbor: remove unused harbor::db module/role

a274b6af9f-+-harbor: remove support for <bullseye

654d2f9c61-+-cp5027: update site.pp and related configs for cp role

e36d009e36-+-cp5026: update site.pp and related configs for cp role

bb45e091dc-+-cp5025: update site.pp and related configs for cp role

55ff7c6a2b-+-site: add vrts2001 role insetup

dbc4cd98b6-+-cp5024: update site.pp and related configs for cp role

8f1a909e7e-+-cp5023: update site.pp and related configs for cp role

3976049873-+-cp5022: update site.pp and related configs for cp role

8905bd57f3-+-profile::openstack::base::cinder::backup: more keystone_authtoken refactor

1dcbe3fa89-+-mediawiki: Add quarterly cleanup of flaggedtemplates table

ab39f9717d-+-Add ganeti5004 to site.pp

0a1984aab6-+-idp::standalone: add chdir for uwsgi app

fc4b4590db-+-Openstack config: move keystone_authtoken into a shared template

9e48cd9261-+-P:idp::standalone: create virtual env for idp-test-login app

bc44582b08-+-Modify jupyterhub config to point to conda-analytics instead of anaconda-wmf.

b2a8b246ba-+-P:idp: move flask test script to a file

f9ae88eeab-+-apero_cas: (WIP) add addtional paramas for OIDC

4b8943c1ee-+-graphite: move alerts to graphite1005

6f546ab498-+-stats: failover writes to graphite1005

f4a9dd4a94-+-Enable profile::auto_restarts::service for prometheus-ipmi-exporter

92aa46766f-+-Enable profile::auto_restarts::service for dragonfly-supernode

bbb8955b32-+-elasticsearch: Add SPDX headers

9d21b7f0d9-+-Openstack config: move oslo_messaging_rabbit into a shared template

adf304032c-+-Enable profile::auto_restarts::service for Envoy on releases*

670e351b4e-+-apereo_cas: fix delegated authentication config

e846e0b5dd-+-cp5021: update site.pp and related configs for cp role

dd23db58db-+-P:idp::standalone: fix minor formating issues

393d32daa1-+-Add new db node to site.pp and netboot.cfg

339fa9aa07-+-mediabackups: Add new policy intended for admin deletion of files

a27ade3dee-+-puppetdb: Bump postgres version for bookworm

17698f3afe-+-Remove one more obsolete package after bullseye->bookworm upgrade

913353d630-+-archiva/piwik: Add SPDX headers

55fbf9e712-+-P:openstack: explicit rules for haproxy backend traffic POC

05f94e539b-+-maps: remove Cassandra and Tilerator service

6da4958096-+-rsyslog: Add SPDX headers

d2e9fcf79c-+-puppetmaster: Add SPDX headers

17a0ae6703-+-site: assign new appservers to their roles

b5386f0c2f-+-Fix typo on hostname

d483300223-+-phabricator: switch mysql slave port for logmail to string

691d21ed9e-+-phabricator: change db ports to strings in tools class

fbe4fc01df-+-phabricator: quote mysql port numbers

c1b1414f20-+-cp5006: decommission host (eqsin hardware refresh)

d9e70a5727-+-cp5005, cp5010: decommission hosts (eqsin hardware refresh)

ed0d8073ed-+-cp5004, cp5009: decommission hosts (eqsin hardware refresh)

34eaaffa21-+-p::phabricator::main: remove unused $cache_nodes

b02c394e04-+-cp5003, cp5008: decommission hosts (eqsin hardware refresh)

a6c5c96b8d-+-Enable profile::auto_restarts::service for Envoy on planet

ba097b7a11-+-cp5002, cp5007: decommission hosts (eqsin hardware refresh)

a66e47b833-+-dumps/distribution: add more data types to parameters

39f37b04a9-+-Patch cinder volume_type api to allow non-uuid project ids.

4ca5e3e194-+-glance: use memcached for token caching

0e7fd8263e-+-ceph: Add SPDX headers

9e37f647f7-+-opentelemetry::collector: Fix config template

affbfe7ae5-+-zookeeper: Add SPDX headers

b7d583e577-+-opentelemetry::collector: Fix service ensure

5d16d4de85-+-opentelemetry-collector: Basic install

170282a96e-+-Remove support for overriding LDAP client stack

0d227615fc-+-Enable profile::auto_restarts::service for envoyproxy on Grafana

79769c9b5f-+-P:mediawiki::maintenance: CampaignEvents periodic

66d175647f-+-graphite: mirror traffic to graphite1005

6149a4bd07-+-P:openstack::designate: remove separate profile for firewall rules

3c6b953cd3-+-Make ganeti2032 a Ganeti node

31db377c35-+-graphite: Add SPDX headers

ca3ebe6cd2-+-Make ganeti2031 a Ganeti node

960bd4648d-+-Enable profile::auto_restarts::service for Envoy on debmonitor

92bd6c58df-+-Enable profile::auto_restarts::service for virtlogd

35ed6283aa-+-systemd::timer::job: add monitoring_url to unit file

97972e3c60-+-systemd::timer::job: update documentation and fix minor lint issues

205804e4d5-+-hadoop: Add SPDX headers

57c83e5a5d-+-k8s builder: allow deployers to sudo update-mediawiki-tools-release

340f87fb03-+-Remove graphite2003

bb46a57262-+-lvs4010: set as secondary LVS and remove lvs4007 (decom)

eb1f7a06d1-+-Add arclam1001 to site.pp and netboot.cfg

4736b63016-+-Add contint1002 to site.pp and netboot.cfg

193741fb39-+-lvs4010: commission new LVS host (ulsfo hardware refresh)

30bc961f0a-+-Enable profile::auto_restarts::service for Turnilo

56fc4a4ea1-+-swift: base the object number on the scsi path

3995854525-+-P:netbox::host: create a motd for the status

684897507f-+-Add SPDX headers to various IF profiles

8b9c3e6784-+-pontoon: Add .crt filename suffix to PKI root CA

2435c0471c-+-rsync::quickdatacopy: Allow having multiple destination hosts

61cce870ea-+-Add puppetdb1003 and dbprov1004 to site.pp and netboox.cfg

93780319f9-+-lvs4009: set as high-traffic2 primary LVS and remove lvs4006 (decomm)

1c4fc973b0-+-webperf: Add SPDX headers

06314f1665-+-swift: Allow for mounting using the device directly

68cd0dbd2d-+-swift::mount_filesystem: allow overriding the mount point

a9ce7c4616-+-P:swift::configure_disks: remove ensure_packages

efbfd7f02b-+-prometheus: move webperf jobs to 'ext' instance

bf616e601c-+-P:swift::storage: add new resource to format via pci path

07bd0a19ae-+-C:swift::storage: add variable for data directory

076c4e88af-+-lvs4009: commission new LVS host (ulsfo hardware refresh)

d0a5260387-+-dumps: fix http alert to check the new status

e5a6a58804-+-scap::dsh: support querying puppetdb, use for k8s-workers

c979f1a6b5-+-pontoon: write out puppet/pki CA certs

4f9a9a5ae1-+-confd: create /var/run/confd-template

dbf4ff4a6f-+-alertmanager: Add SPDX headers

336010eeb4-+-graphite: start mirroring traffic to graphite2004

4e1bc5dcc7-+-cp5031: Set cp role via site.pp and related config

29b8b6791a-+-phabricator: remove hardcoded ports, use parameters in my.cnf for admins

4fce29680a-+-Add kafka-jumbo101[0-5] to site.pp and netboot.cfg

13dcd4da6f-+-role::cache: Remove text|upload_haproxy roles

0bfd1b6538-+-kubernetes::mediawiki_runner: allow ssh from the deployment servers

877caf8a80-+-cp5030: update site.pp and related configs for cp role

a6bd9dc8ce-+-site: Move cp nodes to role::cache:text|upload

9974885cf5-+-dumps: Keep only 13 latest growthmentorship dumps

fd88d2e277-+-prometheus: default to valid external url

7331f10e5d-+-role::cache_upload: Include profile:c:v:f:upload class

223f0c0d2b-+-prometheus::ops: Leverage varnish::frontend::text|upload classes

d895ffdacc-+-P:mediawiki::maintenance::wikidata labs exception

aae750d6a4-+-cache: Create dummy profile class to tell between text/upload nodes

95c872f7c0-+-role::kubernetes::wroker: allow scap to pre-pull mediawiki images

b47cade191-+-cfssl: update pattern to be case insensetive

973d37bdcb-+-role::cache: Link/copy (text|upload)_haproxy to base roles

94ba9f2c92-+-profile::kubernetes::node: add k8s_116 tag to infrapod's default

0d39fc321f-+-cp5029: update site.pp and related configs for cp role

56b6e0759b-+-cp5028: update site.pp and related configs for cp role

21335f92d1-+-cp5020: update site.pp and related configs for cp role

e8728813b7-+-cp5019: update site.pp and related configs for cp role

367e27387c-+-cp5018: Set cp role via site.pp and related config

bcce5325db-+-dumps/distribution: move hardcoded host names to parameters

cc369fbda0-+-glance: use www_authenticate_uri

656d726621-+-cp5017: update site.pp and related configs for cp role

d7d18f3358-+-prometheus: Remove old ats config export job

6b54862286-+-P:pki: add new type calidation for ca names

460e7dc3bb-+-puppet_compiler: bump version to 2.5.2

03a34d3e43-+-prometheus: drop cloudvirt ceph metrics generator

c6af6537dd-+-P:spicerack: ensure firmware directory is writable by dc-ops

d2c6260554-+-cloudvirts: introduce modern NIC setup and use it by default

1535061ddb-+-openstack: nova: compute: cleanup unused code

766aa5ecc0-+-pontoon: don't double-define ferm rules for metricsinfra prometheus

00f6654b6b-+-prometheus: Refactor ATS config monitoring

e41990e9f3-+-GrowthExperiments: Run updateIsActiveFlagForMentees weekly

403b515bf8-+-idp: Add missing/renamed keys

cc84b13a76-+-cfssl: make keys optional

b01a308fbf-+-profile::maps: remove chgrp_log

23734b47a7-+-phabricator: pass missing mysql.port paramater to local settings

061020d65d-+-maps: enable postgres replication slots in eqiad

3d3d94d4fb-+-aux-k8s: allow kubepods to talk to pki

7cb3a7c364-+-maps: add support for replication slots

1dc601ff5b-+-C:postgresql::master: add support for multiple replicas

1ee1edc17c-+-benthos: fix required 'content' for absented systemd::service

a27b107989-+-benthos: fix service name

7195a6defa-+-cloudgw: cleanup unused code to support multiple NICs

54769e71af-+-pontoon: serve public pki certs via fileserver

63ed4978c9-+-P:pontoon: include firewall rules to allow metricsinfra scraping

2001d7d698-+-prometheus: add benthos jobs

3c00da9bfd-+-pontoon: install Puppet and PKI CAs as certificates

32081513cf-+-pontoon: copy out the root pki ca

fa38bca61f-+-k8s: Add a central ipv6dualstack flag to enable dual stack

00c46584fe-+-Remove last trace of cloudmetrics100[12]

0e3894224f-+-elastic: change java GC options to default for ES7

c20d69e37b-+-puppet_compiler: bump to 2.5.1

70468fd5bd-+-puppet_compiler: bump version to 2.5.0

0b5d6ccd62-+-puppet_compiler: set group and bum version

76ddf7f8bf-+-cp5032: update site.pp and related configs for cp role

da0ed39fd0-+-Enable profile::auto_restarts::service for Apache on deployment servers

5ee60f538e-+-puppet_compiler: move clean up jobs and proxy site to db instance

412c831a7a-+-cfssl: change intermediate key path

fecdb98485-+-thanos::rule: allow using without object store

0bab6dd244-+-Revert "puppet_compiler: update to server every thing from puppetdb"

64d5347479-+-lists: Enable profile::auto_restarts::service for Apache

310daedf6d-+-puppet_compiler: fix typo

0e08e0b6d4-+-puppet_compiler: update to server every thing from puppetdb

d0f11faabe-+-P:wmcs::metricsinfra: allow excluding projects from the sync

89f51e839a-+-P:wmcs::metricsinfra: fix user

fea7ddb19f-+-P:wmcs::metricsinfra: add timer to sync project list

83650e85ed-+-P:wmcs::metricsinfra: use `pip install -e .`

f887f98cfd-+-cloudgw: ensure vlan package is installed

598cdf12b1-+-centrallog: add first prototype of webrequest-live with Benthos

f791a47850-+-prometheus/trafficserver: Remove node_ats_config

80644f98c9-+-ceph: osd: factorize config read

51cbf39d39-+-postgres: Remove support for Stretch

68e12b3223-+-cloudgw: introduce more robust vlan interface naming

cd913827da-+-Remove bast5001

f54ef79f86-+-k8s: Refactor profile::kubernetes::master::service_cluster_ip_range

cf19fa44c0-+-k8s: make profile::kubernetes::cluster_cidr mandatory

6740937eab-+-k8s: Stop docker/runc spam from being written to syslog

ce6737e023-+-Remove leftover Puppet entry

ca2d813516-+-Remove puppet leftovers

75e8cc9b2e-+-Remove leftover entry for bast4002

1ff1f5e959-+-add wmcs-securitygroup-backfill

39bf940bbc-+-phabricator: add parameter for mysql port, set it to 3323 if using slave

23454c56c8-+-Add new node to site.pp and to netboot

8a31ae80e3-+-lvs4008: set as high-traffic1 primary LVS and remove lvs4005

9943816a2e-+-varnish: Remove deprecated jemalloc options

4ae068d83c-+-wikidata: fix for data structure manipulation

221d0f75a0-+-wikidata: fix puppet for finding load balancers after reverts

7556c64177-+-cfssl: search intermediate key on filesystem

e39825eaf4-+-pki: run initca for root_ca when needed

da55357a5b-+-pki: generate CSR for root_ca

b324064d97-+-cfssl: introduce cfssl::csr

dc972732c0-+-pontoon: optionally act as PKI root

f7289d36b4-+-prometheus::ats_node_config: remove prometheus-ats-config

a56547e5b6-+-prometheus: Rename ats_ metrics to trafficserver_

c0219e9ef4-+-Remove leftover entry for centrallog2001

bc76a37505-+-Remove puppet leftovers of old ELK5 hosts

4d29c707f6-+-dispatch: sync user role and info from LDAP

517f211887-+-acme-chief: Switch to systemd::sysuser

de7fd6aa99-+-Fix up comments

ab72b2b5db-+-P:idm add missing directories for static and media content.

432f186591-+-C:spamassassin disable email notification on failure.

b5a6440e1c-+-Enable profile::auto_restarts::service for jwt-authorizer on docker registry

9e647bfcd8-+-P:idm fix service fqdn variable naming.

1c2ac2dd6d-+-C:idm::deployment logrotation for Django logs.

c69b9aab17-+-Add a basic puppetization for Benthos

11d45550ce-+-phabricator/aphlict: pass through ensure parameter

b22062638e-+-site: update role for cp4052

1c65956c45-+-site.pp: Fix db1206's owner

6d9216c5e0-+-haproxy: concurrency tracking as discussed

59f9066288-+-No-op change. Replace the idea of stickycounters with actions

cd6d4fd9e9-+-P::lvs::configuration: update lvs4008 config for recent reverts

0ad867a578-+-Revert "P:lvs::configueration: move classification to hiera and add error checks"

78144a7053-+-Revert "P:lvs::configuration: Dont alert for missing lvs definitions"

f3f77e4360-+-Revert "profile::lvs::configuration: Fix typo"

b296b17c35-+-Revert "P:lvs::configuration: Store all site data in an accessible structure"

3ba6245e57-+-Revert "P:cumin::master: Add aliases for lvs traffic classes"

f33a2449cb-+-site: remove phab2001

7d5ea065ee-+-phabricator::aphlict: Pass the ensure to the auto restart

7efa13fa28-+-P:pybal: add lvs4008 to bpg-peer-address

1128eb062f-+-GrowthExperiments: Use job queue for refreshUserImpact script

ef070873a7-+-Add GrowthExperiments periodic maintenance scripts for user impact

e54e5af1d8-+-Remove cache::(text|upload)_envoy remnants

a04ebde4ba-+-Clean up trafficserver::tls and related

0e946d51cb-+-lvs4008: commission new LVS host (ulsfo hardware refresh)

643926a195-+-k8s: Use systemd cgroup (v2) driver with 1.23

6b92e753e2-+-calico: Allow different versions, drop pre bullseye support

7f055a95b8-+-varnish::common: set Python version for bullseye

94143fa2ac-+-profile::java: Add support for bookworm

66907aa2ca-+-elastic: finish decom of elastic2049

527bb1d22f-+-R:rsync::manifests::server::module: add type validation

97d65ae64a-+-site: move contint2002 from insetup::unowned to insetup::serviceops

f92a48b332-+-site.pp update for ganeti103[34]

56c93e88fb-+-Remove obsolete files for OpenStack version Victoria

0b0e0b9fc5-+-Enable profile::auto_restarts::service for aphlict

9deed448db-+-Revert "prometheus: Rename ats_ metrics to trafficserver_"

2269e1a079-+-prometheus: Rename ats_ metrics to trafficserver_

5673274f07-+-puppet_compiler: allow for storing pson files with gzip

5054f13fa1-+-puppet_compiler: bump to 4.2.2

e1f9fd3bfa-+-Bootstrap new AQS Cassandra nodes (eqiad)

227923cf95-+-Add SPDX headers to various IF profiles

9964df11d4-+-netmon: Add regex to match all the netmon instances.

cb816cd0af-+-calico: Align formatting with k8s module and profiles

b9249bfb6d-+-toil::ganeti_ifupdown: fix systemctl path

4254d1a099-+-Enable profile::auto_restarts::service for prometheus-ganeti-exporter

7a8823d5dc-+-grafana: Add SPDX headers

875afa0bde-+-Enable profile::auto_restarts::service for haveged

24774e3e64-+-toil: add bandaid for ifupdown race

b9eb1c0d36-+-swift: Ensure that bzip2 is installed

a486d4f7f5-+-P:kubernetes::deployment_server: fix absenting

aee2efa80f-+-postgresql: move CLI to pg- namespace and dashes

caf47d4ede-+-Retire generic insetup role

86755b13d2-+-apereo_cas: Install libmemcached-tools

9f8466bd66-+-puppetdb::database: Add support for bookworm

335a9ea99b-+-k8s: Use the K8s::Core::V1Taint type

757e635f41-+-k8s: Add version switching where needed

bc50cc8b81-+-Add --service-account* flags for TokenRequest

545196729e-+-access_new_install: use install-console and compat symlink

6ed9cdb21f-+-site/phabricator: move phab2001 from prod to insetup role

adef89f489-+-site: add dispatch-be2001

6df0fae188-+-P:kubernetes::deployment_server: absent services

ce1796acc0-+-prometheus: probe SSH on mgmt network

1fe8249c42-+-prometheus: Alter node_ats_config class to include

504df83bf6-+-Remove obsolete spicerack hook

e46e55aaed-+-global: replace labsproject by wmcs_project

097570e931-+-Remove hook for icu63

c8e8169b1a-+-Remove obsolete vp9 hook

927e9462ab-+-growthexperiments.pp: Run updateMetrics.php daily

84c650f4e2-+-paws: Add SPDX headers

5047472f21-+-ci: Add SPDX headers

ef3a07ded5-+-Cinder: cinder-api-uwsgi.ini is a file, not a template

17aad96c48-+-Cinder: add cinder-api-uwsgi.ini from X-version cinder package

5e25af8980-+-add cinder_seed.sh.erb

6b09056573-+-ml-staging: fix wrong role assignment of staging workers

30bc273bfc-+-swift: add moss-fe[12]001 to swift frontends

0c5966377c-+-C:idm::deployment add required packages for testing.

5facef4f4b-+-pontoon: Make poonton lb a central DNS server for the stack

7528f20bdf-+-bacula: Add missing fileset definition dispatch-postgres

3a99eb0af7-+-P:spicerack: remove whitespace in package name

e7253a67f3-+-Rename ml_k8s staging roles to match naming scheme

4c1d77cacb-+-gitlab_runner: enable restrict_firewall for Shared Runners

d65aec49aa-+-Move kube-scheduler config to file

3f5d1df6fa-+-k8s::package: only install the apt source once

3be0877eba-+-kibana: remove resource needed only for kibana 5

fdb42be9b3-+-dumps: datasets/fetcher, add data types to parameters

684f545fde-+-wikilabels: Cleanup old DB proxy information

0dc88d7231-+-mail: Add SPDX headers

1335aa2aad-+-webservice: add toolforge-* link for it

bbeecdd30a-+-P:idm Apache2 modules are named with _ not -

6efbda8f5f-+-P:idm Fix missing configuration dir.

44683df11f-+-kubernetes: Add SPDX headers

92335deb36-+-P:idm Add missing project variable.

abd2ca520e-+-puppetmaster::standalone: Sync swift rings

78d02efb06-+-R:swift::label_filesystem: jst check that any lable is on the disk

8707e333c2-+-P:spicerack: add python3-packaging

9efa7b6e4a-+-C:idm:deployment add django configuration.

28d031f9e0-+-Move kube-proxy config to file

d9807b891d-+-dispatch: refactor/simplify db profile

b273671a12-+-install_server: remove db2183, db2184 from db recipe, correct owner

22542800fb-+-C:idm:deployment Git checkout should be in a subdir.

f53f7eae73-+-C:idm::uwsgi_processes do not create directory twice.

2528191f6d-+-C:idm::deployment of IDM.

30ffd02ab4-+-site.pp: Change spare with data_engineering

c433990727-+-mariadb: Add spare db1206

8de4b1a103-+-Openstack: Add manifests for Barbican version Yoga

8dd7023952-+-Openstack: Add manifests for Cinder version Yoga

e1d1e659ba-+-Openstack: Add manifests for Heat and Magnum version Yoga

fde6c40016-+-Openstack: Add manifests for Trove version Yoga

38c90cc553-+-Openstack: Add manifests for Neutron version Yoga

f3b75dc0c7-+-Openstack: manifests for glance, nova, keystone, placement version Y

6ee31249bd-+-change cp4052 role in site.pp

19c93e10d4-+-clouddumps/phabricator: rename rsync module to fix dumps sync

7da900a7ac-+-kafkatee::webrequests::ops: install stats script

da7b3424fb-+-Unroll role::insetup

8678e0ab8b-+-base: Add SPDX headers

6bf2819e76-+-puppetdb: On bookworm install from component/puppetdb7

5846c823d2-+-dispatch: move frontend to its own module

572caf4c0c-+-acme_chief: use force to absent cert directory

5ec6628a30-+-trafficserver: Clean up after ATS 9.x upgrade

284fa1e37b-+-kerberos: Add SPDX headers

6abc157a89-+-kubelet: Re-enable readOnlyPort (tcp/10255) for prometheus

b1f75836f8-+-puppet_compiler: bump version

f6a85e40b1-+-statistics::rsyncd: use nogroup for gid instead of nobody

90ff4ecccc-+-haproxy: Produce valid configs for HAProxy 2.6.x

058323fa36-+-Drop toolschecker checks for the wikilabels database

79937211e1-+-Move kubelet configuration to file

71403e4cad-+-cache::haproxy: Allow choosing between HAProxy 2.4 and 2.6

52de3a6ad7-+-smokeping: remove ancillary data

86e164458d-+-smokeping: remove module and profile

fc3570f259-+-profile: absent smokeping

4c4a479433-+-smokeping: add ensure parameter, set to present

a336dcb712-+-aux-k8s: add LVS config for API server

dcd44ab84c-+-esitest: do not require on obsoleted file resource (attempt 2)

e061a32969-+-esitest: do not require on obsoleted file resource

eb49ced507-+-haproxy: use systemd::tmpfile to create /run/haproxy (and esitest)

37e2cbfc1b-+-esitest: add explicit require on /run/esitest

dfd1974cb7-+-Add a few more package cleanups for bullseye->bookworm ABI changes

a139c25c90-+-p::wmcs:nfs: Fix typo in the hiera lookup

21ac454d9a-+-esitest: add config file dependency on /run/esitest creation

15aa842a88-+-dispatch: configure http header auth provider

9c5d37a36e-+-dispatch: run wrapper with interactive/tty support

6926fdfd8d-+-Cleanup obsolete binary packages after bookworm dist-upgrade

c23e992d98-+-installserver: Add SPDX headers

0235686612-+-dumps: Add SPDX headers

ebaa4864f6-+-thanos: Add SPDX headers

d10a34a6d3-+-prometheus: use default for ignored_devices

4bb126e3ba-+-Make Kubernetes version configurable

c61bb70c53-+-safer dnsmasq restart/reload

3013fcfe67-+-p::toolforge:harbor: use distro docker for bullseye

1732d71b8f-+-Add openstack::designate::service::yoga

5db26e6a59-+-Add openstack::serverpackages::yoga::bullseye

ccab4d638e-+-Add openstack::clientpackages::vms::yoga

bf6b2a7346-+-Add openstack::clientpackages::vms::yoga classes

6c314dc30e-+-puppet_compiler: bump version

1c4c5aa36f-+-Schedule image suggestions for ca, no, fi & huwiki

2fd3947a3d-+-C:debian: add support for testing

8c0a345403-+-cloudgw: explicitly accept VRRP packets from the peer

d160f8d36b-+-dispatch: run the scheduler on active host only

6dc755e059-+-dispatch: enforce ssl for dispatch DB user

6b195abdcf-+-P:gerrit::migration: use array for allow hosts

f215f0dfd0-+-Stop installing the base packages list for now

4fcb4320ba-+-P:openstack: use yesy vs true for read_only parameter

9280108a65-+-P:ci:data_sync: hosts_allow expects an array

3a699d5952-+-wmflib::Host_or_network: add new type

d9133e45e4-+- profile::idm incorrectly named variable.

68cfc6b413-+-role::idm Basic deployment of IDM

8329d38ac1-+-cinder-backup: apply backup api patch to cloudcontrol as well as backup server

cf9f09f077-+-aux-k8s: disable lvs

04bf9df048-+-doc: add parameters for gitlab_runner and contint hosts, allow them

b15f56760e-+-aux-k8s: ctrl & wrkr roles

54f3eb605a-+-parsoid: Add SPDX headers

a0d62810ac-+-miscweb: Add SPDX headers

0ab5da6ca1-+-scap::master: Clone the scap repo from gitlab

b8f79bd40d-+-git::clone: Append .git to clone url for gitlab source

2c5d2e7fa5-+-openstack::keystone: provision new security group rules for metricsinfra

5bac4d0264-+-cp4052: update site.pp and related configs for cp (upload) role

6a7aa82742-+-mediabackup: Add SPDX headers

119917a6c5-+-P:wmcs::metricsinfra: drop unused variable

ab73465f88-+-C:ldap::client::utils: migrate to debian::codename function

718a25707c-+-P:wmcs::instance: stop provisioning /etc/wmflabs-* on bookworm

9501475f63-+-varnish: remove unused definition of $fe_mem_gb

c78e0517e5-+-C:statistics::rsyncd: use the nobody user explicitly

9e3df1ecef-+-Remove ganeti4003 from Puppet

de9e61bf85-+-wikilabels: maybe get the tuning.conf source part right

82415b72b6-+-cp4048: update site.pp and related configs for cp (upload) role

788657fa42-+-cp4040: update site.pp and related configs for cp (text) role

9556b5241a-+-Purge the last few references to labstore100[67]

fada60da53-+-Revert "cp4052: update site.pp and related configs for cp (upload) role"

162db30977-+-cp4052: update site.pp and related configs for cp (upload) role

7fbd2705a3-+-ganeti4006

050c0633a6-+-wikilabels: fix wrong path for Postgres tuning.conf

4803f5583a-+-cp4051: update site.pp and related configs for cp (upload) role

6662a4a7eb-+-p::ceph:mon: set permissions if mgr key parent dirs

df97c0f097-+-wikilabels: move Postgres DB to its own (non-wmcs) role

d7643bd6fd-+-cp4050: update site.pp and related configs for cp (upload) role

13503a6b25-+-Add a postgres user with our IPv6 network address

40dba7cbd7-+-cp4041: update site.pp and related configs for cp (text) role

3279d9da59-+-alerting_host: include dispatch profile

1644db1d6f-+-dispatch: introduce profile

a86e6b334e-+-cloudgw2003-dev: give proper role and take over cloudgw2001-dev

5f1ebae8b2-+-kafka: Add SPDX headers

744276449c-+-dumps::generation: Add SPDX headers

bf5df6a51a-+-Enable profile::auto_restarts::service for nginx on archiva/proxy

d58065acbc-+-statistics : Add SPDX headers

5354e9cabe-+-wmcs::nfs: Add SPDX headers

4a3ee683cd-+-cp4042: update site.pp and related configs for cp (text) role

0ea8941573-+-debian: Add bookworm

70f4ff566c-+-Revert "prometheus: temp disable mgmt checks until hiera export script is fixed"

b479f63088-+-confd: don't backup tidied files

2427581347-+-kubernetes: Actually use the master_fqdn instead of the cert name

4b40927ba8-+-cp4043: update site.pp and related configs for cp (text) role

34ea150009-+-cp4044: update site.pp and related configs for cp (text) role

332103ea79-+-Revert "cp4048: update site.pp and related configs for cp role"

be0c3b20aa-+-cp4048: update site.pp and related configs for cp role

7598bf58be-+-cp4046: update site.pp and related configs for cp role

d65a8ec440-+-Revert "cp4040: update site.pp and related configs for cp role"

4b66231eee-+-Revert "Add a postgres user with an IPv6 RFC 4193 host match"

6bd026913c-+-cp4040: update site.pp and related configs for cp role

28a7fc833d-+-confd: brown paperbag fix for tidy

b42251ae23-+-single_backend mode for production varnishes

b36f080d14-+-Remove confd_experiment_fqdn support

d287ef3c0b-+-Split confd file definitions

aa1b499387-+-confd: fixup tidy invocation

c9e4486cb4-+-C:puppetmaster: Add realm override parameter

d8df3795e5-+-C:puppetmaster::scripts: add documentation

44764c5b62-+-confd: cleanup stale errors

9b9d5e18b6-+-cp4039: update site.pp and related configs for cp role

ad5c996ad3-+-Revert "cp4046: update site.pp and related configs for cp role"

cb47db07a0-+-cp4046: update site.pp and related configs for cp role

9ce910f846-+-openstack: networktests: fix typo in systemd::sysuser parameter name

d2c162a428-+-Add a postgres user with an IPv6 RFC 4193 host match

1c9424f78f-+-openstack::monitor::networktests: Switch to systemd::sysuser

53df30d654-+-P:toolforge: use puppetdb for grid hba data

d9e1770e71-+-R:system::role: fix linting and docs

d1c6358d9f-+-Open up the postrges service to the analytics vlans

a4d93822c7-+-Revert "P:netbox::host: create a motd for the status"

cd9b40c8f3-+-idp: Add SPDX headers

77398c1af7-+-P:netbox::host: create a motd for the status

8f3239e1b9-+-Revert "P:sretest: create a test to see if the escap code actull..."

3cbef0189c-+-P:sretest: create a test to see if the escap code actully makes through

2084e5ef2c-+-wmflib::ansi: add new ansi formatting function

f0c6bd31fd-+-kubernetes mediawiki config: Cleanup nutcracker

783e503db4-+-cp4038: update site.pp and related configs for cp role

eeec3ea9ee-+-cp403[35]: decommission hosts as part of ulsfo refresh

d35eb4714c-+-cp402[2468], cp403[0246]: decommission hosts for ulsfo hardware refresh

7c1367668f-+-Clean up outdated commentary on requestctl

08d3814552-+-cp4025: decommission host as part of the ulsfo hardware refresh

9d10521c75-+-cp4023: decommission host as part of the ulsfo hardware refresh

0da0b09201-+-elastic: rotate gc log files at 20m

8f4f45d2b0-+-Don't use slash in apt:repo name

87303a888e-+-haproxy/ferm: rename internal ferm rules 'internal' rather than 'public'

19f83313fa-+-OpenStack trove: expose API to the public internet

dac4fea1bd-+-Add thirdparty/tekton repo to WMCS bastions

ffe4b4ad7b-+-xmldumps: Enable profile::auto_restarts::service for nginx

3cba7ac328-+-realm.pp: introduce $::wmcs_project

ff8502e928-+-haproxy: correct srange syntax for internal apis

aecc37af2c-+-Add a simple mechanism for creating postgresql users and databases

26731011aa-+-Neutron, glance, cinder, keystone: Move api firewall rules into haproxy code

2469e39784-+-OpenStack nova: move the frontend firewall handling to haproxy code

128184b118-+-Use generic 'Check systemd state' alert to catch timer failures

c3284bcfd2-+-OpenStack HAProxy: support frontend ferm rules into haproxy

e01da63ace-+-Remove ganeti4002 from Puppet for decom

78a636afc2-+-Add growthexperiments_user_impact to $private_tables

4697cc9bda-+-site.pp: move insetup hosts to the team specific role

9903d9e03f-+-insetup: add team specific insetup roles to ease ownership identification

3ac7b0d565-+-dragonfly::dfdaemon: Fix dummy ssl_paths object

655d6519eb-+-C:swift::storage: drop absented resource

6fac7f7575-+-C:swift::storage: drop unused udev rule

18321c86e0-+-profile::ceph::mon: explicitly create mgr keyring dir

d62d80bf8b-+-Make ganeti4005 a Ganeti node

2ba5beed81-+-miscweb: add rsyslog::input::files to send apache logs to logstash

2701103b87-+-prometheus: update web_idp urls to prometheus-$site.wm.o

cb66115b00-+-prometheus: enable prometheus web access via proxy with IDP

108d4f6cff-+-dispatch: assign backend role

0eae648bc4-+-Update remaining references to analytics-alerts email

a06c95671b-+-P:puppetdb: fix ip address

43c0d14560-+-P:cumin::master: Add aliases for lvs traffic classes

234f89c57b-+-P:puppetdb: add documentation and fix minor lint issues

2a5d93ab64-+-analytics: move kerberos::systemd_timer and deps to send_mail param

10ea08f071-+-P:mail::mx: move passwords to hiera

e92719ef25-+-Revert "P:mail::mx: move passwords to hiera"

bc8c53f569-+-P:mail::mx: move passwords to hiera

200822bdac-+-prometheus: move service_catalog_targets under ::targets

d456a561c1-+-dispatch: add backend role

15674d3b7c-+-gitlab_runner: restart gitlab-runner gracefully

8f7a1dcd07-+-Revert "cp4047: temporarily remove references"

46148efdc3-+-cp4049: update site.pp and related configs for cp role

c0280a8252-+-cp4047: temporarily remove references

4ffb60be69-+-package_builder: add deb-src for buster and bookworm

6b83d15974-+-Create temporary dir for html dumps

c2d224b690-+-cp4047: update site.pp and related configs for cp role

efc52fa306-+-ulsfo ganeti4005 lvs4008

ff65b96585-+-cp4029: decommission host

ce35373e0f-+-aux_k8s_etcd: assign role to servers

7ba715c7be-+-aux_k8s_etcd: initial etcd config

98f15f44a5-+-cp4037: update site.pp and related configs for cp role

a69056ee4e-+-Mount labstore to wcqs/wdqs instance for dumps reload

fe19cdb930-+-Keep Nova API public in eqiad1 but restrict in codfw1dev

18bb585f62-+-kubernetes mediawiki config: Remove nutcracker

12398437a7-+-Add a default value of undefined for the docker uid hash

7de584adb7-+-Add postgresql to an-db100[1-2]

df6a781f29-+-puppetdb: create small script to query puppetdb for a list of changes

b3397a7f1d-+-gitlab_runner: make allowed_images list configurable in hiera

d354620dc9-+-graphite: extract graphite_hosts into hiera

962f5dcae0-+-Assign graphite role to new graphite hosts

44aaa748d7-+-openstack: remove unused nova::placement manifests

428d3fe6b4-+-maintenance::wikidata: Update cron with lb and lb-pool

361e7361d1-+-P:lvs::configuration: Store all site data in an accessible structure

f1a4f08590-+-opensearch: upgrade curator to 5.8.5-1~wmf3

e22a5c2581-+-Add known_uid_mapping support to the production-images for spark

8de3f2752c-+-phabricator: create /srv/homes and allow rsyncing it

ca8edc3135-+-gerrit: remove etc/motd.config

d4e9f9bb95-+-opensearch: allow gc_log_flags reuse

9a1a98228e-+-service::docker: allow runtime to be specified

1766c0c826-+-add profile::docker::gvisor

2544d2a268-+-confd: remove check_confd_template icinga check

beb101f5bd-+-Eventlogging - Stop refining decomissioned EditConflict events

acb006f6f3-+-varnish::frontend: Allow disable monitoring

93502d3a8b-+-cache::haproxy: Allow disabling monitoring

3a0933204a-+-backup: Increase the maximum amount of volumes of esrw (backup*003)

994f1ccf65-+-phabricator: move list of dumps rsync clients to parameter and Hiera

adbd3c8605-+-phabricator: rename rsync module for dumps

9e17cad08f-+-Add haproxy entry for magnum on eqiad1

702b01c2a5-+-Add OpenStack Magnum to eqiad1

d1475e11be-+-Magnum: use magnum-specific rabbitmq user rather than the shared 'nova'

14520c25a8-+-magnum: use rabbitmq_node rather than openstack_controller for rabbit

c73ec83224-+-pontoon: Add SPDX headers

67a554bbe5-+-labs: Add SPDX headers

17004e2e9a-+-Remove remaining Puppet references for ganeti1005-1008

28d96021b3-+-Remove ganeti role from ganeti1008

f5415620b3-+-elastic: decom elastic20[25-36]

f1cfe73eb3-+-Add haproxy entry for Openstack Heat in eqiad1

f266b95ee0-+-Heat: use rabbitmq_nodes instead of openstack_controllers for rabbit

c21ccef80a-+-P:ci::docker: Install upstream docker packages for all CI agents

901be31a2c-+-Install Openstack Heat in eqiad1

27e9034f6a-+-systemd::override: ensure we also pass override => true

733a1f3c6c-+-P:openstack::nova: remove stretch specific code

6ad9c1cb68-+-openstack::horizon: Remove proxy config from local_settings

e668bd28bb-+-dynamicproxy: include prometheus redis exporter

1950a75397-+-dynamicproxy: simplify tls configuration

2578aa1b0b-+-otrs_aliases.py: add postfix support

95c2ce023a-+-P:terraform: few minor bugfixes

83a1b83e17-+-interface: add dependency on ethtool for interface-rps.py

1f23f5a762-+-rsyslog::conf remove trailing newline logic

8065cf78b1-+-systemd::override: Add new helper define for overrides

a12227ae42-+-docker: Remove support for stretch

83444d5c02-+-logstash: Add SPDX headers

00e3911851-+-pki: Add SPDX headers

d461c9c867-+-prometheus: temp disable mgmt checks until hiera export script is fixed

d36130a39a-+-prometheus: probe a sample of hosts in mgmt network

78d893174b-+-cloudnet: merge host hiera overrides back into the profile

6312afd754-+-Remove ganeti role from ganeti1007

ca63fef583-+-cp4045: update site.pp and related configs for cp role

421f5130b5-+-Openstack Designate: Expose the Designate public API

db09fb22cd-+-Openstack Neutron: Expose the Neutron public API

605946429c-+-gitlab_runner: restrict all internal traffic, not only TCP

a5217b3938-+-vrts: allow installing a local mariadb server in cloud

d58d77d9b9-+-hiera: use Linux 5.10 on cp4045 (buster)

cf5ab9981c-+-dns: Add SPDX headers

93cc0408da-+-Remove Ganeti role from ganeti1005

485589e2df-+-maps: Add SPDX headers

9b010a2c02-+-kubernetes::master fail if user tokens are not unique

61c10112b5-+-kubernetes::master remove apiserver_count

630a2ba0f7-+-opensearch: Add SPDX headers

9252f07e9c-+-Openstack Cinder: Expose the Cinder public API

9802e0ebbd-+-Openstack Glance: Expose the Glance public API

40f610be34-+-Openstack Nova: Expose the Nova public API

90eab5708c-+-Revert "wdqs-test: try installing nginx w extras"

c8ccb22e15-+-wdqs-test: try installing nginx w extras

7c4c79b458-+-systemd: Add explicit default for override_filename

9b0c301446-+-Add type Wmflib::POSIX::Name

5b1dca9c41-+-Restart buildkitd if its config files change

d9a131665a-+-Openstack Keystone: Expose the Keystone public API

314c0cf115-+-dns4004: add Puppet role and DNS/NTP configs

309872c659-+-Switch profile::base::linux510 to the new meta package

215b22da68-+-P:mariadb::cloudinfra: remove direct access from puppetmaster hosts

7572dc456c-+-Make ganeti4008 a Ganeti node

c1f6861aa8-+-openstack: keystone: enable app credentials everywhere

1b1294c698-+-P:base: configure Linux 5.10 on buster via Hiera

1baaafe0d3-+-Make ganeti1032 a Ganeti node

e4362b1ae6-+-Remove ganeti1006

10571cb51a-+-P:gitlab::runner: Quote environment variable hash keys

aeceb57534-+-dns4004

11760eb717-+-ganeti4008 setup

97513f3313-+-profile::lvs::configuration: Fix typo

1a6cdbe160-+-Revert "P:toolforge::prometheus: disable k8s label map"

1edd38461b-+-confd: install and run confd_prometheus_metrics

c73ac99fdb-+-Make ganeti1031 a ganeti node

c69acf04aa-+-wmcs::services: Add SPDX headers

7a19e3db78-+-mediawiki: stop checking per-appserver availability

cf246cad83-+-cloudnet: Stop including profile::base::linux510

81e59e784f-+-P:toolforge::prometheus: scrape jobs-api

c0c92c770e-+-cloudgw: Stop including profile::base::linux510

c048359c0a-+-P:terraform: add a new basic terraform module registry

6a0fe56185-+-Revert "Switch profile::base::linux510 to the new meta package"

dc64799911-+-gitlab: proxy settings on runners must be optional

21b2de6f98-+-Switch profile::base::linux510 to the new meta package

e84c00def9-+-Fix selector in site.pp

70928986f8-+-Make ganeti1030 a ganeti node

0f30707ef7-+-P:gitlab::runner: Provide proxy variables to runner jobs

7f7a2bd9a0-+-microsites: Add SPDX headers

78c7ed4326-+-Remove absented resource definitions for aqs nodes

fffc599587-+-Remove legacy AQS host configuration

929e00739a-+-Remove refs to cloudnet100[34]

3a46a82c18-+-Revert "bird: temporarily disable validate_cmd for bird.conf"

58ab4cc179-+-cloudnet1003/1004: make them spare servers

e0e2e274a9-+-k8s: Remove all debian version if-guarding

6b3c8b3933-+-trafficserver: Allow partitioning the cache storage in several volumes

ca4bafb5c7-+-P:puppetdb: correct slot name on master

6ebd4bb091-+-P:postgresql::master: use correct unless statment

3fde8b95ae-+-P:postgresql:: master: correct sql statment

c83050294e-+-C:postgress::server: add replication slot support

7f537efafe-+-eventlogging: Update includes to current styleguide

f9f90e6e53-+-buildkit: add no_proxy for wmf domains

acf1adcd3c-+-wmcs::metricsinfra: Add SPDX headers

79c9895dcf-+-prometheus: Add SPDX headers

959e32308c-+-gitlab: Add SPDX headers

95cf99dfe6-+-Make ganeti1029 a ganeti node

3a36001708-+-bgpalerter: Switch to systemd::sysuser

6c0401c834-+-swift: Add SPDX headers

b5344d75bc-+-wmcs::kubeadm: Add SPDX headers

9bb2fdb055-+-wmcs haproxy: prepare for IP and user-agent blocking

1b4811108b-+-bird: temporarily disable validate_cmd for bird.conf

2e56c9a7a9-+-P:bird::anycast: add documentation

662258d0a7-+-P:bird::anycast: drop dependency

5bfef368b3-+-mediawiki::php: use only php 7.4 everywhere

c11f9edc74-+-openstack: neutron: l3_agent: more support for new vlan naming

2ca29f5b11-+-P:openstack::base::neutron: dont use the legacy naming

34c27b9556-+-Remove unused mwautopull class

28b0a692d1-+-k8s: Align formatting along k8s module and profiles

94de090bd3-+-Fix parameter

f9c737d09e-+-netops::ripeatlas::cli: Switch to systemd::sysuser

f6a4897663-+-Revert "P::dns::recursor: fix anycast svc dep issue"

a7aa1cff12-+-P::dns::recursor: fix anycast svc dep issue

59c6c75b7a-+-Dumps: remove ensure->absent clause

5b84f2e01a-+-Revert "p::dns::recursor: fix anycast->pdns_rec dep"

22186d9fbc-+-p::dns::recursor: fix anycast->pdns_rec dep

14263bc374-+-P:dns::auth:dotls: ensure ordering for sysd_glue

a5b1708b63-+-gerrit: use daemon_user variable everywhere

330759c616-+-dns4003: add Puppet role and DNS/NTP configs

9d13777b15-+-gerrit: make homedir variable

f41e016e4c-+-gerrit: decouple scap and daemon users

641f8390bc-+-P:netbox::data: add profile to load common netbox data

177423c5f9-+-p:wmcs::prometheus: overwrite instance with hostname if there

e3c8425312-+-Fix typo in header

420db579ac-+-alerts: Add SPDX headers

bff6ebdd92-+-scap: introduce bootstrapping mechanism specific to deployment hosts

c8f8241b67-+-cloudnet1005/1006: give them proper role

204e649004-+-docker_registry_ha: pass jwt_allowed_ips to docker_registry_ha::web

9834008cb3-+-C:httpd::mpm: Remove mod_php* for php7.4

8ace8987af-+-parsoid: Cleanup post php7.4 migration

ba0e7ae750-+-cloudnet1005/1006: prepare for single NIC setup

dea0116e46-+-grub: Update includes

9fde99e7f8-+-mirrors: Add SPDX headers

07944a4a8a-+-adding new dns4003

26adba8724-+-Move labstore100[67] to role::spare

a4a123b102-+-interface: factorize interface renaming function

f48b6f6511-+-Dumps: stop mounting the old labstore100x servers on VMs

981aabfc97-+-cloudgw: cleanup unused Debian Buster code

34274084c4-+-Add puppetdb-test2001 to site.pp

fc889a6ec8-+-Remove cp4021 + cp4027 p11n

8fe5faa26f-+-Use correct auto restart define

394daf25d0-+-docker_registry/imagecatalog profiles: Add SPDX headers

f6a10c1283-+-ldap profiles: Add SPDX headers

09b676307e-+-openstack: neutron: l3_agent: more sysctl fine-tuning

61f7fb00c0-+-openstack: neutron: introduce workaround for debian bug #989162

124c53fe50-+-O:toolforge: block local crontabs on accessible hosts

6993377931-+-Enable base::service_auto_restart for FPM/LibreNMS

234cb753f9-+-Enable base::service_auto_restart for Apache on piwik/matomo

6819e4f424-+-profile::mediawiki::php::absented_version: also remove systemd unit

e8f5ee9099-+-mediawiki::php: allow removing a php version from a running system

0d7f2004e6-+-cp4045 spare role set

3a36a4cf22-+-Adding site.pp and netboo for kafka-stretch

4245cb884d-+-confd: Add SPDX headers

2a81b7656d-+-java: Add SPDX headers

36387e6f18-+-Enable base::service_auto_restart for Apache on mirror

d8da5bd39f-+-C:memcached Fix memcached bootstrap

6f74157488-+-k8s: Limit envoy metrics scraped from k8s

671a4b3480-+-P:lvs::configuration: Dont alert for missing lvs definitions

65e7618f8e-+-C:ferm: update ferm to use restart-or-reload instead of restart

4a8a7516d0-+-openstack: neutron: l3_agent: don't sysctl base interface

9897b53442-+-wmflib::service::lvs_ipblock: remove unused function

731dcd65b6-+-puppetmaster: drop support for locale_servers

e238a3954f-+-netmon: add blackbox-exporter for mgmt probes

4aa985b35b-+-delete-old-output-large-reports: fix desc

920672f979-+-P:lvs::configueration: move classification to hiera and add error checks

4a4f8d6769-+-turnilo: Switch to systemd::sysuser

acf7bfc548-+-mariadb: Promote db2140 to s4 codfw master

2a5f6145d3-+-nova-fullstack: specify per-region resolvers

a2d12166c8-+-nova-fullstack: set --deployment

3563313cac-+-Add nova-fullstack service to codfw1dev

cdd51e6a99-+-P:toolforge::shell_environ: explicitely install emacs-nox

6d2d5fe44d-+-mail::mx Remove LDAP support

ab7c62dfa5-+-wikitech: switch to php 7.4

36cd24ee57-+-Fix config template for OTRS or VRTS aliases

ed7a767565-+-query_service: Add SPDX headers

11479d4ea7-+-docker: Add SPDX headers

38e846a9ad-+-Adding graphite1005 to site.pp

096d620d13-+-Ship WMF-specific systemd unit parts as systemd override

81fd775305-+-grafana: limit /metrics ACL to grafana vhost only

925b304289-+-gitlab: disable email notifications on replicas

e836f2d2b5-+-adding mc-wf to site.pp

ad98762bc8-+-Revert "Mount labstore to wcqs/wdqs instance for dumps reload"

3c8c04ca24-+-Mount labstore to wcqs/wdqs instance for dumps reload

b221b251c3-+-lvs: Convert ::lvs::configuration to a profile

4741a49564-+-Add new logstash nodes to site.pp and netboot.cfg

35b4466c56-+-jobrunner: convert to use php 7.4 by default

e849a0bc3b-+-grafana: block external access to /metrics

604d340c1a-+-Adding site.pp entry for centrallog1002

4256fcab08-+-C:ssh::publish_fingerprints: drop RSA support

7a736cf71c-+-interface: Add SPDX headers

69ecae8730-+-standard_packages: Remove more obsolete packages after buster->bullseye update

ca12a712ef-+-Add new ganeti node to site.pp

ff8b27cd5b-+-Adding new kafka-logging servers to site.pp

c1549725f4-+-Add db218[34] to site.pp

60d8231a12-+-P:toolforge::prometheus: disable k8s label map

6993b0a86e-+-Deploy Spark 3 on the whole production cluster

602c94c384-+-P:thanos::swift::frontend: initiate the rsync::server explicitly

4a52189785-+-P:swift::proxy: initiate the rsync::server explicitly

2098d8d6b4-+-elastic: add instances and ports to motd

67124f9586-+-Revert "elastic: add instances and ports to motd"

aa0b179f8c-+-elastic: add instances and ports to motd

580f70b719-+-Set spark3 config on hadoop workers, test install only on one worker

50c61b64f6-+-debconf::set - add $owner param, set owner in conda_analytics/init.pp

9f301e259e-+-Deploy Spark 3 conf and debian pkg to test cluster

20477f0bb4-+-C:ssh::publish_fingerprints: add combined file

d226b651eb-+-C:ssh::publish_fingerprints: use epp templates

95102ff9e2-+-start daily cleanup job of sql/xmldumps later in the day

dae725945c-+-keep minimum older sql/xml dump files on generation hosts

8faa407fbd-+-dbbackups: Reenable notifications on db2100 after adding s7

21fbcb4ad4-+-P:gitlab::runner: $nameservers parameter type should match aliased

e510d38627-+-Cloudvirts: remove libguestfs-tools dependency

a70102e72b-+-buildkitd: Add missing `--config` argument

9c2f31dd6f-+-buildkitd: Support configuration of OCI executor nameservers

758d95fde8-+-gerrit: rm redundant service_params ensure => running

35877c679b-+-keystone: refactor fernet key rotation timing

36a7c91a08-+-dynamicproxy: remove a comment about the log rotation happening hourly

1627a3c08f-+-apifeatureusage: Drop mapping type from template

319b3096e6-+-buildkitd: add option to enable proxy settings for buildkitd

0bbacef8f5-+-planet: Enable profile::auto_restarts::service for Apache

4eac8b358e-+-dispatch-be1001: apply role::insetup

59fb88fdc0-+-Enable profile::auto_restarts::service for apache2

9f776e5f75-+-Align includes with current practice

cc5c7bb148-+-gerrit: remove useless require => File[..]

ba8c7cb07c-+-Enable profile::auto_restarts::service for nginx/installservers

33cff16b7b-+-Enable profile::auto_restarts::service for nginx/aptrepo

fecdc91ae6-+-apt_repo: Remove Apache2 leftovers

8e5c572843-+-doc: Enable profile::auto_restarts::service for FPM

3a9c6cc18d-+-gerrit: gerrit-theme.html is long gone

ed9dbe11c6-+-gerrit: change its templates to regular files

d5044691d4-+-gerrit: move jetty class to init

df4cf53fcc-+-gerrit: move proxy class to a profile

d541c5240e-+-gerrit: ignore lint error in role

c2072fc72e-+-phabricator: remove absented code for icinga phd superiving procs

f692878389-+-phabricator: remove Icinga monitoring for phd supervising processes

a808ff58d2-+-toolviews.py: Record unique IP page views along with total pageviews

de11577d4d-+-profile::ci::docker: Remove support for Stretch

4e593f0e97-+-Revert "wikilabels::web: use the master branch for git repos"

4a9a5af0c0-+-wikilabels::web: use the master branch for git repos

ae87515085-+-novaproxy: Disable nchan module as it gives failures

2704fc4c99-+-wikilabels::web: update wikilabels config repository

4e52262ab5-+-scap: Add SPDX headers

ec6e66b00e-+-phabricator: Fix sudo env_keep format

cb44edcd67-+-P:wikidough: remove redundant resource absentees

a885526387-+-P:spicerack: add firmware directory

a149240f4c-+-P:spicerack: add documentation and fix minor lint issues

bec4a84f6a-+-O:puppetmaster::standalone: move to useing P:puppetmaster::common

eb8511a74d-+-Put the new hadoop nodes into service

394cd3acc8-+-jenkins: use upstream systemd definition

ba9cd96d10-+-systemd: allow changing override filename

146fe58a8d-+-memcached: Add SPDX headers

55aed80119-+-druid: Add SPDX headers

e715e9fd40-+-phabricator: absent /etc/sudoers.d/scap_sudo_defaults

521c65555c-+-phabricator: add double quotes around sudo config line

976b755d52-+-phabricator: use content, not source with a plain file

b8f37f3033-+-phabricator: move scap user sudo defaults to file, fix puppet

c367aeb564-+-phabricator: Allow deploy user to keep scap3 environment variables with sudo

d210f82e82-+-prometheus: Keep envoy connection metrics

9b5ff0a721-+-O:puppetmaster::standalone: fix hiera_config

20777c245c-+-puppetmaster: explicitely specifify hiera config

4ffbb857b9-+-openldap: Include slapd-audit.log to backup

ebe7f45f3b-+-puppetmaster: remove puppet-merge from wmcs instances

be652c082f-+-puppet_compiler: bump version number

98606a4c78-+-kubernetes: Remove obsolete monitoring::check_prometheus resources

f21e71481d-+-opensatck: remove some not needed absented resources

c68bdd4f34-+-mariadb: Promote es2020 to es4 master

fcc278cf41-+-phabricator::phd: actually use $phd_user variable and small improvements

f3e3863c81-+-phabricator: remove require for homedir from systemd::sysuser

315993afb1-+-phabricator: ensure home dir exists before sysuser is created

0587667052-+-gitlab: allow git user to access backup folder

ceb50634da-+-mail::mx: Add support for PLAIN auth over tls

74dd2d1ca0-+-beta: don't duplicate fonts install

286192c5b2-+-prometheus: deploy provision-fs.sh

7449fc1b87-+-deployment-prep: Add P:beta::mediawiki_packages

7a3b1905a3-+-ats: Enable node_ats_config monitoring

3cc0ebc205-+-prometheus: Parse ATS config to node exporter text

5397562db9-+-ntp: Add SPDX headers

5ce036319f-+-Remove obsolete owner annotations

b45e63f7de-+-wtp: Purge wtp servers following migration to parse

2fe89e5529-+-Use the dumpsgen user to mount the NFS dumps directories

131f7883c9-+-P:wmcs::novaproxy: add prometheus nginx exporter

fbd085bd32-+-More RAID cleanups

b12cd09bd5-+-Remove absented Raid Icinga checks

6a937c938a-+-Revert "Exclude cloud-eqiad prefix from MXs trusted networks"

896f882fb1-+-Revert "Exclude cloud-eqiad prefix from VRT trusted networks"

cc40d9a553-+-P:wmcs::novaproxy: add rate limiter

8db0b364da-+-Revert "Exclude cloud-eqiad prefix from lists trusted networks"

23906e797f-+-vrts: fix puppet failure on otrs1001

3f4f43ed0d-+-k8s scap: change format of mediawiki deployment files

786e84b4ce-+-apifeatureusage: use new kafka truststore

03045a5b0e-+-vrts: install vrts script

5104979dd9-+-Remove support for mptsas RAID

59e9828f4e-+-smart: Also use new raid_mgmt_tools fact

2dc932ad93-+-Spicerack: add configuration file and API key for PeeringDB

7934e81824-+-raid::perccli: Run the correct monitoring tool

577963b7bd-+-Switch to the new raid_mgmt_tools fact to enable RAID tools

08801f7c9f-+-Revert "librenms: recursively chwon sessions directory to www-data as a bandaid"

99570a7671-+-librenms: recursively chwon sessions directory to www-data as a bandaid

06cebeadf1-+-C:librenms: correct typo

3d4ef91c21-+-C:librenms: fix file permissions

8c0dd339b9-+-librenms: recurse setting permissions on sessions directory

5ebf8618d4-+-Drop a few now obsolete permission

69d498e0dd-+-Cleanup some more stale references/comments to crons

e467ed1a96-+-C:spamassassin Allow debugging of why service fails.

61b6856731-+-Rename 'Galera haproxy failover' alert

3fb8b6fcbe-+-P:analytics::refinery::job::gobblin_job: fix permissions

630fae5df5-+-P:ci::slave: add group to homedir

1be8214446-+-C:prometheus: fix permissions for prometheus directory

2a44dce2f0-+-Revert "C:ceph: ensure that the ceph keyring folder gets the correct owner/group"

a218ed44a2-+-cinder: fix file perms

5c19fd85ef-+-icinga: fix icinga.log perms

1551969356-+-icinga: fix dir group ownership

5b82804296-+-P:puppetmaster: ensure dire is readable by puppet

134712a04d-+-C:ceph: ensure that the ceph keyring folder gets the correct owner/group

c10f3c6a66-+-C:query_service::/deploy::scap: correct username post

aa96ea84ec-+-C:prometheus::ipmi_exporter: update permissions to use prometheus user

1336837496-+-C:phabricator: fix user permissions

f4c8d9c45e-+-C:ferm: set group perms to adm

7acc980cf4-+-realm.pp: Add defaults for file

1ed0cad1a1-+-P:idp: add addtional loglevel types

8762296778-+-network: Add SPDX headers

f33b7cd736-+-swift: Add SPDX headers

a3f4071696-+-mariadb: Productionize db1203

5fb2dd26ae-+-mariadb: Productionize db1202

4de43d41ec-+-docker_registry_ha: clean up after nginx's socket

4902d4d5f9-+-site: add phabricator role on phab1004

da96b5af2a-+-phabricator: ensure only the one active_server connects to rw mysql

0a8a50356a-+-P:openstack::codfw1dev::db: cleanup firewall rules

b070120d14-+-wikitech: drop webserver_hostname_aliases

7326b68158-+-Add clean-stale-puppet-certs script

2b1e71f4b3-+-C:prometheus: openstack-stale-puppet-certs get ssldir from puppet

7464df8376-+-Exclude cloud-eqiad prefix from VRT trusted networks

9b3df7b686-+-docker_registry_ha: Authorize GitLab trusted runners using JWT

d16d971e33-+-Fix the spark3-env.sh resource

1d625659be-+-mariadb: Productionize db1201

2d7e3ee713-+-raid: use modern nrpe defines

e5bf6fd411-+-Add cloudcephosd103[1-4] to the Ceph pool

97f8a06913-+-P:toolforge::apt_pinning: re-add required param values

cdb74a544c-+-Puppetize spark3 installation and configs using conda-analytics env V2

e4222fe1d8-+-P:toolforge: cleanup bastion grid integration

7069a88263-+-mariadb: Productionize db1199

eba99d900d-+-puppetmaster: remove 'allow_from'

d5befa5d3f-+-P:toolforge: remove linux kernel pinnings

5015b22036-+-keepalived: do not hardcode default interface name

310f0f0abf-+-mariadb: Productionize db1198

28bd5d6dce-+-mariadb: Productionize db1200

50d452fcb7-+-mariadb: Productionize db1197

7df8bfed43-+-p::metricsinfra:haproxy: move to epp template

482efc5095-+-Systemd timer: Cleanup a few dangling absent cronjob references.

9d3e7fccab-+-mariadb: Productionize db1196

b109b01e53-+-cadvisor_exporter: Remove check fo Stretch

ada5f3655f-+-keyholder: Add SPDX headers

53e5b747f7-+-puppet_compiler: Assign SPDX headers

3aed0de17f-+-C:cpufrequtils: update documentation

f5979840e0-+-C:cpufrequtils: Add package dependencies

c840eeca3f-+-P:mediawiki::php: Order wmerrors config and package install

9229c8f899-+-C:ipmi::monitor: Order service after package install

65ef7fe168-+-P:prometheus::nutcracker_exporter: Order service and package

90a88621f3-+-mediawiki::jobrunner: allow picking a default php version

f6f6449e1f-+-Exclude cloud-eqiad prefix from MXs trusted networks

78df4f8d5b-+-Exclude cloud-eqiad prefix from lists trusted networks

2ec082b501-+-apt::noupgrade: remove

20d4b88143-+-C:admin: add support for deprecated groups

3c9f1232f8-+-Add SPDX headers

52f9dc7ec6-+-Squid: permit production networks instead of aggregate_networks

d37a44edc7-+-k8s: Add SPDX headers

3f4fdac16c-+-P:openldap::management rename variable.

4cde0f62be-+-udp2log: Add SPDX headers

aeb91a8924-+-P:toolforge::grid: remove legacy host key stuff

2565bad5cc-+-dynamicproxy: improve /zones API

8f1fcd1984-+-dynamicproxy: add simple compile test

4af856a864-+-releases: Add SPDX headers

8fcd206aa9-+-webperf: Switch to systemd::sysuser

c04966d7fc-+-backy2: correct pool name for glance image backups

866365140b-+-Switch on a second cinder backup host for codfw1dev

6c0480fe3e-+-phabricator: Deploy user should own everything under old rev directories

7c0d77a21c-+-Revert "Revert "Remove obsolete absented cron file""

72bd05bff4-+-Revert "Remove obsolete absented cron file"

4fa9061cc0-+-rancid: Switch to systemd::sysuser

47011d084c-+-Update various comments

cb9e73c42b-+-Remove obsolete absented cron file

624c8abab6-+-testreduce: Switch systemd::sysuser

b32f4fbd81-+-Move profile::wmcs::backup_glance_images from cloudcontrols to backup servers

d6e2a3bafc-+-cache: Remove cp5001

a22f0afa89-+-P:dbbackups::mydumper Move mydumper from cron to systemd timer.

137d00bf77-+-wmcs.novafullstack: Remove nrpe check and cleanup absent resources

c1d729eb90-+-C:cpufrequtils: Exclude VM from cpufrequtils

c3569bb1ce-+-mariadb: Move db1107 to s1

598119fc00-+-elastic: bring new hosts into elastic cluster

9843300dba-+-mediawiki::php: standardize pool names (3/3)

92bbc88e78-+-mediawiki::php: standardize pool names (2/3)

5194360980-+-mediawiki::php: standardize php pool names (1/3)

a0e87f3e7e-+-P:Docker::Engine: Default to installing docker.io

508b2db1ae-+-P:systemd::timedated: exclude /mnt from accessible paths

560112d392-+-mariadb: Promote db1183 to m5 master

dd16cbfd1b-+-klaxon: Switch to systemd::sysuser

bebc837ccb-+-imagecatalog: Switch to systemd::sysuser

029c399520-+-installserver: Remove support for pre buster

61966fa76a-+-varnish::common: Remove support for Stretch

618b87492f-+-Remove upstart configs in /etc/init/

7e8d52b339-+-graphite: properly shut carbon-c-relay

760a5fc5bc-+-druid: Fixed UID/GIDs are universally in use now

eea94b0af5-+-proxysql: Remove support for Stretch

a6a308e8b8-+-Remove zookeeper_version

d0ccc261b8-+-mariadb::config: Remove old tmpfile hack

7c8c79729c-+-Stop reporting releng images to debmonitor

74f1fd12e8-+-routinator: Switch to systemd::sysuser

72646d8445-+-phabricator: Reintroduce script to ensure correct config ownership/perms

faf4088d45-+-prometheus: fix/invert comments about matching in blackbox monitoring

cc7750d210-+-bacula: Fix backups with custom jobdefaults

a8795954e7-+-bacula: Fix old references to old pools

659e05e8f6-+-bacula: Migrate production backups from backup1001 to backup1009

e705ab51a8-+-bacula: Add new hosts backup1009 & backup2009 as new storage servers

98a9d0e3a2-+-C:mediawiki::packages::fonts: match conf and class ensures

32eb393b5a-+-bacula: Migrate new database dump long term backups to backup[12]008

27cc15886c-+-Revert "C:mediawiki::packages::fonts: Install fontconfig-config"

46f1a84422-+-C:mediawiki::packages::fonts: Install fontconfig-config

6e64907d7f-+-Remove backy2 backups from cloudvirts

6ed54f9487-+-bacula: Setup backup1008, backup2008 as new database backup storage hosts

d686a91fee-+-role::ci::master: remove admin dependency hack

67932b9551-+-trafficserver: Set action=never-cache for caching=websockets|pipe

820ee2275d-+-mariadb: Move db1183 to m5

c436b14aec-+-mariadb: Promote db1159 to m3 master

2bb3e67f0d-+-elasticsearch::tlsproxy: Unconditionally disable ssl_ecdhe_curve

5eca5b0cb5-+-Exclude /mnt from systemd-logind restrictions on Bullseye and later

ce69ab58ac-+-apifeatureusage: Temporarily remove index template during 6->7 transition

c20bbb6539-+-netmon: Add the wikidev group for the rancid directory.

59e0a06dfe-+-admin: set shell to undef if user is removed

3ec4195f07-+-P:gitlab::runner Remove docker_version parameter

742a8d5894-+-Netbox: only keep 2 days of hourly DB dumps

fbc0d2ea6d-+-R:profile::docker::engine::version removal and cleanup

7ad1c2b12f-+-Add cloudcephosd1030 to the Ceph pool

4c145f96fb-+-mediawiki: fix fresh install

3b06d1cff4-+-Schedule image suggestions notifications

2ce6e5ee5b-+-Spicerack: add prettytable for peering cookbook

1285b1df4a-+-xenon: Switch to systemd::sysuser

f39944659d-+-profile::maps::tlsproxy: Unconditionally disable ssl_ecdhe_curve

085941fccc-+-site.pp: Add db1196-db1203 to insetup

dae8593262-+-Apply scaling_governor=performance to MediaWiki servers

b93a26cb62-+-mediwiki/initsitestats: change time of day to run initsitestats

7def73ced8-+-wikistats: run updates of WMF-operated wikis earlier in the day

301e5f7946-+-netmon: Rotate logs as the www-data user and librenms group.

b91af55f52-+-parsoid: Install parse1* servers with only php 7.4

d33c158b2d-+-restbase: add restbase103[123]

05701421e9-+-mariadb: Move db1159 to m3

22308bfcb7-+-mariadb: Promote db1164 to m2 master

cdff9c20ae-+-memcached: adapt values to bullseye

d24c04d042-+-mc-wf*: install memcached

7a99cb7373-+-role::memcached: simple memcached role

e774381225-+-httpbb: remove absented file test_search

f8c4864f74-+-httpbb: drop tests for search.wikimedia.org

93d37a94d8-+-httpbb: Add $ensure to httpbb::test_suite

429053cb98-+-netmon: Use systemd::sysuser and reserve id for the LibreNMS user.

d85b821eba-+-c:spamassassin remove cronjob, and use systemd timer

1240d49b2d-+-openstack: keystone: enable app credentials on codfw1dev

769dac48dc-+-C:profile::docker::storage removal and cleanup

7d748aca00-+-mariadb: Fix host db2130 removed from puppet by mistake

56b534b863-+-ml-serve: cleanup profile::docker::storage

b7b636996a-+-kubernetes: cleanup profile::docker::storage

9475ee46ae-+-ml-staging: cleanup profile::docker::storage

a85fb7541e-+-kubestage: cleanup profile::docker::storage

4ea2447693-+-P:toolforge:k8s:haproxy: increase 404 handler timeout

b6733acae4-+-P:dumps: remove ipv4/ipv6 separation from internal_rsync_clients

b0085dd1e6-+-doc: Fix smalll typos in the systemd::sysuser documentation.

4625ad94c4-+-Remove refs to cloudservices1003

2e7938ebe0-+-Add systemd timer to run scap stage-train on Tuesday morning

93eef92761-+-wcqs: enable proper URI schemes for commons

301e4bf92c-+-Add cloudcephosd1029 to the Ceph pool

f86b23fc86-+-Enable the dse-k8s-worker nodes

6ce0c419ef-+-site.pp: Fix db1194 location

e7bea571e0-+-site.pp: Remove insetup from db1194

90644ce8aa-+-mariadb: Productionize db1194

c10a9f46b2-+-site.pp: Remove db1193 from insetup

828344559a-+-mariadb: Move db1164 to m2

8ad28d97bd-+-c:spamassassin debug alerting on Spamassassin timer.

1468100c6e-+-mariadb: Productionize db1193

650fa84d34-+-mariadb: Promote db1195 to m1 master

b5a3f7d288-+-mariadb: Productionize db1192

ca07852f16-+-c:dynamicproxy clean up after cronjob removal.

b99f95c67d-+-site.pp: Remove insetup from db1185

34cdd226a6-+-mariadb: Productionize db1185

dc35535049-+-Replace cloudservices1003 with cloudservices1005

6fa9ba16fc-+-Revert "c:spamassassin move Spamassassin updates from crontab"

20641406ac-+-logstash: w3creportingapi to use logstash-managed index pattern

e57014d499-+-logstash: use puppet dlq version and revision for index pattern

0e57c97fc1-+-logstash: dlq use logstash-managed index pattern

14e099e17d-+-Make Cloudservices1005 a designate node

e3f26d7ed3-+-beta-logs: w3creportingapi to use logstash-managed index pattern

b12aae5de4-+-beta-logs: dlq use logstash-managed index pattern

819446360d-+-c:dynamicproxy fix wrong interval format to systemd timer

0fff9c8986-+-Enable the LVS realserver profile for dse-k8s-ctrl

c3fb8cafaf-+-c:dynamicproxy move cronjob to systemd timer.

522a57cb47-+-define osm::planet_sync Remove invalid cron times

c3de460b7f-+-define osm::planet_sync move from cron to systemd timers.

20cc904f7f-+-c:raid::md move from crontab to systemd timer

1ed56fda3a-+-grid:exec: cleanup /tmp of stale files

c281d89188-+-site.pp: Remove insetup from db1191

d9a91e0ba2-+-Add cloudcephosd1028 to the Ceph pool

a31ffbd8c4-+-site.pp: Fix db1191 section

0e5be4d8b5-+-mariadb: Productionize db1191

7888e7e0df-+-site.pp: Remove insetup from db1190

733ae0dea2-+-mariadb: Productionize db1190

7cc1ae6ea6-+-site.pp: Remove insetup from db1188

208a7da5c6-+-site.pp: Remove insetup from db1186

885ad1f514-+-mariadb: Productionize db1188

913a8657e5-+-mariadb: Productionize db1186

d4395b649c-+-netmon: Configure Logrotate for LibreNMS logs

f4576d11e2-+-mediawiki: Rename sharded_periodic_job's `command` param to `script`

db169540e3-+-Add profile::mediawiki::sharded_periodic_job

3e7c255632-+-mediawiki: Split updateSpecialPages.php job to be per-shard

c7dcc3a7ba-+-dnsrecursor: Remove support for stretch

c9a384f083-+-Add cloudcephosd1027 to the Ceph pool

981f10de80-+-c:raid::perccli add PowerEdge RAID Controller monitoring to Icinga.

1bd7d4aed4-+-site.pp: Remove db1189 from insetup

e41d2cdb35-+-openstack.galera: add nodecheck logrotate config

67f978bde0-+-p:ceph::osd: get the os disks by size

b0526003f8-+-Remove few usages of ge('stretch')

c6a3238011-+-Absent libsnmp30 on bullseye hosts

f8adcfa4ff-+-puppet_compiler: relocate to /srv/jenkins

5fb5a01310-+-mariadb: Productionize db1189

aab16d3ed5-+-Disable Ganeti cluster rebalances temporarily

f3f71874df-+-site.pp: Regex for dbs insetup

8ab5072a8c-+-mariadb: Productionize db1187

aaf8d72543-+-Run the initsitestats period job on a daily basis

7c63990b7e-+-vrts: Always install the latest version of libdatetime-timezone-perl

083490d7dc-+-spamassassin: fix spamassassin_updates script name in timer

95fc008e04-+-c:spamassassin move Spamassassin updates from crontab to systemd timers.

6e4d6f59c9-+-Add mc-wf200[12] to site.pp

80479b9579-+-Openstack Trove: remove some file resources no longer needed in X

4c8a244843-+-wmflib: introduce pythonloglevel type

3316a01008-+-P:systemd::timesyncd: will need to remove the following fill after merge

d5e448f38b-+-P:systemd::timesyncd: exclude /mnt from accessible paths

df4ad8c975-+-admin: Correct spelling additional_shells

2de9ec9e2e-+-C:admin: when creating users make sure we add a dependency on the shell package

b011aab9f1-+-C:prometheus::ipmi_exporter: only listen on primary address

55b99d39a0-+-site.pp: Remove insetup from db1195

2355fd067f-+-Add the necessary configuration to enable the dse-k8s control plane

23cd458911-+-trafficserver: Set transaction_active_timeout_out on cp4026 and cp4032

c0d51ee127-+-C:scap: use in clude scap vs require

7f8f451396-+-mariadb: Productionize db1195

3270bc8ff1-+-Factor out x2 per-host hieradata into an objectstash role

8189f3b833-+-Neutron: add manifest for Xena services

c19045c818-+-Add glance manifest for Openstack Xena

a9ee711306-+-Add manifest for openstack Placement service, version Xena

da2749407a-+-Add manifests for Openstack Nova version Xena

4b08a5f369-+-Add manifest for openstack barbican version Xena

9c7ef5919e-+-Add manifest for Openstack Heat version Xena

85b141f5d1-+-Keystone: replace file overlay with patch file for Xena

b442e25b1a-+-Keystone: add manifest for Xena

6f29a02546-+-Openstack Trove: replace file overlays with patch files for Xena

a872e72987-+-Add manifests for Openstack Cinder Xena

9f938a8bea-+-Add manifests for openstack Designate version Xena

fc8cdfa7b6-+-Add Magnum manifest for OpenStack Xena

c434b38dee-+-Add openstack client package manifests for Xena

8529313433-+-Add openstack serverpackages manifest for Xena

be79b2162c-+-phabricator: make IP addresses for vcs optional parameters

5ed3b8def9-+-Revert "Revert "site: add phabricator role to phab2002""

610ad3e1e8-+-phabricator: avoid duplicate declaration mixing group{} and systemd::sysuser

a2466c6f46-+-P:openstack::codfw1dev::db: support TLS

98190e2457-+-Add kubernetes202[34] to site.pp and netboot.cfg

a971118c6b-+-C:vopsbot: correct data dir permissions

6c10f1e0cb-+-R:systemd::sysuser: drop managehome parameter as it dosn;t work

3d75858c1a-+-service: use --env-file for docker

fba0837170-+-site.pp: Remove insetup from db2181 and db2182

1f76901ae8-+-mariadb: Productionize db2182

1e4ed03bf6-+-mariadb: Productionize db2181

425887917f-+-phabricator: remove phab_deploy_ensure_config_ownership.sh

1abc2fc594-+-Add missing airflow service users to yarn's production queue

3b7e3e7c14-+-C:rancid: Drop unneeded dependencies

4a2e51f0db-+-netmon: Set correct username/groupname mappings for LibreNMS

67392d539a-+-netmon: Set correct username/groupname mappings for Rancid

ff1c12a89c-+-netmon: Add the OpenSSH configuration file inside the rancid home directory

b8b2c12393-+-Add new profile::ceph::client::rbd_backy profile

c5a3b7f853-+-role::wmcs::openstack::eqiad1::backy: include profile::ceph::client::rbd_libvirt

2edc4457d0-+-Ceph OSD hosts: set mtu on both ifaces

ba7925484c-+-Add kafka-stretch200[12] to site.pp and to netboot.cfg

68827095c4-+-Provision cloudbackup100[34] to back up VM drives

3ca79d05b7-+-profile::ceph::client::rbd_libvirt: remove refs to old absented files

ab6c645b64-+-Add cloudcephosd1026 to the Ceph pool

5870b56bcf-+-site.pp: Remove insetup from db2180

c2a20c0205-+-mariadb: Productionize db2180

58689bee2c-+-pontoon: generate en_US.UTF-8 locale

519160d4c5-+-site.pp: Remove insetup from db2179

288b3b3586-+-mariadb: Productionize db2179

c4fb75eaae-+-Revert "docker_registry_ha: Authorize GitLab trusted runners using JWT"

5102b13cbf-+-jwt_authorizer::service: fix ensure parameter

0da21fd571-+-docker_registry_ha: Authorize GitLab trusted runners using JWT

8a04180e72-+-site.pp: Remove insetup from db2178

21be2f0057-+-mariadb: Productionize db2178

6ad9013954-+-phabricator: replace user{} with systemd::sysuser, only on new hosts

2ff5b43d1e-+-phabricator::migration: add phd with systemd::sysuser, reserve UID 920

835816ce60-+-phabricator: move lvs::realserver inclusion to profile, create use_lvs parameter

da1fe74c61-+-gerrit: $gerrit_servers > $ssh_allowed_hosts

211b54f91f-+-quickdatacopy: Added simple username/groupname mapping for the Rsync server

bbeda54a01-+-Add kafka-logging200[45] to site.pp

1e40bc3889-+-ci: enable docker on machine start

1a55b6d6a1-+-Add graphite2004 to site.pp

7013681d02-+-P:cache::varnish::frontend::text: make esitest ensurable and absent on cloud

b456b1bb4e-+-P:base::production: install prometheus::ipmi_exporter to buster

10ffa62cd0-+-C:trafficserver: Ensure we only instantiate the trafficserver class once

c66622e735-+-role::puppetmaster::standalone: Remove apache2 standard ports

3212eb6325-+-memcached: point to active/used configuration options

780e1732a4-+-airflow - Configure new platform_eng instance and rename old one as legacy.

9053e3b486-+-kubernetes::mediawiki::releases: allow scap users to write releases files

92a67b5251-+-ceph: use many cluster and public networks

8ad69b0f6c-+-C:ferm: fix minor lint issues

ccddcc5d8b-+-P:base::firewall: use reload instead of restart

2e1a963fbf-+-vopsbot: fix yaml escaping of #

f4a0f6c91a-+-vopsbot: make team, vo_admin optional for users

8f37a86a00-+-vopsbot: brown paper bag fix

ed931996af-+-role::alerting_host: run vopsbot

a8e6e588c4-+-Revert "site: add phabricator role to phab2002"

928496d0fe-+-site: add phabricator role to phab2002

9ced75d61c-+-logstash: update production w3creportingapi guard condition

a7372056ed-+-phabricator: make it possible to globally enable/disable vcs setup

68bd0cce6f-+-clouddumps: don't puppetized '/srv/dumps' mount

e4060c4a0d-+-profile::mediawiki::deployment::server: Move stuff to class scap::master

e7c081bfde-+-profile::mediawiki::deployment::server: Populate /etc/scap/phabricator_token

d693b4522a-+-logstash: use logstash routing for w3creportingapi stream

ccfb204b92-+-Give clouddumps100[12] access to hdfs and rsync things

3f040e7c22-+-Revert "clouddumps100[12]: move back to 'insetup'"

50fcf5cbcf-+-netmon: Create the OpenSSH directory inside the rancid home directory

a884d95bbd-+-Add git-review package to profile::mediawiki::deployment::server

9f24407916-+-P:openstack::cumin::target: remove port forwarding support

cc62b1fef1-+-clouddumps100[12]: move back to 'insetup'

699c6e1083-+-swift: move swift ring manager repo

5983f3d061-+-profile::openstack::base::designate::firewall::api: add a missing )

06bb6fb78c-+-P:openstack: misc cleanup for non-tls ports

6085cf0c31-+-P:openstack::designate::firewall: cleanup

637d5b38be-+-P:openstack::haproxy: eqiad1: remove non-tls ports

cc5d981ea5-+-P:openstack::haproxy: codfw1dev: remove non-tls ports

6da6507c97-+-openstack::nova: monitor the backend port

5b8c5f19d1-+-openstack::cinder: monitor the backend port

7b14d4d6f5-+-P:openstack::glance: tidy up monitoring params

5681acb38e-+-profile::openstack::codfw1dev::db: update ref to wmf-mariadb104

639538babf-+-profile::openstack::codfw1dev::db: install wmf-mariadb104

e0ad20d453-+-Add netmon2002 to site.pp

c99748cc5d-+-Remove references to cloudcontrol2003-dev

f1f2ef784a-+-Move cloudcontrol2003-dev to role::spare

5b63d457c7-+-Make cloudcontrol2005-dev a cloudcontrol node

4f6daf617a-+-phabricator: Support scap3 deployment of configuration

7b9dcbced5-+-phabricator: Support scap3 deployment of configuration

537208059b-+-Add new PDU model for ps1-c8

5ad587de18-+-clouddb2002-dev: make a db node

47298ba860-+-analytics:refinery:job:data_purge: Improve drop-webrequest-sequence-stats

6c326ddeb5-+-C:ferm: add o+x permissions to ferm directory

f5dd202051-+-Use proxy for wikifunctions beta blackbox probe.

622577c741-+-Remove puppet refs to cloudcontrol1003 and cloudcontrol1004

f65caacba3-+-C:ferm: allow useres to read config files, needed for nrpe

974efdb1e0-+-C:postgresql::slave: update recovery configuration

9e53c3a4d6-+-Add proxy_url to prometheus::blackbox::check:http as a parameter.

734e6ace51-+-P:base::firewall: use either etc or abuse_nets

52e5a75f47-+-p:ceph::osd: also install the ceph-osd package

810bd1b595-+-p:ceph::osd: bring the cluster interface up

93fa5106d1-+-p:ceph::osd: add the routes only after the interface

96fa3a4b87-+-Add new PDU model for ps1-d[4-8]-codfw

a23f568439-+-elastic: allocate psi vs omega for new hosts

f0ea047b94-+-cloudcontrol100[34]: move to spare role

01205eaffd-+-role::wmcs::openstack::eqiad1::control: remove rabbitmq

4bd21895a0-+-Openstack Glance: monitor service on all nodes

2dab8e3fdc-+-gitlab_runner: Remove support for stretch

03f955fccb-+-Remove puppet refs to labweb100[12]

4474a8fc1a-+-site: remove gerrit2001, merge gerrit1001/2002 regex

28a3345e97-+-analytics:refinery:job:data_purge: Add --allowed-interval to deletion jobs

38c411ddc6-+-Use specific etcd intermediate CA to generate etcd certs in PKI mode

375972ae2e-+-Revert "P:sretest: test behaviour of empty define"

5204748e72-+-P:sretest: test behaviour of empty define

11b174f0da-+-Move cloudweb100[12] to role::spare

e679fc3acc-+-P:base::firewall: add file definition

00e59f698b-+-P:base::firewall add confd prefix

7fd2ffea0f-+-P:base::firewall: enable defs on sretest

12ae2aebf7-+-P:firewall: add if gaurd back

af4f2cc2d1-+-P:firewall: fix if clause

6bc0327307-+-P:base::firewall: Add requestctl definitions to ferm

97773bf2b6-+-Add cloudcephosd1025 to Ceph pool

1f9dff6121-+-Use the chained certificate for the etcd cfssl option

03516dd3fc-+-wdqs: bring more hosts online

af62ab2fcb-+-Change the output directory that cfssl uses for etcd

e5b8c81580-+-P:ldap::client::labs: support multiple restricted_* groups

78bb81106a-+-Stop checking codfw for wikidata/wdqs max lag detection

862cbfd188-+-Change ownership of etcd certificates for cfssl usecase

c7319d3a97-+-Bootstrap etcd on the dse_k8s_etcd cluster

fdca1b8bd2-+-novafullstack: remove leaked VMs test, moved to alertmanager

b4ac0e9bf8-+-Revert "Puppetize spark3 installation and configs using conda-analytics env"

d2d05807df-+-abstract-wikipedia alert: increase timeout; correct team name

4d66b9ef3e-+-Fix the spark3 profile

1ed7466239-+-Puppetize spark3 installation and configs using conda-analytics env

2adbd05fdf-+-Add puppet profile and role files for WikiFunctions.

b55729fb2e-+-ceph:osd: add support for multi-network setup

6a12dae3ee-+-Netbox: remove Puppet config related to CSV dumps

3352a3dd8f-+-prometheus: Add icmp blackbox check

148db719d4-+-Netbox: remove CSV dump directory and timer

c7a8732edd-+-mariadb: Decommission db2079

4e6c255f34-+-Netbox DB dump, hourly on secondary, daily on primary

e3bafc6286-+-Netbox: add housekeeping systemd timer

a8f0f5dd4f-+-Netbox: add hourly postgres backups

daefc71b7f-+-mirrors: also serve Tails with rsync

a3197675e8-+-vo-escalate: actually run every 15 seconds

4bb5c39aeb-+-Fix sysuser config for mediabackup worker

0e3ba985c4-+-mediabackup: Switch to systemd::sysuser

0900678b2d-+-geoip: Remove support for stretch

ac6eb92b6e-+-puppetdb: Remove support for stretch

41e4ad716d-+-C:package_builder: Allow users to add a specific component to the build

1407d8a93a-+-wmflib:: new Wmflib::Dns:Srv type

60c109e8ea-+-lxc: Remove support for stretch

e9298a2780-+-sbuild: Remove support for stretch

36ae2d4c9f-+-ircecho: Add SPDX headers

71d197185b-+-maps: Remove support for stretch

3983f56056-+-Revert "Switch back to the new cloudrabbit1xxx nodes and switch nova to TLS"

c2de5ca010-+-Switch back to the new cloudrabbit1xxx nodes and switch nova to TLS

2352f7e0cd-+-Add new PDU model for ps1-d3-codfw

b4c0f63054-+-Add new PDU model for ps1-c2,c4,c5,c6,c7,d2,d3

fcc627a1d0-+-profile::openstack::eqiad1::rabbitmq_nodes: switch to only cloudcontrol1005

3b4c2c1775-+-Remove rabbitmq profile from cloudcontrol nodes

4c0ee6b872-+-Trove: fix copy/paste error with trove_guest_rabbit_pass

5692384a98-+-sysfs: Add SPDX headers

92d74343ef-+-hieradata: switch traffic to cloudrabbit1001-3

2304cf8c01-+-jwt_authorizer: Provide microservice for JSON Web Token authorization

498a7e27fd-+-P:etcd::v3: fix typo

b0ed942337-+-mariadb: Decommission db2089

f877a511fc-+-Add an option to use the PKI for etcd intra-cluster certificates

2c00ea0abb-+-site.pp: Combine mariadb replicas and master in each section

579db8bac1-+-phabricator: Provide script for ensuring correct config file ownership

42107ab97f-+-phabricator: Stop managing /srv/phab/repos

ad39479f1b-+-Add new pdu model for pdu in rack b3 b6-b8 and c1

6db867e11d-+-netmon: Open firewall port to connecto to the LibreNMS database.

f94b9e3271-+-extra ips for codfw1dev

a6dfd6174b-+-scap: add option to selectivlely disable bootstrapping

531f872744-+-puppet::ssl: update private permisions not public

82089b215d-+-C:puppetmaster::ssl: ensure we generate the ssl certificate

c62ddcc924-+-klaxon: run VO escalation of unpaged incidents

c1809636b8-+-site.pp: Remove insetup role from db2176

7783029802-+-mariadb: Productionize db2177

1ea5b65640-+-Add DHCP details for an-airflow1004

2e3dc22a06-+-mariadb: Productionize db2176

2511b319db-+-site.pp: Decommission db2090

66d664492f-+-mariadb: Decommission db2072

26c5008e57-+-Add new PDU model

deab7d73de-+-gerrit: switch gerrit2002 from gerrit:migration to gerrit role

03ba943169-+-site: Add mc2038 as mediawiki::memcached

b75bebdd57-+-deployment::server: add comment about usage of benchmarking tools

c7be95a444-+-striker: remove legacy deployment

f61443451c-+-statistics::wmde::graphite: add max_runtime_seconds

806b70a77d-+-puppetmaster2004: move to puppetmastr::backend role

c97cb88754-+-P:adduser: apply adduser before any packages are installed

5c216dd45e-+-Revert "P:adduser: apply adduser before any packages are installed"

e305c4c2b9-+-Add roles and cumin aliases for the new dse_k8s cluster

f67b662212-+-P:adduser: apply adduser before any packages are installed

3633fa3781-+-ulog: ensure package is installed before trying to start the service

196b31f1ec-+-site.pp: Remove insetup from db2175

3804fe40de-+-gitlab_runner: fix re-registration issues

6324857955-+-P:gerrit: add ipaddress to host_aliases

49ce474313-+-tilerator: Add SPDX headers

e14a24c228-+-Revert "deployment_server: remove packages wrk, siege and lua-cjson"

b1a2375a12-+-osm: Add SPDX headers

4465f92394-+-scap: enable target bootstrap in beta cluster

588bb64e7f-+-c:ganeti::prometheus Enable Prometheus exporter for Ganeti on Buster

7923a3b6eb-+-scap: allow `scap` user to login into deployment-prep scap targets

58ba48f288-+-swift: add script to grow the SSD partition for container databases

b80b61e96a-+-mariadb: Productionize db2175

682e1894b7-+-db2088: Decommission

ad0b654adf-+-librenms: Collate PHP packages used in bullseye and buster

0a55ff54bf-+-librenms: Install PHP packages via the meta packages

6cee0ec2dd-+-librenms: Remove support for Stretch

bb20e577c2-+-smart: Add SPDX headers

68b3288ccd-+-rsync::quickdatacopy: Allow specifying a custom interval for auto_sync

394654b9c3-+-gitlab: add gitlab role to gitlab2002

91172f732b-+-P:gerrit: Export sshkey for gerrit shared services

2c0629683d-+-trafficserver: 9.x upgrade: add compatibility for session_sharing.match

51805796b4-+-phabricator: use migration role for pre-syncing data

8156d8ec89-+-cloudrabbit hosts: add service names to rabbit certs

47f10d7541-+-puppetmaster1004: move to puppetmastr::backend role

e7a109b22a-+-C:trafficserver: filter out logs without ensure == present

1a24457bf8-+-C:trafficserver: build yaml structure in puppet instead of erb

d444e551e4-+-site.pp: Remove insetup from db217[3-4]

c8ef76f906-+-mariadb: db2072 no longer sanitarium master

3a02b7afc4-+-gerrit: turn gerrit2002 into a gerrit migration dest host

537b3dac38-+-trafficserver: 9.x upgrade: install ATS 9.x from component

896b02c95a-+-Remove mentions of conf100[456]

0df694ab7d-+-trafficserver: 9.x upgrade: replace client.verify.server

76355798ee-+-trafficserver: 9.x upgrade: switch ip_allow.config to YAML format

0ba1f26d83-+-P:prometheus::openstack_exporter: fix executable permissions

1772741a40-+-trafficserver: 9.x upgrade: rename max_connections_active_in

21350620ed-+-P:ssh::client: use more modern functions for collecting sskey

8492f72675-+-mediawiki::webserver: fix non-default routing

a8a777fb0b-+-varnish: enable query-sorting in production via X-Wikimedia-Debug

0f36dbc16b-+-mediawiki::webserver: fallback php version for webrequests

8e02cc996e-+-site.pp: Promote db2144 to x2 codfw master

2b66aa3aa6-+-Decom mw2251-2255,2257,2258

7593345716-+-Openstack Nova: typo fix for cell db name

59a6ecb65e-+-OpenStack nova: pregenerate db grants for cell 0

1fbcfa6fc4-+-Remove kafka alerting class

9417c35714-+-site: install rabbit on cloudrabbit1001-3

35e8fc78ec-+-P:openstack::trove: use new rabbitmq_hosts hiera var

9c03aea5ae-+-Add role::netmon to the netmon1003 instance.

d0c897e312-+-prometheus: remove traffic_drop alerts

6823f70fda-+-Icinga: Remove traffic alerts

49571f75e1-+-P:openstack::designate: use new rabbitmq_hosts hiera var

52e7b9644e-+-P:openstack::cinder: use new rabbitmq_hosts hiera var

9e6458684e-+-mariadb: Productionize db2174

8885484871-+-mariadb: Decommission db2087

1fe1f8ee49-+-mariadb: Productionize db2173

1348553a54-+-prometheus: update blackbox check alerts runbook link

e50ef2c447-+-gitlab_runner: Handle changes to runner config

0d221bb742-+-site.pp: Remove insetup role from db2172

f18f5d8d15-+-mariadb: Productionize db2172

0edc350f9d-+-mariadb: Promote db2161 to s8 codfw master

4bd3d25547-+-mariadb: Decommission db2086

a81418907a-+-elastic: decom elastic2049

089a77ec24-+-prometheus::blackbox::http: add/edit parameter comments

a4ac6acce8-+-netmon: Add suppport for multiple backup/passive nodes in Puppet

d4f6c66a80-+-P:puppet::agent: Add parameter to install puppet-agent 7

c97baa72f5-+-ores: Increase uwsgi request buffer size to 8192

d09b747870-+-site.pp: Remove insetup from db217[0-1]

7243ec939b-+-O:prometheus: drop old absent file

ff73ce639f-+-mariadb: Productionize db2171

506dde0e24-+-netbox::host: adapt to new Netbox data

2bdb9c32f7-+-mariadb: Decommission db2085

b7cd5f48f4-+-mariadb: Productionize db2170

eac5e68b7d-+-Revert "P:ssh::client: use more modern functions for collecting sskey"

f42604d8bd-+-varnish: Enable ESI for /esitest-fa8a495983347898/includer

2792c622f0-+-cache::text - include esitest service

9bdd7fd628-+-esitest service for cache nodes

5d992d026c-+-P:ssh::client: use more morden functions for collecting sskey

cbf73ce373-+-httpbb: also add the new jobrunner tests in production

6d2ca7f571-+-prometheus::php_fpm_exporter: remove from puppet

57b8424bd8-+-prometheus::php_fpm_exporter: absent in production

f038dd4a61-+-C:package_builder: add gem2deb required to build puppet7

d737f26230-+-iegreview: Add SPDX headers

b975b8ad47-+-alertmanager: Add SPDX headers

7b271bc2ba-+-facilities: Add SPDX headers

8b3f713c46-+-pmacct: Add SPDX headers

efba33fb90-+-librenms: Add SPDX headers

3822a54f6a-+-site.pp: Remove insetup from db2169

6892009660-+-apifeatureusage: Write using the _doc mapping type

f28d1fba35-+-openstack::nova::compute::service: don't add 'nova' user to libvirt group

a2347bdb66-+-elastic: enable elastic20[64-72] cirrus roles

dea279008e-+-Put cloudweb100[34] into service

2316e93fef-+-prometheus::php_fpm_exporter: allow absenting the class

e54217d074-+-Adding new db servers to site.pp

d028611089-+-wmcs: don't page for most checks

9a02002d6e-+-mariadb: Decommission db2078

05360d7497-+-P:varnish::common: Add support for passing wikimedia_domains

ec603b6eb2-+-prometheus: default server_name to hostname in tcp check

a478ef8bc3-+-mw_rc_irc: check ircd availability with blackbox prober

132db90ecd-+-phabricator: switch to prometheus-only network probes/checks

f19db52bb1-+-mariadb: Promote db1103 to x1 master

1cab30989a-+-mariadb: Promote db1136 to s7 master

651203e475-+-logstash: add missing closing curly brace

aed6c209e3-+-logstash: enable pipeline-managed index patterns

b6faa4581e-+-elastic: bring 3 hosts in for extra capacity

231b169fa3-+-Revert "striker: Open firewall for Docker-managed service"

177c1b40e4-+-Keystone: fix sync_time for copying fernet keys

33c05e0838-+-Revert "P:varnish::common: Add support for passing wikimedia_domains"

7372f954a4-+-P:varnish::common: Add support for passing wikimedia_domains

216defd366-+-role::beta::docker_services: prune docker images

2b04559f07-+-prometheus: fix blackbox timeout Pattern

425c94160d-+-rabbit: introduce the heartbeat_timeout param and double

90c7a1df11-+-syslog: probe TLS endpoint with blackbox

3de6a6274a-+-prometheus: adjust blackbox check params/types

9592397aef-+-prometheus: add blackbox TCP check

1d326512cd-+-prometheus: use protocol in blackbox target files

7365d189e5-+-mariadb: Productionize db2169

3d069aa53c-+-site.pp: Remove insetup from db2167,db2168

ca1ccbce46-+-Glance: reduce number of api workers per host from 8 to 2.

93ea39a13e-+-vrts/prometheus: fix IP family name, ip4 not ipv4

96b8526c07-+-vrts/prometheus: configure monitoring to use only IPv4

498df3891e-+-Openstack Nova: install the uwsgi.ini files into /etc/nova

3d015f2d5b-+-nova: properly configure the number of api and metadata-api workers

dc56af5070-+-vrts/prometheus: fix path in blackbox http monitoring check

3e3285ce9d-+-lists: add apache security configs

00ae578263-+-Revert "vrts/prometheus: comment out broken check"

122516b013-+-lists: convert apache template to epp

10be6560f3-+-P:openstack::{nova,neutron}: use new rabbitmq_hosts hiera var

229352c6ee-+-O:openstack: prepare for dedicated rabbit nodes

1c9a68bab9-+-core.pp: Make sync_binlog and trx_commit configurable

131114d2e4-+-logstash: enable loki public output on production

e817eb9b82-+-icinga: set 'instance' for commons probe

561ff2d4c9-+-Revert "gitlab_runner: Handle changes to runner config"

b62b9cc170-+-gitlab_runner: Handle changes to runner config

cb94c9707e-+-mariadb: Productionize db2168

da275f2bc9-+-Remove Netbox 2.10 hosts from Puppet before decom

41ab151e14-+-diffscan: Add SPDX headers to diffscan profile

5608044950-+-debdeploy: Add SPDX headers to debdeploy profile

984caa6598-+-dbbackups: Add SPDX headers to dbbackups profile

a19d646e86-+-cumin: Add SPDX headers to cumin profile

d32c989c4b-+-conftool: Add SPDX headers to conftool profile

46c6296a93-+-codesearch: Add SPDX headers to codesearch profile

7bc35fa03d-+-chartmuseum: Add SPDX headers to chartmuseum profile

8c00aa0358-+-certspotter: Add SPDX headers to certspotter profile

345c8848b0-+-cassandra: Add SPDX headers to cassandra profile

dd7621fc7b-+-mariadb: Decommission db2084

30ce51de11-+-Install nova on new cloudvirt hosts

27a005eafc-+-profile: make loki data directory configurable

a95ca9323d-+-Make cloudcontrol100[67] into live cloudcontrol nodes

3c1205cc86-+-Keystone: rearrange how service domains are configured.

886c5a3f1c-+-tcpircbot: Add SPDX headers

45038ec147-+-P:postgress::database: add docs and fix minor lint issues

5f90658e36-+-mariadb: Productionize db2167

59960288b2-+-ganeti: Add SPDX headers

1c6a3a30a8-+-calico: Assign SPDX headers

960e9f90e3-+-P:toolforge::proxy: raise rate limit + add hiera config

696fbd191e-+-dynamicproxy: urlproxy: add a simple rate limit

7e506bfa4f-+-bird: Add SPDX headers to bird profile

20befeb258-+-base: Add SPDX headers to base profile

935d42fdbc-+-archiva: Add SPDX headers to archiva profile

b3f036ca95-+-aqs: Add SPDX headers to aqs profile

5006322590-+-apt: Add SPDX headers to apt profile

44af0d1fd0-+-alertmanager: Add SPDX headers to alertmanager profile

2c2caefa77-+-airflow: Add SPDX headers to airflow profile

30fb167eb3-+-prometheus: blackbox_exporter: remove un-managed module files

88d30593d1-+-admin: Add SPDX headers to admin profile

5bfd51b4c5-+-acme_chief: Add SPDX headers to acme_chief profile

00121de2fe-+-rancid: Assign SPDX headers

65c06bd2b7-+-mariadb: Remove db2082 from puppet

6816c8bcee-+-updating site.pp for cloudweb servers, setup incorrectly for private vlan

c43aa46c1d-+-site.pp: Remove db2166 from insetup

6ea4cf322c-+-mariadb: Productionize db2166

4e094df517-+-klaxon_config: add esc_policy_ids_filter to type definition

05bbb7c292-+-Refine WikibaseTermboxInteraction schema using eventlogging_legacy job

9b93b4ff2a-+-Adding cloudweb1003/4 to site.pp and netboot.cfg

4507111a58-+-Add new PDU model for ps1-a6-codfw

e2903bb3de-+-Remove systemd241 Stretch backport

728497d049-+-site.pp: Remove db216[2-5] from insetup

33a8d3f4f0-+-Remove trailing check_promethus checks for hadoop

411db7e759-+-Remove more alerts that have moved to alertmanager

c69583a1b0-+-P:toolforge:k8s:haproxy: add k8s-ingress monitoring

a3194582f3-+-P:toolforge: update web_domain default value

1243da3030-+-prometheus: blackbox: add support for matching status codes

1d04dd0a20-+-initsystem: drop initsystem variable

15a9d7317c-+-mariadb: db2082 no longer sanitarium master

2f6a413a7b-+-idp: add spdx headers to idp role and profile

596ce5dd91-+-P:aptrepo: install python3-apt required by validate_cmd

6a85e6f4f2-+-P:toolforge::proxy: add blackbox monitoring

fb7b0ed9ac-+-Add new pdu model for ps1-a5-codfw

2f6fb44f66-+-novafullstack: generate prometheus stats too

1d9b970b79-+-P:toolforge: re-add blackbox monitoring for static

a5d2f161d9-+-P:toolforge::prometheus: drop clouddb-services jobs

4ac75a72c6-+-wmcs: remove ceph alerts, replaced by alertmanager

6a69905770-+-mariadb: Productionize db2162

40225c164b-+-icinga: fix ip addresses for commons.wikimedia.org probe

cbccd1eb62-+-wmflib: migrae all calls for puppetdb_query to wmflib::puppetdb_query

3550f6a32b-+-wmflib: create a helper function for querying puppetdb

053aff8c2e-+-P:debmonitor::client: make ensurable

96119e89fc-+-mariadb: Productionize db2164

deafbe5067-+-mcrouter: Add SPDX headers

198cfe1d0c-+-icinga: switch to prometheus-only probes for commons

abed5fffbf-+-opensearch: remove icinga::monitor::elasticsearch::old_jvm_gc_checks

afbff4a36e-+-mariadb: Switchover s3 master db1123 -> db1157

1b0fefb57d-+-wmflib: make wmflib::resource::import safe for puppet apply

1c9cc0ce55-+-puppet_compiler: bump version number

37648a11f7-+-P:base: dont use haveged in containers

b0fce1fc5a-+-base::firewall: add flag do disable managing nf_conntrack hashsize

0f75806a5e-+-P:environment: add dependency to vim package

544e960850-+-resolvconf: add parameter to disable managing resolvconf

b56e3e8ffa-+-varnish: use libvmod-querysort on Beta Cluster

793cbe8861-+-apparmor: Assign SPDX headers

0709403920-+-nrpe: move plugins off the base nrpe class

f53bed88da-+-mariadb: Productinize db2163

ca91c0909c-+-site.pp: db2078 no longer active misc host

fec3c278ed-+-mariadb: Replace db2078 with db2160

33c11754f6-+-prometheus: blackbox icmp probes for hosts

3d29bf3657-+-prometheus: add support to blackbox icmp probe hosts

3d6dab8a2d-+-Add PHP 7.4 dependencies for LibreNMS

ec8216541d-+-thanos: split retention times based on resolution

f37fd0d72c-+-mariadb: Decommission db2080

69257bf9db-+-mariadb: Decommission db2077

b8c8647b09-+-gitlab: for now, only monitor the active host, not the replica

d7d5c5837d-+-Drop the temporary ifdef before it turns two years old

1e9b983cb4-+-Remove Puppet references for deneb

e40e320cbf-+-Revert "P:toolforge::static: add blackbox monitoring"

616212a239-+-O:openstack: remove profiles no longer used

7feb7c28f1-+-P:toolforge::static: add blackbox monitoring

31637497de-+-mariadb: Decommission db2076

237489cadb-+-vrts/prometheus: comment out broken check

67617b980e-+-vrts/prometheus: fix monitored path, avoid redirect

d244296f8c-+-vrts/prometheus: set force_tls to true for check on port 1443

3f332a9db7-+-Revert "labweb: move striker, wikitech, horizon behind envoy"

54863a3a2a-+-labweb: move striker, wikitech, horizon behind envoy

e900b82203-+-doc: remove support for stretch, add support for bullseye

41ad902e15-+-Add new db nodes to site.pp

549f152dc6-+-site/DHCP: decom doc1001.eqiad.wmnet

cb8b293e99-+-P:vrts: fix probe port

28db7869cd-+-updating site.pp entry cloudnet1005-6

935d20236c-+-Adding cloudcontrol1006-7 and fix wmcs site.pp entries

2db3425f69-+-varnish: Enable Prometheus sysctl exporting

11eac7c149-+-mediawiki/releases: fix expected parameter format

db96337702-+-blackbox-check-http: only add hash page if severity=page

9dd55648e0-+-Fix profile::analytics::refinery::job::test::refine

038a34b2e9-+-Assign conf100[789] roles and add them to the cluster

41b206033a-+-bigtop::hadoop: All hosts use the new GID/UID scheme by now

98dfd19cb8-+-P:toolforge::prometheus: import blackbox checks from puppetdb

a45939e9fc-+-prometheus: blackbox: don't deploy tls alerts when tls is disabled

14f5c24c25-+-mariadb: Productionize db2165

a99004eb45-+-prometheus: blackbox: support exporting modules for other instances

413d93407a-+-mariadb: Decommission db2074

4b78bf912d-+-gitlab: fix IPs, hostname and regex for blackbox check

9446a83880-+-profile::rsyslog::kubernetes: Remove stretch support

b5d442d1f8-+-service_proxy: Set SNI and Host header for ingress services

4e1e08a480-+-site.pp: Remove insetup role from db2161

9c9e98f39b-+-mariadb: Productionize db2161

5c651dd41f-+-Switchover s4 master

536d04d00a-+-site/gitlab: remove gitlab1001, update comments

9907b6206f-+-adding new wmcs hosts to netboot.cfg

32df6d16a6-+-Add the new dse-k8s servers with the insetup role

2a195eb4d0-+-scap: make scap::target require the scap class

5ecab80957-+-openstack: horizon: remove enc url from hiera

ea172480b4-+-ores: Remove support for Stretch

eed3c0a5fe-+-P:metricsinfra::haproxy: add thanos routing

faada7b930-+-P:metricsinfra: add thanos query

e71e204f6a-+-P:wmcs::metricsinfra::prometheus: enable thanos sidecar

223b3406c0-+-site/hiera: remove gitlab2001 after decom

124474b64b-+-kubeadm: drop support for 1.20

7a5716bc2f-+-toolsdb: enable pt-heartbeat

45166eb747-+-Revert "profile::mariadb::packages_wmf: Remove support for stretch"

d3377d07c0-+-bacula::storage: Remove support for stretch

ee03ad5479-+-mariadb: Productionize db2160

94d8f6db9a-+-prometheus: switch to blackbox::module

fa5eea7f98-+-prometheus: introduce blackbox::module

786703993a-+-prometheus: move blackbox http check to prometheus::rule

2efc91c042-+-prometheus: deploy alerts as yml not yaml

ab8226183d-+-prometheus: deploy custom probedown alerts

9d489928f3-+-mariadb: db2077 no longer s7 codfw sanitarium master

cc0c4e5612-+-mariadb: db2076 no longer sanitariu master

f7179537d6-+-vrts: add promtheus blackbox monitoring

25a7641eb0-+-Add new PDU in row E Eqiad

77bdf8ca1b-+-prometheus: Add custom vm.max_map_count metric

da26fedc76-+-gitlab: switch gitlab2001 back to "insetup" role

6a3233472a-+-gitlab/prometheus: 'body_regex_matches' expects an Array value, got String

9f380a3c37-+-Revert "Revert "gitlab: add prometheus blackbox http monitor""

b27695ced8-+-kubernetes::master: Increase the apiserver latency thresholds

dc755734db-+-icinga: pass in ip4/ip6 addresses for commons blackbox

3c6c50db33-+-Revert "apt::repository: use signed-by instead of apt-key"

7b917286d9-+-Revert "uwsgi: Remove support for stretch"

5bb0a37f7e-+-apt::repository: use signed-by instead of apt-key

0b5b7a279f-+-bird: add validate_cmd for bird.conf

96e35de961-+-uwsgi: Remove support for stretch

169be8fa45-+-profile::mariadb::packages_client: Remove support for stretch

93bb9d9741-+-profile::mariadb::packages_wmf: Remove support for stretch

a261e10f2a-+-Remove obsolete profile::base::linux419

a46272c503-+-site.pp: Remove insetup role from db2159

77e718f09a-+-mariadb: Productionize db2159

9d5e6c7cc4-+-mediawiki/php: rationalize and order php-fpm installation

34b2a9f479-+-Revert "gitlab: add prometheus blackbox http monitor"

b5dcbbdbea-+-acme_chief: Add SPDX headers

80a8b1f455-+-mediawiki/php: forcibly upgrade php-common if installing php7.4

ac17630100-+-icinga: check commons.w.o with blackbox exporter

086c59fbf9-+-site.pp: Remove insetup role from db2158

70f2aeb911-+-mariadb: Productionize db2158

3ff70babe2-+-mariadb: db2074 is no longer sanitarium master

4cd868def4-+-mariadb: Decommission db2073

c0e561c704-+-Implement MediaWiki multi-DC traffic component

5ad930cee2-+-mariadb: Promote db1173 to s6 master

aaa348c73d-+-OpenStack Heat: configure creds for managing the 'heat' domain

17845b53ec-+-etcd: remove paging alert, moved to Prometheus

baf7f6190d-+-prometheus: disable protocol fallback for blackbox::check::http

6d6ecc552d-+-prometheus: probe DNS for (www).wikipedia.org

f9ceb2adb5-+-base: remove absented files

b68ae26a15-+-wmflib: remove distro conditionals from blackbox http module options

d3b7bd3a23-+-keyholder::monitoring: drop absented resources

87eb431bd8-+-mediawiki: add scap restarts script

a79b3c91d5-+-bacula::director: Remove support for stretch

a47617c428-+-P:aptrepo::wikimedia move private repo to nginx and uninstall apache

50bdc8df74-+-site.pp: Remove insetup from db215[6-7]

cd32cfa26a-+-mariadb: Productionize db2156

cd0fccfae7-+-prometheus::postgres_exporter: Remove support for stretch

876552ffca-+-graphite: Remove support for stretch

143c2ff22b-+-mariadb: Productionize db2157

7c371b745b-+-snapshot: Remove support for stretch

8e5258e783-+-mariadb: Decommission db2092

96cf5fdf5b-+-mariadb: Decommission db2091

93a7a1eb9e-+-mariadb: db2073 no longer sanitarium master

50f0352302-+-P:wmcs::nfsclient: remove ref to secondary_nfs_servers

2623e864c8-+-striker: Open firewall for Docker-managed service

3c9c449e37-+-haproxy/nova-api-metadata use the /healthcheck endpoint for health check

52c915dc2c-+-profile::parsoid::testing: Remove support for stretch

1801a7fa8d-+-profile::openstack::base::galera::node: remove old absented files

72b99773dd-+-Remove references to cloudstore100[89]

62f13ee223-+-P:toolforge: cleanup support for .wmflabs hostnames

3dea9eb0e3-+-prometheus: split blackbox-exporter logs into a file

8afcd1d6a5-+-keyholder::monitoring: remove source for absent nrpe plugin

712db264f7-+-openstack: remove unused check_ssl_certfile

d0ca4057f8-+-labstore: update monitoring for nrpe changes

f1fd1d8b15-+-mariadb: Productionize db2155

a8de103862-+-keyholder::monitoring: drop nrpe plugin

08fb0746e6-+-site.pp: Remove db2153-2154 from insetup role

e4980fe5a6-+-keyholder::monitoring: remove nrpe check

5fc7920f6e-+-cumin: Add SPDX headers

ee1fc7a334-+-jupyterhub: Assign SPDX headers

9381916e3e-+-uwsgi: Add SPDX headers

6448453359-+-mariadb: Add db2154 to s8

1bc77956e4-+-pdns_server: Add SPDX headers

46c810c377-+-certspotter: Add SPDX headers

3dea1aa1f3-+-mariadb: Add db2153 to s1

80897edfa7-+-striker: connect docker container directly to host network

73955266ce-+-Update analytics refine job version in test cluster

fa00b241c6-+-P:toolforge: drop stretch support

a28ea33acd-+-logstash: add loki output support

7a4baa3153-+-P:toolforge::checker: remove stretch endpoints

0c73a7402e-+-ADD new PDU model to ps1-a4-codfw

df617f998b-+-ores: Assign SPDX headers

fe41a7ef09-+-loki: add ferm service to control api access

abeb5a22e1-+-keyholder: Collect Prometheus metrics

943c259ada-+-icinga: remove 'monitoring' from service::catalog

5c7e852fd3-+-P:(toolforge|wmcs::paws)::prometheus: improve namespace filtering

5e3ed2a90b-+-P:openstack::puppetmaster: alert for puppet certs for deleted instances

1064b1b260-+-P:puppet:agent run puppet agent one minute after startup.

b3ff416949-+-mariadb: Remove db2083

71338ca799-+-Create REST api service to manage toolforge replica.my.cnf

24d136e0f0-+-P:aptrepo::wikimedia rollback Apache migration, due to OCSP stapling.

7ba38236b0-+-wmflib::service::get_url: avoid using monitoring to find the url.

54a939de7c-+-class role::apt_repo switch apt-repo to Apache2, from nginx.

a03ea70462-+-mediawiki::php: fix proxy selection when using unix sockets

9319d01446-+-profile::prometheus::ops enable Ganeti metric scraping.

72bbe3e06d-+-mariadb: Promote db1120 to x1 master

50f69b0687-+-Adding new cloudnet, cloudrabbit and cloudservice nodes to site.pp

93906b3e2b-+-grafana: ldap parameter expects a hash by default

8351c4e3f0-+-loki: add loki as an optional grafana component

089c120b9b-+-Add new db nodes to site.pp

ce2491cd12-+-Adding cloudvirts to site.pp

d15cc0d2b7-+-Setup .gitconfig for mwpresync system user

419eb0a92d-+-Inline ganeti::kvm

febee11f9b-+-make script send mail whenever there is output

14734ee3bd-+-mariadb: Remove db2081 from puppet

71e9fd1678-+-bird: upgrade configuration to bird2 (merge IPv4 and IPv6 configurations)

1cd23ff22a-+-profile::prometheus::ops add ganeti cluster targets

811a978245-+-snapshot: remove absented dumps-timechecker cron

25888dd220-+-dumps: remove absented dumps-fetches-wikitech cron

db83a97ed4-+-mariadb: Remove db2075 from puppet

ebc6b309d7-+-mariadb: Decommission db2071

797f67fb03-+-logster: remove absented logster- cron

911e990385-+-striker: require ::profile::docker::ferm in ::profile::wmcs::striker::docker

d84f5a4535-+-gitlab: add prometheus blackbox http monitor

ee6befd604-+-elastic: delegate echo loc to PATH

286a01ba6f-+-cloudweb: include ::profile::docker::ferm so docker can mess with iptables

1d090e0a07-+-elastic: grep path differs btw OS vers

156972c4b6-+-elasic: grep path differs btw OS vers

09db7c9b4f-+-striker: Add profile to provision docker container

db4b3fdb05-+-elastic: don't mutate keystore group

c5bb1e4b83-+-Allow DNS requests from GitLab runner containers

d74d3985e1-+-elastic: use full paths for shell cmds

e7afcff396-+-elastic: elasticsearch-keystore takes from stdin

60bbcc983e-+-elastic: fix s3 user/pass logic

9192e8453b-+-elastic: configure keystore values for restore

9db7078e1e-+-Add new Cloud node to site.pp and to netboot.cfg

fe6402da28-+-P:wmcs: toolsdb: support mariadb 10.4 on bullseye

a206dc0cad-+-Revert "bird: upgrade configuration to bird2 (merge IPv4 and IPv6 configurations)"

f97ddc3dd3-+-Add new PDU model to ps1-d1-codfw

bdc126eb29-+-bird: upgrade configuration to bird2 (merge IPv4 and IPv6 configurations)

d81e8c9953-+-mediawiki/php: fix ordering issues

3c15aa8b85-+-kubeadm: label nodes with nfs mounts

cf14fbf734-+-fix name of the send mail parameter for dump script converted to systemd timer

26ceb3765d-+-C:ganeti::prometheus fix config path

36b4e21fb9-+-C:ganeti enable ganeti prometheus exporter.

5f8ae4099f-+-C:profile::ganeti unbreak Puppet on Ganeti nodes.

4cde687d94-+-c:Ganeti Ganeti Prometheus exporter deployment

d8acec56f7-+-make sure various dump related scripts send email when they run

423a08f4eb-+-mediawiki::php: force apt-update to happen before installing php

c29ec57646-+-toolforge:toolviews: Allow disabling toolviews in hiera

a2fa1e030a-+-C:apt enable thirdparty/hwraid for Bullseye hosts, via private repo.

d9ebb06427-+-Add configuration for the ml-cache codfw Cassandra cluster

1792778f0a-+-Remove absented diamond collector for puppet

702d708791-+-C:snapshot::dumps::timechecker convert cron to timer.

d1903191cb-+-mariadb: Promote db1181 to s7 master

a28313c8f9-+-Revert "mcrouter: Add stats route for fast increment"

991d6efef2-+-P:openstack::pdns: remove unused sudo rules

7cb111ea4e-+-Adding new mw servers to site.pp

5679a65ead-+-P:puppet::agent: correct source paths

f35aa13036-+-C:puppet: move files and templates to correct module

5e0949b496-+-P:toolforge::grid::cronrunner: sync crontabs between hosts

0d5242749b-+-Adding dse-k8-100[7-8] to netboot and site.pp

d1cff8c903-+-P:toolforge::grid::cronrunner: disable cron on non-active hosts

86affed988-+-P:puppet::agent: move WMF customisations to profile

bc6f289d69-+-base::expose_puppet_certs: rename expose_puppet_certs define

7cae20236a-+-puppet: rename base::puppet class to puppet::agent

332c2b52d9-+-ipmi_exporter: Have wrapper depend on sudo::user

e84111e447-+-C:base::puppet move Puppet to Systemd timer

ea76ac08af-+-P:base::puppet: rename profile

068bf3e6e5-+-C:base::puppet: add documentation and fix mionor lint issues

52d024a567-+-Improve performance of Tegola tile pregeneration

a5e014c468-+-Replace crontab with systemd timer for WikiTech dumps.

b1d95008b0-+-updating site.pp for stat1009 and stat1010

75ca22defe-+-Adding conf1007-9 to site.pp and and netboot.cfg

ccf9f03f0a-+-Add new cloudcephosd servers to site.pp

9cc92a130f-+-openstack::trove: reduce workers

3bd4156bfb-+-bsection: Add SPDX headers

1e5ab405c6-+-dumps: remove absented update-dump-statusfiles cron

0e424e399d-+-dumps: remove absented dumps-exception-checker cron

b571e25378-+-security: Add SPDX headers

d515ab37b8-+-Remove old Arclamp buster VMs

ae7dc57ca1-+-deployment_server: remove packages wrk, siege and lua-cjson

8240030a30-+-scap: remove 'files' from file path

36cd53dfc5-+-scap bootstrap: refactor

8432c81e70-+-elastic: remove decom'd hosts

14fcf90d7b-+-Add new model for new PDU in rack A1

01d4cac9ca-+-Revert "durum: add monitoring::service for the check service"

1203caf699-+-Add new model to ps1-a3-codfw

333d7e7d1f-+-kubernetes::master: Double the apiserver latency thresholds

6ae635e706-+-package_builder: add python3-pbr (anycast-healthchecker build)

ce4ff26813-+-Netbox type: fix data type

66324f7da6-+-netbox: fix type definitions

9be406dc7a-+-vrts: Add SPDX headers

45e2e8e9b2-+-netbox::host: rename cluster to ganeti_cluster

16c09b6f97-+-Revert "bird: upgrade configuration to bird2 (merge IPv4 and IPv6 configurations)"

2e0025871e-+-bird: upgrade configuration to bird2 (merge IPv4 and IPv6 configurations)

dc15e19174-+-Revert "Prometheus: temporarily disable the Netbox job"

6bbd25aee2-+-gitlab_runner: fix whitespace in register and unregister check

3df31fc8d6-+-Netbox internal dns.git endpoint monitoring fix

eafc8dc847-+-Netbox: add monitoring to dns.git endpoint

7309902c4c-+-class profile::aptrepo::wikimedia Listen on temporary http ports

ba2b0f9460-+-class profile::aptrepo::wikimedia enable modules headers and ssl.

a6411b1e10-+-class profile::aptrepo::wikimedia enable mod_macro

6fe6032f55-+-profile::aptrepo::wikimedia test public apt repo on Apache

75d7e730ee-+-prometheus: Enable scraping of the ipmi exporter

22fb6c1740-+-base:sysctl: rename sysctl value as it could be enabled or disabled

bcf6ad7087-+-P::base: allow useres to configure enable_unpriv_userns via hiera

42a572836e-+-openstack::nova::monitor: improve check_flavor_properties performance

f6a739e2fb-+-pki: Add ML staging k8s to list of CAs

b2ab33ea82-+-prometheus: Fixes for I0c1a0b9ef2a1310fa5d0c9

8a7a69a944-+-prometheus: Add ipmi_exporter to bullseye+

0ac766f210-+-C:dumps::web::dumpstatusfiles run every five minutes.

18b19f8525-+-C:osm::import_waterlines remove logrotate configuration.

e6d57631b0-+-prometheus: ping access switches and FR firewalls

1e5427045f-+-C:dumps::web::dumpstatusfiles, convert to systemd timer.

3de4511f78-+-zookeeper: remove absented zookeeper-cleanup cron

e854239249-+-squid/racktables: Add SPDX headers

e3530727e8-+-smokeping: Assign SPDX headers

ddc323974e-+-net: Add network config setup for ML staging k8s

fb4eb39423-+-grafana: Assign SPDX headers

9ffc8f7ed3-+-pontoon: fix race between SD/dnsmasq and resolvconf

2c8cac8367-+-pontoon: add profile::pontoon::base

ca9558cb89-+-Netbox: adapt ganeti-sync config file

e4871ceff8-+-icinga::monitor::toollabs: replace stretch with buster

3882c95870-+-gitlab_runner: add job to cleanup old docker volumes/cache

dcb7e3306a-+-sslcert: remove absented update-ocsp-all cron

49e3a189da-+-memcached: remove absented memkeys cron

5fcb62b3ba-+-zuul: disable core.logAllRefUpdates at clone time

dd0aac68da-+-profile::zookeeper::server remove cron mail spam hack

a5465c502c-+-osm: remove absented import_waterlines cron

8400949ee3-+-aptly: Assign SPDX headers

16c4c61b61-+-prometheus: remove absented prometheus_directorysize cron

edb93366bf-+-mcrouter: Add stats route for fast increment

1c4247c416-+-Use $region for default mcrouter routes

cfe045cb57-+-P:toolforge::checker: add missing endpoint config

91da9cb5e5-+-base: create profile to allow unprivileged userns, use it on gitlab_runners

cac200a3b9-+-mediawiki::deployment::server: Rename $deploy_ensure to $secondary_deploy_ensure

7069479c01-+-Add netboot.cfg and site.pp for an-presto hosts

e062ffa079-+-Remove profile::releases::upload and related classes

2f00554d77-+-P:sretest: Add original title parameter to sretest import/export

b57592fa48-+-cassandra: load grants files upon change

693f4595f9-+-Add new pdu model for ps1-a2-codfw

3815fc130f-+-wmflib::service: Reject empty string values

50bc3a800b-+-P:netbox: add dynamic config back to config file

1306bde493-+-Remove old buster IDPs from Puppet

726260c85e-+-wmcs: add default for metricsinfra_prometheus_nodes

eca3cfb23d-+-wmflib::resource::export: make exported resource titles more unique

0beb2b66aa-+-C:tilerator::regen fix logging and rename service.

cd0009ea0f-+-Retire releasers-parsoid group

df7131333a-+-osm: migrate import_waterlines cron to systemd timer job

d3add700ea-+-Prometheus: temporarily disable the Netbox job

70f1445eb5-+-dumps: migrate cron of dumps-exception-checker to systemd timer

1f5903793b-+-memcached: migrate memkeys cron to systemd timer job

0c3843844b-+-Netbox stats, set scrape interval to 2m

cd65d7c28c-+-Remove reprepro config from releases*

d82191ad64-+-sslcert: migrate update-ocsp-all cron to systemd timer job

9c9b06beff-+-prometheus: migrate prometheus_directorysize cron to systemd timer job

ad3da5b12c-+-zookeeper: migrate zookeeper-cleanup cron to systemd timer job

4a8ad67a92-+-site: remove old gitlab runners

e5d1a748b0-+-Galera/haproxy: remove old bash healthcheck script, replace with flask

419d919cc8-+-P:openstack::haproxy: fix galera health check

ee3c42fad4-+-metricsinfra: add metricsinfra-prometheus-2

113ea06e7b-+-galera-nodecheck: fix filename

b516510caf-+-Replace the bash/socket-based galera healthcheck with a python flask app

3bf3911094-+-dnsdist: remove redundant parameters for qps_max

c6630b41a3-+-coal: Remove support for pre Bullseye installs

90b065ea94-+-Revert "Revert "Prometheus/Netbox: use netbox.wikimedia.org SNI""

edbf476aee-+-snapshot: remove absented add-changes cron

61bbb0d19f-+-Revert "Prometheus/Netbox: use netbox.wikimedia.org SNI"

68bae1cb1c-+-php: Add SPDX headers

b548044b17-+-Prometheus/Netbox: use netbox.wikimedia.org SNI

95a30007cc-+-snapshot: migrate adds-changes cron to systemd timer job

dbe60d8333-+-spamassassin: Add SPDX headers

5412ba349c-+-imagemagick: Add SPDX headers

4b06532800-+-Revert "Revert "Provide buildkitd to GitLab runners""

921e530ba0-+-opensearch: ensure elasticsearch-curator on opensearch compatible fork

23c8303c23-+-Prometheus: gently pull Netbox django metrics

89d72126ef-+-Separate metricsinfra nodes from prometheus_nodes on cloud

2055e10395-+-Switch old Stretch arclamp nodes to role::insetup until eventual decom

3c4fa6b5e0-+-Add a sudo_user parameter to the hadoop fsimage freshness check

c228ba1e63-+-Add a new check for the age of the standby namenode fsimage

692490512e-+-C:apt actively absent privte repo if not requested.

5b021a7ffc-+-wmflib::service: add data loader class

603b44b258-+-Enable ganeti4004 as Ganeti node

2ec9135ede-+-P:apt do not include private apt repo on cloud hosts.

8ee58c4a18-+-Remove rsync config only needed for stretch->bullseye migration

f3f70bd574-+-swift: introduce rsyslog config to ban logs before centrallog

16ae448958-+-class:apt Add new private repo.

a519b7988e-+-prometheus: use hostname for blackbox::check::http

16dd601d3a-+-P:(toolforge|wmcs::paws)::prometheus: configure alertmanager endpoint

e927035089-+-Retire profile::logster_alarm

229ca85e4f-+-Fixing site.pp entry for aqs servers, thx papaul for finding that typo

58fbd623cb-+-Fix the path of the sqoop scripts

1595efd92d-+-P:toolforge: exec_env: install libfile-slurp-perl

4c5f872c1b-+-phabricator: let www-data run /usr/bin/git as phd

c24af4277a-+-Include spark3 config on all hadoop client nodes

ace99a5e7c-+-Adding netboot and site.pp for new wdqs servers

a7b1ef687c-+-P:toolforge::redis_sentinel: stop sentinel and puppet fighting (try 2)

80615af1e4-+-Retire profile::logster_alarm

b082a8406e-+-P:toolforge::redis_sentinel: stop sentinel and puppet fighting

b4b6be5478-+-systemd::timer::job cleanup now absent cronjobs.

0e0a4a80de-+-Add new Cassandra cluster for ML cache/feature-store workloads in eqiad

b4129030aa-+-Split up the tables we sqoop

7a807d04a6-+-P:maps::osm_replica fix prom-replication lag script.

a91268ba42-+-scap: remove config for scap Debian package

13f51b0437-+-Netbox: remove Icinga checks for netbox.wikimedia.org

b4450d955f-+-Netbox: only run CSV dumps on active server

64a3739adb-+-Revert "Provide buildkitd to GitLab runners"

253ab95ae4-+-Provide buildkitd to GitLab runners

ec870ed37d-+-cap: add version back

92ef73694e-+-scap: remove scap Debian package from targets

46fcbc7a7d-+-Move Prometheus postgresql lag metric collector to systemd timer

b2fa452147-+-scap: fix bootstrap

6016fa1062-+-Move more OSM cronjobs to systemd timers.

044a8cc8ef-+-logster::job migrate cron to systemd timer.

b2c90d89dc-+-cacheproxy: Add SPDX headers

57b51cbca1-+-bigtop: Add SPDX headers

1d6e32203f-+-Move tilerator regeneration from crontab to systemd timer.

18c65c103d-+-atskafka: Add SPDX headers

5603f17d4d-+-docker_registry_ha: Add SPDX headers

85604a1934-+-airflow: Add SPDX headers

1fb0b743db-+-alternatives: Add SPDX headers

07515ba127-+-aqs: Add SPDX headers

8f0a779e9a-+-backy2: Add SPDX headers

69fc55c4ad-+-scap: switch over from Debian package to self-installed scap

0bc294b30e-+-burrow: Add SPDX headers

066e0ae0c8-+-wmcs: relabel alerts from wmcs cluster with wmcs team

add6f987d1-+-celery: Add SPDX headers

492ec528ea-+-cergen: Add SPDX headers

14e405d128-+-cinderutils: Add SPDX headers

5255066747-+-cloudnfs: Add SPDX headers

17d62cba59-+-cmd_checklist_runner: Add SPDX headers

56d798ce64-+-mariadb: Promote db1131 to s6 master

37bd63375c-+-mediawiki: Remove absented mostlinkedcategories job

d01a20918e-+-mediawiki: Disable useless mostlinkedcategories update job

8cbdcc70bd-+-openstack: set the nova user groups on virts only

fd2d382cf1-+-coal: Add SPDX headers

d6bbbdf97c-+-nova: add user to libvirt-qemu

c27b8e67da-+-noc: Assign SPDX headers

85f76e96b8-+-Configure AQS Cassandra hosts (codfw)

9968491906-+-service::docker: refresh service when config file is changed

fe1bbc57da-+-Switch idp1001/idp2001 to role(insetup)

6016fa6cef-+-C:query_service::deploy::autodeploy remove used autodeploy.

fc50ee3e58-+-put clouddumps100[12] into service

30a74f91a8-+-Revert "Revert "phabricator: allow disabling ssh-phab service except on one host""

80d258ee95-+-prometheus:ops: rename otrs references to vrts

5758075f48-+-airflow:manifests:instance.pp: Bump up number of DAG processors

3dc01ab5bb-+-phabricator: add blackbox http check

3237f44904-+-envoyproxy: Add SPDX headers

423884f252-+-etcdmirror: Add SPDX headers

d48a6ba91c-+-eventschemas: Add SPDX headers

d5235ec308-+-fifo_log_demux: Add SPDX headers

1d2feda353-+-galera: Add SPDX headers

86cb06647c-+-conntrackd: Add SPDX headers

1b16396d54-+-docker_pkg: Add SPDX headers

966c92eb0e-+-docker_pusher: Add SPDX headers

ca9c792188-+-dumpsuser: Add SPDX headers

1d0240bca8-+-external_clouds_vendors: Add SPDX headers

f6ea88cc22-+-external_proxy: Add SPDX headers

771cb80042-+-httpbb: Add SPDX headers

09793ae6c1-+-cpufrequtils: Add SPDX headers

836e5f2b78-+-mediawiki: Use non-transitional cgroups package for Bullseye

f6a97ac94b-+-mx: rename OTRS database related variables

f570e198a0-+-vrts: rename ferm services from otrs to vrts

7da22989c0-+-vrts: rename TicketExport2Mbox file

bf2feede62-+-vrts: rename cleanup cache service

9cd5a07a79-+-vrts: fix type in timer name

aeefad461b-+-vrts: rename systemd timer to train spamassassin

832ea54d9c-+-Enable webperf1004/2004 as new Arclamp hosts

ead3687609-+-profile::mariadb::ferm_misc: Remove old buster IDP nodes

442dbd3aab-+-scap: fix bootstrap exec command

40e5909b7a-+-Fix zookeeper typo

2dbb51ad77-+-scap: bootstrap freshly provisioned scap targets

995c7d8516-+-prometheus::blackbox::check: add new blackbox exporter check

a403c224c8-+-wikistats: Assign SPDX headers

fbaa3f3f00-+-vrts: delete idle_agent_report

ed759d43e5-+-Pin Cassandra 3.11.13 as 'dev'

45ece43565-+-Bring in pingthing

6248aca512-+-gdnsd: Add SPDX headers

042f5bfcb9-+-exim4: Assign SPDX headers

a581d58a61-+-backup: Add SPDX headers

8b953c8503-+-Monitoring: don't check for BGP on cloudsw2

a7c5a4616a-+-profile::aptrepo::wikimedia Wrapper script for reprepro.

1d11df6f0e-+-aptrepo::repo allow notification subject to be changed.

05df2c79ab-+-prometheus: generate per-service TCP blackbox module

b888246e60-+-OpenStack Magnum: use a service user 'magnum' as admin of 'magnum' domain

6d87d40794-+-Keystone: Include config for 'magnum' service domain in codfw1dev

cb45241533-+-Add tenacity lib and retry logic

579af59e18-+-kubeadm: Add SPDX headers

cd33ff6d91-+-netbox: also add CA bundle environment to netbox_dump_run job

4b1908b17d-+-keepalived: Add SPDX headers

f1120de37d-+-kerberos: Add SPDX headers

6e65e7816f-+-kibana: Add SPDX headers

9dc8570b07-+-httpd: Add SPDX headers

d568d3bbfa-+-imagecatalog: Add SPDX headers

0e95defce5-+-kafkatee: Add SPDX headers

8d5ebdd053-+-httpbb: Add missing query_service directory

5b8582d2c6-+-P:netbox: add REQUESTS_CA_BUNDLE variable to systemd timers

6cafef274f-+-initramfs: Add SPDX headers

c0e2f4f145-+-httpbb: Add basic tests for query_service (WDQS)

d0fc27f6b3-+-Add cloudsw1-e4 and cloudsw1-f4 to mgmt and adjust existing cloudsw

c7b0888d0b-+-logster::job revert systemd timer migration.

67730b84f0-+-profile::aptrepo::wikimedia Enable private apt repo.

6deba90186-+-wikilabels: Add SPDX headers

906e7baf20-+-raid: Add SPDX headers

3959cd7f0f-+-arclamp: add rsync config to migrate Xenon data

e254556351-+- profile::aptrepo::wikimedia Fix missing vhost variables.

b33c04d307-+-netbox: Add SANs for addtional vhosts

6cd7c6ac5d-+-P::aptrepo::wikimedia install Apache for private repo.

96e0b169c7-+-gitlab::dump: delete role and profile classes

0faf6f6b94-+-Move restart of slapd, due to memory leaks, to systemd timers.

484f1d1137-+-Rewrite logster::job to use systemd timers.

6c4b50c5c1-+-vrts: rename daemon resource and template from otrs to vrts

5e16d525ec-+-vrts: rename exim4 templates from otrs to vrts

a51b7fdd05-+-query_service: we don't use cron here anymore

e19c17ea55-+-opensearch: add support for managing opensearch 2.0

0240cf72d8-+-query service: clean up absented resources

1fad40773d-+-query_service: load categories daily, not weekly

c25e37028b-+-query service: port cronjobs to systemd timers

f208c96e21-+-Revert "P:wmcs::prometheus: set openstack scrape_interval to 4m"

7a49ebedb3-+-Elastic: Add elastic bindir to root's path

dff7c1e002-+-wmflib: add to_yaml function which allows striping yaml header

0c8d3a8c11-+-os_reports: Make the reports look better

9c2a122ebd-+-logrotate: Add SPDX headers

5eff5107cc-+-logster: Add SPDX headers

0b7a1faedb-+-lxc: Add SPDX headers

a208046fa9-+-mjolnir: Add SPDX headers

191fc429f3-+-mtail: Add SPDX headers

b88db8f593-+-ncredir: Add SPDX headers

b7fb22d661-+-netbase: Add SPDX headers

e544a0cf4c-+-Deprecate 'monitoring_setup' service state

2f3b3d7264-+-webperf: Assign SPDX headers

c3e62333c5-+-ipmi: Assign SPDX headers

a17649627b-+-site: remove gitlab_dump role from gitlab2002

eda25b2699-+-parsoid::testing: move apache/php auto_restarts to separate profile

2717926758-+-vrts: adjust tests files to renamed role class

64bf15f54a-+-remove stray webperf entry in site.pp

72da970df6-+-query_service: Add SPDX headers

6ca9a37020-+-rabbitmq: Add SPDX headers

f3a00c6c6d-+-pontoon: Add SPDX headers

742dd5944a-+-presto: Add SPDX headers

91aa891c82-+-nftables: Add SPDX headers

65588c4569-+-poolcounter: Add SPDX headers

1258d4d510-+-netops: Add SPDX headers

b4292436d5-+-puppet_stastd: Add SPDX headers

1589c8ebc4-+-Add MariaDB grants for x2

b3d82dfa5c-+-Adding backup1009 to site.pp and netboot.cfg

26394f4f33-+-mx: enable tainted data checking

07ac259d52-+-P:sretest: Add merge parameter

5944136e45-+-wmflib: drop rsource::reduce and add specs for resource::import

2ed1b9d0dd-+-wmflib::resource:export: export the resource not the title

2ed84347fa-+-P:sretest: test new wmflib::import/export functions

f92b603491-+-wmflib: add import/export functions

9ceb5e8c81-+-sretest: test reduce function

5b785411c9-+-backup: switch fileset for gitlab from /mnt to /srv

551cbe7737-+-sretest: stop realising resources whil we fix up names

6cd197da13-+-wmflib: Test hack to deduplicate resources

facf17f378-+-wmflib: Add debugging

8d242e2db3-+-P:sretest: Test out new wmflib::resource::reduce function

c2344ccbc9-+-wmflib: add resource reduce function

0ae2d2c76c-+-wmflib: add new resource::capitalise function

8c3a4d189f-+-vrts: fix apache error when running puppet

c93afa501a-+-vrts: rename module files and classes

d28da54598-+-Apply idp role to idp1002/idp2002

fc7bfa7067-+-backup: Cleanup bacula_check

52eab08d5d-+-P:wmcs::prometheus: set openstack scrape_interval to 4m

f0001bff58-+-P:backup::director: use new sudo_user parameter for nrpe::monitor_service

61b9b66819-+-P:aptrepo::wikimedia switch public apt repo to use new define.

818c533807-+-Add clarification to comment, to help avoid mistakes using httpd::site.

ab61a6ca7a-+-mariadb: Promote db1136 to s7 master

5db732b7a8-+-Remove old buster idp-test hosts, add new idp/bullseye ones from Ferm rules

217e408607-+-matomo: Add SPDX headers

ab4649783a-+-karapace: Add SPDX headers

4808495612-+-puppetdb: Add SPDX headers

f17d781ff8-+-Reduce the retention time for hadoop namenode fsimages

ca6e9bb750-+-Revert "move more nrpe checks to nrpe::plugin and sudo_user"

3ba933723f-+-opensearch_dashboards: add and enable bacula backups

ead3c7e3dc-+-move more nrpe checks to nrpe::plugin and sudo_user

55d373fea6-+-metricsinfra: Use prometheus-configurator

b48df3964e-+-P:metricsinfra::alertmanager: proxy access for trusted projects

8140df112a-+-aptrepo::repo No - in nonfree, create missing deb-override file.

ded6633d41-+-C:netbox: add support for proxy configuration

3058a75ffb-+-aptrepo::repo Allow seperate distributions files per reprepro conf.

183ce9b087-+-reposync: Add SPDX headers

653c4aed60-+-sonofgridengine: Add SPDX headers

73f13ca422-+-statsd_proxy: Add SPDX headers

f4dde030d8-+-strongswan: Add SPDX headers

35c5b3ad50-+-sysctl: Add SPDX headers

6e9eec0bbb-+-system: Add SPDX headers

d2c60385ea-+-vm: Add SPDX headers

d39381b244-+-move more nrpe checks to nrpe::plugin and sudo_user

f3f68ce99f-+-r_lang: Add SPDX headers

40bedcb0f6-+-Revert "maintenance::wikidata: Update cron with lb and lb-pool params"

b3c35856d0-+-snmp: Add SPDX headers

2b4befc3a4-+-maintenance::wikidata: Update cron with lb and lb-pool params

d17b5c674d-+-graphite: remove absented update_graphite_index cron

6e0699a2b5-+-ldap-corp: disable paging

3e71971618-+-chartmuseum: Add SPDX headers

be6ae90ea2-+-Add idp1002/2002 to site.pp

3c3b9fcb1d-+-aptrepo::repo move validation command to Python3

20474d5b97-+-imagecatalog: do not have auto_restart service if service does not exist

80afcfb8f0-+-clamav: Add SPDX headers

bce8d00f51-+-Add backup2009 to site.pp

922e587749-+-arclamp: Add SPDX headers

a3a679dae1-+-auditd: Add SPDX headers

0cdc001d04-+-etherpad: Add SPDX headers

dabdfbe7a2-+-C:postgress:slave: add notification for lack of replication init

38d47f1e81-+-dbbackups::check: Add enabled flag to have a passive host on codfw

d75e1b3f94-+-netbox: Add discovery name to django allowed hosts

ba0993deaf-+-icinga: remove absented sync-icinga-state cron

1d5312ddca-+-profile::aptrepo::private remove duplicate file.

33255215f7-+-P:openstack::puppetmaster: remove conftool client

4d6bc94536-+-icinga: migrate sync-icinga-state cron to systemd timer job

10b74e28ff-+-aptrepo::repo add missing distribution file

1566ee46fe-+-graphite: migrate update_graphite_index cron to systemd timer job

c4d18926b5-+-swift: remove failed node ms-be1059, mark a dead drive failed

3a8ba965e7-+-scap: Allow rsync from analytics hosts too

286a8fd681-+-site.pp: promote netboxdb[12]002 hosts to netbox::db

0da3d69bfb-+-aptrepo::repo syntax fixes.

420fa6b573-+-P::aptrepo::private, fix parameters for aptrepo::repo

b4ce02f2fd-+-P:aptrepo::private refactor code to allow for multiple repositories.

3c0965ff45-+-python_deploy: Add SPDX headers

d8e5fc72f2-+-kartotherian: Add SPDX headers

08b57ec68e-+-site.pp: add netboxdb[12]002 to insetup

5f36ea137f-+-Beta Cluster: ship logs from docker services to logstash

b6f8fbf345-+-helm/helmfile: Add SPDX headers

d849d08284-+-mariadb: Promote db1130 to s5 master

7af2d4704b-+-Add 'region' arg to heat and magnum manifests

0dad7d9d0c-+-Set production role and add config for restbase2027

20906bcb49-+-motd/kmod/debconf: Add SPDX headers

99a41da0f8-+-dragonfly: Add SPDX headers

68e5e93aaf-+-idp::memcached: Only enable memcached_16 on Buster

3eac73c2c3-+-gitlab: use gitlab1004 as replia/passive host

3b1e6c6248-+-memcached: Untangle TLS/1.6 options

f1b00de578-+-Revert "Icinga: add page hashtag to paging host alerts"

f5647539a6-+-Icinga: add page hashtag to paging host alerts

2aa6e490c4-+-nrpe: manage sudo rules via nrpe::check (try 2)

307cf0b5b1-+-Revert "scap::master: remove the unused scap::l10nupdate class"

cc5a9854df-+-purged: Add SPDX headers

9042886c81-+-puppetdb: create dbs before grants

a19949d8ae-+-cfssl: write pretty json

70bf8e45e4-+-shiny_server: Add SPDX headers

2018ede3fb-+-sbuild: Add SPDX headers

da973acfaf-+-samplicator: Add SPDX headers

cb04dca668-+-Remove cleanup on unused Fairscheduler for Hadoop.

b262329d56-+-scap::master: remove the unused scap::l10nupdate class

125bc1848a-+-mariadb: Move db1128 from m1 to s1

0197c38295-+-Magnum: add haproxy in codfw1dev

2e3ff503c5-+-Rough in manifest and files for OpenStack Magnum

d0435cfe68-+-haproxy: fix some copy/paste errors with heat frontend ports

2489f2ee8b-+-Heat: include internal keystone url in heat config

95ae66e67d-+-Heat: use 'heat' service user instead of novaadmin for auth

01f0096724-+-Add a properly private encryption key to heat.conf

4f0ff0ec9e-+-Pass in codfw1dev-specific rabbit pass to heat profile

f7c102adec-+-Rough in manifest and config for OpenStack Heat

2e64d00c88-+-parsoid::testing: add an auto_restart service for nginx

ba3c4dba6d-+-cloudweb2002-dev is not behind LVS

febfacf78d-+-opensearch_dashboards: add backup script enable job

1a93c1e9fe-+-Revert "cloudweb2002-dev is not behind LVS"

8dcf295290-+-cloudweb2002-dev is not behind LVS

6a2f57fb7c-+-site.pp: db1128 current situation

30b13905a8-+-resolvconf: Add SPDX headers

f2eb020f2b-+-profile::auto_restarts: make comment match class name, minor grammar

83042d1f17-+-rsyslog: Add SPDX headers

8c3f73a9cb-+-gitlab::dump: add gitlab1004 to allowed hosts

fa030b2db0-+-site/gitlab: make gitlab2002 another backup dump location

903bee67e1-+-gitlab::dump: use rsync::module directly, not quickdatacopy

b167704c66-+-gitlab::dump: ensure /srv/gitlab-backup exists so that rsync starts

fa05ab8c18-+-gitlab: create role/profile to temp use gitlab1004 to store backups

5ecb69e285-+-opensearch: Add SPDX headers

9aeb4a400a-+-turnilo: Fix port variable dererence for monitor

5c8dc0f5a0-+-testreduce: Add SPDX headers

abc36166f3-+-Rename cloudstore101[01] to clouddumps100[12]

131044c020-+-sqlite: update packages and add dependency

df36b138fa-+-cfssl: fix sqlite3 path selection

fec1618724-+-P:puppetmaster::common: drop support for activerecord

ff588125de-+-mariadb: Update db1128 and db1164 status

1e517d517b-+-monitoring::icinga::git_merge: use sudo::rule

784d5f52d1-+-Remove some unmanaged files from sudoers.d

5e7c10412f-+-mariadb: Move db1164 to m1

87175cdbe0-+-squid: Add SPDX headers

e57714af39-+-statsite: Add SPDX headers

e652f0c409-+-statograph: Add SPDX headers

2cd17955a5-+-toolforge: Add SPDX headers

1ed4eb2eb7-+-sudo: Add SPDX headers

01f14418a7-+-gitlab: rsync config and data backup to same folder on replica

08a5cf67f8-+-deployment_server: actually pass the deployment_group to scap

7dde4e7475-+-alerts: Add SPDX headers

f0e82f23fb-+-acme_chief: migrate acme-chief-designate-tidyup cron to systemd timer job

b568e1cd54-+-mailman3: Add SPDX headers

b9f0e9c162-+-P:openstack: remove labs_hosts_range from hiera

4f87126524-+-P:openstack: remove unused base db class

2bcaef352f-+-icinga: deprecate service::monitor class

78474e30b4-+-prometheus: clarify and document 'timeout' service::catalog probe option

97631e06d9-+-netconsole/systemtap/haveged: Add SPDX headers

6bc361317f-+-Revert "nrpe: manage sudo rules via nrpe::check"

5aa6e5d2b0-+-nrpe: manage sudo rules via nrpe::check

e177537d21-+-WIP: Run multiple apt repos on a single host.

eab53ac075-+-cloudvirt: redirect prometheus script errors to journal

71da67b3ff-+-Only add component/memcached16 on Buster

0f07875ce9-+-lvs: stop double-checking docker registry from Icinga

1bf76126cd-+-Allow new idp-test hosts in Ferm rules

1e3ae007aa-+-mariadb::misc: Fix motd that was marking misc hosts as core

fb1a21e962-+-P:aptrepo::private: update to use httpd listen_ports

7e214d5a64-+-gitlab/gitlab_runner: Add SPDX headers

4fa362d6ca-+-beta-logs: enable pipeline-managed index patterns

32f55d087c-+-C:reprepro: ensure /var/lib/reprepro/.bashrc exists

0549898013-+-C:cfssl: create a refresh only resource to force resigns

87b80afeb2-+-C:requesttracker: drop requesttracker::apache

d7dd9cbc31-+-gerrit: properly handle ports configuration

c3f9cd8c61-+-P:ssh::client: Add GSSAPIDelegateCredentials support to ssh::client

09765479bc-+-fastnetmon: remove alert, ported to Prometheus / Alertmanager

b49bd7729d-+-thanos: fix alert 'source' url

00c760d9cd-+-Set fixed uid/gid for kafka by default

ee03237601-+-httpd: use default ports.conf if nothing else was configured

5785edf1a1-+-Revert "C:httpd: allow users to pass the listen_ports to use"

19a7504a14-+-C:httpd: allow users to pass the listen_ports to use

f9cf147333-+-C:httpd: add documentation

722015639a-+-Handle port deallocation for Apache.

0a0ee3ab25-+-nrpe::plugin: don't require a source with ensure => absent

7c21f7c8f5-+-Enable cassandra encryption (aqs cluster)

881cc83742-+-alerts: take rule file site into consideration when deploying

f0959251ec-+-Netbox: Add SPDX headers

fb4a4c379c-+-debian: Add SPDX headers

f2a59e2908-+-toil: Add SPDX headers

edf05d3fbc-+-threedtopng: Add SPDX headers

51d0ce8475-+-postgresql: remove absented backup crons

d68558d6f8-+-tomcat: Add SPDX headers

4d8f2c9c4f-+-P:netbox::automation: Drop Acme dependency

1879c5f66d-+-klaxon: Add SPDX headers

1b2451273e-+-netbox: add new netbox serveres to netbox::fronend

bdd5b11ebd-+-thanos: Add SPDX headers

a31bebf6c4-+-redis: move to nrpe::plugin

9d15de6027-+-netbox: add new netbox serveres to ACL's

bcc7a21eee-+-O:cfssl::cert: also regenrate chained file when generating re-signing

4446d71ee8-+-mx: remove queue size alert, moved to Prometheus

6e7848e511-+-P:openstack::rabbitmq: manage all users

1ff52f3b8a-+-cfssl::cert: ensure we re-generate the certificate if the csr changes

8815e1c1c2-+-R:tlsproxy::localssl: Add cfssl support to tlsproxy::localssl

4f7dca496a-+-burrow: move to nrpe::plugin

897486d0a8-+-C:postgresql::backup: move default date to the script

f47710809f-+-C:postgresql::backup: run command via bash to expand parameter

9db0e21dad-+-postgresql: migrate backup crons to systemd timer jobs

d7a999eb11-+-Private APT repo, add distribution file.

5677360079-+-puppet_compiler: bump version

129d75bcf1-+-P:netbox: Add support for cfssl PKI

d4f3e7dfbe-+-thumbor: Add SPDX headers

cd10fc6d35-+-varnishkafka: Add SPDX headers

dd24614bc5-+-trafficserver: Add SPDX headers

bd360abf2d-+-mediawiki: remove idle php-fpm workers alert, moved to prometheus/alertmanager

32b8c340c7-+-Fix validation command.

3fedb8277f-+-Disable sourcelistscan on turnilo temporarily

81f0b2f808-+-Bullseye do not require python3-apt package.

a9a575635e-+-dbbackups: Delay bacula run for es dbs from 24 to 48 hours

43c425dba8-+-C:redis::multidc::ipsec: migrate legacy redis_shard_hosts to puppet code

cf5f69dac2-+-P:profile::redis::multidc: drop legacy function redis_get_instances

4139b27ab2-+-Ensure that aptrepo will install the correct packages on Bullseye

e97e80048e-+-amd_rocm: Add SPDX headers

4e87216dbb-+-idp: Remove component/idp-test

c84e325db0-+-ulogd: Add SPDX headers

86657b5b2b-+-udev: Add SPDX headers

0ddf2317aa-+-mediawiki::system_users: add mwpresync

991eac9a14-+-profile::cassandra::single_instance: add target_version and rack

2371a7c5e6-+-Also switch idp-test1002 to idp_test role

0152c296ab-+-Move rabbitmq to systemd timer

d352e56d32-+-Revert "Horizon: include openstack bpos on cloudweb hosts"

5703d10692-+-WIP: Private APT repo.

88082c7382-+-Revert "P:sretest: test that sysuser can add users to groups managed by admin.yaml"

7fd7369bcc-+-P:sretest: test that sysuser can add users to groups managed by admin.yaml

a28f4db45b-+-WIP: Private APT repo.

37d0ba4162-+-alerting_host: Remove references to dbbackups monitoring

3f32eb3a83-+-alert_host: Ensure packages and files from dbbackups check are gone

7288da6245-+-profile::idp::build: Add missing package required for CAS build

c7c335c03c-+-Switch idp-test2002 to idp_test role

f81eca4221-+-WIP: Private APT repo

5e769537f7-+-WIP: Trial implementation of a private APT repo.

d54d86a9e2-+-bird/fastnetmon: Add SPDX headers

4a49d639cd-+-dnsdist: Add SPDX headers

87b1e1feb7-+-striker: Add SPDX headers

e3ecf7cbed-+-vagrant: Add SPDX headers

d459db454a-+-Add netmon1003 to site.pp

dfcff4bf91-+-cinder-backup: apply a hack to prevent repeated backup failures

c4123349fb-+-query_service: check_categories lives in /usr/local/lib now

acb4df8911-+-Add new subnets for cloudsw expansion Eqiad to netops infrastructure

9ec5fb3a6d-+-openstack: Make enc api enforce keystone policy

a20209dbfd-+-deployment_server: use helm_user_group everywhere for consistency

191ec7f472-+-deployment_server: better separate resources between scap 2 and 3

97d19220df-+-P:monitoring: cleanup nrpe scripts

80cda0b7e1-+-httpbb: fix 'Unknown variable' warning on beta

c6d08bc085-+-replace wmflib's ensuremounted with stdlib::ensure

82f262bad6-+-P:wikidough: migrate to nrpe::plugin

2f58241f04-+-systemd::sysuser: add ability to managehome of user

860226c8f2-+-mariadb: convert to nrpe::plugin

77d2ac76fe-+-monitoring: use nrpe::plugin

b286c63389-+-raid: use nrpe::plugin

4fbf2b971b-+-gitlab: fix gitlab-ce apt component on bullseye hosts

4605e611f7-+-Modernize aptrepo module.

8a7f5cbbc3-+-Move Hadoop eventlogs cleanup to systemd timer.

d86003c32f-+-Remove old cron calls.

931a6dab68-+-netops: ping core routers from Prometheus

3e2d10eccd-+-Add SPDX headers for routinator/diffscan/bgpalerter/gobgpd/homer

12ed9916f8-+-netops: move network routers/devices definitions to hiera

8d9466a6fd-+-mariadb: Promote db1163 to s1 master

517e9cf007-+-turnilo: move staging instance to an-tool1011

069e3983dd-+-Revert "doc: add monitoring of doc.wikimedia.org certificate"

0be392a436-+-doc: add monitoring of doc.wikimedia.org certificate

a22dcca6a3-+-turnilo: add monitoring for node application

974a83d738-+-varnish: move to nrpe::plugin

f145259734-+-service::docker: refresh the service when its image is updated

92a831ae52-+-P:openstack: make pdns-recusor listen on ipv6

0eb37c2c8b-+-admin: convert unique_users function to puppet function

ef9f070105-+-admin: convert add_all_users to puppet logic

77568afad9-+-profile: migrate to nrpe::plugin

938822dc9e-+-pybal: migrate to nrpe::plugin

5c9001acbc-+-impi: update to use nrpe::plugin

3909eac939-+-Move l10nupdate to systemd timers.

9d844573f7-+-base: remove nrpe old plugin files

11ff74f7a7-+-haproxy: use nrpe::plugin

aa5c020927-+-gdnsd: use nrpe::plugin

33ac630b48-+-eventlogging: use nrpe::plugin

55e9ca4a60-+-dbbackups: Update definition to use Floats for type

9754afdf97-+-dbbackups: Setup backupmon1001 as a database backups monitoring service

d36817546f-+-confd: Use nrpe::plugin

78accef826-+-base::firewall: migrate to nrpe::plugin

21ccc4617c-+-jenkins: update path to war file

7b5aa93da2-+-nrpe: add nrpe::plugin to only installs scripts to hosts with nrpe

5f0c2d23a0-+-wmfmariadbpy: Add SPDX headers

996c59d9d7-+-site: add an-tool1011 to insetup

b1ba3e9f4f-+-visualdiff: Add SPDX headers

111f31f80b-+-fastnetmon: export notification count as metric

4989f1e137-+-mediabackup: Add SPDX headers

791656bdc4-+-libraryupgrader: Add SPDX headers

38c2798702-+-codesearch: Add SPDX headers

2d85e8a789-+-C:helm:  make the group permissions on helm_cache configurable

3a2396e639-+-Move Carbon Cache log cleanup to systemd tmpfile.

e9ea16736f-+-cluster::management: backup auditing logs

fe3d7642fb-+-Move Wiki Rsync fetch jobs to systemd timers.

6f9e08a2e6-+-Update statistics::rsync::published to use SystemD timers

03349c1276-+-Move automated target generation of Prometheus targets to systemd timer.

8b77935254-+-proxysql: Add SPDX headers

c5ebf5ee3c-+-orchestrator: Add SPDX headers

da64c85a58-+-Add SPDX headers to debdeploy/adduser/puppetboard modules

d69ec16326-+-Redirection not available for systemd timers.

7757183c6e-+-Update statistics::publishd to use SystemD timers, rather than cron.

7f78b9e282-+-zookeeper: Add SPDX headers

00b28fe063-+-prometheus: remove http availability pages, moved to prometheus

808bd92a80-+-etcd::tlsproxy: set use_cergen to true

f0f6ac3045-+-Export exim queue length from mx and lists

e607e34231-+-Remove all mentions of netbox-dev2001

3db4214679-+-P:openstack::encapi: add keystone token verification

c73cb69da3-+-P:openstack::puppetmaster: add 8143 to ferm rules

c94e931b06-+-dbbackups: Add SPDX headers

40ebeef4f6-+-mirrors: remove nginx-common

f0908cf9e9-+-gitlab: use gitlab1003 as replia/passive host

43f7f68e52-+-git: add define for abritrarily named config file

0272f84b10-+-Install sasl packages needed to authenticate with kerberos on airflow nodes

99a0a5139c-+-dnsdist: update docstrings to use YARD-style tags

68ad467ee1-+-C:cfssl: Add spdx licences

a821c4a607-+-netops: add site/role to netops::check to cater for new data structure

c36bffcf07-+-wmflib: extend sites

f14de91240-+-apereo_cas: convert module to use SPDX headers

26dbb11bdf-+-Fix the sudoers entry for airflow service checks

a4fdbeb99d-+-P:cache::varnish::frontend: Update lookup keys

41c4b65190-+-C:ssh:client: Add ability to manage ssh_config file

8bf3c7d9d0-+-P:ssh::server: add support for accept env

aa0e5e1575-+-modules: clean up special case for celery v4 in ORES

3b0e26bd7b-+-Create new sudo rules to facilitate monitoring airflow

65f9c66c3c-+-gitlab: allow multiple passive hosts

a6c483a0ad-+-Add kubernetes admin credentials to cumin hosts

a5cc49c158-+-Ensure spark3 conf dir exists

c23e959a25-+-Add profile::hadoop:spark3 class and resources

625872c30e-+-elasticsearch: get java version from java class

f6158aff1f-+-Update default celery version for ORES to v5

face010949-+-C:varnish::common: Add documentation

d6f95c19ff-+-ci: docker system prune on ci::master

c676fb2ed4-+-docker: move pruning to new profile docker::prune

31ef924c64-+-C:ssh::client: Add profile::ssh::client

acaf2557d8-+-C:ssh::server: migrate ssh_server_config to its own profile

4bbfea8454-+-P:cumin::unprivmaster: Add owners variable to unpriv profile

7faee246e2-+-swift: remove absented container stats cron

84ecf8fc73-+-P:conftool: fix location of requestcrl_client script

845bc427dd-+-Add idp-test1002/2002

09f7876461-+-P:base: add documentation and clean up

900a7e86b4-+-swift: migrate container stats cron to systemd timer job

1b08addbe4-+-scap: clone scap code on deployment servers

400cb1822d-+-scap: add system package requirements for scap

b09c4ee15e-+-scap: add new `scap` user to deployment hosts and scap targets

81e6f85ace-+-P:wmcs::prometheus: increase openstack-exporter timeouts

a276b568eb-+-Move jobswatch from crontab to systemd timer

59f408d558-+-Convert dumps-status from cron to systemd timer.

adf0f28fa7-+-OpenLDAP, move restart cronjob to systemd timer.

bc833cf7dd-+-swift: drain ms-be1059, skip cluster-OK checks

5afbac42eb-+-rabbitmq: add missing internal port

dd6848a9d9-+-swift: remove absented stats_account cron

337278f2fe-+-service::docker: allow use of 'latest'

a813060d73-+-P:cache::varnish::frontend: mask the varnishncsa service

29fd99c33b-+-Add a note on the home for systemd::sysuser

cbdda6fc2d-+-P:wmcs::nfs::maintain_dbusers: replace query_nodes with puppetdb_query

129a89dd85-+-P:etcd::tlsproxy: add documentation and fix minor lint issues

74e2047d6d-+-swift: migrate stats_account cron to systemd timer job

41b68af802-+-Fix thumbor probe timeout value

c8ea1a0ed7-+-prometheus: add 'timeout' override for service::catalog probes

7f30574d6f-+-Revert "No longer install subversion on Phabricator hosts"

c7e9abae6a-+-gitlab_runner: move metrics listen_address to global section

32faadb70d-+-P:mariadb::proxy::multiinstance_replicas: drop use of query_facts

2e8006fe28-+-Revert "P:mariadb::proxy::multiinstance_replicas: drop use of query_facts"

17772e583b-+-P:mariadb::proxy::multiinstance_replicas: drop use of query_facts

a5a44a78d1-+-C:docker_registry_ha::web: use puppetdb_query instead of query_facts

6dc8676bc7-+-lvs: remove rx/cpu alerts, moved to alerts.git

0ff74da922-+-P:netbox: Add libapache2-mod-wsgi-py3

f543f0cd46-+-P:acme_chief: Improve type checking for certificates

97421ef4d2-+-C:raid: update hpsa logic to install ssacli tools on > buster

695b8b2fc6-+-ores: refactor git setup and add settings for Buster

1c404e5754-+-prometheus: remove high NEL alert, moved to alerts.git

70990c2bf0-+-Remove references to cloudvirt1016

827f0087dc-+-toolforge: Add liblocale-codes-perl to exec_environ

5e58e340eb-+-docker: ensure apparmor package is installed if on bullseye

750d43c63c-+-update site.pp and netboo.cfg with aqs1016-1021

18cec9d74f-+-P:conftool::requestctl_client: add simple script to check for block ips

55a4d4e7e4-+-postgres: allow enabling the slow query log on replicas

4bcd9e50d1-+-C:netbox: Add scap_repo parameter

7a9c11ebe8-+-Horizon: include openstack bpos on cloudweb hosts

25f8e06a3d-+-durum: add monitoring::service for the check service

e66c938cdd-+-elasticsearch: cleanup indentation to follow usual style

b6bd2ecb1d-+-contint: Bump docker 20.10 version for thirdparty/ci on buster

ba2e674a62-+-Revert "Revert "contint: Install docker 20.10 from thirdparty/ci on buster""

56c6f3b70a-+-No longer install subversion on Phabricator hosts

fbdeca3a70-+-puppetmaster::geoip: remove legacy product IDs even for fallback option

0e15642ab9-+-C:netbox: update docs and fix minor lint issue

2aee0de717-+-openstack: remove ussuri files

27dee62d39-+-elastic: enable/disable ssl_ecdhe_curve based on OS version

db0b2febb6-+-ci: relocate castor storage directory

91eced9c5f-+-ci: on castor server drop /srv requirement

5b3545cbdc-+-wmflib: add drmrs site

38a3dfd5b8-+-Re-enable gobblin jobs

cca3f4df4e-+-Temporarily disable gobblin

8294a058e5-+-Revert "Revert "profile: add etcd tlsproxy certificate monitoring""

afdd88cf67-+-site/gitlab: add gitlab-runner role also on eqiad physical machines

327c21dc8b-+-site: use gitlab-runner role on all new physical gitlab-runner servers

25e3f1bcbf-+-add gitlab-runner role on new physical server gitlab-runner2002

b43f86d116-+-Revert "profile: add etcd tlsproxy certificate monitoring"

3d21b94a55-+-profile: add etcd tlsproxy certificate monitoring

585934d198-+-elasticsearch: Java version is a fact, does not need to be a param

58d5a41e22-+-Puppet: Add netbox-dev2002

c5c2cd71e2-+-P:base: ensure apt is realised before standard packages

e24a943c3c-+-P:base: ensure we contain apt before moving on to installing packages

366bd01863-+-Switch webperf1001/1003 for eventual removal

a21f6e2db1-+-parsercache.pp: Monitor event_scheduler on parsercache

53a10e3648-+-site: Reimage cp5002 as cache::upload_haproxy

d94cc31f15-+-profile::openstack::codfw1dev::db: remove a ref to mysql-server

22c142bf57-+-profile::openstack::codfw1dev::db: mariadb-server instead of mysql-server

368cd3c5e7-+-elastic: use java version to choose GC flags

2d32a6956a-+-P:wikidough: do not automatically restart the pdns service

01a9cc5db5-+-Elastic: Use OS major version for GC flags

304f466b66-+-graphite: remove absented crons

5c254d6f21-+-Configure superset-next.wikimedia.org domain

b0bde3c857-+-P:openstack::encapi: add tls for write endpoint

1d84c3dd24-+-dnsrecursor: fix config file group

144f4ff482-+-dnsrecursor: refactor module (see detailed commit message)

b80d88f09d-+-Apply role::webperf::processors_and_site to webperf1003/2003

cc7e09e796-+-Add a few packages needed for CAS build

4a00e85c1d-+-Add new profile to build the CAS debs

b557837e20-+-puppet_compiler: manage facts cache dir

86b8c37c31-+-openstack_exporter: don't use ensure twice for service

2bdb1e473d-+-profile::installserver::proxy: update squid template

a2b9c3c782-+-P:toolforge::prometheus: support Cinder volumes

7fc4fefa0e-+-P:toolforge::prometheus: add toolsbeta support

397907b1a7-+-Add new pki and krb node to site.pp and netboot.cfg

7974e385df-+-graphite: migrate archiver crons to systemd timer jobs

9d141851de-+-P:toolforge::prometheus: remove absented resources

b604c7348b-+-Split watchrat URLs by need of proxy usage

2a76381149-+-Periodically run purgeExpiredBlocks.php on small wikis

32e2d2710f-+-Remove ref to cloudvirt1018

dae3aa1684-+-site.pp: remove cloudvirt101[2,3,4,5].eqiad.wmnet

d939879a06-+-lvm::volume: add createonly flag and use in cinder backups

3230e41faa-+-prometheus-openstack-exporter: only run it on the primary server

813aa617b2-+-acme_chief::server: Enable monitoring for reload-acme-chief-backend timer

4cfe2abf3e-+-P:toolforge::prometheus: simplify prometheus config

134416b62c-+-P:openstack::rabbitmq: cleanup

47d0e9965a-+-P:openstack::nova::compute::service: replace query_nodes with role_hosts

98c368751c-+-opensearch: enable curator version override

48cb2d5237-+-Add new aqs node to site.pp and to netboot.cfg

d5d68605aa-+-add gitlab-runner1004 to site.pp

01d05a6c9c-+-Revert "opensearch: ensure curator is >=5.8.1"

f808db9ea3-+-opensearch: ensure curator is >=5.8.1

8768be8728-+-adding gitlab and gitlab runner hosts to site.pp

0baf353a08-+-puppetdb::query_facts: update return type

0ef7c8a20c-+-puppetdb::query_facts: try to optimize

5b3bd93426-+-Revert "C:ssh::publish_fingerprints: update to use new_query fac..."

a85124ef84-+-puppetdb::query_facts: add return type hint

4469220533-+-C:ssh::publish_fingerprints: update to use new_query facts function

231aa878b8-+-puppetdb: add query_facts function

4e46b12ffd-+-mariadb: Reference the actual VRTS passwords in the m2 grants file.

506138b06d-+-mariadb: Use ROW binlog_format for db_inventory.

f9e3e4b0ec-+-P:cumin::master: Add contact owners aliases

8bdcb9e156-+-Add ganeti10[29|3(012)] to site.pp and netboot.cfg

ef62d0763d-+-Bumping refine job version to 0.1.27

e224043a34-+-add new parsoid servers parse1001-1024 to site.pp

e4aa499c59-+-P:debmonitor::server: drop query_nodes functions

45a3d355b5-+-Make /etc/helmfile-defaults/private readable by deployment group

f8efef1ff8-+-dnsdist: use absolute path for systemctl

cbdbf6de23-+-Revert "Revert "Revert "mwdebug_deploy: switch back to using the root user"""

2b6e3f0c98-+-P:scap::dsh: Add scap targets as a dsh group

e127f79888-+-P:cumin::master: Add documentation and fix minor lint issue

1f0a039f04-+-varnish: remove absented resource

c39db21281-+-Add new gitlab nodes in site.pp

1233deb1b7-+-Remove references to cloudnet200[2,4].codfw.wmnet

a62cc278da-+-Prepare cloudnet2002-dev and cloudnet2004-dev for decom

c4db1ba856-+-varnish: remove old-style request filters

a0f9f90e13-+-Clean up helm2 specific code and environment variable

3e1d33f6c7-+-Fix permissions/ownership of helm directories

2245daeac0-+-Revert "Prepare cloudnet2002-dev and cloudnet2004-dev for decom"

caebfe2882-+-Prepare cloudnet2002-dev and cloudnet2004-dev for decom

959635d865-+-prometheus: remove per-exporter up checks

610838044f-+-pc1014: Move to pc2.

f004b2ecb3-+-Update role contacts to refelect team name change

fc05be77d7-+-parsoid: move template for testing server to profile, remove old module

485ba5f0d7-+-profile: re-enable grafana db sync post 8.x upgrade

c5e7d50b4a-+-icinga: remove SMART check

c761ac3328-+-mediabackup: Clone localy the mediawiki-config repo

6f288fc680-+-varnish: add new-version dynamic request filter template

8100b18274-+-mariadb: Promote db1162 to s2 master

8b5d26b91c-+-Remove references to cloudweb2001-dev

9f66fe3e08-+-Make cloudnet200[45].codfw.wmnet into openstack network nodes

90801c35a3-+-site: use appserver in codfw C3, cleanup duplicate insetup definition

b2e908bbfc-+-docker engine - pick smart default for package name

3592573d4f-+-docker init.pp - make $version Optional

1dd3285a7a-+-profile::docker::engine - make $version Optional

ead4c6fecc-+-profile::docker::engine - Allow not setting version

286dbd9a46-+-P:wikidough: update notes_url to point to new monitoring page

aaefb5eacc-+-Remove puppet for cloudservices200[2,3]-dev

ec59d4f19f-+-Prepare cloudcephmon200[2-3]-dev for decom

55b07929c6-+-ceph: allow ceph user to access smart utils on mon nodes

e6e0ce8e9b-+-Prepare cloudweb2001-dev for decom

f517d8026c-+-P:wikidough: add a check to ensure service has been restarted

01f47e6146-+-P:systemd::timesyncd: move nrpe script to usr/local

01398531f0-+-Enable profile::auto_restarts::service for ulogd2

e1adf923a9-+-kubeadm: remove metrics files

ea1f1710be-+-P:openstack::rabbitmq: fix file permissions

cd83194fee-+-gitlab::runner: if on buster, ensure apparmor package is installed

e110a24ec2-+-gitlab::runner: ensure config dir is owned by non-privileged user

63d15d6895-+-gitlab_runner: ensure the full path to the config location exists

f68e93adb1-+-monitoring_service: specify units for configuration attributes

83b730477c-+-gitlab: ensure home dir for runner_user exists when running as non-root

babefccf2b-+-Fix up host globbing for ping servers

06331a664e-+-mediabackup: Hide diffs from mc config file

c08546dd61-+-Add four new k8s worker nodes to ml-serve-eqiad

45240419b7-+-mediabackup: Preconfigure mc client config on worker nodes

e4a02ed144-+-ores: support Celery 4 and 5 configurations

9f40bd63af-+-profile::ores::web: allow undef passwords for redis

2173175085-+-mariadb: Promote db1104 to s8 master

ed11513b82-+-monitor_eventscheduler.pp: Monitor event_scheduler on tests hosts

aa1b412fbc-+-Prepare cloudservices200[2,3]-dev for decom

9013bbe6a7-+-Make new cloudweb2002-dev node into a cloudweb node

4db5c379a3-+-Proof of concept for haproxy statistics tracking

a589f3358f-+-ceph::mon: actually install mon and mgr packages on mon nodes

a2cb2d71af-+-Make new hosts cloudservices200[4,5] into cloudservices nodes

cec5a20df9-+-Enable profile::auto_restarts::service for klaxon gunicorn webapp

a18c9acd99-+-Make cloudcephmon200[5,6] into cloudcephmon nodes.

a0700a0652-+-wikitech: remove absented mw-xml cron

6565ad7c02-+-cache: Fix varnish-frontend puppetization on non-etcd environments

0402e9d50c-+-thanos: reload rule via http endpoint

dc90d9ced2-+-P:openldap_corp: fix backups

a9dcc51595-+-wikitech: migrate mw-xml cron to systemd timer job

ef4db161ce-+-P:openldap: remove 'labs' branding

0abd290e89-+-openstack: cleanup enc api remains from puppetmasters

6d7d6451d0-+-Add new cloud nodes to site.pp and netboot.cfg

1fc8f8e275-+-analytics: remove absented clean_jupyter_user_local_trash cron

f496400d98-+-analytics: migrate clean_jupyter_user_local_trash cron to systemd timer job

57c328d20f-+-swift: add disable_fallocate config option

eea5f9bb66-+-Enable profile::auto_restarts::service for Prometheus

f576ea6c8c-+-mariadb: Stop special-casing db2093

82b157af6f-+-mariadb: Promote db1181 to s7 master

b35a57e052-+-scap: remove two absented files

6f4b921767-+-ci: remove absented gitcache crons

e3849c9f0a-+-role::mediawiki::maintenance: remove reference to cron

887e5a5c5d-+-raid::hpsa: fix distro logic that was exactly backwards

4bc8b030b1-+-raid::hpsa: install ssacli on Bullseye

67dfc62d99-+-ci: migrate gitcache crons to systemd timer jobs

a48860ef03-+-webperf: remove absented warm_up_coal_cache cron

881d77cb2b-+-webperf: migrate warm_up_coal_cache cron to systemd timer job

cac86b1554-+-Revert "Revert "mwdebug_deploy: switch back to using the root user""

237aff36dc-+-openstack: remove enc api from puppet masters

22f84ae032-+-Revert "mwdebug_deploy: switch back to using the root user"

894d6b3592-+-Declare new research-deployers group for airflow instances

67cee8f0e6-+-add chunkeddriver.py.patch to wallaby

857729b0ea-+-grafana: double-proxy for performance JSON meta data

1d6495c3ff-+-sretest: Remove absented external_clouds_vendors

5b35b80d9c-+-sretest: Uninstall external_clouds_vendors

1293e253a9-+-P:wmcs::prometheus: use a single entry for openstack-exporter

2a02b19538-+-wmcs: Remove unused role wmcs::nfs::secondary

6a4573b053-+-Adding new elastic servers to site.pp

12f0e948f2-+-service::catalog: add Spicerack comments

0316d8fc3c-+-Adding new hosts cloudstore101[01] to site.pp and netboot.cfg

95a22bcf55-+-P:toolforge::prometheus: remove paws jobs

5828bb3da5-+-P:wmcs::paws::prometheus: add kubernetes prometheus jobs

2d06cd12cf-+-prometheus-openstack-exporter: refresh profile for the new exporter

8fa0826aba-+-mariadb: Promote db1160 to s4 master

a4a45a1f89-+-openstack: remove horizon access to puppetmaster

79d2f22ec4-+-gitlab_runner: solve race condition to to make things work on first run

6bd6590bf0-+-Rename O:ldap::labs to O:ldap::rw

24a176bb8f-+-eventlogging - ReadingDepth schema has been deleted, don't attempt to ingest it

a48b398277-+-spicerack: install service::catalog configuration

4ec78c45e2-+-spicerack: simplify profile

dfe40192ff-+-Revert "phabricator: allow disabling ssh-phab service except on one host"

05b5aee603-+-phabricator: allow disabling ssh-phab service except on one host

2eae046451-+-mwdebug_deploy: fix resource type

bc078576d9-+-mwdebug_deploy: also re-add docker credentials

b15bea23de-+-Increase threshold for IPv6 RIPE Atlas probes from 65 to 90

5480791aa4-+-mwdebug_deploy: switch back to using the root user

f565bf9c7f-+-site: Reimage cp6001 as cache::upload_haproxy

8f35c6da27-+-site: Reimage cp6009 as cache::text_haproxy

804628e6eb-+-site: Reimage cp6002 as cache::upload_haproxy

2fe24f1f6c-+-site: Reimage cp6010 as cache::text_haproxy

734f0e207d-+-site: Reimage cp6003 as cache::upload_haproxy

ef9b54ce5c-+-site: Reimage cp6011 as cache::text_haproxy

5bf55c8ffe-+-mediaiki: add new member of the deployment group everywhere

6ba08c5c10-+-site: Reimage cp6004 as cache::upload_haproxy

ae65449db4-+-site: Reimage cp6012 as cache::text_haproxy

996a9ae593-+-mwdebug-deploy: run as mwbuilder, use release repository

87df049f67-+-site: Reimage cp6005 as cache::upload_haproxy

f5149e5365-+-external_clouds_vendors: install python3-git

bb2065ce8b-+-site: Reimage cp6013 as cache::text_haproxy

dfbf0183d8-+-site: Reimage cp3051 as cache::upload_haproxy

e202c51af6-+-site: Reimage cp6006 as cache::upload_haproxy

d3a2485d2c-+-site: Reimage cp3053 as cache::upload_haproxy

b000078061-+-site: Reimage cp6014 as cache::text_haproxy

5cf542c158-+-site: Reimage cp3050 as cache::text_haproxy

117a8901f7-+-add new dse-k8s-worker hosts to site.pp

041a895da6-+-update site.pp with new ml-serve100[5-8]

96595af591-+-ipmiseld: ensure service enabled and running

9a607bea97-+-spicerack: add logging clusters to elasticsearch config

f6148db84a-+-mail: link grafana dashboard from exim queue alerts

533990e3f8-+-O:openstack: add new encapi roles

bdb9f7ed53-+-openstack: remove 'labs' term from new enc servers

64394dcf8b-+-P:openstack::puppetmaster: split ENC api to a separate profile

eb08af9312-+-toil: remove absented systemd_scope_cleanup cron

0dfebeda7e-+-site: Reimage cp4021 as cache::upload_haproxy

28d571dc98-+-toil: migrate systemd_scope_cleanup cron to a systemd timer job

5561d3c9b3-+-site: Reimage cp4033 as cache::upload_haproxy

b340280116-+-Add webperf[12]00[34] to DHCP config/site.pp

ba9d6cf6b4-+-Enable profile::auto_restarts::service for parsoid::testing

d6f76a4eee-+-site: Reimage cp4027 as cache::text_haproxy

83fc668608-+-site: Reimage cp3052 as cache::text_haproxy

62a70cead8-+-cinderutils: remove absented file

f7f2b3499e-+-site: Reimage cp4035 as cache::text_haproxy

1931c9ee21-+-site: Reimage cp5001 as cache::upload_haproxy

e6033f14d4-+-puppetmaster:geoip: stop trying to download GeoIP1 legacy databases

da48aa49ca-+-httpbb: Clean up absented objects

9cdb98315a-+-httpbb: Add force => true to properly delete the old $install_dir

37acc7f52e-+-gitlab: fix duplicate backup_dir hiera key

07d0848207-+-cloudgw: relocate dataplane-specific sysctl params to ifupdown

d42cf12836-+-httpbb: Restore params to absented systemd::timer::job

3560367224-+-httpbb: Delete the git::clone and install via deb package

ab4b25a8a4-+-wmcs.backy2: fix typo in link to runbook for backup_vms

0c271127d2-+-logstash: set unit TimeoutStopSec of 2 minutes

041b3e34da-+-gitlab_runner: override ExecStart in service unit for non-root

d91f478e9e-+-cache::base: add check to netmapper modification

55fb747a90-+-site: Reimage cp5007 as cache::text_haproxy

f7fcfb3cb0-+-site: Reimage cp5013 as cache::upload_haproxy

89ef8786f3-+-gitlab: move backups to /mnt/gitlab-backup

48252b6f5a-+-site: Reimage cp6007 as cache::upload_haproxy

9261355805-+-site: Reimage cp5015 as cache::text_haproxy

c6308e80ce-+-cloudgw1001: use a custom name for the dataplane NIC

7625b6ab5e-+-Move Prometheus Apache setup to separate profile

d6d923e83b-+-dbbackups: Update valid_sections.txt permissions to be world-readable

ab4472eea9-+-dbbackups: Setup a valid_sections.txt config for db backup checks

43c05b0eed-+-geoip::maxmind: rename the update timers, don't use 'legacy' term

807cc298b2-+-certspotter: switch to a local CT logs list

023cb67a82-+-site: Reimage cp6015 as cache::text_haproxy

5be760a4b7-+-Revert "Temp remove codfw from wikidata updateQueryServiceLag check"

0259694851-+-site: Reimage cp5008 as cache::text_haproxy

82b21bdc8d-+-site: Reimage cp4022 as cache::upload_haproxy

b024e8035e-+-site: Reimage cp3055 as cache::upload_haproxy

e3b4906072-+-site: Reimage cp4028 as cache::text_haproxy

73c3ec8d2a-+-site: Reimage cp3054 as cache::text_haproxy

ec5a03fc7d-+-site: Reimage cp6008 as cache::upload_haproxy

47f7dce528-+-site: Reimage cp5003 as cache::upload_haproxy

6addd50147-+-Enable profile::auto_restarts::service for prometheus-atlas-exporter

d05f85327a-+-gitlab: pass restore interval to gitlab::restore module

ddd731276f-+-openstack::nova::api::service::wallaby: typo fix

ba5f76269f-+-nova-api/wallaby: remove redundant package requirement

01509f707d-+-nova api: Use a diff rather than a replacement file for regex hack

fcc88bb55f-+-site: Reimage cp6016 as cache::text_haproxy

551855a2da-+-site: Reimage cp5009 as cache::text_haproxy

f2fbab19bd-+-hiera/modules: Add config for ML staging k8s workers

d468431dca-+-site: Reimage cp4023 as cache::upload_haproxy

faa8260a6f-+-site: Reimage cp3057 as cache::upload_haproxy

5e1d044c8c-+-Disable automated restarts for ipmiseld

deb99ada79-+-hiera: Add ML staging k8s role

6d51511e07-+-gitlab_runner: override User of default service unit file

5dcb12ff47-+-Revert "gitlab_runner: overwrite default service unit file"

947f729011-+-gitlab_runner: overwrite default service unit file

96e13c06dc-+-site: Reimage cp4029 as cache::text_haproxy

c6a1899be9-+-site: Reimage cp3056 as cache::text_haproxy

44b91eff62-+-profile::conftool::requestctl_client: more fixes

7c5ae999b2-+-Stop using profile::base::linux419 on Hadoop nodes

4700b5cc99-+-Enable profile::auto_restarts::service for Routinator

1016994f7c-+-Enable profile::auto_restarts::service for ipmiseld

593d112db4-+-Enable profile::auto_restarts::service for prometheus-blackbox-exporter

ce014c07c6-+-requestctl_client: remove prefix, already in confd, fix path

631726d62e-+-profile::requestctl_client: brown paper bag fix

5de16f91dc-+-requestctl::client: install preview files for actions

c3b4b16d1e-+-mariadb: Promote db1100 to s5 master

37f6ef4e27-+-openstack::serverpackages::wallaby::bullseye: python3-eventlet from nochange

fdff4e57e2-+-Finalize WikipediaPortal eventlogging event platform migration

89820a5709-+-prometheus: pin ats-tls targets to class not cluster

7f5f83b739-+-coal: use Python 3, add cachelib dependency

eaa8c1fa78-+-site: Reimage cp2028 as cache::upload_haproxy

0365195c61-+-profile::calico::kubernetes: add optional istio-cni config

2b154e570c-+-site: Reimage cp2030 as cache::upload_haproxy

422b3bf338-+-deployment_server: fix handling of docker group

b56e06bef7-+-site: Reimage cp2032 as cache::upload_haproxy

da9a7e4c81-+-swift::ring: deploy by tarball not individual files

06a82b688c-+-gitlab: move systemd interval for backup and restore to hiera

7020ff9fbf-+-Enable profile::auto_restarts::service for Hue

2951adc203-+-k8s::kubeconfig: add ensure parameter

f511662eab-+-certspotter: Switch to systemd::sysuser

c337b7537c-+-puppetmaster: rsync swift rings from each cluster's ring manager

30251880ed-+-icinga: quote check_http_url_for_regexp_on_port regex argument

345cd780ad-+-site: Reimage cp2034 as cache::upload_haproxy

df02fcf5f3-+-P:wmcs::paws::prometheus: fix scrape rules

746d1f6481-+-site: Reimage cp2027 as cache::text_haproxy

4ff5635aaf-+-gitlab: remove conditional, always use gitlab::restore class

0a0eeb2838-+-paws: fix typo

1c98d5927a-+-Refactor Calico's CNI plugin config

9e1fa438e5-+-paws: add haproxy routing for prometheus

cdf140ed8b-+-swift::ring_manager - install_dir is managed by git::clone

902f0ec1ef-+-icinga: remove double quoting for gerrit health check

64c84ef497-+-lists: remove double quoting for http check

f9e63709ec-+-mariadb: Promote db1123 to s3 master

5c6ee6f026-+-geoip::maxmind: remove code for absenting old resources

33a195a0fa-+-profile::wmcs::nfs::standalone: stop nfs server if cinder volume is detached

3eac8243e3-+-paws: add paws prometheus role/profile

86a3df7a64-+-icinga: fix duplicate description for ChartMuseum

7c0f5aeb7f-+-swift::ring_manager: fix Icinga contactgroup name

028e590c3d-+-icinga: fix https expiry check

70ff9f8989-+-swift::ring_manager update contact group

c480962416-+-Request high-entropy Sec-CH-UA* client hints

2a0d3a12de-+-swift::ring_manager typo in #!

ff9f8c216b-+-openstack.cinder: Add patch to the backups chunkeddriver

b1d07aeb44-+-swift: deploy swift_ring_manager to one node per cluster

6e3dd0b68e-+-decommission kubernetes[12]00[1-4]

f829f6fc9f-+-site: Reimage cp2029 as cache::text_haproxy

48a644d874-+-site: Reimage cp2031 as cache::text_haproxy

6d5f705297-+-puppetmaster::frontend: install requestctl

850e245067-+-site: Reimage cp2033 as cache::text_haproxy

df0cfee1c0-+-zuul: prune heads and tags on each fetches

fa07ec931b-+-zuul: stop keeping reflog on the mergers

a9047133d6-+-Move cloudstore1008/1009 to role::spare

312362ae85-+-wmflib: add class_hosts

5cf6079932-+-mediabackup::storage: Switch to systemd::sysuser

5953a5e55e-+-toolforge: remove ingress-nginx manifests

23de24fc6b-+-wmcs.backy2: add link to the runbook for backup_vms

fe3f436f4d-+-cloudgw: don't install kernel or nft from backports

7aa5fbdbf0-+-keepalived: use version from bullseye-bpo

12b61249ec-+-Make cloudvirt1047 a virt node

3c0a1bdeca-+-Add restbase2027 to site.pp and netboot.cfg

ed0daee724-+-R:tlsproxy: Add missing documentation and remove some v2/v3 compat

1149abab1c-+-package_builder: run docker prune on a timer

742153cc0c-+-toolsbeta: update nfs server location

ccedb13f56-+-Updating site.pp for an-worker hosts

e4a0f63ceb-+-P:idp::client::httpd: fix expiry check

927918fe1d-+-orchestrator: Use macros in apache config

38e5ab8ad3-+-P:idp::client::https::site: Add check_http_expiry to idp services

726a3be478-+-[wdqs] test jvmquake options on the public cluster

a32199656c-+-P:librenms::web: add check_https_expiry

2f496f9ed7-+-P:lists::monitoring: Add check_https_expiry check

93f354115d-+-P:microsites::peopleweb: add check_http_expiry monitor

2b00f023aa-+-P:netbox: add check_https_expiry

f7c44fe9b3-+-P:phabricator: add check_expiry for phabricator

276a3f9aa5-+-P:icinga: Add ssl expiry check to external monitoring

a0b8e67243-+-backup: fix filesets definition for mw on k8s

92cfe164fd-+-P:openstack: use correct vhost when checking sl expiry

13682adf4e-+-P:icinga::debmonitor: correct check definition

699736ab62-+-Adding ml-cache1001-3 to site.pp

cc69284ab8-+-profile: Rsyslog omkafka configs use new ca bundle

eb39c6b2e2-+-C:icinga::commons: Add ssl expiry checks for gerrit

a05c9eb120-+-C:openstack::keystone: Add ssl expiry checks for keystone

88e97d7a85-+-C:lvs::monitor_services: Add ssl expiry checks for lvs

ece76c18a3-+-C:noc: Add ssl expiry checks for noc

9ad871256e-+-P:chartmuseum:  Add ssl expiry checks for debmonitor

215332aa26-+-P:debmonitor::server:  Add ssl expiry checks for debmonitor

717861e9ec-+-P:docker_registry_ha::registry:  Add ssl expiry checks

4ab857f959-+-C:icinga::commons: Add ssl expiry checks for commons

74949735a4-+-C:icinga::gitlab: Add ssl expiry checks for gitlab

8d54f06edb-+-C:icinga::monitor::cloudelastic: Add checkes for certificate expiry

6bf048b04d-+-C:icinga::commons: Add ssl expiry checks for debmonitor

cb5cf29773-+-dnsdist: remove redundant rate limits (attempt 2)

b80ef0747f-+-C:icinga::monitor::cloudelastic: refactor to make a bit more DRY

a9f7f27b2a-+-kubeadm::helm: remove absented file

c00885b446-+-profile::java: Also add component/jdk on bullseye

b94b42bb60-+-P:environment: Add ablilty to inject environment variables

c1a04edb9e-+-deployment_server: add mediawiki on k8s releases repo

8ef94a9acf-+-kubeadm::helm: configure default HELMFILE_ENVIRONMENT

5221531b9d-+-kubeadm::helm: use systemd::environment

9770eaf8fc-+-site: Reimage cp1076 as cache::upload_haproxy

1f5d1aea35-+-Enable profile::auto_restarts::service for uwsgi/graphite-web

8e0dcd257e-+-Enable profile::auto_restarts::service for imagecatalog

9360d6839c-+-site: Reimage cp1078 as cache::upload_haproxy

acd5c90cb3-+-envoy: Remove v2 config API support

920880472e-+-external_cloud_endors: ensure we sintall the python3-conftool dependency

47f47185ab-+-systemd:environment: fix typo in docs

9630598627-+-kubeadm::helm: fix typo

090b443b23-+-kubeadm::helm: install helmfile

98ba210a66-+-P:puppetboard: don't monitor testing sites

a01968df79-+-P:pki::multirootca::monitoring: triple escape :/

3ad9e82a7c-+-site: Reimage cp1080 as cache::upload_haproxy

da0f575cda-+-PKI: add '}' back

e75553b963-+-openstack::nova::fullstack: restart service on setting changes

2aa6aab407-+-PKI: double escape, one for puppet one for icinga

486fa9b164-+-P:pki: fix nagios checks for PKI

6af0d7a182-+-site: Reimage cp1082 as cache::upload_haproxy

ad36964953-+-cluster::management: backup also /home

bc3e97978f-+-Reenable the sflow job

730ed6d8b7-+-site: Reimage cp1081 as cache::text_haproxy

814e0edf64-+-Enable profile::auto_restarts::service for nginx/htmldumps

a6e8827492-+-site: Reimage cp1079 as cache::text_haproxy

243a18bfa7-+-mediabackups: Install package and its dependencies through .deb

4150bb7bc2-+-karapace: add karapace role

2f1452d7e3-+-openstac: networktests: fix typo

97c4f6ccce-+-P:icinga: add profile for performance tweaking

18d8d26115-+-openstack: networktests: discard even more hostkey checking stuff

d80190d81b-+-mariadb: DRY username of wikiuser to hiera

4a39db169b-+-icinga: avoid double quoting for the URL

4401983560-+-site: Reimage cp1077 as cache::text_haproxy

110acd9e17-+-profile::logstash::production: use base truststore

98a74cb70f-+-varnish::frontend: install dynamic actions everywhere

7c63eb7662-+-site: Reimage cp1075 as cache::text_haproxy

dcd47a010d-+-check_mw_versions.py: Fix problem induced by recent scap changes

0ae90f1e60-+-P:java: update profile::java to use systemd::environment

ce15444339-+-Enable profile::auto_restarts::service for apache/orchestrator

2870a938a6-+-Enable profile::auto_restarts::service for ssh-gitlab

26701e7218-+-cloudvirt/libvirtd: specify manual 'start' command to work around package bug

721f5d861a-+-cloudvirt/libvirtd: further attempt to fix startup ordering

f1f88f5682-+-cloudvirt/libvirtd: another attempt to fix startup ordering

100d769042-+-dbbackups: Update runbook for backup alerts

b5a10179c8-+-dbbackups: Migrate remote backup (snapshot) cmd line to 0.7 format

435af904d3-+-dnsdist: remove redundant rate limits

be7328d39b-+-P:netbox::host: fix motd title

fb6157b881-+-motd::script: script names need to be lower case to be detected

e4faa4ea7d-+-P:netbox::host: relx type checking as we have racks like \d.\d.\d

2295ee2c6e-+-P:base::production: Add profile::netbox::host

3de594c715-+-instance.pp: Enable event_scheduler by default

b70fe1d272-+-mariadb: Set event_scheduler = ON by default

9be6ba7468-+-P:pki::client: make the bundle source location configurable

96a522dd62-+-ncredir: Use profile::lvs::realserver

e900b3b6cd-+-P:pki::client: add documentation

1680685129-+-P:environment: fix zshenv permissions

047baef178-+-P:environment: move zshenv to a template

20ea2391b3-+-P:environment: fix zshrc systemd env injection

e075482ebd-+-Restrict sourcing of systemd environent.d to Buster/Bullseye

16bbf0fe9a-+-gitlab_runner: remove duplicate ferm rule for AAAA

b173480aa6-+-beta-logs: use new kafka truststore

eaccec7b72-+-fix profile

bfdf93b76c-+-P:environment: actully set the content

124f5f8120-+-P:environment: fix systemd-environment variable injection for bash

8d9955b3e2-+-prometheus: restart elastic exporter on code change

50344d77b0-+-cirrus: Reenable saneitizer

6af870f766-+-systemd: Add new define to manage user service environments

a358ee3208-+-P:environment: Add support for environment.d to zsh and bash

008cdaec5d-+-[wdqs] cleanup the updater setup logic

4b430e516d-+-Revert "Temporarily disable traffic data purge"

571b7bdf99-+-logstash: re-enable service restart on config changes

9bfbf693e2-+-varnish/frontend: consume etcd data for dynamic banning of requests.

43e503caa9-+-opensearch: use separate rundir per instance

fd677a3eba-+-Add kubernetes1018-1022

a0be4d161b-+-gobblin - Use new gobblin-wmf-core jar in hadoop test cluster

6cac59d562-+-openstack: add neutron-rpc-server and ensure up

6ec43dac03-+-C:puppet_compiler: bump version to 2.3.0

3a8110fc0e-+-Enable profile::auto_restarts::service for Apache on an-web

7781924c84-+-P:wmcs::prometheus: set team: wmcs on all alerts

ccb30615dc-+-dumpsdata1006 setup info

40df6cf4ea-+-Added gobblin_shaded_jar param to gobblin_job

ca59da8221-+-Move vendored modules to vendor_modules

af3e1bcebc-+-Enable profile::auto_restarts::service for apache/CI

8d10698e16-+-puppet_compiler: bump software version

bc7b2bf028-+-vrts: rename mail module class variables

674e04109b-+-C:java: Refactor java code to work with cloud

5ee5f4d65e-+-varnish: get blocked-nets from etcd

996c8e487d-+-backy2: move sqlite db to /srv

8013902d4a-+-Prepare to move vendored modules to vendor_modules

970a15b6d2-+-O:kafka::logging: ensure that all base classes are initiated first

5b7ea377a9-+-Fix directory structure/role name for ML staging etcd

cffae9ee12-+-Add etcd setup for ML staging cluster in codfw

10f506cd55-+-C:java: use correct defined call

c4bf646928-+-C:java: update dependencies

18093b7456-+-Revert "C:java: update dependencies"

5c1751cc3d-+-C:java: update dependencies

6ab293437e-+-P:java: Use lower case titles

c5a30e8509-+-Standardize the stats system user uid

caefec16d5-+-Increase max.incremental.fetch.session.cache.slots on kafka jumbo to 2000

3e0d62e28b-+-P:java: add explicit dependency for java class

fd86da5e68-+-gitlab_runner: restrict docker traffic with additional ferm rules

e7e91d9add-+-certspotter: more tuning: use OnUnitInactiveSec

6020b4695a-+-[wdqs] adapt updateQueryServiceLag...

cef51e2789-+-certspotter: set send_mail_only_on_error to false

4a44eabdd9-+-certspotter: re-enable systemd timer

49f0fec280-+-[wdqs] switch wdqs1010 to the streaming updater

c144e8cf35-+-P:toolforge::static: publish SSH fingerprints under /admin

15fddd15a3-+-P:cache::base: add netmapper file for abuse networks

81c3beb49c-+-Enable profile::auto_restarts::service for apache/doc

2dc642dd64-+-Remove cumin2001 from Puppet

42c4b71db8-+-Stop loading wddx PHP extension with PHP 7.4

4ad34c1add-+-site.pp: Specify db1132 status

cd5a9a2031-+-certspotter: add -start_at_end to only fetch new logs

0ecd8480e0-+-mirrors: use @resolve for syncproxy2.wna.debian.org

30a258eafe-+-mirrors: Raise ssl ciphersuite strength

0919aa12aa-+-puppet_compilers: bump to puppet-compiler version 2.2.0

82ae7e8a42-+-motd::message: use the title as the message by default

80e95529c5-+-motd::message: add new define for simple motd entries

3b7f75a1a2-+-P:tcpircbot: cleanup allowed hosts

526ed49d3b-+-certspotter: Temporarily disable certspotter

d5bb09cfec-+-Revert "Also enable component/jdk8 for bullseye, also present there"

68941ec112-+-Also enable component/jdk8 for bullseye, also present there

26a1838422-+-Add profile::java to role::builder to install JDK 8/11

093ec1726d-+-Enable profile::auto_restarts::service for uwsgi-netbox-scriptproxy

6de51462d2-+-certspotter: set send_mail to true to email the output of the service

6f45b7741b-+-profile: update graphite mediawiki grafana dashboard links

54baaa8579-+-search: update grafana dashboard links

3d74a366fd-+-zookeeper: update grafana dashboard links

49088ecf44-+-caches: update grafana dashboard links

03c8985ec7-+-puppet_compiler: fix netbox checkout path

abdf9ba89a-+-P:puppet_compiler: add netbox checkout to puppet compilers

98d8203fa7-+-certspotter: update package and replace cron with systemd timer

c4505cc127-+-role::cluster_management: Remove support for buster

6e9aa9140a-+-ferm: SERVICES_KUBEPODS_NETWORKS to WIKIKUBE_KUBEPODS_NETWORKS

7a03582337-+-Merge rdb2008 and rdb2010 site.pp stanzas

e75eaf2e1c-+-C:varnish: add the external cloud vendors file to the cache clusters

655239c381-+-puppetmaster: download public clouds, upload to etcd

0f6a1f7453-+-external_cloud_vendors: some addtional follow up fixes

d713420fdc-+-external_clouds_vendors: Add ability to save data to conftool too.

ab417e10f6-+-C:pupetmaster: add support for netbox-hiera git repo

24cfa58329-+-db_inventory.pp: Remove binlog override

4211c98e0a-+-db1132: Move it from m5 to s1

b512fe7a00-+-C:external_clouds_vendors: follow up fixes

a971542218-+-hadoop: update grafana dashboard links

ee4993c423-+-eventlogging: update grafana dashboard links

8e8d7afc87-+-profile::mirrors: add headers module for apache2

2958e00bd7-+-profile::mirrros: switch to apache2

34941e4689-+-puppetmaster::gitclone: small clean up patch

ebd4468bde-+-profile::mirrors: move mirrors module into profiles

cb7af420ee-+-Add boot configuration for karapace1001

2d8bc8310a-+-O:external_clouds_vendors: add dependency on systemd::sysuser

71c657571f-+-O:external_clouds_vendors: New module for fetching cloud networks

5cd6822dda-+-Fix definition of /srv/pwstore

4daca70682-+-site: ms-fe1012 no longer insetup

f82c87c0c5-+-Create /etc/spicerack/elasticsearch/

387a9dc36c-+-python::venv: Create deploy-foo user using systemd::sysuser

5836cf3f85-+-mariadb: Promote db1107 to m5 master

9cc30449d6-+-Add role::insetup for ms-fe1012

c7bbbef3a9-+-Wikibase dumps: Lower batch size (reduce run time)

65ac9f09a9-+-gitlab_runner: add dedicated service unit file

3e10307df5-+-elasticsearch: move cluster configuration to puppet

136beaec03-+-C:puppetmaster: clean up and fix up docuemtnation

7714c88cb5-+-P:wmcs::prometheus: drop blackbox checks for services in the cloud realm

0d05a635f5-+-OpenStack: add manifests for openstack wallaby

d00a2fd00b-+-P:wmcs::prometheus: set protocol for https scrapes

039759dd32-+-P:netbox::automation: Correct reposync path

0954b9529c-+-C:reposync: Add ability to control user and group permissions

7be5276e11-+-P:netbox::automation: use /srv/reposync

e71948bcf4-+-Added config for the datahubsearch LVS service

e228932fb0-+-P:spicerack::reposync: add netbox frontends as remotes

707cd760a6-+-gitlab_runner: add gitlab-runner to docker group, change folder permissions

c3be136f9c-+-systemd::sysuser: create option to add additional groups to user

38b90871cc-+-Move some common resources to the opensearch::server profile

a98f53b354-+-Add a profile specific to datahubsearch servers

4d58564f87-+-site: Reimage cp1083 as cache::text_haproxy

356a742949-+-site: Reimage cp2035 as cache::text_haproxy

cfc74bd089-+-P:wmcs::prometheus: update blackbox urls

ade3625aee-+-Switch cumin2001 to insetup role

6ac81c00ff-+-P:wmcs::prometheus: update pdns ports

316df24a1f-+-maps: update grafana dashboard links

19d1aaf7f1-+-zuul: update grafana dashboard links

f625eb0af8-+-P:prometheus::ops: fix powerdns-auth port

c9885a85ae-+-hieradata: cloud: Set monitoring_hosts as empty

4ea51dd456-+-site: Reimage cp3058 as cache::text_haproxy

f9020ac307-+-R:systemd::sysuser: add support for id => "-:groupname"

8d8687e92b-+-site: Reimage cp5010 as cache::text_haproxy

8ec7c7cc85-+-openstack::haproxy: add more flexibility for frontends

bffc884886-+-openstack: haproxy site definition is not a profile

0593d4cf93-+-toolserver_legacy: add a block-all robots.txt

cd9c336363-+-site: Reimage cp4030 as cache::text_haproxy

963fc16503-+-site: Reimage cp1085 as cache::text_haproxy

82e7fb0d9b-+-site: Reimage cp2037 as cache::text_haproxy

38b2e6ecdd-+-site: Reimage cp3060 as cache::text_haproxy

4dd1ae1022-+-site: Reimage cp5016 as cache::text_haproxy

3049fa492c-+-site: Reimage cp4036 as cache::text_haproxy

6daa5bb545-+-site: Reimage cp1084 as cache::upload_haproxy

a34a8da4fd-+-Remove cumin2001 from list of Cumin hosts

8eefb2bd5d-+-site: Reimage cp2036 as cache::upload_haproxy

ec052fe8b7-+-openstack: fix remaining http keystone urls

0808013e9c-+-site: Reimage cp1086 as cache::upload_haproxy

d69456ae58-+-site: Reimage cp2038 as cache::upload_haproxy

3f2a035f9b-+-gitlab_runner: fix service definition

88ebead7eb-+-gitlab_runner: execute gitlab-runner as non-root

bca5abe2d6-+-mw130[2-6]: Remove and decomission

9d7259ac28-+-P:netbox::automation: Add reposync with netbox-hiera bare repo

d55b6e49c7-+-C:apereo_cas: make session configurable

8832fd263c-+-site: Reimage cp3059 as cache::upload_haproxy

325d8792e5-+-site: Reimage cp4024 as cache::upload_haproxy

fc6a22ddf2-+-site: Reimage cp5004 as cache::upload_haproxy

a8c13a2336-+-rdb1005: Remove from site.pp

811e9fc648-+-rdb1011: Switch to master

7dbaec51e5-+-kafka: update grafana dashboard links

bb2184db41-+-graphite: update grafana dashboards links

4aa0b9c542-+-C:reposync: update git init command

84da9af2d3-+-C:reposync: update to use exec git init

fd11c1b24f-+-C:reposync: Add require on git clone command

c42d6793b3-+-wdqs/elastic: Remove icinga checks after moving to alertmanager

70e3a385c4-+-Icinga: refactor network monitoring

4da2f676c2-+-Icinga: Add Juniper image to IPv6 items

aee9bfcd20-+-Icinga: use parent switch shortname

ae84ecb4c5-+-Icinga: add icons to Juniper devices

743d89c40d-+-wmcs: add runbook url to the backup_cinder_volumes alert

7e3b430924-+-P:wmcs::prometheus: deploy alert rule from ops/alerts.git

0b605ac45e-+-C:apereo_cas: add documentation and clean up minor lint issues

13fbba6c83-+-prometheus: use single probes/service job

f4b4e29535-+-P:idp::client: add Wmflib::HTTP::SameSite type

fb66f7df0f-+-rdb1006: Switch to decom

8d20a3577a-+-Change Grafana dashboard links to new format

ec6b3272bb-+-Add kubernetes20[19-22] to wikikube codfw

c3496a6a9c-+-gitlab: remove realm check, move listen_addresses to hiera

9be196b9ab-+-Enable profile::auto_restarts::service for puppetdb microservice

d0d387189f-+-analytics_cluster::datahub::opensearch: add firewall and base_checks

adb371e6e3-+-elastic: fix filename of tmpfile

18beae8279-+-elastic: prevent rundir from deletion

dd97162338-+-dumpsdata1007 info

6b50e8bcae-+-site: Reimage cp3061 as cache::upload_haproxy

f0a6ba4dd8-+-Enable profile::auto_restarts::service for apache/pki discovery

abbe01d292-+-maps: enable slow query log in eqiad

4759889429-+-Set default Airflow concurrency limits for an- airflow instances

5ee14012fb-+-site: Reimage cp5014 as cache::upload_haproxy

d975e4f620-+-geoip: add explicit syslog_identifier

46c2122c36-+-Enable profile::auto_restarts::service for smokeping

af39127c7a-+-C:geoip::data::maxmind: update systemd timers

b4819be357-+-P:configmaster: parametrise server names

28c2062385-+-site: Reimage cp4034 as cache::upload_haproxy

51bb433f7f-+-Add entries for ML staging control plane VMs

2016475a5c-+-Extract ssh fingerprint publishing to an independent class

49e1d18127-+-Add kubernetes2018 to wikikube codfw

8de326414d-+-gitlab: avoid $realm check, simplify ferm rules

bdf1e94713-+-wikistats: move repo from operations/debs on Gerrit to cloud on Gitlab

76c5581347-+-git::clone: allow gitlab as a source

d132a3b5ee-+-Remove ganeti2008

6ba4aab3ae-+-ipmi::monitor: ensure /var/cache/ipmiseld directory exists

bfd7dfbc95-+-Add insetup role for ML staging etcd VMs

6aa76fc928-+-ipmi::monitor: install freeipmi-ipmiseld on metal by default

35aabefcca-+-Restrict filesystem_avail_bigger_than_size check to Stretch

c411286347-+-httpbb: Add some tests for ores

6a051ef30e-+-site: Reimage cp1087 as cache::text_haproxy

c85be144ee-+-site: Reimage cp3062 as cache::text_haproxy

b22a74f50b-+-wmcs-cinder-backups: Increase timeout and decrease frequency

ec637cb6c0-+-site: Reimage cp2039 as cache::text_haproxy

24d91b8b2a-+-Remove ganeti2007 from Puppet

dbe7c08d81-+-otrs: rename module variables

cbc2c721ee-+-Enable profile::auto_restarts::service for auditd

87027d9d59-+-Revert "rsyslog: add 00-load_modules.conf"

a005e0a526-+-rsyslog: add 00-load_modules.conf

ac9ecb5492-+-site: Reimage cp5011 as cache::text_haproxy

e28caa9f93-+-site: Reimage cp1088 as cache::upload_haproxy

5e350dcb2e-+-site: Reimage cp3063 as cache::upload_haproxy

fe41591fc4-+-site: Reimage cp5005 as cache::haproxy_upload

55587ec5b9-+-openstack:galera:node: make sure prometheus-mysqld-exporter is running

1146d21682-+-site: Reimage cp2040 as cache::upload_haproxy

da10d8bd27-+-site: Reimage cp4025 as cache::upload_haproxy

064a12f9d7-+-cache::haproxy: Provide a haproxy-restart script

d366c4e0c2-+-cache::haproxy: Use HAProxy 2.4

cc30bf2b4b-+-Readd packages needed for node but with conditional for Bullseye

7333f73b67-+-prometheus: ditch automatic icmp probes for service::catalog

c61259e0d2-+-query_service: Repair oauth activation

f83032e5fd-+-C:package_builder: revert 765250

70812b8695-+-Add elastic208[3-6] to site.pp

6b15ac303a-+-dynamicproxy: manage DNS records

7185641c29-+-wcqs: Provide access token secret to blazegraph logging

2accc72bcf-+-query_service: Simplify jvm arg handling

280ba836e2-+-mjolnir: Restore prometheus_port parameter

c28f053623-+-cirrus: Alert when # pages Saneitizer fixes high

121208b232-+-Revert "dynamicproxy: manage dns in the api"

24a0a0495f-+-Revert "cirrus: Alert when the rate of pages fixed by Saneitizer is too high"

4893902727-+-Revert "cirrus: add docu link for saneitizer alert"

9b3f793cfc-+-cirrus: add docu link for saneitizer alert

438f240cde-+-cirrus: Alert when the rate of pages fixed by Saneitizer is too high

f341dfcc01-+-dynamicproxy: manage dns in the api

3429cc309c-+-mjolnir: Remove support for < stretch

b3024bdf03-+-mjolnir: Add python3-swiftclient for debugging

e08fcf0ed2-+-elastic: officially decom 10[32-47]

205fd2b653-+-exim: add the ability to silently drop senders

d2bf75ac9b-+-deployment_server::kubernetes: use the correct docker firewall class

f8412b7e3b-+-r_lang: remove unused biocLite.R

59f632a57c-+-deployment_server::kubernetes: add docker firewall profile

9119cfaa76-+-Hook up cloudmetrics prometheus to alertmanager

f2f0e5b3e7-+-ci: Qemu image and snapshot creation

c6483fa146-+-galera: type fixes

994fa5a357-+-galera: install packages from our custom component

7232071ba8-+-P:bird::anycast: use a new variable instead of overwriting $multihop

6e864fbe42-+-Bird: disable multihop when peer is the default route

c3f246810b-+-remove clush modules, profiles and roles

997c8e3951-+-P:openstack::cumin::target: redefine Ferm $CUMIN_MASTERS

d3e3cbcee1-+-P:wmcs::prometheus: update rabbitmq metrics port

a8d450c6ee-+-P:wmcs::prometheus: drop tools-redis jobs from cloudmetrics*

695bed58db-+-deployment_server: re-add mwbuilder to the docker group

fcd819b1ac-+-service: generate config yaml in puppet instead of via templates

b15b8be07b-+-varnish: change the default archive component for varnish

666b560185-+-Icinga: add drmrs routers mgmt interface

0cf679ae0a-+-discovery_dashboards: remove unused profiles/roles

a849146215-+-C:package_builder: only install node-babel7 on bullseye

1f3f626a81-+-Make ganeti2029/ganeti2030 Ganeti nodes

25926af9e1-+-C:package_builder: install tools to build node packages

e2cc1c6422-+-ganeti: Retire ganeti216 option

ba126abc41-+-prometheus: fix quantile config value type

4d433e4c0d-+-Revert "Disable cluster rebalances temporarily"

200b76566d-+-Add new elastic2073 to elastic2082 to site.pp

4943c89671-+-P:wikidough: add monitoring for IPv6 endpoints

a18176de21-+-Temp remove codfw from wikidata updateQueryServiceLag check

d1f337ce31-+-remove references to centrallog2001

4e191a0745-+-P:mail::mx: add max_runtime_seconds to systemd_timer

155f96e23b-+-k8s: update grafana dashboard links

dc7507cdad-+-Revert "prometheus: add heartbeat collection on mysqld_exporter"

b84c1fa2b8-+-prometheus: add heartbeat collection on mysqld_exporter

2b72e110f7-+-common.yaml: make netbox_api_url a global

212ef8503d-+-P:spicerack: Add back missing data

74afa9165b-+-P:netbox: use token not tokens

5643978bc1-+-P:netbox: tidy up netbox profile

1db646020d-+-Absent the eventlogging_to_druid_job job temporarily

b374772870-+-Add new eqiad leaf switches to monitoring.yaml

027268ce23-+-Icinga/netops re-organize devices

b2c0fc0c69-+-db1125: Install mariadb 10.6

be9ddfe3c2-+-Try to fix ordering around /usr/share/trove-common/api-paste.ini

4fd2237ad3-+-trove::service::victoria: create /usr/share/trove-common/api-paste.ini

f136ac2d21-+-prometheus: default Host header to SNI

0f7b51b9f3-+-Disable Junos alarms check by default

0377ce65fe-+-Add drmrs routers to monitoring

0ea56c2587-+-C:cassandra: add optional java_package variable

c9736d00ca-+-prometheus: pass extinfo-url to icinga-exporter

f4efb35f63-+-r_lang::bioc: remove unused module

3bbf092d4c-+-product_analytics: remove unused profiles/roles

0ff89b77be-+-prometheus: inject 'source' label to alerts

984765c0d0-+-thanos: add relabels to rule

bc52d7e8c0-+-db1107: Move from m3 to m5

17f1c72299-+-OpenStack cinder: monitor snapshots in 'admin' project

bb2c564b40-+-Openstack Cinder: Include service monitoring

5ba261bd17-+-Add kubernetes2019, kubernetes202[0-2] to site.pp and netboox

5560ee74db-+-opensearch: change log4j appender.ship_to_logstash.layout

4e7c28322d-+-Add ml-cache200[1-3] to site.pp

9171114568-+-opensearch: make curator version bullseye compatible

50267c8058-+-OpenStack nova: Increase timeout for check_flavor_properties

0299148663-+-elasticsearch: allow using elasticsearch v6.8

0a8c005b37-+-Add new Eqiad row E-F elastic servers to puppet with basic role

00c20d781a-+-parsoid: remove unused module

f445187160-+-openstack::designate::dns_floating_ip_updater: remove python-ipaddress dep

42527ea551-+-openstack::designate::dns_floating_ip_updater: remove python-ipaddress dep

f00232dd94-+-Remove unused module xvfb

c2ceb1e0c2-+-Openstack Cinder and Nova: tweak cgroup kernel settings on Bullseye

26324bc01b-+-ini(), php_ini(): convert to modern Ruby function API

1194ebbc76-+-Remove puppet:///files and move files to modules

d6e410ac7c-+-P:wikidough: enable IPv6 in backend recursor

0a1fa93120-+-dnsrecursor: allow outgoing IPv6 queries

5f0d7402ec-+-Remove ordered_json function

94af734853-+-Remove ordered_yaml function

f858f374b3-+-Add restbase-dev200[1-3] to site.pp and netboot

265f322478-+-backy2: initialize backy2 database if necessary

9a8cd79d53-+-analytics_cluster::datahub::opensearch: start of puppet role

3a580882ef-+-profile::nutcracker: remove unused profile

fa4b9af486-+-pybal::testing: remove unused role/profile

24d5eeb0fa-+-mcrouter::monitoring: remove module

18b5d36de9-+-toolsdb primary: come back in read only mode

d98e644467-+-logstash::input::kafka: allow a custom truststore path

305ae1f4d6-+-durum: add support for IPv6

9654883123-+-backy2: /fully/qualify/grep because puppet likes it that way

5edd5a54d2-+-backy2: on Bullseye, hack around a silly package name mismatch

5e1504f4e7-+-Rename variable used for router id setting in Bird config

81a3c0d896-+-bird: for bird6, set local IP to IPv6 instead of IPv4

90a6f9f46a-+-Revert "vrts: rename module class variables"

f5cd2f88ec-+-vrts: rename module class variables

cb439fc785-+-Revert "contint: Install docker 20.10 from thirdparty/ci on buster"

66e3a70fab-+-contint: Install docker 20.10 from thirdparty/ci on buster

701249f36b-+-Add conting2002 and gerrit2002 to site.pp and netboot

490c96c592-+-Temporarily disable traffic data purge

e8ab600d59-+-profile::wmcs::nfs::standalone: use host-prefix for the service name

fa32e1d1f6-+-drmrs: add vk delivery error alerting

9b6c312d77-+-lvs1015: unconfigure towards spare::system

a69fffca94-+-vrts: rename profile variables

8dd6f8e977-+-lvs1019 interface/role setup

6ecee8f607-+-Install anaconda-wmf-base on all workers, and anaconda-wmf only on client nodes

83662727d8-+-lvs1014: unconfigure towards spare::system

ad4a8e0c88-+-rancid: rm .placeholder, ensure config dir exist, avoid puppet flap

c42cc63d79-+-lvs1018 interface/role setup

e28583b7a2-+-site: add datahubsearch1001 in insetup role

a8674fcd2d-+-Decom prometheus[12]00[34]

a8ae0ddf9e-+-base::kernel: explicitly load overlay when overlayfs is true

4b93215374-+-gitlab: add ferm rules and fix listen_addresses for test instance

e24feb5533-+-cache::envoy: Bound envoy to the same NUMA node as the main NIC

52f532542f-+-prometheus: override probe service address

5053f0be4f-+-P:wmcs::services::ntp: filter out self on peers list

d6b4e456c3-+-P:openstack::galera: drop puppetmaster firewall rules

53bb997b44-+-toolforge cron runner: better support for secondary nodes

b5a108fb81-+-mariadb: Promote es1023 to es5 master

ec6ade0521-+-Add ml-serve200[7,8] to the k8s ml-serve-codfw cluster

54e6a24afc-+-mariadb: Promote db1183 to m3 master

dc211273d7-+-site: remove etherpad1002

6bdca43ac0-+-dynmamicproxy: move db backups off of nfs and onto a cinder volume

fc753b2be3-+-profile::wmcs::proxy::static: include sslcert::dhparam

58392896c6-+-P:toolforge: remove clush access

7ff046908e-+-puppet_compiler: bump version

9d8aa9c3b4-+-profile::docker::engine: skip profile::base::memory_cgroup

9117237bd7-+-cache::haproxy: Limit HAProxy to the same NUMA node as the main NIC

5a7847d1e3-+-prometheus: per-service icmp prober module

f14d20136e-+-profile::kubernetes::node: add grub settings for Bullseye

38a5fb6116-+-wmflib: add 'expect_redirect' option to probes

d904436d3a-+-wmflib: do not quote probe icmp address

43ad5a45d2-+-prometheus: split probes by network sphere and address family

f3d92d25f1-+-role: reorder prometheus profile inclusion

1d6516e1d7-+-icinga: remove ORES unused alerts and improve the remaining ones

c551bc91f0-+-P:wmcs::nfs::standalone: add a motd warning

1ca6fdbacc-+-P:mariadb::grants::cloudinfra: read grant hosts from hiera

80dd063591-+-P:mariadb::cloudinfra: use Cinder volumes for storage

393ddda663-+-profile::wmcs::nfs::standalone: keep the nfs service running

b693ed9ae4-+-phabricator: Regularly check MFA status of elevated Phabricator accounts

b00a1b1dd0-+-Adds aspell-hi to ores/manifests/base.pp

225141e68c-+-profile::wmcs::nfsclient: Move server mount path into yaml config

ca20403aaa-+-O:mariadb::cloudinfra: update comments and motd role

dfc45a641c-+-profile::icinga::ircbot: send ores-related alarms to #wikimedia-ml

e34fcdc9f4-+-profile::wmcs::nfsclient: rearrange the logic that decides what to mount

0b3ceba31e-+-haproxy::tls_terminator: Support IPv[46] backends

0b0a3a44f9-+-Third sweep of tendril clean up

b0662540a7-+-Remove auth2001 from Puppet

793830f6a5-+-Second sweep of tendril clean up

52675d6d13-+-tendril/maintenance.pp: Remove file

2a944f7327-+-First sweep of clean up of tendril

99c40a4f54-+-site: move etherpad1002 back to insetup role

1ea4268b8a-+-Revert "Revert "site: add etherpad role to etherpad1003""

9d4e2b5d06-+-etherpad: allow setting listening IP in Hiera, use IPv6 on etherpad1003

765bf74a94-+-lvs1013: deconfigure towards spare::system

02cda43ae0-+-puppetmaster::web_frontend: add comments for my future self

eef97143b7-+-P:puppet_compiler::puppetdb: delete cronjob

72da4aeebb-+-lvs1017 interface/role setup

f392051390-+-profile::wmcs::nfsclient: fix hiera key name for nfs server mount path

cb33ded312-+-Revert "site: add etherpad role to etherpad1003"

9408cc0940-+-profile::wmcs::nfsclient: allow hiera to override nfs server fqdn and path

05385f3d8a-+-updating site.pp and netboot.cfg for new restbase103[123] servers

23b50d76d7-+-etherpad: fix process monitoring after version upgrade, node->nodejs

a7374772df-+-site: add etherpad role to etherpad1003

4c8c0a9156-+-gitlab_runner: make exporter_listen_address depending on ::realm

2090217282-+-gitlab_runner: export metrics on IPv6

c8984c1e29-+-httpbb: also remove nonexistent from the test_suite declaration

b57e8b9b59-+-profile::rsyslog::kubernetes: add support for Bullseye

742568954b-+-Add ml-serve2006 to the ml-serve-codfw k8s cluster

5b0d62d0e4-+-profile::kubernetes::node: avoid iptables alternatives for Bullseye

dde844ff56-+-C:puppetdb::app: update puppet_compiler to scripts

2481e87579-+-maintenance.pp: Remove file

cc493cf7a0-+-production.pp: Remove tendril grants

4cc7082598-+-tendril/maintenance.pp: Files ensure to be absent

026da9a915-+-profile::idp::client::httpd::site: Default cookie_secure to On

8a1bba21a9-+-turnilo: Set cookie_secure to On

b5655f0d77-+-fix up flow dumps config for deployment-prep cluster

4a129864d3-+-Set cookie_secure: On for superset

7ffbcc6929-+-Revert "valid_section.pp: Remove tendril"

b5f8510781-+-graphite: whisper_cleanup: remove absented cron

f52b5646e2-+-prometheus: add 'tcp' probe type

3055e70809-+-valid_section.pp: Remove tendril

1c6c4d95d1-+-site.pp: Remove tendril references

a9fde6002a-+-grafana: add configurable execute_alerts option

d15fb34b0c-+-profile::wmcs::nfs::standalone: add -nfs postfix to service domain

6d90a76307-+-opensearch: use java_home from profile::java

d08dd56fcb-+-ssh::client: optionally disable key puppetdb management

95b3e8acb0-+-cloudnfs: Add a hiera key to switch scratch hosting on or off

ae8be72545-+-wmcs 'maps' project: use project-local NFS server

a3fe27a417-+-dnsrecursor: add built-in webserver support

33b513082d-+-openstack pdns_auth: fix prometheus monitoring

ba0ce95c2c-+-airflow - add deployment dir to PYTHONPATH

24fb554888-+-Change the date at which the Movement Metrics tasks run

15b2172fad-+-Add LVS service k8s-ingress-staging

555e08f91d-+-puppetboard: Set cookie_secure to On: instead of Auto:

027cbf1952-+-P:puppetbard: add new saml based vhost for puppetboard

b52cad37f0-+-prometheus::ops: remove atskafka job definition

1b904df4d2-+-graphite: whisper_cleanup: migrate cron to systemd timer job

c7338014cd-+-toolforge: grid: always install latest jobutils package

e0bee7fde7-+-gitlab: nginx listen on IPv6, refactor variables

0722b65d93-+-kubernetes: add bullseye apt configuration

c8abff8a58-+-prometheus: remove job unavailable alert

3955d7c090-+-profile::kubernetes::node: support bullseye

2677e37ef8-+-Remove case for installing nodejs 10 on stretch for testreduce

37b8b0a8b5-+-logstash: use java home from profile::java

2a6801a8d3-+-graphite: add grafana-next-rw to cors origins

95b9341591-+-Add mc2038 -mc2055  to site.pp

5d4ab35fda-+-toolforge: grid: fix condition for legacy ssh_known_host file generation

a1370e8e4a-+-Add ml-serve2005 to the ml-serve codfw cluster

35549b9f0f-+-realm.pp: try and fix populate puppetdb

18913fc35f-+-tendril: Remove systemd jobs

2c78efb095-+-tendril: Disable systemd jobs

855b194abe-+-sslcert: additional search paths for certificates

0d136ea9be-+-profile::docker::engine: add param to ignore docker storage settings

c85bfe98e7-+-labspuppetbackend: fix a race condition with logfile ownership

070a21353e-+-airflow - Set SKEIN_CONFIG

b3fe65952c-+-openstack puppetmaster: add missing ) in ferm rule

ca0af3b140-+-rake_tests: enable single_quote_string_with_variables

f9413fdfb8-+-maps: Add kafka helper scripts

c9891dc083-+-Set spark maxPartitionBytes to hadoop dfs block size

316a36e0dd-+-prometheus: relabel 'instance' in job=prometheus with hostname

56e8365978-+-cloudvirt: fully/quality/path to systemctl

19e7faebbd-+-cloudvirt/libvirtd: another attempt to fix startup ordering

70b70b5a8b-+-cloudvirt/libvirtd: try to fix service startup order

3c41208799-+-cloudvirt: remove virt-top from bullseye hosts

b003e8c791-+-cloudvirts: remove some buster-only packages from bullseye

5e5a3101b6-+-mx: set net.ipv4.tcp_fastopen_blackhole_timeout_sec sysctl

6724f63a38-+-P:acme_chief: set watchdog_sec default on cloud

4c80d73437-+-google_api_proxy: fix proxies and ip addresses

d0e5bd7913-+-C:mw_rc_irc::ircserver: Refresh ircd services on config changes

e2fe3821ea-+-base: standard_packages: don't install hp-health on Debian Bullseye

07f7f06f42-+-puppetboard: Also grant access to cn=idptest-users within the profile

fb37322f36-+-elastic: es pkg needs 3rd party comp

2d609892a7-+-elastic: make wmf-es-search-plugins req es package

3079fb46c2-+-mediawiki::maintenance: Run recountCategories.php monthly on all wikis

ea7cbeaa4c-+-elasticsearch: activate role (step 2)

ba00eea11c-+-Use the system default mysql prometheus exporter for analytics-meta and matomo

8e3183cb27-+-mariadb: Move db1183 from m2 to m3

bf6510ac3e-+-mariadb: Promote db1159 to m2 master

3d11302c28-+-gitlab: parameter to allow using either acmechief or certbot for certs

c4066cdbe6-+-imagecatalog: Only run on the active deployment host

4ebcfba64b-+-O:puppetmaster::standalone: add role motd

7e8b936135-+-airflow - Ensure a mariadb client installed

1903f0bad5-+-Add ganeti2029 and ganeti2030 to site.pp

e4546f3421-+-Set the syslog programname of the movement metric scripts

d259e6aa4f-+-P:admin: switch to using wmflib::dump_params

24933da6ec-+-Move ml-serve-ctrl nodes to overlay fs

7037942a15-+-toolforge: Install clang on the grid

76a0d85143-+-site: Reimage cp1087 as cache::text_envoy

27b743609e-+-service catalog: introduce 'page' field

951cbc8243-+-mediawiki::logging::yaml_defs: use wmf-certificates' bundle as CA cert

b6411de2a5-+-mariadb: Promote es1020 to es4 master

84e6d91a8d-+-elastic: install elasticsearch-oss from component

954ee9d5e8-+-gitlab: parameter for exporters expects Hash but is array by default

667eaf4135-+-Revert "elastic: install elasticsearch-oss from component"

1929b26c5b-+-Add ml-server200[5-6] to site.pp and netboot.cfg

2b9e7dfa28-+-elastic: install elasticsearch-oss from component

6426ba3d73-+-Adding new ms-fe1090[9]|1[0-2]) to site.pp

09d262948b-+-Add ml-staging200[12] to site.pp with role insetup

7056273bd2-+-openstack: neutron: l3_agent: some sysctl parameters are only on dataplane

6af2f93e37-+-Revert "Neutron/Victoria/Bullseye: try removing iptables entirely"

f6e05184ea-+-site: Reimage cp2039 as cache::text_envoy

bfff48cea2-+-site: add role for durum hosts in drmrs

79d2162b90-+-P:toolforge: remove useless prometheus_fixup

550f5519d2-+-ores::web: log XFF header as REMOTE_ADDR when available

669e139703-+-maps: tweak postgres configuration settings to use more resources

60299eb978-+-Add hostname-override and cluster-cidr to kube-proxy

fb89c63298-+-snapshot: replace the word cron everywhere

c736b31f9d-+-site: Reimage cp3062 as cache::text_envoy

2d36637e42-+-backup: remove fileset for static-bugzilla

f5b01c4d99-+-Neutron/Victoria/Bullseye: try removing iptables entirely

25211c87f1-+-rdf query service: Use constant filename for defaults

360e82a7be-+-OpenStack Neutron: install iptables on Bullseye

fc6c3700fa-+-site: add etherpad1003 with insetup role

33faa7c0e7-+-logstash: disable gc logging on logstash collectors

23dc299f93-+-logstash: move safepoint logging flag inside gc_log gate

04b9c99cee-+-P:toolforge::redis_sentinel: fix hardcoded interface

bb94b31584-+-Didn't see a site.pp entry for new cloudbackup servers

9b37fbf578-+-Openstack cloudservies: stop installing python2 git

772be76597-+-centrallog: clean up old /srv/syslog/host directories after grace period

8cb772b85c-+-pdns: support bullseye

4d11075c7b-+-apifeatureusage: disable gc logging

a64b0ec33b-+-P:openstack: fix novaenv path

1c3c521046-+-P:openstack::galera: fix monitoring process name on bullseye

6ce33c37ac-+-O:openstack::services: don't use pdns prometheus exporters on bullseye

333e1d8a84-+-Beta: maintenance: no openldap management

2b30904317-+-Beta: maintenance: skip mediawiki::state function

ad3344f894-+-P:openstack::puppetmaster: fix passing non-existent variables

5189e54b8c-+-openstack encapi: Drop special treatment for puppetmasters

4f1c83f8d6-+-site: Reimage cp5011 as cache::text_envoy

61e21a10f1-+-Revert "cirrussearch: Reenable saneitizer"

bc75454da6-+-site: add Prometheus role to eqiad hardware

11be2aaddf-+-pdns::auth::db: support Bullseye

743d80c96b-+-openstack: force start barbican and trove services

850be1c4bf-+-Keystone/victoria/bullseye: brute-force replace init scripts

3d8b4b85c7-+-openstack: keystone: set bind port for uwsgi process

b22dfa4806-+-Another piece of removing Apache from cloudcontrol/bullseye

722439af68-+-Exclude keystone::apache profile on Bullseye hosts

825c4c313e-+-Keystone: don't use apache/mod_wsgi on bullseye

17e05839c3-+-prometheus::ops: Gather varnish mtail metrics on text_envoy

d3d19c5dd6-+-P:pki::multirootca: merge default profiles with profiles

a0dd860033-+-P:pki::multiroot: parameterises int CA cert location

bb04b3a912-+-rabbitmq: fix dependency cycle

78fc2e44b2-+-rabbitmq: use built-in prometheus exporter in bullseye

b25e6472f7-+-kubernetes::master: Remove expose_puppet_certs parameter

673b44ecf7-+-Upgrade eqiad kubernetes masters to tainted full nodes

19422dfc19-+-wdqs: populate journal var to fix puppet failure

1432ed9b76-+-openstack: remove few more python 2 packages

5785ce18ba-+-backy2: don't install python3-crypto in bullseye

d9406cea36-+-upgrade codfw1dev to bullseye

f6ebb76faa-+-httpbb: move tests for static-bugzilla to new file for miscweb-k8s

985acb715c-+-cloudmetrics rsync: run on the half hour rather than on the hour

e4186b4d0e-+-upgrade codfw1dev to bullseye

b023b457d9-+-upgrade codfw1dev to bullseye

10f2f69608-+-otrs: rename profile to vrts

39eb33f624-+-Revert the change made for movement_metrics timer

b5d7261396-+-Launch the script with a given process name

4b7504f291-+-Add mapping for new 6.8 component

08a2698ada-+-site: add role for doh6001 (Wikidough drmrs)

30e3f8ae39-+-P:rsyslog::kafka_shipper: move Kafka TLS CA settings to the new bundle

97e520b52c-+-Upgrade codfw kubernetes masters to tainted full nodes

9a017db174-+-Make ganeti1028 a Ganeti node

e5de66bceb-+-site: Reimage cp4031 as cache::text_envoy

e7292eb7de-+-db1159: Move it to m2

35cea2f32f-+-Create a separate puppetboard-idptest.wikimedia.org vhost in idp-staging

10645ee1a7-+-cache: Provide a text_envoy role

73665df97f-+-snmp_exporter: allow polling from all prometheus hosts

a9451c9df0-+-mariadb: Promote db1128 to m1 master

6ade718afa-+-ci: ensure rsync is on all WMCS CI agents

20552760e7-+-cirrussearch: Reenable saneitizer

3da993254d-+-C:network: add mx context to abuse_nets

5fafff217c-+-delete bugzilla_static after it moved from puppet to k8s

20165613c5-+-prometheus: add blackbox generic "watchrat" http/s static check support

4df9bcfd64-+-P:nftables::basefirewall: drop prometheus port filtering

730f8503fe-+-varnishkafka: use new ca bundle instead of the Puppet one

57ea2a82a9-+-profile::cache::kafka::webrequest: Log Sec-CH-UA* headers

68779f8c58-+-profile: drop individual prometheus node ferm rules

cdb08784eb-+-prometheus: refactor rsync in a standalone profile

c0d00d91b1-+-profile::wmcs::monitoring: update comment about time interval

d73c7010e2-+-Revert "elasticsearch: activate role (step 2)"

851e88f0c4-+-elasticsearch: activate role (step 2)

8069283c4c-+-Revert "elasticsearch: activate role (step 2)"

a07ae4a76d-+-elasticsearch: activate role (step 2)

b9e5fe1399-+-Make cloudmetrics1003/1004 monitoring hosts, 1001/1002 spare systems.

88004b3b68-+-imagecatalog: Add an hourly systemd timer to scan for what's currently running

a9cefe4278-+-Revert "wmcs: monitoring: make cloudmetrics1001 the primary"

046f1d244b-+-drmrs: various minor global config

260069b527-+-Updating netboot.cfg and site.pp with cloudvirt1047

3d1eaeb83d-+-logstash: switch to opensearch output plugin on production logstash

6cb1415cbb-+-gitlab: update cloud hiera, refactor naming

ddbd6f4eb1-+-nginxlogs: Move rsync globs to --include/--exclude

2da1e406b6-+-wmcs: monitoring: sharpen primary/backup rsync setup

747073fa26-+-elasticsearch: keep certificate_name as server_name

93d3684040-+-P:base::firewall: Add prometheus hosts to catch all ferm rule

8241e698ef-+-Revert "P:base::firewall: Add prometheus hosts to catch all ferm rule"

c08d6aed02-+-P:base::firewall: Add prometheus hosts to catch all ferm rule

9e2cc716d0-+-cirrus: move to search.d.w cert

ae3f89ceab-+-C:reposync: create hooks directory

ff55c7636d-+-O:cluster::management: Add reposync

4680fa966a-+-reposync: add initial repo sync class

88da58f557-+-maps: add cassandra toggle, disable cassandra on maps hosts

fd20030f90-+-wmcs: monitoring: make cloudmetrics1001 the primary

54cb15cb12-+-site: add Prometheus role to codfw hardware

74d1ffb7da-+-prometheus: disable rsync where not needed

09b490542e-+-clean up older enterprise html dumps, keep the last 6 runs

c7e9018143-+-Make ganeti1027 a Ganeti node

5de5b43f83-+-site: Add drmrs ncredir host

f44c80d7be-+-Upgrade staging-eqiad kubernetes master to a full node

6308fcdae6-+-blazegraph: prometheus exporter may bypass nginx

3ad2d82309-+-bird anycast: fix defaulting to local gateway

248e61fb60-+-drmrs host bgp fixups

56c401dfff-+-P:openstack::base::keystone::fernet_keys: drop use of '*' in rsync

d9b9fa1025-+-O:cacheing-proxy: add support for structured logs

a4a9063923-+-P:installserver::proxy: quote strings

9129bca175-+-profile::installserver::proxy: correctly escape syslog line

eb25c4bfa3-+-add systemd timer for Enterprise HTML dumps download and rsync

ef742e4366-+-P:installserver::proxy: switch access logs to syslog

3e1ed3aa9a-+-Revert "P:base::firewall: Add proemethous hosts to catch all ferm rule"

d32605928a-+-P:base::firewall: Add proemethous hosts to catch all ferm rule

78da03ffc0-+-gerrit: Convert gerrit-theme to Polymer 3

2847d6116c-+-thanos: move to a single flag to control uploads

51645fd748-+-Add a kafka_11 profile to the PKI Kafka Intermediate settings

ea230b4ac8-+-site: Reimage cp1088 as cache::upload_envoy

bf2dc20377-+-puppetdb-api: allow prometheus_nodes via ferm

48b4899176-+-site: Reimage cp2040 as cache::upload_envoy

a8cc39e577-+-Make ganeti1026 a Ganeti node

a7435e5afb-+-Revert "Revert "logstash: install logstash-plugins on logging logstash clusters""

f7d86dcb4b-+-Revert "logstash: install logstash-plugins on logging logstash clusters"

2ce12040b5-+-logstash: install logstash-plugins on logging logstash clusters

2ca035b8ed-+-Revert "Use the default prometheus_mysql_exporter for matomo"

3c987e9c98-+-gitlab: change restore manifest formatting

12fecd55d9-+-sodium.wikimedia.org: remove reference, decommed

1300963fe4-+-P:openstack::rabbitmq: add tls ports to firewall

6da1e4d89f-+-ci: always use a LVM volume for Docker data

1e24c965fc-+-ci: set Docker partition size explicitly

c2f27e425f-+-Update network_flows_internal druid indexation job

8ea7bea110-+-Use the default prometheus_mysql_exporter for matomo

8160b878a5-+-[WIP] add enterprise html dumps downloader settings and credentials files

b238ff972b-+-Make ganeti1025 a Ganeti node

b7d7fdf27e-+-Add scs-f8-eqiad to Icinga and Rancid

c5072fa1b8-+-prometheus: support probes behind SSO

f5340afb78-+-prometheus: override valid status codes for http probes

2afc9e1a9d-+-site: Reimage cp3063 as cache::upload_envoy

3658531092-+-builder: add opensearch1 pbuilder hooks for logstash-plugins update

b2522ca84f-+-logstash: ensure dlq directory exists

0cbdc789b8-+-Pin Cassandra 3.11.11 as 'dev'

d85bb9d169-+-Provide cinder backup node list to rabbitmq in eqiad1

785d3bf2b7-+-Define profile::openstack::eqiad1::cinder::backup::nodes

4b933b8f10-+-Add WMCS specific cloud role for syslog server

fd632b3464-+-toolforge grid engine: install fdm

bd00c08829-+-analytics:refinery:job:data_purge: Add deletion for anomaly detection

46909fd09f-+-prometheus: match SNI with Host when overridden

939f83a4d5-+-O:pki::multirootca: update config to inject default profile options

07c5390faa-+-Bump Atlas exporter scrape_timeout from 10 to 30s

1b92711de8-+-Update automatic Icinga LLDP hostgroup

65b734f46d-+-prometheus: add Host header support to probes

7ee58580d0-+-Deploy the dev version of cassandra to aqs1010.eqiad.wmnet

7c267477ce-+-cache::envoy: Set the delayed_close_timeout to 20s

115c609454-+-envoy: Allow configuring delayed_closed_timeout

1fcf4e6f58-+-P:docker::reporter: make http_proxy optional

5d7193e682-+-prometheus: skip tcp module, already in http module

6e3c3982d9-+-wmflib::deep_merge: add a deep merge that support arrays

624d52ca53-+-prometheus: handle non-LVS service::catalog entries

fd2fa3de87-+-P:mw::maintenance: add centralauth group purge job

e076f9a908-+-Update codfw kubernetes master to a full node

df374e479d-+-Make ganeti1024 a Ganeti node

be8b0c68b7-+-mariadb: Move db1128 to m1

034bc43996-+-rabbitmq: Add support for listening on TLS

378e676bd8-+-Fix network_flows_internal druid loading jobs

a952e4555a-+-logstash: move elk5 collectors to role::spare::system

5a44a4e46f-+-profile::apifeatureusage::logstash: update ssl identification and index name

4cfaf101fe-+-OTRS: rename role class to VRTS

39dffb5089-+-Fix RIPE Atlas icinga checks

e32e3e40ff-+-Add cinder-backup role/profile for eqiad1, use on cloudbackup2002

34da51a938-+-assign role::apifeatureusage::logstash to apifeatureusage[12]001 hosts

702d27416e-+-P:pki::multirootca: Make alerts critical

0c8ba8090b-+-Adding new backup1008 to site.pp

35106861cf-+-toolforge: deploy test suite

2dfe83dc68-+-Reset druid load jobs for network_flows_internal

2e7e15d30f-+-Atlas exporter: add probes and traceroute mesurements

1e4c4f8877-+-cloud-vps nfsclient: switch to using the VM-hosted scratch NFS server

e73d7246a2-+-wmcs nfsclient: remove a long-absented mount

93273925e6-+-C:monitoring: use ['lldp']['parent'] instead of lldp_parent

f84ea0f9e0-+-P:microsites::os_reports: update rsync to use -r instead of *

ae271845d4-+-Make disabled insecure API the default on kubernetes masters

dc38dbb0da-+-Make ganeti1023 a Ganeti node

01b5871d90-+-Add single quotes to the wildcard for rsyncing nginxlogs

e3e8ca7036-+-Revert "profile: move statsd writes to graphite2003"

127599770e-+-Revert "graphite: check graphite2003 metrics"

79b8adf4e0-+-cmd_checklist_runner: fix file name

b423305da8-+-openstack: monitor: network tests: disable systemd timer

6908eba364-+-cmd-checklist-runner: separate into its own module

6c6ac1fad6-+-Make ganeti2026 a Ganeti node

1161df735d-+-pontoon: use a valid string for cert expiry

087ce4c3d8-+-beta-logs: use opensearch output plugin

9cd3de6bca-+-logstash: add opensearch output config definition

0d6c3427f1-+-logstash: add optional document_type parameter to es output config

0d926c9e5a-+-scap: No longer install dependencies via Puppet

8e2caea288-+-C:cfssl:signer: update default expiry

daa48adc69-+-O:uppetmaster::standalone: Add upload_facts parameter

c56f6e4228-+-O:puppet_compiler: mount yaml dir

0c680116b5-+-O:puppet_compiler: mount yaml dir

c36ae3be4c-+-cache::envoy: Set upstream idle timeout

814b408fe4-+-Add msw2-eqiad to monitoring

d963e71d7d-+-gitlab::restore: restore after rsync of backup

c56eb399d1-+-kafka: add check to test the Broker's TLS port

2998116bdf-+-realm.pp: Add ipinfo_ip_changes to private tables

692d17b488-+-service::monitor: do not include services with just probes

31efa66b7d-+-cache::envoy: Disable circuit breakers

4102923d06-+-envoy: Allow disabling circuit breakers

57763feb54-+-wmflib: fix get_services_for

64f8722c3f-+-wmflib: add service::get_services_for function

0affaf0ebf-+-k8s-apiserver: Disable insecure API on systems that no longer need it

3be84f4fae-+-cache::envoy: Limit number of requests per varnish conn

dc44adcb16-+-Add missing notify on kube-scheduler config change

a51377cae6-+-Migrate kube-scheduler away from insecure API

6ae2155ce1-+-Make use-service-account-credentials the default for controller-manager

62e6788789-+-services_proxy::envoy: add support for v3 configuration

6f2910c195-+-envoy: make the choice of api version explicit

88c31e0ce4-+-extdist: remove absented crons

d8e1ca1dff-+-extdist: migrate crons to systemd timers

1415150baa-+-Absent network_flows_internal druid jobs

52717f8b29-+-cirrus: Fetch java before elastic plugins

e26e566f11-+-Revert "cirrus: Fetch java before elastic plugins"

aacdcfaecd-+-cirrus: Fetch java before elastic plugins

998528390f-+-P:cyberbot::exec: support newer debian versions

96ca32df2b-+-query_service: make journal configureable for streaming updater

24a2c1643f-+-wcqs: Deploy streaming updater

a6610092d6-+-Make build2001 a build host

c73483725f-+-cache::envoy: Set stream_idle/request/request_headers timeout

23fba1ec3d-+-envoyproxy: Add stream_idle/request/request_headers timeout

0cdcafe1ab-+-Fix error in network_internal_flows druid job

624d5bf509-+-Add network_internal_flows to refine and druid-load

0cb9eda612-+-beta::autoupdater: Don't manipulate ${stage_dir}/php-master/LocalSettings.php

e3f5a28480-+-P:admin: pass through always group

403d952e98-+-bgpalerter: switch to using wmflib::dump_params

dab4e6ca99-+-osm::usergrants: remove unused define

9546c20a1e-+-bgpalerter: convert rest to a structurd type

62c8c1e741-+-C:puppetmaster: pass the http_proxy parameter

8a6f2fe16b-+-drmrs: lvs/cp puppetization

c7b6aaa253-+-nfs::standalone: Don't attach network interface unless volume is attached

e5cb93d9ee-+-phabricator: fix ferm rules for VCS, git-ssh

7d19bdd065-+-Revert "Revert "phabricator: move vcs firewall rules to profile""

602b37b3e8-+-site: reprovision eqiad logging cluster to opensearch

6f3212ae8e-+-Revert "phabricator: move vcs firewall rules to profile"

6efa3397bb-+-phabricator: move vcs firewall rules to profile

c4678e6ec9-+-deployment_server,::helm: remove helm2 support

64ed9cc295-+-bgpalerter: Add email alerting and tweek default config

8b76bcf397-+-O:bgpalerter: add rpki as a class paramter

3d0c623dc0-+-toolforge: grid: weblight: support debian buster

fc07ec218a-+-mariadb: Move db1128 to s1.

d8f7238251-+-role: add apifeatureusage role

36fec65ef6-+-O:wikidough: enable DoT to auth servers

d93ad22602-+-dnsrecursor: add support for DoT to auth servers

b125d89cdd-+-bgpalerter: use absolute path for prefixes and log directory

a533b6143c-+-bgpalerter: fix prefixes content

f39d62b0c9-+-bgpalerter: fix type definition

ad48903e58-+-bgpalerter: add new class to configure bgpalerter

edcf73ab7a-+-profile::wmcs::nfs::standalone: bind service IP to VM

ac8ed377a6-+-kubeadm: raise default to 1.20

058f7c6004-+-Import commons mediainfo json dumps to HDFS

3626ebcff6-+-wmcs::db: remove used roles and profiles

bd2668af75-+-O:puppetmaster::standalone: add type validation

6f56884c34-+-maps: Install s3 client cli/lib

87d9413e6b-+-role::mariadb::proxy: remove unused role

6fb38e95ee-+-role::mariadb: remove unused role

6405f11a8c-+-cloudnfs: allow nfs-exportd to make public mounts actually public

79631dce98-+-{role:,profile:,}peek: remove unused classes

bddbd1788e-+-elasticsearch:decommission: remove unused module

ca4c1222ba-+-snapshot: Dump information about Growth mentorship

ca083dcf89-+-logstash: update weekly indexes to use weekyear pattern syntax

66a5b37862-+-install_server: add dhcp/netboot entries for apifeatureusage VMs

6f6f4a6e19-+-profile::logstash::gelf_relay: pass correct package name

e2c9cacf95-+-Use a flag to deploy log4j-extras on Hadoop-related nodes

fef3d43b47-+-sodium: change role to spare::system, to prep for decom

5d00d54bd9-+-kubernetes: remove kubestage1001 & kubestage1002

141c001af9-+-P:prometheus::ops: add prometheus job and ferm rules for gitlab_runner metrics

9e1ce6cd7a-+-gitlab_runner: fix missing parameters in registration command

8605a9c269-+-gitlab_runner: fix missing url in registration command

40faf7e185-+-gitlab_runner: use config template for registering new runners

28d75658ff-+-osm: remove unused profile/role

42cd12733b-+-jmxtrans: remove unused modules

204f86ba5d-+-b:h:j:{metatstore,server}: remove unused module

45ec2de0c3-+-c:kafka:broker:jmxtrans: remove unused module

de864381dd-+-Refactor git-daemon use in profile::zuul::merger

f7663c3765-+-icinga:nsca:client: remove unused module

9cca75b45d-+-c:kafka::mirrors: remove unused module

9422e73ca9-+-bigtop:spark: remove unused modules

9456d4e894-+-b:hadoop:httpfs: remove unused module

b69761129a-+-r:cloud_analytics: remove unused roles

1eadcfaa15-+-r:kafka::simple::mirror: remove unused role

d5a6991221-+-e:sevice:consumer: remove unused module

56a9ae3c36-+-r:analytics_test_cluster::{turnilo,webserver}: remove unused roles

952e6cd618-+-role::memcached: remove unused role

266d38ff2d-+-maps: write tegola swift credentials out to file

8e5c5ed06b-+-service::packages: remove unused define

4f23ca3afb-+-profile::ceph::common: remove unused profile

8631d69684-+-labs_lvm:swap: remove unused module

679ebcfa6b-+-lshell: remove unused module

412c6e0e3b-+-sonofagridengine: cleanup unused classes

8f88483af2-+-r:wmcs:paws:k8s:etcd: remove unused role

a16c53e1a1-+-p:wmcs::nfs::misc/misc_backup/backup_keys: remove unused profiles

5106429ded-+-r:wmcs:openstack:eqiad1:cumin_controller: remove unused role

d95074e005-+-service::deploy::scap: remove unused define

6bc8fa61e0-+-zuul: send errors from git-daemon to client

1aaea546b8-+-P:mediawiki::deployment: fix ferm syntax

7f7d7ccde9-+-Define git::daemon class and use it in profile::mediawiki::deployment::server

cff64e5826-+-P::quarry: add prometheus multiprocess support

e692af2e37-+-realm.pp: this block still causes issues with pcc and puppet lookup

3b81fece9e-+-systemd::preset: remove unused define

be6754b1a8-+-stunnel: remove unused module

2fa0a59fb3-+-statsd: remove unused module

c92861e2f3-+-role::prometheus::labs_project: remove unused role

f1f0759f51-+-role::logstash::elasticsearch: remove unused role

26aca58670-+-ssh: remove unused class

b8a129ef4c-+-role::openldap::labtest: remove unused role

9826d5ff61-+-role::graphite::base: remove unused role

9b99638e61-+-logstash::puppetreports: remove unused role/profile

a8891633bc-+-r:wmcs::openstack::codfw1dev::virt: delete unused role

704f42e78f-+-cache::envoy: Add sslcert::ocsp::hook

0a247646d1-+-sslcert::ocsp: Allow configuring group ownership on /var/cache/ocsp

00f4e3246b-+-cache::envoy: Allow envoy to read sslcert managed TLS material

6b1b39eaa0-+-cache::envoy: Allow envoyproxy unit to write on /var/cache/ocsp

79ccda7c12-+-bastionhost::migration: remove unused profile

563fc479c6-+-p:db:development,r:beta_dashboards: remove unused classes

03b25077c3-+-docker: remove unused modules/role/profiles

da0b94dad7-+-prometheus: extend blackbox probes options

4ced5d4042-+-role::wmcs::prometheus: remove unused role

e6cef78e7a-+-varnish: remove empty init class and unused module

8f51699af8-+-udp2log:rsyncd: remove unused module

8c1f5e373d-+-systemtap::runtime: remove unused module

08e7861444-+-logstash:input:syslog: remove unused module

61719b0ac0-+-site: Reimage cp5005 as cache::upload_envoy

1dbbaf170a-+-cache::envoy: Increase LimitNOFILE

a38a67c388-+-deployment_server: fix permissions for mwbuilder/other

5a6bbc7d64-+-profile::openldap: increase the size limit for labs servers

829ebd4201-+-webserver.pp: Remove tendril checks

d122919813-+-nagios_common::command: don't need for absent

6f5e049ab3-+-Move all records of tendril to tendril-legacy

3288f30dff-+-monitoring::graphite_freshness: remove define/cleanup

0945095955-+-html5depurate: remove unused role and modules

c98c1758e5-+-alternatives::install: remove unused module

689a511091-+-geoip:data:package: remove unused module

d67a934856-+-apparmor::hardlink: remove unused module

09399250fa-+-initramfs:hook: remove unused module

2895beb67a-+-identd: remove unused module

e5cdeb5f84-+-labs_debrepo: remove unused modules

b2242bedd1-+-mariadb: remove unused class

f52818d858-+-locales: remove unused module

d1dd88a4db-+-netops: removed empty class

0a432d58b5-+-nginx::ssl: remove class

8c9937dd48-+-nginx:snippet: remove unused class

2d006bcb2e-+-logstash:plugin: remove unused module

bf83020406-+-kubernetes::deployment_server: only include additional stuff in the role

64259d79b2-+-profile: turn off grafana db sync ahead of 8.x upgrade

49e94968d0-+-Add build2001

90a79a666f-+-kubernetes::deployment_server::mediawiki: add builder user/role

fd49bc708c-+-profile:k8s::deployment_server::mediawiki: split in subprofiles

1ea9f4b322-+-aptrepo::distribution: remove unused module

b3978fbeea-+-deployment_server: add docker engine

490e5a2587-+-profile::base: introduce class memory_cgroup

46d1ae1c68-+-puppetmaster::gitsync: remove absented crons and logrotate::conf

47da980426-+-puppet_compiler: update version

97e0aa0c7a-+-puppet_compiler: fix doc root

2a4a173798-+-puppet_compiler: fix vhost for db vs worker

fa547bfb32-+-P:puppet_compiler: update workers to use shared puppetdb

f63063a475-+-toolforge: exec_env: use default buster mono in buster grid

b4e0f31cec-+-docker::engine: raise a warning if overlayfs is not enabled

9a1b7a6ad2-+-role::builder: only rebuild images on deneb

a478352404-+-profile::docker::storage::loopback: remove from puppet

ffcffef05e-+-profile: upgrade collector7 to ecs 1.11.0-2

6bf8af1508-+-profile: upgrade to ecs 1.11.0-2

ff23217287-+-cloud cumin: add support for project puppetdb

3b176225e9-+-Subscribe airflow services to instance profile.sh file

55c65eb5c9-+-Make airflow instance profile file readable by all

036990014f-+-Remove already absented airflow from an-test-coord

5c25f72237-+-Add airflow instance profile script, use it from scheduler and webserver

8e982ebead-+-O:puppetdb: fix motd to match actual class name

b277d82211-+-P:environment: Add a simple zshrc file to the home dir

d88f37176d-+-imagecatalog: Pass cluster names along with config paths

d3eaae87f8-+-Revert "imagecatalog: Pass cluster names along with config paths"

7792756b45-+-imagecatalog: Pass cluster names along with config paths

f6d08e5cd5-+-kubeadm: Upgrade Calico to v3.21.0

82e1243650-+-Add drmrs prometheus to various global config

e0d756c12c-+-prometheus6001: macaddr and site.pp

862d19e1df-+-static-tendril: give apache site the name matching the virtual host

3763e3007a-+-wikistats: add /usr/local/bin/wikistats/ to PATH for all users

f7de535829-+-Delete unused role::mediawiki::irc_events

703cde7035-+-cirrussearch: s/sanitizer/saneitizer

ea20d98754-+-mediawiki: Move mwmaint system::roles to the role

94599d4d2d-+-install6001: add site.pp entry

345256344a-+-dynamicproxy: enforce project permissions

45adff38a4-+-cinder backups: dump backup config to yaml

24586abc9d-+-puppet_compiler::upload: tar_file is actully a Path

c1d7b3a073-+-puppet_compiler: fix group

b1a57d0bfb-+-puppet_compiler: fix call to unlink

2fea854033-+-puppet_compiler: use correct jenkis group

0387395d02-+-puppet_compiler::uploader: move process facts file to webroot

98585d5ada-+-pupppet_compiler: run timer as jenkins-deploy

650e556dbe-+-pcc_uploader: fix typo

2026cd5bb6-+-puppet_compiler: Add timer

9112f86fff-+-puppet_compiler: add pcc facts processor

db11cf801c-+-puppetmaster: add puppet-facts-upload job to puppetmasters

0334670fc1-+-miscweb/static_tendril: add dbtree.wikimedia.org as ServerAlias

c9911aac71-+-Cinder: add backup job timer to one cloudcontrol in each cluster

a429f3eaa3-+-Add simple script to backup cinder volumes according to yaml config

27a25af0e7-+-Add initial script to manage/automate cinder backups

38ca10e89e-+-mx: make exim queue alert paging

cb724081ed-+-Adding kubernetes1022 to site.pp and netboot.cfg setup role

3b3cd25aa9-+-site: Add drmrs bastion host

c280e84762-+-Adding new ganeti hosts to site.pp insetup role

f8a0fa2681-+-add new prometheus servers to site.pp in setup role

2ebc5b90af-+-mariadb: Fix path to another file

cfdee9e525-+-mariadb: Make centralauth GRANTs conditional to s7

2d4fd3312e-+-prometheus: consider non-discovery case when sending SNI in blackbox

7574ab1fbb-+-prometheus: export service catalog metrics

f926d8a511-+-prometheus: add mini-textfile-exporter

70a2db0a43-+-static_tendril: use wmflib::dir::mkdir_p to ensure docroot exists

42c1b4a16b-+-miscweb: Set up static_tendril microsite

04102a59be-+-mediawiki: Enable php-yaml unconditionally

44bcdc25ef-+-imagecatalog: 0770, not 0440, so the init command can create a DB

2fe38a2b8d-+-imagecatalog: Fix outdated TODO comment

96477ce2e9-+-imagecatalog: Install and configure OCI image catalog on deploy hosts

608085bab6-+-lvs1016: unconfig lvs, move to insetup

8cf65b657a-+-query_service: Collect wdqs and wcqs jmx metrics separately

c60d015f21-+-P::toolforge::grid: fix tomcat on buster

cd4e0d7257-+-Add backup2008 to site.pp

3bc14afd2d-+-Make ganeti2028 a ganeti node

4ec89679a0-+-cfssl: fix create chained cert typo

2f6043fb2c-+-mediabackup: Add an encryption key to store private files securely

e5259e4673-+-puppetmaster: Install 'age' on puppetmaster frontends

445e02b49f-+-role_hosts: capitilise role before testing

15253b286e-+-cloudmetrics: remove refs for cloudmetrics1001/1002 and prepare for decom

0b0207aadc-+-cloudmetrics: make cloudmetrics1003 the primary, 1004 the secondary

f88317d4db-+-pybal: peer all eqiad lvses with eqiad routers

e3f79b3e84-+-debian mirrors: add new mirror, mirror1001 in eqiad

093d2e60e9-+-logstash: use logstash-oss for gelf_relay

07231a44d0-+-lvs1020: lvs role and iface/addr metadata

336ae54471-+-prometheus::ops: Add varnish/ATS metrics for cache::upload_envoy role

fc7735dbbc-+-prometheus::ops: Gather full metrics for cache::envoy

dbcb8f1ff0-+-cache::envoy: Disable x-request-id generation

10bd196b5e-+-envoyproxy: Allow disabling x-request-id generation

7d460eb596-+-prometheus: don't probe services not deployed in the current site

f9088ad36a-+-cache::envoy: Fix ocsp systemd config file content

41b5f9778b-+-site: Reimage cp4025 as cache::upload_envoy

3184ec8a4e-+-"Pmacct add sflow listener" try #2

0f2f6a7bf3-+-P:pki::multirootca: Add addtional port to configuration

7a1688435a-+-prometheus::ops: Collect envoy metrics for profile::cache::envoy

4d641cc1e3-+-Enable ganeti2025 as ganeti server

c7d4afd38c-+-mediabackups: Make wiki optional, add another optional parameter: dblist

c33c959d36-+-prometheus: pin discovery probes to their site

67ab251de2-+-cache: Provide a Envoy upload role

0d161e2456-+-copernicium: rename to mirror1001

81fad00067-+-Added openstack client package for bullseye

a37c21bcbc-+-Prepare cloudmetrics100[3,4] to replace cloudmetrics100[1,2]

3c354656f4-+-lvs1017-20: switch to insetup_noferm role

9ca58665c9-+-mgmt: delete the entire module and role::mgmt::drac_ilo

e2d49f2162-+-Add new lvs servers to site.pp role (insetup)

c16c3d7330-+-O:pki::multirootca: make ferm rule ensurable

e4d27557ac-+-maps: Install openstack swift client CLI/lib

c446cf28d0-+-P:pki::multirootca: add addtional vhost for k8s

dcb3e18349-+-puppet_compiler: avoid duplication of puppet_compiler class def

2fb46f4913-+-Include new netflow VMs in site.pp

0b64e300e4-+-Revert "Pmacct add sflow listener"

f975d4ffc7-+-prometheus: add blackbox/discovery jobs

eddd4371ca-+-Pmacct add sflow listener

6bb8e52056-+-graphite: backup 'daily' hierarchy, with weekly frequency, every Monday

f6874d25e2-+-puppet_compiler::uploader: add web user permissions

2f75ea9cef-+-puppet_compiler: update realms type

c4f2d0736b-+-puppet_compiler::upload: Restart when settings change

30770c7e9b-+-puppet_compiler: client_max_body_size nginx

73ddd2a6b0-+-puppet_compiler: correct template location

f5e1429ee3-+-P:puppet_compiler: add uploader proxy

c46ecae773-+-C:tomcat: manage /etc/default/tomcat9

eeeb4a41bb-+-O:puppet_compiler: convert dependencies to python3

98c58472b8-+-restbase: add new hosts restbase202[456]

c4d3acd92e-+-ceph: auth: load_all: don't fail if only keydata is defined

56a5fd4456-+-ceph: auth: load_all: fix input datatype

f9c0e1dd4b-+-delete cescrout role and profile

ea922f64d8-+-transparency.wikimedia.org: switch git::clone from latest to present

2d968ada6d-+-bienvenida.wikimedia.org: switch git::clone from latest to present

0a4021d02c-+-annualreport: switch git::clone latest to present

23ddde7b6e-+-diamond: delete collector::servicestats*

1be365448a-+-contint: delete deployment_dir class

8617408da5-+-contint: delete the proxy_gerrit class

fdb3b311b5-+-P::openstack: add back puppetmaster_ca

026f5392f6-+-cloudbackup1002-dev: mark as spare for now

deeaf77192-+-puppet_compiler: notify uwsgi when file changes

2c66be1619-+-C:puppet_compiler: update default verion to 2.0.0

01811d7869-+-C:puppet_compiler::uploader: fix ip type

45f5349ba6-+-puppet_compiler: Add concept of realms

708bf83bb0-+-openstack: enc: properly fail on server error

c6676a13ca-+-openstack: refactor puppetmaster access

936fcc8b31-+-ceph::auth::keyring: ensure parent directory tree exists

ced8cc53bc-+-ceph::mgr: fix missing parent directory tree

a511682b94-+-ceph: mgr: ensure all the directory tree is managed by puppet

d20a42e455-+-ceph: mgr: migrate keyring to new auth abstraction

b4d5bc2b7c-+-C:cfssl::config: improve error message

c0b1d3789d-+-prometheus: bump logging level for blackbox-exporter

59df6a9ef2-+-role: remove netconsole from ganeti

44852f5189-+-xdummy: Remove xdummy

54d2180e95-+-prometheus: support for blackbox configuration fragments

64fff297c1-+-envoyproxy: Allow setting http2 protocol options

18d886827d-+-envoyproxy: Add downstream idle_timeout config option

2587b95470-+-envoyproxy: Allow setting per_connection_buffer_limit_bytes

b9e9d8d148-+-envoyproxy: Allow configuring TLS handshake timeout

9c2b52dbc2-+-profile::prometheus::alerts: fix eventgate's dashboard links

cc71f5afc7-+-graphite: enable netconsole client

53ec3ffc98-+-netconsole: move to anycast syslog

1834541862-+-dbbackups: Add s3 to db1145 (backup source)

97c4618047-+-Make ganeti2027 a Ganeti node

e9f66cd3df-+-cfssl::config: support per profile auth keys

6a35e5564e-+-envoyproxy: Support PreserveCase HeaderKeyFormat

15a5944dbd-+-dbbackups: Add s2 to db1139 (backup source)

38de183eed-+-dbbackups: Add x1 to db1116 backup source host

17df6e4c17-+-profile: move statsd writes to graphite2003

fa52829d6b-+-graphite: check graphite2003 metrics

09d5b3d465-+-maps: Install lib to handle compressed kafka messages

4de39df3fa-+-gitlab_runner: rollback usage of dedicated module for runner config

4f4ab96b41-+-Install python client for kafka on maps masters

3d4614e0a6-+-swift::proxy: install python{3,}-monotonic

5b334118bc-+-syslog: add netconsole::server

07c9087ca4-+-gitlab_runner: add --config parameter to register command

fc1fa6dfae-+-gitlab_runner: create module for runner config and enable metrics

e951b0d7b7-+-site.pp: fix a very important typo re: cloudvirt1028

8990205897-+-delete role::dmarc

3cd304e7f2-+-puppet_compiler: fix folder names

eb88ab6290-+-C:puppet_compiler: add configurable port for uploader

0b903562c3-+-C:puppet_compiler::uploader: pass params as array

5f1194f2af-+-C:puppet_compiler::uploader: correct typo

6e18a3ed9d-+-P:puppetdb::microsite: just ensure package

d1a615e7d3-+-encapi: Remove statsd metrics

ef440203f7-+-C:puppet_compiler: add uploader class

5a909c1740-+-bird: add validate_cmd for anycast-healthchecker.conf

0520d44521-+-P:trafficserver: add a hiera guard for checking

18c3dc4ddf-+-set up tls termination on cloudweb2001-dev

3869ca6efa-+-Revert "Revert "durum: show if the user is using DoH or DoT""

7f13912c29-+-Revert "durum: show if the user is using DoH or DoT"

09bfe766c8-+-ldap: Do not install py2.7 files on bullseye

229d4a4b2a-+-dnsdist: refactor the configuration template for updates to durum

bcd085f470-+-durum: show if the user is using DoH or DoT

0d271af693-+-ceph: mgr: fix typo in relationship

31b2f33ac3-+-monitoring: refactor class

d080e55b20-+-Revert "gitlab: disable restore timer to perform upgrade"

2d2b16dbff-+-Revert "monitoring: refactor class"

9787c3f63f-+-monitoring: refactor class

1815f24272-+-Remove the HDFS corrupt blocks check from Icinga

634bf11aba-+-C:ldap::client::utils: Update to python3

7ab8f09313-+-Switch profile::openldap::management to use profile::openldap::client

c5eca62534-+-P:openldap::client: Add ldap::client::utils

0171dbb1c4-+-Refactor superset caching to enable dual caches

be10a669dd-+-gitlab: disable restore timer to perform upgrade

04d0e47b69-+-wmflib: add 'probes' to service::catalog type

8b644ceb4e-+-service: add public_aliases list

d36d488be6-+-prometheus: remove textfile stale alert

8c18d192ea-+-prometheus: change blackbox jobs to use / as separator

b544a8eb6b-+-site: reprovision codfw logging cluster to opensearch

0341ccd7b4-+-profile::analytics::cluster::secrets - fix chmod for swift research_poc env file

a83ea59b64-+-P:wikidough: remove redundant space

885dc518d9-+-profile::analytics::cluster::secrets - fix for research_poc swift user

789fcac3e0-+-profile::analytics::cluster::secrets - run as hdfs user

fb8b57842d-+-Deploy research_poc thanos swift auth env file to hadoop

841332fe48-+-site: use gitlab_runner role on gitlab-runner2001

757ac09565-+-requesttracker: delete plugins class

0dbd659158-+-site and install_server: add gitlab-runner2001

7648001e28-+-Write out a separate /etc/ldap/wmf-ldap.conf for tools

086e79cb34-+-profile::kafka::broker: allow to specify kafka uid/gid

e06ccce817-+-site.pp: Add testing cluster

d03239e52e-+-extdist: Fix conditional to use lt, not le

fcc8ab33a1-+-extdist: Only enable labs::lvm::srv on pre-bullseye

7c18c2affa-+-extdist: Use packaged composer on bullseye

8ad5c4ae85-+-Add new restbase202[456] to site.pp

a5bc397bea-+-profile: allow logstash checker to query opensearch

b20ff745e7-+-opensearch: use systemd timer for gc log rotation

16a22677c6-+-Revert "striker: send dev logs to logstash pipeline via localhost"

19804e27c3-+-striker: send dev logs to logstash pipeline via localhost

d51ba024ac-+-mediawiki: Install yaml extension for SettingsBuilder on canaries

365f24d2d7-+-Switch WCQS to profile::base::linux510

66af0571b1-+-wmcs: added admin script to produce text of annual purge wiki page

25bb331dce-+-cirrussearch: fix grafana dashboard links

9ba5b23275-+-rdf-streaming-updater: Provide the namespace to be updated

5251c8caee-+-Convert cloudvirt1028 into a local storage hypervisor

11750e0b9f-+-site: consolidate logstash node definitions

cad577ae69-+-site: Reimage cp1089 as cache::text_haproxy

d45ad1e9c3-+-Remove three more HDFS checks from Icinga

2bae9078f9-+-puppetboard: drop definitions for puppetboard [12]001

b319b429eb-+-site: use gitlab_runner role on gitlab-runner1001

0c68f6136f-+-varnish: Listen on several Unix Domain Sockets

6572cd33ad-+-presto: use system truststore to validate TLS connections

c23dd10496-+-presto: use new ca bundle jks for internal TLS traffic

aab0f28696-+-presto: move truststore to the new wmf internal CA bundle

a05fe3afe6-+-profile::kafka::broker: use new get ca bundle path helpers

4826c27194-+-Move coal, navtiming and statsv to the new canonical CA bundle path

680f7498b0-+-[wdqs] cleanup streaming updater config

495d8d40c4-+-Add profile::base::linux419 to the WCQS role

64c7bb467e-+-opensearch-dashboards: enable phatality on beta-logs

0b482d7506-+-cache::haproxy: Avoid using lua

056a15f7d9-+-refine - bump jar version to get deduplication logic fix

da7ec164be-+-P::doc: sync data to non-active servers

217e0a243b-+-O:puppetboard::ng: rename to puppetboard

61110a58c4-+-O:puppetboard: drop ol puppetboard code

4719707b69-+-Move kafkatee instances to the new CA bundle location

026c6c0c04-+-Add helper functions to retrieve CA bundle paths/passwords

8b984fbfa1-+-install_server: notify dhcp server

af860f9b4f-+-ceph: migrate mon auth to the new abstraction

b0890e7ad0-+-ceph: auth: introduce function to calculate keyring_path

f99ad43eca-+-ceph: auth: introduce new parameter 'import_to_ceph'

08a534c57d-+-sslcert::trusted_ca: ensure cert bundle readability for group/others

bd134770b1-+-fix up filesize config option for commons mediainfo dumps in deployment prep

ea51f2aeb8-+-Add drmrs public prefix to ntp allowed config

f6824459ce-+-Disable cluster rebalances temporarily

46bcfeba5c-+-Retire labnet-users group

f16f37ea9a-+-atskafka: use the same ca certificate as varnishkafka

0263dc34ec-+-hieradata: Swap deployment-prep deploy host

09777b72b3-+-puppetmaster::gitsync: Replace cron job with systemd timer

51561f3013-+-trusted_ca: Fix typo defaut->default

f135e170c0-+-analytics/systemd/sqoop: Add daily sqoop

7539c63d3a-+-sslcert: use correct default of undef

a2d0313a26-+-P:cache::kafka::Webrequest: always include profile::cache::kafka::certificate

e8184c4347-+-O:sslcert::trusted_ca: fix trying to join struct to array

7cdcb090c1-+-P:cache::kafka::Webrequest: use cert defined in P:certificates

f727334826-+-P:base::certificates: update support for trusted CA

2b06da766a-+-profile: ceph: cleanup firewall config

d9fd7d387d-+-ceph: move bootstrap keyring into new auth abstraction

bc0a1a649f-+-site: Reimage cp3064 as cache::text_haproxy

61e52620ad-+-site: Reimage cp2041 as cache::text_haproxy

bac28b9843-+-cinder-backup: subscribe to config file changes

1ed3b1e76c-+-ores::worker: disable coredumps

a5d66b8365-+-P:ci::slave::labs::common: Add toggle for lvm managment

359acd465e-+-puppet_compiler: additional volume is not ephemeral

9d2472e390-+-puppet_compiler: dont use mkdir_p

9caebc4e43-+-puppet_compiler: mkdir_p workdir not vardir

7c612b736c-+-P:puppet_compiler: Refactor

29c95595d8-+-pontoon: use profile::base on puppet master

7e5054b168-+-P:puppet_compiler::postgres_database: create ssl directory

05def7d48f-+-timsyncd: Flip the handling service condition

ce5ba87692-+-timesyncd: handle bullseye ntp hosts

d780ff9681-+-interfaces: remove ethtool configueration

47d036ce76-+-Prepare site.pp for new ping VMs

da1cd8f53a-+-cassandra: correct check notes URL

f3bf630df6-+-ceph: common: support both buster & bullseye

709dfc2f38-+-cache::haproxy: Disable PROXY protocol

faaa022588-+-alertmanager: Update address for perf-team alerts

1b14071c2e-+-db1128: Move it to test-s1

f2d1e86add-+-site and install_server: add gitlab-runner1001

455f0cf7bf-+-profile: logstash: add production logstash profile

a8b4f2ec4c-+-mailman3_queue_size: increase check intervals

6d05bf167f-+-logstash: deploy ecs 1.11.0-1

dd4d025259-+-P::doc: use correct php_fpm path

d665796d85-+-mediawiki: Remove libvips-tools

d7356078de-+-mediawiki: Remove tidy binary

e336de155a-+-Add elastic206[1-9]elastic207[0-2] to site.pp

9d3ebd42e6-+-Delete roles for bare metal WMCS puppet masters

11504e4a1f-+-wmflib::argparse: improve type checking

17a211cbb1-+-argparse: Fix number of parameters when String argument contains spaces

7839029344-+-mariadb: Remove :: from profile setup on 2 mariadb roles

ec181097cb-+-httpbb: add missing file in previous change

ea824741c4-+-mariadb: Split the dbstore_multiinstance role into two others

c0ff0b074a-+-analytics:refinery:job:refine_sanitize: Fix refine_monitor offsets

50abaa4f51-+-P:puppetboard::ng: Add nrpe check_http command

a75d31c243-+-R:service::uwsgi: add support for nrpe check_http check

26f2254a88-+-wmflib::argpasre: parse args to command string

139bca6d24-+-varnish: Fix UDS check cmd

18bb442c9d-+-R:uwsgi::app: Add parameter types

ce6966a2af-+-cp5006: Disable PROXY protocol

0081a9830c-+-Add wdqs200[9,10,11,12} to site.pp and netboot.cfg

94719afcb4-+-wikimania_scholarships: delete module and profile, remove from miscweb

88ba767465-+-cache:haproxy: Set http-reuse to always

fb9bef3282-+-acme_chief: remove absented cron code

5a51cd2fff-+-haproxy:tls_teminator: Allow configuring http-use

a4a392f32e-+-profile::base::certificates: deploy wmf-certificates only in prod

5cda0e214b-+-analytics:refinery:job:druid_load: Reduce shard size for netflow_sanitized

2392c8ead4-+-mariadb: Promote db1132 to m5 master

5415b832f4-+-site: Reimage cp5012 as cache::text_haproxy

7bf8331d0a-+-prometheus::ops: Gather varnish mtail metrics on text_haproxy

b46a1aad82-+-cirrussearch: temporarily disable saneitizer

5366563476-+-acme_chief: new timer needs to use '1h' not 'hourly'

d991881198-+-acme_chief: convert cron to restart service to timer

2ee46bf87e-+-gitlab: create role for prod gitlab-runners, adjust cumin alias

c8d9e5e5e5-+-Add ganeti200[78] to site.pp and netboot.cfg

382296ad58-+-query_service: Generalize prometheus config

9cdf88f478-+-prometheus::ops: Add cache::text_haproxy nodes

08a60177c5-+-site: Reimage cp4032 as cache::text_haproxy

c6c5d36f82-+-role:cache: Provide a text_haproxy role

cb7eacf85b-+-librenms: replace librenms-readers with wmf/nda

d8fccc62bf-+-Revert "Include base::puppet in profile::puppetmaster::pontoon"

a6db9be67a-+-Revert "Revert "dynamicproxy: add keystone token verification""

50906f5713-+-cinder: fix config template and don't reuse 'ceph_pool' that much

e4a4714e5c-+-ceph: update default version to octopus

d946427c51-+-packages_wmf.pp: Add bullseye support

d8178f7a4e-+-Revert "dynamicproxy: add keystone token verification"

6bd9e6e21c-+-Add prometheus200[56] to site.pp and netboot.cfg

cebdf346d5-+-R:scap::target: drop notice message

800b5a91d0-+-Remove thumbor2001 and thumbor2002 from site.pp

80780be018-+-site/conftool-data: remove mw2280

a14faedaa3-+-Add kubernetes2018 to site.pp

89e0570b36-+-logstash::input::gelf: remove hardcoded tags

7916390f43-+-dynamicproxy: add keystone token verification

ad504cde9b-+-role::elasticsearch::relforge: ship ES logs via gelf_relay

918b8f92cc-+-role::elasticsearch::cloudelastic: ship ES logs via gelf_relay

fa05989fec-+-dynamicproxy: add tls to api

f7b10e3aef-+-Add LDAP_RW_URI to horizon local_settings.py

f0a08c0b1b-+-wmfkeystonehooks: don't rely on ldap.conf for ldap settings

1785664414-+-ci: upgrade lintian-junit-report

098807cf0b-+-cloud: cinder-backup: refresh hiera defaults for eqiad1

a2878ca20d-+-cloud: cinder-backups: refresh node references

03b9dad589-+-Remove thumbor1003 and thumbor1004 from site.pp

2c390b31f3-+-disable_tool: run every 2 minutes rather than every 5

e720785d52-+-site: include new k8s hosts on kubestage group

cdb061ce20-+-cloudbackup: require the lvm package

4c7b9fa78a-+-updating site.pp for an-test-coord1002.

48bd739b3c-+-cloudbackup: introduce base profiles

b8a76e28a8-+-cloudbackup: introduce ceph rbd configuration

e66c88bc25-+-profile::cache::kafka::webrequest: add pki settings

6de804b36a-+-cache::haproxy: Increase rsyslog config priority

387a7c1cee-+-beta::autoupdater Don't mess with ${stage_dir}/php-master/cache/l10n

0fd109f61f-+-Obsolete role::restbase::base

77a9613d2d-+-prometheus:ops: Fix cache_haproxy_tls_mtail yaml filename

5b144526be-+-cache:haproxy: Gather TTFB metrics using mtail

c05fc5fa85-+-site: Add drmrs lvs instances

8b96c43e80-+-toolforge: enable wheel on buster

722ad701e1-+-site: Reimage cp1090 as cache::upload_haproxy

2f4fa17b5c-+-varnish: remove code used to clean up old mtail scripts

bed787ff61-+-Move thumbor2005 and thumbor2006 to thumbor::mediawiki

0c342a60ab-+-elasticsearch: disallow puppet to restart

a2bd36dec3-+-Add role in site.pp for new rpki2002 VM

9b5ecdbb96-+-site.pp: enable proper role for cloudbackup1001-dev

aef5a74cad-+-ganeti6: switch to ganeti role

cf292a141b-+-site: Reimage cp2042 as cache::upload_haproxy

5552b9f13e-+-P:mail::mx: move otrs_aliases_file to the top of the file

4721d57bf5-+-role::exim: update config to drop ldap validation

bc31c2efb1-+-varnish: fix path to default mtail scripts to remove

db87204555-+-varnish: remove internal mtail scripts from default instance

dec14a3e71-+-cloudbackup100X-dev: add insetup role

f516e044af-+-cassandra: move cluster:user relation from 1:1 relation to a 1:many

12eb055837-+-openstack: radosgw: migrate to new ceph auth abstraction

911408df37-+-P::configmaster: fix typo

43ddc84403-+-sslcert::ca_deselect_dstx3 for envoyproxy

44dd7b3767-+-cloud: ceph: client: rbd_libvirt: enable ceph::auth::conf

8b2ed7a446-+-prometheus:ops: add varnishmtail-internal jobs

d5c45d4021-+-openstack: nova: factorize libvirt secrets management

5d8b222d75-+-apereo_cas: add cas_u2f script

d1878c86b0-+-varnish: move internal mtail scripts to another instance

c2592c492c-+-Move coal, navtiming and statsv to the new CA bundle

37d5207e70-+-Move thumbor1006 to thumbor::mediawiki

1179618e12-+-Added docker::gc class

42cdaa031c-+-httpbb: Add some tests for thumbor

da686c8519-+-wikimania_scholarships: let the module start to remove itself

6f926c8f0b-+-mediawiki/parsoid/wikitech: flip default for font install

bd259ae2fc-+-disable_tool: add ldap uri to the config file

5554cb454b-+-mark_tool: Remove reliance of /etc/ldap.conf or /etc/ldap/ldap.conf

6bc11af4ff-+-gitlab: re-enable restore timer

48587bca52-+-mediawiki::php::restarts: support multiple versions of php

6c2d94d698-+-ceph: auth: introduce datatype for configuration hash

8e5feff3ba-+-P:pki::client: manually deploy the root CA in cloud

e0e19e6966-+-P:netbox::scripts: use role_hosts to get ferm rules

03b92ed8a8-+-cloud: introduce role for cloudbackup-dev

3a6d4cc8f5-+-p:{osd,b_g_images,backy2}: require c::a::deploy when checking keyrings

e16a6c5ad4-+-ceph::auth::keyring: Generate keyring_path if not passed

b0a9323f2d-+-ceph::auth::keyring: allow passing the full client name

c8bb1ad331-+-toolforge::cronrunner: disable cron on non-active hosts

141adc53d5-+-varnish: add varnishmtail-wrapper

d908be58b8-+-Configure stat servers to use /srv/spark-tmp as spark.local.dir

748c28093d-+-Move thumbor1005 from insetup to thumbor::mediawiki

20ac44b115-+-profile: drop successful access logs for shellbox-constraints

64e1f82cae-+-role::elasticsearch::cirrus: ship ES logs via gelf_relay

3ce8299b22-+-cloud: ceph: reorder osd/auth profile declaration

cf040a79a3-+-cloud: ceph: auth: enable admin client

512cdf2157-+-gitlab: disable restore timer to perform upgrade

e8bc1e313e-+-gitlab: accept backup file argument

abc97cb077-+-cloud: ceph: migrate admin keyring to new abstraction

a626ffd79a-+-profile::base::certificates: vary trusted_certs on realm

d12ca88078-+-Import new ROCm version 4.5

37623ba8d0-+-openstack: eqiad1: Remove cinder key generation from cloudcontrols

b40b5d23dc-+-P:multirootca: dont include the root CA

cd93efe99e-+-dragonfly::dfdaemon: Serve the chained cert to clients

5b107e9112-+-openstack: codfw1dev: remove cinder keyring

174d9b7e96-+-mediawiki::php: report prometheus metrics for all php versions

e44a45dc4e-+-maps: Add cronjob to send tile invalidation events

dd753da337-+-P:mediabackup::storage: update mino daemon to use the chained certificate

494c41f82e-+-mediawiki: add support for multiple versions in the web configuration

f83e9994c1-+-mediawiki::php: support multiple php version in monitoring too

1e271ae4b2-+-scap::target - add $manage_ssh_key parameter

00b9ea721d-+-noc: move template used only by NOC to it

e1b94ea239-+-Declare airflow-dags scap for analytics-test instance

c911c621f9-+-Include base::puppet in profile::puppetmaster::pontoon

8de603f667-+-Remove prometheus based Druid checks

1c47712470-+-ceph::control: enable auth deploy on eqiad and remove unused vars

df0f752970-+-cache:haproxy: Disable check_haproxy based checks

c129db0bee-+-haproxy: Allow disabling check_haproxy based monitoring

af72022adf-+-varnish: add varnish::logging::mtail

bc80ecf039-+-P::kubernetes: allow disabling kafka ipv6 on hiera

e40376b57a-+-wikidough: enable support for EDNS padding

506305a38b-+-dnsrecursor: add support for enabling EDNS padding

d7650c516a-+-site: Add drmrs cache instances

f2d2347652-+-Enable refine_sanitize_delayed jobs in test

2699d4a361-+-dbbackups: Reimage db1116, db1139, db2097, db2100 to buster

e657f422ea-+-prometheus:ops: Take role cache::upload_haproxy into account

723db0f91a-+-openstack: networktests: introduce in eqiad1

439bf1db62-+-openstack: networktests: fix timer job interval specification

9ed1ff7001-+-site: Reimage cp3065 as cache::upload_haproxy

8019080f86-+-openstack: networktests: add systemd timer job to run the test suite

37fa367795-+-openstack: networktests: run as dedicated user

5203509afd-+-mariadb: Promote db1109 as s8 master

1a888d7ae2-+-webperf::arclamp: turn log compression & expiry into parameters

4dc29dcd94-+-statistics::product_analytics: Update contact group for monitoring

d1a45b0bb5-+-arclamp: compress logs after 3 days, not 7

89ad664028-+-Add gitlab support for scap_source

119ac7d57e-+-varnish: Mimick XFF behaviour with UDS + PROXY protocol

c4b3320bea-+-Update the times at which refine_sanitize monitor jobs are run

ca766b7448-+-profile::cache::kafka::webrequest: move atskafka to new CA bundle

ca98397098-+-kafkatee:instance: change TLS CA bundle

23133ca16a-+-openstack::control: remove other old keyrings and enable for codfw

b298600e3a-+-ceph::client::rbd_glance: remove keyring generation

3a492a0182-+-Sync db1108's my.cnf settings with analytics_meta

1574aa0d8e-+-profile::base::certificates: renamed jks/p12 truststores

330ec5f93f-+-sslcer: use /bin/cat not /usr/bin/cat

5ff6b1f285-+-P:base::certificates: refactor jks trust-store

3b2231721b-+-php: remove backwards compatibility layer

21fc351092-+-add credentials file for downloading enterprise html dumps

814a273bf0-+-snapshop: remove absented cron code

8476f599e0-+-dynamicproxy: Add a switch to make the api read-only

bca1a5f226-+-P:kafka::broker: switch back to default profile

7da8c551ed-+-php::extension: remove "package_name"

88dd65af39-+-snapshot: convert 2 crons for full and partial dumps into systemd timers

9ec32528a5-+-cache:haproxy: Monitor HTTPS port

c313672955-+-presto: enable ui over http

4c30d3b892-+-ceph::auth: Deploy on virt and virt_ceph_and_backy hosts too

379b87afac-+-varnish: remove support for mtail_additional_args

82b625939a-+-profile::mediawiki::php: Allow running multiple php versions in parallel

032e824064-+-P:kafka::broker: request a server profile cert

e702e19960-+-cache:haproxy: Fix OCSP symlink

e3ff18b693-+-profile::phabricator::main: update usage of php::extension

1a94245d0b-+-dnsdist: allow setting additional custom HTTP response headers

5a5f4fc753-+-php: allow installing multiple php versions at the same time

ec3c1936f1-+-varnish::logging: remove statsd_host and mtail_progs

b8ab4971bc-+-profile::base::certificates: add truststore password

b88956bec9-+-ceph::auth: Add deploy for eqiad virt_ceph hosts too

6ab4bb0852-+-profile::kafka::mirror: add support for PKI-enabled truststore

e64b59af9c-+-varnish: remove cachestats.py

577bb2dcd3-+-site: Reimage cp5006 as cache::upload_haproxy

3c6de42468-+-sslcert::trusted_ca: add explicit ordering for jks

b3ecb610b6-+-varnish: Run nrpe UDS check as root

775dcc2b44-+-varnish::logging: pass list of mtail programs from profile

88a734426d-+-P::novaproxy: deploy dhparam

53dfd364ba-+-ceph::auth::keyring: Add possibility to override file permissions

61d573e142-+-sslcert::trusted_ca: fix file title

7a6404af90-+-profile::kafka::broker: move to profile::base::certificates for pki

925623c843-+-profile::base::certificates: add sslcert::trusted_ca options

b50e747f8e-+-dynamicproxy: fix backup interval

5e573281a4-+-ceph::auth::delpoy: allow not passing the keyring path

fc1853197c-+-O:puppetmaster::puppetdb: rename role to puppetdb

9357e2b1f1-+-libvirt|ceph: small refactor and remove keyrings

f5ab39ddfb-+-Add codfw cloudvirts ceph::auth::deploy profile

138cb30796-+-varnish: remove ensure-absent for varnishmtail

fb803f567f-+-varnish: notify varnishmtail@default

005d15cdbf-+-Revert "varnish: remove ensure-absent for varnishmtail"

a52192f9ec-+-varnish: remove ensure-absent for varnishmtail

2b72cd5d9a-+-cloud: networktests: use -q

9b864f55e1-+-puppetmaster: delete labs-root-password

98af8281b7-+-cache:haproxy: Bump maxconn limits

1de2593bb4-+-dynamicproxy: Drop python 2 redis client

06b2a8eb30-+-Remove unused bigtop hive and oozie database creation code

ddf11bf095-+-prometheus: Avoid filename collitions between haproxy jobs

86b7185744-+-profile::docker::builder: Add building cert-manager images

8e04e205a8-+-analytics:refinery:job:refine_sanitize: Avoid monitor false alerts

c4a3c379d6-+-varnish: use systemd template files for varnishmtail

a3a520ae0e-+-bird::anycast_healthchecker: allow customization of logging options

80e9ec3df3-+-ceph::auth: skip keys with no keydata

1d81895891-+-ceph::auth::load_all: allow generating the keyring path

f20d536d1f-+-ceph::auth: add deploy profile and classes

b5644a3477-+-openstack: networktests: correct some problems

35d1e18127-+-profile::puppet_compiler: fix systemd timer intervals

5ae21e576c-+-cloud: introduce network tests

3cab0de831-+-cache:haproxy: Sort puppet dependencies

e9b6c9770a-+-varnish: install varnishxcache like other mtail programs

1632ea15b8-+-site: Use role cache::upload_haproxy for cp4026

bfe7fed793-+-Revert "Revert "prometheus::ops: Add haproxy-tls@cache_upload config""

7b7512c25a-+-Add comment about Druid data retention for webrequest_sampled_128

ef1349f68f-+-beta: open up opensearch api port to labs in ferm

92a12a60ed-+-java::cacert: add the -keystore option when creating a custom truststore

dceece7888-+-profile::kafka::broker: use a jks truststore for PKI TLS certs

49eff9621e-+-sslcert::trusted_ca: add jks truststore

5e9ec1d488-+-Revert "prometheus::ops: Add haproxy-tls@cache_upload config"

1ca27ca9fe-+-prometheus: remove varnish_2layer

edb7fe4ba0-+-FIX DHCP ferm syntax

66f9008fd5-+-Ferm: allow dhcp request from infra IPs

59bce67d04-+-upload_haproxy: Adopt ::profile::base::production

15afee5242-+-cache:haproxy: Require haproxy bpo pin to install it

7de4ce519c-+-prometheus::ops: Add haproxy-tls@cache_upload config

8435a24dfb-+-maps: Add script to send tile invalidation events

6e3dfafb5c-+-varnish: give higher priority to component/varnish6

b2f8f30aba-+-profile::kafka::broker: add conditions to truststore deployments

06bb4eec50-+-profile::kafka::broker: allow to override super_users

6e0217a812-+-profile::kafka::broker: add truststore for pki-based tls certs

380ba697ce-+-Add sslcert::trusted_root_ca

fd8b832b75-+-profile::statistics::explorer::ml: fix model_upload script perms

1707e17050-+-role::statistics::explorer: add ml profile

8e46ee1a90-+-profile::openstack::base::wikitech::web: add parameter to remove font packages

7fd022d568-+-lists: Use the new private hiera keys

2379eaa749-+-logstash_exporter: add service notify to defaults file

a46067c093-+-logstash: switch monitoring API to port 9675

4c74136ce1-+-mailman: rename public hiera keys

0cdc963dba-+-add logstash gelf relay to elastic1049

a71747d63c-+-cassandra: allow empty tls_cluster_name

a680d19ff9-+-site: Add drmrs ganeti instances

9d0083ab70-+-cloud cumin: support bullseye

7477fac333-+-cassandra: fix incorrect parameter for version

2c56df264b-+-cassandra: use profile::java

3856379cd6-+-prometheus: remove varnish-canary job

16b3fa1064-+-R:cassandra::instance::monitoring: make sure cassandra is loaded

35d1001208-+-centrallog: prep rsync from centrallog2001 -> centrallog2002

2ae6941962-+-cache: Expose prometheus metrics for HAProxy

a8b28212b9-+-site: Add dns instances for drmrs DC site

4bc3509de0-+-Revert "dnsdist: disable check_cmd for version upgrade"

41c8b9df86-+-Re-assign role to cloudcephosd1020

8387bd8d2e-+-cloud: ceph: eqiad: include new nodes in the farm

6275d30f4d-+-dnsdist: disable check_cmd for version upgrade

d3635958ac-+-cache: Provide a HAproxy upload role

8540487a56-+-haproxy: Add missing TLS configuration options

dc1514fbab-+-Also apply ganeti_test role to 2002/2003

bd5f48b783-+-lists: allow banning requests using a hiera array

8f13baa382-+-netconsole::server: remove duplicate netcat-openbsd package

4ed3b0fe0c-+-lists: Split ferm and monitoring of profile::lists

241f2174f1-+-base_packages: install netcat-openbsd by default

22a0ce25bf-+-Bird: peer with router IP (gateway) if nothing explicitly set

564f1a1007-+-Switch ganeti-test2001 to ganeti_test role

78d246bf3c-+-fix up name of enterprise dumps downloader script

a70f3c86ae-+-puppetmaster::r10k: change exec to refreshonly and subscribe

ced0ecef68-+-add the Wikimedia Enterprise content downloader script

3a04b86d1c-+-ceph: introduce auth load abstraction

c4016f7e4a-+-O:puppetmaster:r10k: make config more flexible

5e51d1d3c5-+-C:puppetmaster: don't create hiera.yaml file for r10k users

dedf5e92c7-+-puppetmaster::r10k: check for an actual file

c79ebe0671-+-C:puppetmaster::gitclone: add support for r10k environments

86e3f92f44-+-mariadb: Promote db1118 to s1 master

57d3db0721-+-O:puppetmaster:standalone

abf5180aa2-+-O:puppetmaster: fix environments path

50340b45f1-+-C:puppetmaster::gitclone: add switch to link to environments directory

cb5696e5c0-+-R:acme_chief::cert: drop deprecated paramters

e7b568c7f2-+-maps: Disable http2 in tlsproxy

52bf12c3ef-+-Revert "role::ml_k8s::master: add node-role.kubernetes.io/master labels"

01523fc600-+-tlsproxy::localssl: Allow disabling http2

0df33fce62-+-R:cassandra::instance: explicitly cast string to int

4d69e39e25-+-acme_chief: Page on acme-chief unit failure

2c4058a0b4-+-role::ml_k8s::master: add node-role.kubernetes.io/master labels

824a75a97b-+-elasticsearch: cleanup absented cron resources

ca92d0840a-+-growthexperiments.pp: Run purgeExpiredMentorStatus.php twice a month

2b016dc60e-+-growthexperiments.pp: Remove absented job

264f8fde17-+-site: Add new cache instances in ulsfo DC

ff9e77ce29-+-change drmrs PDU facilities from 3 phase to 1 phase

96f18842ed-+-wikistats: use wmflib::dir::mkdir_p, ensure dirs exist before first deploy

2dbd4634c3-+-wikistats: refactor related to supporting bullseye with new PHP version

e2351f8bda-+-insetup_noferm

87e28ee554-+-ferm not firm

c2a9fb6f66-+-Add model sentry4 to both PDU's for drmrs

d3c7273e2b-+-Add new PDU for drmrs site

c4292dd29e-+-P:kafaka::broker: use chained file for p12

dcff953dbb-+-C:cert: create chained certificate using root

ea5083c646-+-profile::kafka::broker: add new Kafka PKI intermediate CA option

fa835a40c8-+-P:docker::engine: don blindly include profile::docker::engine

f74fc1f25f-+-P:docker::storage: Add defaults for physical_volumes and vg_to_remove

0486e9435c-+-toolforge: exclude DST_Root_CA_X3

c170d7ee42-+-sslcert: introduce ca_deselect_dstx3

bb4110ee86-+-R:ceph::keyring: ensure all variables are defined

95350bdf84-+-O:cluster::management: only send out systemd emails in production

f4d51375c1-+-haproxy: Allow setting variables

f327795b62-+-Add drmrs network to monitoring

8ea9836605-+-new cp40[3-6]

a92a6a8bd6-+-mediawiki: allow absenting font packages via hiera

d89db699ee-+-Revert "Add new PDU for drmrs site"

1dfb797944-+-Add new PDU for drmrs site

778fd0d3d8-+-wikistats::httpd: fix PHP package names with duplicate 'phpphp' string

52ac222ef7-+-wikistats: drop unneeded wikistats_host parameter

1564cc7644-+-wikistats: pass php_version parameter to web class to support bullseye

a1050e0c50-+-gitlab: ensure restore timer is enabled only on passive host

f93327eed3-+-hdfs_cleaner - Use $ensure_timer param for hdfs-cleaner-gobblin

b70ca64b41-+-re-enable hdfs-cleaner-gobblin

3d62783e4c-+-profile::logstash::gelf_relay: ingest GELF logs and output as JSON over UDP

ec3b0d5575-+-ntp: Add drmrs DC site

3c3f20fae5-+-realm: Add drmrs DC site  IP regex

5f11d61c06-+-P:mariadb::grants::production: ensure we inlucde required classes

e42afdacf0-+-C:gitlab: add default variables for backup_dir_data and backup_dir_config

e12a64b715-+-P:trafficserver::monitoring: include dependent class profile::moniotring

53c7cdc0e3-+-C:bigtop::hue: ensure all variables are deifned

e889fb7ee6-+-bigtop::mysql_jdbc: ensure package_name variable is always defined

239b8bd717-+-P:wmcs::monitoring: fix typo

ee9c91eb86-+-cache::haproxy: Remove deprecated require_package

af88a796ad-+-profile: add enable_relay flag to statsd exporter profile

9728ba4ad2-+-growthexperiments/updatementeedata: Run updates every three hours

c58ea9c248-+-C:aptrepo::rsync: explicitly include aptrepo::rsync

243df3e53f-+-P:docker::engine: ensure we include all required classes

b369b10615-+-P:druid::historical: make sure all variables are defined

3afca576db-+-R:netops::check: drop is_array as its depreacated

14ecfc19fa-+-P:nftables::basefirewall: drop is_ip{4,6}_address as deprecated

be7f121aca-+-Refine: now use -shaded jar

ccc60739b4-+-rsyslog: centralize remote_syslog_tls lookups into single location in hiera

bfde4b6277-+-R:profile::prometheus::redis_exporter: explicitly cast to int

f4749f428c-+-P:redis::multidc: drop warning

dc2bd8f565-+-Bump Refine version to 0.1.20 to get JsonSchemaConvert map type logic change

077bd117e6-+-P:webperf::processors: explicitly cast port as a integer

80db97566c-+-Add digicert-2021-unified certs and intermediates

630e17a1f9-+-statistics::product_analytics: Switch to monthly execution

ff9e737f24-+-mariadb: Allow lists1001 to talk to m5's dbproxy

1cc78622e4-+-ceph|openstack: add comment when generating ceph keyrings

5121590ae2-+-remove role::beta::puppetmaster

fcdae7c074-+-O:puppetmaster::standalon: add support for logstash report

f386739267-+-P:puppetmaster::common: Add back logstash support

2735e2a46a-+-p:openstack::cinder::backup: add cinder user option

9c564f088f-+-Revert "Thumbor: Choose python-logstash package based on distro"

ed539b8819-+-gitlab: disable puppet in script and change timer

8857770e39-+-Thumbor: Choose python-logstash package based on distro

13dc5d2323-+-mediawiki::packages::fonts: replace fonts-liberation with fonts-liberation2

10ce7e33e1-+-threedtopng::deploy: Only install nodejs-legacy on Stretch

340677edc8-+-ceph::osd: add cinder backup hosts to ferm

9d2e4d7e5e-+-Regularly resubmit changes that might be stuck in wb_changes

cd1630676c-+-airflow - Allow access to webserver port

81a737898f-+-thumbor: Remove conditionalization for stretch

1f887fb920-+-Remove all remaining references to alluxio

a313842535-+-Purge any unmanaged files from /etc/security/keytabs

8ef9f5530d-+-Add a temporary firewall rule to support cassandra3 migration

8d8c8bcbf4-+-puppetize directories for Wikimedia Enterprise dumps

02441355b7-+-tlsproxy::localssl: acme_chief should notify nginx

539132a367-+-Revert "statsd: failover writes to graphite2003"

955ccc654d-+-Revert "monitoring: check graphite2003 metrics"

33604ebba6-+-grafana::production: exclude grafana.db-journal from rsync

67fff527bf-+-query_service: Add new oauth related configuration

c4c02596af-+-profile: add beta logstash profile

0b37a5fa63-+-role: add logging::opensearch::collector role

693815ef93-+-rsync::quickdatacopy: add option to exclude some files

52425a7f8e-+-package_builder: Refactor PHP hook into a template

749d4012fb-+-package_builder: Add hook to stop rebuilding man-db

690f39712f-+-docker: Mostly documentation updates

46cc7811cb-+-P:puppetboard::ng: drop icinga check

4c37d157b9-+-P:puppetboard::ng: add notify for service

7ae2ac33f4-+-P:puppetmaster::ng: Enable catalog and update inventory facts

4df96a6dc9-+-codfw1dev openstack: fix keystone http port number

4be9b8efff-+-Revert "nova: increase timeout for flavor monitoring"

602a99a7a8-+-nova: increase timeout for flavor monitoring

67df24fa44-+-keystone: use https check rather than http check for endpoint checks

1670f25254-+-Striker: use https endpoint for OpenStack

e1d18aff8f-+-Designate: specify https for keystone authtoken url

4897a38c9c-+-OpenStack: Always use the tls ports (25000, 25357) for openstack services

fa61097ce4-+-zuul: use releng list rather than jenkins-bot for email

83a174411b-+-wikistats::httpd: support buster with PHP 7.4

e38096057d-+-simplelap: ensure httpd::mpm before mpm, set purge_manual_config => false

0a67cb97aa-+-simplelamp2: ensure httpd::mpm comes before httpd, revert previous change

bf14c28aaf-+-simplelamp2: add a notify->exec to restart apache before changing MPM

b4e9d79fe4-+-role: add logging::opensearch::data role

d74569fec9-+-profile: add logstash common profile

fd0965c54c-+-simplelamp2: declare httpd::mpm explicitly and use prefork MPM

e1d095bd81-+-Revert "ntp: Add drmrs DC site"

1d3ac15b37-+-zuul: double git-daemon max connections 48 -> 96

ff42d8590d-+-P:puppetdb: update puppetboard hosts

841a67301c-+-P:puppetboard::ng: use P:base:::production

2d1741b2d1-+-O:puppetboard::ng: add new role

5179deb902-+-ntp: Add drmrs DC site

9091f32d73-+-kubectl::kubeadm: make kubectl-sudo executable

3a40e78093-+-kubeadm::kubectl: install kubectl-sudo

71d5d815bd-+-P:idp::standalon: switch to P:base::production

05866feae4-+-Revert "P:idp::standalon: remove unused profile"

eab1b26ed3-+-Set ganeti2025/2026 to insetup

ba8116d28e-+-prometheus: Add drmrs DC site

0c23ad9bdf-+-simplelap: declare httpd::mpm explicitly and use prefork MPM

5534c04032-+-simplelap: fix a typo introduced in a previous change

c88d8b330d-+-profile: fork kibana profile into opensearch::dashboards

a78e6fae44-+-Openstack Keystone: pass in the auth_uri from the keystone profile

c2d94273a9-+-kafka_shipper: map site->kafka cluster name & point codfw to codfw brokers

0258e543a3-+-P:base: move profile::rsyslog::kafka_shipper to production only

60d0094a9c-+-global: remove all "filtertags" lines

3cedd948a5-+-OpenStack: remove obsolete 'train' config files

08dbc61016-+-Revert "kafka_shipper: map site->kafka cluster name & point codfw to codfw brokers"

c3f89f6331-+-Remove HDFS Capacity Remaining check from Icinga

aa2218a5bc-+-Designate: add tls firewall rules to the api firewall class

62fdbc3cb0-+-openStack:haproxy add tls termination for openstack in eqiad1

c182c709ac-+-install_server: uniform DHCP snippet automation

8ec722b91c-+-kafka_shipper: map site->kafka cluster name & point codfw to codfw brokers

79253adc61-+-P:standard: drop profile::standard as its no longer used

31282c57ae-+-P:base::labs: update labs base profile to include profile::base

8188c303b7-+-P:base::production: update production roles to use P::base::production

fee869d270-+-P:base::production: add parameters to disable this profile

266d1dd375-+-P:idp::standalon: remove unused profile

b03953fb6a-+-P:base: move production specific code to their own profile

2d4923f136-+-Remove the alluxio user and group

9d2eb790e0-+-librenms: add snmp v3 dummy section

b12be8750c-+-C:package_builder: drop superfluous dependencies and pre_condition

964c48781a-+-Absent the Analytics hdfs-cleaner-gobblin timer

7325d13b06-+-gitlab: Refactor docker volume parameters to use cinder

d7ea734251-+-gitlab: Allow configuration of gitlab-runner concurrency

f4556148e1-+-profile: fork elasticsearch profile into opensearch::server

e8ec1664fa-+-builder/systemtap: convert role::systemtap::devserver to profile

97a7e98992-+-Add analytics purge for Gobblin old files

7abe154247-+-package_builder: Add hook for building PHP 7.4 packages

fb6036e4e6-+-P:puppetboard:ng: pass through additional variables

4dc9f26d2c-+-P:puppetboard::ng: update uwsgi to use an actual python module

29e2d4e761-+-service::uwsgi: drop python for ge bullseye

2edffb4b00-+-puppetboard-ng.erb: add uwsgi_port

208e6112a7-+-mariadb: Remove absented alias file

000c45ba2e-+-anycast_monitoring: add check for durum

dd0e24b487-+-P::toolforge: rename toollabs-webservice package name

9329170563-+-icinga: read monitoring groups from wikimedia_clusters

63d3c2fd13-+-profile: fork elasticsearch base_checks for opensearch

1dc9e7c022-+-profile: fork elasticsearch::logstash into opensearch::logstash

bf8b718b84-+-logstash: kafka input: add manage_truststore parameter

a0a4d3ef23-+-icinga: fork icinga::monitor::elasticsearch::base_checks

d33699f420-+-openstack::haproxy: add tls for the barbican api in codfw1dev

e7b6506ac7-+-openstack::haproxy: add tls for the swift api in codfw1dev

d86c2f6439-+-openstack::haproxy: add tls for the placement api in codfw1dev

3f6e3b304c-+-openstack::haproxy: add tls for the trove api in codfw1dev

98fab0c72b-+-openstack::haproxy: add tls for the neutron api in codfw1dev

b74d4e2719-+-openstack::haproxy: add tls for the cinder api in codfw1dev

ca8f5accc9-+-openstack::haproxy: add tls for the keystone-admin api in codfw1dev

92a4777204-+-openstack::haproxy: Add tls frontend for designate api in codfw1dev

da055f0e3e-+-opensearch_dashboards: fork kibana module into opensearch_dashboards module

aaeb5b1693-+-opensearch: fork elasticsearch module into opensearch module

c8a54b001c-+-mediawiki: Drop absented wikibase_repo_prune2 systemd timer

6669e34f18-+-openstack::haproxy: tls-ify nova and glance on codfw1dev

beb7d1cb45-+-openstack:haproxy: set x-forwarded-proto

413fe43c51-+-openstack:haproxy: port-based tls termination support

27f4e6df3b-+-Remove obsolete pki role

966fca24d9-+-mediawiki: Absent wikibase_repo_prune2 systemd timer

2c6ec96a4d-+-thorium decom - Remove absented rsync module

2591333df9-+-mariadb: Use scripts instead of aliases for mysql.<section>

be971d4338-+-contint: regularly prune docker material

df19e76389-+-index page and directory for Wikimedia Enterprise HTML dumps

7590fe5e16-+-P:puppetboard:ng: add new profile for puppetboard

78a00f3b5f-+-systemd::timer::job: add support for splay

74eefd06d9-+-statsd: failover writes to graphite2003

23eb5d1357-+-monitoring: check graphite2003 metrics

c132072caa-+-mariadb: Promote db2103 to s1 codfw master

6ef9a6d5e5-+-ntp::daemon and systemd::timesyncd: use ensure_packages

fba093c617-+-p::s::timesyncd: use ensure in auto_restarts

42d602b455-+-site: cloudvirt1020 back to just virt

340afc057b-+-Buster tracking updates

8f59f57442-+-puppetboard: use correct file path settings.py

023f66bd49-+-puppetboard: fix typo

d3a46fa902-+-puppetboard: also add facts-contents

e043a9050b-+-cache::haproxy: Manage request/response headers

d34e673642-+-haproxy: Allow loading lua scripts

3ef3e7d536-+-haproxy: Allow adding/removing HTTP headers

41d93a1e06-+-haproxy: Add PROXY protocol support

527d34e108-+-puppetboard: introduce puppetboard module

1fbf78c1f6-+-haproxy: Add H2 performance tuning settings

432a3051af-+-haproxy: Allow configuring timeouts

308fb5149f-+-profile::prometheus::alerts: update kafka mirror maker settings

f2fd537428-+-centrallog2002: apply role::syslog::centralserver

255d21e4e6-+-cache::haproxy: Configure sslcert::ocsp

f4d83b46ad-+-Remove alluxio resources from puppet

7602c95386-+-haproxy: STEK support

5fd6119a9b-+-haproxy: Allow configuring TLS options

6ce3ce04c5-+-haproxy: Basic TLS terminator based on HAProxy

1cb5ece067-+-mariadb::packages: use ensure_packages

2f0db8be29-+-mariadb: Add per-section alias

376e53b448-+-P:java: add Wikimedia_Internal_Root_CA to truststore

f47e648635-+-P::toolforge: fix ensure => absent for /srv/composer

e790744aef-+-acme_chief: Enable monitoring on systemd

c837214b73-+-P:pki: deploy certifcates via wmf-certificates

cc3f8c73b6-+-standard: remove standard module

05ccf2f37e-+-standard::ntp: move standard ntp to its own profile

4ceabde559-+-graphite: expire metric files not updated for 3y

81533aeb1f-+-systemd: Allow paging on a systemd::service failure

a50452d453-+-Remove now obsolete owners.yaml file

5166d628ff-+-profile::query_service::monitor::wikidata: update streaming lag monitor

54969e1483-+-peek: drop cron class

e3b3440ff4-+-logstash: deploy ecs patch 5

8b34349707-+-osm: convert common role to profile, avoid role inside role

eccf872801-+-openstack: cinder backups: introduce ceph client config

186c2a9263-+-p:environment: Move wmcs specific etc files to p:wmcs::instance

f8a463f600-+-acme_chief: Support systemd watchdog

6caa6dbdf2-+-standrd::ntp: fix ntp order

22dfececf7-+-P:mail::default_mail_relay: move templates to correct location

3a7918c710-+-adduser: move login.defs config to adduser

45e1075fcb-+-isystemd::sysuser: create option to allow users to login

5db07f7334-+-gitlab::ssh explicitly add git user with fixed id

998a205800-+-kubernetes::deployment_server::mediawiki: add logging configuration

6615f28c64-+-growthexperiments: Run refreshLinkRecommendations in parallel

619af60956-+-cinderutils::ensure: give more info when no device found

4f909d25d7-+-dynamicproxy: remove absented cron code

6cfa31e68d-+-toolforge: wheel of misfortune: dry run on buster

7ac83a4b1d-+-toolforge: drop legacy webservice endpoints on bullseye

0fadcb6373-+-growthexperiments: Remove absented systemd job

f520347983-+-anycast_monitoring: add checks for Wikidough DoH/DoT

536fcf807f-+-P:prometheus::node_exporter: update node_exporter to a profile

fae8c78781-+-C:prometheus::node_puppet_agent: drop dependency on node_exporter

7d3132eaa8-+-p::prometheus::node_exporter: fix typo in docs

ad36b5297c-+-P:prometheus/node_exporter: use include during transision

9f0d2bdf6c-+-openstack: galera: allow DB access to cinder-backup nodes

a8ee677a1a-+-openstack: cinder backups: create directory for mount

d994c8f7d9-+-openstack: cinder backups: use per-deployment rabbit pass

5f60c703af-+-openstack: cinder backups: use per-deployment DB pass

f0053fcf07-+-P:standard: move profile::mail::default_mail_relay to profile::base

6b52ba5002-+-cloudbackup: deploy cinder-backup service

ee6196b34b-+-P:prometheus::node_exporter: update node_exporter to a profile

e6d94b71a8-+-updatementeedata.pp: Update script parameters

47f4d7812d-+-pontoon: skip certificate generation during bootstrap

02bd1bf417-+-base::sysctl::core_dumps: move core_dumps to their own class

ac70d68fb4-+-P:standard: drop unused code/parameters

a8c1f35176-+-systemd::sysuser: also manage the group if we have a uid:gid id

a897490d9a-+-graphite: disable tags support

edf17449ee-+-gitlab: allow installing the restore script while NOT enabling the timer

2286785428-+-gitlab: deactivate new backup-restore unit for now

1148d70a58-+-gitlab: add gitlab restore systemd timer

7100cc9109-+-wikidough: update monitoring::service to check the host IP

3073a53055-+-systemd::sysuser: also manage a user resource

c705e06f28-+-Revert "db-kill: Fix wmfmariadbpy package dependency"

8d1a744d28-+-role::ml_k8s::worker: add LVS configuration for the inference svc

cadb6ece15-+-otrs: Remove T187985 leftover

15a6a9db8b-+-systemd::sysuser: add more error checking

dbcbe1e1a2-+-systemd::sysuser: refactor to provide some useful defaults

fedb88e8cc-+-kubeadm: fix profile.d/helm-config.sh source

19c10de85f-+-kubeadm: add helm-diff

c56f6fd101-+-wmfmariadbpy: Explicitly require the library package

12b06a0bcf-+-db-kill: Fix wmfmariadbpy package dependency

5c5b342dcd-+-mariadb: Add easy-to-use wrapper for pt-kill

81d75b1e93-+-Move swiftrepl to a Hiera option and obsolete role::swift::swiftrepl

32c431fa60-+-graphite: move production to /srv/carbon as storage directory

cef6adbc8c-+-thanos: use include not require

de130d80ee-+-thanos: deploy global alerts only on hosts running thanos-rule

23c4186001-+-profile::manifests::toolforge::disable_tool: fix password/dn mixup

e4167a326b-+-mark_tool.py: fix password/dn swap

514d7a63ef-+-Added mark_tool commandline to cloudcontrol nodes

fb4c4102a9-+-NEL alert is empirically high-signal & should page SRE

e93a4b71f1-+-cumin::target: Move the reboot-host script there

e67ac4c378-+-Extend globbing for testvm*

3dba2bc3d1-+-icinga: remove alertmanager::alerts

b0d5970dee-+-cache: exclude single backend experiment from pooled ATS backends

00d4372298-+-Restrict the use of component/ganeti216 to Stretch hosts

1afbae8fb9-+-openstack: cinder: refactor configuration file to its own module

26e2343da3-+-mediawiki::mcrouter_wancache: disable ssl listening on mcrouter

309c039d48-+-wmcs::instance: use path to allow different systemctl paths

661529238b-+-gitlab: enable Content-Security-Policy reporting

05670c8702-+-mariadb: Page for read-only status issues in both DCs

6a09b15c8b-+-openstack::...vms::common: Use ensure_packages

a7760e610a-+-graphite: fix buffer-size option name

1ad3aaa5be-+-graphite: bump uwsgi buffer space

afc43a2ee1-+-cumin: remove wmf-auto-reimage scripts

d26358305f-+-mailman: Drop mailman module and move them to profile::lists

6619bad402-+-mediawiki: Update cgroup documentation

f317667291-+-mediawiki: Remove absented lilypond and ploticus packages

cece6b305b-+-mediawiki: Remove ploticus

6b5be43b7d-+-mediawiki: Remove lilypond

580315be3d-+-Adding site.pp entry and dhcpd entry for cloudmetric100[34]

eb48961a62-+-gitlab: set session duration to 604800 seconds

efaf945a2b-+-Adding site.pp, dhcpd and netboot.cfg for kubestage servers

555772793d-+-toolforge harbor: fix type for cert and file params

ed3a779ada-+-toolforge harbor: clean up the certs setup a bit better

6d6131eec3-+-toolforge harbor: install docker-compose with puppet

93e0e23fa4-+-toolforge harbor: install and configure docker properly

8a80be8294-+-toolforge harbor: change the permissions a bit on the dir

886e0c2831-+-toolforge harbor: puppetize the install/compose config file and such

9d971a204a-+-Adding new kubernetes host to site.pp, dhcpd, and netboot.cfg

89f59fddfa-+-bird: use content not source

fc52ba04a5-+-bird: filter v4/v6 prefixes

f1f02470a2-+-bird: add IPv6 support to bird and anycast-healthchecker

4a9a6fddc3-+-C:bird: test migration to epp

de97790c67-+-base::environment: move to profile::environment and parametrize

2fb05351b1-+-base::environment: use only vars inside ::realm ifs

67e78bb396-+-profile::hadoop::yarn_proxy_testcluster: fix if condition

080a89554a-+-P:sre::os_updates: only manage the rsync server on the active host

c3c7dd48df-+-Correct file resource to create directories

bc930959a5-+-growthexperiments: Run updateMenteeData.php in parallel

9593611d2b-+-debdeploy: add force to directory managment to ensure removal

548425ba58-+-P:debdeploy: include debdeploy client not debdeploy

7f226c6553-+-base::auto_restarts: move to profile and make debdeploy support optional

aaf12bf5c2-+-ganeti_rebalance: Normalize calendar entry

d7e4e32789-+-ganeti: Run a monthly cluster rebalancing

92b4fd9197-+-statistics::product_analytics: create and prepare

7f2a814613-+-graphite: set settings_module from uwsgi

5a90d9e2ec-+-statsite: switch to python3 on Bullseye

7cf3eff29f-+-Extend testvm globbing in site.pp

0279f172f6-+-P::base: create standard directories in base::standard_packages

36e0b12639-+-stdlib: update stdlib from version 7.0.1 to 8.1.0

fd39e4fe03-+-P:rsyslog::kafka_shipping: drop unused parameter

98e4d91e0e-+-base::environment: add types to the parameter

948b09ab00-+-deployment_server: fix typo

13f33f0425-+-kubernetes::deployment_server: fix key lookup

8f97ade944-+-kubernetes: allow constraining users to specific subsets of masters

130de50866-+-P:contact::get_owners: sort array before casting

858cf957ff-+-kubernetes: do not repeat user tokens.

fad9037485-+-wmflib: remove require_package

acb4bd441e-+-require_packages: update all uses of require_packages

32d19e13d3-+-dynamicproxy: replace proxydb-bak cron with systemd timer job

3755d46bfb-+-mailman3: Drop profile::mailman3

9bf49948c1-+-Remove Parsoid jessie debs

96a2ec0ee0-+-Revert "Revert "mediawiki/geoip: add option to also pull new MaxMind databases from master""

94dbcd5c04-+-Revert "mediawiki/geoip: add option to also pull new MaxMind databases from master"

62125f3773-+-mediawiki/geoip: add option to also pull new MaxMind databases from master

2206479d07-+-uwsgi: Use /bin/systemctl for non merged-/usr hosts

e0e4e11363-+-ferm: switch to ensure_packages

47fd08705e-+-mailman3::web: dont try to install the packagae twice

12d13978e9-+-rsyslog: switch to ensure_packages

671446bfc5-+-Add audio packages to support DSE hackathon on stat100x

2360512f46-+-pontoon: auto generate service certificates

4b3d7187f6-+-profiles/hiera::gitlab fix ssl configuration

223b955fe3-+-ATS: make backend ram cache size configurable

87ec0f61fa-+-sslcert: switch to using ensure_packages

d43362c5d7-+-profile::gitlab start using gitlab module

d6dde75de1-+-Upgrade stat100[5,8] to ROCm 4.2

4efea44df3-+-toolforge postgres: drop database tuning

50a113e954-+-puppetmaster/geoip: add puppet CA server name to geoip config pt.2

5758b2b180-+-webperf: connect to Kafka using TLS

112d91af44-+-puppetmaster/geoip: add puppet CA server name to geoip config pt.1

642e5bf687-+-logstash: clean up unused cache clear script

5e826bd72e-+-geoip::maxmind: use ensure_resource to ensure data_directory

75b18c0d7d-+-geoip: remove absented cron code for maxmind update

8c4020de56-+-geoip: replace maxmind update cron with system timer and config

1914ee7d6f-+-etcd: remove absented cron code

d89affebe8-+-etcd::backup: convert backup cron to timer job

63ad77c69b-+-P:contacts::get_owners: return a hash mapping roles to their owners

a7e30f406b-+-P:base: include monitoring earlier so that the plugins directory is created

33eb2ec2f6-+-On bullseye and later install routinator from thirdparty/routinator

837d00e7dc-+-uwsgi: restore unicode output for NRPE check

0b6f902e24-+-P:monitoring: change ordering

a48fb7252a-+-graphite: add Bullseye support

90d363d2d1-+-icinga-status: fix non-unicode chars

21021a6cac-+-graphite: stop using LVM for /srv in labs

7c335b1667-+-amd_rocm: add support for ROCm 4.2

dbabfc3ec6-+-Revert "cassandra: use FQDN in CN name for future instances"

567ae1914d-+-cassandra: use FQDN in CN name for future instances

e948ed83a8-+-mediawiki: Remove absented systemd timer jobs

60745022f9-+-openstack: drop manila code

c27fd65798-+-mediawiki: Stop wikidata dispatching via systemd timers

91ed219fd0-+-base: delete unused base::debdeploy

909e9ba745-+-alerts: fix resource ordering

d63373b84b-+-amd_rocm: update settings/packages for ROCm 4.3.1

d9b965e7f6-+-alerts: fix newline escape in unit description

12e5b34912-+-alerts: move alerts-deploy to systemd units

a2cc984cf3-+-alerts: remove icinga overload alert, moved to AM

988b101a74-+-Revert "puppetmaster::geoip: test if new license lets us download needed databases"

7f001c0ac3-+-puppetmaster::geoip: test if new license lets us download needed databases

a363672832-+-wikistats: add email capability to import jobs

ce08ae3e40-+-debdeploy/base: replace require_package with ensure_packages

8d46c5c32c-+-alertmanager: replace require_package with ensure_packages

900fc007ce-+-thanos: replace require_package with ensure_packages

7f98caf6b4-+-AuthDNS DoTLS - use alternate LE chain

224ce14ab3-+-dotls: Benefit from HAProxy support on acme-chief

341933ca60-+-amd_rocm: import ROCm suite 4.3.1

5fc2b4bcf1-+-ssh: Puppetize GatewayPorts config option for sshd_config

11791f4494-+-mediawiki: Drop absented systemd timers of test wikidata change dispatching

0172d781d9-+-geoip/maxmind: fix/rename resources related to new ipinfo job

bb1c064c9c-+-geoip: create transitional class geoip::data::maxmind::ipinfo

768a8eea52-+-puppetmaster::rsync: remove absented cron code

7435647e8f-+-puppetmaster: rename cron references to jobs/timers

9ae7d82cf5-+-Revert "Revert "puppetmaster::rsync: replace data sync crons with timers/jobs""

c6157cb829-+-gitlab: install backup restore script

699de1fc33-+-toolforge harbor: add external postgres db

43337b366b-+-P:rsyslog::kafka_shipper: set hiera config directly in this profile

efb738518e-+-P:base: move more monitoring stuff to the monitoring profile

0bf1f1a429-+-zuul: raise zuul queue alarm

8d9b87fda8-+-P:monitoring::host: rename to P:monitoring

b2123f02a2-+-query_service: default oauth_settings in gui to {}

aae12e6d84-+-query_service: Parameterize oauth redirect url

243704613c-+-Revert "gitlab: test edit"

84ce06d48b-+-query_service: Split oauth secret from settings

0f3297272e-+-Set thorium to role spare::system and remove references to thorium

235bb52b4c-+-mediawiki: Absent testwikidata dispatching and clean up systemd timers

f37a53284a-+-monitoring::openapi_service: update notifications_enabled parameter

48a1a55cbe-+-ganeti: Implement a memory monitoring check for ganeti nodes

706a56c8fd-+-P:base: move base::monitoring::host to its own profile

8992aac768-+-network: add k8s pod+svc ipv{4,6} subnets for the ml-serve clusters

2ee51840dd-+-Replace $KUBEPODS_NETWORKS ferm macro with cluster aware ones

67f9dc1304-+-P:base: make notifications_enabled a boolean

f4a5f688ea-+-network: Split kubepods networks per cluster

d5932fd88b-+-dev-images: migrate repository to gitlab remote

9899b33b5d-+-statistics: remove leftovers for stats.wikimedia.org

8eb170c09d-+-Add testvm2003

26910798c3-+-depdeploy:client: always create the debdeploy-client directory

eb88b340c5-+-prometheus: deploy instance-specific alerts

2eec4c280f-+-prometheus: add instance-specific alerts path

b6536c6300-+-P:tlsproxy::instance: move defaults to hiera

242eef818a-+-openstack: manila: refresh services on config file change

d749e57e34-+-rsyslog: remove 00-abort-unclean-config.conf

caf5e3bf6b-+-Revert "rsyslog: abort on unclean config"

68d4584c5d-+-rsyslog: abort on unclean config

55e9d24076-+-ldap::sssd: remove unused parameter ldapincludes

3163a403dd-+-microsites: Switch to wmflib::dir::mkdir_p

25737238ed-+-query_service: Support proxying to microsite from backend

c0e4f42000-+-Deploy query_service microsite for wcqs

72599de5f9-+-P::toolforge: Use composer package on buster

8aa3fb6213-+-Adding new servers an-db1001-2 to site.pp, dhcpd and netboot.cfg

538e5ef8ff-+-Adding dhcpd file and site.pp for new puppetmaster servers

4259ca6f4f-+-Add thumbor200[56] to site.pp

533bd7a95b-+-Setup systemd timer to sync OS reports

e180bc2daf-+-airflow - Add support for configuring connections using LocalFilesystemBackend

8ae5f790b3-+-logstash: add udp output module

5f7f6d4f28-+-logstash::input::gelf: add host param

60af577b5c-+-logstash: make jmx_ params optional

3eb3f8227c-+-Add mw24[12-19] MAC address and to site.pp

db27175a34-+-ldap::sssd: Don't specify services on bullseye

8040996874-+-ci: Apply profile::wmcs::lvm as needed for new integration instances

af7386d50a-+-ci: Add 'bullseye' to docker lsbdistcodename hack

8c33f33554-+-Fix the ferm configuration for alluxio workers

6b51c214a9-+-Install Alluxio to the test cluster

c0570fe12e-+-openstack: galera: allow optional access to the database from manila share

8526cb072c-+-cassandra: remove variable for enabling jmx exporter

c6da982047-+-ci::master: remove production k8s tokens

2ce7ae6aeb-+-profile::kuberentes_deployment_server: re-think user management

c6222d5bee-+-Revert "puppetmaster::rsync: replace data sync crons with timers/jobs"

bb41e9c3c8-+-puppetmaster::rsync: replace data sync crons with timers/jobs

491eba3f4a-+-swift: remove absented swift-drive-audit cron

3ebd252c7f-+-Adding new elastic servers to dhcp and site.pp

89dd2933c9-+-gitlab: test edit

822d8e935c-+-mailman: More mailman2 clean ups

4e1ee284c3-+-Add microsite for OS reports

fa11d809b7-+-Add kafka clusters' brokers to spicerack config

58a535bd0f-+-wmflib::dir::mkdir_p: fix issue cause by trailing slash

e8af9a044f-+-create role to deploy staging instance for quarry

00f34fc4a7-+-C:base::monitoring::host: Add type definitions

edf1e07088-+-spec tests: drop pre_conditions as its not needed

2b57b96aa9-+-install_server: standardize DHCP includes

fa81d4b092-+-monitoring: drop monitor_screens parameter

655efd2d55-+-openstack: trove: enable service by default

2208483c01-+-swift: migrate swift-drive-audit cron to systemd timer

57a0888220-+-swift: fix metrics prefix for low latency

1260d4841a-+-profile::mail::mx: Remove OS checks

abb23b5afa-+-Disable the "long running screen/tmux session" check by default

1791914779-+-openstack: manila_sharecontroller: fix typo in class name

eeb6af695b-+-openstack: manila_sharecontroller: fix typo in profile name

df3c32a224-+-openstack: manila_sharecontroller: require Debian Bullseye

badcddfa8e-+-openstack: manila: separate manila-share service into a different role

c97a01dbaa-+-Remove rdb200[3456] cruft

d50bd12b77-+-P:base: move git configuration to standard_packages

c33a60bc38-+-P:debdeploy: wmflib not stdlib

4b059c2604-+-debdeploy: fix ensure paramerter

3abf375959-+-openstack: manila: typo in parameter name

c6f3c1e414-+-P:debdeploy::client: bass through ensure

f60497237c-+-openstack: manila: refresh configuration file

5f736b968f-+-P:debdeploy: make ensureable and set absent on cloud

92baadb5c7-+-Remove mx1002/mx2002

9fb64043bf-+-wcqs: go from service_setup to lvs_setup

e9f0951338-+-query_service: LVS for WCQS step 1

4908d70557-+-query_service: fix newly broken gc-log-cleanup

1d1366947a-+-modules::gitlab add missing fields from ansible gitlab.rb template

ab346211c6-+-base::resolving: convert base::resolving to a profile

3fae0064bb-+-resolvconf: create new class

ca72670b11-+-O:base::resolver: unify resolv.conf templates

1f99ea426e-+-O:base::resolving: make nameservers mandatory

266c821478-+-Allow miscweb hosts to pull OS reports via rsync

700c90800a-+-O:idp: update access permissions for sre-admins

e4cb2c9e68-+-mail::mx: fix typo in command name for mail-exim-aliases

4500e8aa6a-+- mail::mx: move mail-alias-file config to class parameters and hiera

797fa269ed-+-mx: turn mail-exim-aliases into proper shell script with config file

8e8106ca5d-+-profile::mediawiki: remove comment references to cron jobs

021e0cf0b0-+-durum: add and set CSP headers for check.wikimedia-dns.org

c1d7e81a35-+-mail::mx: convert cron that sends alias file to ITS to timer

76c935351c-+-rancid: remove absented cron code

53d325e889-+-rancid: convert crons to systemd timers

a3f1d1c0d5-+-Fix typo in group name

223d1cb081-+-Setup timer to generate OS reports daily

5bb562e8b7-+-C:puppetdb::app: drop and rename deprecated config options

385872e29c-+-openstack: manila: install manila-data package

182f73d301-+-Add missing dir declaration to helmfile private configurations

2d5673020a-+-kubernetes: add revscoring-editquality in the services configs

c5dde5c336-+-cloudnfs: refactor profile to allow hiera to set server vols

a7691ced7e-+-profile::mail::mx: add +dkim_verbose to log_selector on bullseye

cca7fc46ae-+-cloudnfs: adding DNS to nfs server

f57acd88df-+-cloudnfs: connect toolsbeta to the VM-based NFS server for testing

40b8f51f6c-+-toolforge harbor: install clients for redis and postgres

86cce97377-+-cloudnfs: some cleanup in case we want more forking

28d0b24890-+-cloudnfs: remove another conflict with the wmcs/instance profile

ad19c74eb0-+-openstack: manila: install python3-manilaclient

65a663f021-+-openstack: codfw1dev: manila: enable services

99c43a0fbc-+-openstack: manila: configure additional bits for the service image

0da5408ffc-+-P:java: fix default_package_name

0d41c9da69-+-valid_section.pp: Remove reference to s10

b711b2a55e-+-openstack: manila: introduce support for manila user

2cb319371a-+-openstack: manila: fix typo in hiera key for rabbit pass

5873a734b0-+-P:java: create new variable to track the default package name

a399e5e56b-+-apt::package_from_component: use apt-get update exec from init class

2117361b7a-+-openstack: manila: fix datatype for db_host config value

11305eac96-+-openstack: manila: introduce rabbit configuration

7e91abf146-+-cloudnfs: remove deprecated dependency on nfs-manage-binds

83a7726614-+-cloudnfs: remove the redundant nfs-common file

b3f32bfab0-+-cloudnfs: switch packages to ensure_packages

3eef7d1ab0-+-swift: remove absented cron for dispersion-stats-lowlatency

e8552d5129-+-swift: absent cron for dispersion-stats-lowlatency

e40714467c-+-swift: convert dispersion-stats-lowlatency to systemd timer

95c738813b-+-swift: remove absented cron for dispersion stats

1dbb09bcf7-+-cloudnfs: set up a PoC Openstack instance-based nfs server

a324a3c0d4-+-labslvm: fix the branch around ephemeral vols

579e455051-+-swift: convert dispersion stats cron to systemd timer

70b92b3771-+-P:puppet::client_bucket: exit with 0 when ok not 1

50c5fe4646-+-P:puppet::client_bucket: update to use a proper nrpe check script

0912168837-+-Install python3-maps-deduped-tilelist on maps masters

c22ebc6f13-+-P:puppet::client_bucket: temporarily absent the nrpe check

0b824598ae-+-P:puppet: Add alerting for large files in client bucket

bf94221b2b-+-Add comment about 'statistics' packages

78d29c950a-+-Add temporary rsync modules to two Cassandra nodes

7785add667-+-openstack: manila: don't show config file diff

6c47192d86-+-openstack: bootstrap manila component

9cc9bad905-+-statistics: decom old httpd Directory for stats.wikimedia.org

01a48b1bd6-+-mediawiki::web::yaml_defs: fix data structure hierarchy

a093870383-+-mediawiki::web::yaml_defs: fix typo

2fa407d20a-+-kubernetes::deployment_server: inject statsd for php fatal errors

2d68a272c6-+-mediawiki::web::yaml_defs: inject php7-fatal-error.php in k8s

d9f86e9455-+-Install swaks on mail servers

2447a65665-+-Revert "mediawiki::packages: remove libvips"

1c366977a2-+-mediawiki::packages: remove libvips

cdb54e2cc5-+-durum: add motd ASCII art

dea34a3ea4-+-thumbor: add a system::role describing it

20d39077eb-+-thumbor: remove absented cron code for generate-thumbor-age-metrics

b7458781f7-+-thumbor: convert generate-thumbor-age-metrics to timer

cca357d028-+-role::releases: Add profiles needed for image testing

e54600c296-+-os-updates-report: Adapt to new OS tracking

4f30a077eb-+-profile::analytics::httpd: disable CGI

0b041966a0-+-mediawiki: Remove support for Stretch

a779447e14-+-Remove obsolete java::security

17f4d39901-+-wdqs: remove codfw hourly restarts

c692d23411-+-wdqs: Prepare streaming updater settings

808c65a055-+-elasticsearch: Switch from cron to systemd timer

1410712a0e-+-query_service: Repair non-scap deployment methods

20387f4217-+-ganeti4004 setup

d6adeb2983-+-query_service: tear out on-disk query event logs

7d870ab555-+-query_service: Disable query logging

194246f1c8-+-wmcs: nfs: nfs-manage: don't hardcode /24 netmasks

3809d0c12e-+-site: update role for durum[12345]00[12]

76bb1c4aaf-+-conftool::safe_service_restart: remove unused parameters

b1e0c07608-+-Disable scope cleanup cron on Thanos backends

280ac57fde-+-query_service: Require paths prior to running wdqs promotion

e761f6ba7b-+-query_service: Provide generic path to query_service logs

42e0aca6b2-+-query_service: Enable installation to new wcqs instances

8010805fda-+-thumbor: remove absented cron code

4fffda4616-+-thumbor: convert systemd-clean-tmpfiles cron to timer

a4f93f637c-+-envoyproxy: Allow setting a global lua script

4627bf4d6e-+-statistics::rsync::published - push to analytics-web.discovery.wmnet cname

31e6145027-+-mediawiki::web::sites: allow k8s-only parameters

a3762cabbd-+-Improve the Kerberos automatic renewal service

c87b7d0937-+-Revert "wcqs: tell puppet solver we need this vars.yaml"

d6bfc99435-+-elasticsearch: Fix cirrus_settings_check

b906d2ee16-+-cloud lvm: finish up volume group creation for ephemeral disk

e006d47a2f-+-Revert "query_service: create common location for vars"

235f73d163-+-query_service: create common location for vars

47f0254ed7-+-wcqs: tell puppet solver we need this vars.yaml

bd73b08337-+-cloud lvm: add back an optional labs_lvm init

545b517cea-+-logging: clean up legacy logstash alerts

cc79e215e4-+-acme_chief,cfssl: Prevent key material from being backuped by puppet

b07fa9df37-+-sslcert: Provide chained TLS cert with private key

d0f608fdf5-+-Revert "sslcert: Provide chained TLS cert with private key"

856a4b217d-+-sslcert: Provide chained TLS cert with private key

c14d02111c-+-dbbackups: Remove s4 and s7 stretch backup source instances

9477867612-+-analytics/data_purge: Finish renaming geoeditors_daily to editors_daily

67976bc63a-+-Revert "[wdqs] switch updater reporting topic to codfw"

e6ffeee32b-+-Allow mwdeploy to run sudo /usr/local/sbin/restart-php7.2-fpm --force

19a2ccff98-+-Change ganeti216 component to only add the apt source

d44b074067-+-safe-service-restart: only verify pooled services

a94c541769-+-prometheus: temp exclude 'rails' from job availability alert

9a72e41875-+-labstore: fix old scratch mountpoint permissions

9a07ddf44b-+-Add puppetmaster200[45] to site.pp, Dhcp and netboot

0145ad65b7-+-Add centrallog2002 to site.pp, dhcp file and netboot

3ae0e6cb64-+-toolforge: package_builder: don't assume we have 2 disks starting with bullseye

07dfa4e05c-+-package_builder: drop transitional packages

50088f91c3-+-envoyproxy: Support TLS min/max version config

05613eec45-+-envoyproxy: Support alpn_protocols configuration

7a50e0ba15-+-planet: parameter 'environment' expects a Hash value, got String

74e4732ebd-+-planet: add HTTPS_PROXY with environment parameter, not directly to cmd

a76c420c93-+-planet: fix updatejob parameters, languages_keys isn't one

3f6a980128-+-planet: replace http_proxy with https_proxy and add it to the update command

9352b683ea-+-mailman: Remove absented file definitions

375dca2695-+-durum: switch to client-side UUID generation

9df7bca342-+-Disable new config validation on Bullseye

708f46c8c1-+-Decommission old eqiad memcached hosts

f273508e40-+-P:sre::check_user: update dependencies and ass proxy support

e606743a7a-+-Add logoutd script for wikitech

23e144621b-+-gitlab::backup move backup cronjobs to puppet

08721c636b-+-site: add durum1002 with insetup role

0037f84bdb-+-query_service: support multiple variants of wdqs microsite

76b115579e-+-swift: add ms-be10[64-67]

eb5909f442-+-contint: do not backup /srv/docker

bd0271af4d-+-puppetdb: log "long" autovacuum tasks

11845f8105-+-Add Hiera option to enable Ganeti 2.16 backport

cbf5e11b20-+-maps: standardise the maps2.0 config in codfw, remove old nodes

05d95a32e5-+-haproxy: Accept systemd unit content instead of template path

e63104f31c-+-haproxy: Allow using a custom systemd::service template

d60c955e03-+-kubeadm::repo: use lsbdistcodename

49f887b00d-+-kubeadm: refresh version defaults for 1.19

d663c70aac-+-statsd: remove statsd_udp_inbound_errors

cef487c99b-+-Revert "query_service: support multiple variants of wdqs microsite"

688dded20c-+-icinga: remove check_grafana_alert

c25004e70c-+-query_service: remove absented query-service-gc-log-cleanup cron

034c012729-+-query_service: support multiple variants of wdqs microsite

5230f887d9-+-mailman: Try to fix 4869d91b0beb92

4869d91b0b-+-mailman: Drop listinfo files

db709dc9b7-+-ms-be1067 updates

0afd118fd9-+-cloud nfs: Update the drbd config to allow buster+

4453f1f6aa-+-P:base: drop broad dependency

8023b70ff4-+-Run GrowthExperiments fixLinkRecommendationData --dry-run every day

97d5884033-+-create a generic class to clean the puppet client bucket

c967bebdb6-+-zuul: Drop absented cron

49f81d16d7-+-zuul: migrate cron of zuul_repack to systemd timer

3416fa578f-+-pc2010: remove puppet entries for pc2010

8981ae1ef2-+-pc2009: remove puppet entries for pc2009

91df7b4e02-+-Add emacs-nox to standard packages

7dedc97846-+-pc2008: remove puppet entries for pc2008

01510ccb65-+-pc1010: remove puppet entries for pc1010

a9f2309c3f-+-puppetmaster: Add drmrs DC Site

ac01e157c7-+-Add a prometheus scrape target for the aqs_next role

31323e7510-+-pc1009: remove puppet entries for pc1009

298c5df140-+-pc1008: remove puppet entries for pc1008

1db8535f33-+-pc1007: remove puppet entries for pc1007

3aefbf2a8c-+-prometheus: couple mysqld export service to mariadb (multi-instance)

05fe49fed5-+-profile::maps::osm_replica: Allow replicas to be connected to by tegola

e783781607-+-postgresql::user: split HBA configuration into a different define

c94d7fa2b4-+-haproxy: Use systemd::service

5d4237bec6-+-mariadb: Promote db2110 to s4 master

92d3e70e50-+-cloud nfs: disable scanning toolforge tool directories

9cac01546c-+-cloud NFS: tighten up the traffic shaping a little

28e7633172-+-wdqs: temp mitigation => restart hourly w random

ecac22bf13-+-Revert "wdqs: temp mitigation => restart hourly w random"

d793d599e8-+-wdqs: temp mitigation => restart hourly w random

4c7399c5ae-+-update celery worker to allow for celery v5

3f18ad987e-+-mariadb: Remove pc2007 from puppet

e418efe949-+-blazegraph: Setup tls termination for wcqs

fc96e61112-+-blazegraph: Setup new wcqs instances

92db6889bf-+-query_service: migrate query-service-gc-log-cleanup cron to systemd timer

aca27e4cae-+-thanos::rule ensure /etc/thanos-rule/rules directory

17a0823622-+-thanos: add recording rules for etcd error slo

7d96628049-+-thanos: add thanos::recording_rule

fa368d7c4d-+-gitlab: Provide profile for docker based GitLab runners

5eaaebe1f9-+-Automatically pull latest MediaWiki image onto staging cluster

f670a84f13-+-envoyproxy: Provide support for UDS upstreams

7e34b96199-+-Fix again --until for monitor_refine_event_sanitized_analytics_delayed

05a46f8e23-+-prometheus_local_crontabs: remove absented cron

c196625392-+-P:standard: move admin to its own profile

483f312b54-+-mariadb::misc::db_inventory: use mariadb::service

6e11aff88c-+-admin: drop dependencies between adminuser and admingroup

430900914a-+-pontoon: extend service_names to include aliases

a36a7849dc-+-wmflib: add 'aliases' to Service

4aafead275-+-prometheus: couple mysqld exporter service to mariadb service

022ef4bf41-+-mariadb: Set pc2007 to spare

f679ca5fc3-+-quarry backup: change the cleanup job to check number of backups

f7e234efc6-+-quarry: add a simple backup server

1cabf131d6-+-backup: Simplify Mailman backups

dacbe8e19a-+-toolforge: remove portgrabber

b68cd68eb1-+-mediawiki::maintenance: Add --statsd to updateMenteeData.php

75dd6f0b7e-+-Adding ms-be1064-66 to site.pp insetup role

b2a1b16686-+-admin: add sre-admins to the always group

605f99b4c6-+-Clean up absented files and unused configs

c530d067c0-+-Drop wikidata alerts

29903c3aa7-+-puppetdb: block additional facts

70f922ee96-+-P::toolforge::apt_pinning: bullseye support

2e34a404bd-+-mailman: Drop lists3 role

d462db9535-+-P::toolforge::redis_sentinel: Block REPLICAOF too

adb720614f-+-cloud osmdb: don't use proxy for cloud

a89fe0bb03-+-cloud osmdb: set num_threads in the sync job

4c45a30ebc-+-realm.pp: update to use structured facts

ac42330db0-+-service_auto_restart - match full line when ensuring absent

1e3f346f8e-+-admin: droprequire

e93f3d84c2-+-osm: remove absented osm_sync_lag cron

60d00e2ec7-+-labstore: remove absented /etc/exports.d/public_root.exports file

32d17fcc53-+-prometheus_local_crontabs: use a systemd timer

701941c257-+-Fix --until for monitor_refine_event_sanitized_analytics_delayed

11cc01f0d3-+-durum: fix notifying the uWSGI service

00e5c30d06-+-osm: migrate cron osm_sync_lag to systemd timer

e369977a56-+-ceph: fix keyring race condition

8fdd139962-+-C:puppetdb::app: move blacklist file to correct config

7ca89a63da-+-icinga: Drop grafana alerts

48c0efbdcd-+-varnish: Allow configuring UDS owner/group/perms

7b59cef56f-+-varnish: Do not assume that UDS implies PROXY protocol

8b0adba531-+-P:puppetdb::database: ensure users are all created before db's

c19d66716b-+-P:configmaster: don't  backup known-hosts and fingerprint files

b51b8d6f4a-+-durum: notify the uWSGI service for app file change

c5a7b01815-+-durum: update results page and remove redundant code

4d88a08733-+-P:prometheus::ops: add cfssl_jobs to actually scrap metrics

766b357d80-+-Switch redis-tools to 'present' rather than 'latest' on Stretch

8bd0747c87-+-racktables: remove work around for missing install in codfw

0310dd17b7-+-racktables: add data types to parameters

faf94d9b20-+-P:dns::auth::config: use backup false for GeoIP2-City.mmdb

f79064b247-+-kubernetes::node: Make use of the disk_type fact

fcf2787cf0-+-mariadb: add section to alert name

9d49a8132b-+-prometheus: remove alerts moved to AM

1348e80ffe-+-logstash: more specific link to udp packet loss runbook

a0f70799f3-+-durum: update nginx.conf.erb

ac9a35461e-+-durum: fix requirements for durum.py

715741037b-+-durum: fix notify for uWSGI service

dee4c705eb-+-durum: intial commit

bcaa481c77-+-durum: introduce role durum

ab39e8163d-+-site: change role of durum1001 from insetup to durum

8f6c2b5137-+-P:base: Create profile::apt

a4375b850c-+-durum: add role insetup

6e4c4fe17a-+-P:debdeploy::client: Add debdeploy profile

219866756d-+-debdeploy: move debdeploy to its own class

afbad3c27a-+-cache: Support TLS on kafka::statsv

f21b24e85c-+-wmflib::role_hosts: fix typos

2a5b849dc7-+-envoyproxy: Add STEK configuration support

0f2d3bfa50-+-Create profile for emacs with disabled backup files, use on releases

b67e3fd0c9-+-k8s::apiserver: Add admission controller config file

3b97751335-+-envoyproxy: Support ECDH curves configuration

bd44defd77-+-profile: remove thanos alerts, moved to alerts.git

0d271ec8e2-+-db2121: Promote to s7 primary

98b59c4557-+-httpbb: Wrap the systemd ExecCommand in "sh -c" so the wildcard works.

7dc6aac045-+-remove lvm

4e8d9175fb-+-cleanup kafkamon role description

cc38e268cf-+-use to_yaml

0247819ad8-+-wmflib::role_hosts: return a sorted array

dc26bca022-+-sretest: test puppetdb function

50e6de8071-+-wmflib::cache::nodes: test new puppetdb function

88f12f4d94-+-envoyproxy: Support ciphersuite configuration

50c77cde36-+-sslcert::x509_to_pkcs12: fix unless statment

5e6c4d0958-+-sslcert::x509_to_pkcs12: fix heredoc

66995fb900-+-Improve creation of pkcs12 file by checking contents

2ef7a367d1-+-envoyproxy: Add dual stack cert support

2b653804c9-+-Add six worker nodes that were staged into service

ac90a44314-+-mcrouter: add option to remove certificatre expiring alerts

5d385a93dc-+-hieradata/hosts.pp: eqiad memcached refresh cleanup

aba5ee9642-+-profile: remove thanos-compact alerts, ported to alerts.git

fddf863e65-+-mediawiki: Drop logrotate config for wikidata

4c173b4f9a-+-Added wmcs-novastats-cephleaks script

eeed147429-+-mediawiki: Absent logrotate for wikidata

c40c51d94c-+-remove lvm requirement

8792f277ed-+-httpbb: Add hourly test runs via systemd timers.

2a0ff1f697-+-base: note that service_unit is deprecated

444d2bf620-+-envoyproxy: Add prefetched OCSP staple support

05f6e0cbad-+-envoyproxy: Support V3 configuration API

f6f0ed4379-+-simplelap: support bullseye

7ec086e1a8-+-simplelamp2: support bullseye

98aba78a83-+-mediabackup: Use file resource in lower case

5acbac996b-+-wmflib: Adopt Cfssl::Wildcard type

3362af2663-+-Propose a format for profile contact data

24ccd2a997-+-icinga: remove reading-web Grafana checks

17fab06ea2-+-mediabackup: Add new conf and identity for read only recovery

a7f829f65f-+-site: remove decommissioned maps hosts

c621216d3e-+-Remove references to old druid servers from site.pp

e4462d81fd-+-swift: prefix Bullseye pipelines with proxy-logging

5ae6e452a5-+-Begin decommission of druid1001

ec1355cf5a-+-retire role::kafka::monitoring and kafkamon[12]001

efe4d7d70c-+-envoyproxy: Add $runtime field to set a static runtime layer.

5aed57aac7-+-maps: Install kafkacat on osm master nodes

51fed6d456-+-maps: Allow creating ad-hoc python venvs for maps scripts

9a3645877f-+-swift: disable ecdhe curve in tlsproxy

4d5aefe0e8-+-pontoon: add lb module

d6c7e4c4b2-+-pontoon: add sd module

097a3c1283-+-pontoon: add service_names

1683191bc0-+-paws trove: actually install mariadb-client

ec41227f55-+-paws trove: add the log dir

8a730f8101-+-paws trove: fix duplicate identifier mistake

67811f090a-+-profile::gitlab load rsync::server only on passive GitLab

ade3e8fd44-+-wmcs.ceph: add cloudcephosd1018 as osd

a01491fb78-+-site: Install memcached on new memcached servers in eqiad

4d67ea71b8-+-swift: stop carrying drive-audit patch starting with Bullseye

afd1bc5dae-+-swift: add support for loopback storage device

40df50156e-+-restbase: Add a new check_disk for instance-data volume

fe64b9eaf1-+-swift: ship uwsgi config for account/container server

7b0e3b8ef0-+-site.pp: Clarify task for the m5 master failover.

5db1ea9d20-+-mediawiki: Drop absented crons in wikidata.pp

10589837c2-+-mediawiki: Migrate wikidatawiki dispatch crons to three systemd timers

8b2eaff679-+-site/conftool: remove mw1276 through mw1279

e0b4fa879f-+-microsites: Add Query Builder subpage to wdqs gui

945b39643a-+-mariadb: Remove commented out File for /root/.my.cnf

2c7fcf0bf8-+-dbbackups: Remove s2 stretch codfw backup source, move s4, upgrade 2099

fb66b8bbf5-+-P::toolforge: Prepare apt repos for bullseye

49c80cbd06-+-statistics::discovery: Stop metric calculation

398550284c-+-site/conftool: add mw1451 through mw1456 as apppservers, A1, A8

6eab972510-+-site: switch doh4002 to O:wikidough

62c3e7316d-+-site/conftool: add mw1447,mw1448,mw1449,mw1450 as canary API appservers

a695a9d490-+-site: remove mw1444 from 'insetup' role

d46039d30f-+-Add cloudsw2-d5-eqiad to monitoring

0a3d75c466-+-remove test PDUs that are being shipped back

b2c8481ca7-+-pontoon: allow any IP range to access the frontend

042ec36fec-+-mariadb: Move db1132 to m5.

0871fd8a76-+-Revert "mediawiki::mcrouter_wancache: disable ssl listening on mcrouter"

6f72def743-+-labstore: remove absented archive_export_d cron

18f4b80b90-+-site: add role insetup for doh4002

9630b36786-+-arclamp: add temporary excimer-k8s pipeline

ae250f9bba-+-mediawiki::mcrouter_wancache: disable ssl listening on mcrouter

db41385d9e-+-mtail: On bullseye use the distro default (3.0.0-rc43)

cb054a0c25-+-Decommission druid1002.eqiad.wmnet

6738bb0253-+-role: add standard/firewall to pontoon::frontend

003d3e051c-+-cassandra: remove cassandra-metrics-collector

4a3658aa11-+-Begin decommission of druid1003.eqiad.wmnet

cc559bec82-+-Apply MX role to mx2002

28040c012e-+-bacula: Change default retention to 60 days

b30606d42a-+-deploy-mwdebug: introduce interactive mode

0e8d66eb75-+-mariadb: Promote db1107 to m3 master.

49a80bf6c4-+-labstore: migrate cron of archive_export_d to systemd timer

2616b0c935-+-mediabackups: Hide diffs from logs on sensitive files and cleanup

06073e3a61-+-mediabackups: Add python3 dependencies and misc changes for workers

8a39b7523a-+-mediabackup: Puppetize the media backup workers

61ba3e6f40-+-logstash: remove absented cron and file

39ded535e0-+-prometheus: tweak external url to reflect reality

69b82e54e9-+-kubernetes:node: Fix disk-type annotation

2bf9c38525-+-drafonfly: Clean up and document dragonfly classes

7dc8e9d27b-+-profile::gitlab rsync fix rsync backup command

c5f9d75aae-+-mariadb: Promote db2104 to s2 master

3ae617555a-+-logstash: remove absented cron

6c2ac547a4-+-fixing entry for new mc host

08451a89a6-+-new mc nodes install params

f8d02b6ffb-+-ganetia1023-24 setup netboot.cfg, dhcpd file, site.pp

120704995a-+-setup dumpsdata1004-5, dhpd, site.pp and netboot.cfg

531e2785a0-+-mediawiki: Migrate dispatching cron of testwikidatawiki to systemd timer

3e7752e3fb-+-profile::gitlab rsync latest backup to passive host

7619700166-+-Fix the ownership of more druid directories

60b63764ca-+-mediawiki::tlsproxy::yaml_defs: brown paper bag fix

c11d740e69-+-mediawiki::tlsproxy::yaml_defs: fix file permissions

379b8747bd-+-trafficserver: ensure sysconfdir exists on default instance

5c9fc4d13b-+-Revert "mariadb: Promote db2104 to s2 master"

4d41bb8f2e-+-mariadb: Promote db2104 to s2 master

91faef3e1a-+-mwdebug: also get discovery listeners from puppet

a3e1fe5c57-+-deploy-mwdebug: better handle errors

8baadcf3fb-+-Bring an-druid1005.eqiad.wmnet into service

e9515f3186-+-cache: use confd only if backend list is on etcd

e4ad17bd64-+-site: switch doh5002 to O:wikidough

833ea5c0a6-+-mariadb: Add specific role for sanitarium masters.

34cc5bf5b5-+-cache: deploy prometheus varnish exporter after varnish

1ded14389f-+-Bring an-druid1004.equad.wmnet into service

d6f9d0faa0-+-Create the druid user and group before installing druid-common

c30c7c5647-+-kubernetes::node: Add node.kubernetes.io/disk-type annotation

b2c8e5f67e-+-Bring an-druid1003.eqiad.wmnet into service

8cb60cc2f2-+-mariadb: Move db1107 to m3.

332a1a6a46-+-site/DHCP: decom peek2001

b812d5cab7-+-metricsinfra: Add config management server

9a380eb99a-+-Add cloudsw2-c8-eqiad to monitoring

b30dd46d16-+-site.pp: Fix location of db1167 (s8, not s7)

0f1210ab2b-+-Exclude jupyterhub notebooks from local logging

40c10865d3-+-Revert "prometheus: Add hosts_only=false on minio job"

ae245594ae-+-Clean up appserver_dragonfly test role

130c77e618-+-mediabackups: Make /etc/minio/ssl writeable by owner

838e33ac66-+-mediabackups: Switch TLS certificates to PKI rather than puppet

499279c54d-+-xhgui: enable database access for admins

962573ed5d-+-appserver_dragonfly: Remove experimental stuff from appservers

0c4a115b87-+-dragonfly::dfdaemon: Notify dfdaemon on certificate change

a3849bbdfe-+-profile.icinga_exporter: Added label_teams_config parameter

116953b07a-+-prometheus.icinga_exporter: Add label_teams_config parameter

fc1a504cb3-+-analytics-web: temporary rsync module for thorium

f5b93f0399-+-Remove role insetup for ms-be206[2345] from site.pp

a3ee275ef0-+-analytics web: create htdocs subdirectory

fe0654ecab-+-Add ms-be206[2345] to DHCP file and site.pp

b1c849f2ae-+-wikidough: refactor and move the landing page to a separate file

2999a5e7f1-+-logstash: add logstash103[345] to eqiad elk cluster

55edbbcb05-+-dragonfly::dfdaemon: Add local hostname to dfdaemon certificate

4dea8d3e3d-+-site: add doh5002 with insetup role

a68a45ed79-+-logstash: add logstash203[345] to codfw elk cluster

7bec5d4901-+-prometheus::ops: Scrape metrics from dfdaemon

470b3cef52-+-mariadb: Productionize dbproxy2004

40a86a2bf4-+-cache: single backend experiment

ec69c88a06-+-cache: refactor dynamic_backend_caches logic

36d90fb7f1-+-site/install_server: Add dragonfly-supernode2001 to DHCP and site.pp

1a9e95955e-+-dragonfly: Enable metric scraping for dfdaemon

47e69b7085-+-configmaster: Add drmrs DC site

064a5a8514-+-icinga::ircbot: Send database notifications to #wikimedia-data-persistence

7408db2d7e-+-thanos: add /srv/alerts-thanos to rule alerts path

12894be840-+-alerts: add Thanos-specific alerts deploy

3459c16a02-+-alerts: refactor into ::prometheus

eb5d53713c-+-mediawiki: Remove old 'parser_cache_purging' job

52be86603b-+-toolforge: drop dedicated grid queues

cd2a194b70-+-site/conftool: convert 4 jobrunners to appservers for balance

0371b2950a-+-metricsinfra: Add IRC bot for alerting

1fbe2b77af-+-mediawiki::website: parametrize the fcgi proxy in all sites

8df25e8238-+-Add testvm200[12] to site.pp

08b0eb5596-+-site: Switch a bunch of eqiad appservers to appserver_dragonfly role

c7f42493ed-+-pontoon: allow access from DOMAIN_NETWORKS

b34b0ed2ec-+-mediawiki::appserver_dragonfly: Fix docker package name

072c734eb2-+-Add a temporary role for appservers plus docker and dragonfly

ad141493f1-+-pontoon: fix path to curl

f654a1b556-+-analytics web: create wikistats webdir if absent

ee83cee50f-+-analytics: commission new webserver

304dd7d6d8-+-refine - bump refinery version to pick up normalized_host transform

052562b9b9-+-Add new ganeti-test nodes to DHCP file, site.pp and netboot.cfg

3222fb0d95-+-haproxy: read config directory natively

ba29436d19-+-dbbackups: Move s4 from db1145 to db1139 and reimage db1145 to buster

414966c064-+-dbbackups: Add s4 to db1139, eqiad backup source

f3cfa8e509-+-Set hive default log4j version to 2

6fbbc0f69f-+-metricsinfra: add karma with cas

b91b04c14d-+-dbbackups: Purge db1139:s2, old eqiad stretch backup source

ed86879336-+-gerrit: listen on all address with iptables rule

d52081ea8f-+-site/conftool: decom mw1271 and mw1288, formerly mcrouter proxies

82277ccd86-+-mariadb: Drop absented cron in check_private_data

1b07ff95a3-+-db1183: Move it from m5 to m2

5e19c7158c-+-deploy-mwdebug: use proper syslog identifier

e6d77cdac5-+-deploy-mwdebug: run every 5 minutes

db57097121-+-icinga: remove grafana alerts for Traffic, moved to alertmanager

b970c2a876-+-alertmanager: allow alerts from grafana and thanos-query

f401c8f320-+-pontoon: wait for puppetdb to be up before enabling it

e7827a3558-+-Revert "mariadb: Move db1125 to m1"

2d99c9d346-+-Fix typo in smartmon reset-failed exec name

299f6fdac9-+-site/conftool: decom jobrunners: mw1295,mw1296,mw1298,mw1299

05bf3e1e23-+-deploy-mwdebug: several bugfixes

bc0de199f9-+-site: remove already installed servers from insetup regex

bd05b488a6-+-airflow::instance - use force => true when ensuring directories

b1648c4b00-+-site/conftool: convert 4 appservers to jobrunners in row D for balance

fdde2e6614-+-P:puppetdb: add script to automatically clean down the stockpile dir

addf69578c-+-O:alerting_host: fix job command for statograph systemd timer

cb846431f5-+-O:alerting_host: create puppet class for statograph service.

2e4139c152-+-Revert "mariadb: Move db1124 to m2."

7e7d0c208d-+-bacula: Fix pool name on eqiad databases

c901af671f-+-docker: introduce docker::credentials

af4857ec16-+-bacula: Uniformize the backup of databases to be full weekly

ca31b43ac2-+-bacula: Adjust number of max volumes for database backups

828d07dd55-+-icinga::monitor::gitlab add alerts for https and ssh for gitlab

cff32278aa-+-Update TLS configuration for analytics-test-presto

0f6f31ec92-+-docker_registry_ha: require authentication from deployment servers

b14c04e71b-+-bacula: Increase ES backups retention to 90 days

3d8fa7269c-+-profile::kubernetes::deployment_server: add automation for mw on k8s

ae6b06d39f-+-cloud instances: /qualify/path to systemd

9e6a855c82-+-Cloud instances: further attempt to clear the failed state of smartd

fd5925d8ac-+-Don't run smart drive drive check

e4aeadba9b-+-Toolforge: Added phab tasks explaining why arcanist is installed

767df62bb0-+-toolforge: Install arc in exec environ

cb7f398464-+-P:diffscan: drop contacts from role

14a795004c-+-Update hive to log4j version2 configuration files

b574cd6f5f-+-refinery/job - remove already absented jobs

c76c607fd6-+-Remove no longer used camus module and references to camus

f24d1d35e2-+-Enable kerberos ticket auto-renewal for a test client

e90efb7cc5-+-conf: Switch to nginx-light

e7ce46c71d-+-R:apt::package_from_component: add more flexible packages param

bac1c13f0f-+-Swap dumpsdata rols back now that network maintenance is complete

eb989c0d64-+-Remove Grafana alerts for ORES

3ab6a20944-+-Set up airflow@platform_eng instance on an-airflow1003

77c8f84331-+-Set up airflow-research instance on an-airflow1002

82a91c12bb-+-P:pki::multirootca::monitoring: update sudo rules to drop sudo command

7a8c924f44-+-P:pki::multirootca: add CA name to description

aa43ffbbf8-+-syslog: expose centrallog retention in hiera

d855b8e83f-+-P:pki::multirootca: Add checks for each signer

45b1a1e2d6-+-icinga: remove services Grafana alerts

ae66f24540-+-site/conftool: convert mw1434-mw1436 from API to app servers

2a0e93aa8d-+-wmcs.ceph: remove unused backup role

9e1f88a832-+-Use admin module to manage system user for use by human users

8f61b19eca-+-systemd::preset: add system::preset define

3735c548b4-+-debian::autostart: drop this function

f77f3f29b9-+-admin::user: add support for nonexistent home directory

10d7912fa9-+-Add ganeti2025/2026 to Ganeti test cluster

2aef6e8d08-+-P:pki::get_cert: make discovery the default CA

7a8ec8e1f1-+-Revert "prometheus: temp disable node-pinger"

e104ff0c19-+-prometheus: temp disable node-pinger

5c8be4f6e0-+-Revert "Revert "kafka - Use hardened_tls instead of java::security"

f96b1b7759-+-logstash: remove references to logstash202[012]

56a667df86-+-Move airflow-analytics-test instance to an-test-client1001

da4dea2d65-+-profile::kubernetes::node: add netbase to iptables dependencies

2fbf508b49-+-admin::user: pass home_dir to the user object

bc1b4996b2-+-profile::kubernetes::node: add component/iptables for Buster

cadf9d7a9a-+-Install tmpreaper on quarry web hosts, clean up temp files 4+ days idle

6a8472510e-+-prometheus::ops fix gitlab rails metric path

76fbdaf0a4-+-prometheus::ops add job to scrape gitlab metrics

7413a0257d-+-debian::autostart: correct typo

f561cf2858-+-site/conftool/scap: decom mw1269, replace scap proxy with mw1420

0ee354cec8-+-site/conftool/DHCP: decom mw1285

2988eda189-+-debian::autostart: force the creation of the symlink

b5d5ff740c-+-Move systemd presets to /run

8d423a213b-+-wmflib::dir::mkdir_p: Use ensure_resource for full directory

d833234560-+-thanos: fix rule port

53a6e40c3e-+-move gitlab rails exporter to port 8083

a86f0f4ea6-+-ceph: use the correct var (osd::hosts) for the lookup

d66026e15c-+-prometheus.node-pinger: fix script source path

d4ef6ef4e0-+-ceph: add latency monitoring stats

497065a43f-+-profile: wait for apache2 in wmcs::instance sites-local

4a3bf54261-+-logstash: add gitlab ECS transformations

e2f2a81dcf-+-Added wmcs-pause-cloud admin script

1d61a1c358-+-icinga: fix ircbot::ensure logic

24836e8b5b-+-Make the RAPI certname configurable

952bf2b0ff-+-dragonfly::dfdaemon: Allow to specify ratelimit for dfdaemon

9db8aeac15-+-Fix permissions for /usr/sbin/policy-rc.d

75d2e0b6c6-+-thanos: query rule component too

bb3d5ab68c-+-prometheus: pull metrics from thanos rule

98fda46c37-+-role: activate thanos::rule profile on thanos::frontend

b1394e12b5-+-thanos: add rule to module/profile

32bd2ba79c-+-toolforge harbor: puppetize experimental base server for harbor

21ea5390e4-+-airflow - set default smtp settings

7155dbf369-+-metricsinfra: remove alertmanager from prometheus role

13a5dad83d-+-debian::autostart: update autostart to use custom policy-rc.d script

ce5f91d168-+-profile::prometheus::k8s: collect more metrics from k8s controllers

de2dfcfddc-+-pontoon: fix lookup of public_domain in frontend

11c0aea0bb-+-wikidough: add motd script to indicate logging of root commands

3c23a12495-+-auditd: initial commit for the auditd module.

7979af1369-+-gerrit: remove SMTP encryption option

497cf43de4-+-site/conftool: add mw1443 through mw1446 as API appservers

b726e7513c-+-pontoon: always link hiera directory

50e0e87b0b-+-pontoon: create puppet client dir

949e209f2b-+-pontoon: stop reading stack from hiera

402300e732-+-site/conftool: add mw1439 through mw1442 as appservers, rack D8

527fb7d157-+-icinga/planet: use letsencrypt check command for https cert monitoring

26d762db19-+-Drop kubeadm 1.17 remains

7649903b5a-+-tools prometheus: try directly using openstack

710cd0e0c0-+-disable-tool: add a job to the sge-cron host that archives databases

c7fa5d7953-+-disable_tool: run every 5 minutes rather than every 10

0059397493-+-tools prometheus: allow scraping by ip address

1e55feff85-+-nfs: use disable-tool.py to archive disabled+expired tools

ee74817115-+-toolforge cron: use disable_tool.py to archive crontab for disabled tools

7b59f244b0-+-toolforge grid master: run disable_tool.py every 10 minutes

daff17ffba-+-Remove camus puppetization

2a07dd933c-+-profile::prometheus::ops: add collection of ml-etcd metrics

69c30381e7-+-Ensure remaining camus jobs are absent

0d8cc2ed28-+-pc101[1-4]: Add to parsercache role and sections.

792bee604e-+-conftool: convert mw1421, mw1422 from app to API servers for balance

62c6da015f-+-pc201[1-4]: Add to mariadb::parsercache role

73a761d5e6-+-dumps: Drop absented cron in kiwix

31e247fcc0-+-mediawiki/maintenance/growthexperiments.pp: Run updateMenteeData every day

9a39dc913e-+-logstash: add logstash200[123] to v7 cluster

d5b93a1c20-+-site/conftool/DHCP: decom mw1293, mw1294, jobrunner canaries

caa3c77b99-+-puppetdb: wait for stockpile initialization

d9d4f1be4e-+-Revert "prometheus::ops add jobs to scrape gitlab metrics"

7cb08c6a95-+-site/conftool: add mw1437,mw1438 as canary jobrunners

d2be4ed787-+-Disable unprivileged user namespaces on Bullseye and Buster hosts with 5.10

69c067fa7e-+-autostart: Fix option for disabling a unit if used with update-rc.d

c55a22a687-+-C:puppetdb::app: make stockpile dir and vardir local variables

7c0e42761e-+-prometheus::ops add jobs and ferm rule to scrape gitlab metrics

5565d488ff-+-Complement autostart test setup with a native systemd service

787fb30a71-+-Fix the autostart logic for the systemd preset config file

e65aa41393-+-toolforge: jobs_framework_cli: introduce configuration file

c518a0fdca-+-puppetdb: rename stockpile mount var

3b730ec210-+-yarn: re-enable queues

44723368f1-+-scap: Drop never-used 'sqldump' tool

79683ca7e1-+-site/conftool/DHCP: decom mw1289, mw1290, mw1297

b6af2d0d65-+-scap: set sqldump to ensure => 'absent'

61f7c1aaba-+-logstash::output::kafka - fix typo "boostrap"

10dae6a73b-+-Typo fix: "the the" -> "the"

d2a6b6abf9-+-yarn: disable accepting jobs to queues

8cc3352667-+-prometheus: Add hosts_only=false on minio job

368ad68817-+-mariadb: Migrate cron of check_private_data to systemd timer

6da0b72c47-+-prometheus::ops: Add scraping config for dragonfly supernodes

6089fd8253-+-P:idp: update profile to support delegated authenticators

558c129694-+-C:apereo_cas: Add ability to support delegated authenticators

7e86a3ba9e-+-mediabackup: Enable prometheus monitoring of minio

f210831e2a-+-Use types for apt::pin

5f33ad4118-+-Add 5 minutes offset to gobblin webrequest timer

e32cdd1640-+-prometheus: update alert dashboard link

28e37f76e5-+-swift: enable listing_formats on bullseye

5710842acc-+-swift: use addresses for memcached

86ff2fc6da-+-profile::kubernetes::master: add panel numbers to grafana dashboard links

1d08aab633-+-profile::kubernetes::master: add comments and improve hiera lookups

842f89db12-+-puppetmaster: Collect prometheus metrics about git-sync-upstream

d639f0d922-+-site/conftool/DHCP: decom mw1284,mw1286,mw1287

3b1544b525-+-elastic: Fix timer to fire continually

8bc145cd1a-+-arclamp: Migrate crons to systemd timer

8c33177f29-+-Enable debian::autostart on sretest* for some tests

3124329393-+-swap roles of dumpsdata1001, 1003 in prep for T286065

139bd15916-+-site/conftool: add mw1434,mw1435,mw1436 as API appservers

99ca537320-+-site: assign role gitlab to gitlab2001

0ff6e9ccf6-+-site/conftool: decom mw1270,mw1272,mw1273,mw1274,mw1275

abd6c855d7-+-site: remove decommissioned host malmok.wikimedia.org

63279cb267-+-debian::autostart: function to prevent services autostarting on install

f07baf1e0b-+-openstack galera: set monitor on failover

da202d7cfe-+-P::toolforge:apt_pinning: drop legacy paws k8s cluster pins

0b918a3482-+-toolforge::prometheus: Update PAWS ingress target

ed19d76115-+-metricsinfra: Add separate alertmanager support

c0dff2e857-+-metricsinfra: Remove alertmanager apache proxy

aca76f9395-+-metricsinfra: Add HAProxy for distributing http traffic

6e809273a6-+-fixing copernicium entries

5c71303c19-+-copernicium imaging details

57f59637ac-+-Swap dumper (snapshot1009) and testbed (1013) in preparation for T286069

fda621e76a-+-beta: add warning motd and link to term of uses

7d1b6da795-+-site: add mw1430 to regex for new appserver range

0e15bf1410-+-site/conftool: add mw1429 through mw1433 as appservers, rack B3

d28ba36911-+-site/conftool: add mw1426, mw1427, mw1428 as API appservers

32a0e204d6-+-ceph: Update dashboard links to tags

7461eedc48-+-ceph: Update health alert url to runbook

e54994c988-+-dragonfly: Don't run pki::get_cert in ensure=absent case

c19a5cb8cc-+-Bump refine refinery-job version to 0.1.15

d4d9dbd33d-+-site: re-add mw1422 to regex for appservers

be4419c236-+-site/conftool: turn mw1423,mw1424,mw1425 into API appservers

a5edf63ff0-+-librenms: Drop absented crons

50bdd0e04f-+-dragonfly::dfdaemon: Fix HTTPS_PROXY URI to actually use HTTPS

ba57066ac8-+-profile::osm_master: add tilerator users for kubepod subnets

36001af734-+-dragonfly::dfdaemon: Write certificate to /etc/dragonfly

c6c0350f80-+-kubernetes::*::worker: include dragonfly dfdaemon

813e9af57f-+-dragonfly::dfdaemon: Make profile and module ensureable

d77457a0f3-+-role::common::mediawiki::canary_appserver add new canary app server in eqiad

5484f4b6c4-+-mediabackup: Remove deleted directories and files

35ddd34fb7-+-Don't show Kerberos ticket info in general

a2a3dbbe7a-+-cloud nfs: cleaning up the non-drbd setup

48f3ddce59-+-mariabackup: Fix config dir variable interpolation on module

8d6c2ebcaa-+-mediabackup: Update the method of detecting minio server processes

799e32b5e4-+-mediabackup: Update check name to not have spaces

8ae2a90f6a-+-mediabackup: Add monitoring to the minio storage server process

55613c5572-+-Install generic systemd-logind logout.d script

519e17fb93-+-mediabackup: Update config dir behaviour, add root passwords

8e0901f567-+-Tune Refine jobs in production hadoop

3e5e9e7a18-+-Deploy systemd-login logout.d script fleet-wide

57f138a4e6-+-Remove deprecated eventgate validation erroro throughput alerts

0b657b9bcb-+-site/conftool: remove mw1281 through mw1283

8833dd8b5b-+-swift: split wmf rewrite into python3

581f829935-+-swift: use python3 packages as needed

bedb9828a7-+-Remove statsite from swift/thanos, replaced by statsd-exporter

e1d81ab724-+-Bump Refine spark_executor_memory to 8G

cbc69bee79-+-site/conftool: turn mw1422 into an mw appserver

9767441cf6-+-mediabackup: Assign correct default group to minio-user

6f2b387ead-+-Revert "Revert "mediabackup: Install minio on the storage hosts and open port 9000""

af059367a0-+-profile::wmcs::prometheus: Don't pass $site to prometheus::class_config

77df0c85ac-+-Ensure camus eventlogging job is absent

dbcc6c4f06-+-Finalize eventlogging_legacy gobblin job migration

6c8b403e8e-+-Add grafana-cloud.w.o as alias of grafana-labs

5dae6f5859-+-Revert "mediabackup: Install minio on the storage hosts and open port 9000"

5570b1ca25-+-mediabackup: Install minio on the storage hosts and open port 9000

8a426f8685-+-librenms: Migrate crons to systemd timers

4a7a10af47-+-Add gobbln job eventlogging_legacy

03ff7a77a4-+-maps: fix osm sync directory path

e0004ccb1d-+-R:prometheus::resource_config: reintroduce site parameter

23464c5cb2-+-httpbb: add tests for noc.wikimedia.org

b4a04bfed9-+-mediawiki::maintenance: open ferm hole for deployment servers to port 80

65951ffb57-+-Revert "P:thanos::query: drop site parameter from prometheus::resource_config"

bcdd5fea87-+-P:thanos::query: drop site parameter from prometheus::resource_config

c52445eddb-+-logoutd: add support for Python 3.5

44dd4271ff-+-paws: add a very simple backup server

decc972cfa-+-kubeadm: Upgrade Calico to v3.18.4

d3b3371a61-+-Refine event - fix input_path_regex_capture_groups param

a35feb23cd-+-Finalze gobblin event migration

8663f3e0be-+-Add k8s iBGP neighbor config to the ML k8s master nodes

9530f1753b-+-Remove remaining references for ldap-replica1001/1002/2003/2004

506e76a214-+-P:prometheus::ops: manage target_path

cc158431b0-+-P:prometheus::ops: drop the site parameter

0e121806d7-+-R:prometheus::cluster_config: Drop ERB file

d2579d7246-+-Add gobblin job event_default

4c577cf503-+-prometheus: don't deploy alerts to 'global' instance by default

fa4fc1d707-+-role::ml_k8s::master: add docker profiles

4329e4d5ef-+-ml_k8s::master: add profile::kubernetes::node

6d8058c3be-+-db1183: Assign role, configure hiera values.

75e38d246e-+-site/install_server: Add dragonfly-supernode1001 to DHCP and site.pp

f0bff4a50e-+-varnish: Add listen on UDS support

6acca46f53-+-dragonfly: Remove fetching of $docker_registry_fqdn cert

35217f0285-+-dumps: Migrate kiwix update cron to systemd timer

6f6f3a338d-+-Remove already absented camus jobs

c4c6698aa8-+-test/data_purge - fix checksum on refinery-drop-raw-event

aa0b4d6bb5-+-Gobblinize test refine_event and drop_event jobs

84a2b3c1b7-+-Fix for refine eventlogging_legacy_test

ea92ae7742-+-Fix checksum for refinery-drop-eventlogging-legacy-raw-partitions

0e6a05e62b-+-Gobblinize eventlogging_legacy_test Refine and data purge jobs

d16f52e97f-+-Add gobblin job in hadoop test event_default_test

383d269136-+-Add gobblin job in hadoop test eventlogging_legacy_test

6c16b0b44d-+-Run gobblin netflow at 5 and 35 after the hour

589d06b84d-+-Use hive/gobblin date path format for netflow data purge job

853d495f3a-+-Gobblinize netflow Hadoop ingestion

5bdf2a2167-+-P:prometheus::ops: Add scrap configuration for PKI servers

f868373c16-+-Add mx1002/mx2002 to Puppet

3874d97fbf-+-mediawiki::nutcracker::yaml_defs: fix data structure

43572df273-+-Update webrequest raw data purge job with new partition path format for gobblin

afa04ff3b8-+-Ensure absent webrequest camus jobs

e1fc564ff3-+-P:pki::multirootca: Add ACL so prometheus nodes can scrap data

a279fde53b-+-cfss;::cert: add ability to ignore legacy CN certificates

6c2bbf1b9e-+-Fix comment in job/gobblin.pp

ebcc75c379-+-Declare analytics webrequest and netflow gobblin jobs

1d562249e2-+-Remove camus webrequest job in analytics test cluster

17fc00e6b1-+-P:idp: move tomecat specific config to profile

38dd8be094-+-O:apereo_cas: move WMF specific code to profile::idp

132babd05a-+-gobblin_job - set PYTHONPATH in environment

ae66d3a1c4-+-gobblin_job - fix typo in path to default jobconfig file

11d2c6cc82-+-Add gobblin_job define and declare first gobblin job in hadoop test cluster

a1ed1e14b6-+-mariadb: Move db1124 to m2.

276c03856a-+-Add separate role for Ganeti test cluster

1431f31ae1-+-dumps: Drop absented cron

518b8a797b-+-mariadb: Move db1125 to m1

b376659b4e-+-puppetdb::app: Use seperate user for the read databse

53df76404e-+-dbstore1004: Rename to db1183, prep for m5.

77066b5f0f-+-dragonfly: Add dragonfly supernode and client (dfdaemon) modules

eca0025cd9-+-Revert "Add 4 new docker-regisry nodes in codfw"

658fb45b6f-+-profile::maps::postgresql_common: allow connections from kubepods

d103dd6a34-+-kubernetes: use k8s::base_dir everywhere it's appropriate

cb91b2e20d-+-kubernetes: centralize the creation of /etc/kubernetes

ac56789df3-+-network::constants: add kubepods network constant

19e8013d36-+-ceph.keyring: make sure the bootstrap dir exists

33850c942a-+-Revert "ceph.keyring: ensure that the bootstrap dir exists"

54e76d76b9-+-ceph.keyring: ensure that the bootstrap dir exists

4850fd7774-+-site: add eight appsevers in eqiad row A3

56c9b2cd85-+-site/install/conftool: decom mw1267, mw1268

bf2fbc1b60-+-cirrus: systemd timer for readahead script

ba156c842a-+-Revert 1c99db9965361cdf95f042bb2401e86733a31393

35bb79062c-+-cirrus: fix broken module path

35349877f1-+-cirrus: systemd timer for readahead script

1c99db9965-+-cirrus: systemd timer for readahead script

c5b1765ef6-+-profile::toolforge::disable_tool: standardize on the singular 'disable_tool'

d93f748fc1-+-toolforge: add a profile for installing the disable_tool script

1b0b08fb6a-+-cloud nfs: commit solidly to the drbd setup step 1

5bcdbd193e-+-Remove old RPKI Grafana alerts

c6c94742cd-+-Switch ncredir to profile::nginx

92987390d5-+-wmcs.ceph: Add the new 17, 19 and 20 OSDs

67c3c6d167-+-site/conftool/DHCP: remove old eqiad appservers in A5, mostly canaries

4ff87e54de-+-Require python3-pandas for performance asoranking

a0c5e087f8-+-toolforge: bastion: fix typo

560ee252bf-+-toolforge: install jobs-framework-cli

3624390f74-+-ceph.keyring: Add requirement for the ceph-common package

98c23cef7f-+-Cleanup old mediainfo dumps

308a26eeb4-+-eventlogging: remove mariadb profile and create log dir

6211956d88-+-jupyter: simplify the cron script to clean up user Trash

7df2db2451-+-mediawiki: Run purgeParserCache.php in parallel for each shard

dd0e2c71aa-+-paws::haproxy: Allow specifying the port for ingress nodes

d7eb678616-+-wmcs.ceph: Add cloudcephosd1016 to the ceph osd role

2cbdc7d206-+-gitlab: add parameter for active_host, limit backups to it

253315dd84-+-P:pki::multirootca: enable default_usages feature

c7d099c22f-+-P:multirrootca: Add ability for intermediates to define the default usage

160fcaf268-+-swift: set group 'swift' when filesystems are unmounted

ea76605eee-+-varnish: add counters for Varnish SLI

bbaed48cd5-+-statistics: Drop rsync_job

f486207c2d-+-camus events - change which DC topic is used for Hadoop ingestion alerts

bcea292ea9-+-cloudcephosd1016 insetup role

51a7c6b744-+-postgresql: use correct unless priv for function check

ba91d3a0a4-+-postgresql::db_grants: quotes matter :S

ca8d8e39be-+-puppetdb::db_grant: fix sql unsless statments

315f587139-+-postgresql::db_grant: use correct privlage

cabb5b99f6-+-postgreslq::db_grants: correct order of sql statment

2461742afc-+-postgress::user: Add new grant resource

d28863c0b0-+-toolforge: haproxy: more jobs_api cleanup

5a7133c823-+-toolforge: enable jobs-api

54ef2b3e84-+-toolforge: k8s: drop ingress configuration for jobs-api

0d0a12b83e-+-toolforge.exec_environ: use libnode-dev on buster

9132cc733f-+-toolforge: Add buster specific packages/setting

76dc0f92ee-+-toolforge.genpp: add buster repos

4a2627b8e9-+-role::docker_registry_ha::registry: Switch to profile::nginx

c4f1539edd-+-Revert "dbbackups: Temporarily change backup schedules to fit better dc switch"

64367380dd-+-[wdqs] switch updater reporting topic to codfw

83e0b5bd3b-+-P:puppetdb::database: add $role variable back as $db_role

4c8781eaaa-+-P:puppetdb::database: merge puppetmaster::puppetdb::database into this profile

0252da1abd-+-C:puppetmaster::puppetdb::database: move local account to hiera

3b6dcae74c-+-profiles::docker::builder use after in production-images-weekly-rebuild job

0f6f073077-+-systemd::timer::job: add parameter to define denendency using after

7a8d9da0df-+-dbbackups: Temporarily change backup schedules to fit better dc switch

d43a53dc8d-+-mirrors: Switch to profile::nginx

80b59bf88e-+-docker_registry_ha: Enable local nginx cache by default

b8a0ee0865-+-wdqs: Switch to profile::nginx

dc5f426e02-+-Fix "Duplicate declaration: Systemd::Syslog[wikistats]" part 3

0347ae4451-+-cinderutils.ensure: don't add mountpoint if we exec

288e2763f1-+-dbbackups: Remove s5 (stretch) from backup sources

bd03eccb1d-+-Enable profile::nginx for acmechief

c31b2e4f1b-+-dbbackups: Migrate db1171:s2 to db1139, reimage as buster and set s7&s8

5b572de634-+-Remove obsolete Tor Puppet classes

ef69010bca-+-DHCP and site: add gitlab2001.wikimedia.org

210aa08367-+-P:logoutd: create wrapper script for calling logout.d scripts

53d0694a20-+-Revert "Revert "mediawiki: Port mw-cli-wrapper to Python""

9b0ddd17de-+-Revert "mediawiki: Port mw-cli-wrapper to Python"

1fe86edf62-+-cinderutils.ensure: tweak further the fs usage limit

b7c1ddd3e3-+-site.pp: Specify which wikis are on s6.

b3aedf2b1f-+-profile::wmcs::nfs::primary: more c/p fixes

a284fe7369-+-profile::wmcs::nfs::primary: Fix exchanged ldap pass and dn

6a0cfdb626-+-Add config file for the disable_tool script

fafc34c8f5-+-mediawiki: Port mw-cli-wrapper to Python

dc09321e2e-+-kafka-logging: migrate logstash2003 broker to kafka-logging2003

028d9221c7-+-kafka-logging: migrate logstash2002 broker to kafka-logging2002

73a13774a2-+-kafka-logging: migrate logstash2001 broker to kafka-logging2001

8392c6e043-+-cinderutils.ensure: use 11MB as filesystem space lost

09821a544e-+-cinderutils.ensure: take into account filesystem size

c7419f1233-+-Remove reference to obsolete phabricator libraries.

b357545e90-+-Add logout.d script for the IDP

3be5f457bf-+-postgres::slave: remove problematic auto-replicate

b358fc77c2-+-Remove backup for sretest

af89efa7a2-+-mailman3: Fix logrotate, set retention to 30 days

d0eae549b0-+-mailman: Drop absented files and packages

b241327c32-+-varnish: install mtail programs in a loop

52de7ec6bd-+-varnish: add error counter to Prometheus

d5d4ead744-+-install params for mw14[14-47]

d844adec50-+-mjolnir: Provide prioritized topics to bulk daemon

eddbe1bd37-+-superset: rename analytics_cluster::ui::{dashboards,superset}

59d7c0f1b6-+-reportupdater::job: fix variable name

d0d867e4ef-+-logstash: add and enable ecs revision 4

ae0c7b8eb6-+-DRY profile::analytics::cluster::users

4c53e632ff-+-C:postgresql::server: prefer an empty list to undef

d2f9bb74c4-+-mediawiki: Reduce purgeParserCache.php sleep from 500ms to 200

4bd71fb82a-+-Finalize backend migration of CentralNotice EL schemas

edca4c9ff8-+-nrpe: Pass through the provided contact_group.

b347428013-+-webperf: drop checks that are now in AlertManager

2056fec553-+-dumps: Migrate dumplists cron to systemd timer

01c4f27563-+-dumps: Remove absented crons

9ffc39e6d1-+-postgresql::slave: add optional to the includes parameter

585c51d1f1-+-[wdqs] fix prometheus_jmx_exporter class selection

48bf4ad5ad-+-Setup info for thumbor100[56] an-web1001

9197c04861-+-Add helper tool for returning a user's current TGT

9a9486ec34-+-wmflib: replace extlib with wmflib in code examples

d2152dfbc5-+-bacula/gitlab: add a backup::set for gitlab and use it

e76d8af2de-+-gitlab::backup: create backup paths with wmflib::dir::mkdir_p

c7ae40d83f-+-mariadb: Monitor pt-heartbeat for expected status.

97be63ab34-+-profile::gitlab: ensure backup dirs exist in production

e21e0ade85-+-fix up conversion of adds changes dumps cleanup cron job to systemd timer

d01cff99e7-+-dumps: Migrate xml dumps clean up cron to systemd timer

0c34dcacbd-+-dumps: Migrate miscdumps clean up cron to systemd timer

3523491873-+-mariadb: Promote db1130 to s5 master.

e000cd2c30-+-DHCP, Site.pp: Add ganeti202[56] to site.pp and it's MAC address

a2c8c58516-+-Unify netbox tokens

b21662cd5c-+-node_cloudvirt_libvirt_stats: use ExecStartPre instead of redirection

4007b84f93-+-profile::kubernetes::deployment_server: add istioctl package

201d1e5f06-+-nova: collect VPS data from the hypervisor

81b52e1669-+-C:netbox: code clean up

014895ee5d-+-O:netbox: Always install the ldap and cas_configueration files

bf695f2209-+-osm: create missing imposm directories, add mirror support to import

cbef5526d7-+-systemd::timer::job Adapt docs to new defaults

7734879be9-+-Fix "Duplicate declaration: Systemd::Syslog[wikistats]" part 2

c7b482fa28-+-mediawiki::web::vhost: add wikibase_rewrites boolean

5a640b66ae-+-mariadb: Promote db1157 as s3 primary

2ed9d4d403-+-Cloud-vps puppetmasters: rotate enc logs

c8c6917c5e-+-Toolforge bastions: add a broken shell for disabled tools

a481639fd7-+-mediawiki::web::yaml_defs: brown paper bag fix

4f3bd801b6-+-postgresql::slave: Ensure includes are arrays

0983fad891-+-R:postgres: drop unused postgress roles

aff7b93b28-+-mediawiki::web::yaml_defs: mangle vhosts

4b985acd31-+-bacula: Fix schedule and monitoring as a followup to 67ee5c0

f7ba21c744-+-mediawiki::web::yaml_defs: also monkey-patch templated sites

67ee5c02b6-+-bacula: Add new jobdefaults/schedule for Gitlab, full backups every day

acdee1d8d1-+-archiva: Switch to profile::nginx

83e97140ca-+-redis: Get rid of distro-specific config

6d65ce3e45-+-backup: Exclude /var/lib/mailman3/queue

f532c0e83a-+-decom lists1002/lists-next

91db3c6b09-+-metricsinfra: Reorganize things

3d0cf7573d-+-prometheus: node_cloudvirt_ceph_network: sort node list

a54f0542ce-+-openstack: prometheus-cloudvirt-ceph-network: account for all ceph nodes

82c112aeeb-+-varnish: install mtail program varnishprocessing.mtail

098f747d9b-+-C:postgress: Add support for bullseye

e301cd872e-+-C:postgresql::server: Add support for bullseye

22f7e78291-+-C:uwsgi: Add support for bullseye

6fe9831ed6-+-P:puppetdb::database: Add support for bullseye

187fd67bac-+-C:puppetmaster: drop unneeded python dependencies.

b802b31fa5-+-cassandra: drop support for 2.1 in metrics. Fix collector version

47e7e39b91-+-mediawiki::web::yaml_defs: fix virtualhost port.

e5c1b9f38b-+-mediawiki::web::yaml_defs: fix data structure name

88aec68d8d-+-mariadb: Automatically manage pt-heartbeat.

7f766618d5-+-cfssl::cert: update to the correct amount of seconds

fb6f41afda-+-P:tendril::webserver: Ensure apache is automatically refreshed when certs change

1f07d1c3cb-+-cfssl::cert: renew certificates when there are 11 days left

679f9ea87d-+-pc1010: Move back to pc1, now that the maintenance is done.

65d4ac8a33-+-gitlab: add ability to only listen on port 80

2a07e59fb7-+-nfs prometheus: change to strings for dir sizes

5a95e4f7a8-+-airflow::instance - allow access to API by default

d636123739-+-toolhub: fix php.ini path

46f47a7089-+-toolforge: setup some reasonable php.ini defaults

69e6ed27fc-+-yarn: re-enable queues

9128256bab-+-yarn: temporarily stop queues

06c4bd7b6c-+-Fix prometheus monitoring for Toolforge Ingress

e1edb42635-+-airflow: Add host configuration for an-airflow100{2,3}

31b90d263b-+-analytics cluster - Remove more deb packages that sbould not be needed

6cbdb179ee-+-Finalize backend EP migration of 4 EL schemas

04b94e1a83-+-profile::memcached::instance: Add TLS support

a9b84f7fbb-+-puppetmaster: update the private repo pre-commit hook to check staged

6b10987fb1-+-Add profile::contact to multiple roles/profiles

51ea403ffa-+-Fix "Duplicate declaration: Systemd::Syslog[wikistats]"

3086d4b006-+-Revert "Allow mgmt range to connect to tftp servers."

6f923865da-+-installserver/tftp: install tftp client on tftp servers for debugging

1682f7e1b2-+-httpbb: reduce git pull frequency from minute to hour

912d162a3c-+-toolforge: Remove non-helm ingress-nginx files

09bfce117d-+-site.pp: Add new parsercache hosts as insetup

9e90610cff-+-tools: try to alleviate sudo crashing when triggering oom

7aa0644223-+-nutcracker::yaml_defs: add nutcracker pools for kubernetes

b45b56d1f9-+-labsdb: Remove some labsdb entries

89c213bd90-+-Undeploy mjolnir profile from analytics

5d24397877-+-Allow mgmt range to connect to tftp servers.

e5ec3c5409-+-P:contacts: Add test to ensure role is defined and bail out early if not

085a604f5a-+-P:base: only use P:contacts on production

cf67b3bccc-+-site: switch doh1001 and doh1002 to O:wikidough

6347b30af5-+-profile::docker::builder: add the istio use case to image builders

9d89437078-+-ssretest: Add contacts to sretest

3e2398cf1a-+-profile::contacts: add a profile and define for adding contact metadata

83c6ac06df-+-concat: Add puppetlabs-concat module

fa596ae122-+-Revert "concat: Add puppetlabs-concat module"

a390389a64-+-Revert "profile::contacts: add a profile and define for adding c..."

387cc5d62b-+-Revert "(Test): Example PR demonstrating the contacts profile"

c0f3a3f239-+-(Test): Example PR demonstrating the contacts profile

43e3b12bf5-+-profile::contacts: add a profile and define for adding contact metadata

6a1d821eea-+-concat: Add puppetlabs-concat module

3c08b67ab1-+-P:cumin:monitoring_agentrun: sudo rule cant have sudo in it

37f627d0cb-+-P:cumin::master: Use sudo to run the check command

3e91acc48f-+-Revert "P:cumin::master: Use sudo to run the check command"

f5f0ed3247-+-P:cumin::master: Use sudo to run the check command

0f56db123d-+-Enable apt* hosts for unprivileged Cumin

3f0ea77a46-+-Revert "deployment::rsync:: temp allow dumping files from miscweb1002"

71a1f49c59-+-site: add wikidough eqiad with insetup role

5dab0d2622-+-deployment::rsync:: temp allow dumping files from miscweb1002

be1a19db6d-+-maps: make maps2009 a buster imposm-based master in codfw

53438c78d0-+-cfss::cert: drop refreshonly

7802c8bd78-+-cfssl::cert: Improve check for generating chained file

2b2dbddeca-+-site: switch doh4001 to O:wikidough

37855b1f64-+-O:cluster::managment: move monitoring from puppetdb to cumin host

fadcfe8755-+-apereo_cas: add base_url to type signiture

8a40824ebf-+-mariadb: Disable sustained repl lag alerts for parsercache

50c3b20dbd-+-P:netbox: Add support for cas authentication provider

a7cdc73cad-+-mcrouter::yaml_defs: fix yaml structure

d9f14eafef-+-mcrouter: add mcrouter pools to deployment servers

0de653acdf-+-eventschemas: Switch to nginx profile

82448cd386-+-kubernetes::deployment_server: create a separate mediawiki profile

5fd32a492e-+-site: add doh4001 to role insetup and setup dhcp

653cc028e7-+-realm.pp: Add ldap_domains table to the private list

93dc6bfede-+-pc1010: Move to pc3.

66356d50fc-+-profile:mariadb:core: Hack in access from labwebs to s6

ada685fad0-+-Enable install* hosts for unprivileged Cumin

4aa3344cad-+-Deploy the host keytab directly in the profile::base::cuminunpriv profile

739291a595-+-icinga: update reading web Grafana alerts

741b3e9ed8-+-P:pki::multirootca: use source not content

91278934c9-+-P:pki::multirootca: Add puppet CA to the the pi web site

4fd0060719-+-role::dumps::distribution::server: Switch to profile::nginx

d5c4b70c19-+-P:idp::client::http:site: add support for same site cookie

e3c38e0d02-+-galera: clear up confusing xtrabackup parameter

bbdedd8eb0-+-Fix prometheus monitoring for Toolforge Ingress

ccc0850bbb-+-analytics cluster - Remove more deb packages that sbould not be needed

49f12560d1-+-mariadb::instance - allow passing extra configs from hiera

0f85099e07-+-analytics cluster - Remove bigtop and stretch overrides where not needed

0da8a6f537-+-drop_event job - Use dedicated Hive CLI log file

41fa838d07-+-modules::memcached: add notls support for external addresses

765e2ded4b-+-prometheus::pop add retention size param and set to 80G

24480507e0-+-rsync: Drop absented cron

c03102445d-+-prometheus: Drop absented cron

c05548f543-+-R:systemd::timer::job: use the syslog_identier for the syslog programname

e7c095ccf2-+-P:openldap::management: Ignore errors ffor account consistency check

8fdad56bc7-+-Enable blank node skolemization for wcqs

c84a411f2d-+-htmldumps: Switch to common profile::nginx

b1500d0a72-+-dumps: Drop absented cron

c5757268b3-+-mediawiki::alerts fix panelId for mediawiki exceptions alert

89c70c9220-+-galera: ensure that mariabackup is also installed

64cc973aa4-+-Switch testreduce to profile::nginx

8b7147e5da-+-Enable profile::nginx for parsoid::testing

85fae65110-+-site: switch doh5001 to O:wikidough

c7f691096a-+-P:gitlab: open SSH port to the world

9d2ac9dec4-+-dumps: Migrate rsync of nginxlogs from cron to systemd timer

6837b5328e-+-site: add wikidough eqsin with insetup role

ea6a8fe055-+-Switch installserver::light to profile::nginx

8631b62087-+-ADD new Raritan test PDU

d1552d1de7-+-airflow - Expose admin details by default

e216fde545-+-Set up airflow-analytics on an-launcher1002

ed0637f9a4-+-moss-be100[12] setup info

e976d5d512-+-Add nginx profile to apt_repo

d56ba2d57f-+-site: switch doh3001 and doh3002 to O:wikidough

c9c646ba62-+-ceph.mon: don't subscribe to ceph.conf

96bc9dc256-+-alerts: reload prometheus instances after deploy

23e3974acb-+-site: add wikidough esams with insetup role

cbfd4d5ad3-+-site: remove dbstore1006 from mariadb role

669ff0510b-+-gitlab: add Bacula backup::host class to role

3dc0b1ab4c-+-Remove more python packages from stat boxes

1a0e727a79-+-site.pp: Fix dbstore1007 role

6468e8fafe-+-site: give mariadb role to dbstore1007

913ff572e2-+-site: decommission cescout1001

e3cde2b378-+-P:mail::mx: update systemd timer so that it fails silently

b9818a1ecf-+-P:mail::mx: fix template location

73dde4507c-+-role:mx: add script to generate otrs aliases

969978e481-+-db1125: Rename back from dbstore1006

d8b37e355f-+-O:puppetmaster::puppetdb: add nginx profile to puppetdb

0114935b1d-+-P:nginx: add an nginx profile

adc7939345-+-wmcs.toolschecker: update the tools etcd nodes

5ba2ccf891-+-site: add dbstore1007, reimaged from db1183

12f44ed797-+-mailman: Absent configuration files of mailman2 and make package absent

182760a804-+-airflow - add clean_logs wrapper script

9742e3ba34-+-mailman: Drop mm2 scripts

fe32c7d0c1-+-mailman: Absent mm2 script files and their systemd timers

d7dbe6ccae-+-Disable peek crons

5274e85c67-+-toolforge bastion: do not run wheelofmisfortune on buster yet

d0ad75925f-+-C:puppetmaster::puppetdb: drop filter_id hack

d445073a60-+-Subscribe airflow-webserver to webserver_config.py

86c983b3ab-+-lists: Stop mailman2 service

ea8ef53a1c-+-airflow - webserver host default to localhost, Admin for public role

c2a826ea17-+-grafana: add wrapper to call grr with environment vars set

5bd83da157-+-grafana: fetch operations/grafana-grizzly as /srv/grafana-grizzly

69a931a006-+-lists: Drop enable_mm3 config option

2c17a8a33f-+-airflow test - ensure analytics instance is absent, add analytics-test

0f69ccef76-+-gerrit: switch to Java 11

aeaa222e46-+-Revert "Allow absenting the helmchartctl systemd timer"

fdb81b61dd-+-chartmuseum: Set cache-interval to 60s

46a778d176-+-postgresql::postgis: use latest packages on buster

f9b9a76996-+-Revert "swift: group-writable log directory"

2c7a2232a0-+-Remove obsolete tlsproxy::ocsp and related configs

b351d39685-+-Remove obsolete profile cache:ssl:unified

4d3730ba12-+-gerrit: add Java 11 packages

21f0b4ba64-+-Add logout script for sretest

c749d2a8df-+-reportupdater::jobs: improve permits of logs rsynced to HDFS

25c8437cfd-+-Revert "Revert "Revert "Revert "bacula: Reenable read-write ES database backups, disable read-only""""

d0be2b7b72-+-phab1004 setup params

93e7527dff-+-nfs: fix the scratch mount setup

3df91339f1-+-airflow - use airflow.cfg for webserver port

1b26e625d2-+-Airflow puppetization + airflow@analytics on an-test-coord1001

915272e7f8-+-role.wmcs.virt*: sorted and add extra comments

08752e855b-+-httpbb: Allow tests to be templates

5d5586b63e-+-pc1010: Move to pc2.

1a30bc7624-+-dbbackups: Move s2 from db2098 to db2097, reimage db2098 to buster

874bcebb4d-+-swift: group-writable log directory

b3ed6c1ddd-+-site.pp: add snapshot101[45] to insetup

65ff22e390-+-service::catalog: fix the use of %{::site} in interpolations

eb1814eaca-+-Revert "Revert "Revert "bacula: Reenable read-write ES database backups, disable read-only"""

d64e9f6c11-+-Bump refinery::job::canary_events to 0.1.13

269b69a849-+-Convert cloudvirt1018 to a local-storage hypervisor

b2fbe0a3cc-+-site: update and consolidate Wikidough hosts

a718ce2937-+-P:base: add logoutd profile to base

24ef25932f-+-P:logoutd: create a logout.d profile for managing logout scripts

6232ca9a17-+-wikidough: update role to work towards anycast support

18bae8abc1-+-Bump refinery::job::canary_events to 0.1.12

1327589211-+-osm: fix import issues in imposm-initial-import, run imposm as osmupdater

2615258160-+-ATS: add instance name to traffic_exporter check description

b8a91bfdd1-+-httpbb: Add tests for docker-registry

87e73b108d-+-docker-registry: Add caching config for nginx

aafbb252dd-+-Readd cumin on cumin2001

c39d8a734c-+-Skip Cumin/Homer/Spicerack on cumin2001

623a0db06c-+-docker::baseimages: add proxy support to the systemd timer

0fa6fd33c2-+-dbbackups: Remove s6 stretch backup source instance on eqiad

730731d8c2-+-udev: Bullseye compatibility for udevadm

49aa2c27e8-+-Revert "Revert "prometheus: Migrate node_file_count cron to systemd timer""

ca9a88d6ca-+-docker::baseimages: remove bootstrap-vz, build bullseye

57474fe2f7-+-Revert "mailman2: Generate a 5-year retention Archive backups of mailman"

1b67a4d907-+-reportupdater::job: swap ::path with ::source_path

c8fe981161-+-icinga: switch to LibreNMS AlertManager paging

630a82b19c-+-profile::reportupdater::jobs: move logs to /tmp/reportupdater-logs

37b24471b9-+-profile::reportupdater::jobs: add systemd env variables

3a59c14a40-+-profile::reportupdater::jobs: fix dependency

21d22598bd-+-reportupdater: Rsync logs to HDFS

e4d9f54334-+-package_builder: add logstash-plugins build hooks

eb9ce6f698-+-yarn: set queue state to RUNNING

fe02761c39-+-logstash: bump ecs to 1.7.0-3

63f0649eb2-+-yarn: enable submitting jobs to queue

1fb64f45e6-+-prometheus: Use high retention time when using size

4a163f4d20-+-yarn: temporarily stop allowing jobs to be submitted to yarn

ddee2130b5-+-update puppet defaults and docs to libera.chat

907a00dd52-+-db1124: Move db1124 to the testing section

79b5fc63a0-+-P:pki::multirootca: drop nrpe check for expired certs

564a22d6a5-+-varnish: add .sh suffix to shell scripts

7bbde97692-+-mailman2: Disable temporarily production mailman2 backups

ba9f536e23-+-mailman2: Generate a 5-year retention Archive backups of mailman

e93259bff1-+-P:puppetdb::microsite: only pupulate site content if enabled

4a670d8ad4-+-role: add pontoon::frontend role/profile

cba103eb73-+-P:pupetdb::microsite: only request certs if pki is available

13afbbf941-+-P:pki::get_cert: add calling module to fail message

ac83a5df28-+-wmflib: add role/public_endpoint to wmflib::service

53092ab6f7-+-toolforge: Add separate role for Redis Sentinel

18329748bc-+-Refine VirtualPageView schema using eventlogging_legacy job

5a97b33437-+-Netbox: fix path to new CA

17c6accfe5-+-kafka-main: deploy kafka::main role to kafka-main[12]00[45]

74efb7e41e-+-toolforge: update static proxy config for toolforge.org migration

e69a865c54-+-maps: DB performance improvements

20dd31cdc1-+-C:netbox: update SSL config to work with pki.discovery.wmnet

e551de4f31-+-baseimages: add preferences file, bullseye

62811bf8e1-+-docker::baseimages: add script to build debian-slim

fe69135cb5-+-Revert "Revert "bacula: Reenable read-write ES database backups, disable read-only""

530de192cf-+-mailman3: Optionally enable memcached caching

974f916b71-+-wmcs: Point dologmsg at wm-bot's Libera Chat relay

520fa1329e-+-docker::baseimages: drop alpine support

6e97ff2f7a-+-P:puppetdb:croservice: use server profile for ssl certs

7357de1b15-+-P:puppetdb::microsite: fix config file

3da17c1eae-+-P:puppetdb::microsite: request certificate from pki

c7316f6c28-+-mediabackup: Setup the storage hosts

a3dcc1fde5-+-C:admin: add ability to manage home

7cb37b20da-+-mariadb: Setup 2 new host as temporary metadata database for media backups

c8b8f76fc0-+-mariadb: Fix small typo on comment

daf908582b-+-Add 4 new docker-regisry nodes in codfw

73fd67361d-+-fix up comment for mediainfo dumps configuration file size setting

35b645d56a-+-mediabackup: Initial setup for the media backup worker hosts

e714ae7ce9-+-Allow absenting the helmchartctl systemd timer

2f4d153d62-+-mariadb: Decommission db1087

231367d3bd-+-site: add role for dbstore1006

a287a877d1-+-cloudstore: set syncserver to only be run with puppet disabled

20e8b9d027-+-site: configure dbstore1006 as insetup

b4e7055a00-+-logstash: update ES template to patch 2

eed151f5d3-+-librenms: remove librenms-ircbot service

568bf75dbb-+-librenms: remove librenms-wmf irc config

33a1067e95-+-icinga: move logmsgbot to libera.chat

f7f70af7cf-+-mariadb: Use ROW binlog format for heartbeat on dbinventory.

84eb1c3edb-+-mariadb: Convert pt-heartbeat to a systemd service.

014568c03a-+-site.pp: s3 is no longer default for new wikis.

034b5ee7c6-+-maintain_dbusers.pp: Remove reference to labsdb1011

30d6c0eb49-+-mariadb: Decommission labsdb1011

901667bbf8-+-Revert "bacula: Reenable read-write ES database backups, disable read-only"

3abd1f80b9-+-db1125: decommission db1125

35a9b643f8-+-site: add doh200[12] to site.pp with role insetup

d438702415-+-Revert "kafka - Use hardened_tls instead of java::security

3025e7bc6f-+-kafka - Use hardened_tls instead of java::security if $ssl_enabled

3b47f6e36c-+-chrony: drop chrony

751ba6ef31-+-toolforge: Allow passing host port for k8s ingress

923042b6c7-+-Enable SLO by default

a0502c022a-+-prometheus: fix syntax error

ff3d5a5427-+-toolforge: Add ingress-nginx Helm files

53f97d4dbf-+-rsync: move quickdatacopy to systemd timer

4adc338d65-+-maintain_dbusers.pp: Remove labsdb1010

1085092ef6-+-mariadb: Decommission labsdb1010

9ad25c790e-+-Hadoop - set hardened_tls: true and remove java::securty from hadoop::common

902ec52991-+-logstash: remove logstash-output-statsd plugin

5a5cbdc50e-+-Keystone: provide a hiera flag to adopt new policy enforcement

ab31e30827-+-Remove profile::analytics::cluster::packages::hadoop

31acaacb74-+-db1085: Remove from puppet

5e54565a9f-+-mariadb: Install 10.5 client on host with only client packages

de88370802-+-gitlab: disable grafana, node-exporter, promethous and alertmanager

22027dde89-+-prometheus: exclude netbox_device_statistics from job availability alerting

94654136f8-+-gitlab: manage sysctl files

2902cdf84f-+-Enable SLO for yarn

aba4542bdd-+-Enable SLO for Hue

3c3514d445-+-Enable SLO for Superset

05da5d0060-+-grafana: restore rsync::quickdatacopy between active/standby hosts

901698f30a-+-prometheus: Remove absented crons

8a500dbb69-+-Enable SLO for Turnilo

613ffc71f2-+-mariadb: Decommission db1083

4c45503b3b-+-mariadb: Decommission labsdb1009

7ba805d2fc-+-paws: monitor the frontend certs maintained by acme-chief

40e1fc383e-+-cloud-vps: enable the cert monitor for acme-chief

d898d17197-+-toolforge: re-enable toolforge certificate monitor

bfd671d573-+-cloud nfs: Change primary cluster rate limits dramatically

bdf0978cbc-+-logstash: add logstash101[012] to elk7 cluster as ES backends

e9936821d1-+-dbbackups: remove db2097 s6 section for this codfw backup source

da2597df35-+-openldap/offboard-user.py: Port to Python 3

a643187e34-+-logstash: clean up mtail config

7d62b74586-+-cfssl::cert: Add support for wildcard names

ce455a19ef-+-docker-registry: Remove absented nginx-site resource

2b319683fb-+-docker-registry: Remove monitoring for port 81

17cb22b55a-+-analytic.pp: s/labsdb/clouddb

349ab2240a-+-docker-registry: Clean up old nginx http endpoint

2aead4f56b-+-Revert "openldap/offboard-user.py: Port to Python 3"

bf56806842-+-prometheus: Remove absented crons

f3d7af194a-+-mariadb: Decommission db1079

5a6f067ae2-+-mariadb: Promote db1173 to s6 eqiad master.

64b76c342c-+-cloud-vps: don't install ldapsupportlib on Bullseye

c5df3bd73d-+-ldap::client::utils: Exclude python2 libraries from Bullseye

96faa90d2e-+-cloud-vps: Don't install Diamond on Bullseye

0a3058c717-+-Openstack VM client packages: don't install python-netaddr on Bullseye

0a7d86ed3f-+-cloud-vps openstack packages: don't install python2 packages on bullseye

4f49f94e5f-+-cloud-vps VMs: use ssd for Bullseye

dbf7c368a4-+-Add an OpenStack package class for Bullseye VMs

8432f90ceb-+-bacula: Reenable read-write ES database backups, disable read-only

6132ede938-+-cloud nfs: fix the netmask for swapping cables

73f9fc2ee4-+-peopleweb: put a public_html into /etc/skel to ensure all users get one

2634411224-+-microsites::peopleweb: add more comments

fb43b2a8e0-+-site: remove people1002 and people2001, update comments

a5f0e4cf84-+-O:gitlab: add external url

e5e5c6b35a-+-P:gitlab: add basic gitlab class

e834c218e2-+-C:gitlab::ssh: add new gilab::ssh class

20d85fc5d3-+-cloudstore: fix the sync path for the secondary cluster

5e8b6eb974-+-Trove: fix up hacks for dns integration

0e70dd71a0-+-OpenStack Trove: enable dns integration for DB access

021d0edee3-+-Trove: hack in fixes to the dns integration

38447cbc8f-+-homer: disable diff checker on cumin2001

cc0d02fb31-+-logstash: update ingest errors to use dead letters gauge

49ec3242a7-+-Trove: remove train and ussuri manifests

acac922497-+-logstash: clean up deprecated curator entries

4f8c03ac2f-+-logstash: remove elasticsearch from role::logstash

4d544cc3db-+-Revert "logstash: remove kibana and elasticsearch from role::logstash"

1b8937c601-+-logstash: remove kibana and elasticsearch from role::logstash

6053dbf36a-+-P:idp::client::httpd: move simple sites to opt into SLO

2fc38f9a3d-+-P:idp::client::http: rename ssout to slo

7f27359332-+-(WIP) systemd::resolved: start work on puppet module for systemd-resolved

145e82a241-+-dbbackups: Disable temporarily rw-backups, enable ro-backups

508be5d8c5-+-profile::hadoop::master: add alert to bump the heap size when needed

cbd3f2fcdd-+-cloud drbd: change default for this cluster to eno3

b56278cbb8-+-data_purge - Refactor drop-el-unsanitized-events in to drop_event job

533c72ea86-+-analytics:refinery:job:data_purge: improve drop-el-unsanitized-events

7278f59e0a-+-site: add peoplweb role to people2002

398c619eae-+-mail: move default mail relay config out of standard module

7a4e76641f-+-logstash: collect kaios_app.error stream into logstash clienterror input

3232726c2d-+-Revert "logstash: collect kaios_app.error stream into logstash clienterror input"

6411f97f84-+-logstash: collect kaios_app.error stream into logstash clienterror input

eb67e5cc31-+-docker_registry_ha: Rename style.css to registry-homepage-builder.css

1261340f44-+-cloudnet2003-dev: decomission

0a4364b153-+-openldap: Convert the weekday cross-validate-accounts from cron to systemd.

7411884f18-+-refine - finalize WikidataCompletionSearchClicks migration to event platform

df984a5fba-+-refine - Remove absented refine_mediawiki_job

04f2ac49c6-+-refine - Ensure mediawiki_job refine is absent

ef67b411c9-+-prometheus: Migrate node_varnishd_mmap_count cron to systemd timer

3a5b225eb0-+-openstack: neutron: more cloudgw cleanups

6c53a969f3-+-prometheus: Migrate node_sge cron to systemd timer

7dca101197-+-cloud: replace cloudnet2003-dev with cloudnet2004-dev

228e8a5957-+-tendril: Remove support for jessie

6af056accf-+-poolcounter::client::python: Remove now obsolete check

be29ebd4b1-+-Remove/update more obsolete comments related to jessie

3cd5ac4a0d-+-Update a few comments related to jessie

ab09878624-+-site.pp: Remove labsdb comments

22fbaa4518-+-debian: Remove support for jessie

e293a9dc7f-+-Remove remaining debian::codename tests for jessie

e02eb9339d-+-mariadb: Decommission db1074

a78e2dc446-+-base: Remove support for jessie

0581eb7dc4-+-aptrepo: Remove support for jessie

dbf076d23b-+-apt: Remove support for jessie

80a80b304a-+-standard_packages: Remove support for jessie

84e58b94e9-+-motd: Remove support for jessie

b238402167-+-mariadb: Move db2108 from s2 to s7.

0a9c15a2c0-+-OpenStack Trove: add quay.io credentials for client docker access

704dd0e7ef-+-site: add people2002 with insetup role

d61bfba709-+-kubeadm: Add support for API server SANs

49417b6036-+-Trove: allow labs instances to talk to rabbitmq

17cda4a1c7-+-httpbb: fix path to test suite for peopleweb

4b315b19bb-+-Trove: set up haproxy for trove-api in eqiad1

f2fd774ba6-+-Trove api-paste.ini: remove trailing space

3c55c82e75-+-Trove: puppetize api-paste.ini

14f98747ba-+-peopleweb: fix logic for changing MOTD based on rsync source

142d0686bb-+-Deploy OpenStack Trove in eqiad1

ed9c242581-+-peopleweb: set a different MOTD if not on the active backend

bb6a22d326-+-bacula: Fix job defaults for read-write Es database backups (2)

c98c30c73f-+-bacula: Fix new job defaults for read-write Es database backups

ef3f2b602e-+-P:tendril::webserver: update dbtree to use new pki for tls certs

597fc4295b-+-remove all references to mwlog1001

f94c2cddd9-+-wikireplicas: remove the old wikireplicas profile from the proxy

1fa7369675-+-pontoon: introduce public_certs

1c8a918117-+-pontoon: add public LB class

031f5bd950-+-remove all references to mwlog2001

01646918fd-+-profile: don't hardcode LDAP group/base names in icinga/am

99fbf1b714-+-O:sslcert: fix comments

a339589e3f-+-package_builder: Remove support for jessie

acb3ca38a4-+-logstash101[012]: prep for reimaging

849e9ddfc7-+-hiera: enable SSOut for peopleweb and puppetboard

d1aa0090df-+-P:idp::client::httpd: add support for CASSSOEnabled

672fb22923-+-P:trafficserver::backend: Use a new trusted CA file

303da28ea0-+-prometheus: Migrate node_ssh_open_sessions cron to systemd timer

63cd111d2d-+-P:pki: function: always return chained path

5bf4943faf-+-P:pki: make provide bundle the default

a61a1da041-+-cloudgw: don't use concatenation with CIDR

d028a01315-+-kube-apiserver: Update admission controller config

5bebf80456-+-prometheus: Migrate cron in node_amd_rocm to systemd timer

2f91716b60-+-prometheus: Remove absented crons

6684fdca3f-+-prometheus: Clean up absent file resource

401d70b5cc-+-mariadb: Decommission db1082

f861f51f11-+-icinga::ircbot: Send Wikidata notifications to #wikidata-feed

599f8fb958-+-mailman3: Install flufl.bounce from our component too

2483ebf3fa-+-openldap: Only run cross-validate-accounts on weekdays.

e04ece9ab3-+-cloudgw: cleanup unused all_phy_nics parameter

0f69574a3c-+-cloudgw: factorize NAT template file into base profile

77857f745f-+-openstack: cleanup neutron hacks

489a271e1c-+-dbbackups: Split dbbackups::content into 2 roles, client and storage

404e7b503a-+-wikidough: lookup domain and IP from hiera

82a008e531-+-wikidough: use check_https_url_custom_ip for DoH check

44acfcbb96-+-prometheus: bump PDU SNMP scrape timeout

d6acb74df6-+-scholarships: update default value to mwlog1002

15a49935dc-+-Manage different templates per Java release branch

4811fa908e-+-mariadb: Clarify that innodb_change_buffering is none

24e0715e84-+-Remove Puppet refencences to old Buster failoid hosts

d95a579b3f-+-Apply LDAP replica role to ldap-replica1003/1004/2006

1d94e17fec-+-lists: Update monitoring

3093a9198e-+-mailman3: Monitor runners

1a0ec7a82e-+-mailman3: Script to generate pipermail redirects

c1ce0054fc-+-lists: Add Apache configuration for pipermail redirects

0f903de34a-+-toolforge kubernetes: change class for the new cinder environment

c1efa9c60f-+-P::toolforge::k8s::haproxy: Add keepalived

fa37c3bc6f-+-P:wikidough: Add TCP connect check for DoH and DoT

07d9828a27-+-Unconditionally install spicerack from "main"

e1f0aaab59-+-wmcs.prometheus: increase retention to 500GB on cloudmetrics

5a1ca7296a-+-site: update comment on mwdebug servers, remove mwdebug1003

a8715a2e60-+-prometheus: Migrate node_puppet_agent cron to systemd timer

75a9790107-+-Revert "prometheus: Migrate node_file_count cron to systemd timer"

ca5826596a-+-prometheus: Migrate node_file_count cron to systemd timer

4d5ed6ffb5-+-prometheus: Migrate node_gdnsd cron to systemd timer

7296231302-+-parsercachepurging.pp: Reduce parsercache retention to 21 days

a8e322e876-+-cloudgw: introduce icinga checks

219711f744-+-python_deploy::venv: fix typo in path

e447b334b0-+-Add python_deploy::venv class

f02cf1890f-+-Revert "package_builder: add python3-yaml"

41f3232997-+-Add cumin2002 as cumin master and allow for tcpircbot and ganeti/rapi

47686f310e-+-Don't install python-etcd starting with bullseye

97638dbb53-+-bigtop::hadoop::nodemanager: use the correct systemd setting

b9cf7bd8b3-+-bigtop::hadoop::nodemanager: use double quotes for override content

94b1bbddba-+-bigtop::hadoop::nodemanager: apply systemd override to service

0f551060de-+-conftool::client: Remove python-socks

4047fed4ad-+-P:pki::client: explicitly include P:pki::clinet

660e80a044-+-hadoop: force Yarn to use DominantResourceCalculator

babc13e109-+-openldap: Remove python-ldap

a9fc5ed458-+-P:pki::client: ensure profile is ensureable

fff8874138-+-Remove references to eventlog1002

302ffe802e-+-openldap/offboard-user.py: Port to Python 3

bfa1b690fb-+-remove last traces of snapshot1005,6,7 from puppet manifests

58c81c4140-+-dbbackups: remove db2098 s3 section for this codfw backup source

553b8a8da2-+-Add ldap-replica2005 as new replica with Bullseye

a357b5c757-+-trafficserver: Fix cacert_(dirpath|filename) usage

6258fc61cc-+-turn snapshot1005,6,7 into spares

f5f952f38f-+-deploy logster_alarm to mwlog1002

059632e9ff-+-P:tlsproxy::envoy: use chained path wit cfssl

4794d46080-+-P:pki::client: fix chain an chained certificates

31496b57b9-+-point wikimania scholarships to mwlog1002

4f02772baa-+-Revert "P:pki::client: fix chain an chained certificates"

cfd1795328-+-P:pki::client: fix chain an chained certificates

4f4222e1b2-+-Add IRC alerting for two relevant NEL subtypes

87f7cd6d31-+-thumbor: add a timer that writes the output of fc-list to a file

352ffdacce-+-httpbb: fix path to tests for people.wm.org

50ee3db6e2-+-httpbb: add tests and test_suite for people.wm.org

b5c0ce66c2-+-O:icinga: add monitogin for debmonitor.wikimedia.org vip

d7b8670be6-+-package_builder: add python3-yaml

f472eef0db-+-icinga: remove icinga[12]001 site.pp entries

09a687adee-+-P::toolforge::mailrelay: support multiple domains

98c84b85b9-+-O:debmonitor::server: request cert using cfssl

a801cc0d53-+-O:apereo_cas: add toggle to enfore MFA logins

b3664c94d1-+-P:pki::multirootca: Add timer to clean expired certificates

ba54bdbe5a-+-homer: Only use scap up to Buster, deployment will switch to a cookbook

587158c5c4-+-openstack: wmcs-dns-floating-ip-updater: fix file permission

d0ea26cb4c-+-profile::dbbackups::transfer: Also set internal/description for standby hosts

c2063f10da-+-Also select wmf-mariadb104-client for bullseye

475bae176b-+-wmf_root_client: Also allow cumin2002

62c2d96fd7-+-cumin: Add support for bullseye

fc3c805171-+-Make cumin2002 a Cumin host

b32fa14e76-+-site.pp: Remove comments from db1154,db1155

cb1147d3b9-+-Install python3-troveclient on VMs

e252651780-+-cloud-vps: install python3-troveclient on Stretch VMs

a7be77c438-+-Puppetize cp501[3456]

c22dd0d1cf-+-swap: remove references to profile::swap

12e0c1f874-+-profile: restore rsyslog-udp-localhost inputs on legacy logstash cluster

04746beaf3-+-ceph alerts: fix hardcoded use of a single prometheus server

30c0a6b735-+-P:pki::multirootca: create a bool to control where cron jobs run

c98e6ef1d2-+-P:pki::multirootca: add dependency when creating ocsp

f2c1954924-+-dbbackups: Add s3 to db1102 and s2 to db2101

476681058d-+-kubernetes::global_config: add ipv6 for kafka

d6a9070263-+-puppet_compiler: Remove etcd and conftool::client

869a5c5116-+-Remove unused profile::etcd and related classes

6285df9bbc-+-Rename role configcluster_stretch to configcluster

166fe69d65-+-mariadb: Productionize db1178

e9376b0843-+-realm.pp: Add discussiontools_subscription to private tables

b3c49f5faa-+-maintain_dbusers: add new multi-instance analytics dedicated host

feaf22b32d-+-refine - Remove webproxy for eventlogging_analytics job

4bf1788f1b-+-P:gitlab: Deploy acme chief certificate

647565dfe8-+-analytics:refinery:job:test:data_purge: remove -skipTrash from drop_event

bcfae215ce-+-P:gitlab: install gitlab-ce

a713656f18-+-Remove SWAP / virtualenv based jupyterhub

8f8625bfcf-+-backups: Fix typo on fileset name, resulting on no backups scheduled

72f32cca49-+-P:pki::multirootca: drop ca bundle file as its not used

69bb012a3c-+-P:pki::multirootca: use hardcoded sources for pki certs

3dc16729f2-+-Change owner of /srv/patches to mwdeploy (from root)

25c82d6076-+-Horizon: install trove policy file for trove-dashboard

ae30ed8eb9-+-Trove: add policy.yaml override

3b1c6beece-+-rsync::quickdatacopy: ensure a destination host gets an rsync client

b30fd09b2e-+-cloudstore: enable drbd on cloudstore1008

bd958cedde-+-peopleweb: ensure rsync is installed

325e3a2d87-+-Finalize TranslationRecommendation refine migration

851f14c4b3-+-Revert "docker: Build bullseye base image"

a47b43b4fc-+-docker: Build bullseye base image

debbf983cb-+-docker: Just have one keyring

4c0fb562ed-+-Revert "test/refine - use local schema repositories instead of schema service"

e754aa5073-+-test/refine require ::eventschemas

a85096cd94-+-test/refine - use local schema repositories instead of schema service

4c0c6472d9-+-OpenStack Nova: Remove some settings from nova.conf on compute nodes

a3739a2dcc-+-P::tlsproxy::envoy: go back to using the cert

a6f91ee483-+-P:pki::client: move ca-certificates managment to profile

f0d37ce29c-+-cfssl::cert: dont purge outdir

bf4db5ef82-+-P:tlsproxy::envoy: also use the chained file for the global cert

774657f061-+-P:tlsproxy::envoy: when using cfssl use the chained file

7b493ee993-+-Remove absented druid data drop job from test cluster

1676081ea9-+-cfssl::cert: also created a chained file with the full certificate chain

0408e62489-+-O:rsync::server: refactor

0e86ac9de4-+-P:tlsproxy::envoy: ensure we notify tlsproxy when the cert changes

f31f98e0f0-+-P:tlsproxt::envoy: Specify specific outdir

1de520e06c-+-P:tlsproxy::envoy: Ensure cfssl cert is owned by envoy

f835a506be-+-mariadb: Decommission db1080

feee154054-+-mailman3: Fork and improve upstream templates

6038fcf3c8-+-mailman3: Improve migration script

b8bbd2844f-+-mailman3: Puppetize Amir's migration script

3c0856f39a-+-Revert "Revert "site: add peopleweb role to people1003""

779692fa05-+-cloudstore: Collapse drbd vs symlinks into one profile

83cb82cccc-+-toolschecker: update the etcd cluster

4ea11e57e9-+-Remove refinery-drop-webrequest-sampled-druid job from test cluster

5c3f54c3d2-+-wdqs: shift 1 codfw internal host to codfw public

eede45c7b2-+-P:pki::root_ca: enable backups

811c516ba5-+-Add comment in refine about  mediawiki_page_properties_change

714768e6cf-+-Enable event_sanitized_main_immediate job

9ed2d62831-+-cfssl::cert: ensure the CN is also in the Alt name

04927b8c6e-+-P:base: add ability to manage services file

4bc039d84c-+-P:debmonitor::client: dont specify an explicit CA

4188ac2ae5-+-zookeeper: Remove jessie support

9d42703c0a-+-profile::java: Remove jessie, add bullseye

ad21d0daa0-+-make snapshot1011 the new wikidata dumper and snapshot1012 the new enwiki dumper

a79da2770e-+-Revert "O:debmonitor::server: request cert using cfssl"

eb7c3d86df-+-O:debmonitor::server: request cert using cfssl

ef96e6f8b5-+-P:base::certificates: Add pki certs to default trust store

8181f74efa-+-netbase: add new module to manage /etc/services

b22a352c2e-+-configcluster: Enable etcd v2 backups

49d94ed087-+-kubernetes::deployment_server: also add kafka broker, pass CIDRs

382f88a6a8-+-bacula: Revert TLS 1.0 downgrade on storage servers (including director)

42efd1a058-+-updating cp501[3456] role

ecd116829c-+-lists: Backup /var/lib/mailman3

093d6079dc-+-cp501[3-6] base install params

f258d1e083-+-P:debmonitor::client: Add provide chain to certificate request

dda6bf8a7a-+-P:pki::get_cert: Support multiple certs with different profiles

bc0d2bbcb9-+-site: eventlog1003 role to eventlogging, allow access to kafka

8ee125e651-+-P:debmonitor::server: fix parameter order

863e7ad17f-+-canary_events and refine_sanitize - use refinery 0.1.9

8d4318cffd-+-Update refine_sanitize job to use event_sanitized_analytics_allowlist

77a02b552c-+-P::debmonitor::server: pass hosts instead of names

e42c662de8-+-Remove references to conf200[1-3] after decom

5a8baeddda-+-package_builder: Added python3-pytest-runner

34589902be-+-nftables: restart command should be reload

e390b518f5-+-P:debmonitor::server: add support for CFSSL

bd9e1b07c2-+-Revert "Revert "sqoop: switch to single grouped_wikis.csv""

08a1e498fc-+-P:tlsproxy::envoy: Add support for cfssl ssl provider

023e76b595-+-test/data_purge - add drop_event job

76a064ba08-+-P:tlsproxy::envoy: refactor ssl configuertion

63a1a009d3-+-bring up snapshot1001,12,13 as dumps testbed hosts

63a655d37a-+-swift: bump thresholds for swift originals uploads

9eb7d6a3fa-+-ldap replicas: Only include the OpenLDAP exporter up to buster

159a46a31d-+-configcluster: No longer include zookeeper in old configcluster role

cb9a5ef596-+-mailman3: Explicitly install python3-mailman-hyperkitty

f3b6e2d1b9-+-mariadb: Allow lists1001.wikimedia.org to talk to m5

257b2e7f8c-+-mariadb: Promote db1163 to s1 master

17bcdebcd5-+-Revert "site: add peopleweb role to people1003"

43a594fa75-+-site.pp: Setup rdb1011, rdb1012

fcd7308663-+-site.pp: Decomission rdb200[3456].codfw.wmnet

1af742441e-+-nftables: indicate that service has restart

285c29e5de-+-nftables: basefirewall: introduce prometheus facility

17a34bbb42-+-nftables: basefirewall: nftables doesn't like strings with single quotes

995dc49bc3-+-R:pbuilder_base: add extra packages to updates as well

67e6edfc7c-+-nftables: basefirewall: reverse quotation

464c1006bd-+-k8s::deployment_server: add ip addresses to discovery data

d2d5858b5d-+-cloudgw: add newline at the end of file

19ce76f437-+-Have rdb2010 replicate from rdb2009

1e0dc783ab-+-site.pp: make rdb2007, rdb2008 a redis cluster

3b069e2b36-+-zuul-gearman.py: Port to Python 3

f4c7471911-+-nftables: basefirewall: drop double-quote scaping

6be13cc3d1-+-Swap zookeeper from conf2003 to conf2006

bc9e1bb62e-+-nftables: basefirewall: play with the order of the last counter rule

fc0d4a225c-+-site.pp: Setup rdb2009, rdb2010

76e0b0c4c7-+-debian: Fix typo in NaN error message

3601c9953a-+-Remove site.pp scb entries

1cacbd42f9-+-Swap zookeeper from conf2002 to conf2005

554e78d40b-+-site.pp: Fix db1167 role

9b152b4401-+-mariadb: Productionize db1167

e74995a8fb-+-site.pp: assign puppet role for rdb2007,rdb2008

088be00816-+-mariadb: Decommission db1077

cf6a2eb20a-+-mailman3: Use backported packages from component/mailman3

d470c11d1a-+-Revert "sqoop: switch to single grouped_wikis.csv"

48ffe5b3a8-+-sqoop: switch to single grouped_wikis.csv

64cf08f680-+-radosgw: enable => true to the service resource

684a8f002c-+-site: add peopleweb role to people1003

85d30274c8-+-snapshot10[1-5] setup info

21ddb05e31-+-site/DHCP: add people1003 with bullseye

d59128e13d-+-lists: Move renamed lists into hiera

9e427f60a6-+-site/DHCP: remove planet1003

c636ee3661-+-cloudstore: set up secondary_drbd classes

532838ae61-+-Ceph: rename radosgw service

6787f7cdfc-+-Ceph: Try to re-centralize radosgw keyrings

505fe91100-+-wcqs100[123] setup info

2f7e33c5ad-+-C:ssh::server: Update the type checking to String

9597ac9fdf-+-openstack.nova: libvirt use systemd socket instead of --listen

8ddef99e79-+-Swap zookeeper from conf2001 to conf2004

d667c00aca-+-snapshot: Drop absented crons

19e435b11a-+-P:pki::multirootca: update default expiry to 4 weeks

76a2f7823b-+-Add ldap-replica1003/1004/2005/2006

9a9a2ea4ad-+-P:pki::multirootca: increase default expire policy

0e7b39f2d3-+-dbbackups: Add s2 to db1102, a buster backup source

466a993047-+-mariadb: Move db1125 from sanitarium to testing

9dbd7d3c16-+-site: set eventlog1003 to insetup

7eb30784e9-+-Revert "Temporarily disable some reportupdater jobs"

7663804d0c-+-etcdmirror: add script to reload the cluster

3e416f06ee-+-Enable the Yarn Capacity scheduler for Hadoop Analytics

970438ec06-+-helmfile: create module

9cc9ee67a5-+-mariadb: Productionize db1183

a5da46708c-+-radosgw profiles: remove keydata param

e2054d2643-+-radosgw: try generating a per-host keyring

7d2b1acce1-+-radosgw: refresh when ceph.conf changes

cb68b6eb94-+-cloud-vps ceph: initial config for adding radosgw to control nodes

d076705d91-+-snapshot: Migrate cronjobs in wikidatadumps to systemd timer

92c84d5308-+-snapshot: Migrate cronjobs in commonsdumps to systemd timer

4f9f97125b-+-redis::multidc: Make discovery optional

3690842424-+-planet: use python3 tidylib and libxml2 versions on bullseye

512d8e1186-+-refine - allow configuring RefineMonitors since and until params

a3362f586e-+-site: add planet role on planet1003, testing bullseye

615a3e3a68-+-snapshot: Remove absented crons

5696377590-+-Trove: move most trove activity into a service project

cd4567ebec-+-snapshot: Migrate cronjobs in mediaperprojectlists to systemd timer

49d41f3713-+-snapshot: Migrate cronjobs in contentxlation to systemd timer

1d157d4a3d-+-snapshot: Migrate cronjobs in shorturl to systemd timer

e24c5153ee-+-snapshot: Migrate cronjobs in dump_machine_vision to systemd timer

a810f0ce10-+-snapshot: Migrate cronjobs in dump_global_blocks to systemd timer

be98b35792-+-snapshot: Migrate cronjobs in categoriesrdf to systemd timer

46b12bd3d0-+-snapshot: Migrate cronjobs in pagetitles to systemd timer

56d6fb61bb-+-Enable failoid role for failoid1002/2002

5bd5e98bd4-+-mariadb: Productionize db1158

d6d897104d-+-mariadb: Productionize db1124 into s7.

32f844e1ec-+-refine_sanitize - use refinery 0.1.6 with RefineSanitize job

dfe8516504-+-mailman3: Add discard_held_messages script and timer

169f2c66cd-+-mailman3: Add remove_from_lists helper

695782e5b3-+-mailman: Add script to dump all list admins

268f9d621f-+-sanitize_eventlogging_analytics_immediate - ensure absent during switchover

ea9b7a84b3-+-site: add planet1003 with insetup role

2ea0e8e326-+-Add new backup node MAC address, partman recipe, role insetup

8d7561fdcf-+-Move sanitize_eventlogging_analytics jobs from data_purge to refine_santizie

d720d73522-+-P:pki::get_cert: escape unsafe labels

dde95142dc-+-Make cloudcephosd1016 an osd node

70d29bacfd-+-Add failoid1002/2002 to Puppet

ffab1c5e2a-+-mariadb: Productionize db1156 on s2

577181e75e-+-profile::conftool::client: Remove support for jessie

75bf0fe115-+-mariadb: Decommission db1086

845c3f56b4-+-Add cloudnet2004-dev MAC address, partman recipe and to site.pp

2f12b87ce6-+-lists: Notify when exclude_backups list is out of sync

4b61b6dff3-+-Move WCQS update to Tuesday

0d7e93ad6b-+-updating cloudcephosd fqdn

142eb32217-+-mailman3: Send queue lengths to prometheus

c7e0592971-+-lists: Use check_mailman_queue for monitoring mailman3 too

3b92cdf82a-+-lists: Port check_mailman_queue to Python

fe77a8dc4c-+-mailman3: Add monitoring for active processes

b0f4035c68-+-role::lists: Drop pre-stretch compat

ff6427c705-+-clouddb: enable alerting for clouddb1021

9b01e9e3a5-+-Update hadoop capacity scheduler

005806e330-+-test/refine_sanitized - add a event_sanitized_main job

7b6975cbb2-+-Make cloudvirt1040-46 into hypervisors

c2d7945c0e-+-logstash: limit apifeatureusage curator job to jobs_host

d8c02ec974-+-Adjust min shard size for mediainfo dumps

8ca876c5a5-+-dbbackups: Add s3 to db2139 (mariadb source backups)

b0f8beb21e-+-systemd::timer: fix ignore-errors switch

bf966d278b-+-P:debmonitor::client: migrate timer::job to use send_mail

a879768615-+-check_cumin_aliases: ensure script exits 1 on error

e941edc04f-+-systemd::timer::job: update mailing script with additional options

cfdfb9e76c-+-dbbackups: Add enabled parameter backups on the cluster::management role

70dc9393f5-+-toolforge.prometheus: add possibility to parametrize the retention

1550da850c-+-sudo: add new flag purge_sudoeres_d

9b5a0d7543-+-prometheus: allow using the --storage.tsdb.retention.size option

3a1bf2b93d-+-swift: force creation of /var/log/swift symlink

0cb94097a5-+-site: add phabricator[12]002 for upcoming hardware refresh

e8c934136d-+-test/refine - suffix job names with _test for easier identification in alerts

42f99f929c-+-refine_job - RefineMonitor should also use use_keytab param

7f3059a233-+-analytics test - import mediawiki.page-delete with camus and refine it

9753c42891-+-P:tlsproxy::envoy: Add support to opt out of FLoC

5260c6a993-+-snapshot: Migrate cronjobs in cirrussearch to systemd timer

39663b3aed-+-Only disable timers for ipmitoo/smartmon timers up to Buster

fc3da4948b-+-test/refine_sanitize - absent sanitize delayed_test until June

360a3e25a2-+-openstack: clodugw: conntrackd: resolve peer names

96a3cc3f68-+-Adapt name of security suite for bullseye and later

96a3352675-+-P:multirootca: fix sudo:: rule title

2df36a76a1-+-cfssl: update certificate expire check script

433061b444-+-cloudgw: introduce eqiad1 service implementation

245ef06a4d-+-thanos: extend retention to 5y

7a69da5870-+-swift: hide diffs for files with sensitive data

3bab95d32e-+-swift: fix reimage race on /var/log/swift

0aef320dda-+-P:debmonitopr::client: add correct owner to ssl cert

c1219c4c8b-+-Enable bacula on sretest1002

370e386dce-+-Remove Python 2 packages on Bullseye

34908afe09-+-Temporarily disable some reportupdater jobs

b81430c808-+-backups: move the exclude backups list for mailman to hiera

cae3fb3b3d-+-Remove cloudera-related packages

0dc1e6d9ad-+-lists: Add option to enable mailman3 on lists

f125b7fc99-+-Decommission analytics-tool1001

61aff469b6-+-gridengine: set additional grid-configurator source files to new domain

329e67f831-+-gridengine: set grid-configurator source files to use new domain name

602cd8257b-+-superset: Enable superset http check

611dd8409e-+-fixing cloudcephosd entries

439e93c2a1-+-refine_sanitize_salt_rotate - use local_salts_prefix properly

23a8bc6d86-+-test/refine_sanitize - make salt rotation more generic

b32fb16960-+-kafka-logging: migrake broker logstash1012 to kafka-logging1003

28653d159f-+-cloudcephosd10[16-20] setup info

47bf08bc51-+-logstash: provision per-target apifeatureusage jobs

a65fd9ba31-+-hadoop::directory - Remove dependency on namenode

227f1723d8-+-Install trove services in codfw1dev

c51e40134a-+-motd: Use heredoc to allow expanding description with apostrophe

5fd149f6c2-+-P:pki::multirootca: fix sudo script

5becf9c608-+-P:pki::multirootca: fix sudo rule

3c47a74ea5-+-P:pki::multirootca: add nrpe check

d25f20574e-+-refine - use 0.1.5 and lowercase table names in include/exclude regexes

aa651e958e-+-bacula: Exclude the whole list of backups, as defined on profile::lists

fa44110cb8-+-ttest/refine_sanitize - use refinery 0.1.5

7306bc3169-+-cinderutils: ensure: fix path to helper script

125beeeac5-+-bacula: Exclude certain directories from mailman backups

544f66c3f2-+-P:debmonitor::client: add scafolding to be able to use cfssl pki

27364fce7c-+-P:pki::get_cert: Add new function to create certs and return there paths

71be2a4710-+-logstash: clean up apifeatureusage curator job

af302941a8-+-elasticsearch: curator remove stdout redirect

03c5fe18de-+-test/refine - use 0.1.5 and lowercase table regexes

693045647d-+-ProduceCanaryEvents - use refinery 0.1.5

cb172699d1-+-wmcs.novafullstack: Point to a dedicated runbook

4380aa3ff6-+-toolforge: Install pandoc

a356f8f755-+-bigtop::mysql_jdbc: add general use case for jar_path

4e339b7c66-+-bigtop::mysql_jdbc: use component/libmysql-java for buster

77ad67a31e-+-P:debmonitor::server: Add ability to support multiple CA's

d6638def6a-+-Setup new etcd3 cluster on conf200[456] in codfw

89adaeb8be-+-base::firewall: add switch to use separate log file

034222c9ac-+-P:debmonitor::server: switch to mod_proxy_uwsgi

e39e8c1b08-+-Revert "P:debmonitor::server: switch to mod_proxy_uwsgi"

28c53777db-+-P:debmonitor::server: switch to mod_proxy_uwsgi

43f70b1487-+-Revert "P:debmonitor::server: switch to mod_proxy_uwsgi"

acb9ec0c52-+-P:debmonitor::server: switch to mod_proxy_uwsgi

dd0bf90505-+-mariadb: Productionzie db1182

a129862daa-+-mariadb: Productionize db1179

e1e13a59de-+-logstash: refactor how curator jobs are defined and deployed

d6ceb59be8-+-kafka-logging: migrate broker logstash1011 to kafka-logging1002

124f02dd42-+-Remove obsolete backup of /root on the apt servers

1fe6815fcb-+-cfssl::multirootca: install certs script

761c2585db-+-ceph: add ceph repo and parameter to all client modules

4834fe4c67-+-site.pp: Specify the old m1 master

f21cd11602-+-check_https_client_auth_puppet: add new icinga check

ced8247f30-+-Remove dbmonitor1001 from Puppet

1b372a9fab-+-Remove kraz

17e2c2449f-+-P:debmonitor::Server: drop absented resource

673028898a-+-P:debmonitor::server: drop systemd-catafrom gc job

04573e88b3-+-P:debmonitor::client: update debmon-client systemd::timer

d49664e374-+-Remove bast1002 from Puppet

b32e136b02-+-mariadb: Decommission db1076

9c43c2803e-+-superset: use different user headers for staging and production

8b6593a974-+-site/conftool-data: designate mw2394,mw2395 as dedicated jobrunners

6ef4dd8001-+-codesearch: Puppetize beta frontend

7b98f254a2-+-P:debmonitor::server: convert cron to systemd::timer::job

1685ce1cf0-+-mailman2: Purge attachments from lists with archiving disabled

02fb4a3405-+-statistics:discovery: fix the PYTHONPATH set for the timer

cc22b8beff-+-statistics::discovery: Set PYTHONPATH

84caea2bc1-+-apt::package_from_component: Only add package dependencies if installing

11d3d1e3fa-+-Configure Notebook Terminal to not use login shell

8b2c62ef08-+-kafka-logging: migrate broker logstash1010 to kafka-logging1001

b4303b31c7-+-test/refine_santize - Use normalized lowercase table name

771cbb8f5d-+-test/refine_sanitize - ensure hdfs salts dir exists

e018878e67-+-Ensure refinery/python on PYTHONPATH for refinery-eventlogging-saltrotate

d111fe1eb1-+-test/refine_sanitize - use proper refinery path

2c81bc629a-+-Set up refine_sanitize jobs in analytics test cluster.

ab5c175696-+-Refine - fix typo in job_config

2d72b91407-+-refine - use refinery 0.1.4

6177c9921e-+-refine_job - remove  RefineFailuresChecker and use 0.1.4 in test/refine

388a300109-+-P:debmonitor::server: Drop nginx in favour of tlsproxy

b4be045c5d-+-Drop bastion role from bast1002

ee16d555d4-+-P:debmonitor::server: move the internal server function to apache

e8ffd58b41-+-ircecho: Install python-prometheus-client

1c1d63f0ff-+-dbmonitor: Remove support for jessie

ca3b7f06ea-+-Revert "P:debmonitor::server: move the internal server function to apache"

cb32483a17-+-Revert "P:debmonitor::server: Drop nginx in favour of tlsproxy"

6baa684b78-+-P:debmonitor::server: Drop nginx in favour of tlsproxy

2b668bc2da-+-P:debmonitor::server: move the internal server function to apache

3bf6e7254e-+-apt::package_from_component: ad toggle to make installing packages optional

4a7eb4ceee-+-systemd: Add ability to set working directory in the timer job

fd47064090-+-systemd: Make timer send email to MAILTO if specified instead of root@

03e31e06c3-+-Add growthexperiments_mentee_data to private tables

cb84ab4cff-+-Remove obsolete requires

c97216ee0a-+-Switch to iptables legacy alternative provider on bullseye

d8b891d78e-+-remove obsolete html files from snapshot manifests for dumps

2376649b7e-+-produce_canary_events -  No longer use http proxies and use api-ro

ee2965d6b8-+-wmcs-policy-tests.py: apparently we need the .py extension

ff6c0390f4-+-Fix path to wmcs-policy-tests.py

7658d21ee2-+-cloud-vps: add first draft of policy tests

361a75d7b5-+-profile::openstack::base::envscripts: add an env file for the osstackcanary user

f08e0317d6-+-OpenStack env scripts: refactor to use a more general resource

2f02927cb9-+-observerenv.sh: make observer_project into a hiera setting

46de7661ca-+-OpenStack control nodes: remove region-migrate.conf

76c678cdb2-+-lists: Make mailman2 easier to run on the cloud

80a31f59a5-+-lists: Drop check for buster

942edf017d-+-apt: Copyedit package_from_component documentation

6bb50fedf4-+-superset: ensure http check absent until it is working

f303d8a01c-+-superset: comment out check that isn't working as intended

5064aae3e6-+-Add moss-be200[12] MAC adderess, partman recipe and role insetup

bd5780cff8-+-superset: check http server following redirects with curl

4c79bf9350-+-site/conftool-data: assign 4 x API, 4 x app, 2 x jobrunner, rack A5

33b0f4f130-+-mediawiki fonts: Remove ttf-ubuntu-font-family

4a996612de-+-ceph: use ensure_packages instead of package directly

b2d2641668-+-Remove references to cloudcephmon2001-dev.codfw.wmnet

19c9f84f70-+-Switch cloudcephmon2001-dev to a spare::system

41f183bb0d-+-Replace cloudcephmon2001-dev with cloudcephmon2004-dev

fcac319d1a-+-profile::parsoid: remove parsoidJS from production 4

66da282f04-+-Only install git-fat for distros up to Buster

c79a04f36f-+-hieradata: remove parsoidJS from production 3

dcb2aa36d1-+-jupyter: avoid logs to syslog/daemon.log for jupyterhub

8918717305-+-deployment_server: Unify 2 "admin" if exlucsions via filter()

2d975fcd39-+-mariadb: Add db1177 to s8.

4e84c4d7a9-+-Assign mw_rc_irc role to irc1001

df176e37e3-+-hadoop: add the liblog4j-extras1.2-java jar to HADOOP_CLASSPATH

17d2069d6b-+-kubernetes: Fix requiring a resource that doesn't exist

4ed58bfda9-+-Add config and manifests for Openstack version Victoria

c16f260281-+-logstash: remove logstash output on legacy cluster

834927c2fe-+-Revert "site/conftool-data: mw2397 through mw2402 back to insetup, not ready yet"

e620be7b7d-+-Designate/Victoria: remove a hacked file

f552f6ed29-+-OpenStack Victoria: pin librdkafka1 to the bpo

d4a8b6e595-+-OpenStack: remove config and manifests for version 'Stein'

8466027181-+-superset: Add victorops alerting for superset

99abfb7d9f-+-Add new conf nodes MAC addresses, partman recipe and role insetup

73922648ca-+-service::deploy::gitclone: change clone path to match repo name

edd65e66d0-+-Add moss-fe200[1-2] MAC address and to site.pp with role insetup

cf99768ff6-+-base::monitoring: ensure script has rb extensopn so its checked by CI

217ba6427d-+-debian: Fail if the release values are not numberes

911e6e11dc-+-ceph.mon: parametrize the repository to pull the packages from

aaf1771221-+-service::deploy::gitclone: do not use mediawiki/services as prefix

0f64f5a333-+-helmfile: Remove deployment_server_secrets::admin_services

2fad2ff684-+-mariadb: Add db1180 to s6

408856de0c-+-backy2,nfs: use ensure packages for dependencies

fdfedcc591-+-base::debdeploy: Install python3-dateutil instead of the Py2 package

dc5554fedd-+-camus: fix the remaining queue name for Hadoop test

a8e2def008-+-camus: fix Yarn queue settings in Hadoop test

354a5b72e4-+-tendril: Remove absented crons

028f5ef2e1-+-sretest: Restrict profile::docker::firewall and cuminunpriv to buster only

d058ccf357-+-Add cloudcephmon2004-dev to site with role insetup

85b6cda290-+-superset: Temporarily rollback victorops-analytics contact_group

c01d105c0c-+-Keystone: get prod_ and labs_networks from a profile

0db84e504d-+-superset: add victorops contact to superset monitoring

6a5811d981-+-OpenStack: Add package and config for Designate/Victoria

0cc0f9b92c-+-Added openstack::clientpackages::ussuri::stretch

086bb5490b-+-toolforge.checker: Update list of etcd nodes

a5df98db4a-+-P:pki::multirootca: ocsprefresh dose need the actuall dbconfig not just json

abc65fda5f-+-cfssl: updated cfssl-refresh script to us dbconfig directly

179cfa4acd-+-ssh::server: Support additional options for PermitRootLogin

4264a1ed18-+-Make bast1003 a bastion

8dbffcfb1d-+-mariadb: Productionize db1184

0633401f4a-+-hadoop: fix the test cluster's yarn queue settings

0bb39bf9a3-+-hadoop: refactor and simplify the Yarn Capacity scheduler's settings

46b04a874b-+-tendril: Migrate crons to systemd timers

6879cb4e45-+-statistics::wmde::graphite: disable wmde-toolkit-analyzer-build timer

4f41c3f4b8-+-Add postgresql-server-dev-all to package builder packages

49a7e2c422-+-ADD new mw servers in rack A5 to site.pp

c16228a449-+-ssh::server us legacy facts for ip addresses

40b89f323c-+-scb: Remove all mentions

c6d5ddf94c-+-C:ssh::server: add support for multiple listen addresses

6ba245fee9-+-C:ssh::server: make authorized_keys_file an Arrauy[Stdlib::Unixpath]

d5cf40ead4-+-C:ssh::server: update parameter types

ef67021133-+-C:ssh::server: refactor

7a962258a1-+-P:debmonitor: clean up absented files

3e7a5b2eea-+-add growthexperiments_mentor_mentee to $private_tables

38b97cbabb-+-OpenStack Horion: create /etc/openstack-dashboard/default_policies

1a5bf4d6a1-+-Horizon: clean up some old ensure => absent file resources

2e7076bfa2-+-mailman3: Use xapian for fulltext search

ee51804f62-+-site/conftool-data: mw2397 through mw2402 back to insetup, not ready yet

59a43f0e28-+-site/conftool-data: turn 8 new codfw servers into API appservers

9f35884f13-+-moss-fe100[12] setup info

0ff340c9b3-+-mailman3: Avoid duplication in rsync definitions

e89a1ed1c2-+-site: turn 12 new codfw servers into mw appservers

e2019805f9-+-Openstack Glance: rip out code for the glance-registry service

f1e1c24a29-+-Fix the mariadb jdbc driver name for Hive and Oozie on Buster

47d220ac87-+-Use mariadb instead of mysql for Hive and Oozie settings

31981086f9-+-profile::oozie::server: use default-mysql-client

983780e799-+-Neutron: Remove ip_lib.py hack for Ussuri

3b703d81df-+-OpenStack: add manifests, files and templates for version Ussuri

c906d7dc07-+-kubectl: Fetch it from_future for a set of hosts

1f477ddd0a-+-kubernetes: move infrastructure_users to the k8s master role

dc16175ed8-+-site/conftool-data: decom jobrunners mw2243,mw2246,mw2247,mw2248

34ccdabb06-+-OpenStack Designate: forward the domain deletion fix to Ussuri

73eb528d42-+-cloudvirt104[0-6] setup info

3e9bef7556-+-site/conftool-data: turn 4 more new servers into jobrunners

d518fa88e2-+-Add Designate files and manifests for version Ussuri

ed55df8c5c-+-OpenStack: add package manifests for Ussuri

227d487894-+-bast1003 setup info

4f3372cf42-+-role::deployment_server: do not always use lvm on cloud

f64f9b0bf9-+-Revert "wmcs.ceph.codfw: Upgrade to latest 5.X kernel"

f9e563ba81-+-hive: use the default logging config path for parquet logs

5c56a7813c-+-site/conftool-data: add 24 new codfw appservers with insetup role

f9bcb4ec50-+-codfw1dev: turn off trove for now

6ef542f926-+-mailman3: Explicitly don't use dbconfig-mysql system

b1441ef50e-+-mailman3: Add documentation to classes, merge hyperkitty into web

a89431e882-+-Openstack Trove: Hack in a bugfix that's missing from the debian package

0fb53baa20-+-P:ci::package_builder: update profile to pass through extra packages

6fd319f1c7-+-package_builder: add ability to inject extra packages

a438bb56c1-+-P:debmonitor::server: serve static files directly from apache

254732baee-+-Add test pdu ps-test-d8-codfw

4523bc16ef-+-mediawiki: Enable CPUAccounting for various components

53f581e8f4-+-debian: add sid as valid codename

18dc492a2b-+-mediawiki::mcrouter: add onhost memcached unix socket support

9c666d1a0b-+-osm: use osmimporter to do expiry when using imposm3.

0ff9299889-+-Use versioned refinery-job.jar in refine sanitize job

b59b78e341-+-Add wcqs200[1-3] to site.pp

dde56a7d34-+-mailman3: Add rsync for mailman2 archives for importing

9aebb8ce35-+-mailman3: Use Stdlib::Fqdn type where possible

a575cf60e0-+-mailman3: Have root@ go the real root@wikimedia.org alias

cb1dbdf172-+-mailman3: Add mailman-web wrapper

d2f2cb4a75-+-kibana: execute systemctl restart as root

e411c21f9b-+-Rabbitmq: open firewall to traffic from the cloud in codfw1dev

19914f4bce-+-cloud-vps: include python3-troveclient

42456b0742-+-Rsync private mediawiki files to releases server

e93c4e7d74-+-Rough in OpenStack Trove module

f9371ecf99-+-refinery: Rename --labsdb flag to be --clouddb

fc3a603e18-+-delete contint::composer

8726c28c1a-+-delete profile::dumps::web::dumpsuser

002755eee8-+-delete contint::website:labs and template (integration.wmflabs.org)

4f5815786d-+-nova: set recursive ownership for /var/lib/nova/instances

01b44452ba-+-Run GrowthExperiments listTaskCounts.php script every hour

86c827d0fc-+-pki: move pki2001 to pki::multirootca role

c1520404c8-+-P:pki:multirootca correct profile name

7b722478ce-+-pki1001: move host into multirootca role

acbe731e9b-+-O:pki::multirootca: add multirootca role

f329402c1f-+-openstack: neutron: disable conntrackd

5be65659ca-+-rancid: parametrize MAILDOMAIN

271ae7fc6d-+-varnish::instance: drop use of array_concat

316b37744e-+-hadoop: enable yarn.admin.acl in Hadoop test

6ff56521cf-+-Drop celery::flower

68b35c45e9-+-delete profile::mediawiki::webserver::tls_nginx

e88392c101-+-delete role::labs::ores::compute

4abdc055d9-+-delete role::mathoid

2120805fdc-+-mailman3: Add basic monitoring for SMTP (exim) and HTTPS (apache/django)

4f1bd5f3ad-+-delete role::pentest::tools

13c0b32b37-+-hadoop: add label capacity settings for the root queue in Yarn

c7b06cc0b3-+-hadoop: fix syntax in configuration of Yarn labels

4773721c55-+-hadoop: attempt to tune Yarn labels for the capacity scheduler

b12370fbd1-+-install_server/dhcp: dhcpd.conf include mechanism support machinery

dbd23c06e4-+-quarry: remove the querykiller profile

9cd55de76e-+-dhcp: Introduce automation proxies for management networks

913c9c4b44-+-calico: Clean up code from calico 2.2.0

17d2e4231a-+-varnish: remove setup_filesystem define

83c566c4f7-+-prometheus::cadvisor_exporter: Support only buster and later

9094904e32-+-cadvisor_exporter: Switch to 4 spaces tab

39a34f4bb4-+-hadoop: refactor how Yarn node labels are set in hiera

0242d3ca96-+-hadoop: introduce the GPU labels for the test cluster

4ba3d8080d-+-mediawiki: Include profile::prometheus::cadvisor_exporter

1e13d2cbee-+-librenms: add base_url setting

8caf874beb-+-toolforge:k8s:etcd: Remove support for jessie

fec62ae8a0-+-quarry: remove the querykiller

c92d4596f1-+-profile::wmcs::nfsclient: include nfs-common package

c35f2e570f-+-hadoop: disable vmem vs pmem check in Yarn defaults

42b62e9205-+-hadoop: increase the Yarn's defaults for vmem vs pmem ratio

ffd0886189-+-site.pp: Use correct role name for root CA

bdbd743925-+-O:pki::root: move pki-root server to pki-root role

90aa55cea3-+-mwlog: "tee" udp2logs received to all mwlog hosts

f0871a0a7a-+-toolforge: services: don't install grid stuff

b4cc4d516c-+-toolforge: services: drop code to support cold-standby approach

5ecabe5cd5-+-initial grafana::grizzly module and profile

3882580d70-+-PKI: make pki serveres spare in prep for rebuild

108bb6db2c-+-wmcs.ceph.codfw: Upgrade to latest 5.X kernel

d8fc411402-+-hadoop: tune Yarn's capacity scheduler defaults

bedaf632f5-+-site/conftool-data: turn new servers mw2377,mw2378 into jobrunners

48832140ce-+-mariadb::misc: Open firewall hole for lists1002 (mailman3)

7e77ee286f-+-Configure lists1002

9a0b148774-+-webperf: use new http_only parameter with httpd in processors_and_site

ae8ec735a9-+-gitlab: add missing brackets in ferm rule drange

16cbd2c805-+-gitlab: open firewall for 80,443. use drange to limit to service IP

fb2fed93cb-+-Add cumin2002 to site.pp

f409ff56f3-+-httpd: add parameter to allow listening on 80-only regardless of mod_ssl

5e84ce5d66-+-mailman3: Configure DKIM

34a7066966-+-gitlab: add gitlab.wm.org service IP, with lookup from Hiera

5cd9900687-+-cinderutils: wmcs-prepare-cinder-volume: fix perms again

b59674b6fe-+-cinderutils: refresh helper script

39e24ddcd5-+-site: Fix typo for mc1038

dcada7e105-+-hiera/nodes: put mc1038 into our session redis and memcached cluster

c2f5a41853-+-statistics: Clean up absented crons

3b07b62ed5-+-openstack: Remove jessie support

32e46b6dd6-+-labs_bootstrapvz: Remove support for jessie

3504fed2a4-+-wmcs: add new admin script to create a new base image based off of upstream

ff94572109-+-toolforge: docker registry: don't use labs_lvm on buster

019498d0a5-+-toolforge: docker registry: deploy dhparams.pem

5e22979cce-+-hiera/nodes: put mc1037 into our session redis and memcached cluster

b4183356b2-+-Add irc1001.wikimedia.org

c8f587dd6b-+-cloud VPS/Toolforge: Remove jessie support

f32108ab86-+-Revert "[wdqs] switch reporting topic to codfw"

25e04d0701-+-prometheus: read alerts from /srv/alerts

31f7d76695-+-hyperkitty: Install whoosh

71f9492712-+-mariadb: Decommission db1084

963cd89872-+-mailman3: Enable mod_headers

36956bba63-+-mailman3: Use acme-chief, unify Apache configuration

6359892086-+-mailman3: Parameterize MariaDB dbname and username

6266cea604-+-mailman3: Configure ferm

ebee6596dc-+-role::lists3: Include profile::standard and profile::base::firewall

f3ff0f93e6-+-Add mw237[7-8] to site.pp

f4e8ed232d-+-acme_chief::cert: Use normal spaces in documentation

49570826a8-+-releases: Provide server-agnostic rsync for security patches

1e28671c85-+-Checkout master branch of testreduce always

0739785166-+-logstash: arrange systemd::timer::job resource around cron_splay

fb609fa3ae-+-pki-root1001 taking over auth1002 chassis

0b99e3fe82-+-logstash: only add dlq cleanup if enabled

be73c98ba6-+-logstash: add and enable dlq max_bytes workaround

d663e396e2-+-statistics: Migrate wmde cronjobs to systemd timers

855e882559-+-Update GrowthExperiments cronjob parameters

c9afb2471b-+-sonofgridengine: install cpp at the same time as 'gridengine-common'

6b4e05e4a0-+-site.pp: Remove duplicate role declaration

72498acae7-+-aqs_next: add more hosts to the cluster

5df295f58c-+-alerts: deploy to Prometheus hosts

ab05736be1-+-mariadb: Productionize db1181

dd0f9fad6c-+-[wdqs] switch reporting topic to codfw

e3ed0625e2-+-kubernetes eqiad: Apply role and hiera values to new masters

f4eaade47a-+-kubernetes eqiad: Populate hiera keys for k8s worker updates

006b20493f-+-mariadb: Promote db1136 to s7 master

8319311793-+-site: remove decommissioned node labsdb1012

3eba39c81e-+-site/conftool-data: decom mw2249,mw2250 jobrunner canaries

c67b687003-+-cloudgw100[12] setup

7ce70b72f3-+-site/conftool-data: turn mw2278,mw2279 into canary jobrunners

69b70220fb-+-hosts.debian.tmpl: further attempt to handle VMs without cloud-init

a7e28ba812-+-cloud-vps instances: only change a cloud-init template if we have cloud-init

9590c2d157-+-Support building a grid-exec node with cinder or flavor-defined storage

23aefcb170-+-wmcs instances: override /etc/cloud/templates/hosts.debian.tmpl

3dd4e49922-+-Extend tendril ferm rules with dbmonitor1002

b3393610ab-+-analytics: fix admin/submit policies for the yarn capacity scheduler

f29a5c3860-+-puppetdb::app Add GC parameters to ro-host

f77a99765c-+-Fix PHP version in one more place

d38c033766-+-Fix component name

06c236bf67-+-Assign tendril role to dbmonitor1002

45e2f4a438-+-prometheus: remove ircd-exporter

aa5b258502-+-mariadb: Productionize db1161.

3ee17f0864-+-Additional PHP config tweak for tendril/buster

7d520917ce-+-analytics: move druid load jobs to the analytics Yarn queue

ee90a87484-+-analytics: set test refine jobs in a different Yarn queue

858ea5fa3b-+-camus: switch to the yarn 'ingest' queue for Hadoop test

c303ac2ecd-+-hadoop: fix typo in capacity scheduler's config

b16b37b112-+-hadoop: fix Yarn capacity scheduler queue mappings

009899f529-+-hadoop: set the Yarn capacity scheduler for the test cluster

75850ed440-+-hadoop: add a profile to deploy the capacity scheduler's settings

37ec851ab3-+-docker_registry_ha: Add documentation to profile class

a776ea2d17-+-webperf: Don't have apache listen on 443

05c4404d56-+-webperf: Enable mod_ssl for performance website

80f67d3381-+-site/conftool-data: decom mw2244,mw2245, former canary servers

ef03397b65-+-arclamp: serve SVGs, compressed logs from Swift

9438c0c8c3-+-site.pp: Add lists1002.wikimedia.org

4104c229d7-+-site/conftool-data: turn mw2251,mw2252 into canaries

7ed5af6654-+-P:tcpircbot: drop monitoring of service

de1376b2a1-+-P:debmonitor::server: allow users to configure the cas required_groups

dbd7c35a69-+-P:debmonitor::client: update cas vhost and open FW

38219bc4ad-+-P:debmonitor: fix dependencies in cloud

5431969e18-+-deployment: Add ML cluster to deploy hosts

445d116f50-+-profile::rsyslog::kubernetes: add component for buster

45e8699371-+-sonofgridengine: master: ensure cpp package is installed

1c9f046c2a-+-parsoid::testreduce: switch mysql data dir to /srv/data/mysql

e3f38fba40-+-site/conftool-data: decom mw2239 through mw2242, rack A4

aa891e1997-+-prometheus: re-order sudo access for the cron

d72b59926d-+-docker_registry_ha: Require authentication from k8s nodes

26bc04eec4-+-toolforge: set up an "opt out" of the infrastructure profile

cec3c2617e-+-systemd::service: Add ability to monitor services

723c9057ba-+-systemd::monitor: create a generic nrpe systemd check

77ffacd082-+-P:debmonitor::server: make logback and monitoring optional

b150a1124e-+-P:doc: use the correct php version for each debian distro

1fbcf31d3c-+-swift: fix kernel version check

aad95bf7cb-+-swift: compare kernel version directly

450539726e-+-dbbackups: Move s5 from db2139 to db2101

3c77db49f0-+-P:debmonitor: Make profile compatible with cloud environments

7dbd6ff789-+-mc103[78] install params

52acdaaada-+-site/conftool: remove mw2230 through mw2238, rack A3

185219657f-+-new db host additions

ef22dbb851-+-paws haproxy: tighten block restriction to use x-forwarded-for as well

a5147952bc-+-rsync::quickdatacopy add auto_ferm_ipv6 param

b8d93c5ba6-+-modules/tcpircbot: Port to Python3

b1cf964dee-+-Add dbmonitor1002 to site.pp/DHCP

dc652a8c5c-+-hiera/modules: Add role for ML k8s workers

1669f9f8b1-+-mwlog: add primary/standby host settings and rsync

5f4fe4fafe-+-grafana: make domainrw optional

f9750b540a-+-C:puppet_compiler: ensure the yaml dir is always readable

de56d54793-+-Adapt package installation for tendril/buster to pull in PHP 5.6

2825156e20-+-otrs: remove absented cron code

9a53b6e0f2-+-otrs: replace spamassassin cron with systemd timer

21779c662b-+-profile::kerberos::client: Default to use DNS canonicalisation

0be9b17251-+-mariadb: Productionize db1161

cb4397690f-+-site/conftool: decom mw2224 through mw2229

66045566b6-+-icinga: monitor: fix notes URL for some toolschecker entries

d71a57886a-+-contint: use Java 11 on Jenkins agents

b80e0e7b64-+-doc: script to restart php-fpm

c1f0140410-+-P:base::firewall::extra: profile to set ferm rules via hiera

50463f0115-+-puppet_compiler: stop installing openjdk

0512e8dd7a-+-C:grafana: add types

7e5448d43a-+-toolforge: fix apt pinnings for several packages in stretch

e817c1a967-+-Switch java::package to ensure_packages

23a97fae91-+-aqs: add aqs1011 to cassandra 3.11 test cluster, add aqs_next role

d58dd97692-+-ceph-common: add fio for testing and debugging

bd5d0cb93b-+-profile::discovery::client: remove services filename

62bb8f7424-+-kubernetes codfw: Apply role/hiera to new masters

3d4be8a7c9-+-kubernetes codfw: Populate new worker hiera keys for k8s update

46a3156577-+-mariadb: Productionize db2150

3a44b1a023-+-logstash: add dead letter queue support

1646fc35c2-+-Add cinderutils::swap

5ee688b561-+-cinderutils::manifests::ensure: refine behavior for existing lvm volumes

e3c75db58d-+-logstash: bugfix: remove unnecessary character escaping

828bc63bf8-+-logstash: bugfix: use type field

294011e342-+-logstash: add dead letter queue ingest support

32927d3485-+-cinderutils: exclude sda and vda from any mounting

a4eec34a18-+-site/conftool: decom mw2220 through mw2223

75be623c27-+-aqs: move import of ::passwords::aqs

1195132492-+-cinderutils::ensure: support specifying mount options and file mode

c2035b5783-+-Refactor cindervolumes fact again

b81ba8122e-+-k8s: Add docker-registry credentials to pull restricted images

da54cc6f29-+-Add eventstreams clusters to monitor_services.pp

19b3c4c3f7-+-cloudgw: adjust sysctl parameters that are only meant for dataplane

82b505639c-+-icinga: remove Grafana alerts for Performance

52d621cd25-+-cloudgw: add standard mapped IPv6 addresses to the primary interfaces

aae3e19410-+-cloudgw: separate dataplane network configuration into a different file

8561bc4a8d-+-Assign mw_rc_irc role to irc2001

09c19354f1-+-profile::hadoop::common: move defaults from hiera to the profile

d0e3a273ff-+-idp: Make the memcached transcoder configurable

0aa0449b73-+-Revert "Revert "wdqs: impl. envoy for wdqs-test""

e503b02528-+-site/conftool: decom mw2217, mw2218, mw2219

a5caaf50a6-+-site/conftool: turn mw2374 and mw2376 into API canaries

a9024b8175-+-postgres: add script for automatic resyncing

e6dd70da54-+-paws: add a hiera-controlled ip blocklist

4598e69a2d-+-profile::wmcs::instance: replace hiera_include with lookup

dde57aaf6b-+-cinderutils::ensure: Gracefully handle lvm legacy cases

201a4f9947-+-mariadb: Decommission db1088

b4e24dc65b-+-prometheus::node_puppet_agent: update requires

70ddf46004-+-bacula: Reduce read-write es db backup retention to 60 days

0e8c899c4a-+-Revert "wdqs: impl. envoy for wdqs-test"

ef58d86133-+-wdqs: impl. envoy for wdqs-test

09b32217a6-+-site: decom mw2215,mw2216, codfw API canaries

3387524cf5-+-mailman3: Add let's encrypt parts for labs

692dbd1053-+-mailman3: Add exim4 configuration

8066ba2348-+-superset: allow analytics networks through staging firewall

1ba994a4f5-+-phabricator: remove absented cron job code

46dd228d6c-+-phabricator: run cleanup_tmp_files job as root

11f108e176-+-phabricator: fix description for cleanup tmp job

0fee80abf5-+-phabricator: replace task dump cron with timer and switch to weekly

7335473e1c-+-backup1003 updates

643d0056b5-+-grafana: add domainrw param and lookup

55e99fd5f2-+-docker: Simply use the default package version on Buster and later

9ffa5bdbce-+-mariadb: Fix duplicate resource declaration.

88958d8efe-+-mariadb: Expect all pc hosts to be read-write.

6f956c955d-+-hiera: Add LVS realserver config for ML k8s

051e213869-+-toolforge: initial support for Debian Buster on bastions

98524f09f0-+-mariadb: Use section params: remaining profiles.

e71077e4d5-+-mariadb: Productionize db2149

988e7e9f92-+-mariadb: Productionize db2148

a3a7e29afc-+-site.pp: Tighten registry* regex

762a2d5b8d-+-cinderutils::ensure: Refactor and add a 'mount' resource

0b4c5753e2-+-releases: include profile::docker::ferm in releases role

b1dc5a04a8-+-builder/docker: break out docker ferm rules into own profile

1d7288a52c-+-Update comment to reflect that an-conf100[1-3] are in use

731870d7d3-+-systemd::timer::job: Add ability to redirect stdout/stdin/stderr

a12b40ae3e-+-manifests: decomm remove mc1024 from puppet

a5ad78239d-+-aqs: make aqs1010 a separate AQS cluster

e82864af58-+-dbbackups: Move files and templates to dbbackups hierarchy

0fd9169ce7-+-Add kafka-logging200[123] to site.pp

1bdc2278b2-+-Add role::labs::cindermount::srv

21c57827d8-+-Move prepare_cinder_volume.py into the cinderutils module

4c3e697840-+-cloud-vps: Add a new resource to detect and format available cinder volumes

5985e56bad-+-ms-backup100[12] updates

1620da4f86-+-p::pki::client: enable tls_remote_ca

e6d9191bd3-+-P:pki:client: correct tls param

26f3cdc695-+-pki::client: allow user to override remote ca

8185ba5011-+-cfssl::cert: use client config not root

f2ac9254ad-+-P:profile::client: support tls-remote-ca

d853fdcbdc-+-P:pki::intermediate: add additional TLS clients

39bf6d09b4-+-Add profile::base::linux510 for cloudgw and cloudnet

5070e6c7b1-+-P:pki::multirootca: use correct private key

390f4b2b26-+-manifest: Mov ML k8s machines in codfw to prod

ce28a928c1-+-Followup to I01027c61fbeafa3ae688af6bee79a2e044785d5e

dcf46e9d44-+-pki::multirootca: add headers module

d48e3f8514-+-labs_lvm: give a unique name to the pv-free exec

905a06d3a4-+-P:pki:multi: add class { 'sslcert::dhparam': }

99db868c84-+-manifest: Move ml-serve1002 insetup -> ml_k8s::master

88073c88b3-+-P:pki::multirootca: use apache for TLS termination

826ea6102f-+-Finalize Editing team schema ingestion migration to Event Platform

87ed065f31-+-modules/roles: Add k8s config for ML team machines

96cfdb0485-+-P:pki::client: make the mutual tls certificates optional

3d24da30a5-+-commons entity dumps: use mediainfo for the name in the config file

ed891db196-+-wmflib: remove deprecated $::_roles variable from the role() function

b06296c3a8-+-Decom ms-be[2016-2027]

abddcb2e90-+-systemd::timer::job: correctly quote environment variables

a084fb9100-+-Refine 2 ReadersWeb schemas using eventlogging_legacy job

bf165d38d1-+-logstash: ingest logstash logs as json and convert to ECS

1fb7bc8c10-+-an-druid100[345] updates

c38d524537-+-Add apache2 mod_rewrite to beta prometheus

751c8b3c68-+-docker_registry_ha: Remove legacy "uploader" user

1d3f6e8358-+-wikireplicas: give analytics_multiinstance role to clouddb1021

b3b2c9e54c-+-labs_lvm: check for available space before partitioning

dbca6f94ab-+-cfssl::client: store bundle certs in own directory as we purge others

bf784e38dd-+-cfssl::cert: add ability to notify a service on renew

8b2ec439e7-+-P:pki::client: allow proxy service to use TLS when proxying

c4b3efa6ac-+-Finalize PrefUpdate schema ingestion migration to Event Platform

4843343974-+-cfssl::client: add ability to proxy requests

c3195fa864-+-mariadb: Use section parameters: smaller misc profiles

a9f637c97c-+-mariadb: Set misc nodes in codfw as 'master'

4369a6f504-+-cfssl::signer: change default expiry to 96h

9d389ebc2a-+-cfssl::cert: change renew time to 24 hours

f8595d3e52-+-cfssl::cert: fix path for int ca

0e1700e35e-+-cfssl::cert: change how we distribute bundles

d614bfcc6e-+-make wikidata and commons entity dumps easier to test in deployment-prep

7c9f5a8a8d-+-kafka-logging updates

b2cd303a20-+-site: remove deploy1001/2001

89e54242b6-+-P:pki::client: add bunldes source

eeccdc2a86-+-wikireplicas: Add basic configuration for clouddb1021

9420fc6420-+-cfssl:cert: provide method to fetch CA bundle

69bafd9a29-+-Remove labsdb1012 from puppet in preparation for rename

aad8ba09df-+-P:pki::multirootca: correct typo wmflib::dir::mkdir_p

4939bf028d-+-P:pki: server bundles from web server

db9a2f08f5-+-pki: update to use include

09f200b612-+-cfssl::ocsp: create an empty response file

c941b3e3f1-+-P:pki: gaurd loading cfssl class

8b5f241b08-+-P:pki:multirootca: fix types

b8f35974c1-+-P:pki::multirooca: add multirootca profile and config

37ddb126e9-+-P:pki::root_ca: use standard size key for ocsp

843cfc65bb-+-P:pki::root_ca: correct ocsp responder location

d1ca45adb7-+-Switch active kubernetes staging cluster to eqiad

f4d60a9684-+-wdqs: new query-preview microsite

1131838629-+-mailman3: Add hyperkitty

68fce31665-+-kafka: Disable alert for absolute max lag value

5eb3dd07aa-+-mailman3: Start apache2 for web

283f631c86-+-ldap::config::labs: replace hiera_hash with lookup

badfdcb2cc-+-package_builder: remove absented cron code

f6ba5d0665-+-package_builder: remove /dev/null redirection from cowbuilder update command

984ee04ec3-+-package_builder: convert cowbuilder cron to systemd timer

50ee1aea29-+-assign mwlog1002 role::logging::mediawiki::udp2log

f38b731bae-+-assign mwlog2002 role::logging::mediawiki::udp2log

b446666ee3-+-Rename CONDA_BASE_ENV_PATH to CONDA_BASE_ENV_PREFIX

76c91eabd2-+-mariadb: Add section parameters: misc

daf974a40a-+-mariadb: Add section parameters: core::multiinstance

981fcb0b74-+-kube_env: Add bash completion

dbba7f89b7-+-Remove old kubernetes staging master neon.eqiad.wmnet

3d1c2793cc-+-fix state_path for imposm engine

858f31c2e8-+-mariadb: Productionize db2146

862d2158d9-+-profile::docker::registry: Update monitoring check to check Buster

5e00f29258-+-scap: Swap betacluster udplog deployment-mwlog01

78b5deca1a-+-mariadb: Productionize db1159

e7d94c968e-+-mariadb: Productionize db2145

8426123706-+-cassandra: Remove support for jessie

8f43c688d7-+-mariadb: Add section parameters

b1e8e40c33-+-docker::baseimages: fix systemd timer name

02228f31d7-+-service::monitoring: Remove support for jessie

3c6442b969-+-service::node: Remove jessie support

a32595d91b-+-[wdqs] fix puppet on wdqs1009

17f815612a-+-striker: Remove support for jessie

32d9abecd3-+-role::analytics_cluster::hadoop::worker: set linux 5.10 on GPU workers

eebf39dfd9-+-site: remove mwmaint2001

d4a42f833c-+-site: add gitlab1001.wikimedia.org

e15f4b33cf-+-Use more generic non-team specific name for alerts

35a50559e8-+-site.pp: Add new registry VMs

4dc119c80a-+-eventlogging: Remove multiple unused modules

ca629f2cc7-+-Finalize Growth schema ingestion migration to Event Platform

95ef9d64c4-+-Finalize WMDE Technical Wishes schema ingestion migration to Event Platform

038952855d-+-Configure spark to work better with conda environments

0b78049f0e-+-Add ms-backup200[1-2] to site.pp

078670887f-+-mediawiki::alerts: fix mediawiki-error-rate check

a9d009b29d-+-[wdqs] buffer 250 messages instead of 1000

9738443c31-+-tcpircbot: remove deploy1001/deploy2001

5c2a634a0e-+-git::lfs: Remove support for jessie

1a3e1add8f-+-Add backup2003 to site.pp

20630abeba-+-P:pki::root_ca: create ocsp certificate

17912c0e13-+-cfssl::cert: update default key size to 256 and drop rsa

24ded1af9b-+-Revert "site: add gitlab VMs with placeholder role"

f3d08a60f6-+-docker::baseimages: weekly rebuild

9739ab7401-+-Revert "gitlab: open port 80 for traffic from caching servers"

992cbec132-+-modules/hiera: clean out old (<3.8) ROCm configs

8aef055612-+-staging-eqiad: Apply role/hiera to new master

85dd81f8bd-+-P:idp::client::httpd::site: update default delimiter

94100dc9d9-+-O:netmon: update delimiter to use ':'

9391ee5b1c-+-profile::puppetmaster::common: Remove support for jessie

df54d5f1f6-+-mediawiki::alerts: add per cluster error/fatals rate alert

e739fdec88-+-P:pki::root_ca: use correct title for intermediate certs

f41054aec8-+-profile::wmcs::nfs::primary: Remove support for jessie

d39c1c2f0e-+-deployment_server: Switch k8s staging to codfw

42636458cf-+-P:pki::root_ca: add ability to generate intermidiate certificates

fc75f405af-+-cfssl::cert: use db-config if signing locally

2b1f9b36e4-+-Add profile to deploy the 5.10 Linux kernel on Buster hosts

2735f4e1f0-+-dhcp: specify owner and group for option 82 config

dfdea94091-+-P:profile::client::httpd: add param override the attribute delimiter

2c220adcae-+-cfssl:::signer: Only notify Service if we actually manage Service

f2c05a96d2-+-P:pki:root_ca: add auth_keys

a8b4246074-+-P:pki::root_ca: fix typo db_ vs dn_

1ebe24c33b-+-pki::root_ca: add new profile for offline root ca

130974e4f7-+-Configure unprivileged Cumin to use the Puppetdb microservice

0bc4e3c139-+-cfssl::db: make notify_service optional

a7dc7646be-+-Also add /etc/cumin/aliases for unpriv Cumin master

3614a8bd85-+-Update comment

183e828481-+-prometheus::haproxy_exporter: Remove support for jessie

32558257be-+-Correct typo in site.pp related to new analytics worker nodes

a2e0c9882b-+-Add an-worker113[2,5-8] to the Analytics Hadoop cluster

30ee24acee-+-profile::hadoop::worker: add explicit require for profile::java

d94ff185aa-+-profile::tlsproxy::envoy: Remove support for jessie

67055013a6-+-profile::zuul::server: Remove support for jessie

028ff11e30-+-Revert "tcpircbot: allow deploy1002/2002, do not allow deploy1001/2001"

8fdfe645f4-+-kibana: add systemctl full path for valid sudoers config

a3a99623d6-+-add sudo rule to restart kibana

b3c61d36a4-+-tcpircbot: allow deploy1002/2002, do not allow deploy1001/2001

9971eeac76-+-tcpircbot: remove deploy2001

9ee5610213-+-fix sudoers rule for phatality (`kibana-plugin install`)

dc21d2ebff-+-mediawiki::maintenance: remove superfluous dot in maint hostname

3654246992-+-mediawiki::maintenance: reverse rsync direction for home dirs

feb191088f-+-tcpircbot: remove mwmaint2001, replace with mwmaint2002

706f77e777-+-site: add mwmaint2001 with insetup role, decom in progress

40beba2c23-+-site: remove mwmaint2001.codfw.mwnet

6c54593193-+-gitlab: open port 80 for traffic from caching servers

ae9afdb333-+-icinga: add grafana dashboard alert for client errors

c8bb9f0e1e-+-Add GrowthExperiments maintenance script

3c25fcb47e-+-bigtop::sqoop: apply upstream patch/override to sqoop bin

dbbccc35f7-+-Introduce kubemaster[12]00[12], kubestagemaster1001

cc449fa479-+-Add an-worker11[19,20-28,30,31] to Analytics Hadoop

bc39c0d60f-+-uwsgi: Remove support for jessie

f6804b856f-+-envoyproxy: Remove jessie support

ad61d54a81-+-sudo: add validate_cmd for sudoers file

25e21f3282-+-mariadb: Productionize db1164

abc8ce1b7e-+-maps: fix imposm3 cache dir

e5ae18b74f-+-prometheus::postgres_exporter: Load additional rules on stretch

6404e10af3-+-sudo: add validate_cmd for sudoers file

28f6769799-+-profile: remove logstash inputs on legacy cluster

6d0f23196a-+-hiera/scap: switch deployment server to deploy1002

8359283c08-+-docker_pusher: Use new docker-registry credentials

2de2c5eecf-+-promethues: scrape mtail metrics from logstash 7 cluster

dcb72517c5-+-Keystone: stop monitoring for novaadmin/novaobserver project membership

45f7e0de71-+-tcpircbot: add mwmaint2002 to allowed hosts

ca3711ed55-+-site: add mwmaint2002.codfw.wmnet to maintenance server role

6b7654d9e7-+-profile::python38: limit the scope of the module to Buster

13d2709560-+-prometheus::postgres_exporter: disk metrics and custom queries

966f2d2512-+-Bump docker.io versions used by CI/releases Jenkins

4ab64de431-+-debmonitor: Bump the uwsgi buffer size to 8192

8c6acf7367-+-profile::python38: fix component name

0865737396-+-profile::amd_gpu: add python 3.8 on Buster

3cdea52f7f-+-wmcs.postrgesql.osm_primary: add missing required engine param

05994ef996-+-prometheus: add notes_link for stale node-exporter textfile

e1286b7739-+-kibana: use different settings based off version

91a26e1aef-+-mariadb: Productionize db2152

2495951727-+-mariadb: Decommission db1092

78914f8271-+-Include profile::analytics::jupyterhub on an-test-client1001

b5d1254844-+-deployment: allow syncing home dirs to other dpeloyment servers

578fc0c561-+-role::deployment_server: re-order includes, add comments, clean up

a562ce1325-+-scap: switch codfw deployment server and scap master to deploy2002

0b89540583-+-deployment::rsync:: also sync patches directory

1ecf52ed40-+-Add mwmaint2002 to site.pp

60d464a65a-+-amd_rocm: remove hcc from base packages

0fddfe8114-+-amd_rocm: deploy the hcc package only with version < 3.7

a984a800a5-+-Expand range of Modify Kafka max replica lag slope alert

967aef4fbd-+-mariadb: Productionize db2147

4f020f7ddf-+-Make Toolforge docker registry cert configurable

e435cbdeca-+-docker: Lockdown /root/.docker a bit more

8b1722bd6c-+-docker: Use "prod-build" account for pushing production images

0dfbb2ff77-+-deployment::rsync: remove references to the 'trebuchet' name

f4ba7abe49-+-docker::engine: replace hiera_hash with lookup, add data types

6a7926985e-+-Revert "ldap::config::labs: replace hiera_hash with lookup"

2d66f907cd-+-ldap::config::labs: replace hiera_hash with lookup

91802c9a73-+-ci: Use dedicated "ci-build" account for docker-registry pushes (try #2)

abb1378033-+-mediawiki::packages::fonts: Remove support for jessie

d1b8f73e1b-+-quarry: Remove absented cron

a2e0f82a8f-+-Add ml-serve-ctrl100[1,2] base config

5ee4746f03-+-Add a job for TemplateWizard metrics aggregation

09605ba9df-+-Add ml-serve-ctrl200[1,2] base config

374eab7430-+-openstack: neutron: add wmcs-netns-events.py daemon

4270dc2ac8-+-kubelet: Support the IPv6 feature gate

7bbb4cc64b-+-bigtop::hadoop: hdfs/mapred/yarn system users needs to be in grp hadoop

e069612fd7-+-bigtop::hadoop: avoid a dependency between hadoop-client and users

6bf87e02d9-+-bigtop::hadoop: create system users before installing hadoop-client

27d0a5467f-+-profile::cumin::unprivmaster: Install tqdm from spicerack component

6443d0fc6e-+-Add an-worker111[7,8] to the Analytics Hadoop cluster

4255501c9a-+-profile::cumin::unprivmaster: Log to user's home

290a583715-+-Allocate fixed uid/gid for analytics-related system daemons

6d4a3c1d12-+-mariadb: Productionize db1168

f20d76bd2f-+-profile::analytics::refinery::job::refine_job: fix ensure_monitor flag

0623790652-+-phabricator::logmail: fix timer description

96a5a8f7c3-+-quarry: Replace query-killer cron with systemd timer

a61ff9909e-+-mediawiki::udp2log: remove absented cron code

d2d4ab6b96-+-deployment::rsync: remove absented cron code

3bd2c11840-+-logging::mediawiki::udp2log: replace cron with timer

938466d2f2-+-deployment::rsync: replace cron with systemd timer

6627bb7074-+-phabricator: remove absented cron code

7b9bff8115-+-Revert "ci: Use dedicated "ci-build" account for docker-registry pushes"

f7401135a3-+-ci: Use dedicated "ci-build" account for docker-registry pushes

76eb5b726d-+-releases: Fix variable interpolation in docker_config.json

5d332cfe8c-+-releases: Add docker-registry credentials to push restricted images

4d88cf2352-+-releases: Move documentation to correct role

a6e5ae63d6-+-phabricator: convert statistics mail crons to systemd timers

2c9275ff88-+-labs_lvm: change the default disk in case we ever create an odd image

1fead1a90c-+-kubeadm: remove swap from preflight_checks

6901ceb788-+-logstash: add logstash service resource management toggle

e03d866b6c-+-profile: add logstash unit override to order logstash after ES

f97698c825-+-mediawiki::alerts: another attempt to fix mw server saturation alert

607ad2574f-+-Initial Cumin parts for the unprivileged Cumin master profile

8f7ab3de26-+-mtail::program: restart mtail by default

3347edb485-+-Remove unused analytics_cluster::superset

0ca93a3782-+-autoinstall: Prepare ms-be2016 for reimage for swift backups testing

d3aaca6e27-+-mediawiki::alerts: attempting to fix mw server saturation alert

ea6db5a3fc-+-Fix syntax

52af5b55e5-+-Fix role name in detection of active Cumin hosts

3803ea336e-+-druid: set caffeine as default cache for the Brokers

40d179a205-+-osm: correct file paths for imposm components

a428dfeef0-+-mediawiki::alerts add alert when 20% of servers is saturated

0f34d9e750-+-dumps NFS servers: don't rsync to internal hosts if there are none

a72b4cbbe5-+-druid::bigtop::hadoop::user: add fixed uid/gid from Buster onward

312a520460-+-mariadb: Decommission db1090

7ccba76df7-+-Fix role insetup for db21[45-52]

efa7f17272-+-site: fix typo in regex for gitlab nodes

2966a9b412-+-site: add gitlab VMs with placeholder role

ca674fdcaf-+-analytics:refinery:job:data_purge: Remove Growth deletion jobs

c3ad16fb7d-+-mw_rc_irc: add check_prometheus alert on no messages being relayed

da78a92139-+-create placeholder role/profile for gitlab VMs

7c025f42ac-+-Finalize migration of SpecialMuteSubmit ingestion

7add26a020-+-analytics:refinery:job:data_purge: Absent Growth deletion jobs

9e1dc72af4-+-docker_registry_ha: Have restricted/ images that are limited read/write (try 2)

46710f5d1f-+-bigtop: set uid/gid for hadoop user/groups for Buster

c69e4b016a-+-bigtop::sqoop: apply workaround for BIGTOP-3508

c595fae146-+-Set a symlink for the host keytab

2ae5c9682b-+-Drop host keytab from the cuminunpriv profile

2d5d0e5edc-+-graphoid: Remove all puppet references

fde5c53ba6-+-start using imposm as OSM sync tool

158740975b-+-P:ntp: drop use of array_concat

f20f68af3c-+-Make GSSAPI configurable in sshd config and enable for sretest1001

6a88b87741-+-Decomission dbmonitor2001

14aee243c7-+-toolforge: front proxy: drop non-TLS support

b4fbbb7517-+-Add GrowthExperiments tables to private_tables

d9301da859-+-bigtop: add the hadoop/hdfs/mapred/yarn groups to the catalog

76ae74962b-+-make commons json entity dumps use mediainfo name like rdf ones

4313575f41-+-pbuilder: create apt-cache directory before running pbuilder init

798e04f25d-+-Include profile::kerberos::keytabs in profile::cumin::unprivmaster

ee571b6de6-+-Refine - re-add accidentally removed spark conf from last patch

9f44c01067-+-Refine - Remove override for spark2 assembly jar

aaeab72e9a-+-Don't run Camus checker for atskafka webrerquest job

2c33dad1b3-+-Fix time limit on Camus job

7b1d9991c0-+-analytics/camus: Add job to export ATSKafka events to HDFS

e072300eaf-+-nutcracker: drop use of to_milliseconds function

c9e4cfa47f-+-prometheus: mask prometheus.service

454d8163cf-+-bigtop: require hadoop users before installing daemon packages

5058182e04-+-Apply ensure absent to the monitor refine flags in Analytics refine

32e1c26f91-+-Generation of json dumps for wikimedia commons

60f8ff3d0a-+-Update test cluster refine jobs to use event platform schemas

b7aa35401d-+-toolforge: add haproxy and nginx-ingress configuration for jobs.toolforge.org

793f2648d8-+-Decommission the Hadoop backup cluster

445b5e43b4-+-Fix Kafka Broker Replica Max Lag is increasing alert

551f9484a9-+-Add alerts on eventgate_validation_errors_total rate for each eventgate service

de0e42f96d-+-Horizon logging: try to detect multiple-line log messages

6a1c9b9cfc-+-Alert if kafka max replica lag is steadily increasing

ba19f06648-+-arclamp: add excimer-real pipeline

7670290274-+-install params for an-worker11(29|33|34|39|40|41)

a0a3a17464-+-profile: add prometheus job for udpmxircecho

bf1eaffbf7-+-mw_rc_irc: add metrics endpoint to udpmxircecho

4979c96350-+-restbase: Remove graphoid config

4c0b0ea766-+-P:idp: Add script to delete u2f rgistrations

b9676ac19b-+-base::standard_packages: install python3-wmflib on all buster servers

3771503d44-+-debmonitor: ensure installation order

d0bc00b9be-+-debmonitor::client: replace cron with systemd timer

dafd0b757e-+-mariadb: Remove db1075 from puppet

7a88c73624-+-analytics/reportupdater: remove ee job

955b362953-+-Horizon: ship error logs to ELK

72fc692003-+-kibana: set vega.enabled: false by default

30138a061c-+-role::maps: fix MOTD message

b680875912-+-profile: set content directy bypassing config validator check

59e03e2662-+-profile: add content to filter_ulogd_ecs to appease config validator

b56cd55c6b-+-profile: disable ulogd_ecs filter on legacy logstash

c43284de22-+-wikilabels: Remove absented cron

8d5fcd5f6e-+-profile::base::cuminunpriv: Allow SSH access from unprivileged Cumin masters

1d76108a50-+-puppet_compiler: add spec tests

f104be4ecc-+-make ca_source optional

ead14d1bbf-+-cloudgw: set up conntrack sysctl parameters

1b059b3659-+-P:puppet_compiler: add job to deletd large pcc reports after 7 days

c6fc198753-+-Initial stub role for rootless Cumin

60bd7384e7-+-Swift: Stop setting net.ipv4.tcp_tw_recycle for buster and later

45c2401852-+-profile: remove deprecated syslog input

cd77769e86-+-cloudgw: let keepalived track additional static routes

5df429b71c-+-delete class tlsproxy::prometheus and nginx template

b645bccdd2-+-Remove MaxMind archiving code

0cc9446797-+-site: move mml-etcd in codfw from insetup to etcd role

b7fb67516c-+-Add etcd role for ML Team's new clusters

6d546b70b6-+-hadoop: add more precise notes_url for various daemons

3c540eb779-+-P:puppet-compiler: use fully qualified cmd

ce09626499-+-dbbackups: Reenable read-write backups, disable ro, document job ids

176fb1749a-+-P:puppet-compiler: add description to timer job

fbc50a26ae-+-puppet-diffs: update

ca4174cf3b-+-P:puppet_compiler: update cron job to systemd timer

e211211bce-+-P:puppet_compiler: refactor a bit

32778221fa-+-cloudgw: use address per interface in the cloud-instance-transport subnet

09544c71dd-+-openstack: cloudgw: allow incoming conntrackd TCP connection

97e1151a44-+-memcached::instance: Add support for memcached 1.6.x

544e3f15b3-+-hadoop: deploy kernel 4.19 to master/worker nodes

8c1c2d294b-+-kubernetes::deployment_server: add yaml to configure MediaWiki sites

ab39946b18-+-conntrackd: also install the conntrack tool

5cc0b33bae-+-wikilabels: Add description to the systemd timer

13658e0bac-+-wikilabels: replace cron with systemd timer

5ff8556667-+-mariadb: Productionize db1172

076390276e-+-mariadb: Remove db1093 from puppet

02d1c394b7-+-cloudgw: stop setting up VIP addresses that are now handle via keepalived/VRRP

6b114a1371-+-cloudgw: introduce HA by using keepalived/VRRP

d8ef77fd9e-+-profile::hadoop::master: raise threshold for corrupt blocks

e7cb8a6093-+-swap roles of dumpsdata1001 and 1003 so 1003 is primary for xml/sql dumps

2f0545575a-+-labstore: allow NFS connections from public cloud networks

657ee5203d-+-misc dumps: move commons rdf to later on Sunday and media info to earlier

68becc285c-+-Revert "dbbackups: disable all ES db bacula runs until next week"

68c90823d9-+-Update oozie sharelib creation

1e9aaf2931-+-hadoop: enable HDFS service port for Analytics Hadoop

d83c3f3b95-+-profile::hadoop::backup::namenode: add a more precise notes_url

ca7b60bc6d-+-Revert "mwdebug: allow rsyncing home dirs

3d910879c4-+-dbbackups: disable all ES db bacula runs until next week

a62e77fa28-+-aqs101[0-5] puppet repo updates

3507b67a64-+-refactor wikidata json dumps to be easier to test on deployment-prep

7fe7cbc045-+-keepalived: add support for custom template

961ccde2ff-+-cloudgw2002-dev: give it proper puppet role

19c621268e-+-Revert "docker_registry_ha: Have restricted/ images that are limited read/write"

ca8ace98e9-+-docker_registry_ha: Have restricted/ images that are limited read/write

4def5826ca-+-mwlog1002 updates

895cf96ae7-+-mwdebug: flip rsync source and dest hosts

d0aae7a07b-+-Remove old OpenStack Rocky files/templates/manifests

4c97b2e6e6-+-dbbackups: Create new puppet module dbbackups, move backup check to it

34441e23e7-+-mwdebug: do not automatically sync home files, just manual

947ad87302-+-mwdebug: allow rsyncing home dirs from any mwdebug* to a backup host

b63e308e7a-+-dbbackups: Move database backups-related puppet code to its own profile/role

9e5ba68049-+-apertium: Cleanup scb cluster, puppet

1a35915868-+-grafana: support multiple read-only vhost via server alias

9d4b2b1226-+-P:idp::standalone: use correct name

bf95aa71f1-+-P:idp::standalone: add uwsgi app

b074505a48-+-idp::standalon: drop uwsgi::app in favour of service::uwsgi

50b190f914-+-P:idp::standalone correct indent

2c67407cd2-+-P:idp::standalone: add simple lask app to test idp

e5279d1e63-+-refactor script for wikidata and commons rdf dumps

4b97e830b5-+-bigtop: allow to split the HDFS Namenode RPC thread queue

89f18b5cb2-+-apereo_cas: disable notify on servie changes

c8c96867dc-+-P:idp:standalone fix template

9024b7b3f3-+-profile::idp::standalone: create a profile for managing idp on cloud

651c31b204-+-profile::memcached::instance: remove "default_values"

b714dc0a6b-+-dhcpd: create and include files for option 82

01e4f0fe1a-+-db1163: Reimage to stretch to potentially become s1 candidate master

2921116d1d-+-base::service_unit: drop support for sysV and upstart init scripts

6f05f62adb-+-systemd: add data type for 'day of the week' in systemd timers/calendar

a3ab8b5caf-+-Rename the Cloudera CDH specific configs to Apache Bigtop

85c2a01e78-+-Remove obsolete netfilter sysctl setting

215a28046e-+-arclamp: Remove traces of excimer-buster pipeline

4204742e5a-+-arclamp: Actually remove the excimer-buster pipeline

b563365dfc-+-Revert "arclamp: Add excimer-buster pipeline"

c645217a72-+-ldap: Migrate hiera() to lookup()

8c6d7fdefb-+-P:idp: add ability to change memcached port

88b1e76ac3-+-wikireplicas: adjust logrotate for multiinstance on wmf-pt-kill

b847a72464-+-profile: update w3creportingapi to use 12 weekly indexes

ecca2e6d5b-+-druid: remove cdh specific configurations

f02bd46e86-+-P:idp: update profile to use ldap['proxyagent']

5f3bd82d3b-+-P:idp: add ability to disable start tls

311eb5eeb4-+-Initial client profile for unprivileged Cumin

b7b4d6dd77-+-profile::kerberos::keytabs: Drop require for the user

1f480eb445-+-P:idp: drop tls config in cloud

b416fc6bf6-+-mariadb: Decommission db1081

7b474713c9-+-mariadb: Productionize db1162

a29dead460-+-Fix type in refine.pp spark conf

c8ccce5cf1-+-Refine - use spark assembly without hadoop jars

73a35a627b-+-gerrit: remove code that absented cron

de03bc5d45-+-gerrit: replace certbot cron for cloud with systemd timer

7b024157e9-+-profile::rsyslog::udp_json_logback_compat: hiera -> lookup

ac9db36ce4-+-profile::labs::downloadserver: remove lvm class

73c0cfee40-+-profile::labs::downloadserver: remove lvm class

d2b9acee1d-+-relforge: service impl of relforge100[3,4]

81078b91dd-+-Keystone: a new (but still terrible) approach to making projectid==projectname

4d49553ebc-+-bacula: Temporarily enable read-only backups and disable rw backups of ES

eae3639b87-+-Train/buster: don't install python-pycadf

bc6a816682-+-mariadb-backups: Remove old scheduled job disabling

9bc1a13005-+-ceph.osd: Allow setting the io scheduler of the osd disks

71e08b7905-+-phabricator: add network performance tuning settings

4ad5b041de-+-Set Apache Bigtop 1.5 as default hadoop distro

0eaac24945-+-mariadb: Productionize db1170

b23265afd6-+-profile::labs::downloadserver: remove lvm class

c9efff2a21-+-parsoid-rt / parsoid-vd: Pass in database socket path in server config

6df31b424a-+-parsoid::testreduce: set mysql datadir to /var/lib/mysql

83624ece8f-+-kartotherian: Followup for I7f77fd9a1c8d49f3e23dc

650f9a5e95-+-md: Run checkarray on a random weekday of each month

51ee231867-+-mediawiki: remove the unused site directive

a73e4825c9-+-memcached: enable unix sockets in memcached

0820422748-+-mariadb: Decommission db1094

67fe615e19-+-toolforge: front proxy: add dhparams file

d03705641a-+-Bacula: Fix reference to still not yet renamed pool Databases

3814c70912-+-Add a new profile to install OpenLDAP client tools in production

bea900d5e2-+-backups: Apply partial rename of jobdefaults without changing devicename

f16808224d-+-Bacula: Fix dependency cycle on es backup storage setup

bb5ccde07e-+-Bacula: Start using new storage/pools for es database content backups

c5fad8b88a-+-mediawiki: use a data structure to define all virtualhosts

1a60fdadb3-+-Bacula: Create a new set of storage daemons dedicated to db ES backups

d44ad343e4-+-aqs: allow deployment via git

4f9c0d37b3-+-mariadb: Add new codfw databases to insetup

6ab0e139d1-+-installserver::proxy: remove code that absented cron

d9eaf26e60-+-profile::hadoop::master: add more precise runbooks for alerts

a2c180d38d-+-site.pp: Add 9 new databases as insetup

e9e7e654ca-+-prometheus: update profiles to drop array_concat

ca44bbeec6-+-scap::target: drop array_concat

27dff6ee2c-+-mariadb: Productionize db1157

d372e86e60-+-profile: temporarily extend w3creportingapi retention period

647d89a02f-+-sbuild: in buster, sbuild installs createchroot cmd in /usr/bin

9f577c7d29-+-profile: filename should have underscore

a2dd2f844e-+-profile: send w3creportingapi logs to indexes with custom schema

350898b7b7-+-logstash103[345] puppet updates

c454ce1334-+-puppetmaster: drop shell_exports function

17443fc0ec-+-profile: fix guard condition to check ecs.version

4fb2175746-+-Revert "toil: remove rsyslog_tls_remedy"

ddd3dab315-+-install_server: Decommission db1095, substitute with db1171

991141967f-+-swift: limit rsync and swift-object-replicator memory to 5% in codfw

59fe628167-+-wmflib: drop ensure_link in favour of stdlib::ensure

e998b6c902-+-mariadb: Decommission db1078

502e2f3f1c-+-wmflib: Email type

0b772d6a71-+-wmflib: drop ensure_service in favour of stdlib::ensure

5bb8e26245-+-ipsec: Clean up the parts related to cache cluster

a84f7d2a97-+-tlsproxy::localssl hiera->lookup

e6e4831ac5-+-zuul::server: Add types

340f8c4f96-+-Move an-worker1117 to the Hadoop backup cluster

2de8b3fc79-+-Reduce the HDFS Namenode fsimage backups retention on Hadoop Backup

48cbc236ed-+-installserver::proxy: replace cron with timer

13786dc2f9-+-wikireplicas: query sampler subscribe to correct config file.

7664974f88-+-wikireplicas: fix one more typo in the new querysampler service

6192771b72-+-wikireplicas: remove error from the profile for query sampler

0cb264cb42-+-wikireplicas: add a role for consistency on the querysampler service

62c11b675d-+-wikireplicas: deploy a cloud-based query sampler for the replicas

d6e3ececb2-+-labs_bootstrapvz: hiera -> lookup

1897f273d0-+-profile::redis::multidc: hiera -> lookup, add data types

0347e7a614-+-wmflib: drop ensure_directory in favour of stdlib::ensure

3273a44734-+-swift: apply interface::rps to i40e NICs

4a967e68a7-+-trafficserver: migrate from wmflib::HttpStatus to Stdlib::HttpStatus

4c487c4d39-+-wmcs.backups: Use the wmcs-backup script for vms

7a363072ae-+-mediawiki::prod_sites: move to dumb templates

e12f24494d-+-stdlib: update to 6.6.0

ef4f1e0e6f-+-swift: limit rsync to 10% memory in codfw

698e997bab-+-swift: limit rsync service memory

93ad402dfd-+-mariadb: Productionize db1173

cbd81dc658-+-releases: Parameterize profile::ci::kubernetes_config owner/group

78bcf0bf94-+-profile::ci::kubernetes_config: ensure /etc/kubernetes exists

76dc4825f7-+-Revert "archiva::proxy: allow nginx to serve content from repositories"

7fc59bf611-+-OpenStack Nova: use /var/lib/nova as $home for nova

c6e0e43c03-+-profile::docker::storage::loopback: hiera -> lookup

48582607bb-+-wikireplicas-proxy: fix typo

a4031dc3c5-+-wikireplicas-proxy: tune the main haproxy config for databases

2a4d5049a3-+-install-server: Fix overly generous RE for ml-etcd machines

e15b1dfee2-+-install_server: Add DHCP, partman and manifest entries for ml-etcd*

6101cda28f-+-releases: Provide remaining pipelinelib dependencies

138bb6e330-+-modules/network: Break out management networks by DC label

a63fa1aa54-+-profile::wmcs::instance: remove needless requirement on lvm2

442589429e-+-archiva::proxy: allow nginx to serve content from repositories

205f9abd25-+-profile::hadoop::master: better naming for the alert runbook

d24e6cef49-+-profile::hadoop::master: add more specific alert runbook

92854b8390-+-k8s::kubelet: Ensure apparmor is purged on old k8s nodes

cf919bc5a0-+-mariadb: Productionize db1174

347a49f23a-+-backup-sources: Productionize db1171 to substitute db1095

689727a281-+-mariadb: Decommission db1089

0615f216b0-+-arclamp: Add excimer-buster pipeline

69eedc9c92-+-nagios_common::commands: require_package -> ensure_packages, simplify

126cd6267d-+-openldap: Convert cross-validate-accounts to Python 3

ec3e296f47-+-gerrit: drop log4j custom config

e6fb220daa-+-Add a textfile exporter for the machine's Debian version

ed4c3748c3-+-wikidough: update description for role

3161b9e194-+-decom francium.eqiad.wmnet

3f39a83be6-+-cloud-vps instances: add a helper script to format & mount a cinder volume

8a4a2272d5-+-Refine SuggestedTagsAction schema using eventlogging_legacy job

7ddcf8a431-+-profile::analytics::refinery::job::test::camus: update EL dt field

99987b8178-+-k8s::kubelet: Ensure apparmor is installed

ccf687b319-+-Finalize NavigationTiming extension Event Platform migration

eb558d92bb-+-make adds-changes dumps easier to test in deployment-prep

7a8b025ac9-+-ldap::client: use ensure_resources to install ldap-utils

8d4b772e81-+-profile::maps::tlsproxy: add_ecdhe_curve toggle

d8473f40ee-+-[beta] Add vote.wikimedia.beta.wmflabs.org to beta_sites

7f20d91fa9-+-add a proper media section to the deployment-prep dumps config file

5a178131b6-+-WMCS utils: add script to detect leaked VM puppet certs

a4a42e3740-+-nova-fullstack: remove test for puppet cert cleanup

546e095fa3-+-Update the nova-fullstack monitoring to expect python3

8eef529185-+-make snapshot1007 running buster a dumpsrunner and move testbed to 1005

dce7c42256-+-presto: set kerberos enabled by default

f643aea6ab-+-Allow incompatible col type changes for Hive 2.x

39f7119874-+-nova-fullstack test: use a bastion proxy for ssh tests

c687930706-+-neutron-linuxbridge hack: restart service after hack is applied

749bba742e-+-Neutron: Hack in a bugfix for the linux-bridge agent

3268054114-+-role::postgres::master: hiera -> lookup

4e090f2dd4-+-profile::rsyslog::udp_localhost_compat: hiera -> lookup

ea7b4130b4-+-profile::rsyslog::netdev_kafka_relay: hiera -> lookup

c68bf7425a-+-base::certificates: hiera->lookup, add data types

c1d157215c-+-monitoring::service: hiera -> lookup

fcd92596d2-+-dumps: switch htmldumps server from francium to htmldumper1001

e7a2ffaa6f-+-site: update comment on htmldumper1001

16e0e6cc50-+-Install placement client on Train nodes.

7ec029f49a-+-dumps: add a config for xml/sql dumps that writes elsewhere than prod dirs

3764feb7db-+-Add test presto server role to an-test-presto1001

76ac629276-+-OpenStack: Forward placement files and manifests from stein to train

18e616a5b6-+-Add an-test-presto1001 to puppet

8123ad316c-+-Remove nova-placement-api service manifest for Train

d194ee0403-+-Replace nova-placement-api with placement-api in eqiad1

baa53e9de5-+-mariadb: Productionize db1166

f2ee8fd131-+-bacula: Undo conditionals added while transitioning helium->backup1001

5f0270ad44-+-profile::docker::storage::thinpool: hiera -> lookup

00f6a891da-+-profile::kubernetes::deployment_server::helmfile: hiera -> lookup

11311a35e4-+-profile::kubernetes::node: hiera -> lookup, add data types

4a436bd16f-+-bacula: Remove helium and heze references from puppet

475095162e-+-role::analytics_test_cluster::client: add presto client

d55d567e49-+-mariadb: Productionize db1175

11a62cc93c-+-elasticsearch: missing s at end of edac-utils

a4186d0b56-+-elasticsearch: include edac-util (ecc userland)

f2dbca5030-+-mediawiki: Port nrpe_check_opcache to Python

68aec5dcce-+-wmcs:  Migrate hiera() to lookup() and set datatypes in nfs secondary

59946d029e-+-wmcs: Migrate hiera() to lookup() in nfsclient

b923a6a90a-+-wikireplicas proxy: add PRODUCTION_NETWORKS to the ferm rules

38c646982b-+-Revert "bacula: Perform a one-time backup of helium's archive pool"

97ebc4ec1e-+-Revert "bacula: Add temporary jobdefaults for 1 time Archive pool backup"

1bb2f4a9d9-+-wikireplicas: set up LVS for multiinstance wikireplicas

e85e3f1658-+-analytics:refinery:job:druid_load.pp: Bump up jar version to 0.0.146

2cebdeb667-+-OpenStack: add the standalone 'placement' service

218e8c5d2c-+-tlsproxy::prometheus: hiera->lookup

eea14283bc-+-P:idp: open port specific to what is listening on tomcat vs envoy

ba3544a808-+-bacula: Add temporary jobdefaults for 1 time Archive pool backup

780dc5c1a6-+-Allow the kube-controller-manager to run without superuser permissions

8387746d46-+-bacula: Perform a one-time backup of helium's archive pool

9d9f43092d-+-Fix argument syntax for redirect check

34f95e6909-+-Cinder: fix copy/paste error for codfw1dev ldap password

4a28db9517-+-tomcat: add libtcnative-1 when apr enabled

9ea889f308-+-tomcat: add suport for ssl connector

5182ca1ab1-+-Adapt SSO check for debmonitor

88a98f1174-+-bacula: Fix bug on realizing backup sets on motd

2f0be26ccb-+-alertmanager: bind phab bot to all addresses

47079ca6c3-+-alertmanager: have kthxbye listen on all addresses by default

d9c7d36872-+-prometheus: add job for alertmanager::phab

35161fd847-+-alertmanager: add phalerts webhook receiver

4f7623c437-+-Add import_commons_mediainfo_dumps to role::analytics_cluster::launcher

e0723ef740-+-lvs: Migrate hiera() to lookup() in realserver

39f633bb70-+-OpenStack Cinder: use novaadmin, not cinder service user, for keystone auth

1768d64cf0-+-docker_registry_ha: Have build-homepage talk directly to the registry

05a22768e0-+-profile: get the ecs pre-filter filename right

a76a54ba73-+-profile: place drop ecs filter in place of ecs pre-filter

b837025fc8-+-base.pp: move value_type and merge behavior into the options hash

c04cd3c4de-+-etcd::replication: hiera -> lookup, add data types

34acce3b24-+-profile::base: hiera->lookup, add data types

f4326b575d-+-wikireplicas: open the proxies for the new ports

7200b0eca0-+-wmcs: Migrate hiera() to lookup() and set datatypes in nfs primary

c3118e363c-+-idp: update idp profile to support ldaps or ldap starttls

5f8fae27e7-+-P:idp: Add hiera defaults

1eca15f7c6-+-cassandra::single_instance: use dedicated hiera key, don't use 'cluster'

f952590d26-+-Add snappy dependency to coal

a7d2c8c03b-+-Absent /etc/helmfile-defaults/service-proxy.yaml

61d3bbd5d9-+-include correct mysql client package for dumps on buster

d0e2593a6a-+-mariadb: Remove mariadb module mylvmbackup

0aa73cd177-+-Enable base::service_auto_restart for netbox/apache

66ba5cf873-+-mariadb: Remove mariadb module mysqld_safe

36dd64c493-+-Migrate hiera() to lookup() and set datatypes in purge.pp

206fcaaf46-+-mariadb: Productionize db1169 in s1

f22871052e-+-service_proxy: add ipv6 config option on services_proxy config

bd2065cefa-+-parsoid/testreduce: add envoy on testreduce1001 for TLS termination

b2baebce66-+-wdqs: use envoy for wdqs-internal

7993b9b0fb-+-relforge: remove decommed relforge100[1,2]

f96fac1fe6-+-Parsoid Testing: Switch rt/vd server db hosts to localhost

5bb3beba76-+-data-services: apply user variances to future creations

92460f2082-+-Decommission relforge100[1,2]

55beea5e73-+-Add manifests for Neutron version 'Train'

e29ec2ac30-+-Add manifests for Keystone version Train

a416c7c12b-+-Add manifest for Glance version Train

b04609bc04-+-Add manifests for Cinder version 'Train'

1c13119775-+-Add OpenStack client package manifests for version Train

45dd13a2df-+-Add manifest for Barbican version Train

c6c9c294f4-+-Add manifests for Nova version Train

38e4ac74a9-+-toolforge: pin sudo_ldap to a newer package version

13f2611a29-+-Refactor Discovery's analytics airflow to be more generic

d4a03af892-+-profile: define required curator config variables

921804bbb7-+-profile: ecs indices to use a weekly rotation

6097d87fbc-+-maps::apps: only use nodejs10 repo on stretch

7d74bab979-+-O:idp: update apero_cas::service so its a bit more intuitive

fb1ae44175-+-maps: make maps1009 a new, independent buster master.

24b3cb5f0b-+-Enable managed adduser.conf unconditionally

e16cfb7c43-+-Remove obsolete tmpreaper Puppet classes

d2d66a0a0a-+-realm: Add translate_cache to $private_tables.

344254474b-+-udp2log: Install bsection

0a67cf7826-+-mariadb: Productionize db1160

7ae9403fc4-+-Add an-worker1119 and 1131 to the Hadoop backup cluster

b1bcc80f86-+-alertmanager: add JSON logging of all notifications

33a64c26ec-+-mariadb: Promote db1138 to s4 master

8031135b08-+-mailman3: Fix python package for mysql

2ce6e625c7-+-udp2log: Switch require_package -> ensure_packages

97d574439f-+-threedtopng: Switch require_package -> ensure_packages

65ed6e4124-+-superset: Switch require_package -> ensure_packages

70a9da9ae2-+-parsoid::testing: switch db_host from m5-master to localhost

274e9494df-+-snapshot: Switch require_package -> ensure_packages

33fd7539a7-+-logstash: enable curator to accept custom age filters

46d7d2214b-+-Add clougw2002-dev to site.pp

75a28edbf0-+-logstash: Migrate hiera() to lookup() and setting datatype

5eaf376691-+-cache: Migrate hiera() to lookup() and set datatypes in frontend

c1fe4fa8f7-+-Do weekly dumps of Wikidata Lexeme

e119b3068e-+-reduce number of xml/sql dumps kept on dumpsdata hosts by one

a061332841-+-profile::analytics::refinery::job::hdfs_cleaner Update

95ed5f4027-+-lvs: Migrate hiera() to lookup() and set datatypes

934e178e35-+-Add the HDFS balancer to the Master node in Hadoop backup

1554710ec9-+-Add the Hadoop worker profile to master/standby in Backup

eb55be5abe-+-profile::hadoop::monitoring::resourcemanager: fix jmx resource name

e96d321df4-+-Remove old analytics decommed nodes

c7b52d80c3-+-scap: Switch require_package -> ensure_packages

40037bc8a5-+-libraryupgrader: Update celery systemd units

789b031634-+-Designate monitoring: make regexp for designate-api detection more lenient

9f11af6102-+-releases: Provide docker to PipelineLib based jobs

7adb2f62d2-+-analytics:refinery: Bump up Refine/DruidLoad jar versions to 0.0.145

6b7956d8bb-+-query_service: use a SPARQL query that is agnostic of the updater.

8cc0f190de-+-wikireplicas: remove query killer from dedicated replica server

b5b81d85bc-+-query_service: fix failing WDQS SPARQL icinga check.

50045d31af-+-role::ml-serve: Add ml-serve machine role

3b8e57eb64-+-Revert "Render kafka cluster connection info in helmfile-defaults..."

165df2bbf7-+-Add puppetboard[12]002

56ce04da62-+-profile::prometheus::analytics: add metrics for the Backup cluster

87cb55162f-+-hadoop: make Yarn Spark Shuffle optional

b584b6f3a8-+-profile::hadoop::backup::namenode: add dep to analytics-admin

3bb3fd63bc-+-Add roles to the Hadoop Backup cluster nodes

9afc2181a9-+-wmcs.enc: added a small cli to be able to use the enc

fcbbda7233-+-profile::hadoop::worker: make client tools optional

0acdfdc179-+-query_service: remove monitoring check for UI.

ef2024e289-+-Lower druid-public historical datasource backups

18f75b1e54-+-profile::analytics::refinery::job::druid_load Bump jar version

99f7f41640-+-Initial configuration of the Hadoop backup cluster

e6b92ec34c-+-openldap_clouddev: fix for new acme ca

dfcb92a45b-+-Remove obsolete role installserver::apt

956dda1390-+-wikireplicas: add a multiinstance role for the dedicated analytics host

d02f9a43ec-+-Finalize QuickSurvey* Event Platform migration

33a7439e49-+-Remove the 'letsencrypt' module

6c6094f828-+-Install python3-snappy for webperf navtiming

2a69ffa501-+-Remove k8s::ssl

d5232e0304-+-Nova: move vendordata handling out of nova::common

a358b30495-+-profile::analytics::cluster::users: add analytics to the druid group

5f1769e691-+-Add comment in site.pp for former bastions

d2848969b8-+-Remove unused roles librenms and rancid

3388b4d81c-+-Remove tor::instance

23dfdcab61-+-refinery: Migrate hiera() to lookup()

2f3bea3e5b-+-Nova: reload api and api-metadata service when the vendordata source changes

63169f001f-+-nfs: set default monitors for 10Gb Ethernet

92102c090b-+-docker_registry_ha: Randomize timing of build-homepage job

0d1c6eac75-+-docker_registry_ha: Have nginx serve /srv/homepage for /

42f6da2456-+-docker_registry_ha: Enable and fix build-homepage job

2f75676e1c-+-monitoring::host: move hostgroup_default to params, hiera->lookup

9c81c6d9a1-+-profile: drop ECS messages on legacy cluster

36dd52fc07-+-mailman3: Add parts for Postorius (web interface)

b83d845ff3-+-redis::slave: hiera->lookup, add data types

87adf88d7d-+-Update HDFS folder creation for analytics refinery

f76e9eae8a-+-profile::analytics::refinery Create HDFS folders

a5beac301d-+-network: add cloud_networks_public constant and use it in ferm

4cd732026b-+-analytics: Migrate hiera() to lookup()

9cd094a254-+-Render kafka cluster connection info in helmfile-defaults/general-*.yaml

cdd66703ba-+-Revert "Nova: add a simple vendordata REST service"

90abb81eb8-+-klaxon: autorestart on envfile changes

be465720f9-+-nova vendordata: use a bit of jinja and inject dhcp_domain into cloud-config

20cec87066-+-Disable bast3004/bast4002/bast5001 as bastions

6f84ad2bae-+-webperf: enable Apache base::service_auto_restart

f2620f55a0-+-toil: remove rsyslog_tls_remedy

f8e362769c-+-Add cuminunpriv1001

43d333164a-+-[wdqs] disable async imports

de17b16ea1-+-Revert "nova: install the novavendordata api in codfw1dev"

e616d08bc2-+-docker_registry_ha: Disable build-homepage job for now

fb58894a20-+-docker_registry_ha: Add missing parameter for systemd timer

9db6bb0bfc-+-profile: add priority to logstash filter filenames

fcc1b39103-+-docker_registry_ha: Fix typo

dc2f2fa42b-+-docker_registry_ha: Add a script to generate a static HTML homepage

17b1b9547a-+-role: remove rsyslog TLS remedy

b2f7986ffb-+-orchestrator: Add sslcert:dhparam

61b3455cf0-+-orchestrator: Enable apache2 mod_ssl

1fd8af5b17-+-orchestrator: Put orchestrator behind IDP

fc2a800c05-+-bacula: Migrate hiera() to lookup() and setting datatype

8bafcecd85-+-rsyslog: install rsyslog from component/rsyslog on Buster

7f9397a647-+-install_server: Fix domain for dborch1001

2fcb5902df-+-query_service: Migrate hiera() to lookup()

4887bcb346-+-kafka: Use lookup() instead of hiera() in code comment

b33433295f-+-eventlogging: Migrate hiera() to lookup() and setting datatype

f693adff4f-+-cloudinfra: Migrate hiera() to lookup()

60ceb76c46-+-nova: install the novavendordata api in codfw1dev

6dc5f1dbb4-+-Nova: add a simple vendordata REST service

6e3b791166-+-eventlogging: Migrate hiera() to lookup() and setting datatype

66e80e3cc0-+-Drop profile::analytics::refinery::job::streams_check

2f4eeb9447-+-analytics:refinery:job:data_purge Activate netflow auto-purging

3af67f94ba-+-mariadb: Allow public orchestrator ip to connect.

b31cf73e7a-+-query_service: Migrate hiera() to lookup() in gui

847a508580-+-Add designate packages and manifests for openstack/train

365c315fb4-+-adding new an-workers to puppet

e5869e123d-+-Remove openstack Queens config

8d83046261-+-klaxon: allow setting of team IDs filter for pages to show

74149908e6-+-klaxon now depends on python3-wmflib

cafbad0e11-+-tlsproxy::localssl: Remove support for the acme_subjects param

85fb5ec2e3-+-Make bast4003/bast5002 bastion hosts

1bec75a8b4-+-wmcs.ceph.osd: actually disable write caches

09e87bc9dd-+-wmcs.ceph.osd: disable write caches when possible

ee8b990523-+-cache: Migrate hiera() to lookup() and setting datatype in eventlogging

991ce14fac-+-cache: Make statsd address an argument and hiera() -> lookup()

0cc13f7299-+-query_service: Migrate hiera() to lookup() in common.pp

a0222a2876-+-Horizon: install real Cinder policies

40fa6dd2bc-+-cinder: enable haproxy frontend in eqiad1

feebabab19-+-Enable cinder in eqiad1

5020b9754b-+-keystone: remove obsolete service definition

5833327c04-+-Keystone/stein: disable the packaged keystone init script

b11f31adaa-+-nova-api monitoring: simplify grep for detecting processes

1920ec1239-+-nfs: change the default throttles for primary cluster read and egress

c79472d2d8-+-Nova monitoring: update the egrep string for the nova-api process

58948bb203-+-kubernetes::master: add data types, hiera->lookup

75038b1bc4-+-phabricator: drop absetned file

0a9f5be2f5-+-Add bast4003/bast5002

e2fba8e13e-+-monitoring: update varnish 5xx logstash short link

a77d9d4f11-+-logstash: update short link to indexing errors dashboard

14f3999fcf-+-Enable base::service_auto_restart for puppetboard/apache

7a9186f6ec-+-cloudgw2001-dev: introduce server

682546cd7c-+-P:phabricator: remove apache level blocking

79138b8b98-+-swift: apply interface::rps to bnx2x as well

08b8d06aa8-+-query_service: Migrate hiera() to lookup()

296b36f367-+-labtestvirt2003: drop host from production

49c0930768-+-netbox: actually create the empty file

e13d44dc3a-+-role: add interface::rps to swift::storage

23b21c7a02-+-netbox: create the state file for the Icinga check

2adaab0789-+-docker: require_package->ensure_packages

56a6fe5706-+-discovery:client: hiera->lookup, add data type

64a8de3729-+-icinga::elastic: require_package->ensure_packages

5f8810ad0c-+-sbuild: Switch require_package -> ensure_packages

c36d8f00ec-+-Undo finalization of EL migration of SpecialMuteSubmit

0c78c03c90-+-Make bast3005 a bastion

ce8dd8f8a4-+-eventlogging: Remove profile::eventlogging::analytics::files

cc9e7c98a3-+-wmflib::dir::mkdir_p: use ensure-resource to avoid duplicate

ea58d5a8b9-+-dnsrecusor: update variable name for installing version from component

4cf52eb520-+-P:microsite::peopleweb: convert dirtree to mkdir_p

37491b6499-+-wmflib: create dir::split and dir::mkdir_p functions

03fff23ccd-+-cloud.encapi: enable ssl nginx vhost

d3c3bd4c0c-+-varnish: add phabricator specific ban in varnish

852cc014a9-+-role: add interface::rps to swift::storage

52e932c531-+-Enable sending mail for Cumin alias check

088da923da-+-Add a new option to enable mail output for a systemd timer

6973859859-+-Add a wrapper to optionally mail the output of a systemd timer

3ee6adfd8a-+-pybal::testing: convert to role/profile, hiera->lookup

374924a081-+-updating puppet repo for ml-serve100[1-4]

2c3e186cb8-+-bird: require_package->ensure_packages

e7ddb8c1d8-+-lvs: stop monitoring graphoid

a8f59b82a8-+-Finalize migration of UniversalLanguageSelector to event platform

4ea97f2d14-+-Remove analytics-tool1004 from puppet (decommed node)

6853f2631b-+-Add bast3005

71e23dd49c-+-zuul: Switch require_package -> ensure_packages

c7ca29bfde-+-docker_pkg: Switch require_package -> ensure_packages

c4d2f897bc-+-visualdiff: Switch require_package -> ensure_packages

6d56ded895-+-wikireplicas: fix up wmf-pt-kill service on multiinstance replicas

6542478bcd-+-wikireplicas: one last tweak to merge the hashes right

52c9702ffd-+-wikireplicas: enable standby behavior on multiinstance proxies

672ee05006-+-Revert "wikireplicas: enable standby behavior on multiinstance proxies"

df383672f5-+-hive: Migrate hiera() to lookup() and setting datatype in serve

7036921520-+-hadoop: Migrate hiera() to lookup() and setting datatype

9056ed8de1-+-cache: Migrate hiera() to lookup() and setting datatype in statsv

694ca2037f-+-wikireplicas: enable standby behavior on multiinstance proxies

82aed04090-+-cfssl: helper script

1c37c7b0a1-+-Remove evenstreams role

c64567a72b-+-Finalize migration of SpecialMuteSubmit to event platform

63da22c93d-+-wmcs.backup_glance_images: disable the backups on 1003 and 1004

3d310df485-+-P:toolforge: migrate to ensure_packages

c0f9692383-+-cloud: neutron: l3_agent: double size of conntrack table

41c86ddc7a-+-profile::hadoop::yarn_proxy_testcluster: guard auto-restart inclusion

ccf0f98795-+-Enable base::service_auto_restart for purged

b0caeb9736-+-ATS: make number of allowed Lua states configurable

133b0eb081-+-Only install base packages list for Stretch and later

f9bdcb97b5-+-Enable base::service_auto_restart for prometheus-es-exporter

877165d95e-+-Stop installing apt-transport-https on Buster and prune it from Stretch installs

528d3630a1-+-When changing rabbitmq-env.conf, notify rabbit service

b4b323db9e-+-OpenStack rabbitmq: set busy wait threshold to 'none'

e2edc557e8-+-dumps::web::fetches::analytics::job fix perms

0f62d6be52-+-mailman3: Start mailman3

96f0f8fac9-+-codesearch: Remove manual operations/puppet handling

46b2e4b1cf-+-wikistats: let import job run as root, needs to delete tables

13baa209b5-+-dumps: require_package -> ensure_packages

b80ac9be9e-+-toolserver-legacy: use an acme-chief cert

d135e602e5-+-delete the mongodb module

86417dd1d2-+-mail::smarthost: hiera -> lookup

52b4bcd7c5-+-etcd::v3: hiera->lookup

d6b65fa25d-+-mediawiki::php: remove code to absent mongodb module

839f6cf217-+-sentry: delete module and hiera keys

4ad828adad-+-wmcs.backups: replaces the image script with new one

9ceb9aaf21-+-Enable base::service_auto_restart for Apache/Yarn

f0923c073b-+-[wmcs][wikireplicas] Add haproxy to the proxy servers

8fcd50f136-+-Enable base::service_auto_restart for Apache/Hue

1043085ff3-+-Enable base::service_auto_restart for Apache/Hue on testcluster

6b618cc5d5-+-Increase default executor memory size to 4G in Spark Refine settings

f46100e738-+-cirrus: bump es shard size alert thresholds

abc9e7d757-+-mediawiki: remove mongodb PHP extension from appservers

ade9af544d-+-[wdqs] add jmx_wdqs_streaming_updater prometheus job

8ca57099aa-+-wdqs: default to using kafka for updates

b462a65a79-+-Enable base::service_auto_restart for Apache on xhgui

a59b881f9e-+-wikireplicas: Work toward a proxy setup on multi-instance replicas

45ac54fd53-+-snapshot: require_package -> ensure_packages

a0f36631f7-+-netbox: require_package -> ensure_packages

5dce1634e7-+-homer: require_package -> ensure_packages

1f275becf6-+-Remove 'reseachers' and 'gpu-testers' posix group from Analytics cfgs

819a8c5b95-+-Adjust refine_event memory and parallelism

9d566f2a01-+-eventschemas: Migrate hiera() to lookup() and setting datatype

c2e0fcabd9-+-Enable base::service_auto_restart for Apache on Thanos frontends

31827d4c02-+-iegreview: require_package -> ensure_packages

66ee5436af-+-Striker: replace requirement with libmariadb3

6b1adf45c6-+-add uz.wikimedia.org to wikimedia-chapter

de62f47ad5-+-cloudweb mcrouter config: use LatestRoute for read actions

4d932b3afd-+-cloudweb mcrouter config: use AllFastestRoute for write actions

d05d4908fa-+-Set fs.permissions.umask-mode for the Hadoop cluster

9fd787807b-+-cache: Migrate hiera() to lookup() and setting datatype

f33c669d3d-+-hive: Migrate hiera() to lookup() and setting datatype in metastore

6d9604b165-+-Enable base::service_auto_restart for Apache on Netmon

e3d1c3a173-+-nova-api: restart service if vendor_data.json changes

d3ceef691d-+-openldap::management: hiera->lookup

6e6ef62d2f-+-mariadb::maintenance: hiera->lookup

8f6ce0a193-+-cloud haproxy: refactor the various haproxy setups

2f9d512e97-+-Bump refine jar version to refinery-job 0.0.143

6708ab7b72-+-swap: hiera->lookup

0df9878632-+-dnsdist: allow custom headers in the HTTP response and enable HSTS

2548e51552-+-apt: audit_installed move to sbin

145606816e-+-sretest: test install_apt_audit_installed script

a3a50de75b-+-profile::base: add parameter to install apt audit script

a22e43a66e-+-apt: Create a script to detect manually installed packages

fa1b869f67-+-pupetlabs-lvm: update lvm module with latest upstream

40fe52248a-+-cloud: mail: smarthost: drop support for letsencrypt::cert::integrated

32ee94db28-+-Enable base::service_auto_restart for Apache/Nginx on debmonitor

c053bf94a0-+-openstack: add prometheus script to collect ceph usage network metrics by nova

3e7139b2b4-+-mariadb: Productionize db1155 as sanitarium

e82103780d-+-Nova: another attempt at getting vendordata properly injected

d843ce4e9e-+-mediawiki: Update path for AbuseFilter script (try 2)

fe07604662-+-Revert "mediawiki: Temporarily add alternative path for AbuseFilter script"

c68c110609-+-parsoid::testing: fix duplicate declaration of mariadb-client for buster

a94dc741a9-+-parsoid: include a generic mariadb server in testreduce role

25e2549ea6-+-parsoid/testreduce: install g++ on testreduce host

b877805597-+-mw maintenance: Install php-readline from component/php72

5877901c2f-+-profile::mail::smarthost: add acme-chief certs

90cf351593-+-mediawiki: Temporarily add alternative path for AbuseFilter script

295a221d6e-+-Add a rough account-creation script for acme-chief/LE

5eed5e6527-+-Add a job for TemplateData metrics aggregation

17d70a7ab3-+-Port elasticsearch/es-tool.py to Python3

b6d1a487c4-+-cfssl::db: use correct config

3e4d80509f-+-pki: add python db config file

728ffeef14-+-tendril: Migrate hiera() to lookup() and setting datatype

9c2d14c5f7-+-profile::analytics::database::meta: remove old alarm

3e0bdafd94-+-nova: puppetize the nova-api-metadata service

e33c35479e-+-Nova: move our injected userdata into vendor_data, where it belongs

f078180d96-+-Revert "Nova: move our injected userdata into vendor_data, where it belongs"

6e310f1aa1-+-Nova: move our injected userdata into vendor_data, where it belongs

8504a7adba-+-Nova: generate vendor_data from a puppet hash rather than a template

662b1092c5-+-openldap: use chained certificate for slapd service

a5665cb7e0-+-nfs: include python3-dateutil

5ec950ed1a-+-profile::wmcs::nfs::primary: include bdsync

c06b7b8ef8-+-profile::base::puppet: drop puppet/facter_major_version params

bdb33f78c2-+-Keystone: remove token_formatters-fixed.py backport

b4e36d4533-+-Keystone: use the keystone-wsgi-admin script installed by the package

039810a4e4-+-wikireplicas proxies: fix a couple errors in the config

238cb43386-+-Nova-api: add a puppetized api init script in Stein

76eb930a32-+-Cinder: add a puppetized api init script in Stein

0852adea23-+-Glance: remove glance-registry service from Stein deploys

9b45db84dc-+-Add OpenStack client package manifests for Stein

ef150beba0-+-Barbican: add service manifest for Stein

fb6979dd02-+-Neutron service manifests for Stein

b18c5fbb81-+-Keystone: Add Stein service manifests

eb956e53fa-+-Cinder: add Stein version of service manifest

a2b25be661-+-Glance: add Stein versions of manifests

114631f8eb-+-wikireplicas: set up VM haproxy layer

e68e6fadbf-+-Nova: Move some hard-coded rocky includes into version-specific manifests

68d0fee0ce-+-Nova: add Stein manifests

54ef6c1f59-+-haproxy: add a note about the $logging param

444ec6af52-+-klaxon: restart on pulling changes from git

30f58eddde-+-klaxon: git::clone ensure=>latest

456c59c3b0-+-Klaxon: needs gunicorn3, not gunicorn

e32b0db85d-+-Klaxon: correct pass port number to apache

c1c3c43efe-+-klaxon: tweak deploy path & fix dependency

10a8945139-+-Puppetization of klaxon, a webapp for trusted users to page SRE

a19adaa6fa-+-profile::pybaltest: move hiera keys to profile namespace

b6f7f1b39c-+-pybaltest: convert to role/profile, hiera->lookup

363edbf527-+-cirrus: bump es shard size alert thresholds

08609237aa-+-prometheus:node_exporter: hiera->lookup

522cd77593-+-puppet_compiler: hiera->lookup

b1327a7d7b-+-graphoid: hiera->lookup

33eb001da4-+-aptrepo: remove absented cron code, replaced by timer

943f6e0059-+-cloud nfs: make sure the /srv/scratch dir is there and another fix

59015d983d-+-aptrepo: replace cron with systemd timer

bb747a930a-+-Install php-readline from component/php72

06e0a04f82-+-Revert "labstore1004: move to 'insetup' role"

dc8aab223e-+-cloud nfs: get primary interface from puppet and create mountpoints

a91089b9e0-+-analytics::refinery::job::refine: Bump up refinery_version to 142

b02e9cff95-+-labstore1004: move to 'insetup' role

c82a734269-+-role::analytics_cluster::ui::dashboards: Add superset to an-tool1010

37b55c20c2-+-cdh::hive: don't use TLS for local db connections

a0becbcd1f-+-netbox: Fix typo in internal redis configuration

3afdde5703-+-netbox: Fix dependency loop introduced in previous patch

400798300c-+-Openstack galera cluster: move data to /srv

461ff2f55b-+-netbox: Adjust settings for supporting Netbox 2.9 series

70f7a8c002-+-Designate: filter health checks from Kibana logs

83540f1d6b-+-sqoop: Ensure /tmp/sqoop-jars/ is present

1a5b3f7b02-+-kubeadm and paws: tuning options for stacked control plane

9fd7d2e088-+-rdb1011 install params

4dd6179523-+-etcd: make snapshot interval configurable

851ab5f3b4-+-puppetmaster: dont't install puppet master as we use puppet-master-passanger

895ea7842d-+-[wmcs][backups] Add project and vm info

2d42a20339-+-mariadb: Decommission es1013

c8e7f64797-+-druid: Migrate hiera() to lookup() and setting datatype in middlemanager

00b64b7aff-+-druid: Migrate hiera() to lookup() and setting datatype in middlemanager

67ac61103d-+-site: apply doc role on doc2001 and unify role stanza

dfdcc5acb3-+-site: apply doc role on doc1002

6e824ab7b3-+-etcd: add data types, replace hiera with lookup

d8bc435377-+-doc: don't include envoy when in cloud, allowing tests

3b8177fc59-+-Revert "Change labstore1005 to role(insetup) so that we can log in"

80ad397324-+-Change labstore1005 to role(insetup) so that we can log in

02683c6984-+-druid: Migrate hiera() to lookup() and setting datatype

6f799e437b-+-Add a job for some visualeditor metrics aggregation

dd3bccbeba-+-site: add doc1002 and doc2001 with insetup role

bfbb63cf1f-+-Add mw-cli to the releases server

8eac157e2d-+-profile: deploy filter_scripts directory to logstash 7 collectors

edf6aab8f0-+-profile: identify network devices logging input

baf8cc18bf-+-kafka: add remaining nodes to kafka test cluster

21296065bd-+-bacula: remove unused srv-docroot-org-wikimedia-doc

bdd80935fa-+-doc: remove legacy doc directory

abe7996689-+-doc: unconfigure legacy backup::set

68ea44f5f5-+-doc: relocate published documents to /srv/doc

9d395910d0-+-druid: Migrate hiera() to lookup() and set data type in monitoring

7029eabe6c-+-maps: increase retries on postgres alert

f766c224aa-+-icinga/prometheus: add notes_link to puppetboard to puppet failure alerts

5d7842517c-+-config-master: add envot tlsproxy config

fe3969b0ee-+-httpd: just empty file don't remove it as its included in apache.conf

c821f26c00-+-puppetmaster: remove default apache ports from puppetmaster

f0c53567b5-+-httpd: Add abbility to remove the defauls ports configueration

8ada301369-+-P:configmaster: Us ipaddress6? fact instead of DNS

eeafeefecb-+-P:configmaster: add abuse networks to NDA folder

f3f90d88f4-+-Restore puppet roles for the Hadoop test cluster after reimage

cc98421afb-+-config-master: nda folder use html readme file

908ca0d2ad-+-configmaster: move pybal-config to an aliase and config-master to vhost

f029b642f4-+-config-master: created and NDA protected directory on config master

5a4c0c4aa9-+-idp: make sure we purge un managed services

3ecf452397-+-Prepare the Hadoop test cluster to be reimaged with Cloudera's CDH

66a12e6646-+-phabricator: update RemoteIPInternalProxy with correct IP address

7e75cf7d64-+-mariadb: Decommission es1019

f9283f11c2-+-parsoid: All profiles use_php=true, remove parameter

40236eb474-+-mediawiki/jobrunner: create beta role, remove hiera lookup

438f345246-+-icinga: use ensure_packages for all packages and move to top

3ffd4c415a-+-toolsdb: set the rsync script to be the whole data dir

5cd2b2c6bf-+-Add a job for CodeMirror metrics aggregation

07e2b7c447-+-kubernetes::calico: Switch to useing calico-kubeconfig

04b99d7f92-+-network: add phabricator context for abuse nets

d2a5a11789-+-dnsdist: respond to qtype=ANY queries with NOTIMP

5eff8e4460-+-mariadb: Add db1154 as a temp sanitarium

db30ba0dfc-+-toolforge: upgrade sssd patch version

37a537a339-+-puppetmaster: remove absented puppet-wildcardsign

a0a268a163-+-puppetmaster: remove absented ganglia-gen and sshknowngen

b1346e0990-+-puppetmaster: remove absented logrotate conf

0634a39454-+-site.pp: Clarify the situation with db1154 and db1155

5ed94330c6-+-site.pp: fix definitions for pki servers

1396cbe376-+-keep fewer cirrussearch dumps on the internal dumps servers

7dea193615-+-[wdqs] proper selector for machines running the streaming-updater (take 2)

5099fda4e3-+-mariadb: Add eqiad x2 hosts

e99d9f6c33-+-httpbb: add tests for parsoid servers

c32c69f06f-+-puppetmaster: require_package -> ensure_packages

62b8f1e7b3-+-icinga: require_package -> ensure_packages

322a95d3cf-+-cfssl: only install ocsp refresh app if ocsp resource defined

eea0f94a24-+-cfssl: update ocsp refresh to work on multi master

1d2f80cb62-+-prometheus: collect zuul error mtail metrics

44721f25f6-+-profile::presto::client: allow to customize the kerberos ccache path

5fcce18690-+-categories: fix prom exporter's broken namespace

007d4033d5-+-jenkins: support changing $JAVA_HOME

8f467a22d3-+-Remove apache config for zero.wikimedia.org

b351e9bbb9-+-puppetmaster: remove code to remove crons, replaced by timer

852810c3ca-+-doc: allow changing WMF_DOC_PATH from Hiera

43a116c95c-+-calico-typha: Allow 5473 from kubernetes nodes

00b9938644-+-kafka: Add kafka-test1008 - 1010

ad1dff97c4-+-profile::swap: allow to override the kerberos credential cache location

0341bb37c7-+-mjolnir: Migrate hiera() to lookup()

1ac7c5b327-+-cfssl::ocsp: use correct flag for responses file

fc6fe2834f-+-P:pki::server: fix typo proto != protoc

740b0e7ae3-+-P:pki::server: open firewall

307b86afb6-+-pki: enable pki1001

f6c8445f76-+-mariadb: Add codfw x2 hosts

59c7efb379-+-kafkatee: Migrate hiera() to lookup() and set data type

0c286c372d-+-mjolnir: Migrate hiera() to lookup()

51948e019c-+-Glance: remove the glance_image_dir param

9c53f95fbb-+-Remove obsolete glance image_sync code

289d4fa9c8-+-Glance: make glance active/active in codfw1dev

f8f9054610-+-Cinder: include custon resource_filters.json file

1440b297b1-+-httpbb: add missing directory for doc tests

415616c373-+-httpbb/doc: add tests for doc.wikimedia.org

f26d6f8960-+-toolforge: make timeouts for our slow etcd clusters configurable

743ab6288e-+-Do not refine HomepageVisit using eventlogging_legacy job

f067fb7ea2-+-puppetmaster: ensure previously used cron is properly removed

8b215cee88-+-Refine Growth schemas using eventlogging_legacy job

060d745248-+-puppetmaster: run "remove old reports" job as root

33a18d2c8e-+-puppetmaster: replace cron to remove old reports with systemd timer

a528d22434-+-Glance: increase priority of rsyslog filter

a4a6541449-+-Cinder: Fix syslog filter of health checks

59c4c10e68-+-Add ml-serve200[1234] to site.pp

21d633867a-+-k8s::apiserver: Allow setting allow_privileged

36a0cac958-+-kubelet: Remove --allow-privileged

c46543bdfb-+-kubestage2*: Assign role

3ae9e71f79-+-calico: Move calico-cni package inclusion to main class

b4cb5ceda4-+-profile::kubernetes::node: Remove old redundant code

8842377402-+-rbd_libvirt: fix installation of the cinder ceph secret

625d243365-+-nova-compute/cinder/ceph: add a cinder-specific ceph uuid

bc01683b3d-+-arclamp: add CORS header and clean up modules

0e5a8f1081-+-webperf: require_package -> ensure_packages

6ea3e7329e-+-poolcounter: require_package -> ensure_packages

1b019f35f1-+-wikimania_scholarships: require_package -> ensure_packages

d5cd2bcf27-+-otrs: require_package -> ensure_packages

06efa826ef-+-ntp: replace hiera() with lookup(), move use_chrony to parameters

a2bef436bc-+-calico: Add support for calico 3.x with kubernetes datastore

a434081421-+-Add kafka-test1007 virtual machine

a521331a72-+-Add bigtop15 component for Analytics

2ac5af5b79-+-Add group wikibase-releasers & folder

0a82211a88-+-redis: define redis version on buster for multidc

7a98523cba-+-Add a second Hive Metastore on an-coord1002

a3bf877a1b-+-wikistats: fix file name of db dump script

7ceb619fe1-+-wikistats: use script and separate config to dump mysql from timer

72a056bf7f-+-remove zero.wikimedia.beta.wmflabs.org from beta sites

cf8e94d64d-+-query_service/updater: replace hiera() with lookup()

6f7e503457-+-icinga/raid.pp: Add Python3 requirements for raid_handler.py

c581014f31-+-parsoid/testreduce: ensure make is installed on testreduce host

ea30a43011-+-site: update comment about location of mw1281-mw1283

dbd45704a3-+-Cinder: include cinder-volume service on control nodes

7a90e0584c-+-Cinder: fix keystone auth for the cinder service user

10294c8fa5-+-Cinder: no need to restart apache2 when config changes

2ad79b4027-+-superset: add cache to staging superset

1e8966f07f-+-Cinder: use the deployment-wide libvirt_rbd_uuid for cinder

2fca3fb691-+-Cinder: install ceph client keyring

4c618ea19b-+-hive: force TLS from the Metastore to the db-host when needed

a9fb960cbb-+-prometheus::k8s: Support arbitrary clusters

0c90572193-+-maps: increase replication lag tolerance further

7e925d63d3-+-Remove "idp" backup file set and drop backup host profile from IDPs

59706e105b-+-racktables: add trailing semicolon

aad91b02e6-+-racktables: update correct file

1e8e58e194-+-racktables: Make everyone admin

59e3dd1216-+-spec: add and use parallel sec which seems to give a boost to run time

458e68e41b-+-Include glance/ceph image backup job in codfw1dev

7c95d6c4b5-+-Ceph: allow controller nodes to be specified per DC

0ba8d81282-+-Cinder: add rabbit hostname/password to config

1ecd10a88e-+-Cinder: correct some config settings

1190d5ef76-+-Cinder: create cinder group as well as user

6ffe1308f0-+-Cinder: create cinder system user before package install

d9fddbba87-+-Pass ceph_pool name from profile to module

4725fb7b24-+-Pass ceph_pool name to deployment-specific cinder profiles

e746d7a265-+-Initial cinder class and templates

c7f29a209e-+-profile: add logstash ecs 1.7.0-1 template

4c84dbe54d-+-Schedule maintenance script for prioritising images for CAT

cb0fd5ada5-+-scap::sources stop assuming mediawiki/services as a prefix

2715242748-+-recommendation-api: Cleanups

2012d64373-+-alertmanager: add custom email template

96cb83e0e8-+-wikistats: double-escape $ and % in systemd timer commandline

8d554792ae-+-profile: make a logstash templates directory and relocate existing templates

af50e46836-+-wikistats: replace all cron jobs with systemd timers

c283b3308a-+-apt::repository: require_package -> ensure_packages

9093b09635-+-gerrit: require_package -> ensure_packages

12c411769b-+-ipmi: require_package -> ensure_packages

2aa80819d7-+-deployment_server: require_package -> ensure_packages

96dc504126-+-mw_rc_irc: require_package -> ensure_packages

802e487a80-+-maps: fix typo in postgres command, retry 5 times before alerting

ca8a254769-+-Remove calico::builder

ed5a345299-+-Enable CAS for RT

3787eb636d-+-presto: Migrate hiera() to lookup()

13de05b817-+-Glance: add a hiera setting for the glance ceph pool

4d4c649284-+-Glance: fix copy/paste mistake in logging class name

fc970f2195-+-Revert "[wdqs] proper selector for machines running the streaming-updater"

d28a0b0993-+-[wdqs] proper selector for machines running the streaming-updater

98977fb6de-+-(WIP) CFSSL::ocsp refresh: add systemd timer

95c636da54-+-openstack: Enable support for nested VMs

8a94fe4b4a-+-realm: replace hiera() with lookup()

89cdf717ec-+-mediawiki: replace hiera with lookup, add data types in all profiles

b703d19d8d-+-kafka: make alerts not critical for test cluster

e82e79b87b-+-Codfw1dev cloudcontrol nodes: remove redundant ceph definition

af0c21810b-+-Glance: enable rbd for glance in codfw1dev

968ded6706-+-profile::kerberos::client: improve the user experience with kinit

624bc6fdb8-+-cfssl: comment out timer as it causes puppet compile to hang

7ead35a350-+-cfssl::ocsp: add description to timer

e36f902268-+-Cloudvirt2001-dev make a ceph-backed hypervisor

1aaccac3b6-+-cfssl: add ocsp refresh timer

7b41e57698-+-cfssl: move ocsprefesh to a timer

c1148e4ef8-+-cfssl: add ocsp refresh script and timer

585f5ff06c-+-k8s: Partially revert the removal of chained certs

3ab551e309-+-kubernetes::master: Don't create the chained cert

64613656b4-+-k8s:apiserver: Manage kube user/group

1f248b88dd-+-deployment_server: Add k8s-staging-codfw

bf8a8f8e49-+-pki: dont purge responses dir

395cd42b4f-+-ki::server: add ocsp proxy

d594fb580d-+-analytics::refinery::job::data_purge.pp: Fix netflow typo

99b45ad963-+-Move bsd-mailx (providing mail(1)) to standard packages

77a3c6bc58-+-dumps::generation::server::statsender: Drop OS check

91348e4bfc-+-profile::hive::client: rename parameter

fb68d241b5-+-wikireplicas: let clouddb1020 join the party

8e93cab119-+-Make cloudvirt2002-dev ceph-enabled

4e7d5c9aad-+-Add kafka_test and zookeeper_test clusters

9aeea5980e-+-ores: move LB setup for cloud from role to profile

4169c61485-+-Add kafka-test1006 as start of test kafka cluster

25fcd21c52-+-analytics::refinery::data_purge.pp: remove netflow automatic deletion

c2d5cbfe0c-+-wikireplicas: extend maintain_dbusers to multiinstance

7b8fd91c3b-+-superset: Migrate hiera() to lookup() and setting datatype

79c00d1691-+-wikireplicas: add maintain-meta_p only to s7 and legacy replicas

7d5d7f8e41-+-openstack: l3 agent: refresh conntrackd configuration

d7eabe4949-+-labstore::nfs_mount: drop support for empty string share_path

a668bc2d86-+-labstore: add data types and some other style fixes

571f51e238-+-scap-helm: Remove the last vestige of it

e74adf2308-+-profile::kubernetes::node: Remove toolforge customizations

a23ba8879d-+-profile::kubernetes: fold infrastructure_config to profile

c13f7e746b-+-k8s: Remove default values for some parameters

bcda103a0c-+-add configuration for puppetdb cleanup TTLs

97d057df20-+-superset: add cache to an-tool1010

89c8907142-+-CAS support for debmonitor, step 1

353daee5cb-+-Revert "Move s-nail (providing mail(1)) to standard packages"

86573d1521-+-Move s-nail (providing mail(1)) to standard packages

fa6b244f3d-+-hive: force the hive server to use the local metastore

de06e7827d-+-hive: use an explicit parameter to deploy jdbc settings

b331af27e1-+-profile::prometheus::ops: add monitoring for zookeeper test

a06ea802f7-+-site: assign roles for all ms-be / ms-fe hosts

946aca4cca-+-hadoop: Migrate hiera() to lookup() and set datatype

2bd3a070ba-+-mailman: replace cron with systemd timer and move to profile

97709ebd20-+-wikireplicas: extend maintain_dbusers to multiinstance--test 2

0f09ccd45a-+-wikireplicas: extend maintain_dbusers to multiinstance replicas

1e26269b84-+-Revert "wikireplicas: extend maintain_dbusers to multiinstance replicas"

8139384ab3-+-wikireplicas: extend maintain_dbusers to multiinstance replicas

7bc16ddc34-+-httpbb: Add test_suites for the new files

72d2647d74-+-httpd/simplelamp2: add parameter to not purge manual config

a73a92cfe6-+-apt:package_from_component: Fix the ordering relationships

cf523d7aa3-+-httpbb: Remove httpbb::test_suite for baseurls.yaml

01e7fdfb05-+-Add {calico, kubernetes}-future components to buster

446b643b86-+-package_from_component: Move to ensure_packages

6e19979307-+-k8s codfw staging: Assign role to node

e9255f0653-+-zookeeper: configure test-eqiad single-node cluster

6f84e7003d-+-mirrors: use 'mirror' user instead of root for periodic jobs

5e8be6cc63-+-mirrors: use "1h" instead of "hourly" for interval

a6277a84e3-+-analytics::refinery::job::druid_load.pp: add fields to netflow long term

14afe7a49c-+-analytics::refinery::job: Bump up jar versions for netflow

9eb2426ddc-+-analytics::refinery::job::druid_load.pp: correct druid_datasource param

6ac62bdd44-+-analytics::refinery::job: Move netflow to event database

165f47f4d0-+-Revert "systemd: add validate command for unit files"

15b4f9c775-+-conftool: replace hiera() with lookup()

05ac1adf35-+-helm: Split repo update in 2 systemd timers

45b92a0d54-+-turnilo: add export mappings for network devices via query_resources

6b7f98ce8a-+-Enable kerberos in kerberos::systemd_timer by default

e6e626d5f8-+-systemd: add validate command for unit files

982b347fa9-+-mariadb-backups: Rename snapshoting systemd unit to avoid underscores

ca9be3dcfb-+-Revert "mariadb-backups: Rename snapshoting systemd unit to avoid ..."

bd76a0e8d9-+-mariadb-backups: Rename snapshoting systemd unit to avoid underscores

ff746da3ea-+-kerberos::exec: enable kerberos by default

2b68f5a64e-+-prometheus: collect ci master hosts

6f240892df-+-openstack: l3 agent: fix conntrackd hiera configuration

3fa6fa6d68-+-Add new ms-be nodes to site.pp

36eb68176f-+-k8s: Allow using cergen

0a08b43634-+-k8s: replace hiera with lookup

e200cc9ead-+-mariadb: Cleanup old cron deletions after some time after deploy

2c8bf787c9-+-cloud: add conntrackd for better neutron l3 agent failover

aa38bdd6b2-+-k8s::master: Remove redundant has_lvs hiera check

acf29e8db0-+-Revert "Remove Hiera option to enable adduser config"

0d76600163-+-Fix typo in Ubuntu mirror timer

d2f7ba0b4b-+-Remove Hiera option to enable adduser config

c3fe2d29a1-+-mirrors: replace cron jobs with systemd timers

4e915ee19a-+-mediawiki::common: hiera -> lookup, add data types

e3b060562c-+-Add data types to openldap class

9fb7290e62-+-maps: remove no-longer-accurate insetup role

489657251d-+-maps: remove no-longer-accurate insetup role

97c0937123-+-chartmuseum: Install helm3

592de1ba62-+-swift: parametrize rsync max_connections based on backends

ad937b6d39-+-mariadb: Decommission es1017

ce8057478c-+-Make clouddvirt1030 a ceph-enabled hypervisor

e4792f441d-+-Add kafka-test1006.eqiad.wmnet virtual machine

4e54c1a222-+-thumbor: move thumbor mediawiki role to profile

9d7066847c-+-Configure zookeeper-test1002.eqiad.wmnet

2c09a6dae1-+-cirrus: alert on pool counter reject spike

286dea1c72-+-site: add deploy2002 and unify deployment server role regex

ec213114af-+-deployment::server: buster support, use default-mysql-client package

0091c86124-+-delete the drac module

41b401b646-+-Extend PIL Python package with Python 3 counterparts

c9c03a388f-+-cloudvirt2003-dev: move to ceph-enabled virt role, add ceph hiera elsewhere

706161e114-+-analytics::refinery::job::druid_load.pp: reduce netflow retention

91e76ad344-+-Keep EventLogging SpecialMuteSubmit on old system for now

23b5c8359f-+-Revert "Port elasticsearch/es-tool.py to Python3"

c798d837c8-+-ci: add prometheus exporter for Apache

6e98bd7cf9-+-Port elasticsearch/es-tool.py to Python3

1bebbbc539-+-wikireplicas: Upgrade maintain-meta_p.py to python 3

b9a53043d9-+-alertmanager: fix cluster config out of sync alert

aff0c0c86e-+-mariadb: Decommission es1018

2c969d1d09-+-valid_section: Add x2

a3a3e864f0-+-bacula: Move logs to /var/log/bacula

81b644fbf8-+-oozie: improve log retention and cleanup

0254fe8eb7-+-hadoop: Migrate hiera() to lookup() and setting datatype in spark2

f1249e8129-+-Add db214[234] and logstash203[345] to site.pp

d5e7deb067-+-wikireplicas: modify views scripts to work on any replica style

b5020f3f55-+-thumbor: Migrate hiera to lookup

ab4aee2b2e-+-mediawiki:deployment_server/beta: replace hiera with lookup

756c2d1ca3-+-enable page content batches for wikidata xml/sql dump run

226a3a249d-+-P:pki::server: use the correct CA certificate and add ocsp_port

dd3dbd12da-+-P:pki::server: use safe_title for the label

92b9c8476d-+-P:pki::server: Use correct host name

8202c4e980-+-profile::pki::server: enable ocsp service

b385b6eac8-+-cfss::ocsp: move ocsp service to its own resource

9e7224c21a-+-Refine 2 Anti-Harassment schemas using eventlogging_legacy job

05d7b91c3d-+-P:base::labs: use fq path

cef2609324-+-profile::hive::client: make DBTokenStore the default

61d21fed03-+-Roles and hiera for codfw1dev ceph cluster

0407a3baa9-+-C:apereo_cas: drop support for managing the user

b30dfb9f4a-+-P:idp: remove the concept of a primary and a secondary

84f53bb86b-+-P:idp: drop support for json devicie storage

46238a730c-+-systemd::timer::job: Ensure all commands are fully qualified

47f7e2b7f4-+-gerrit: use fully qualified path

c8b75e0822-+-Use CAS for Racktables

f8d110702b-+-cloud: kubeadm: refresh version defaults

7ef6f920b1-+-P:mariadb::backup::transfer: use full path in systemd unit

6c90a27f9e-+-kafka: Migrate hiera() to lookup() and setting datatype in monitoring

977b4c0b67-+-k8s::apiserver: Follow the other components config pattern

4d02dd4f07-+-k8s::controller: Define --logtostderr=true and --v=0

2e8b6744a0-+-k8s::scheduler: Define --logtostderr=true and --v=0

3b4d854137-+-k8s::kubelet: Define --logtostderr=true and --v=0

48496e588a-+-k8s::proxy: Define --logtostderr=true and --v=0

e4732098d4-+-atsmtail: make systemd unit depend on fifo-log-demux@

6cdfc17757-+-Systemd::Servicename: add '@' to Pattern

184e4c0ee7-+-Correct analytics pageview_actor data purge

b34fa3714f-+-mariadb: Decommission es1015

ce203e3bbf-+-pki: allow more flexible profile config and add test intermediate

bab6735846-+-cfssl: force removal of unmanged resources

cc120ca571-+-pki: correct path

22071b06f0-+-pki: fix certificate location and mysql tls options

b5093dda52-+-pki: provide content for intermediate certs

a53f2b8a00-+-pki: allow ability to provide key material content for intermediates

b8fd0a3081-+-pki: enable mysql TLS

357b94562e-+-pki: use only one db config for multirootca

15e2c1dd1e-+-cfssl: move cfssl::db to its own define

2150184a19-+-mariadb: Decommission es1016

e5d096c96c-+-helm: Fix environment syntax in exec

ad4c579327-+-helm: Add helm3 support to helm module

6e73966a13-+-puppet_compiler: switch to python3

717f280398-+-profile::hadoop::spark2: add log4j.properties to puppet

8a6cf7f04a-+-Revert "puppet_compiler: switch to python3"

a53347c961-+-puppet_compiler: switch to python3

99971f06e7-+-Introduce kubestage codfw machines

af7e01f9d6-+-openstack: neutron: drop apt proxy configuration

c44045c146-+-elasticsearch: Add per-index metrics

a205b32ad6-+-codesearch: Adjust write-config job to restart services

e3423c8627-+-mariadb-backups: Make sure mydumper and xtrabackup are installed

d684269d81-+-mariadb-backups: Use new stats-file option, preventing password logging

aca8d67f5a-+-sretest: Fix class name

ebdc6d429f-+-kafka: Migrate hiera() to lookup() and set data types in main

d24cc602ee-+-Increase refinery jar version requirements for Hadoop test

9e5ca4185e-+-analytics::refinery::job::druid_load.pp: Add fields to wmf_netflow

fd1f5fa10d-+-profile::mediawiki::videoscaler: Add Support for Buster

25228fb5d2-+-Remove obsolete absent for /etc/apt/preferences.d/php_wikidiff2.pref

b56950f38b-+-ping_offload: hiera->lookup

79a5fd5bbd-+-OpenStack Keystone: update mode for fernet key directory

e59da0961d-+-OpenStack Glance: filter out health check log messages

b529c18cb3-+-cfssl: unwrap sensetive values before use because PUP-8969

2a5af130fd-+-P:pki::server: try testing sensitive type

522008fdd5-+-Move cloudcephosd2xxx-dev from .wikimedia.org to .codfw.wmnet

519df58383-+-varnish: Migrate hiera() to lookup()

856cdc8969-+-pki::server: add db_config to all signers

19de8cc97a-+-Rename cloudceph200x-dev to cloudcephosd200x-dev

51d638fae6-+-P:pki::server: enable support for mysql DB backend

4ef0ee82a3-+-idp - db: update firwall rules to add idp.wikimedia.org sources

8ae49aeb4a-+-kafka: Migrate hiera() to lookup() and set data types in broker

c4eb727e38-+-maps: add maps100[5-9] and maps1010

8d80ef9169-+-hive: set session token handling via database for Hadoop test

b8302d4cd2-+-Revert "Revert "Purge remove apt-listchanges""

ba4d92d097-+-Stop installing timidity and freepats on appservers

2ee95d6aa5-+-Also apply the PHP 7.2 component for Buster

537d119676-+-toolforge: avoid transitional package ttf-alee in favor of fonts-alee

9654c961e4-+-Avoid transitional package ttf-wqy-zenhei in favour of fonts-wqy-zenhei

2c0465d711-+-mediawiki: Use python-pil on buster

2126ba1baf-+-mediawiki::php: fix hardcoded stretch dist name for PHP 72 packages

2cf49e30ed-+-cumin: add the kerberos-kadmin alias

af63aaae97-+-profile: fix dashboard links for thanos query-frontend alerts

d36ad98cb4-+-standard_packages: Remove more obsolete packages after stretch->buster update

8a7b388258-+-site: add a note re: ms-be and role swift::storage

3eb6c9cf6d-+-mariadb: Make innodb_change_buffering configurable

1bf8f0a9c1-+-Add ms-be106[0-3] to swift::storage

1e7ff68039-+-thanos: add query-frontend alerts

921ed84e4b-+-jobrunner: add SERVERGROUP environment variable

c7e7f109a1-+-mariadb: Decommission es1012

960f39788b-+-OpenStack Designate: updates for version Stein

8c49316050-+-OpenStack: add client packages for Stein

5df09669ee-+-OpenStack: add server packages for version Stein

2f2d851b31-+-Revert "delay start of monthly run half a day to finish up wikidata run"

dab59234ea-+-mediawiki::php: allow opting-in to use the PHP72 component on buster

6fcb3e3b2d-+-nfs monitoring: remove the old paws path

49b919f8f8-+-mediawiki::nutcracker/mwlog: hiera -> lookup

946c10b711-+-mediawiki::scap_proxy: hiera -> lookup

74e54578a1-+-ores: Migrate hiera() to lookup() and set typehints

2bdf681ad1-+-mediawiki::webserver: hiera -> lookup

67ea185996-+-tcpircbot: require_package -> ensure_packages

8d16ef66f1-+-docker_registry_ha: require_package->ensure_packages

3477a29efb-+-smokeping: require_package -> ensure_packages

e486621e21-+-gerrit: fix name of new data type for AuthType

d5d2c172f7-+-Add mwlog2002 to site.pp

ec53060a04-+-Add zookeeper-test virtual machine

b09259c57c-+-aqs: Migrate hiera() to lookup() and set typehint

a225b994ee-+-Rename labtestpuppetmaster2001.wikimedia.org to cloudcephmon2003-dev.codfw.wmnet

64232284dc-+-Revert "Purge remove apt-listchanges"

247ccfbe85-+-alytics::refinery::job: build simple script inline in puppet

6e23536b6e-+-TLS unified public cert: remove expiring gs-2019

2172269e7b-+-sretest: drop P::docker::firewall as it requires buster

b47172885a-+-package_builder: Switch to ensure_packages

636897bba3-+-Purge remove apt-listchanges

0989379659-+-Remove analytics10[42-50] from puppet (decommed)

9761c2045d-+-delay start of monthly run half a day to finish up wikidata run

3016d4d0b6-+-cirrus: re-enable saneitizer

0c9f4dc017-+-kibana: add enable_warnings flag and disable warnings for role::logstash7

33bf95fd45-+-gerrit: Add custom puppet type (Gerrit::AuthType)

b480736f92-+-puppetmaster::frontend: increaes time out and only check once per day

7ea895cf86-+-Add dhcp file and site.pp entry for new ms-be106[0-3]

090517591c-+-Add log filter for Openstack/Oslo log messages

e208a317af-+-P:puppetmaster::frontend: fix check install

ec51ba25d7-+-puppet ca: cert monitoring

5d5bc6979a-+-authdns: monitor for exactly 1 gdnsd running

d44130863e-+-Add cloudcephmon200[1-2]-dev to site.pp

40d0246088-+-standard_packages: Remove more obsolete packages after stretch->buster update

1e6a6bcc28-+-idp: add cors_allow_credentials parameter

23d02a814f-+-mariadb: Decommission es1011

d5487f35eb-+-profile::base::puppet: update parameter to use arrays instead of strings

a71d904a52-+-Remove unnecessary hiera 'use_kerberos: true' settings

f9c339b5f5-+-openldap: Stop using require_package()

f457f539e4-+-profile::base::linux419: Move away from require_package()

80ea870dfc-+-debmonitor: Move to ensure_packages

8c456551a8-+-mariadb: Decommission es1014

8b6ed4355f-+-parsoid: add data types

31e70cb6f2-+-Revert "Revert "certspotter: temporarily disable cron job""

83ab0c9bd0-+-mediawiki/memcached: stop using role inheritance

1900b43c12-+-site: update locations for mw1317, mw1318

ead467d4f3-+-refine netflow - put spark_extra_files as spark opts, not job config

9dc52c622d-+-analytics::refinery::job::refine.pp: Add transform function to netflow

3f3ff0617a-+-Cloud NFS: remove the load alerts

54a72f34b0-+-Revert "certspotter: temporarily disable cron job"

2fa98a5460-+-site: add canary appserver role on mwdebug1003

e47a98d5ce-+-cfssl: ensure service is refreshed correctly

ce1c7a2fb4-+-cfssl::multirootca: add db support

f32fda489e-+-Revert "Revert "kerberos: set dns_canonicalize_hostname = true for krb1001/2001""

67a7130077-+-an-tool1010 setup

324fdc4d41-+-Revert "kerberos: set dns_canonicalize_hostname = true for krb1001/2001"

855d6668e9-+-kerberos: set dns_canonicalize_hostname = true for krb1001/2001

41cdf43d9e-+-fetch maxmind geoip daily instead of weekly

ca796661cd-+-authdns: copy geoip data rather than symlink

bf9b0c60f4-+-bacula::client: notify service after installing certs

48965d402e-+-cfssl::cert: fix (re)sign command

7d7fb13984-+-cfssl::cert: fix (re)sign command

9721b9fe15-+-aptrepo: add elastic710 component

047d0912a9-+-alertmanager: add aliases for API vhost

a342359d7d-+-ores: Drop all precaching puppet roles for labs

da8f8c0810-+-Bring 3 new eqiad wdqs nodes into service

11e7e2fcc0-+-planet: let systemd timer for each language run at random minute

3470e79afb-+-planet: adjust update timer to be based OnUnitActiveSec

e8f4ace7ed-+-peek: don't change permissions within a git repo

85033c4cb3-+-OTRS: replace cron with systemd timer

a57ec9fb4d-+-git: replace require_package with ensure_packages

d036cefbf8-+-cumin: remove code for absented check aliases cron job

e8bdc897af-+-httpbb: replace require_package with ensure_packages

52b4779b50-+-noc: replace require_package with ensure_packages

4449eb08b6-+-iegreview: replace require_package with ensure_packages

73f9900d84-+-mailman: replace require_package with ensure_packages

113b6ca9a8-+-aptrepo: replace require_package with ensure_packages

6d2a4b5108-+-FIX typo on rdb2010

6886e7ddf1-+-Add rdb200[9][10] to site.pp

a98c041feb-+-OpenStack Nova Compute: configure libvirt_cpu_model from hiera

f457acc685-+-webperf: convert statsv to use Python 3

a464d2520a-+-coal: use Python 3

65e98cf4aa-+-arclamp: Use Python 3

caaec3a93c-+-webperf: change navtiming to use Python 3

e12e196928-+-Install emacs-nox on deployment servers

ec6e6ab521-+-site: introduce mwdebug1003 as debug server on buster

d0e066f168-+-Update eqiad OOB IPs

0acaff2f72-+-profile::analytics::database::meta: set readonly depending on status

b2a5b6a6ce-+-Remove DB init scripts for hive/oozie

89a0e7d52b-+-Revert "puppetmaster::ssl: fold puppetmaster::ca_server into puppetmaster::ssl"

eeb1222255-+-Special docroot for thankyou.wikipedia.org

479297cff4-+-alertmanager: add more correct types for apache require

62a25afc39-+-puppetmaster::ssl: fold puppetmaster::ca_server into puppetmaster::ssl

7f672d781a-+-configure digicert-2020 certificates

e4bfe1c5e1-+-alertmanager: vary apache access config based on type

f38bffb5ab-+-role::analytics_cluster::coordinator::replica: add meta db instance

bd67e36be5-+-role: add Alertmanager API profile

739dbea762-+-profile: add Alertmanager API virtual host

d0dadf7efb-+-P:lvs::realserver: only sintall python3-poolcounter on > jessie

dab89b4816-+-wikireplicas: set up site.pp and hosts hiera for new servers

55e6c06212-+-Revert "Revert "ores: absent icinga monitoring of labs nodes""

bd3f090110-+-cumin: replace check-aliases-cron with a systemd timer

a180132456-+-Revert "ores: absent icinga monitoring of labs nodes"

a017ea05ee-+-ores: absent icinga monitoring of labs nodes

a3124b0185-+-ores: temp. re-enable icinga monitoring of labs nodes

b42b04dd03-+-Revert "icinga: Drop ores.wmflabs.org monitoring"

91693c8d0e-+-planet: replace update cron jobs with systemd timers

580f983bd7-+-icinga: Drop ores.wmflabs.org monitoring

2e88687c45-+-releases::mediawiki: do not attempt to restart masked service

b74ed1fde0-+-prometheus::mysqld_exporter::instance: drop arguments paramteter

1828ba5c0b-+-apereo_cas: dont restart tomcat on the active node

1f93ce56ee-+-P:idp: add paramters to control CORS

850fae2789-+-mariadb: use correct number of args

2e30fc53ca-+-swift: split memcached servers and port

e3177a3fdf-+-mariadb: migrate to ensure_packages and minor refactor

b1ad3183f5-+-P:tendril::webserver: migrate to ensure_packages

f4e821b017-+-prometheus: limit gerrit polling to codfw/eqiad

bfbb95b210-+-mariadb: Productionize es1032-es1034

812f9a04fc-+-profile::prometheus::analytics: remove hive_test target

7c06f41aa4-+-profile::prometheus::analytics: change target class for hive

3a1cd004d6-+-cloud-vps: Change NFS mounts to default to false

e00bfb67d6-+-toolsdb: set up quickcopy to move the dump

02c03f5353-+-Replace 'codname' with 'codename' in several places

d1ba54a7f1-+-hiera: add parameter to enable access from hosts and add grafana

4e01aa74aa-+-apt.unattendedupgrades: use apt::conf

9d227966cb-+-prometheus: collect Gerrit internal metrics

e41a06b74c-+-ores: Stop memory reporting

8d70585fda-+-P:mediawiki::common: migrate to debian::codename

903a90c683-+-P:base migrate to debian::codename and ensure_packages

f6157d0e0c-+-mariadb: migrate to debian::codename

daf4d7960f-+-nginx: drop condition for ge jessei as it matches all nodes

bdc30db010-+-P:base: migrate to debian::codename and ensure_packages

c539f7a259-+-Introduce role::analytics_cluster::coordinator::replica

ead3d42166-+-P:toolforge: migrate to debian::codename

0b1673ac14-+-P:tendril::webserver: migrate to debian::codename and ensure_packages

70421cb23e-+-debian::codename::require: update code to use new debian:: functions

db324a5556-+-debian::codename::requre: allow passing a custom message to require

68f92fffb8-+-mcrouter_wancache: tune onhost memcached

3e7e281eaa-+-role::analytics_cluster::coordinator: reword docs and remove unused bits

6918d36223-+-Add deploy2002 to site.pp

283a163e80-+-[apt::conf] Allow passing integers as value

29bc988708-+-Nova check_flavor_properties test: increase timeout again

323e78ce4d-+-peek: make git::clone ensure => latest

cf509e2545-+-P:prometheus: migrate to debian::codename and ensure_packages

ddee75ac42-+-P:proxysql: migrate to debian::codename and ensure_packages

31af4b6e44-+-base:standard_packages: migrate to debian::codename and ensure_packages

85f3746528-+-envoproxy: migrate to debian::codename and ensure_packages

7681ba30d8-+-cdh: replace os_version with debian::codename

2fab5d1433-+-profile::envoy: Remove jessie support

c84a024bb1-+-profile::analytics::database::meta: Remove obsolete OS check

5968acb3a3-+-puppetmaster::puppetdb::client: All puppetmasters are on buster

58803db9d4-+-haproxy: migrate to debian::codename and ensure_packages

9e8e0fe65e-+-puppetdb/puppetmaster: migrate to debian::codename and ensure_packages

dde0963102-+-mjolnir: fix ensure_packages args

7fa0553da3-+-libraryupgrader: migrate to debian::codename and ensure_packages

d29c6ffca0-+-jupyterhub: migrate to debian::codename and ensure_packages

36af688f90-+-java: migrate to debian::codename and ensure_packages

399f06e429-+-openstack: migrate to debian::codename and ensure_packages

b0105d9146-+-motd: migrate to debian::codename and ensure_packages

3649414adb-+-mjolnir: migrate to debian::codename and ensure_packages

3089ce4683-+-lxc: migrate to debian::codename and ensure_packages

9c51a14155-+-librenms: migrate to debian::codename and ensure_packages

17cd571b7b-+-profile::backup: migrate to debian::codename and ensure_packages

c87b58be0e-+-profile::analytics: migrate to debian::codename and ensure_packages

addf9c3ea2-+-postgresql::server: migrate to debian::codename and ensure_packages

b28219817c-+-P:conftool: fix typeo

5c77772aee-+-P:conf::client: migrate to debian::codename and ensure_packages

c9d2126d7c-+-P:ci: migrate to debian::codename and ensure_packages

4f779c1a5a-+-profile::ceph: migrate to debian::codename and ensure_packages

1bea61e660-+-P:java::java_8: migrate to debian::codename and ensure_packages

1370895239-+-P:docker::engine: migrate to debian::codename and ensure_packages

a6f87b88ff-+-P:cyberbot::exec:  migrate to debian::codename and ensure_packages

51020215ed-+-P:mariadb: migrate to debian::codename and ensure_packages

bb2d369e4a-+-P:lists: migrate to debian::codename and ensure_packages

b5501a3dc4-+-O:alerting_host: migrate to debian::codename and ensure_packages

b80739519c-+-P:mediawiki: migrate to debian::codename and ensure_packages

2b534460bd-+-P:spicerack: migrate to debian::codename and ensure_packages

c20a121166-+-P:parsoid: migrate to debian::codename and ensure_packages

2e9240780f-+-P:openstack: migrate to debian::codename and ensure_packages

b553edae01-+-P:phabricator: migrate to debian::codename and ensure_packages

ee114b04db-+-P:python37: migrate to debian::codename and ensure_packages

96561ca4c4-+-P:tlsproxy::envoy: migrate to debian::codename and ensure_packages

f967575913-+-dumps::generation: migrate to debian::codename and ensure_packages

c5d54c939b-+-P:wmcs: migrate to debian::codename and ensure_packages

535cf6354b-+-P:wikistats::httpd: migrate to debian::codename and ensure_packages

e6da67c69e-+-P:webperf::xhgui: migrate to debian::codename and ensure_packages

aba813bfc0-+-P:zookeeper: migrate to debian::codename and ensure_packages

58fdabacc0-+-P:puppetmaster::common: migrate to debian::codename and ensure_packages

47701b560f-+-P:zuul::server: migrate to debian::codename and ensure_packages

82427166da-+-mediawaki::memcached: migrate to debian::codename and ensure_packages

3bfc42bb61-+-mediawiki: migrate to debian::codename and ensure_packages

85495e1651-+-Revert "P:prometheus: migrate to debian::codename and ensure_packages"

326c04025a-+-P:prometheus: migrate to debian::codename and ensure_packages

59426eacb7-+-P:puppet_compiler::packages: migrate to debian::codename and ensure_packages

1f6a480b85-+-query_service: migrate to debian::codename and ensure_packages

48be2623bd-+-racktables: migrate to debian::codename and ensure_packages

a6747e2cc8-+-lists: migrate to debian::codename and ensure_packages

1470a55f7f-+-puppetmaster::standalone: migrate to debian::codename and ensure_packages

233fcbdacc-+-simplelamp2: migrate to debian::codename and ensure_packages

7c5949790e-+-striker: migrate to debian::codename and ensure_packages

f6afb42983-+-simplelap: migrate to debian::codename and ensure_packages

1fb7ecb6e7-+-wmcs: migrate to debian::codename and ensure_packages

827c329b5a-+-smart: migrate to debian::codename and ensure_packages

054abcdf5a-+-service: migrate to debian::codename and ensure_packages

12742d2611-+-rsyslog: migrate to debian::codename and ensure_packages

f9ace79457-+-sudo: migrate to debian::codename and ensure_packages

0052ed37fc-+-swift: migrate to debian::codename and ensure_packages

f6ce4432cc-+-systemd: migrate to debian::codename and ensure_packages

e7047b6243-+-res: migrate to debian::codename and ensure_packages

3df866a08a-+-tendril: migrate to debian::codename and ensure_packages

7201ff5294-+-P:cumin::master: migrate to debian::codename and ensure_packages

3ff4af4d61-+-testreduce: migrate to debian::codename and ensure_packages

35137a21ef-+-thumbor: migrate to debian::codename and ensure_packages

ead946a8f3-+-uwsgi: migrate to debian::codename and ensure_packages

6cf6b353e9-+-varnish: migrate to debian::codename and ensure_packages

15e6ce7fa0-+-ores: Reduce number of requests that trigger a restart of uwsgi worker

cfb58a1232-+-Disable apereo_cas_jobs in Prometheus scraping

9ae92273e8-+-gerrit: exit the JVM after OutOfMemoryError

a67e2e417a-+-profile: add prometheus jobs for am acks

2d2b2cbf63-+-alertmanager: enable acks and silences on alerts.w.o

830df5c69d-+-alertmanager: add ack daemon

81e25025ff-+-Add a Hiera option to enable ICU63 component

957cdedf77-+-role: add query_frontend to thanos frontend

17c7707d88-+-prometheus: add thanos query-frontend jobs

2011971267-+-swift: ensure /var/log/swiftrepl is a directory

050eb0b970-+-refinery - ProduceCanaryEvents - use schema.discovery.wmnet

9b61fc2c3f-+-openstack: drop redundant os_version check

254c17fa0f-+-labs_bootstrapvz: migrate to debian::codename and ensure_packages

2b3a4a5af5-+-toolforge bastion: reduce number of wheel-of-misfortune runs

a9b937868b-+-install_server::dhcp_server: migrate to debian::codename and ensure_packages

92cffc71b9-+-git::lfs: migrate to debian::codename and ensure_packages

987ba73af0-+-geoip: migrate to debian::codename and ensure_packages

cb8ce0e984-+-etc::monitoring: migrate to debian::codename and ensure_packages

8bbbdce69a-+-dnsrecursore: migrate to debian::codename and ensure_packages

b8295089ac-+-codesearch: replace os_version and require_packages

fc5c1b6604-+-certgen: migrate to debian::codename

d6c7a34edc-+-cassandra: replace os_version with debian::codename

255268252a-+-apt: migrate from os_version to debian::codename

ed0c778593-+-bacula: switch to debian::codename

4065c339cd-+-adduser: migrate away from os_version

28503fd950-+-new module: debian

c871b021a4-+-confd: pass srv_dns directly instead of loading confd::srv_dns

13aefafccf-+-mariadb: Initial setup for db214[234]

a0e410513e-+-mariadb: Set db11[51-76] in setup.

43d0ebb88b-+-cirrus: fix shard_size thresholds

9a705d222c-+-cirrus: temporarily disable saneitizer

f64758a361-+-nginx: Remove profile::tlsproxy::service

f083ba3a84-+-cloud-vps: fix quotes in the last fix

0cb078cf19-+-cloud vps: unattendedupgrades seems to have a type issue for cleaning

bd22ff9fd3-+-P:sre:check_user: add required dependencies

36d34c3188-+-p:sre::check_user: fix script path

d84935aabd-+-profile::sre::check_user: fix hiera keys

3f56454d5c-+-cluster::managment: drop old profile

72e89313c3-+-profile::sre::check_mail: new script for checking user emails

ead5ccac2c-+-postgres: change max replication connections to nodes + 6

8d5285bc71-+-kibana: add param to manage kibana.index, and use for ECS instance

4473b68d0d-+-labstore::fileserver::exports: use sudo::safe_wildcard_cmd

da997e2c63-+-grafana: commit ldap-users-sync changes

3532862ab9-+-thanos: add query-frontend

4bba109975-+-role::analytics_cluster::coordinator: increase innodb buffer size

d4f8a61215-+-oozie: Add admin groups for authorization

f88459ff6e-+-labspuppetbackend: fix ownership of logfile

700acae1f5-+-labspuppetbackend: add an explicit logfile

9e43d8d4a2-+-dumps nfs: remove probably-unused firewall ports and services

3dc28df4fa-+-Refine ContentTranslationAbuseFilter using new eventlogging_legacy job

aa26f052d2-+-profile::hue: parametrize thrift version and fix hive hostname in test

ff1ffa58c8-+-P:analytics::jupyterhub: pick up the admin groups from P:standard

b481f137d2-+-profile::standard::admin: manage admin groups in profile::standard

33703fb0b9-+-standard: switch roles to call profile::standard not standard directly

818bbc6afd-+-standard: move none standard class to profile::standard

e839b456cf-+-base::standard_packages: fix duplicate declaration for mcelog

cdd41c29c6-+-profile::lvs::realserver: add ability to configure poolcounter for pools

e2c4445df5-+-base::standard_packages: ensure absent mcelog to do auto-cleanup

3bf2986106-+-mariadb: Productionize es1029,es1030,es1031

bca74dbad4-+-Revert "Turn off airflow scheduler during db downtime"

ade2591d32-+-backup::director: add type checking and use lookup vs hiera

2d8b6ab341-+-service-auto-restart: clean up cron

cd7d30d838-+-smart: remove cron type

48bee8f940-+-prometheus_intel_microcode: remove cron type

e4016f5c79-+-remote-backup-mariadb: remove cron type

ecebcacc66-+-poolcounter: add client configuration classes

fdfcb2c262-+-Restart puppetdb-microservice if config changes

0be67af4a9-+-postgres: set max connections in postgres based on replica count

57e92789b2-+-elasticsearch: migrate to shared spec helper

ff1f26ff7c-+-nginx: migrate to shared spec helper

4f4542abe6-+-mirrors: fix spec tests

6eba598e8f-+-base: clean up old spec helper and fix broken spec tests

9e3e8de184-+-mariadb: Remove puppet entries for db1091

11c000eca8-+-profile::kubernetes::deployment_server::helmfile: simplify code

15614f54ca-+-profile::kubernetes::deployment_server: cleanup the old layout

22550d38f9-+-orchestrator: Drop the obsolete thirdparty/orchestrator component.

dc77c05d6e-+-netbox: add dependency on python3-wmflib

814ba69f80-+-orchestrator: Support sqlite backend

a1bcc0fdee-+-orchestrator: Support running as non-root

9ae2b152a5-+-prometheus: re-enable compaction by default

04ccd2d604-+-thanos: use systemd overrides for query/store/compact

ee1fa1c242-+-thanos: configure memcached size via hiera

9e32f9fa55-+-Turn off airflow scheduler during db downtime

57e3e15613-+-mariadb: Productionize es1028

4d4bee2b3f-+-mariadb: Productionize es1027

0272df4801-+-mariadb: Productionize es1026

4e6b318ccd-+-geoip: cleanup having moved archiving to launcher

2eabc810bf-+-decom testvm1001.eqiad.wmnet

e0144580f3-+-Add ::profile::analytics::refinery::network_region_config

dba71f093e-+-maps: add maps(200[5-9]|2010) as maps hosts

dd8452c0bd-+-Produce canary events every 15 minutes

c571e4a60f-+-dumps::web::html Change location of pageview complete landing to readme.html

7ffb5be7da-+-dumps::web::html: fix pageview-complete's settings

72b63fb904-+-dumps::web::html Add landing page/readme for pageview-complete dumps

ee65bac667-+-package_builder: use --no-cowdancer-update when updating chroots

75394270be-+-Remove ldap-replica2001/2002 from Puppet

5534a71f59-+-site/appservers: cleanup comments about appserver rack locations

8766ee9c77-+-site: move mw1267,mw1268 from rack A7 to rack A8

6b8d1b0a8a-+-puppetmaster: add data type for server type and use it

f7708bda03-+-phabricator: replace require_package with ensure_packages

c0506f0ebe-+-WDQS microsite: use branch production instead of master

770e5fd49f-+-create microsite for WDQS UI

8f3e7d5cd5-+-toolsdb: remove unused role

a3e3f2e109-+-toolsdb: Fix the my.cnf template to include parameter for socket

9c492f7284-+-site/parsoid-testing: reapply testing role to scandium

d46b114fe0-+-toolsdb: Make socket a parameter so new servers might work right

aaca9e2016-+-Set debian buster for mc2036

a683827400-+-site/parsoid-testing: update comments, apply insetup role

578bf1eaf9-+-parsoid::testing: remove vd_client/server and rt_client/server

4db2d5493a-+-amd_rocm: Only add DKMS+firmware for rocm33 installs

f0fa7537cc-+-mariadb: Move db1077 to test-pc1

cb68050778-+-mariadb: Set both db_inventory nodes read-write

e1e7271412-+-httpd/puppetmaster: add data type for SSLVerifyClient and use it

fd112a5253-+-puppetmaster: add data types to all remaining parameters

a4d6025e93-+-Decommission an-tool1006

502d87f301-+-Add role::analytics_test_cluster::hadoop::ui to an-test-ui1001

f12a527060-+-toolforge-k8s: Let hiera set the replicas value for ingress controllers

5ffd63042d-+-dumps: rm profile::dumps::distribution::datasets::cleanup_miscdatasets

df6a6ea904-+-logstash: add dhcp/netboot entries for logstash1032

93c99cda1d-+-Fix settings for the Druid test cluster

ad87a7e6b0-+-sretest: Add missing colon

4134d5af77-+-Add role::druid::test_analytics::worker to an-test-druid1001

acae12141f-+-sretest: Experiment with preserving docker rules

6ce0bf0b5b-+-cloud-vps instances: include bsd-mailx on all hosts

beb01e4896-+-toolforge: script to make long-running processes on bastions less good

741b4ad65a-+-site: add an-test-druid1001 in setup stage

e8e2651387-+-Remove Puppet references for ldap-eqiad*

dd1dbb5c2d-+-java::cacert: add support for java 7

f360dae0a3-+-zookeeper: use profile::java

3f9340bc8e-+-profile::java: add support for Jessie

f65d6fcb76-+-update sql/xml dump config settings for stashing revision info

7ca6901551-+-Add basic settings for an-test-ui1001 (new vm)

4c595455d1-+-gdnsd: add systemd::service to apply a custom LimitNOFILE

30edd0370c-+-alertmanager: add dashboard url to irc messages

1218d16281-+-Revert "Revert "Revert "site: assign insetup role to scandium, reimaging fails with prod role"""

a5cca1c028-+-Revert "Revert "site: assign insetup role to scandium, reimaging fails with prod role""

de409609af-+-parsoid: allow skipping installation of nodejs on test hosts

ce201624d0-+-Revert "site: assign insetup role to scandium, reimaging fails with prod role"

5263a93d82-+-site: assign insetup role to scandium, reimaging fails with prod role

f702c94b9b-+-gerrit: replace clear_gerrit_logs cron job with systemd timer

b96d6d9b3c-+-parsoid: stop using nodejs parsoid on scandium

f98caa946f-+-base/labs: add systemd timer to clean puppet client bucket

704d952182-+-stats: Remove nginx from thorium

72a026236a-+-paws: Get haproxy logging working

0e38a18bef-+-helm: drop monitoring for systemd::timer::job

3e82c63e91-+-k8s-haproxy: Fix a typo in the logrotate config

4c1131494e-+-site.pp: Remove duplicate external store entries.

93b4205468-+-k8s-haproxy: take steps to fix logging

49e7b97ccf-+-updating site.pp entry for new ES servers in eqiad

b10ce82911-+-node_intel_microcode: fix time spec 1h vs hourly

08130187f0-+-profile::docker::builder: drop monitoring for systemd::timer::job

2c20a74ab8-+-apereo_cas: dont monitor systemd timer

5bb7e89814-+-profile::icinga: drop monitoring for systemd::timer::job

dbb6fa2090-+-base::labs: hiera->lookup, add data types

86b9ab3b9d-+-profile::analytics::cluster::packages::statistics: add npm

3876981e34-+-systemd::timer::job: switch monitoring_enabled default to false

3d6c7b5150-+-orchestrator: Install mariadb client

5991a01bb3-+-db2093: Clarify it is active for orchestrator DB

9735e325c5-+-wikistats: replace require_package with ensure_packages

e7723b2f7d-+-wikistats: allow to 'absent' import/dump crons as well

1a927afe58-+-releases: only use auto-restart script on primary server

0ab53276df-+-[wdqs] add support for streaming updater lag metric

1e3ed18c50-+-Exclude predefined user agents from eventlogging data

f184894c03-+-ldap::client::labs: fix 'Unknown variable: '::restricted..'

f2bc8efa70-+-analytics/camus: switch back to eqiad

3cccd5de46-+-gerrit: remove 'list_mediawiki_extensions' cron job

d974362cbd-+-phabricator: remove absented cron jobs for Bugzilla updates

5828f24eea-+-base::standard_packages: avoid mcelog with kernels >= 4.12

7afe833829-+-cloud-vps resolv.conf: replace hardcoded .eqiad.wmflabs search with hiera

ccb8bc4462-+-grafana: add user sync from LDAP

66b002c7da-+-dbprov: Apply the cleanup stale scope sessions to the right set of hosts

baa8b57f78-+-dbstore_multiinstance: Add module to cleanup stale scope sessions

ffa61df982-+-grafana: introduce 'profile::grafana::active_host'

2ccc0ed457-+-systemd::timer::job: add complex interval type checking

34bab8f4f2-+-Fix auto restart on IDP test hosts

57c540183e-+-mariadb-snapshot: disable monitoring on timer job

d9ed32579f-+-remote-backup-mariadb: update cron to systemd::timer::job

92b5c71d4f-+-Remove auto restart for pmacctd

d849e18523-+-Cloudvirt1027/1028 to ceph and backy2

58c41f3c7d-+-Get rid of update_parsoid.sh script that is no longer needed

e5e7806d68-+-mariadb::grants: hiera()->lookup()

cd0fcf7e61-+-ntp: hiera->lookup, data types

48adea7474-+-cassandra: remove absented metrics collector cron

edba349ff9-+-Add new es servers to site.pp setup role and mac addresses to dhcp

36ff2bc0b5-+-librenms: remove absented and obsoleted cron

951e4ae9d3-+-wmcs::nfs::primary: remove absented cron TODO

00d356654f-+-toolforge::clush::master: remove absented cron TODO

6290d66eec-+-openstack::designate::dns_floating_ip_updater: remove absented cron TODO

918b9c655f-+-openstack::wikitech::web: remove absented cron TODO

8fd43ace88-+-toolforge: Install pack and buildpacks repo on image builder

17c9748549-+-service_auto_restart: disable monitoring

46d8a41310-+-orchestrator: add monitoring for process and TCP port

bb5f850aff-+-orchestrator: Add topology querying config.

39653663bf-+-librenms: use cron_ensure variable to install auto_restart_service

127f4cf5ef-+-kibana: add kibana_ecs role

a65299ca86-+-[wdqs] fix StreamingUpdate package name after refactoring

9403563bc7-+-idp: use correct server name on idp-test

dc52c8d93c-+-prometheus_intel_microcode: update cron to systemd::timer::job

e4993b985f-+-smart: switch cron job to systemd::timer::job

b8f610822d-+-Add debian-debug repository

e049f18239-+-service_auto_restart: fix time spec

28cf011a3d-+-cfssl::cert: fix re-sign command

253b49572c-+-prometheus: add ServerAlias for fqdn

e2478ba86e-+-service_auto_restart: update to use systemd::timer:job instead of cron

5823244931-+-ci: drop reference to Jessie

125c702207-+-debmonitor::client: hiera->lookup, add data types

7b76052161-+-rpkivalidator: hiera->lookup

4203b69c4a-+-prometheus: proxy pushgateway through apache

7d3a503409-+-docker_registry_ha: hiera()->lookup(), add data types

adb8dfa68e-+-encapi (aka 'labspuppet backend'): add reload-on-exception to uwsgi config

bdb7ea36b9-+-orchestrator: Add basic config

b8b9e0a0a1-+-orchestrator: Add very basic role/profile/module.

daad7f7926-+-Move upload of hive-site.xml from client to hadoop standby in test

b54ca8e059-+-dns::auth::acmechief_target: hiera->lookup, data type

be716a8398-+-site.pp: Do not use clouddb1020 yet

b4da9ad030-+-hadoop: final clean up after the decommission of old nodes

c3a51acae3-+-docker::registry: hiera->lookup, add data types

ed5fc0caf0-+-wmcs: change cloudvirt1025, 26 and 29 to ceph-enabled hypervisors

431c825231-+-site: add deployment_server role on deploy1002

886c09d4eb-+-camus - run job 5 minutes earlier to not conflict with timing of canary events

f85e830b22-+-profile::oozie::client: make config global

10e03cf8e4-+-dnsdist: set and increase the value of setMaxTCPClientThreads

0fc4cc3c70-+-profile::hive::client: refactor code to have settings only in one place

3772fe2fa2-+-camus::job - Remove support for 'dynamic-stream-config'

6ef74fdeef-+-profile::mariadb: make use of Stdlib::Datasize

cbaec1ea16-+-camus - bump to camus jar version wmf12 for all camus jobs

edd0e37131-+-camus - remove extra unneeded paren in regex

f8cd1dad9a-+-camus - add extra backslash escapes for regex in systemd unit

9ac3c12404-+-camus - use eventstreamconfig for eventgate-main streams

e3b33ade28-+-camus - use eventstreamconfig for eventgate-analytics streams

04b1159487-+-camus - take 2 bump camus jar version for eventstreamconfig event jobs to wmf12

697c4fd555-+-cassandra: add data types, hiera->lookup

d398e297f9-+-stdlib: Switch to new Stdlib::Yes_no type where appropriate

a064ea97db-+-camus - bump camus jar version for eventstreamconfig event jobs to wmf12

bdb8a6f7ba-+-camus - use eventstreamconfig for eventgate-analytics-external streams

7df76d122b-+-nftables: change ensure_package parameter datatype to String

17236875c2-+-amd-rocm: Add 3.7 to reprepro

63a8ee68b6-+-prometheus: honor labels from pushgateway

4f289cbfb0-+-role: add Pushgateway to Prometheus ops

a40346e444-+-prometheus: add Pushgateway profile and module

1b6a1afbab-+-Decom analytics1057 from the Hadoop cluster

6f2339abc4-+-Revert "Revert "geoip: move archive timer from stat1007 to an-launcher1002""

f39b968513-+-camus::job - fix --check-java-opts when no $check_java_opts is given

1a3ab08fda-+-Add analytics_test_cluster::client role to an-test-client1001

2fcee0afa9-+-Revert "geoip: move archive timer from stat1007 to an-launcher1002"

ef93495a45-+-geoip: move archive timer from stat1007 to an-launcher1002

951312b5e8-+-stats: Add envoy on port 8443 alongside nginx

7b003f8f1e-+-hue: switch from nginx to envoy for tls

44797b7533-+-turnilo: use envoy instead of nginx for tls

f681c5e3d7-+-superset: use envoy instead of nginx for tls

14b832e39c-+-piwik: use envoy instead of nginx for tls

399446a990-+-camus test - use proper eventstreamconfig.stream_names property

181dda86cc-+-Add an-test-client1001 mac address

38496f3a96-+-Include profile::analytics::refinery::event_service_config in camus test

e451d9f285-+-camus::job - only use \s in systemd Environment, regular CLI needs spaces

70e34e08ec-+-camus::job - use \s for spaces in systemd unit Environment var

7c73edb301-+-camus - Refactor http proxy envs

8a8dd9c730-+-cloud nfs: close all unnecessary ports

1ed1dcf8c8-+-wmflib: drop Wmflib::UserIpPort as Stdlib::Port::User is now avalible

9e263410bc-+-role::analytics_test_cluster::client: change description of the system role

faaa52f31c-+-stdlib: update to v6.5.0

fea84b9857-+-role::analytics_test_cluster::client: upload hive-site.xml

4409eb9e97-+-camus - Bump check_jar version to refinery 0.0.137

863da73ead-+-cloudgw: install latest nftables package

c5cabe1a97-+-camus::job - use double quotes around java opts value

73167154dd-+-camus::job - eg-analytics-external: add missing check_java_opts

12908a88e3-+-camus::job - don't fail if dynamic_stream_configs is set

dbb6705af7-+-Install ldap-replica100[12] as additional LDAP replicas

d43899eaf7-+-camus::job - replace check_whitelist_topics with check_java_opts

200c92c1d3-+-mariadb: Make innodb pool size configurable.

31ac27790a-+-Fix analytics1056 role in site.pp

d243b7a051-+-Decommission analytics1052 from the Hadoop cluster

010214884d-+-cloudgw: force installation of latest kernel

2813dd686a-+-cloudgw: fix unset variable in interfaces template

e86bb802ae-+-diffscan: fix type

3b90e47ac5-+-diffscan: switch to new refactored diffscan

71a6763f90-+-site.pp: Add dborch1001 node

67cd9fc075-+-superset: remove presto TLS config (not needed anymore)

d823683d58-+-site.pp: Add task to clouddb future hosts

ecc8290ceb-+-tcpircbot: remove "tin" IP from allowed hosts

7d803e0c33-+-tcpircbot: add deploy1002 to allowed hosts

5f4faa311c-+-puppetmaster: pass $servers parameter to gitclone class

1d45dc2872-+-docker: hiera->lookup

159c89c721-+-site: remove wtp2001 through wtp2020

c370a8487d-+-Revert "cirrus: temporarily disable saneitizer"

4977d4bda9-+-openstack: pdns recursor: allow openstack control plane to query the server

cee785bd08-+-openstack: pdns recursor: allow monitoring hosts in the ACL

479e94c5d2-+-openstack: pdns recursor: allow querys from extra CIDRs

ff63986809-+-Remove eventlogging-valid-mixed output for eventlogging-processor

67ffcfd08c-+-presto: remove unused code

6c34722e73-+-presto: use puppet TLS certificates instead of the self signed ones

a2962d2807-+-mariadb: Move passwords include to profiles

76a1bfb331-+-mariadb: Convert role::mariadb::misc to profile.

039f8d7d8b-+-mariadb: Add profile:: prefix to mariadb::mysql_role

1363333990-+-ci: Install docker-credential-environment credHelper

3c8d7a3462-+-profile: add alerts for Thanos sidecar not uploading or failing to do so

72c93d4bfb-+-Decommission analytics1056 from the Hadoop cluster

5d69bfc72b-+-updating deploy1002 to insetup

d691113062-+-wmcs: glance image backup bugfixes

9858820083-+-Bump shard_size warning/crit thresholds

dae3af1485-+-wmcs: add backup jobs for glance images on cloudcontrols

f4a661b281-+-eventlogging-processor - skip events for schemas migrated to Event Platform

d246fe5d97-+-glance-api: make active/active in eqiad1

9af0d8c97a-+-mariadb: Use lookup() instead of hiera()

0868f204d4-+-Install ldap-replica200[34] as additional LDAP replicas

fcd53c555c-+-Make the mirror to use configurable via Hiera

72522de902-+-Remove analytics1055 from the hadoop cluster

d85151366c-+-site.pp: Clarifying comment about multi-instance hosts

7c73774659-+-glance-api: replace 'default_store' with the more flexible 'glance_backends'

bc38b23096-+-Decom analytics1054 from Hadoop

b99574c440-+-wmcs admin scripts:  added wmcs-imageusage

36b38a0f3e-+-Decommission analytics1053 from the Hadoop cluster

7c2091c4f3-+-Glance: make rbd the default store in eqiad1

ed85b2f860-+-adding deploy1002 to site.pp

a1169f4e8c-+-diffscan: add refactored diffscan

124d8512da-+-remove refs to decommed cp2 boxes: 3, 9, 15, 21

38034401bd-+-cloudgw: add support for selecting NICs using hiera

d9a25b7100-+-prometheus::rsyslog_exporter: update collector to listen on primary ip

88aff701b1-+-Decommission analytics1051 from the Hadoop cluster

4bac80adb5-+-cloudgw: add routes for internal VM addressing

65366b1ca4-+-profile::analytics::cluster::packages::statistics: remove stretch bits

f8156a4963-+-varnish: do not install -dbg package

dfa5f9795e-+-base::environment: remove lint-ignore that ignores nothing

07d1b1eddd-+-archiva: hiera->lookup, add data types

ee1685e557-+-phabricator: remove lint-ignore, fix alignments

229b892251-+-statistics::user: remove lint-ignore that ignores nothing

3a0a9c5141-+-ores::web: remove lint-ignore that ignores nothing

8649a96870-+-wmcs::postgres: hiera->lookup and add data types

45d7b1867f-+-Add neovim – a modern fork of vim – to toolforge

f07f21d387-+-Switch gerrit to profile::java

d2bdd33841-+-Revert "prometheus: ensure new prometheus-rsyslog-exporter version"

47e412e2a3-+-yarn: replace nginx with envoy for tls

2604391a8f-+-librenms: use ensure_packages to avoid duplicate declarations

76f3781886-+-yarn: add envoy on unprivileged port 8443 for yarn.wikimedia.org

5734efa22e-+-netmon: ensure nmap and mtr-tiny are installed, add profile for tools

38fa6ab1de-+-netmon: PHP version is float, not string, fix error

748af580cb-+-netmon: move webserver setup to profile and pass PHP version as param

9c77132e79-+-Add an-coord1002 basic settings to puppet

0d42ac0160-+-get_ips_for_service: update stdlib::ip type

ffd8b8e8c5-+-prometheus: ensure new prometheus-rsyslog-exporter version

9649847174-+-stdlib: drop legacy Stdlib::Ipv{4,6} types

99793bf211-+-thanos: rename hiera setting "enable_thanos_upload" & enable in pops

a4a728c42a-+-ferm::filter_log: update type to modern version

8dbe5eaf20-+-role: add thanos bucket-web to frontend

4542f9c5cd-+-thanos: add thanos-bucket-web explorer

73b00b604b-+-Remove an-scheduler1001 from puppet

43f043c168-+-mariadb: misc::analytics::multiinstance - generate sections

a6aedfb155-+-mariadb: dbstore_multiinstance - generate sections.

ba6566c316-+-P:prometheus::nic_saturation_exporter: configure listen address to primary ip

61ab9c7350-+-prometheus::nic_saturation_exporter: add ability to listen on specific addr

71c081745b-+-mariadb: sanitarium_multiinstance - generate sections.

60239f2e53-+-mariadb: misc::multiinstance - generate sections.

7d6064f500-+-mariadb: core::multiinstance - generate sections.

0629a2e857-+-neutron: add option to disable customizations if cloudgw is enabled

e121fa5c52-+-neutron: drop l3_agent_only_dmz_cidr option

dfd15c0dd3-+-profile: selectively enable Prometheus compaction

3fb4056f04-+-Decommission analytics1050 from the Hadoop cluster

cfa0ef2886-+-Revert "nova fullstack test: run tests every 10 minutes and increase timeouts"

1763b8d613-+-mediawiki: replace font package ttf-alee with fonts-alee

58aba78b35-+-calico: hiera->lookup, add data types

5e7d2c793d-+-pybal: replace hiera with lookup, add data types

c2b8391d83-+-puppetdb::app: add abblity to blacklist facts from puppetdb

c3141cd18d-+-deployment_server::helmfile: Allow default secrets per environment

b602f0a9bd-+-swift: change ownership depending on mountpoint status

a3639f0780-+-Add an apt proxy config for deb.debian.org

f83ba20496-+-profile::hadoop::master: refactor monitor for HDFS space left

88f58f7cde-+-mariadb: Add db sections to motd.

6818c3f818-+-mariadb: Convert role::mariadb::core to profile.

7890dcb62e-+-mariadb: make role::mariadb::core_test use mysql_role

2a3237d586-+-mariadb: Remove unused hiera lookups

9fa89ca7f2-+-profile::hadoop::worker: avoid custom disk space checks for the test cluster

4912c490e0-+-Decommission analytics1049 from the Hadoop cluster

0c6d075956-+-elasticsearch: replace hiera with lookup

86b56ab4d7-+-wikistats: redo the way cronjobs are setup, add parameter to absent

544e806a1e-+-geoip: archive MaxMind database to hdfs only

35113b82d5-+-wikistats: rm php7.0 pre-buster support, make PHP version parameter

d3515fde85-+-site.pp: rearrange slightly to clarify different cloudvirt roles

e9e98ece5f-+-dnsdist: update permissions for dnsdist.conf

6cf6f4a8f0-+-wikidough: enable OCSP stapling in dnsdist

baed9c2765-+-cloudgw: refresh network configuration

5f7f3d6521-+-cloudvirt1021: add backy support

f5961390da-+-cloudvirt1022: move to virt_ceph_and_backy

05ceeda038-+-redis::instance: raise the file limit to match maxclients

29d29ffb65-+-profile::redis::multidc_instance: correct reference to base::service_unit

7cee6b9078-+-redis::instance: switch to use systemd::service

6b73e7a0c1-+-cloudgw: refresh routing configuration

af63623ef8-+-Remove analytics1048 from the Hadoop cluster

6895bfb247-+-site.pp: Remove s3 comment

cd3db9f007-+-Clean up Analytics lvm-based backup not used anymore

4f9975b283-+-role::analytics_cluster::coordinator: avoid lvm backups to an-master1002

470b161df0-+-Remove lvmbackups of Analytics meta from the Hadoop Standby master

2705be35e4-+-amd_rocm: Ensure linux-headers-amd64 is installed

6fee44b7a1-+-role::analytics_test_cluster::coordiantor: avoid db backups

c7e7d03f45-+-Set the test coordinator role to an-test-coord1001

984ce7e52f-+-Decom analytics1047 from the Hadoop cluster

91c848eea5-+-Decommission analytics1046 from Hadoop

2212b62938-+-profile::hadoop::balancer: add syslog id to systemd timer

14783adace-+-Remove analytics1045 from the Hadoop cluster

bb336c247a-+-site/DHCP: add testvm1001 with appserver role for a test

dabf87e3f0-+-Cloud puppetmasters: Rename an argument in Profile::Pupetmaster::Backend

d5e748b199-+-toolforge/grid: hiera()->lookup(), add data types

6afe8daf97-+-local_dev::docker_publish: hiera->lookup, data types

f07148a36d-+-parsoid: replace a hiera call with lookup

6775f593a4-+-ci: replace hiera with lookup, jenkins, shipyard, pipeline, k8s

13b216dd06-+-map::postgresql_common: make maps-admin chgrp toggle

e51f8be8b0-+-Set up the new Analytics Hadoop test cluster

d77c2b0511-+-pontoon: use hiera.output

8b65eaf51d-+-pontoon: configure hiera based on the stack found on the filesystem

04cc53beae-+-pontoon: write the stack name once to the filesystem

2df6e1bdd9-+-openstack: codfw1dev: refresh external connection for neutron

4430dfe274-+-Decommission analytics1044 from Hadoop

49a0bc9624-+-Revert "site: add mediawiki appserver role to a test VM"

2482db074c-+-site: add mediawiki appserver role to a test VM

1ca6b1947e-+-cumin: replace hiera with lookup, add data types

181835e6da-+-toolforge: delete profile::toolforge::services::basic

13d386c3e4-+-Delete puppet role and module for Phragile

4b7b35ec29-+-recommendation_api: hiera->lookup, data types

6d58415f81-+-wmcs server backups: Add a way to assign projects to backup hosts

603241222c-+-zookeeper: hiera->lookup, add data types

eecb87270e-+-wmcs backy2: allow hiera config of when the backup runs

3d876847fe-+-hadoop::monitoring: hiera()->lookup(), add data types

20b3902112-+-elasticsearch::cirrus: hiera->lookup

a3a76f34ef-+-cache::ssl::unified: hiera->lookup, add data types

92e9a1a38b-+-Revert "oozie: use admin groups to determine admin access"

2418f30e38-+-thumbor: hiera->lookup, add data types

234b7dd7be-+-oozie: use admin groups to determine admin access

60f26c0271-+-base::firewall: use ferm::rule instead of ferm::conf

c68afca294-+-firewall: change to default reject instead of drop

7ecadc230c-+-amd_rocm: Fix package list

5a7e7cc5dc-+-modules: Add functionality to allow use of 3.8 rocm packages

bf2e40d67e-+-cloudgw: refresh network config for the PoC

c67ff8c7cc-+-Add analytics data purge for webrequest sequence stats

e9bcfc846c-+-Remove analytics1043 from the Hadoop workers

ef3a63603c-+-Move the HDFS balancer to an-launcher1002

849b509c83-+-restbase: remove monitoring calls to the http endpoint

20bf444019-+-mariadb: Remove puppet entries for es2015

6b3cd35a60-+-P:logstash/apifeatureusage: fix puppet-lint issues

ab1a7ce617-+-P:netbox: fix puppet-lint complaints

d931b5bb0a-+-ceph::osd: fix puppet-lint issues

7126114f1b-+-wmflib: drop apply_format function

d0e25c99b6-+-dumps::web::fetches::stats: fix pageview's hdfs path

7c6165ec6a-+-dumps::web::fetches::stat_dumps: add rsync job for pageview complete

337cb273f4-+-Add a pbuilder hook to include apt sources for icu63-linked packages

57030652fd-+-deployment_server::helmfile: Allow to define general values in hiera

dce20b0d15-+-service::configuration: connect to restbase via TLS

a222da88a0-+-service: drop legacy validate functions

7a84cd9cde-+-profile::hadoop::master::standby: improve hiera lookups

24c2218fad-+-cloudvirt1023: to Ceph and Buster

7643dae77a-+-envoy: Set appropriate service names for three level wikimedia.org domains

7675d05d59-+-Lower elasticsearch readahead from 128kB to 16kB

5235d653c8-+-geoip: add data types

a1b08d1ebb-+-bird/piwik: replace hiera with lookup, data types

385439bbe0-+-wmcs::services::ntp: hiera()->lookup(), add data types

c8d2ba6ecb-+-trafficserver: replace hiera() with lookup()

a3cce558cb-+-prometheus: convert mysqld_exporter from role to profile

64adbca99d-+-Drop /wmf/data/raw/mediawiki_job and /wmf/data/raw/netflow after 90 days

fd67507da2-+-wmflib: drop Wmflib::Sourceurl and replace with Stdlib::Filesource

db6dedde38-+-wmflib: drop validate functions

dfd60f3840-+-logstash::input::tcp: drop validate functions

cae682aa73-+-kartotherian: drop validate_array function

327b4fbcf3-+-Revert "openldap: increase query size limit"

13f99dc27d-+-openldap: increase query size limit

e99b8fe9cf-+-role::logstash::collector: remove unused role

6538b3c377-+-alertmanager: fix config invalid alert

ef24d273e0-+-prometheus: connect prometheus 'ext' to alertmanager

74868256db-+-Add maps1005-1010 to site.pp and add mac addresses to dhcpd file

f1b942cb2a-+-role::logstash::puppetboard: refactor role

44cce2a57a-+-role::logstash7: refactor role to conform to coding guide

67d3a525d4-+-role::logstash: refactor role to conform to coding guide

31c2762ee1-+-Revert "dnsdist: temporarily disable validate_cmd for dnsdist.conf"

f83adde23c-+-mtail: upgrade mtail across the fleet to 3.0.0~rc35-3+wmf3

a8f725d6df-+-redis: Check for existence of pass

15e2a25a9d-+-stdlib: update to version 5.2.0

dbf25269d4-+-casandra: drop legacy _validate_ functions

d8b25e04fb-+-memcached: refactor rules

b2b3dbf31f-+-profile: add alertmanager::alerts

e4c9bebd5d-+-Set an-worker1114 as Hadoop worker node

8de015b921-+-diffscan scan all the ports instead of top 2000

6bac6641d6-+-delete role::beta::availability_collector, diamond varnishstatus.py

7b1315e124-+-Set an-worker111[13] as Hadoop workers

71c987e796-+-mariadb: Remove es2017 puppet entries

91153e52c9-+-remove shinken module, profile, role

7a7d353d09-+-Cloudvirt1021 and 1022 to Buster and Ceph

6cb3510ad0-+-consolidate bastionhost roles, remove module

38eecff5a8-+-base: replace hiera() with lookup()

d482c95706-+-Set an-worker111[5-7] as Hadoop workers

5488f3836b-+-hadoop::common: add additional info to fail message

d79883441b-+-profile::java: Add support to deploy debug packages

38fd30eced-+-Add profile::java for cergen

009ea48f89-+-dnsdist: do not set the TLS library explicitly (use dnsdist's default)

87b2ff0a7c-+-Remove profile::ipmi::mgmt from role::bastionhost::pop

23169183c7-+-Set an-worker111[02] as Hadoop workers

4ba355f9d4-+-Swift object servers: enable object-expirer

94b0a26c1c-+-puppetdb: manage mode on vardir

870717f132-+-Add ldap-replica2003 to DHCP and the new instances to site.pp

d4735ec1bd-+-nova fullstack test: run tests every 10 minutes and increase timeouts

3a81fd7914-+-phabricator: don't create chk_phuser shell script from erb

c7c782111d-+-pmacct: hiera()->lookup(), add data types

17dfb9b8f6-+-keyholder: hiera->lookup, data types

362f595b01-+-dnsdist: add acl parameter for webserver configuration

3c19cebb2f-+-dnsdist: temporarily disable validate_cmd for dnsdist.conf

74d91825e8-+-Fixing typo in docker registry class

2b058910ae-+-oozie: hiera->lookup, add data types

47f31f7b63-+-remove etherpad1003 from site and DHCP

01e67c1d9d-+-maps: hiera()->lookup(), add data types

5b07029a15-+-bastionhost::pop: remove tftp from bastions

ae114e59d7-+-Set an-worker110[6-9] as Hadoop workers

ba18637022-+-profile: remove rollout flag for rsyslog queues

d42cdfe8a2-+-Set an-worker110[0-2] as Hadoop workers

acb3867777-+-mariadb: Remove es2011 puppet references

d0dac33d36-+-site: add etherpad1003 with role(insetup)

a7b2f45060-+-cloudvirt1018 to Buster/Ceph

f7fb6b7e67-+-import IP address type patterns from stdlib 5.2

4c8099af58-+-mtail: move systemd unit customizations to override

838cb3cfda-+-openstack: cloudgw: introduce native vlan for easier reimaging

73738dfa88-+-Set an-worker109[78] as Hadoop workers

44b6aca66a-+-Add an-worker1097 as hadoop worker

bdf0fd55c7-+-amd_rocm: add rock-dkms package

e602e4f78e-+-docker: add data types

52e2256938-+-Generalize profile::statistics::gpu

2fb0fe3491-+-Set an-worker110[45] as Hadoop workers

844a658f00-+-Add hadoop worker node role to an-worker1103

ba133e19fe-+-swift: move swift parameters to the profile namespace

acdb3dc462-+-profile::swift::proxy: pass swift parameters via profile namespace

95552e4c3c-+-lvs: Remove mathoid non-TLS endpoint 1/2

5ed5a3b994-+-proton: remove all puppet code, other references to the non-k8s service

7a2d640dac-+-proton: remove the ganeti VMs from puppet

3253b038a9-+-geoip::data::archive: run the systemd timer as analytics-privatedata

5f25984d39-+-mariadb: Remove es2016 puppet entries

b2ca3e68e8-+-cloudvirt1017 to Buster and Ceph

b79e37b1f4-+-profile::swift::stats_reporter: pass statsd host and port via hiera

1439c532d9-+-swift::storage: migrate swift::storage from a role to profile

dfa730cb20-+-swift::swiftrepl: convert role to profile

ee99678c6c-+-profile::swift::proxy_tls: Swap hiera for lookup function

2f62791e65-+-quarry: hiera->lookup, add data types

871c061b0c-+-add testvm to partman and comment about bast5001 to site

5d0dc9a031-+-mcrouter_wancache: fix typo in WarmUpRoute

31e6acdcbb-+-cfssl::cert: include stderr in unless comparison

d695bc834a-+-cfssl:cert: make profile optional

c6e31fac72-+-P:pki::client: add ability to create certs

5c23f0c9f2-+-cfssl: correct fact

7b36b970d3-+-cfssl::multirootca: listen on primary ip and use safe title

80843badf6-+-cfssl::multiroot:  add multiroot class

5c3d9b9054-+-Allow deployment of AMD ROCm drivers on Stretch

f420537baf-+-openstack: neutron: use iptables-legacy

b989f26782-+-mcrouter: install ohhost memcached on MediaWiki servers

2a172a263c-+-interfaces: drop aggregate (bonding) dead code

71fc82298f-+-mariadb: Promote db1131 to s6 master

2dc1a6efbf-+-profile::prometheus::snmp_exporter: update snmp ro string

44461f5cbd-+-mariadb: Decommission es2019

f45a839390-+-Cloudvirt1016 -> Buster/Ceph

1203f0b9af-+-swift::proxy: convert role to profile, fix various lint issues

27890166e2-+-mariadb::core_test: convert role to profile, add data types

efca47109d-+-puppetdb: add ability to mount the stockpile queue dir as tmpfs

3d24d2502f-+-restbase: install libjemalloc2 if on buster or later

abb4f946b8-+-change variable use_onhost_memcache to use_onhost_memcached

a128ffe3c2-+-Remove need for codfw only SNMP community

450a67e889-+-openstack: cloudgw: add hiera keys for basic network bits

06f7f9eebe-+-Anycast: add check_fail

28da739286-+-openstack: cloudgw: drop unused orig_nic hiera key

9051888ca1-+-mariadb: Promote db1104 to s8 master

c0e75b6ed5-+-restbase: set role for new nodes

eb050cebc8-+-otrs: remove jessie support

a7dcd2b162-+-cache: upgrade Varnish to v6 in esams

b3aa79bf33-+-mariadb: Decommission es2013

4dbe96c4ba-+-prometheus: replace remaining hiera() with lookup()

ea908ec389-+-tlsproxy::instance: switch from hiera() to lookup(), lint fix

59f900b6a9-+-facilities: replace Stdlib::Ip_address with IP::Address

536829019f-+-phabricator: replace Stdlib::Ip_address with IP::Address

3b275361be-+-Move cloudvirt1012,13 and 14 to ceph and Buster

64faa74ca1-+-tor: use Stdlib::Host to match FQDN or IP

890fb9ecd3-+-cache::base/varnish: replace hiera() with lookup(), add data types

cb42bb7919-+-acme_chief: replace hiera() with lookup()

3392e16be7-+-docker: replace hiera with lookup, add data types for builder and registry

b83bb289e0-+-logstash: keep at least 2 copies of each shard for apifeatureusage

9b0bdb4f09-+-openstack: replace remaining hiera() that had default values

580ae8f2a1-+-mariadb: Set up db1150 as the new buster source backups host

8f00bac541-+-Adding db1150 to site.pp insetup role and dhcpd file

746debd367-+-bsection: Script for binary-searching log files.

e9be3c190a-+-Remove mendelevium

0daab2ea4c-+-base/monitoring: move monitor_screens to proper profile parameter

cb4ea9ed94-+-Have the puppetised sources.list depend on the wikimedia repository

fc334e94ca-+-services: add TLS encrypted endpoint for wikifeeds (2/2)

580b2da732-+-Switch CI to profile::java

f8cae68371-+-Decommission Hadoop test cluster

aff91a3ef3-+-statistics::web: hiera->lookup, add data type

8b8986b2bd-+-service::uwsgi: replace hiera() with lookup()

3156486133-+-Remove pipelinebuilder role and builder profile

39c7044e07-+-trafficserver: update to use a .wikimedia.cloud dns name

18decbf809-+-Add role::analytics_cluster::hadoop::worker to an-worker1096

d3e3d3611f-+-Create a role for the sretest servers and apply to sretest100[12]

8d6fead8dc-+-profile::hadoop::spark2: set default from hiera

02246b4c26-+-profile::hadoop::common: cleanup after new TLS settings

606543d3bd-+-openstack: dns_floating_ip_updater: only run in one control plane node

cb1362e79d-+-profile::hadoop::common: get the datanode mountpoints from facter

ef8658ba82-+-cirrus: temporarily disable saneitizer

3d794d742d-+-mail::smarthost::wmcs: convert role to profile, fix lint issues

77fc4fa9a6-+-[wcqs] add favicon for wcqs

c65e3e0901-+-refine - Exclude CitationUsage; schema has been deleted

51e2b746cf-+-site: add installserver::light role to new install servers

4988b496a4-+-kafka::certificate: add data types, hiera()->lookup()

02a1bf9fa2-+-syslog::centralserver: convert role to profile, fix lint issues

16124f2fdc-+-puppetmaste::puppetdb: add passthrough params to puppetdb postgres config

89db392efc-+-wmcs::postgres: fix type

1442a68fe0-+-postgress::server:  add Types and additinal options

97512edbdc-+-wmcs codfw1dev haproxy: add proxy for barbican api

03eec5235a-+-OpenStack: add initial manifests for OpenStack Barbican, a secrets API

5b28b3aaaa-+-postgresql::server: add types and new params

ce9ce93863-+-Add a helper to dump/restore memcached for reboots

39893c03c5-+-[wdqs] use an Integer instead of String for jmx_exporter port

de3b1887d5-+-profile::hadoop::common: use only TLS puppet certs

a328f7affd-+-puppetmaster: update web site to use strong ssl ciphers

0c361f4f88-+-puppetdb::app: Add ability to change log level

935f1d4cef-+-Retire stub firejail code in service::uwsgi

ae83f2f20f-+-Manage /etc/apt/sources.list via Puppet

3abb3b0a6d-+-monitor_services: switch citoid monitor to https

ce0ccace99-+-puppetdb: small refactor update types

de3d1729f1-+-service: add TLS endpoint for mathoid 2/2

3cb7e6f379-+-diffscan: hiera->lookup, add data types

1ccd81a01e-+-mariadb: Remove es2012, es2018 from puppet

9276c58259-+-netbox: move state file to /var/run

937d282c1f-+-netbox: improve check_json_file

e365d10ee1-+-netbox: convert Icinga check in timer

430eb83d06-+-CI profile: move ruamel requirement to publisher

0a31a4dc68-+-site: add new POP install servers with insetup role

e715fba025-+-toolforge: use locales::all for the grid

5d5becafa8-+-nutcracker: hiera-lookup, add data types

cf79e7e320-+-phabricator: replace hiera() with lookup()

3f17d8ec60-+-netbox: set timeout for nrpe check

8876594ac3-+-netbox: add check for uncommitted DNS changes

9496bf618f-+-varnish: install packages specifying archive component

adfee164be-+-profile: add queues to rsyslog kafka output

7f2902f9a4-+-mariadb: Remove es2014 puppet references

50d12cf900-+-codesearch: Configure to use git protocol v2

cd7be93327-+-cfssl::csr: renam to cfssl::cert

dc254e917b-+-cfssl::csr: add auto renew function

c8e5c93251-+-cfssl: add ability to configure CA bundle for signers

1636132779-+-role::bastionhost::pop: remove prometheus instances

f3a5c587c5-+-profile::pki::server: enable cfssl server for sre intermediate

78360d06c3-+-profile::pki::server: Add new signer config

ab9e4bf931-+-cfsssl: update service description

2b57decc9f-+-cfssl::csr: update to compare strings not numbers

a6c067f216-+-Revert "base::expose_puppet_certs: add option to enable/disable p12 encypted keys"

fb5fb07b21-+-cloudgw: rt_table: fix newline at the end of file

2dbf390d06-+-cfssl::csr: add better validation command

c730e016e7-+-Add missing dependency on wmfmariadbpy on mariadb::backup::transfer

cdbeb00af1-+-Add missing dependency on wmfmariadbpy to mariadb::backup::check

ceabdbb430-+-cloudgw: add templated network interfaces file

e396db9142-+-profile: point statsv at proper statsd-exporter intake port

b4020f742e-+-base::expose_puppet_certs: add option to enable/disable p12 encypted keys

4941f89ae9-+-proton: remove non-https endpoint

4c7a72c209-+-profile: install and configure statsd_exporter and retarget statsv

f86da09808-+-cfssl::csr: Ensure we manage the produced files

236fd38b85-+-profile: add prometheus instance for external metrics

54a890342f-+-cfssl::csr: fix white space in exec and update output location

5dfd07dbac-+-mariadb-backups: Use the wmfbackups-remote package and not the puppet version

bdbae0e24c-+-cfssl::csr: update csr resource to support multiple signer configs

029e96fc06-+-mariadb: Stop using puppet to deploy wmfbackups and use debian packages

f125a63f39-+-cfssl: update config paths to be some what standard

a2f0b739e3-+-profile::pki::Server: update cfssl::signer to a define

4e41a99062-+-mariadb-backups: Start using the package instead of the script on puppet

d2ecf878b0-+-wmfmariadbpy: Update possible installation roles: add 'library'

7f90ae969f-+-wmfmariadbpy: Add 'library' role value

6b092b5eea-+-sslcert::x509_to_pkcs12: check for a valid p12 instead of just a file

53bf7125c8-+-Exclude testwikis and private wikis from CX draft purge script run

8d6307b107-+-Revert "presto: use puppet host TLS certificates by default"

0ff768c99a-+-presto: use puppet host TLS certificates by default

3a46907046-+-ceph: add firewall rules for cloudcontroller nodes

b0b843fb05-+-Add python3-pid debian package to reportupdater

2d2861975a-+-hadoop: decrease default yarn log retention from 90d to 40d

401a230e63-+-cloudcontrol eqiad1: add ceph client for Glance

68fbe9252e-+-cfssl::config: drop client defaults for usages and expiry as they are ignored

7ac687ac0c-+-cfssl: refactor server functionality out of cfssl

6f13b284ed-+-cfssl: update client class to use new config define

07b8ec9674-+-profile::presto::server: fix ownership of ssl directory

c9a7e92eec-+-profile::presto::server: allow the usage of local puppet TLS certs

74809be1d3-+-profile::hadoop::common: migrate to base_exspose_puppet_cert

18336bf44d-+-base::expose_puppet_certs: update p12 interface

34c6a7e4ad-+-sslcert::x509_to_p12: add owner/group parameters to manage the p12 file

b4dfb85c86-+-profile::base::puppet: remove export_p12 function

6b407abf1d-+-Remove the Yubikey HSM classes

e29b4fe857-+-nginx: add data types

cf17702833-+-Use the HTTP_X_CAS_UID http header for hue-next authentication

e2a7226dbe-+-Revert "disable category rdf dumps for now"

2c17b50a92-+-profile::hue: fix nagios alarms for Hue 4

0451d02b24-+-mariadb: Productionize es2031,es2033,es2034

f9844bb252-+-rebalance number of pages in xml dumps stubs files for large wikis

c1d7a07d8b-+-dumps: rename the do_acme parameter and lookup

eeb2d5d0e0-+-openstack: replace hiera() with lookup()

2d5ea88632-+-mailman: require package pwgen to create random passwords

36bb7952dd-+-gerrit: dump heap on out of memory error

d9327b3ee2-+-profile::hadoop::spark2: use the package resource instead of require_package()

199450a23c-+-openstack: rocky/buster: fixes for iptables updates

ab7e8a03cb-+-openstack: rocky/buster: use more modern netfilter components

991feb2beb-+-profile::hadoop::common: remove duplicate variable definition

a72b9fb415-+-profile::hadoop::common: add missing config to local puppet ssl

e595744ea2-+-profile::hue: adjust settings for the new python3.7 alerts (hue 4)

322b164e8d-+-profile::hadoop::common: create the ssl directory if not present

c41f47aef4-+-profile::hue: add new alarms for Hue 4

d26f350a80-+-parsoid: replace hiera with lookup, add data types

02877ca0c8-+-scap: Fix "Could not find resource 'User[deploy-devtools]'" in cloud

0bf3b86cc2-+-ntp::daemon: replace hiera() with lookup(), lint

8de5d05a15-+-phabricator: add script to check a phab user's email address

7fd4bb0294-+-base::remote_syslog: use .wikimedia.cloud naming for deployment-prep

062f649709-+-gitlab-test: pam access for ssh for git user

040f00764b-+-Remove refs to cloudvirt1015

af2eeae62f-+-profile::piwik::instance: actually copy Maxmind data files

b0937ab216-+-Add MaxMind data files to Matomo /misc directory

8975b585e8-+-Remove refs to cloudvirt100[1-9]

69a3918516-+-profile::hadoop::common: add g+r to the puppet cert exposed file

ea60c174fb-+-profile::hadoop::common: refactor puppet TLS cert deployment

eca7f44575-+-cumin: for new wmcs. prefix for cookbooks, grant access to wmcs-admins

533cb38ebc-+-gridengine: cleanup some file removals

9e9ea8d503-+-icinga: notify on commands change

74192084e7-+-cloudvirt1001-1009: mark as spare systems pending decom

6150f57392-+-toolforge grid: Remove some old scripts we don't use anymore

f7e76fb53a-+-profile::hadoop::common: fix keystore path for puppet certs - part 2

1a574f9666-+-updating pdus from upgrade

b95ea9bc0f-+-profile::hadoop::common: fix keystore path for puppet certs

85931bbb2b-+-Use local puppet host certificates for Hadoop Test's TLS encryption

11848ec947-+-pki::client: add class to install client pki tools

1b732de74b-+-stunnel: Add new stunnel class and daemon define

9824299508-+-toolforge spreadcheck: don't page!

37c225b131-+-changeprop: remove changeprop from puppet

3ae4cf65d4-+-Add grafana-rw to CORS origins

c70f7d8271-+-cdh::hue: deploy libsasl2-modules-gssapi-mit

82a7ee206c-+-prometheus: Use FQDNS for k8s etcds

3952c89370-+-base: remove obsolete enable_rsyslog_exporter

c7b88a4047-+-icinga: reload when nagios config changes

ad1fa949a9-+-spicerack: replace hiera() with lookup()

f22cb4d196-+-mariadb: Productionize es2029, es2030

069391f1d2-+-puppetmaster: drop workers parameter as this can be inferred from servers

337805fb5b-+-puppetdb: (re)move hiera lookup for db pass to profile

bd5ce0acea-+-puppetmaster: (re)move hiera lookup for scripts to profiles

2be06099f8-+-profile::scap::dsh: replace hiera() with lookup()

aca0433418-+-Add types to profile::analytics classes

ff5edd035e-+-ci/pipeline/builder.pp: Add ruamel package

cbc8fa9f6a-+-hue: use 'sync' with gunicorn when hue 4 is selected

f82dc6baa4-+-refine.pp - use eventlogging_legacy job to refine Test schema events

80cd8a84c1-+-d7 d8 pdu upgrades

c8e67ef3e0-+-pdu upgrade in c6/c7

23a471bebb-+-prometheus: Scrape k8s etcd nodes

5d4ce4f17d-+-otrs: Redirect cache cleanup cron's stdout/stderr

38f12e8c50-+-otrs: Cleanup Cache every 1h

5dbf0e44c9-+-hue: use gunicorn with Hue 4

9619997515-+-hue: add specific settings for version 4

f84fe2c09f-+-Remove kafka msearch and bulk daemon from cirrus and relforge

731bc9880d-+-Make the servername configurable via Hiera and set to hue-next for an-tool1009

f02b577e2f-+-lvs: Remove mobileapps non-TLS endpoint from LVS 1/2

a64a8f76a3-+-tendril::webserver: configure mpm

9b4c65007d-+-lvs: Remove check_eventgate_main_http_cluster monitoring

2d30d66d2b-+-lvs: Remove check_eventgate_analytics_http_cluster monitoring

5d8b41d772-+-Remove etcd100[123] hosts

26f6006967-+-Add CAS-enabled vhost for editors/admins

915e61c75c-+-prometheus: add port to alertmanager url

db05288f66-+-prometheus: use prometheus-icinga-am to send alerts

4891146cc8-+-rsync: handle quickdatacopy cron cleanup when flipping source/dest

23fdd4780f-+-mariadb: Productionize es2031

a2e84e5752-+-Revert "base/apt-upgrade-activity.py: Port to Python3"

54309ea861-+-base/apt-upgrade-activity.py: Port to Python3

c809cd5e1e-+-service::node: replace hiera() with lookup()

15e754ce5b-+-scap: replace hiera() with lookup()

8d4abcf4ae-+-logstash NEL: use 'tags' not 'type'

e66e29c858-+-monitoring: replace hiera() with lookup()

964343c736-+-nrpe: replace hiera() with lookup()

38dfd3fc69-+-collector7: fix omitted 'type' stanza

39d77cfa76-+-logstash: NEL: rename overloaded body field to report_body

6850451fc1-+-lists: replace hardcoded server name with variable

4532fbafed-+-Revert "Add geoip::data::puppet to profile::piwik::instance"

6019d2f636-+-lists: move hiera lookup out of module, add servername as proper parameter

28e43f84a0-+-Add geoip::data::puppet to profile::piwik::instance

a35b9ee55c-+-original logstash: accept Network Error Logging reports

0389a9bc35-+-wikireplicas: create multiinstance roles and profiles

91eb91605d-+-Revert "profile::piwik::webserver: Add geoip data to Matomo"

de86833f46-+-profile::piwik::webserver: Add geoip data to Matomo

4e5a2e9d2c-+-profile: remove usage of logstash statsd outputs

52c5732133-+-Add maps20(0[5-9]|1[0]) to site.pp

e72de94347-+-ps1-c[45]-eqiad update

2476de6750-+-Add security.wikimedia.org microsite

e86ad79a0d-+-setting ps1-c[23]-eqiad monitoring

d954aaab01-+-grafana: switch to eqiad

9f18d94946-+-refine - Exclude CitationUsagePageLoad from refine

55cd3ca9f6-+-Canary events refinery job

7e6bc57c1d-+-lvs: Rename cxserver-https to cxserver

8e64349559-+-lvs: Rename termbox-https to termbox

78b1bd5a39-+-role::search::airflow: add profile::analytics::cluster::gitconfig

c0002c1aba-+-mariadb: Productionize es2028

a60e705c62-+-mariadb: Add arbcom_ruwiki to the list of private wikis

83587f7f1f-+-logstash collectors: accept Network Error Logging reports

d260aa3953-+-ps1-d[56] update

7c11903cbc-+-Revert "ps1-c[23]-eqiad update"

974d1eaff3-+-ps1-c[23]-eqiad update

78beda132b-+-debmonitor: Remove now obsolete compat code for stretch

3f3e92bd16-+-Remove debmonitor1001/2001

6aa14feea7-+-statsd_exporter: stop tracking local statsd connections

398f22b16d-+-git: fix template and phab configueration

b4c7957d02-+-git: remove the creates line in update-gitconfig as its refresh only

43b5a9d84e-+-phabricator: migrate to git::systemconfig

6a2349f2a3-+-deployment: remove obsolete Trebuchet git config

c3371d3384-+-base: enable git protocol version2 fleet wide

c902df4af5-+-cloudgw: bonding: specify original NIC

ad5bbef17e-+-Refactor ferm rules in hiera for Kafka Jumbo to increase maintainability

a1751bb623-+-Revert "statsd_exporter: stop tracking local statsd connections"

7e832f7394-+-statsd_exporter: stop tracking local statsd connections

66f7a542a1-+-base: add remote syslog queues

4ebf6f2020-+-mariadb: Productinize es2027 into es3

fd0c9adfea-+-Add custom ferm srange to Kafka Jumbo brokers

04312588dd-+-Use dedicated schedules for the various wikidata ttl dumps

135690519e-+-arclamp: fix spurious "environment changed"

f1bef6ef57-+-updating ps1-d[34]-eqiad

98dc019bba-+-scap: add support for .eqiad1.wikimedia.cloud targets

b32cf6c57f-+-Add wmcs-drain-hypervisor admin script

1e311b69e4-+-kibana: enable logging by default

aab90f293f-+-git: allow multiple calls to git::systemconfig [take 2]

ef0a0ae89f-+-Add ::profile::base::linux419 to set up kernel 4.19 on stretch

7648407317-+-profile::oozie::server: set admin list for the test cluster

944b52b6d1-+-Install git instead of git-core

ed13be77a5-+-site: add parsoid role to all new parsoid hardware

298c69fcc3-+-site: add parsoid role to parsoid2020.codfw.wmnet

77a374a261-+-mediawiki: update alerts on logstash logs

46be8a678f-+-webperf: add parameter to disable timing beacon monitoring in eqiad

d9a40c91a1-+-wmcs pdns recursors: add zone forwarding for .cloud lookups

756bd00e1a-+-wikistats (cloud): add import cron for neoseeker wikis

648a1f7a44-+-Openstack Module: remove instance_info_dumper.pp

61f1b6a6ed-+-Install anaconda-wmf on hadoop workerrs and clients

3330487795-+-mariadb-backups: Add db2141 to the dbstore role for backup source

f9fb51703b-+-cloudgw: introduce bonding+trunking

67c06d311b-+-Revert "git: allow multiple calls to git::systemconfig"

cdb5db5b3c-+-git: allow multiple calls to git::systemconfig

0f3c1aa1bf-+-base::puppet: only manage p12 file if source exists

74fac5cbe4-+-base::expose_puppet_certs: add ability to expose p12 cert

57aa3aa887-+-spicerack: remove double require of same profile

10534e7237-+-Add db2141 to site.pp

38cf1a3a97-+-cloudceph: Add cpufreq tools to set cpu governor

000d9abc4d-+-kibana: move kibana.yml settings to parameters

b4f29d5011-+-alertmanager: enable/disable irc service as needed

89a7854756-+-transferpy: Add ability to override transferpy defaults for wmf

3ce9f861bf-+-base::puppet: move the export_p12 parameter to base::puppet

1a972987ab-+-java::cacert: -cacerts is not supported in java 8

310100c4f0-+-base: puppet use hostcert not publickey

96901eb57b-+-base::puppet: add ability to create p12 puppet cert

30c848f99a-+-sslcert::x509_to_pkcs12: add define for creating p12 files

64c47fbba9-+-profile::java: add param to toggle puppet ca trust

1df870e02f-+-java: add define to update the java trust store

f6a348353d-+-Disable backports on stretch for production

bda1d31512-+-profile::mjolnir::kafka_msearch_daemon_instance: fix enable value

a4c2e38029-+-profile::mjolnir::kafka_msearch_daemon: clean up old code

3aea8111d8-+-tools-grid: Install correct version of php-igbinary

c2e3c512ae-+-Multiple instances of msearch_daemon

adc18b7d62-+-pki: drop ocsp vhost and serve over http

e736a9be0d-+-Add $site parameter to wmflib::service:get_url

e7b786da97-+-OpenStack Neutron config: remove the 'tld' variable

98525aebc6-+-mariadb: Move db1133 from m5 to core-test (backup testing db)

c2d5768529-+-pki: enable headers module

9f67add6b4-+-pki: install sslcert::dhparam

6f65485c40-+-pki: install mod_ssl

fb82e34bfd-+-mariadb: Productionize es2026

ad70709727-+-pki: add vhosts for pki and ocsp which will proxy to the backend cfssl

d8e16010e9-+-Retire the HTTP listener for debmonitor (along with ferm rules)

10ecf5913b-+-Fix relforge100[3,4] definitions in site.pp

f82c422041-+-mobileapps: enable monitoring on the TLS endpoint

d8be22ec8d-+-profile::java: actualy drop undef from lookup function

95ed4b1b73-+-Remove auth parameter for Graphite base class

a8d4db9557-+-deployment_server::helmfile: add service_proxy to the general file

d2c7128022-+-installserver::web_server: switch from nginx full to light variant

c97b8deb1d-+-cescout: update hiera lookups (enclose keys in quotes)

d4163a243e-+-wikidough: update hiera lookups (enclose keys in quotes)

073c46fa11-+-arclamp: provide Swift credentials to cron jobs

28359c032a-+-arclamp: add data types

378474ab7a-+-openstack::nova::placement::monitor: update process regex

ba12ad8c87-+-eqiad1 openstack: replace missing monitor classes

86ce058b47-+-mariadb: Add types to mariadb::service parameters

8e21ba94ca-+-wmfmariadbpy: create seperate module/profile for wmfmariadbpy

55ec3881e4-+-wmflib: Add wmflib::Enable_Service

7c3c9f3a01-+-mariadb: simplify mariadb::service

a8b4a435d1-+-webperf::arclamp: fix typos in lookup

9d2c3a5a93-+-webperf: replace hiera() with lookup() in profiles

e736c5aba0-+-phabricator: remove hiera() lookup from module

e72a197892-+-codesearch: Update URL to wmcloud.org and fix name

0f5804fc1a-+-Update analytics snapshots data purge

0017bfdca0-+-openstack::cumin: remove jessie support

22390cbbee-+-prometheus: switch over to buster kafkamon hosts

b763edb316-+-mariadb: Make mariadb::config basedir required.

0c53bb3b65-+-mariadb: Add profile::mariadb::packages_client

606242680b-+-mariadb: Allow overriding of wmf-mariadb version in hiera

518c195c6a-+-alerts: combine alerts.wm.o and icinga.wm.o certificates

09c48a9ab3-+-mariadb: Create profile::mariadb::packages_wmf

121dc43a0b-+-Remove apt::pin for ceph packages in openstack/rocky/stretch

f123d97ac5-+-Add debmonitor1002 as debmonitor server

0b2b819d19-+-mariadb: Promote db1128 to m5 master

988edd7f51-+-Add --notify-age-in-days option to notify users before draft purge

2e7a1abf91-+-dnsdist: add validate_cmd attribute to the dnsdist.conf resource

1f77aeec06-+-cfssl: add ocsp responder dump file

e65ddd1009-+-nftables: basefirewall: allow monitoring hosts

5c79272bba-+-cfssl: add ocsp responder servie

7278aeb338-+-Add apache config for api.wikimedia.org

a2aa6f2295-+-cloudgw: use newer nftables and kernel

89c8608297-+-cfssl: move auth keys to correct section

cd3baec17c-+-cloudgw: fix hiera variable name

e5d0abf3d4-+-cfssl: convert mapped Hash back to a hash

7aeff85f9d-+-nftables::file: break puppet dependency cycle

4ae907f14d-+-Add ms-be2057 to swift firewall

bb8bc0c31c-+-swift: extend ferm rules to cover more ports

83e355fc8b-+-Adding kubernetes1017 to site.pp

84501c3162-+-admin: Add type annotation

92c61974fc-+-Add type annotation to profile::analytics::cluster::packages::common

9010f66296-+-Openstack Nova: add a hack that validates server names

aa1dbf8a91-+-openstack: replace hiera() with lookup() in several places

9219355a92-+-scap: add data types, lint fixes

42b6e001a7-+-Adding nodes an-worker1096-1117 to site.pp

fe9237764a-+-wikireplicas: test removing deprecated passwords module from role

c5dcb34089-+-pki: add authkey support and keys

5a474d1410-+-wmcs admin scripts: add wmcs-instance-fqdns

2f60ef3d1f-+-Revert "mediawiki: Add api.wikimedia.org"

3883f9b059-+-swift: fix swiftrepl after switchover

bd7251f4ff-+-mediawiki: Add api.wikimedia.org

e67620119f-+-pki: Add OCSP configueration

36b1e83952-+-Revert "prometheus: switch over to buster kafkamon hosts"

3c297d5510-+-prometheus: switch over to buster kafkamon hosts

2a63f9186f-+-pki: add db config and oscp profile/certifiacte

346e610b81-+-sqlite: correctly initiate with the schema

1471109e31-+-correct ensure_resource call

4e8ff7e4dc-+-cprrect parameter name

e6e84fc2ac-+-pki: add sqlite DB

7cd9f82c45-+-cloud: bootstrap the cloudgw role/profile

7ce7fa987c-+-rasdaemon: only install rasdaemon on buster systems

dba87971c7-+-role::mx: parameterise otrs db variables

1da4e6b0ba-+-varnish: stop installing libvmod-tbf

1a55876d95-+-role::kafka::jumbo::broker: move down inclusion of profile::standard

b7209654bf-+-varnish: do not explicitly install libvarnishapi1

9efc003f26-+-prometheus: add 'alertmanagers' setting to all instances

dc9513d644-+-prometheus: minimal default alerts for Prometheus

eda5359066-+-varnish: give CAP_DAC_OVERRIDE back to root

efe1bf51c7-+-disable category rdf dumps for now

e652ddf8a7-+-prometheus: hiera()->lookup() and data types in exporters, part 2

23d5e11727-+-wikidough: add an option to set the landing page

1daecc22b4-+-site/DHCP: decom releases1001.eqiad.wmnet

c86442d56e-+-camus - don't check eqiad topics while DC switchover to codfw is ongoing

324450f56d-+-nftables: drop service params

3c0c9b2063-+-nftables: use wmflib::ensure for the service parameter

2584e7afdd-+-nftables: reorder masking operations to don't race with service state changes

e167daa7cc-+-nftables: mask the service if not running

ab55070ba7-+-nftables: override systemd service file

14931b012f-+-nftables: add infrastructure for customizing the ruleset

1c3af622ec-+-prometheus: move beta to its own profile

71c027993e-+-alertmanager: use amtool check-config as validate_cmd

1c3d8d8cac-+-icinga: support contactgroups stubs

4a2a8d467f-+-hieradata: fix undefined for aptrepo gpg_pubring

7ecaf1b732-+-aptrepo: import reprepro 'updates' public keys

403f37c493-+-ldap: remove jessie support

64091d7ab9-+-k8s::deployment_server: hiera() -> lookup()

83eab4a108-+-miscweb: rename misc_apps to miscweb for consistency

f868d23a3c-+-rename webserver_misc_apps to miscweb

9417e2eacc-+-deployment::rsync: add data types

1867cc96b7-+-mediawiki::deployment::server: add data types, hiera->lookup

f71398f0a7-+-OTRS: add data types to parameters

4ee081cd03-+-Ceph mon nodes: re-enable prometheus access

2be85b968e-+-prometheus: hiera() -> lookup(), add data type for prometheus_nodes

685a07606f-+-graphite: remove jessie support

65938653fb-+-purged: only care about the lowest last-event-time

ffb74170f3-+-profile::openstack: drop legacy validate_ functions

5f56de9c76-+-debmonitor: Fix dependencies on Buster

284848cd6e-+-spec_helper: fix hiera definition in shared spec helper

b2a220e231-+-Add debmonitor::server role to debmonitor2002

0eada59073-+-spicerack: create configuration for the switchdc.services cookbook

33cf3e9042-+-move dumps around on the snapshots in prep for network upgrade work

66be9e5dc7-+-Openstack Nova: Add new enable_nova_rbd hiera setting

055ed9e826-+-microsites/misc_apps: add data types for host names

74677ab743-+-icinga::ircbot:: add data types and hiera()->lookup()

14de33e5db-+-wmcs admin scripts: added wmcs-flavorusage

fc4f45d3f5-+-wikimania_scholarships: split udp2log host into FQDN and port, alignments

a92701bd04-+-cloudcumin: remove openstack packages that are already now in all vms

0fdee2ea09-+-cloud-vps: Add python3 client packages in cloud

101212f3ed-+-Openstack Nova compute: hack around a bug with threading on Buster

b835ef27c7-+-wikimania_scholarships: add data types to parameters

fc1c1417fe-+-site: remove mw2196.codfw.wmnet

878e34d71a-+-shared-storage: add specific NFS volume monitoring for cleanups

a7252d62b4-+-sqlite: add sqlite module

69c453d6b8-+-Add debmonitor1002/2002 to puppet

f403b727f4-+-wmcs: expose metricsinfra alert manager

e069a73dc3-+-Revert "Switch openstack::serverpackages::rocky::stretch to component/ceph"

2c7cbe72a7-+-Switch openstack::serverpackages::rocky::stretch to component/ceph

a4570ecfc2-+-Add ms-be2057 to site.pp with role insetup

d8a3856fba-+-site: remove mw2189-mw2195,mw2197-mw2199

b21469e143-+-site: remove mw2187-mw2195, mw2197-mw2199, mw2135-mw2147, mw2200-mw2214

37f87aac20-+-Revert "shared-storage: add specific NFS volume monitoring for cleanups"

1259801660-+-shared-storage: add specific NFS volume monitoring for cleanups

011b7ff9ca-+-pki: correct creates path

ff1e04b7fa-+-pki: fix heredoc command

f8c67db55d-+-pki: use safe_title

540f25b67a-+-pki: add ability to generate intermidiates

ed1b2e01f9-+-alertmanager: use port 9094 for cluster/HA

01a8256292-+-mariadb: Use hiera for shard+role for all profiles.

16cd1bd4ab-+-cfssl: update ca_constraint parameter

17197eed2a-+-mediawiki::php::restarts: Allow disabling of php-fpm restarts

785c328204-+-grafana: set root_url to fix dashboard redirects

5487db17b4-+-Remove old schema[12]00[12] from puppet

b5fa137148-+-profile: re-enable grafana rsync codfw->eqiad

d90b1444f0-+-alertmanager: assign AM-specific active_host/partners variables

637a880419-+-mediawiki/php: use new data type for PHP version

78f50e0a0f-+-wmcs galera tests: don't page the whole SRE team for galera issues!

f855d4dcce-+-cfssl: add additional usages

78237aba8b-+-ripeatlas: bump IPv6 failure threshold

81f8962a48-+-pki::server: refactor to pass through params

88023357e8-+-pki::server: fix secret location

6555d3c24b-+-pki::server: Manage root certificate

3077541bf4-+-pki::server: use correct key paramater

fcdbe52215-+-mariadb: Setup section->port assignment on puppet

73c13de1b7-+-pki: add managed root CSR certificate

f21e30db38-+-cfssl: manage base config dir

9e84b216d5-+-pki: Use correct profile name

3c9487db4b-+-pki: add cfssl and pki profile to pki role

2b40f9277f-+-pki: add new PKI role

88137624f7-+-dynamicproxy: serve default /robots.txt and /favicon.ico for Toolforge

219493d2d2-+-dynamicproxy: Drop temporary file cleanup blocks

c308129f11-+-wmcs admin scripts: add wmcs-ceph-migrate

072d02040c-+-cloudvirts: add ceph config to non-ceph-enabled cloudvirts

a99b902729-+-Add a weekly reload job for wcqs data reload

11edea2264-+-webperf: add data types to profiles

6c0b6807ce-+-zuul: add data types, replace hiera() with lookup()

e9dad8d3c1-+-profile::elasticserach: add version 7.9 to enum

35dfcfe2bf-+-logstash: add #o11y tag to logstash alert descriptions

b023ea0021-+-wikireplicas: fix path typo for the heartbeat-views file

c7a576499c-+-wikireplicas: refactor to eliminate confusing "labsdb" naming

72522132e0-+-Exclude superset_staging from the db1108's meta replication

a7388cdca6-+-mariadb-backups: Setup dbprov1003

42b6c40589-+-icinga_exporter: export problems only from Icinga active_host

a1fcc17e17-+-cache: remove 'backend_services' hiera setting

1077a86b67-+-wmcs: collect prometheus metrics from alertmanager in metricsinfra

5ccff20434-+-pontoon: Use a symlink for /etc/puppet/hieradata/pontoon

23a00eb080-+-grafana: remove deprecated settings

0f7951ac38-+-Puppet: change eqord ASN to 65020

b3fcb9ef1b-+-toolforge: Remove jessie conditionals

872ce4df03-+-site, install_server: Remove mc2028 for decom

e07460cc8b-+-site: move mc2037 to role mediawiki::memcached

620d386cfe-+-aptrepo: add thirdparty/elastic79 component

b29389bfbf-+-standard_packages: remove purge of 'at' package

6bb529a25c-+-mariadb: Move db1128 to m5

483f332dfd-+-Adding an-test-masters/test-coord1001 to site.pp role insetup

bbd5cebf19-+-Adding an-test-workers to site.pp insetup role

06e1307192-+-cache: remove '_ats' suffix from DC names

25ea084a97-+-prometheus: add alerts to 'ops' instance

d394096899-+-prometheus: export icinga service problems as metrics

314ba9705a-+-cloud: Remove legacy conditionals from profile::base::labs

fe84b6cb2d-+-Fixing dbprov1003 site.pp

38a914605e-+-Adding pki1001 server to site.pp insetup role

237719856b-+-Updating site.pp file for dbprov1003 switched it to role:insetup to be safe

b2af307df2-+-cloud-vps: improve flavor monitoring

6334a48db1-+-wikistats (cloud): replace wmflabs.org with wmcloud.org and update README

602e4ca339-+-Enable file query events for WCQS

1aed069a23-+-wmcs: amend the check-flavor-aggregates test to send an email

214213e6cc-+-doc: set  WMF_DOC_PATH environment variable

d5c5ac44b2-+-Add pki2001 to site.pp and fixed kubernetes2017 typo

d119163fad-+-doc: add a placeholder in /srv/doc for Bacula

566eb6b210-+-doc: prepare /srv/doc as the new destination

bb56d25c26-+-ci: bring back jenkins-deploy in the docker group

3ae9ac0a84-+-Add kubernetes2017 to site.pp

27d37a1922-+-delete role::xhgui::app

71ca558146-+-remove tungsten from site, DHCP and partman

f6ba162109-+-ci: switch integration.wikimedia.org to scap DocumentRoot

1b6a3a47d0-+-testreduce: add parameters to control client services

61e97d25f7-+-wikidough: enable DNSSEC validation in pdns-recursor

36046c2db8-+-role::ores: enable the service proxy to the MediaWiki api

bb6819fc79-+-dumps: Start blocking by useragent

575fde9235-+-Revert "dumps: Start blocking by useragent"

0c5bf87547-+-dumps: Start blocking by useragent

05772cdb2e-+-testreduce::server: add data types to parameters

c66b86f57d-+-parsoid/testreduce: add parameter to control parsoid-rt service

7b563d47e0-+-decom releases2001

9feddacb9f-+-Mark cloudvirt1015 as spare

49066a5308-+-haveged: install haveged on VM'si debian < buster  by default

0d33bfb057-+-Add mc2037 to site.pp with role insetup

d6db03b1b3-+-pontoon: stack-specific hiera settings

ffe5bb4da7-+-prometheus: use 'regex' to drop alert labels

8e88be5504-+-librenms: use CN for realname which is case preserving

621937adb9-+-prometheus: drop 'replica' label in alerts

2750c81ad9-+-librenms: use the ldap uid to map users

85cd3ff6d7-+-icinga: make sure update-etcd-mw-config-lastindex is enabled

26d2d45de3-+-icinga: ensure tmpfs cleanup

f551c1123b-+-profile: refactor logmsgbot to follow Icinga failover

d8532a0e0e-+-profile: switch Grafana plugins to Debian package

6178c1da4f-+-cloudvirt1006.eqiad.wmnet: move to role::spare::system

8936d700b6-+-prometheus: remove unnecessary define and split mediawiki queries by channel

8a2988ab21-+-cloudvirt1024: move to new role, 'virt_ceph_and_backy'

96b148506d-+-cloudvirt1024: move to Buster and make a ceph cloudvirt

650347a7f7-+-profile::ci: add more data types to parameters

eb6c2a127f-+-Revert "wmcs/ceph/backy: move backup engine to cloudstore1009"

f2f2e968a7-+-wmcs/ceph/backy: move backup engine to cloudstore1009

a18c40ba2d-+-backy2: hack in a fix to an upstream bug in 'backy2 du'

72ae8e9a23-+-backy2: remove some unused hiera settings

84f0565bc8-+-ci::jenkins: add data types to parameters

2ebce3d3cb-+-profile::idp::client::httpd_legacy: drop unused class

4f42e12c3f-+-alerting_host: updated to use new apero cas define

d673d4cc22-+-jupyterhub - Subscribe jupyterhub to spawners.py

08eb262e63-+-librenms: migrate to new idp define

94be310984-+-tendril: migrate hue to new idp define

ef9e0ac0fd-+-piwik: migrate hue to new idp define

b63db69809-+-jupyterhub - make sure $config_path is created

7269f76df6-+-jupyterhub - Create config files explicitly with proper modes

7804a1210e-+-people: move ui to new mod_auth_cas define

4bbcf9af55-+-thanos: move ui to new mod_auth_cas define

8c08562d73-+-yarn: move ui to new mod_auth_cas define

5322270b6b-+-domainproxy: enforce TLS by default

3fad8156fa-+-jupyterhub-conda -  Always set proxy_pid_file to a writable path

51fc6d358c-+-analytics_cluster/superset: use updated mod_auth_cas client

497afcdef0-+-prometheus: add alertmanager::web jobs

678265041b-+-graphite: update to use new apereo cas define

406a837456-+-Fix typo in jupyterhub::server

74b3f15d5e-+-turnilo: update to use new apereo cas define

dfc519e0e7-+-correct resource name

7992f3e744-+-profile::hue: migrate hue to new idp define

be4a47b762-+-Add profile::analytics::jupyterhub

9c899411d6-+-profile::puppetboard: use include instead of require to avoid dep loops

d55b19a642-+-profile::puppetboard: drop require_packages

7ed00d17f1-+-mariadb: Update name of wmfmariadbpy package

5e36b12b2d-+-mariadb: Drop check_mariadb.py in favour of packaged version

9b1fd9ff05-+-profile::puppetboard: convert puppetboard to new idp class

d19b57d527-+-profile::idp::client::httpd: create new httpd class

1f4068dc73-+-profile::idp::client::httpd: retire currently class

888cf80664-+-Enable profile::alertmanager::web on alerting_host

e71f2e2024-+-Add prometheus::karma and profile::alertmanager::web

52e5f1694b-+-mariadb: Allow install new es hosts in eqiad/codfw

efe7c10715-+-phabricator: Add new db user for the daemon, separate from web request user

c425d5ecdd-+-mariadb: Fix referencing of wrong variable.

ca85903afd-+-mariadb: Allow the installation of clouddb hosts

bc637b5653-+-Phabricator: use a separate mysql user for phd daemons

a0027ef9da-+-site.pp: Specify the correct role for db1132

47b301a44b-+-db1128: Specify db1128 shard

62f86efc3e-+-dbproxy1016,dbproxy1020: Change m3 master

82b7d5010e-+-parsoid::testing: add support for buster by adding mariadb-client

4411603c96-+-testreduce: add profile parsoid::testing to role

4e7b8e0566-+-wmcs-backup-instances: add a dict of regexps to exclude servers from backup

405f591460-+-parsoid::testreduce: add rt_server profile to role

9a80ab9d90-+-parsoid::testreduce: add rt_client profile to role

edab9b87b4-+-wikidough: increase TCP connection limits for dnsrecursor

fc8634eeac-+-releases:reprepro: update outdated warning comments

c6abf95d72-+-mariadb-backups: Enable eqiad backups, which are sent to codfw (backup2001)

033c79b40e-+-graphite: move graphite paramters under profile namespace

5c67ed941b-+-prometheus: add alertmanagers configuration

db62ad04ee-+-discovery: clean up old hiera values

cc1da6e4c5-+-Revert "ferm: ensure rules always end in a semi colon"

f5122edfd3-+-ferm: ensure rules always end in a semi colon

02765b91d1-+-prometheus: add alertmanager jobs

2c7532776a-+-mariadb: Give better name to sustained replication lag alert

c9998cde1f-+-Backups: Fix storage definition for Databases on codfw

793824183a-+-Add new pool DatabasesCodfw to backup data generated on eqiad

6959c41cd1-+-Disable cgroup memory accounting

a06605b96e-+-mariadb: Disable snapshots being sent to bacula

e1db6a3d15-+-profile::analytics::refinery::job::refine: bump jar version

e865383b94-+-webperf: remove the xhgui_old_host parameter

dcfc28228b-+-releases: ensure to have motd warnings on all secondary servers

a0e90deee7-+-releases: avoid adding rsync when source and dest are the same

1477e9bfc5-+-releases: reprepro rsync needs to be on all servers

31e56ba942-+-xhgui: increase PHP memory limit to 512MB

ccf25926c8-+-backy2 alerting: use wmcs-team-email, not wmcs-email

a5a3438371-+-releases: rsync needs to be on all servers incl the primary

0fb00363ef-+-wmcs/ceph/backy2: move our cleanup logic into a script

cc81d5c8b6-+-wmcs/ceph/backy2: use 'root' user to run backups

58e1b29fcf-+-wmcs/ceph/backy: add timer to run a backup job and a cleanup job once per day

e129fd34ae-+-Remove backup role from cloudvirt1004

ccfe88139b-+-releases: allow rsyncing jenkins data between releases servers

a9138326e6-+-role::wmcs::ceph::backup: include observerenv

807666a62f-+-openstack clients: include python3 openstack client packages

b92278bfe7-+-Refine - temporarily exclude resource-purge from refinement

e895d3d21d-+-Add schema[12]00[34] dhcp + role config

d78e11591b-+-parsoid/testreduce: add a service_ensure parameter, stop on new server

0d4fbdf9b6-+-releases: do not monitor releases-jenkins on multiple hosts

4f8bdc21be-+-jenkins: redesign the way we manage service ensure/enable

ad5c5836b3-+-Create dispatch lag alerts for test.wikidata.org

86c71c4db9-+-camus -  Remove now unused mediawiki_events job

4108aed543-+-camus - Exclude mediawiki.job streams from eventgate-main_events job

d6998502d9-+-camus - replace mediawiki_events job with eventgate-main_events job

8ace1fcea7-+-doc: move Apache config to flat file

0ef9b11840-+-contint: move Apache config to flat file

257a2a4dc0-+-profile: add mtail user to list group

00b7da9ee8-+-alertmanager: allow access from all Prometheis

b347490d01-+-mariadb-backups: Remove replication lag avg check from backup sources

094b11dae9-+-alertmanager: add advertise-address cluster option

c445ed3379-+-helm: Add wmf-stable helm repo

65a98f1522-+-add alertmanager to alerting_host

05680f9651-+-prometheus: Introduce Alertmanager

1ad02715fc-+-nova flavor aggregate monitoring: increase timeout

e3496eb774-+-Openstack Nova: warn if any flavors are not assigned aggregates

5df529ba7e-+-camus - include mediawiki.api-request in eventgate-analytics topics to check

1356ff80fa-+-web_testing: Clean up the old class used for apache-fast-test.

b6c5bde9b7-+-camus - replace mediawiki_analytics_events with eventgate-analytics_events job

4e87de95b5-+-Refine - bump version to 0.0.132, but default to not merging Hive schemas

9e3cb4487d-+-lists: remove fermium entry from site.pp

2800e8e0e1-+-releases: Remove absent resources

8d69461642-+-web_testing: Remove the apache-fast-test placeholder

3a568e3ba0-+-lists: make lists1001 primary mailman host

c9be1729e9-+-camus::job - Fix typo in stream_configs_constraints_opt

863a92a05c-+-camus - declare event service specific camus::jobs.

cd329dc378-+-wmcs/ceph/backy fix name of backup script

b0f1a9cc36-+-camus::job - pass stream_configs_constraints through to refinery camus wrapper

b6d0ec85b9-+-wmcs/ceph/backy: add basic backup script, wmcs-backup-instances

b4367fa187-+-lists: stop automatically sycing fermium to lists1001

ae2219b8b1-+-deployment_server::helmfile: fix typo

5d40219a9f-+-deployment_server::helmfile: generate files for new-style helmfile organization

3d34322825-+-grafana: temp disable grafana db sync ahead of upgrade

6854e722fd-+-helm: Remove obsolete cron resource

f8610e4e26-+-releases: Remove deployment-charts repo

1c622ddc1a-+-arclamp: configurable email address for cron jobs

d29974eb9a-+-releases: allow http connections also from cumin masters

889937eb1d-+-prometheus: fix typo

ac72506c75-+-arclamp: require python-swiftclient

6064ab3c31-+-arclamp: Run & scrape Prometheus exporter

81c8cdb998-+-arclamp: also send mail to perf-team for compress cron job

f8fc52239b-+-profile: disable statsd_exporter relay for ores

4f7043cf77-+-httpbb: move test_releases.yaml to releases subdir

b5acba7c9c-+-arclamp: remove absented resources for xenon

f506d72020-+-arclamp: send mail from generate-svg cronjob to perf-team

ca43ae42fa-+-mariadb: Increase labsdb* memory monitoring thresholds

c9cbaab751-+-kafkamon: add role::kafka::monitoring_buster, assign kafkamon[12]002

0cba0da322-+-mariadb: Add memory check to most other mariadb roles other than core

42849470cc-+-role: add alertmanager::irc to alerting_host

53d7435ccc-+-alertmanager: add IRC notifier

4d29e946da-+-cache: move all VCL files to the same directory

c7ab41c175-+-mariadb: Add memory monitoring to core (mw) db hosts

6de8965d31-+-profile::webperf::processors: fix prometheus monitors

4d940803b8-+-profile::analytics::refinery::job::refine: exclude MobileWebUIClickTracking

9c208f6e4f-+-Additional prefixes for sdoc for wcqs

02501c7eb5-+-paws: monitor the new URLs instead of the deprecated ones

8daeb33633-+-Revert "Bump refine job refinery version to 0.0.132 to fix $schema field bug"

79bbba3e47-+-wmcs/ceph/backy: add python3 packages for rbd and rados

0c5fa79ea0-+-wmcs/backy2/ceph: add admin keyring so backy can access things

35393bb808-+-wmcs/ceph/backup: remove quotes that were messing with ferm

bc34481855-+-wmcs/ceph/backup: fix some copy/paste errors, move db host

7bee088cbf-+-cache: add type Profile::Cache::Sites

48ce9824f2-+-kibana: disable telemetry and newsfeed

26a94ba0dd-+-ATS: add function profile::trafficserver_caching_rules

737f0ad75d-+-mariadb: Add proof of concept of memory alert

da43050e8a-+-wmcs/ceph: split out rbd client profiles

8a67c5bf18-+-profile::gerrit::server: rename profile

72e84bdb43-+-profile::gerrit::server: correct hiera name space

95741a53cd-+-profile::gerrit::server: correct hiera name space

437e3272fc-+-Retool cloudvirt1004 and cloudvirt1006 as ceph/backy2 test hosts

fb2939161a-+-Introduce role::wmcs::ceph::backup

cf7bacf83f-+-profile::gerrit::migrations: correct hiera name space

6221e174be-+-backy2: fix up some dependency issues in install

96326529d7-+-shared-storage: remove nfs-manage-binds

0f3aca34bc-+-wikidough: enable QNAME minimisation for the dnsrecursor module

3794cd89b8-+-Add Backy2 module and profile

8408e5da53-+-profile:prometheus: fix typo

02601b9769-+-profile,prometheus: create define for prometheus-es-exporter configs

a476967838-+-ci: Bump Buster docker.io version to match apt repos

a352eb7031-+-prometheus: puppetized install of prometheus-es-exporter

bb2fbd0950-+-Add check_prometheus rules for navtiming

4ab28e2942-+-helm: Replace repo update cronjob by systemd timer

a9e46368a5-+-mariadb-backup: Initial setup of dbprov2003

f9b89ceebb-+-httpbb: add directory and test file for releases.wm.org

e0bc4d21b3-+-wmcs galera: change our HA approach to primary/backups for db access

e250327185-+-dnsrecursor: allow installation of pdns-recursor from component

d6186bb242-+-releases: use --delete when rsyncing files between servers

b998bcc835-+-httpbb: Remove temporary ensure-absents for moved files

74175b258f-+-httpbb: Fix breakage caused by 618554, create dir before files

3dbb9acdd1-+-releases: open firewall hole for http from deployment_server

f86e62de9f-+-httpbb: Move test files into subdirectories by host type.

4300df97ae-+-Add dbprov2003 to site.pp

1a404372f6-+-haproxy-galera: Make a meaningful healthcheck

86d2ab9242-+-alerting_host: assign alert[12]001 role::alerting_host

5ea16c70f3-+-mariadb: Use correct binlog format for db_inventory

bcee65137f-+-mobileapps: Remove the profile and the role

560b66729d-+-druid: puppet cleanup after upgrading all clusters to 0.19

3c9ad4a6aa-+-mobileapps: Remove mobileapps from scb

f94d342507-+-profile::prometheus::ops: change mjolnir's target classes

180bc4329e-+-mariadb: Reimage db1132 to Buster

b2c9a5f441-+-rsync::quickdatacopy: add optional parameter to let rsync --delete files

6c84074166-+-mjolnir: Provide primary cirrus cluster url to msearch daemon

3c88a342b3-+-role::search::loader: add URL of elastic search endpoing

adda6eb69b-+-ores: add envoy-proxy for TLS termination behind ATS

ea72d1b461-+-aphlict: make client port and IP also configurable, rename parameters

e206cf5ae6-+-Move mjolnir's daemons to search-loader hosts

99c33db78c-+-mediawiki::maintenance: install modsecurity-crs

d47615310d-+-analytics::reportupdater::jobs: Absent ee-beta-features job

de2349375c-+-Install anaconda-wmf on stat nodes

2053c98638-+-atskafka: double buffering_ms

27bf76668b-+-deployment_server::helmfile: use to_yaml instead of a template

c7f2b6e5e8-+-Fix LibreNMs IRC bot

e9e362ba5b-+-librenms: fix purge.py definition

037d548838-+-librenms: replace python2 purge.py with native options, extend retention.

d2ded7870f-+-kubernetes: Stop sending ICMP redirects

1f03aaec0c-+-mariadb: Promote db1107 to m2 master

d215583fd5-+-Fix daily config file path for Spark EL2Druid Analytics jobs

301a760db5-+-Fix Spark config file path for Daily EL2Druid Analyitcs jobs

bebea59094-+-mediawiki::maintenance: load mod_security2 also on mwmaint*, not just mw*

977a883008-+-Galera: another attempt to get the ensure of the service right

a85d79cd78-+-Galera: split out the running/stopped logic into a service define

0ee1a00263-+-galera: remove "critical" tag from another monitor spot

1d5e51de66-+-Mariadb/galera: override TimeoutStartSec/TimeoutStopSec

7de94238f5-+-Bump refine job refinery version to 0.0.132 to fix $schema field bug

d500845323-+-exim4: move daily paniclog rotate from exim4-base to exim4-paniclog

2c61a9e716-+-dnsdist: update value for IP rate-limiting

beef4b809e-+-galera: don't page prod SRE for this cluster

7fcaa71570-+-Galera: don't restart db service on config change

671b49eec9-+-librenms: hide diff for files with passwords

a927ed47ea-+-Add mtail program for monitoring the Zuul error log

91cf4ce017-+-zuul::server: Replace hiera() with lookup()

c843dee4ca-+-librenms: fix python3 dependency

33e8798326-+-librenms: update .env file with db connection parameters

2ce1bda6f4-+-atskafka: lower request.required.acks

fd05e8d6ff-+-prometheus: import atskafka batch metrics

f6c387f55a-+-mariadb: Drop mysql.py in favour of wmfmariadbpy package

bc1bb1ad0e-+-mariadb: Fix variable value in replication_lag

a67c98b151-+-Fix config file path in Eventlogging to Druid jobs

8acbaf58dd-+-Set spark deploy-mode client for all the Analytics Hive to Druid jobs

2c800a5b33-+-atskafka: set queue.buffering.max.ms to 1s

3991caf9c8-+-atskafka: tune librdkafka settings one by one

459e4d466f-+-helm: Fix path to grep

63494db70d-+-helm: Allow to update existing repositories with new URL

649d0d6d85-+-helm: Switch stable chart repository to chartmuseum

ce4c644c5e-+-openstack::nova::compute::service::rocky::buster: use legacy ebtables

001a36df94-+-Nova compute: remove some old Ubuntu->Debian migration code

9b5642603a-+-Make cloudvirt103[3-9] into cloudvirts

6072663895-+-Fix comment about cloudvirts and scheduling

aad7a29dff-+-Revert "Move cloudvirt1031 from virt_ceph to virt"

763ad9f737-+-Move cloudvirt1031 from virt_ceph to virt

0d35aede95-+-switch xhgui1001 to new xhgui role

f2aab8a2e2-+-Update role for cloudvirt1031 and 1032

961acb825d-+-otrs: Fix ferm::rule syntax

e3961f4675-+-atskafka: librdkafka settings tuning

7638cf2112-+-otrs: Disallow outgoing emails from test instance

ee2ca23398-+-helm: Allow multiple helm repositories

d5e87f28b3-+-cloudvirt103[1-9]: move to insetup until I can figure out what's happening

5c5fa59a02-+-Fix typo in sources for older distros on package build host (and remove jessie)

aab5eca0f1-+-chartmuseum: Change repository name to stable

8aa6221873-+-profile: ensure only one webrequest host sends 5xx to logstash

7ee9af118f-+-profile::mariadb::misc::analytics::multiinstance: change ports

ea4d266a9d-+-nova-compute: Remove a reference to a (now-not-always-present) mountpoint

c06e3831d7-+-cloudvirt103[1-9]: puppetize as thinvirts

0b2fdeedf6-+-xhgui: ensure the config file is written after the package is installed

eb22948627-+-switch xhgui2001 from xhgui::app to webperf::xhgui

9f29780e3d-+-xhgui: fix dependency cycle between php-twig package and APT pin

a0ce9fe761-+-paws haproxy: switch to the chained cert for TLS

f256be19fc-+-Make U2F token expiry configurable

587812e823-+-profile::druid::historical: set class prefixes like the other daemons

5070e6b968-+-sudo: create new command to create safe wildcard sudo commands

735718277d-+-Fix up ERB templates for Hue/CAS

8e9f035294-+-Decom weblog1001

ce35d3b8c7-+-[wcqs] use correct UriScheme in blazegraph

b479c1ef9c-+-assign kafkamon[12]002 role::insetup

6280058d2a-+-arclamp: restore 90 day retention

475e49c865-+-Revert "Revert "kibana: CVE-2020-7016 / CVE-2020-7017 mitigations""

099ed64f18-+-Revert "kibana: CVE-2020-7016 / CVE-2020-7017 mitigations"

a2a2f23d1a-+-kibana: CVE-2020-7016 / CVE-2020-7017 mitigations

1765a1bfdb-+-profile::thanos::httpd: pass maxconn and query_port to idp vhost

b9c17a9a4a-+-Add CAS support to Hue

50590ec245-+-Adding alert1001 to site.pp and dhpd file

36058905c1-+-prometheus: drop legacy validate_functions

1c28f73079-+-graphite::web: drop validate_functions and add type validation

3e7793d56c-+-helmfile: add data for enabling service proxy in k8s

a3ca2e642a-+-[wdqs] install openjdk-8-dbg

a1eb4c6a07-+-prometheus: hide diffs in snmp_exporter::module

15a86d6d92-+-Revert "Revert "[wdqs] add a new streaming updater profile""

05a479f22c-+-Remove ::role::deprecated::labsvagrant

caaf0b1c77-+-aphlict: make port and IP for the admin interface configurable

1feb953dcf-+-aphlict: add parameter/ferm rule to let phab server talk to admin port

27e6efcfe4-+-wmcs: standardize old ceph osd nodes

fd0ff8718a-+-ceph osds: rename bootstrap key, again

d4c058c2b4-+-ceph osd: rename bootstrap key

79f1e7cf69-+-dynamicproxy: Add custom response for missing proxy backend

d464544997-+-eventlogging - Stop outputing to local files on eventlogging server

229c083021-+-dynamicproxy: update error pages

938cf39339-+-logstash: fix thanos-query https url

075a5f7a6d-+-Ceph osd nodes: install bootstrap keyring

878ff4d0fa-+-sslcert: drop validate_ functions

4e6194fd72-+-Remove lvs from cloudcephmon nodes

da10dd084a-+-cloudceph: don't use lvs for prometheus monitoring

60745a0a36-+-keyholder: drop legacy validate functions

2c82cffbce-+-profile::mariadb::eventloggin: drop legacy validate_ function

601d4e3488-+-Make the rest of the cloudcephosd hosts into osd nodes

8f76032183-+-profile::redis::master: drop legacy validate_ functions

0232b04e3d-+-sysfs::confile: drop legacy functions and add type validation

63027e9d63-+-tmpreaper: drop legacy validate_ functions

d3b22610a6-+-statsd_proxy: drop validate functions

ad7e72da6e-+-sudo: drop validate functions

259a7bec95-+-udev::rule: drop legacy validate functions

0b26f5bb1f-+-mtail: drop legacy validate functions and add type validation

6a03398204-+-postgresql: drop validate_functions and add type enforcment

ffa44237da-+-security::pam: drop validate_functions and add type enforcment

6d9e19844d-+-kmod: drop legacy validate_ functions

f420c593ff-+-redis: fix legacy validate functions

8be3bca67b-+-tillerator: drop legacu validate_ functions

e030242f94-+-zuul: drop validate functions

e5327e903f-+-profile: move thanos-query clients to https

9cb0cf0a20-+-rancid: ship .gitconfig

aafbe11d8d-+-rancid: use active/failover netmon server for rsync

1809aed8ea-+-mediawiki: Create /etc/firejail/mediawiki.local

4cb06e9a6e-+-Install libmysqlclient18 from component/cloudera

894ee01474-+-profile::superset: Remove stretch support

6e4f1c7907-+-nutcracker: ensure verbosity is an integer

0892669f7e-+-nutcracker: drop puppet < 3.5 support

16d10a2df1-+-diamond: remove unused file

9f898c4006-+-Add analytics-product system user

6c57ee3a82-+-arclamp: fix cron specification

2c87d27ee2-+-aphlict: do not attempt to remove log and run dirs when absent

4fe7b1a919-+-Ceph: make cloudcephosd1004, 1005, 1006 into OSD nodes

33bf1c72a2-+-Ceph: make cloudcephosd1004, 5 and 6 osd nodes

23efd69fe2-+-arclamp: run arclamp-compress-logs from cron

7eeb06ca1b-+-airflow: Allow scap deploy user to set variables

57c5905298-+-Assign the Hue role to an-tool1009

dd3447c1c8-+-otrs: Add OTRS 6.0.29 prereq packages

8112e60012-+-Move cloudcephmon1001 from .wikimedia.org to .eqiad.wmnet

298140ca11-+-Fix typo in Hiera variable name

8843899079-+-profile::analytics::refinery::job::refine: disable monitor

66c12958dc-+-mariadb: Fix read-only logic in db_inventory

dbbaabf863-+-mariadb: Refactor tendril+zarcillo

fe95814113-+-chartmuseum: Run timer command (ExecStart) in a shell

19c2090689-+-chartmuseum: Add systemd timer to package and push charts

b9cf5f0de3-+-modules/systemd: Allow to define EnvironmentFile for timers

f4200a7c3a-+-prometheus: whitelist atskafka runtime metrics

00e23d01ea-+-Add CAS support to Superset

0dd36560b3-+-profile: add alert on no logs ingested

f504ad8916-+-Revert "Remove lilypond for now"

6a98d05b46-+-mariadb::monitor::prometheus: Remove unused parameters

6b230b3401-+-kubernetes::deployment_server::helmfile: use kube_env in .hfenv

9f9df23223-+-aphlict: add envoy for TLS termination

89de4c9c73-+-Add site.pp entries for cloudcephmon1001-1003.eqiad.wmnet

94004fdaff-+-aphlict: require php-cli package

51d2a68278-+-phabricator: fix the basedir/base_dir parameter name for aphlict

0db4d482e4-+-phabricator/aphlict: set base_dir parameter when using aphlict

58cea46be5-+-aphlict: remove requirement of the phab_deploy_finalize script

197af23bff-+-wikidough: set TLSv1.2 as the minimum version for DoT

8018d98438-+-Fix naming of cloudcephosd1004 in site.pp

1f0a77c6ca-+-Make cloudcephosd1005.eqiad.wmnet a ceph node

b9c7036be4-+-Add an-tool1009 to site.pp/DHCP

16594686f9-+-druid: add metrics for version 0.19 and update Druid test's config

03a9314f02-+-realm: Add oauth_ratelimit_client_tier to private_tables.

b6c4105c21-+-Add cloudsw1 switches to Icinga

1222d52dff-+-smokeping: default to active/active

7e2e623878-+-aphlict: add scap deploy target and missing parameters

d197e9de2a-+-Rename cloudcephosd1004 through 1015.

7ce5a17ba9-+-visualdiff: update git branch from ruthenium to scandium

1a4ae81632-+-Revert "[wdqs] add a new streaming updater profile"

e02a770f45-+-[wdqs] add a new streaming updater profile

3e337c1a64-+-ganeti: Remove metad from monitoring

05a108e5ec-+-ganeti: Fix wconfd monitoring typo

a41561f273-+-druid: allow different package/class prefixes for logging/alarming

f1b12c593f-+-Remove unused role

4b6c011c6d-+-role: force mpm_prefork for netmon/librenms

1a8de062a4-+-librenms: set bootstrap/cache permissions

c1bcf721ad-+-puppetboard: increase buffer size

3e64f46232-+-ganeti: Fix ganeti-mond typo

b1254406ad-+-librenms: add passive server for rsync server

d621978c6a-+-Add discovery records for chartmuseum

fefb093d77-+-rename the dump rsyncer script preparing for new one that rsyncs via secondary

8719dd3180-+-librenms: correct group map type

be8e993ce2-+-librenms: add additional parameters

50aa89e052-+-librenms: Fix hash definition

864fadd631-+-mariadb: Move db1107 from s1 to m2

5ba20ebfec-+-docker::registry: Allow param config to override defaults

b4fdbb0890-+-dnsdist: update module comments (no code change)

7f5839624b-+-wikidough: enable support for EDNS Client Subnet

9640f86bdd-+-prometheus: introduce role::prometheus::pop

e7908ab545-+-xhgui: Switch to extra_pkgs

38bba84462-+-Phabricator: Make scap's manage_user configurable

17868fe777-+-[wdqs] overrides default blazegraph ns

c7f47c89d8-+-dnsrecursor: add a parameter to set the use-incoming-edns-subnet option

3b77ad6e33-+-toolforge: enable delete API for docker-registry

124bbee7c5-+-dumps rsync refactor, better opts and flags handling

e41b797586-+-smokeping: don't sync data between hosts

e5532ef5da-+-Remove obsolete references to Yarn on hadoop::ui role

535db3b0ce-+-ATS: Move from /var/run/trafficserver to /run/trafficserver

2a24ee8370-+-mariadb: Use defined type in profile::mariadb::mysql_role

3178ec8db1-+-profile::thanos::frontend: Add SSO

0eeabc9c4b-+-profile: sync weblog data to centrallog2001

bc8ef016a1-+-icinga: add logs retention

338502df99-+-Configure yarn/testcluster for LDAP auth only

426f805115-+-rsync: fix quickdatacopy sync script

681a2493d4-+-[wdqs] drop updater mode config

2befc65717-+-airflow: Include refinery python dependencies

0d24492a40-+-webrequest: add rsync server to migrate data

f2b1a5e3c5-+-Add logout location

530749637b-+-Switch Turnilo to CAS

c94ad925c1-+-Remove unused role

7e553d1a0e-+-mariadb: Move db1084 to s1

832ad586ae-+-osm: Drop role::osm::master

970e1ab9b7-+-Revert - Refine Don't use merged Hive + event schema when reading

e0844bca50-+-trafficserver::instance: move single line scripts inline

95919fc13d-+-profile::thanos::httpd: move defaults to hiera

3e4840e87e-+-varnish::logging: move default definitions inline

dcd9cf1cbc-+-wmcs: Add redirector site for wmcloud.org and www.wmcloud.org

716c39a089-+-tlsproxy: drop websocket_support

209b9fc570-+-Don't use merged Hive + event schema when reading raw event data

dd1a36480b-+-otrs: vary mysql-client on debian distro version

db19d76d8d-+-Adding new cloudceph servers to site.pp

410df049a4-+-mcrouter: store defaults in module not in hiera

70a42f2150-+-P:mediawiki::mcrouter_wancache: refactor parameters

b98abe3823-+-profile::mediawiki::mcrouter_wancache: refactor

87dae2e934-+-otrs: Allow disabling daemon in profile

cdc55d6d59-+-otrs: Set otrs1001 as OTRS role

b6c97f2659-+-role::parsoid: Add missing exporters for parsoid

92595c5efc-+-Remove IDP defintions for logstash vhosts

4c87f63201-+-mariadb: Comment out sections that do not appear in puppet.

777e61e86e-+-mariadb-backups: Adjust check parameters to get less false positives

6424b83ecb-+-Switch yarn.wikimedia.org to CAS

47eb8b67b5-+-mariadb: Add replication monitoring for zarcillo

5450c2a7b2-+-netbox: make HTTP(S) checks use dynamic hostname

0309964a22-+-mariadb: Promote es1021 to es4 master.

10f7f98cc3-+-profile::analytics::search::airflow: use TLS with mysql

9eb3bfd2e8-+-prometheus[345]001 assign role::prometheus, add to prometheus_nodes

a036578c13-+-backups: Move metadata monitoring to icinga hosts.

ced5da2161-+-start restructure of dumps rsync

148f8a4629-+-statsite::instance: fix style violation in define

af26867a00-+-role: fold weblog into centrallog

1a79e85d3e-+-ATS: Support listening on multiple ports

9259b0d8f4-+-profile::grafana: add types and convert to lookup

1339cdf120-+-profile::kubernetes::deployment_server: add kube-env script

5fcb736d61-+-mariadp::misc::idp_test: remove unused profile

b7f47c9ce1-+-icinga: update Varnish healthcheck endpoint

31a2bf201f-+-mariadb: Changing link to section from "slave" to "replica"

48a4a24b59-+-aphlict: use default basedir, not custom

b581b97251-+-aphlict: no longer require Phabricator class itself

d8ab637f7c-+-aphlict: comment-out envoy TLS part for now

4a89c2b428-+-phabricator: create separate role/profile for aphlict

cbe6d58c99-+-dnsdist: add a parameter to set the size of the ring buffers

d4bd03da4e-+-dnsdist: reload the certificates instead of restarting the service

e71a52a374-+-profile::piwik::database: add TLS config for mariadb

fc9d4a077e-+-profile::analytics::database::meta: enable TLS

8ed80788cb-+-profile::hive::client: allow to specify jdbc host:port

8d7d63ac62-+-profile::oozie::server: allow to specific jdbc host:port

f61c0f5c53-+-cloud: introduce very basic nftables setup in cloudnet servers

43527eb4ba-+-Install the fcgid package on Netmon

0fd7888cfa-+-Require profile::hadoop::common in the yarn_proxy profile

fd941c8df9-+-Apply Yarn role to an-tool1008

b00e59c6f2-+-prometheus::memcached_exporter: fix arguments hiera call

f548b0c7df-+-Introduce search-loader[12]001

ae283a2cd2-+-Add separate role for Yarn

1ab7675f2f-+-visualdiff: ensure /srv/visualdiff/testreduce exists

add40865ba-+-parsoid: create new role to install just testreduce

c610f11f15-+-assign role::insetup to prometheus[345]001

8cfa6248ab-+-wikilabels::session: don't quote the port number

c2453a1c1f-+-cloud-nfs: Allow changing the nfs mount version

bbc3134617-+-site: add testreduce1001 with insetup role

0329bfcaf8-+-site: add aphlict1001 with insetup role

d32a013685-+-mariadb: Update zarcillo location to db1115

ec9c3a8815-+-mcrouter_wancache: Add mcrouter support for a machine-local memcached instance

70c23300bd-+-Add an-tool1008 to site.pp

37d232f3e1-+-Allow installing additional libapache2-mod* packages in the httpd class

81744245bb-+-Revert "Switch yarn.wikimedia.org to CAS"

e70728582a-+-Switch yarn.wikimedia.org to CAS

1cd0798a7b-+-block_abuse_nets: enable block abuse nets on misc sites

969b0fa3d9-+-profile::waf::apache::administrative: remove waf config

2c9ceb193d-+-releases: pull MW security patches from deployment server on all servers

0b21db518a-+-Change labtestpuppetmaster2001 to role(spare::system)

e5d06dc040-+-updating ps1-c8-eqiad

07ff795ba0-+-Allow aptly::repo commands to run as alternate user

7403435209-+-Moved a comment to a better place

8394eb1535-+-purged: stop passing -mcast_addrs

b0dd2466b6-+-mariadb-backups: Fix typo when calling check_mariadb_backups.py

abb9787716-+-replace playbook links w/ shortened URLs

a514752554-+-Revert "Revert "database-backups: Move database-backup metadata tables from zarcillo to m1""

8ccf0c6538-+-Revert "database-backups: Move database-backup metadata tables from zarcillo to m1"

61a4591e03-+-database-backups: Move database-backup metadata tables from zarcillo to m1

083c073c44-+-role: port netmon to Buster

8611100719-+-profile::piwik::webserver: avoid port 80 for HTTP

e1876a6326-+-envoyproxy: add ability to also listen on IPv6

8647314f8a-+-jumpcloud: remove refrenses to jumpcloud

7c08d67438-+-Switch matomo to CAS

cc03533f52-+-testreduce: Fix syntax for ensure_packages()

ae27a92743-+-Remove apt pin for stretch-backports for npm

65d68c679a-+-mariadb: Promote db1103 to x1 master

691dcb42ca-+-cloud puppetmaster frontend: don't double-include packages on VMs

2201ac27f5-+-openstack: monitor: neutron: nf_conntrack: run the NRPE check as root using sudo

616954b48e-+-prometheus: node_neutron_namespace: disable explicit monitoring

7a46272b9a-+-openstack: neutron: add NRPE plugin to check nf_conntrack status

8213b2b8ca-+-P:idp::memcached: pass port directly to prometheus exporter

d8280f4dc2-+-role: noop style change

aaa3cb3c1b-+-profile::piwik::webserver: Remove support for stretch

1cd5aee3ff-+-bacula: Add ignorelist for long-term broken backups

8b6e68edd0-+-bacula: Fix typo on check_bacula.py path

d85b38aaf6-+-bacula: Merge prometheus exporter and icinga check into a single file

431c03cc0d-+-site.pp: Fix typo for db1131

9884689a98-+-mariadb: Promote db1093 to s6 master

50ea9eee50-+-webperf: Serve different robots.txt on beta site

c6002e7e0b-+-xhgui: Pin php-twig at version 1.*

aeff1113cb-+-releases: sync MediaWiki security patches to multiple servers

0d3fc7e950-+-releases: switch reprepro file sync to support multiple destinations

aaaee562ad-+-releases: move more common code out of the mediawiki class

51b5df7d9a-+-lxc: Remove jessie compat code

07ed360f3e-+-No longer install osm2pgsql from stretch-backports

5b71c40589-+-Remove lilypond for now

d43d7afc30-+-Allow to pass additional settings to the vhost config

49cb1eed9d-+-mariadb::ferm_misc add netmon1002/2001 access

5e906e66b4-+-ATS: set Rsyslog::Conf priority to 20

5658c981eb-+-mariadb: Remove puppet references for db1097

79b7cebeee-+-arclamp: Remove residue from old renaming

af3e53a07c-+-releases: move rsync code for all releases from mediawiki to common

1c286fb17d-+-releases: remove duplicate rsync code from blubber and parsoid classes

03bd432506-+-mariadb: remove ferm firewall hole for gerrit servers

8d41e7857c-+-tools-prometheus: Add the paws etcd exports

0df73b81b5-+-Revert "ci: switch integration.wikimedia.org to scap DocumentRoot"

1112f82375-+-ci: switch integration.wikimedia.org to scap DocumentRoot

50e61a9abe-+-wmcs prometheus: correct role name for galera metrics

612bb38a21-+-cloudmetrics: gather db stats from wmcs galera db hosts

4b6d596fb2-+-ATS: send Set-Cookie syslog output to logstash

f6e31356e0-+-cloud: add prometheus neutron conntrack collector

3014bc69e5-+-SSHFP: add a text file with the SSHFB of all hosts

0950dfd587-+-paws-prometheus: add node exporter info to tools-prometheus for paws

8920cfec01-+-tools-prometheus: reduce scrapes and increase scrape_timeout on cadvisor

705f0682c1-+-query_service: Remove more hardcoding of wdqs

093186d479-+-[wcqs] gui custom config

47aa3edfa0-+-GrowthExperiments: shorten welcome survey retention window

305a156527-+-thanos: set concurrency to 1

5bbf565899-+-proton: Set LVS level OpenAPI checks on TLS

959ef1a3bf-+-cloud: network nodes: explicitly load nf_conntrack module on boot

e943c292b6-+-restbase: switch to use https, envoy for proton

4696335762-+-librenms: add support for apereo cas

ac13bb4d9a-+-profile::librenms: update to use lookup instead of hiera call

bdde031173-+-Stop installing git-lfs from stretch-backports

71b60ff65e-+-wdqs: remove wdqs200[78] from "role(insetup)"

025d0bd8d0-+-mariadb: Move db1084 from s4 to m2

3872a85d86-+-Revert "wmcs galera: adjust firewall for prometheus access"

16486607e5-+-wmcs galera: adjust firewall for prometheus access

5f3cf162f2-+-tools-prometheus: fix a typo in the config that repeated an entry

1df00773a8-+-galera: generate grants script for prometheus access

9602d831f9-+-tools-prometheus: set up prometheus to get paws metrics

060f409e90-+-releases::mediawiki: support rsyncing files to multiple secondaries

8b990fb15e-+-openstack::db::project_grants: make privs configurable

61c5eef626-+-openstack::db::project_grants: remove unused db_host arg

cd38a4cb07-+-wmcs galera: rework use of prometheus-mysqld-exporter

a83d3f9918-+-Revert "tools-prometheus: set up prometheus to get paws metrics"

7e5339ed17-+-tools-prometheus: set up prometheus to get paws metrics

ea8994f600-+-Deploy analytics refinery to airflow instances

ce24338228-+-restbase: use envoy for contacting MediaWiki, parsoid

709dfa90c1-+-icinga: switch icinga to use apereo cas for authentication

34b56c731e-+-mariadb::misc: Add iptables rules for idp_test and cleanup

876b779911-+-toolforge: urlproxy: drop support for the legacy routing scheme

3af35938ff-+-java: use content not source on file resource

4e7b6c6a9a-+-java: update java.security to support specifying different EDG's

392c9d3560-+-Switch Graphite to CAS-only

56967ee4a7-+-profile::statistics::explorer::misc_jobs: add graphite_host global

7ffe73ffb9-+-profile::cassandra::single_instance: update to graphite_hosts global

d16089cf2d-+-mariadb: Remove puppet references for dbproxy1003

e32f75df47-+-Remove obsolete apt::pin for librdkafka1 on eventlogging

b16b17693e-+-mariadb: Promote db1080 to m1 master

8e6e2bc81f-+-restbase: re-switch to proton-http

ac11f78392-+-site/DHCP/partman: decom gerrit1002

6554b73859-+-site: remove gerrit role from gerrit1002

4513870f3b-+-gerrit: remove absented host key file for gerrit-test

83c3b1b051-+-mtail: remove component and upgrade mtail to 3.0.0-rc35-3~wmf2 across the fleet

5b0dbf8cfc-+-zuul: remove gerrit-test connection and setup

02360df60e-+-Drop Puppet code which tries to install graphite-web from stretch-bpo

e8b3bd60e7-+-add thirdparty/elastic78 component

70b035076b-+-mcrouter: avoid unit restarts when /etc/default/mcrouter changes

ae119fbbdb-+-mcrouter: avoid systemd unit restart when config file change

156c9c44a9-+-Revert "standard_packages - add httpie"

70c92d73d1-+-standard_packages - add httpie

8209f28b6a-+-galera: fully/qualify/path to the init script we're removing

dd6cbe6d2f-+-Galera: use mariadb service name rather than mysql

2d8d3f6bb7-+-profile::mediawiki::mcrouter_wancache: send probe after 60s

1e38b2e0f4-+-add a README about the content of the commons structured data dumps

dcff387d96-+-scap configuration for integration/docroot

5b31b0fb15-+-logstash: decom check_procs

844bb56e85-+-Fix topic name typo for eventgate validation error logstash collector

8f77d8f93f-+-Refine SearchSatisfaction using new eventlogging_legacy job

61b1274caf-+-mariadb: Promote es2021 to es5 master in codfw

3085aab719-+-systemd/slice: Update comment

54216beaf1-+-Remove obsolete apt::pin for librdkafka1

0d558b72d9-+-restbase-dev: add the service proxy

42e4fafa45-+-systemd/slice: Install systemd 241 from component/systemd241

45949596a4-+-logstash: fix kafka input ssl configuration for eventgate validation errors

21f3444699-+-restbase: stop using envoy for proton

b00b96957e-+-Remove archiva1001 from puppet

a66cccb7a2-+-restbase: use the services proxy for everything but parsoid-php

58b751099d-+-wmflib::service::get_url: fix lookup for listeners

4ffbfa6679-+-restbase: still use non-encrypted proton endpoint

89f50cb444-+-Remove apt::pin for python3-prometheus-client-package

c7f42d2e14-+-restbase: switch to using get_url

7ea0219816-+-mariadb: Promote es1024 to es5 master

ea07a09092-+-Collect eventgate error.validation topics into logstash

f70311a607-+-prometheus: Switch chartmuseum scrape target to HTTPS

278337b2d3-+-Horizon: Include PROXY_DOMAIN_DICT

2bbf6fbff3-+-wmflib::service: introduce get_url function

71f2f1c82e-+-dynamic proxy: don't treat "" as a boolean for $acme_certname

edf4dc4a5e-+-profile::wmcs::novaproxy: add acme_certname

07d56a583a-+-profile::wmcs::novaproxy: add use_wmflabs_root option

f155e7f231-+-Switch role for chartmuseum hosts to chartmuseum

7921974ffe-+-profile::base: noop style changes

7f89b1dfd7-+-restbase: install the service proxy along with the tls termination

7aa1b46b2f-+-puppetmaster::frontend: manage ca_cert.pem

6da86621f7-+-puppetmaster::frontend: add hiera calls and type validation

6323775b29-+-add chartmuseum[12]001 to dhcp netboot.cfg and site.pp

8eecbefcc5-+-realms.pp: Add sysop_itwiki to private_wikis

87cc1bea0b-+-Add echo_push_subscription to $private_tables

5a9b61b109-+-profile::prometheus::analytics: rename mysql jobs

ceaf68e521-+-profile::envoy::builder: fix repo location, add timer

3f081d347d-+-toolforge: exec_environ: install libxml-feed-perl

7a4c4a3d89-+-profile::envoy::builder: use an exec for creating the docker volume

a5340eefcf-+-Add basic setup for an-scheduler1001

f24f731cb5-+-profile::envoy::builder A profile to use in building envoyproxy

da7c3f5c49-+-Remove notebook1004 from production

a0d8f4293f-+-Authenticate with MW oauth 1.0a for WCQS

3db0b8c442-+-Handle oauth proxy settings

73bd5c4a4a-+-gerrit: Fix ITS template name of merged commits

c791098726-+-gerrit: Format short gerrit URLs in phabricator comments

aa3183c1c6-+-gerrit: Drop removal of javamelody-deps jar

0ff3cb5dd9-+-gerrit: Move new version's homedir to default place

56ac01f025-+-gerrit: Drop old version

19d0cad862-+-gerrit: remove all database parameters / support

2ab0cbd901-+-toolforge: Update comment reflecting source of tesseract packages

2fc0cfcb9b-+-wikidough: update firewall rules

a35dd3d4fa-+-facilities: update model for ps1-c3-codfw

d27dcba378-+-mariadb: Add role and section profiles to remaining mariadb roles.

19f1add462-+-Refine: Only filter for allowed domains from external EventLogging data

c595f471d1-+-icinga: move server wide config to httpd::conf define

dd091b86cc-+-puppetmaster: remove ganglia leftovers

b28922f43a-+-Remove obsolete pinning for libhwloc

4f81971f6d-+-apereo_cas: fix service properties entry

3a3a05e711-+-prometheus: remove ganglia leftovers

f97b37c384-+-Make Graphite httpd site configurable

da76d75f35-+-apero_cas: add abbility to configure per service properties

78eec9c533-+-purged: alert if local backlog grows past the given limits

dc98a754e1-+-scap::target: make this resource ensurable

9b47d7d060-+-security::access::config: Add types to define

b379138bbb-+-snapshots: enable dumps of structured data from commons

4a7cde0a35-+-chartmuseum: Add initial module, profile and role

efdffe506d-+-profile::mariadb::misc::analytics::multiinstance: use underscore

53a5a17546-+-Rename analytics meta mariadb instance for Backup host

a61236c77c-+-Remove jessie base images building process

975af0747b-+-thanos: set consistency-delay on store

4d037cb8de-+-monitoring: switch to new names for global availability metrics

41cbad4328-+-mariadb-backups: Fix remote_backup_mariadb.py deps and path

c1c36faa4a-+-Introduce profile::mariadb::misc::analytics

be2a9c0ad3-+-arclamp: Deploy from scap

097daf1176-+-Refine - KaiOSAppConsent exclusion was accidentally lost, re-add it

16d98af2b8-+-Add eventlogging_legacy Refine job for events migrated to EventGate

960ec05cae-+-systemd::sysuser: quote the gecos field to avoid errors

38ef998496-+-maven: remove main /etc/maven/settings.xml

c874204d67-+-webperf: Remove XHGui dependency on MongoDB

7b8660cb10-+-cr1-eqsin -> cr3-eqsin

d89b164a02-+-toolforge: mailexchange: add prometheus bits to know about queue length

ada5179766-+-mariadb: Add monitoring to temporary test ipd database db1077

6c0b96e4da-+-Switch puppetboard to only use CAS for authentication

8d068d89c3-+-cumin: Add db-role and db-section aliases

35e411868a-+-mariadb: Use custom types to ensure role/section have valid values.

3c318546cf-+-mediawiki: Remove 'test.wikimedia.beta.wmflabs.org' vhost

cdac9e432e-+-Revert "Revert "Role for SDoC WDQS""

e4da407efd-+-gerrit: add cron to auto-renew cert using certbot in cloud

7df40b2fd3-+-gerrit: make $replica_hosts an optional parameter

e35b6f740e-+-role::puppetmaster::standalone: allow for overriding the hiera config

e4367ae79f-+-mediawiki: Raise fatal alert threshold from 50 to 100

cd49b70128-+-mediawiki: Change mw alerts to use a moving average

0cd37bff15-+-gerrit::server: if acme_chief is not used, install certbot

ab7d15787a-+-cloud-vps: puppetize /etc/ldap.conf on sssd clients

550f1225ec-+-libraryupgrader: Add systemd units

b131f6c85d-+-site: add Logstash7 capacity

911958ea3d-+-MW PHP-FPM worker saturation: make it page

323d01cc94-+-Camus eventlogging - consider meta.dt and dt for event partition time

d72deb010b-+-mariadb: Setup db1077 as a misc::idp_test database server

d9b8a35ccf-+-add playbook links for important alerts

a78a97f64a-+-role::alerting_host: update the cas-icinga vhost to use the icinga cert

fbca77f357-+-Add analytics data purge for pageview_actor_hourly

ffa00ce5a1-+-Revert "Revert "mariadb-backups: Move transferpy deployment to debian package""

ccbadb5996-+-Revert "mariadb-backups: Move transferpy deployment to debian package"

764d8c5db9-+-site.pp: Move db1080 to m1 instead of m2

78df7d1b88-+-mariadb: Move db1080 from s1 to m2

ba9e8a379b-+-planet: avoid whitespace in gecos field when using systemd-sysuser

443198e13b-+-planet: replace system/user group with systemd-sysuser

c3e612b614-+-zuul: remove jessie support

91e44880a0-+-releases: remove phpunit and php-curl

2ae5191321-+-releases::mediawiki: remove PHP packages

e1b495f516-+-mariadb: Disable prolonged-lag check for non-replication cases.

57d6176735-+-ores::web: Pass skip-atexit-teardown to uwsgi

94ade4ddfa-+-toolforge: mailrelay: introduce spam filtering with spamassassin

2ae7c720cd-+-purged: alert in case of high event lag

c8d79839e6-+-mariadb-backups: Move transferpy deployment to debian package

54f33b686d-+-mariadb: Add monitoring for lag spikes (v2)

583041938c-+-Decommission an-launcher1001

47194e8c43-+-mariadb: Move db1135 to s1

8a572e26ac-+-gerrit: As log4j.xml is a static file, treat it as static file

0d1776781f-+-maps: Rename "slave" to "replica"

c7ec95403c-+-Revert "unattendedupgrades: allow configurable kernel cleanup"

3d5c6278f3-+-cumin: backup all of /srv where a lot of deployment state may live

3a470e73f1-+-logstash: use system openjdk 11 for logging ES7 instances

39e46e8999-+-Consolidate query_service profile duplication

9297eb75d3-+-site/DHCP: add logstash[12]03[01]

c2588a74a3-+-mediawiki::maintenance: add server-header config

fd9502e6fa-+-releases::mediawiki: only install PHP packages if pre-buster

10d48ad3b7-+-Move all analytics timers but RU ones from an-launcher1001 to 1002

fa7cd1e264-+-site: add logstash1030/31 with insetup role

b4126eef3e-+-Add an-launcher1002 to puppet config

093648b972-+-toolforge: mailrelay: introduce SRS to correctly envelope forwarded emails

2e60f68b56-+-Remove notebook1003 from puppet

b72ae29add-+-fix multiple invocations of systemd::sysuser

33169cd82d-+-prometheus: use the correct password for the wikidough job

e8006993ed-+-Set notebook100[3,4] with role::insetup

56dee18411-+-Introduce kubernetes[12]01[56]

f89e383898-+-prometheus: update scheme for wikidough (improves ab8a948a)

86e239aadb-+-camus: use refinery-camus-0.128

d3e524993a-+-mariadb: Promote db1097 to m1 master

a9f3b4efde-+-codesearch: limit connections to port 3002 to $CACHES

c53af1e5d1-+-Add initial puppetization for libraryupgrader

40446aa8ee-+-site: add releases role to releases1002/2002

3644d8b3ed-+-icinga: move ferm rules from module to profile

a2e875486c-+-set disable_fsnotify for all current mtail usage

c86377b2d7-+-Revert "Revert "Reimage db1108 to Debian Buster""

ab8a948a28-+-prometheus: add wikidough statistics

1d1c94b18d-+-profile::reportupdater::jobs: absent old RU job

f0471ffc24-+-pontoon: Fake confd, and protect against double-enroll.

92aeccadc6-+-apereo_cas: add support to store u2f using JPA

912efddf74-+-toolforge: mailrelay: collect exim metrics using prometheus

28d63b93d1-+-pontoon: fix storeconfigs type and hiera defaults

96cbb659a3-+-wikidough: update dnsdist web server listen address

b4e3a7cb1b-+-Fix permissions for pwstore dir

cb7d7358c4-+-Add pwstore (dummy) profile

fc4568b23f-+-mariadb: Add 2 profiles to allow finer-grained cumin selection

1b1d5df2b5-+-Revert "Reimage db1108 to Debian Buster"

3f60c0584b-+-Reimage db1108 to Debian Buster

eb380b287d-+-mariadb: Remove dbproxy1008

fe6ada061d-+-codesearch: move ferm rules from module to profile

041065698d-+-profile::netbox: Parameterize backups

5357697430-+-Revert "profile: temporarily disable alerts on cloud_dev_pdns* for maintenance"

28d671a17d-+-gerrit: Drop javamelody-deps library for new Gerrits

1783f61eb2-+-gerrit: Allow to use request tracing for new Gerrits

38de1c6f77-+-contint: remove obsolete firewall rules from labs

d65c7c8d60-+-wmcs: install galera on eqiad1 cloudcontrol nodes

30251a3440-+-dumps: move ferm rules for xmldumps from module to profile

0f612612d7-+-wmcs: Remove "slave" from comment

9fb1233697-+-toolforge: mailrelay: migrate TLS cert to acme-chief

54cb876947-+-cloud nfs: clean up some of the secondary cluster materials

d477907fc9-+-mariadb: Setup db1145 as a mariadb backup source for s4, s5

59b9eabc1b-+-Fixed a meaningless typo

26bf69dbd5-+-Galera backups: use default policies

e64f0c96fb-+-profile::idp::httpd::client: add CASScope

65e8c87663-+-pontoon: first skeleton

78d2252432-+-bacula: remove unneeded lint-ignores

9522359ff8-+-prometheus: require class node_exporter for node textfile scripts

30b12864e8-+-eventlogging: Change basedir depending on the OS

c3c5459efc-+-cloud nfs: only run nfs-exportd on the current active node

e131db7df1-+-galera/bacula: giving this one more try

5b54af6c5c-+-Revert "wmcs galera backups: move to weekly"

e3c466878d-+-wmcs galera backups: move to weekly

9d60230fec-+-unattendedupgrades: allow configurable kernel cleanup

5e696f3774-+-wmcs galera: add daily backups of each OpenStack db

dba607fc7f-+-mediawiki_vagrant: Update role name used for if defined check

679390dd74-+-cescout: enable proxy access (improves 16ac24a82c)

1da1016bc5-+-gerrit: Add dedicated home dir for new Gerrit version

49bc28ceb9-+-gerrit: Add option to mark gerrit servers as upgraded

16ac24a82c-+-cescout: enable proxy access for the postgres service

27473aa5b8-+-core/multiinstance.pp: Change the mariadb basedir depending on the OS

f4e8f3cdbc-+-cescout: ensure that /var/run/postgresql exists at boot time

addebda622-+-nagios_common: Add data persistence irc bot config

c6cc1e319d-+-Remove banner now that the server is reimaged

1c176fbb2a-+-multiinstance.pp: Change the mariadb basedir depending on the OS

ebce11b708-+-s/slave/replica/ in visible parts of MariaDB alerts

147cf58079-+-alert on high load on xml dumps nfs primary

13a2d8f840-+-cumin: fix labs install on Buster

6fa33e73d7-+-Revert "mariadb: Add monitoring for lag spikes."

395ff80b2d-+-mariadb: Add monitoring for lag spikes.

465868f2dd-+-logstash: bump pipeline workers

412ad74da1-+-Update various references/comments to jessie

dd039f4d77-+-dnsdist: disable the console by default

74143fe31f-+-dnsdist: add parameter for web server configuration

3c2f043f88-+-kibana: disable metrics

c2ef603187-+-site/DHCP: add install4001.wikimedia.org

2a0a6e5cc7-+-kibana: additional settings

3347d7a35d-+-profile::icinga::external_monitoring: fix typo in check_command

52ff403f25-+-profile::icinga::external_monitoring:  correct icinga check

a5a9bf0334-+-profile::icinga: add vhost for external monitoring

7f0cd5e788-+-add alerting for Mediawiki PHP-FPM worker pool saturation

efdbcc0f9d-+-homer: add dependency on bsd-mailx

e53befdb7d-+-galera: provide access to puppetmaster (for the enc)

bd371c0703-+-cloud-vps puppetmasters: create /etc/labspuppet dir

1af8e67b97-+-cloud-vps puppetmaster db grants: further attempt to get fix the template

12016333fc-+-Try to work around puppet's weird list handling

2af5643738-+-codfw1dev: move puppet enc storage to galera

d20c2ad073-+-designate database: expand grants to include cloudcontrol nodes

4bbf3e195c-+-netbox::scripts: Fix typo in parameters

42d6067645-+-netbox::scripts: Fix error in acme deploy

ef24c55958-+-wmcs: paws: haproxy: add keepalived support

34f5a274a8-+-purged: remove unused argument 'stats_dir'

a61c2b95d5-+-keepalived: simplify input arguments

1b21dc19cc-+-purged: restart upon configuration changes

b8d97a5fb6-+-profile::idp::client::httpd: remove trailing slash from proxied as

dfaf081417-+-archiva: allow to set a custom location for the user db

99936805c4-+-Revert "profile::archiva: use /srv/archiva-public for rsync"

32fac1c86a-+-profile::archiva: use /srv/archiva-public for rsync

715fad1830-+-[cirrus] drop icinga check on deprecated cirrus bulk update topic

3e67d56e40-+-openstack::db::project_grants: show_diff => false

25a3a0144c-+-openstack: add templatized database grants for openstack services

5766c59096-+-netbox: parameterize the acmechief certificate in scripts

3cf6e4ddcd-+-phabricator: Hiera'ize ferm srange for port 80

2f8a8ec77f-+-zuul: add gerrit-test:29418 as a ssh known host

2babff26f6-+-netbox: parameterize the acmechief certificate and set it for netbox-dev2001

5526ca78f6-+-Decommission matomo1001

9a69b1fc0b-+-cloud apt: set periodic autocleaning to once a week

851a47a13d-+-profile::analytics::backup::database: add mariadb-client

17bb9f9790-+-Split out galera tests into two configs

63b3afe3cf-+-mariadb: Fix typo

e6b855fb15-+-wmcs galera: add a second icinga check

809d637413-+-dumps::web::fetches::analytics::job: use ls when checking dirs

2a003802db-+-site: add mw2335-mw2339 as appservers

a49a0cf258-+-profile::idp::memcached: move SSL termination to memcached

c70089f0fd-+-memcached: add TLS support

27105492c7-+-prometheus: pass min_time to Thanos sidecar

2417f354d1-+-thanos: pass min / max time to store

37c31a5f8f-+-Remove role spare from old ganeti hosts

53fd117be3-+-toolforge: legacy-redirector: declare explicitly sslcert::dhparam

d50c57978d-+-toolforge: legacy-redirector: use specific certificate

5040eb1774-+-mariadb: Move db2091 to s8

08de3155c9-+-thanos: fix Thanos sidecar Prometheus connection alert

3d0db5b07c-+-cloud nfs: allow opt-in soft mounting wherever folks want to try it

7a3fb7a572-+-nfs monitoring: fix the broken paths for the directory size monitor

ee559597eb-+-site: add releases1002/releases2002 with insetup role

cd42e59431-+-query_service: Move shared config into common file

0e065604ef-+-maintenance: Migrate wikidata prune jobs to periodic_job

dbd5c27dc8-+-refine.pp - bump version and make eventlogging_analytics use event_transforms

e096d53e94-+-check_command configs should notify icinga for reload on change

dc12a22e27-+-Update refinery-job jar version for analytics' refinery profiles

20b4f7f86e-+-java: manage elasticsearch and kafka java dependencies with ::profile::java

300a7afeeb-+-netbox: Configure for netbox-dev hosts

a0dc1cd3a7-+-icinga: include a couple of perl packages for check_icinga_nodes.pl

aaf6da2b20-+-keepalived: add support for multiple virtual addresses

9df785fe14-+-memcached: convert systemd service file to an override

04652a6af7-+-swift: stop requiring Package swift for log directory

29066c6106-+-galera monitoring: more icinga fixes

f8a5a03c8f-+-swift: add explicit ordering for /var/log/swift

0101232724-+-Galera monitoring: move defines from icinga host to monitored host

4ba6b2a4d5-+-ganeti: Decomission ganeti1001-4, ganeti2001-6

c6aa4620aa-+-icinga galera monitoring: typo fix

1a114b3167-+-Add icinga monitoring for WMCS galera

6851827100-+-wmcs: kubeadm: decouple haproxy profile for Toolforge/PAWS

7eda5dad13-+-wmcs: kubeadm: drop leftover nginx_ingress_yaml declaration

e931afd1e7-+-Fix MOTD

51f0d57f99-+-toolforge: relocate nginx-ingress config from kubeadm

65c3ddfa80-+-reimage banner for cumin1001

35d9703b24-+-swift: optional read affinity proxy setting

ce62426f15-+-profile::idp::memcached: use default settings for memcached

bc054b2ea0-+-Example: build script in line in puppet

e6fa878e5f-+-rsync: move oneline script inline

aa20b7926d-+-drbd_role: extract the string we are looking for

082e569a37-+-labstore: fix variable definition for drbd_actual_role

3148681024-+-labstore: long-overdue refactor of primary profile and role

9004c8862f-+-toolforge: remove legacy killgridjobs.sh script

c30535c7ec-+-wmcs haproxy: fix up mysql config

2ce37ac497-+-wmcs galera: move codfw1dev mysql port behind haproxy

e0f102c62e-+-Galera: move behind haproxy

0aeb1f219b-+-wmcs galera: fix mysqld process check

139506bd17-+-wmcs galera: fix firewall rules to remove commas from ip lists

9cccefa863-+-wmcs: install galera on codfw1dev cloudcontrol nodes

79c99a7ef2-+-Initial module and profile for galera + mariadb

f1f8abe074-+-homer: fix git clone URL

f6519f68de-+-homer: set the keyholder env variable

e163fdf7e4-+-git::clone: allow to pass environment variables

63e375e321-+-homer: fix initial clone of private repo

0639594ad8-+-Readd the spicerack component on Stretch

47fc0c097d-+-Switch spicerack installation to ensure_packages

f658b2068e-+-aptrepo: build single line shell script inline

b2352c8ad5-+-profile::icinga: move single line scripts in line

38dff4fd94-+-swift: remove swift-container-sharder unit

a5f9f15f3f-+-package_builder: Remove support for jessie

bde40ee7d2-+-mariadb: Productionize dbproxy1020

e4b5225230-+-Remove unused Analytics statistics profile

cc8c5959af-+-phabricator: move template to file as no dynamic values

b5ac7120f2-+-phabricator: move template to file as no dynamic values

59c3ed8f1e-+-cloud NFS: remove the nfsiostat diammond collector

fae0ded952-+-puppetmaster::gitclone:  build single line script inline

eb4da67b10-+-remove obsoleted/unused wmflib::service::lvs_icinga()

b606fd3137-+-profile::base: add hardware_monitoring option and set for out-of-warranty nodes

11b4d9aafe-+-statistics::performance: add syslog id to systemd timer

428d6768c0-+-site: Add alert2001 with role insetup

1adef5f930-+-kubernetes: Add more nodes to the 2 clusters

c55a0af4ea-+-Convert ASO ranking report into a systemd timer

74ff4bec49-+-profile::archiva::proxy: Use ip addresses instead of localhost

5c0d45ad27-+-paws: haproxy: fix some small issues

3875af3729-+-wmcs: kubeadm: haproxy: introduce support for TLS termination

9e0c6b251e-+-mariadb: Fix mariadb::instance comment

92e133471d-+-profile::archiva::proxy: use certificate_name for monitoring

4930a23758-+-mariadb-backups: Disable transfer.py logging to systemd

07d7166e96-+-gerrit: add parameter for db_name, let gerrit1002 use test db

a27310a1d1-+-purged: make Kafka cluster name configurable

24a2bc14ea-+-mariadb: Move db2084 to s8

7ccbe09fee-+-Site: Add rd200[1-7] with role insetup

88c875f269-+-dnsdist: update the queries per second limit

e44e84b142-+-purged: fix Kafka brokers TCP port if TLS is disabled

fe9a7ef8ac-+-wmflib: add type for a valid PHP version

fd603714bd-+-meet: Add ferm rule to open port 5000 to the cloud proxy

14e308caf2-+-wmcs: kubeadm: introduce different haproxy port frontend/backend

8621cd5a4c-+-kubeadm: fix typo in hiera key name

b95f550b18-+-paws: add welcome banner

36792e2ce6-+-puppetmaster,icinga: naggen2 cleanup and update to python3

e8b5bd2cbd-+-prometheus: enable httpd mod_rewrite

22e7ba9837-+-oresrdb: Remove the last references from puppet

2e1681ae34-+-wikidough: set up the pdns-recursor

2d939e6ba4-+-icinga: convert sync_icinga_state.sh.erb to file with config

4baf71538f-+-Assign role archiva to archiva1002

33a7afa0da-+-varnish: use Host:varnishcheck.wm.org for icinga checks

35af5aa167-+-Fix installation of memcached 1.6

fac8f5e864-+-kubeadm: rename hiera key for ingress nodes

5ad58dc353-+-Make memcached 1.6 an option for the memcached class and enable for the IDPs

bb27d50278-+-oresrdb: Cleanup profiles, hieradata, cumin aliases

bea3807788-+-oresrdb: decommision

0a4a86a651-+-phabricator: change sender address of community_metrics mail

d15e554e36-+-memcached: allow more tunables to avoid implicit settings

0ba69577dc-+-meet: Use python3 in uwsgi

52f717e172-+-prometheus: enable Thanos upload for ops in esams

8e8afd3f7c-+-meet: Change the account manager socket

1a2f479ffc-+-peek: add data types, comments

5f6dc924d5-+-peek: Reenable cron with correct params

b4484ed0d8-+-dnsrecursor: make forward-zones and edns-subnet-whitelist optional

1425ea86f3-+-site: add thanos-fe1* to frontends

89f90dfbbb-+-site: add new appservers mw2335 through mw2339

2f7e9b0ef9-+-prometheus: enable Thanos upload for k8s

fdda24a4fc-+-Add wsgi-file for meet-accountmanager

ed537c7409-+-systemd::timer::job - add ability to syslog match based on programname equality

3b910cf1af-+-ATS: handle healthchecks in Lua

befd251033-+-site: add thanos-be1* to thanos::backend

33c15d97a3-+-mx: change officeit@ to its@ email recipient for exim alias mail

3a79995429-+-On buster install python3-tqdm from the spicerack component

3efb9eb4fd-+-mariadb: Move db1127 from x1 to s7

c494912518-+-service::docker: Change volume parameter type

44d1405390-+-Add archiva1002 to site.pp

346faaf31f-+-Revert "base/monitoring: allow setting different contactgroup for systemd"

a8c91ac3fb-+-mariadb: Move db1103 to x1

0852ef4e12-+-base/monitoring: allow setting different contactgroup for systemd

095aee5f80-+-Exclude deleted eventlogging schema from proper refine job

a9cb7a01cd-+-Exclude deleted eventlogging schema

dee88ce1cf-+-cloud-vps resolv.conf: restore use of both recursors

15257c4f69-+-profile::archiva: fix timer's command

794ded180f-+-archiva: move archiva-gitfat-link to systemd timer

6ff31a93e5-+-cloud-vps resolve.conf: move traffic from recursor0 to recursor1

826343e485-+-profile::mail::jumpcloud:

d09b6ccae5-+-profile::mail::jumpmcloud: remove jumpcloud

fefe16bae1-+-wmflib: add systemd.timer OnCalendar support to cron_splay

86f8fa9e17-+-prometheus: use profile::lvs::realserver

a27b606abf-+-Gerrit: Enable crons on Gerrit replicas

a734461670-+-beta: Allow using docker volumes

01361c936e-+-Gerrit: Fix log retention period in comment

0d1601fa55-+-wmcs vms: stop using ns1 for resolving

a746f28758-+-debmonitor GC: generate cron email on failure

89297f9afd-+-wikidough: update profile to use a single recursor

a2cb75f00f-+-php: $enable_request_profiling should affect CLI

8d1c24fca8-+-puppetize meet-accountmanager, step 1

2fd6d64adf-+-Use the cumin profile in role::cluster::management

e012d8afcb-+-maps: profile::rsyslog::udp_localhost_compat

06a47f1cc4-+-mariadb: Move db1141 from labsdb role to s4

870da48567-+-Revert "phabricator: add envoy TLS terminator for aphlict"

6d4c742e25-+-Revert "phabricator: add non-global cert/key path for aphlict envoy terminator"

c3f9ca8d35-+-phabricator: add non-global cert/key path for aphlict envoy terminator

ca64428827-+-phabricator: add envoy TLS terminator for aphlict

f02903ab56-+-mariadb: Move db1097 to m1

e3ccc017ef-+-httpbb: convert an .erb.sh script to inline content

91cf4b8abc-+-profile::statistics::gpu: upgrade stat1005 to rocm 3.3

9806240a85-+-dbproxy1018: Pool labsdb1011 and add labsdb1010 with reduced weight

d4842bcacb-+-Adding thanos-be100[1-4] to site.pp

13a01eb4ef-+-Adding thanos-fe100[1-3] to site.pp insetup role

1688919cdf-+-Adding relforge100[34] to site.pp role insetup

2d1d2c1543-+-expand phpfpm status text exporter to all appservers

cf83728da5-+-textfile exporter for php-fpm worker pool status

41f7496bf0-+-Systemd::Servicename: make it reflect reality e.g. php7.2-fpm

b27ab96c8c-+-puppetmasters::scritps: join arrays

d4cc3effa1-+-puppet-merge: fix syntax

360c748e7b-+-puppet-merge: split dynamic values out of puppet-merge script

bc8a9c6122-+-prometheus: merge ops instance role into profile

036d5fc11c-+-profile::piwik::instance: fix archiver's settings

63d8b8600c-+-profile: allow NaN for Thanos compact/query errors

50e48eb5f8-+-matomo: move archive cron to systemd timer

ff3cf26d07-+-Fix Thanos compact alert threshold

0fface41dd-+-phabricator: convert 2 scripts created from erb to files with config files

73cde93c00-+-Enable base::service_auto_restart for Apache on peopleweb

4d690fd997-+-Enable base::service_auto_restart for Apache on RT

50d2fe972e-+-wikistats (cloud): update query for XML dump of Wikipedia table

f5f626e5fe-+-prometheus: enable Thanos upload for services

1b6f9c0488-+-thanos: add alerts for Thanos components

75a2ff9a48-+-monitoring: bail on check_command containing newlines

fc05af76e8-+-centrallog: disable mtail fsnotify, increase fd limit & simplify glob

93a52c7df7-+-profile::piwik::webserver: support Buster

c1bc984e8f-+-Integration Cluster: update gitcache nightly

56009521d6-+-httpbb: add test_miscweb snippet to profile

8593aafca7-+-Add puppet configuration for matomo1002

4583676e7a-+-alternatives::java: fix java paths

bd94ffe4db-+-gerrit: Set default for value for ipv6 (undef)

6b3423f359-+-DHCP/site: add people2001

3773105877-+-releases: add data types

9a651f1543-+-statistics: delete empty file password.pp

eda303a1c5-+-rancid: add data types

95160fbcf0-+-ganeti: Monitor metad and wconfd as well

938095c7c8-+-profile::planet: add data types

5ebb039c86-+-Correctly reference the ganeti_cluster fact

986b25b07a-+-ganeti: Utilize ganeti_master fact to deduplicate checks

3fe9ec0978-+-ganeti: add monitoring for ganeti RAPI

2b155ec708-+-Revert "thanos: add alerts for Thanos components"

98b8f7b328-+-thanos: add alerts for Thanos components

6448e5f1c7-+-smokeping: add data types

736f17de1d-+-prometheus: move global instance to profile

630fa246c2-+-prometheus: move services instance to profile

e5b46b02f7-+-Include profile::java in analytics::hadoop::ui roles

0e64151365-+-profile::hadoop::yarn_proxy: remove java depedencies

b4eddbea35-+-Add Turnilo to the staging environment on an-tool1007

e16c7b91fb-+-turnilo: move functionalities to the proxy profile

dc96298266-+-elasticsearch: need dhparam.pem for nginx ssl

822259dc2d-+-cloudelastic: bring new nodes into service

475a520022-+-icinga: increase "rsyslog failing to deliver messages" check threshold

521f306f63-+-dnsdist: allow access to control socket

8bb4c61c18-+-ganeti: Deduplicate /var/lib/ganeti/rapi/users

acb0e600da-+-Update netflow-to-druid load job configuration

cc3c3c00d2-+-Assign role::ganeti to new ganeti expansion hosts

ff52c3bc83-+-profile::superset: move to gevent

781ff82e40-+-Add parameters to the eventlogging_to_druid job

ec22500df1-+-ci: Remove support for jessie

0e5eb48943-+-wmcs: kubeadm: refresh default version to 1.16.10

b6621ed572-+-gitclone: add labs/private checkout back to labs environment

5ca7ea8f7d-+-puppetmaster: remove monitoring::icinga::git_merge check on backend

a4c6a70f53-+-puppetmaster: update puppet-merge""

cc5b9a5b67-+-Revert "puppetmaster: update puppet-merge"

7209768c87-+-puppetmaster: update puppet-merge

2e9c9ada86-+-profile::java: ensure /etc/environment.d

bbd021cf18-+-role::search::airflow: use profile::java

64cc6229ad-+-Deprecate profile::java::analytics in favor of profile::java

5f8e7b0c44-+-mediawiki::monitoring: disable opcache monitoring on parsoid::test

95d4aadc2c-+-mariadb: Move db1091 from s4 to s1

a7ac978136-+-Remove RPKIcounter

6e8f3fd08e-+-profile::conftool::client: only use root on cumin*, puppetmasters

ad19375322-+-acme_chief designate: Support multiple projects from one acme-chief instance

61f29af6e3-+-profile:wmcs:proxy:static: add acme-chief certs as specified by hiera

c44b008cb0-+-profile::analytics::cluster::packages::statistics: Add cairo

beea881ba9-+-Revert "Role for SDoC WDQS"

32bd5a217d-+-Role for SDoC WDQS

a9aad74818-+-Define a shared profile to remove duplication in roles

3f45c2d3a5-+-profile::analytics::cluster::packages::statistics: Add packages

8d8a4b5488-+-Remove duplication and improve clarity in role::wdqs

4e1910d6c8-+-Update example to reflect the new typed arguments

a95bb405d9-+-mariadb: Add snapshotting capabilities to content backup hosts

ddd6952e47-+-systemd-sysuser: Use /bin/systemd-sysusers and skip config on jessie

94f21cda45-+-Add wikimedia server_alias for api.wikimedia

9030c2a1b7-+-microsites::design: use variable for repo dir when cloning blog files

353dbbc730-+-microsites::design: move blog repo dir out of design dir

071bde8c96-+-acme_chief: Don't bother with cert-sync timer if we have no passive host

4a61197cba-+-Ship the sysusers default config via systemd::sysuser

241409a740-+-profile::etcd::tlsproxy: add testserver ACLs

f93ec40585-+-profile::conftool::client: allow overriding the user root can access

1f5e92450c-+-microsites::design: add git clone for blog site

464e684e3f-+-prometheus: enable Thanos upload for analytics

fbfb73ab54-+-microsites::design: add blog subdirectory

297db58715-+-site: decom mw2180 through mw2186

16549f038e-+-maintenance::cirrussearch: extract index rebuild

d8e1799c70-+-varnish: add support for additional mtail args and set disable_fsnotify in eqsin

8eba2a10c0-+-profile: add additional flags support for atsmtail and disable_fsnotify in eqsin

623e94bd68-+-dnsdist: add a parameter for setting addDOHLocal's base URL

d391bc7091-+-profile: add additional mtail args support and set disable_fsnotify in eqsin

7542645174-+-monitoring: allow "host" to also be a string

48144c8926-+-dnsdist: add parameters for TLS configuration

8668daa403-+-site: decom mw2173 through mw2179

bdce02755e-+-Make systemd::sysuser require systemd class

7deebfc580-+-Revert "ci: Add kubeyaml"

18956a9668-+-ci: Add kubeyaml

63c3bf58c3-+-monitoring: add data types to monitoring::service

0a4887eeb4-+-ores: Parameterize redis ports

df3bfe8472-+-thanos: enable swift stats reporting

1a883e9c37-+-swift: refactor stats_reporter into a profile

fa703749ee-+-mariadb: Place db1148 into s4

45f4c781f9-+-mariadb: Add db2140 to s4

f746353385-+-Rocky/Buster/Designate: a few live hacks to get things working on Buster

bbb9fe184b-+-[wdqs] fix DCAT-AP reload and load it to the categories endpoint

d921b7a69a-+-Revert "stdlib: fix "double quoted string" lint warnings"

3670210f6a-+-Remove ganglia configs from cdh and jmxtrans modules

d856f21217-+-profile,gerrit: Add backup of Gerrit's LFS files

1e33a0234b-+-icinga: Add alerts for synthetic testing for search pages

ca9d3e4b36-+-profile::idp::memcached: mcrouter also needs to own the cert

aef76e6b4e-+-profile/manifests/dumps: enable ipv6 drop ferm rule for 443

9922dbf1c6-+-dumps::web::fetches::analytics::job: fix rsync bash script

ea22eb158f-+-profile::idp: use mcrouter port

e61057791d-+-prometheus: move analytics to profile

468926d0c8-+-web::fetches::analytics::job: do not rsync mediawiki if missing source

90170e380b-+-Decom ms-be101[678]

83b1d3ba18-+-profile::idp: split memcached function to its on profile

361a1efc0c-+-transfer.py: Use xtrabackup on path now that all packages are 10.1.43+

0e297b026b-+-stdlib: fix "double quoted string" lint warnings

c42421070a-+-mariadb: Productionize db1147

c876c4b78f-+-peek: Disable cron execution

dcffd347ab-+-node_nic_firmware: fix comments in header

653e9b9097-+-dnsdist: add a parameter to use dnsdist's packet cache

0c69e0e8cd-+-maintenance: Migrate updatequerypages to periodic_job

6984b5c533-+-maintenance: Migrate startupregistrystats to periodic_job

c171dac648-+-maintenance: Migrate initsitestats to periodic_job

bd06796450-+-peek: add asana and env variable dependencies

7401f2afe9-+-idp: fix route type

9f18b52c69-+-apereo_cas: correct typo

f77d6ea526-+-apero_cas: alow ability to use memcached for tickets

7a523570e2-+-profile::idp: add mcrouter

b0d161a591-+-Revert "enable dumps of structured data from commons"

baaed22098-+-Force Java 11 JRE for zookeeper on druid1001

2c5e8f476f-+-dnsdist: allow DoT (DNS-over-TLS)

4366961c75-+-Set Debian Buster for druid1001

16005cf358-+-atskafka: increase queue.buffering.max.ms

ce5fb673e3-+-Rename squid3 class to squid

0f2d6868c0-+-mariadb: Promote db1081 to s4 master

93fc40c5a2-+-wmcs: Add db1141.eqiad.wmnet to maintain-dbusers

55d845a882-+-Designate: designate doesn't need to write to the pdns db anymore

c0a3e8f066-+-peek: fix paths to conf files for cron

0f38ef4673-+-peek: fix require reference for /etc/peek

494a5eae2f-+-peek: update dependencies

fcde6f239c-+-Revert "Swap profile::java::analytics with profile::java"

5aa226ec1d-+-Swap profile::java::analytics with profile::java

227e177015-+-wikidough: allow traffic to tcp/443 (DoH port)

9972e76a04-+-Add component/idp-test and enable on the staging IDPs

3f78bcf728-+-prometheus: whitelist atskafka-specific metrics

7b5ff3f45e-+-thanos: fix sidecar objstore file permissions

ce56218ff1-+-prometheus: enable Thanos upload for Prometheus k8s-staging

8d6a379442-+-mariadb: Add db2139 to s4+s5

321527717d-+-profile::url_downloader: Add types and switch to lookup()

d33e31be31-+-Remove obsolete pdns3hack class

5add71121a-+-Remove support for non-Tomcat and non-DEB deployments

73bc1c9884-+-Cumin: add network devices support

cfaa4930ab-+-monitor_readonly.pp: Add a more specific page for this alert

b8b3efd68e-+-profile::prometheus::ops: add Superset httpd exporter

0346dca0c4-+-profile::etcd::tlsproxy: add additional users for pools

b29de3269a-+-Unconditionally enable mod-crs

e7a29d2889-+-profile::superset::proxy: add httpd prometheus exporter

05338c1d1b-+-Move ms-be101[678] to spares

bb564f9483-+-profile::etcd::tlsproxy: refresh code for modern puppet

d21d32b820-+-profile::openstack::base::designate::service: tighten up firewall rules

4968c61826-+-peek: update remote repo resource

4a0d8ed70a-+-peek: fix require resource definition for template dir

68b895315a-+-peek: add profile to role

8ca0947778-+-peek: security team PM tooling

9191fbb350-+-peek: add role for peek2001

08afd482a3-+-fix up cron name of commons structured data dumps

84ac7259a5-+-enable dumps of structured data from commons

f02868da98-+-dnsdist: add parameter to limit number of queries

38b3e8ee84-+-Decommission Maps & Search metrics legacy dashboards

24d90fd7c9-+-prometheus: rename Thanos jobs

a1324bd64a-+-mediawiki: Disable fewestrevisions for wikidata

a6c81696c0-+-site/DHCP/partman: add peek2001.codfw.wmnet

ac3325b744-+-thanos: add objstore support to sidecar

bcaf9f95a5-+-prometheus: filter interesting rdkafka metrics in purged job

b89bdaa550-+-toolforge: shell_environ: drop byobu package declaration

340e8f0850-+-dnsdist: add parameters for TLS certificates

31b7ab5144-+-Drop colordiff from gerrit role, now part of standard packages

c14eaebd40-+-prometheus: job definition for atskafka

caa50a09ac-+-Switch the IDPs to profile::java

820856062d-+-base: Add some small quality-of-life packages.

936f34156a-+-Integrate hardened java.security into profile::java

11ad2d8929-+-prometheus: allow setting min/max block duration

24aa093bc6-+-mariadb: Place db1146 into s2 and s4

998cbd1c61-+-prometheus: Fetch atstls.mtail metrics

a7bf1e68de-+-thanos: monitor compact metrics only for enabled host

36ea08340e-+-Remove further package leftovers after stretch->buster upgrades

840a0a64b4-+-thanos: don't enable compact when not needed

c20a90fc8f-+-mediawiki::webserver: use envoy only for TLS

3cb6a5750b-+-Import lexeme ttl dumps to HDFS

ff35845d29-+-jobrunner: use envoy by default

dc29ec57ab-+-superset: set default gunicorn app name

af68e1fac8-+-base::debdeploy: switch to lookup and default in hiera

fec0c56693-+-thanos: add thanos::compact

a551c82d7c-+-wikidough: deploy certificates on the malmok host

1f87f26fbe-+-prometheus: add store and compact jobs

a83a2d95b5-+-Revert "icinga: replace check_ssl_http with check_ssl_http_letsencrypt"

0c5edf099a-+-thanos: add Store Gateway

5d68415cfb-+-profile::ganeti: refactor hiera

e46650e701-+-site: Restore mw2180, inadvertently dropped from the regex.

0999c921bb-+-ATS: Add atstls.mtail program

6fc826e82c-+-profile: remove unused profile::etcd::auth

4f1d933986-+-Enable base::service_auto_restart for Apache on Turnilo

13f03b150e-+-mariadb: Add db2138 to s2+s4

15ec813ab9-+-site.pp: Add missing mariadb multiinstance comments.

d651390354-+-site: define mw2249,mw2250 as jobrunner canaries in codfw

cedc2f6683-+-dnsdist: add a class to install and configure dnsdist

813b9cf7fd-+-Remove jessie check in Docker registry

e6329a560e-+-site: define mw2187,mw2188 as new canary appservers

959a851e22-+-profile::tlsproxy::envoy: add max_requests parameter

a1fa23a445-+-site: move appservers in codfw rack C4 into their own regex

3452997adb-+-site/DHCP: remove people1001.eqiad.wmnet

4bf94ca693-+-Remove absented reprepro configs

c6d523ad53-+-site: Move the D3 hosts under the D3 comment

b8f9ad34d2-+-zuul: add convenience link to 'zuul' bin

9e8d9e2754-+-role::postgres::common: Remove jessie support

9dda3ba761-+-role::archiva: move to profile::java

ea4ebb4c47-+-profile::java: set defaults correctly accoring to their type

e49c542655-+-profile::java: set extra_args with type Optional[String]

c2d5663739-+-profile::java: one profile to rule them all (openjdk-x versions)

fc29270aed-+-Include unzip package on extdist cloud vps tool for composer

e57f3b9722-+-Make CAS deployment via a deb toggleable

d21403177c-+-Fix a number of typos and duplicated words

1b76e25bf6-+-atskafka: do not write stats to disk

5f86aec2e7-+-Remove varnishkafka::monitor::ganglia

e5e37d71c4-+-package_builder: add unstable sources to the build hosts

2210a9d6ae-+-alternatives: add a class for the java use case

e1d82aa4a5-+-kubernetes2007-2014: Move to role kubernetes::worker

0de6f9816a-+-Remove install[12]002 site.pp entries

5a8f361e87-+-toolforge: remove elasticsearch5 role and profile manifests

1f5c664ba8-+-kubeadm and toolforge: rearrange some things to get it working

1c3aef0ca7-+-systemd::timer::job: unkludge OnUnitInactiveSec/OnUnitActiveSec

bdea0f54bb-+-site: decom mw2170 - mw2172

a69abb31ed-+-site: decom mw2163 through mw2169 appservers

6eee14d2e1-+-site: fix comment regarding servers in the wrong rack

aeafd82af5-+-mariadb: Productionize db1144 into s4 and s5

b7ff77b51b-+-installserver/light: limit access to webserver to DOMAIN_NETWORKS

e48a5eb976-+-idp: rename check_sso_redirect command into check_https_sso_redirect

0aa950de32-+-site: remove 13 old jobrunners from codfw rack C3

29b0cdeb5c-+-Revert "superset: upgrade gunicorn app name for all envs"

f84c3dc84b-+-superset: upgrade gunicorn app name for all envs

ce8b6f8cf1-+-profile::prometheus::alerts: improve druid alerts

b6ccee8b81-+-profile::prometheus::alerts: update druid analytics monitor

54200d6d77-+-mariadb: Place db1149 into s4

aca1eae2ee-+-paws-k8s: set some volumes up

e7cc22cfb8-+-Fix typo for kubernetes2007 to kubernetes2014

34d84f63c0-+-labstore: the monitor_systemd_service module doesn't work with drbd

734df19e60-+-Assign role::druid::public::worker to druid100[7,8]

590ae7a344-+-paws-k8s: Adding a checkout of the paws repo

bdc5fb89f7-+-kubeadm: Our template should match package versions for bootstraps

fab3fdc696-+-paws: install the helm3 package in the control nodes

3ce651bec6-+-Add kubestage200[1-2] , kubernetes200[7-14] MAC entries and to site.pp

44d27e6ed9-+-paws-kubeadm: Add option for stacked control plane

5ca9d6423a-+-install_server: add an nginx also on servers with "light" role

1ed5e8f793-+-role::druid::public::worker: update historical's settings

4241c06f62-+-changeprop: remove changeprop configuration from scb

5f16a31996-+-site: remove peopleweb role from people1001

9fabed61ea-+-puppetmaster::gitclone: add pre-commit to private repo

23a42e41bb-+-role::druid::analytics::worker: add autoconfig for historical

a108d093ee-+-jobrunner: add code to switch to envoy, switch codfw

5f9935768f-+-ci::slave: add /srv/deployment dir to fix dependency problem

37b6e2c595-+-contint: Drop the slave_scripts manifest, no longer used

829e30212c-+-contint: Fix comment claiming the file is remote

c5c799ed88-+-wikidough: add role and profile (first commit)

fe80b529ed-+-mariadb: Add db1143 to s4

d8f0181a45-+-profile::openldap_clouddev: further attempt to get the sync_pass from hiera

c71e574049-+-profile::openldap_clouddev: typo fix

7f35d655a0-+-Attempt to get a real sync_pass for clouddev ldap

b92efae648-+-role::wmcs::openstack::codfw1dev::services: added a comment re: ldap

f49abbc8de-+-Add testable anycast authdns address (attempt 2)

9d2c957a38-+-Revert "profile::druid::analytics::worker: tune historical daemon settings"

237fde0ea9-+-Revert "Add testable anycast authdns address and bird stuff"

2360a69bc7-+-profile::druid::analytics::worker: tune historical daemon settings

ebd6a3ef0f-+-Add testable anycast authdns address and bird stuff

c62b3132ce-+-lvs::monitor: expand icinga service descriptions

d2c051aaf4-+-profile: fix thanos swift healthcheck

9a94222aac-+-thanos: add Envoy TLS terminator

a1f22e1f58-+-Add a define for creating a system user using systemd-sysusers

7e16882862-+-site: change FQDN of malmok to public IP

4897853ec8-+-Enable base::service_auto_restart for Apache on Superset

b6400a9402-+-mariadb: Add db2137 to s4+s5

46c990b979-+-mediawiki:jobrunner_tls: Remove runjobs monitoring

91f4b00e75-+-site: add malmok.codfw.wmnet

66585cdc9c-+-kubeadm: drop package_from_component define

c7959610df-+-profile: open port 80 for thanos-query

4341c04f7c-+-mariadb: Place db1142 into s4

c38106f89d-+-openstack::util::admin_scripts: Include a mariadb client package

f3f8d157a2-+-Add check_dns_query to dns profiles

bb9d6c0040-+-Split nagios_common::check_dns_query from commands

abe1847ab6-+-paws: Introduce the role skeleton for the paws servers

33418dccbe-+-toolforge: exec environment: use newer tesseract suite

63c5276d1a-+-site: add thanos::backend role to thanos-be2*

9195cb24bd-+-profile: add thanos::swift::backend

45bc3f7106-+-profile: add thanos::swift::frontend

184965c635-+-prometheus: export NIC firmware versions

1dc39eb061-+-cescout: enable restart for the Postgres service (finalize f3a35978)

25895eb89c-+-profile: add thanos::httpd to proxy thanos-query

52f29c8794-+-toolforge: mailrelay: introduce support for disabling TLS

579636f22c-+-Remove mysql module from WMF

508014275f-+-jenkins/icinga: fix process monitoring after change in command line

c29864ed65-+-mariadb: Use db1141 as test for labsdb1011 issues.

4929922af2-+-mariadb: Remove db2136 from spare role.

9f0160292d-+-ATS: Stop handling KA and WS on tls.lua

2977f2b3d9-+-jenkins: master should stick to java 8

2fd6da61e5-+-backups: Add backup1002 as the eqiad host for ES db backups

420a54faf8-+-Add kafka-jumbo100[89] into the jumbo-eqiad kafka cluster

b9b37a9c97-+-Use apt::package_from_component in confluent::kafka::common

7813a16172-+-delete the apache module, replaced by httpd

669c8dc43f-+-Add kafka-jumbo1007 to jumbo-eqiad brokers

ad88d02d76-+-swift: set defaults for replicator concurrency

2601058f96-+-mariadb: Add db2136 to s4

837fe673fe-+-ci: rename role::ci::slave::labs::common to a profile

be3a51b666-+-contint: remove obsolete roles

296d576286-+-Add role::druid::analytics::worker to an-druid100[1,2]

19daef4198-+-contint: remove profile::ci::browsers

a5008f7c33-+-contint: remove local apache virtualhost

dcf28203b3-+-jenkins: remove unused java_path variable

6c3f17a26b-+-puppetmaster: add type checking

5aead951b8-+-contint: cleanup no more used material

95509a5903-+-deployment::server: replace apache module with httpd module

41ca1684fe-+-swift: read hash_path_suffix with lookup()

3ac172c7b6-+-swift: migrate off swift::params

73bd72300e-+-varnish: move reload-vcl to /usr/local/sbin

c67eebc1ce-+-delete role/profile hmmp, duplicate of simplelamp2

56eed26b1d-+-delete role::simplelamp

13789e5f81-+-Move cloudvirt-wdqs hosts off of ceph

eb95f2c611-+-pmacct: embiggen rcvbuf

7790ee9fdb-+-fastnetmon: fix comment mispaste

49b0b1c4a9-+-samplicator: add service_auto_restart

d677814450-+-profile: add anchor to mailman monitoring section

235b5bb21e-+-Resolve duplicate declaration of openjdk-8 on logstash nodes

397f66700d-+-samplicator: *properly* embiggen SO_RCVBUF

266254b4b2-+-Revert "samplicator: embiggen SO_RCVBUF to prevent drops"

5b3248c938-+-samplicator: embiggen SO_RCVBUF to prevent drops

85de35b6a0-+-mariadb: Remove conditional for system user

82be71df74-+-mariadb: Remove redundant include of prometheus node_exporter

c234d5d698-+-bacula: Fix small typos on pool class documentation

3e6b6f2a47-+-role::archiva: move to profile::java::analytics

92eded8a9e-+-Add thanos-bw200[1234] MAC address and to role insetup

06cc588436-+-profile: check_prometheus expects int

ac22a2530f-+-profile: add mailman outbound queue monitoring

f3a3597802-+-cescout: harden the Postgres installation

f69449c577-+-lists: don't monitor mailman procs on standby_host

16236840e3-+-Update exec role for Cyberbot

ba9638d912-+-profile::kafka::broker: use openjdk-8 for Buster

0e984a06c1-+-Factor out java 8 installation into java_8 class

b76a6cf90c-+-cloudvirt1004/1006: fix role name

3ea4dbd90f-+-Convert cloudvirt1004 and cloudvirt1006 to ceph-backed cloudvirts

704c8077f1-+-Add rocm-smi path as parameter to the Prometheus AMD GPU exporter

6062c96fbc-+-profile::cache::purge: correct access to kafka configuration

f1b81c4fb1-+-purged: add support for kafka

fecd12f290-+-static-codereview: activate Icinga monitoring

78abd94282-+-maintenance: another fix in host names for rsyncing from miscweb

c25cc45980-+-maintenance: fix hostname of miscweb server in codfw

02f85973e8-+-maintenance: also rsync codereview files to codfw miscweb

e1f293f38e-+-swift: remove accounts from swift::params

a27aab9b4f-+-profile: move analytics::cluster::secrets to profile::swift::accounts

10aac7dd48-+-matomo: switch to apt::package_from_component

8169bd0cef-+-profile: move docker registry to profile::swift::accounts

b8e731bbc8-+-profile: move thumbor to profile::swift::accounts

be1cc44089-+-Switch Parsoid's rt-testing from testreduce_0715 to testreduce

133c729d65-+-swift: move out of swift::params::accounts

1444b9e591-+-swift: add ability to toggle WMF-specific filters

1662cdd6f7-+-swift: clean up 'storage_policies' from swift::params

1c0c47566a-+-cassandra: use openjdk-8 on Buster

c13ef85476-+-Add profile::wmcs::proxy::static

09e9a27cec-+-dumpsdistribution: quiet the load alerts a bit

ff386557c9-+-gerrit apache-exporter: fix comment mispaste

a0e55dde0d-+-run apache-exporter on gerrit hosts

16866b2b49-+-lists: add concept of primary and standby host, and rsync prmry -> stndby

ebc285c4a8-+-toolforge-kubeadm: calico upgrade changes

43e0a4570a-+-Allow kafka brokers in the to talk to eacn other's prometheus jmx exporter

a8af0339bd-+-maintenance: temp allow rsyncing home dir to miscweb

7f18b5aadf-+-mariadb: Switchover zarcillo from db1115 to db2093

6104fd11b3-+-mariadb: Default monitor disk & process paging to false

13b83973c7-+-systemd::timer::job: fix bug re: On(In)?ActiveUnitSec

1830f8884b-+-Decommission old ArcLamp HHVM pipeline

a51b6cd8e5-+-static-codereview: Update notes URL to new wikitech page

714baa994d-+-aptrepro: add spicerack compoment for buster

e6efb55675-+-ferm: use /bin/systemctl not /usr/bin

a4d4f78252-+-ferm: correct restart command

5c6720b918-+-ferm: restart ferm when its stopped

ece6530617-+-ferm: ferm has a status script now so instruct puppet

e329191b56-+-Remove component integration for Puppet 5 / Facter 3 on jessie/stretch

1988c339c0-+-peopleweb: allow rsyncing /home to a new server

7745810495-+-prometheus: add thanos::sidecar to services and analytics

c43cddbf78-+-site: add peopleweb role to people1002

9d7dbc1fa4-+-swift: move swift::params::swift_cluster to profile::swift::cluster

48c0d30a14-+-logstash: Set tcp input type to class $title

9b9c3a24da-+-monitoring: remove usages of 'dba' contact group

3613f466e6-+-prometheus::ops: Set netbox class config to not hostnames_only

80ab106180-+-cescout: fix permissions for metadb directory

13bb93c056-+-prometheus::ops: Add prometheus job to scrape Netbox scripts

b9d06ed84b-+-Fix duplicate alert descriptions for eventgate_logging_external_errors

1ef2647624-+-site: add people1002

ced5922d65-+-thanos: add lvs addresses to frontend

d88679a6a2-+-Revert "Revert "varnish: update varnish config to use the abuse_networks global""

4cf41d0134-+-Remove notes_links from monitoring::alerts::kafka_topic_throughput

0c8fd6ecc0-+-Add notes_link and use + instead of space in some eventgate icinga alerts

8549f932ef-+-Revert "varnish: update varnish config to use the abuse_networks global"

d801490515-+-varnish: update varnish config to use the abuse_networks global

7ee1daae83-+-Don't add an Icinga service for the staging IDP vhosts

ecef3f7939-+-Remove more squid3 compat code

daff19b58b-+-site: decom mw1280

cb91eb096b-+-Fix name for httpd::site and Icinga defs when using the staging flag

e1a22f3086-+-Remove jessie support from squid classes

0a076fe081-+-phabricator: Change mail alias only on wmcs

b05b87c8b8-+-phabricator: Disable/Enable dumps using hiera

5ba6de40a9-+-jenkins: add missing /srv/jenkins dir

35b7d07278-+-Initially use Java 8 for contint on Buster

fb78d4e39c-+-Change doamin from codfw.wmnet to wikimedia.org for cloudceph200[1-3]-dev

79619718bc-+-netbox: Change scripts.cfg group to www-data so that external scripts can access

eb0bd03ece-+-puppetmaster: fix standalone puppetmasters

b93848afd8-+-Add cloudceph200[1-3]-dev MAC address  with role insetup

a2d749ccef-+-backups: Set backup1002 as an "in setup" system and disable notif.

ea0da97dbf-+-role::eventlogging::analytics: remove mysql config

7889213d36-+-profile::analytics::refinery:job::refine: bump event refine exec memory to 4g

d10e9a5df4-+-Enable base::service_auto_restart for Apache on dbmonitor

5e08fec187-+-Enable base::service_auto_restart for Apache on miscweb

ebda316c4a-+-Enable base::service_auto_restart for Apache on Grafana hosts

66b389b341-+-backups: Add backup1002 as a spare system, enough to prepare RAID

010e32970b-+-aptrepo: populate /srv/tftpboot from volatile also on APT_repo servers

894de86450-+-apereo_cas:  support staging environment

104e7300e8-+-site: fix typo in role for new restbase hosts

72eb11005e-+-site: assign thanos::frontend to thanos-fe2*

2fac736e59-+-Adding kafka-jumbo100[789] to site.pp insetup role

494e4e12fc-+-Make cloudcontrol1005 a cloudcontrol node

6e53b5549e-+-Fix TYPO for thanos-fe200[1-3]

ffc3f685ba-+-Increase number of mappers used for Camus mediawiki_analtyics_events

6ecc40966d-+-simplelap: add support for buster/PHP 7.3

100a62ce82-+-redis: Restore $slaveof parameter

2808f7595b-+-Revert "redis: Followup for 63addad7b79d8dff7bbf"

29c909cf1e-+-Make /var/log/cas writable to the tomcat systemd unit

94d35177c8-+-redis: Followup for 63addad7b79d8dff7bbf

388e3ce6a5-+-redis: Allow override of instance config

63addad7b7-+-redis::instance: Deduplicate base_settings

a24f7fe034-+-puppetmaster/configmaster: convert from apache to httpd module

cfffea6718-+-mariadb: Add replication monitoring to misc hosts

f351151305-+-mariadb: Add read_only monitoring to other misc dbs: tendril, phab, event

2541808414-+-thanos: fix query class arguments and path

ec92defc22-+-mariadb: Enable read_only monitoring on misc hosts

c9ab35ffb4-+-create simplelamp2, replace mysql->mariadb, apache->httpd

6d440211be-+-prometheus: add thanos sidecar to k8s instances

54318f2036-+-ATS: Puppetize max_connections_in and max_connections_active_in

34c0f5b5bb-+-phabricator: Drop phd.pid-directory as it's now uneeded

f0424875e5-+-Disable Analytics refine failure check for sanitize timers

c9715a4517-+-toolforge: another fixup for the kubeadm refactor

2d2895fd5c-+-toolforge: fix docker imagebuilder for the new puppet structure

3dbdd7df12-+-wmcs: kubeadm: introduce support for selecting repository component

783cb0a035-+-idp: remove trailing slash

967c821af2-+-profile::idp: add devices dir to tomcat readwrite paths

249cd0d9b1-+-vcl: set large_objects_cutoff in hiera

021ac9d186-+-Explicitly install both myspell-pt-pt and myspell-pt-br

c8978e2e5c-+-phabricator: in cloud, use a local database server

efe3b8fdab-+-ferm: change ferm-status owner/group to root:root

aac13496c0-+-create profile to install a generic mariadb server

53d60184ae-+-Add thanos-fe200[1-3] MAC address, and to site.pp

98faeae783-+-Assign role::statistics::explorer to stat1007

857a5e2dd1-+-Add camus job event_dynamic_stream_configs

8289865775-+-tomcat: add RemoteIPValve

03ce828bd4-+-Add analytics pageview-actors data purge

c03cfd56f7-+-mariadb: Enable read_only check to page on primary masters

8be874ca74-+-Adding new restbase1028-1030 servers to site.pp role insetup

339e58d709-+-Adding an-druid100[12] and druid100[78] to site.pp insetup role

e1154e66be-+-apereo_cas: alow use to override daemon user

22223c3ce5-+-deployment_server: in cloud we need more space in /srv

845ff4e21d-+-apere_cas: fix dependencies

1a5418a1cf-+-tomcat: fix closing xml tags

b8bd89f994-+-apereo_cas: add support for external tomcat instance

a5a8428ed8-+-ferm: enable ferm status script

90da4fda73-+-Adding new kubernetes nodes to site.pp role insetup

cd62663f00-+-role: rename thanos::query in thanos::frontend

9041868cc5-+-profile::kerberos::client: fix credential cache location and env variable

89ca486459-+-profile::kerberos::client: set KRB5CCNAME with default_ccache_name

c9da04eba0-+-Enable base::service_auto_restart for apache2 on xhgui

2f23434c4d-+-mariadb: enable read_only monitoring in parsercaches

8f4cd0ee46-+-Openldap: split the clouddev ldap server into a separate profile

7d40bd2914-+-openldap acls: change the type of extra_acls

58219ec7fd-+-mtail: add flag to install mtail from apt component

7fc3b26496-+-netbox: Use netbox-extras version of tools

0ecba35ec9-+-ATS: Add ensure support for Log definitions

017c746488-+-Enable base::service_auto_restart for apache2 on graphite

3e2d94c602-+-ATS: Use the analytics log on atslog-tls

0c7a75f3c7-+-kubeadm: refactor toolforge code for reuse by PAWS

c2310ea212-+-profile::kerberos::client: allow to set a different credentials cache dir

df801abd79-+-Apereo_cas: correct typo and increase default max session time

cf237d3f6b-+-apereo_cas: use 7 days as a max time value

060dff868b-+-purged: make purge_host_regex default to undef

56cab1fc76-+-apereo_cas: add more timeout values

46de287dd6-+-purged: use nrpe::monitor_systemd_unit_state

54d44993af-+-prometheus: remove node_vhtcpd

2ac07ab715-+-add static-codereview profile to miscweb, comment out monitoring

dc37c01e04-+-Add profile and module for for static HTML dump of CodeReview

1e2de53646-+-varnish: remove varnish::htcppurger

fed80e53de-+-cache: remove profile::cache::base::use_purged

eb9ef8528e-+-install_server: Allow reimage db114[1-9]

57e7273023-+-analytics::refinery::job::refine.pp: Bump up jar version

444636ef78-+-rabbitmq::plugins: change order of args to rabbitmq-plugins check

019da51133-+-mcrouter_wancache: Clean up $use_gutter now that it's true everywhere.

337678027c-+-toil: mitigate monthly acct cronspam

da5800fc08-+-profile::analytics::cluster::hdfs_mount: temporarily disable alarms

5636291bf3-+-nova::common: fix ordering a bit for a clean install

0ca65177f5-+-Openstack haproxy ferm rules: support AAAA and fix syntax

4b793df105-+-openstack/buster/nova: Create 'nova' system user in puppet

90f7fe436a-+-profile::reportupdater::jobs: Add delay to published_cx2_translations_mysql

b4bbd1ea5c-+-superset::proxy: allow to set the x_forwareded_proto header

f36e72b9de-+-Update path to CirrusSearch maintenance scripts

f936a882c8-+-icinga: replace check_ssl_http with check_ssl_http_letsencrypt

acaea5cfe5-+-sslcert: add parameter to support cergen private keys

f828c38328-+-Also specify system user range for systemd-sysusers

8f01a82a53-+-Remove boron from Puppet

e050204896-+-Ship /etc/sysusers.d base directory for systemd-sysusers

f3ad678362-+-profile,gerrit: add enable_monitoring flag for gerrit-test

5751ee4798-+-Keystone: create /etc/keystone/fernet-keys directory

69af7dc751-+-Glance/Buster/Rocky: remove explicit uid/gid for glance service user

432b623902-+-Glance/Rocky/Buster: explicitly create 'glance' user and group

efe43fe438-+-Python/Buster: removed install of python-mysql.connector

dc6d8dde49-+-Openstack/Buster: remove include of python-mwclient

7e3bff294d-+-Openstack/Buster: remove explicit import of python-ldap from Buster

a519cb2575-+-Openstack/Buster: remove component for python-oath

8b0aefc0ff-+-OpenStack on Buster: remove requirement for python-mysql.connector

2985cb5b74-+-Openstack/Buster: removed some python2 packages that we don't actually need.

96625c7b22-+-spicerack: add both RO and RW Netbox tokens

306a822cb5-+-contint: On stretch, use the docker we have

d80a5638ee-+-toolforge: k8s: client: specify buster as the distro for kubectl

898344c831-+-toolforge: k8s: client: fix typo in package declaration

391316511a-+-Add hadoop yarn queue to analytics sqoop scripts

dd87db2edd-+-vcl: pass fe_mem_gb to vcl_config

bf9a238648-+-toolforge: kubeadm: use apt::package_from_repository

d3322e69ef-+-toolforge: kubeadmrepo: temporary unbreak depdency loop

c36bdc698c-+-Phab & Gerrit: Only install *::apache2::administrative on production

9e8acbbbfa-+-aptrepo: kubeadm-k8s: create versioned components

710e88b81f-+-vcl: 10M cutoff for the 'exp' admission policy

ef4b8cb5bd-+-mariadb: Add db213[6-9] and db2140 as spares

bd5d940bb1-+-Assign role insetup to cloudelastic100[5,6]

f0a296b448-+-prometheus::druid_exporter: add metrics_config_file to defaults

b78d319830-+-prometheus::druid_exporter: upgrade to 0.8

f1d51cba11-+-Move import_wikidata_entities_dumps timers one hour later

fdc58a553e-+-Openstack buster packages: pin python3-ceph and related

34f4966414-+-netbox-script-proxy: Fix uwsgi configuration

9a1f3e6800-+-Openstack Apt repos: allow gnupg to be installed before custom repos are set up

a1adb92097-+-Openstack Apt repos: allow gnupg to be installed before custom repos are set up

700b49a8a0-+-profile: escape exclaimation point

6806987ab5-+-apt::repository: remove redundant package require

280479858a-+-profile: temporarily disable alerts on cloud_dev_pdns* for maintenance

56705416bd-+-apt: install gnupg before trying to set up keys for a repo

dea511158e-+-keystone: make the max_active_keys a bit smarter

3517d4a293-+-refinery::job::test::camus - set check -> $monitoring_enabled

f63c29229a-+-remove bromine.eqiad, vega.codfw and webserver_misc_static role

0d32c1128f-+-refinery::job::camus - Make sure check defaults to true

5e7f5a902a-+-Initial role assignment for cloudcontrol2004-dev

4c683c79e3-+-pdns: update mysql-client package name for Buster

47e2ab9bde-+-camus::job - Allow for false when setting boolean parameters

600ca911f5-+-Remove absented failed_flags_ refine::jobs

d1b08760c6-+-cergen: Add script for renewing mcrouter certs.

0b562e41bd-+-Refactor and DRY camus module templates

f43daacae1-+-Factor out RefineFailuresChecker into the refine_job define

2dcd89690f-+-maintenance: Migrate readinglists to periodic_job

3b68dfeda3-+-maintenance: Migrate pageassessments to periodic_job

4327d73ce2-+-maintenance: Migrate generatecaptcha to periodic_job

946e01e883-+-maintenance: Migrate cirrussearch to periodic_job

f91010ecda-+-maintenance: Migrate db_lag_stats_reporter to periodic_job

91a24b1f66-+-Refine - fix table_blacklist_regex and remove mediawiki_events refine job

c768aebc83-+-refine.pp - Slight refactor to use new unified refine tranform functions

abd866e3a4-+-profile::statistics::explorer::misc_jobs: get more jobs from stat1007

0efdac9f75-+-maintenance: Migrate purge_securepoll to periodic_job

1c71baa7d8-+-maintenance: Migrate purge_old_cx_drafts to periodic_job

c17c1d4c0e-+-maintenance: Migrate purged_expired_userrights to periodic_job

125dde4b08-+-maintenance: Migrate purge_abusefilter to periodic_job

8b113daec8-+-maintenance: Migrate purge_checkuser to periodic_job

a579c873ee-+-mariadb: Fix bacula alerts documentation urls

7d59fe0403-+-remove https://transparency-private.wikimedia.org

ff761f95cf-+-aptrepo: cleanup unused openstack components

636e1544f5-+-ci: remove integration.mediawiki.org

f18de775d2-+-cache: use profile::lvs::realserver

9448ff26a8-+-tomcat: create new tomcat module intended for use with apereo cas

87e3adaf7e-+-prometheus/icinga: avoid duplicate service definitions

7788661ed5-+-LVS/icinga: avoid duplicate service definitions

068611b050-+-Rename labtestservices2003 to cloudservices2003-dev

d630eccbce-+-Openstack packaging: set the stage for Rocky on Buster

309b12ffc8-+-wmcs pdns: stop using primary/secondary language for resolvers and recursors

059e705ec8-+-Collect kaios_app.error stream into logstash clienterror input

29026617bd-+-Revert "keyholder: notify the agent on auth changes"

7908d25102-+-keyholder: notify the agent on auth changes

7852525a16-+-wmcs-instancepurge.py: fix hiera settings to match profile code

41eaa6674b-+-Install python3-setuptools-scm in package builder

dc7267c8ea-+-phragile: Remove support for jessie

c10cc59398-+-Remove now obsolete check for jessie

0d0fb2c2af-+-Enable idp-test1001 as second IDP staging server

daef630685-+-homer: add a diff check that sends an email

301d4c1b5e-+-package_builder: Add dh-exec to package builder packages

6a5a1c35b7-+-cache: remove nginx-ats transition leftover

46ece3af1b-+-role::statistics::private: factor out wmde/discovery crons out

6ee599461e-+-Enable base::service_auto_restart for KDC

7095928337-+-cloudvps: metricsinfra add project label and default alert rules

1b3cec2321-+-netbox: Add framework for exposing scripts to internal services

47ed35a3a1-+-Ceph: Cleanup comments in config module

6bace53a4a-+-mcrouter: update example code

971912ae9d-+-Horizon: replace nutcracker with mcrouter

329360ce69-+-Add wmcs-instancepurge.py and a timer job that uses it

ea5e5963c4-+-Add idp-test1001 to site.pp/DHCP config

59ef014df0-+-base::firewall: dont add desc as comments are cache specific

661e15dc1d-+-network::parse_abuse_networks: update module function

0c0f610f70-+-cumin: Fix Python version for Buster and remove support for jessie

8477a52696-+-phab: correct syntax error in ferm rule

f3bc777362-+-phabricator: remove srcaddr in ferm rule

6e9fcfd900-+-idp: refactopr to make idp_secondary optional

ef9fadb952-+-mcrouter: add default timeout values

efc72645b7-+-Enable base::service_auto_restart for squid

5cec687098-+-cloudvps: metricsinfra add prometheus alert manager and email notifications

921f42641f-+-Enable base::service_auto_restart for fastnetmon

a89022133e-+-Enable base::service_auto_restart for pmacctd

2f0febe6f7-+-apt_repo: stop including migration rsync class

0a998eacaa-+-Enable base::service_auto_restart for CAS on fallback servers

35d7daedff-+-purged: pass host_regex

d32242a159-+-role::elasticsearch::cloudelastic: set CMS occupancy fraction to 85

64afa71830-+-prometheus: scrape thanos sidecar/query metrics

34769a20c7-+-Add Thanos query

b9939d622d-+-prometheus: add thanos-sidecar to prometheus@ops

ded4bf32e9-+-modules: add thanos-sidecar define and profile

b5b830e7af-+-Decommission es2001, es2002, es2003, es2004

3516ab604d-+-logstash: log safepoints only when running the daemon

b01cd0bcd7-+-mariadb-backups: Tune backup size monitoring thresholds

d8bb1eaaa0-+-idp: alow specifying specific branches for the idp profile

52aaf2433f-+-cloud-vps puppetmaster: add a missing )

27819ce0ec-+-Re-enable webrequest data deletion job

68719b03ca-+-shinken: settle on keystone_api_fqdn after all

b2df70ac1a-+-shinken: leave internal var named keystone_host

fbd2dd5fc1-+-prometheus::metricsinfra: rename keystone_host to keystone_api_fqdn

2ba0e37832-+-shinken: rename keystone_host to keystone_api_fqdn

3d24b060f2-+-Neutron common: replace keystone_host with keystone_api_fqdn

adbd252733-+-keystone service: remove keystone_host hiera setting

fae8b40686-+-cloud-vps cumin: replace keystone_host with keystone_api_fqdn

3764c9275b-+-designate pdns: replace keystone_host with keystone_api_fqdn

7cc4c096fa-+-Horizon: replace keystone_host with keystone_api_fqdn

5f420108ef-+-designate service profiles: replace keystone_host with keystone_api_fqdn

c5eb4a9419-+-Openstack metrics profiles: remove keystone_host params

cb82327823-+-Openstack metrics profiles: tidy up params

d294ab9886-+-Openstack observerenv profiles: use $keystone_api_fqdn

5e01ea63cb-+-Openstack observerenv profiles: tidy up params

e3aaafae2d-+-mariadb wmcs ferm: remove references to osm_host and cloudweb_dev_hosts

f70a4ad639-+-mariadb wmcs ferm: update ::wmcs profiles to use types and lookup()

efb238b163-+-mariadb wmcs ferm: use openstack_controllers instead of nova_controller etc.

ddd2e02d76-+-cloud-vps puppetmasters: use openstack_controllers instead of nova_controller

8e09640e10-+-wmcs openstack haproxy: use openstack_controllers instead of nova_controller

c22416826f-+-role::statistics::explorer: add profiles to match role::statistics::private

12b10b275e-+-Add cloudcontrol2004-dev to DHCP with role insetup

575329d180-+-role::swap: add deprecation notice motd on notebook100[3,4]

420bc829a5-+-mjolnir: Ensure python3.7 is available before initializing repo

56a25e27f2-+-mariadb: Decommission dbproxy1011

5a68586c14-+-Add Druid support for event.editattemptstep

b24bcf171a-+-role::statistics::explorer: move target hosts to hiera

dd307136c4-+-role::statistics::private: factor out geoip archive to a profile

3b95c1e8d9-+-mariadb-backups: Move OK alert description to wikitech

78e93998e6-+-puppet_compiler: updated default version

971c0fcbd1-+-mariadb-backups: Include es4/5 into backup checks and refactor

96b3b0fc04-+-purged: raise 'frontend_workers'

874ea6234e-+-site.pp: Remove 10.4 comment

6bbe6ece15-+-ATS: Enable SSL_OP_PRIORITIZE_CHACHA on ats-tls

0be0ec01a4-+-toolforge-k8s: make sure directory exists before checking out to it

16490b64a5-+-toolforge-k8s: add a puppetized checkout of maintain-kubeusers

849d0d4c41-+-keystone: remove glance_api firewall rule

3af3c74b5b-+-nova.conf: remove [glance] settings

a1f0ce41e4-+-nova fullstack: use openstack_controllers instead of nova_api_host

54fcdb206a-+-Remove nova_api_host params from places where it wasn't doing anything

49b3cb2e87-+-Openstack: remove config for version Pike

087d33e9a0-+-profile::openstack::codfw1dev::keystone::fernet_keys: remove an unused param

d9be8f5dff-+-Neutron metadata agent: use keystone_api_fqdn for the metadata api

3e41a2e94b-+-Neutron common: use openstack_controllers instead of nova_controller params

ace6d0055d-+-clouddb2001-dev: make a ferm rule a () list

b6cf1a7448-+-clouddb2001-dev: remove a stray )

253bc14a65-+-wmcs pdns recursor profiles: remove nova_controller params

157d76c031-+-profile::openstack::codfw1dev::db: tidy up firewall rules

0bcb99b381-+-cloudvps: Add new role for metricsinfra

e6607eef20-+-Refactor logstash::input::kafka to DRY ssl_truststore_location logic

eb95744e21-+-mediawiki::mcrouter_wancache: add a failover route to a secondary pool

1b17e46921-+-miscapps: allow rsyncing app data to multiple destination hosts

13faaaa68a-+-misc_apps: setup rsync to copy microsite data for migration

94055dd2cf-+-prometheus::node_vhtcpd: add 'ensure' attribute

443e5bedd3-+-Deprecate statistics::rsync::mediawiki

877a128c12-+-profile::analytics::search::airflow: improve cleanup timer

ebd5535f15-+-merge microsites into webserver_misc_apps

052f4389ac-+-tlsproxy::envoy: allow limiting firewall srange

812ecc5a75-+-profile::analytics::search::airflow: fix systemd timer

9082899f1c-+-profile::analytics::search::airflow: clean up old logs after 30d

08700f74c6-+-Remove jessie support from osm/maps

af11cdf75b-+-Fix installation of graphite-web on Buster

64ee7d5f63-+-nova common: use keystone_api_fqdn instead of keystone_host

711c179ad5-+-Openstack env scripts: use keystone_api_fqdn

5509dcd32b-+-designate firewall: use openstack_controllers instead of nova-specific things

2ab34176d1-+-Designate: remove use of nova_controller and nova_controller_standby

d16fc9493f-+-openstack::designate::service: remove some unused internal variables

bbf2225d5f-+-rabbitmq: use openstack_controllers instead of nova_controller

88342a7338-+-Keystone: remove openstack::keystone::cleanup

5b4a70cfc4-+-openstack::keystone::cleanup: remove all timers

19dab9ab0e-+-Keystone service: stop using nova_controller and nova_controller_standby

47ecf026c6-+-keystone::fernet_keys profile: use openstack_controllers from hiera

d09a8c87b3-+-Nova project spreadcheck: run on all openstack_controllers

8c54f9f1e5-+-nova common: replace nova_controller and nova_controller_standby

09e94839f7-+-Openstack nova: remove spiceproxy code and config

545ac8b881-+-Re-enable the second dumps run of the month.

4f10cb7cda-+-cloudvps: add prometheus alert rules for project instances

d128760a65-+-Glance profiles: add param types and lookup() calls

f01ca8aca3-+-Glance: use keystone_api_fqdn for endpoints

ac3eed1944-+-Glance profiles: remove firewall rule for labs_hosts_range

c1c0a6e818-+-glance profiles: remove use of $nova_controller param

d9cdd140f8-+-glance image sync: simplify secondary image handling

bfaaf12b1d-+-glance image_sync: don't make a file depend on itself!

a7976fd9c4-+-glance image_sync: use primary_glance_image_store to choose the image store

1525b9f679-+-designate/mcrouter: use ipv4 address for servers rather than fqdn

e1a73537fb-+-Designate/mcrouter: typo fix

b047c56a8b-+-designate/mcrouter: all each mcrouter to talk to each memcached

29e69f2399-+-Designate mcrouter: talk to memcached on port 11000

67bdd7c510-+-designate: further (largely random) mcrouter config tweak

769167309f-+-Designate/mcrouter: another attempt at mcrouter config

4dbe90cdd3-+-designate mcrouter: add a default_policy to the route

d558dfee07-+-Designate: replace standalone memcached with a mcrouter cluster

c4ac331970-+-statistics::rsync::mediawiki: reduce retention and improve security

93710d866c-+-profile::kubernetes: add the puppet CA cert to general.yaml

fb932df6ee-+-ferm: Add status check

ecc41e098c-+-profile::idp: provide undef default value for Optional params

934c54d6ed-+-ci::master: add envoy for TLS termination for integration

12e626916e-+-role::statistics: share mediawiki/eventlogging profiles

f4a68eb228-+-Use -XX:NewRatio=3 for cloudelastic-chi instead of setting a specific size

392005ed10-+-cloudvps: update project service discovery prometheus config

9927a5f166-+-maintenance: Migrate update_special_pages to periodic_job

7e4c1c8092-+-nic_saturation_exporter on all physical hosts w/ hiera enabled

da6c43f858-+-profile::prometheus::nic_saturation_exporter: pass through ensure param

ce9a1cdf7a-+-ATS: cap ats-be TTL at 24h

d9e4a49496-+-maintenance: Migrate update_flaggedrev_stats to periodic_job

d3bd96cd84-+-mariadb-backups: Split mariadb::backups into 2 roles for backup2002

9221b66635-+-atskafka::instance: add snappy compression by default

5917959ea3-+-mariadb-backups: Move all backup config templates to its own subdir

ee01a2b3d3-+-database-backups: Set backup2002 as a generator of es* host dumps

618716bb0b-+-gerrit: remove unused parameter for cache_text_nodes

57dddc323a-+-ci::firewall: replace ferm::rule with ferm::service

4976e8faca-+-udp2log: Switch ferm::rule to the more canonical ferm::service

765fa64b31-+-maintenance: Migrate refreshlinks to periodic_job

19b5fcbf91-+-cloudvps: Add metricsinfra prometheus server

5597b6f3e7-+-prometheus/ops: add nic saturation exporter

aad44bbfcd-+-nic-saturation-exporter: remove erroneous override

c3bef2fb4f-+-jessie-ified nic_saturation_exporter on memcache hosts

f500c1d98c-+-Revert "puppetize nic_saturation_exporter & run on memcache hosts"

6d426a9e62-+-puppetize nic_saturation_exporter & run on memcache hosts

e32236aee9-+-contint: remove unused Gerrit firewall rule

981247ced1-+-purged: stop passing udp port

9add563173-+-contint: allow masters to ssh to themselves

9939670d6d-+-Run the refine failure flag checker against the last 48h instead of 24

fe16007826-+-sbuild: chroot: update it using the root user

235b80039d-+-cloud: review direct references to cloudcontrol1003.wikimedia.org

c4f58017be-+-zuul: inject Gerrit ssh public key to known_hosts

089f7a7095-+-Revert "Profile to inject Gerrit ssh public key to known_hosts"

7f91fa093f-+-Profile to inject Gerrit ssh public key to known_hosts

4cd55aeb6a-+-dynamicproxy: add support for dynamic XFF per FQDN

6faf685ed2-+-bacula: Increase max total size of Databases backups to 40 TB

8bef9ea8b0-+-cache: check that the purged process is running

e422691cb0-+-Set 10G for the JVM's young gen size to cloudelastic-chi

d60ed27014-+-mariadb: Move db1114 to s8

2bc8b355fe-+-Adding new cloudcontrol1005 as role insetup to site.pp

7cad1b584e-+-smart: make smart_data_dump importable for adding tests

b156dc276b-+-zuul: add missing ssh public key for zuul-merger

b302efe330-+-Enable TLS encryption between kafkatee instances and Kafka

d563bcc77f-+-kafkatee::instance: add types to parameters

beaf9ad9c4-+-purged: run one frontend and multiple backend workers

101e18a38f-+-zuul: create /var/log/zuul

2e5aaa0c2b-+-profile::mail::mx: Add toggle to enable jumpcloud integration

932deca57b-+-profile::mail::mx: add type enforcment, lookups and move defaults

bd1fab9be0-+-profile::mail::jumpcloud: add new class to manage jumpcloud aliases

a4aebcd3de-+-logstash: validate config files

3fc3569cbc-+-cache: ensure vhtcpd is stopped if using purged and vice versa

e62546d2bb-+-tlsproxy: add the ability to define an idle timeout for upstream connections

154856ba41-+-Set Java CMS GC for cloudelastic chi cluster

11130d2f93-+-mariadb ferm: fix a typo in the designate_hosts lookup

1f7ec59240-+-Remove now unused mediawiki/event-schemas repo

7dcdd3ea84-+-cloud puppetmaster: fix flatten() syntax when producing cert manager list

b70823c62b-+-designate: fix a misplaced ) in a ferm rule

9f480c0669-+-Designate: fix ferm rules for designate_hosts list

aa0d5df8c7-+-Designate: use a list of designate hosts in hiera

6acbcf3d70-+-Designate: remove the coordination_host param

736afe261d-+-cloudservices: add a missing ) in a ferm rule

6acf23446a-+-designate: remove second_region_* hiera values

477ded2916-+-designate: change api_base_uri to proper HA endpoint

97d5fa0747-+-openstack: increase labweb memcached size

5810aefe36-+-Make totp profile parameters optional

b0795a3762-+-sbuild: introduce module and use it in toolforge package builder

c584b97d3b-+-profile::kafkatee::webrequest::analytics: use ssl_array for Kafka Brokers

8abdc775e5-+-ATS: Enable res_track_memory in cp1085

dd9cf15c65-+-kafkatee: add support for TLS to Kafka and enable it for a test instance

48968a0339-+-role::analytics_cluster::launcher: add data_purge

b4626ad372-+-role::analytics_cluster::coordinator: absent data_purge

e18a0aee1e-+-netbox: switch git::clone to ensure present, not latest

5ccdca5cbf-+-Openstack python3-tooz hack: only install on hosts that really need it

a917cdfaf7-+-Openstack rocky serverpackages: require python3-tooz

e597b37b73-+-toolforge: Remove Jessie config for grid engine + bastions

e1a0d88dbc-+-toolforge: Update python dependencies for pywikibot

5d9fbefd8d-+-role::analytics_cluster::launcher: add druid_load

44261afffa-+-role::analytics_cluster::coordinator: absent druid_load

2a8e12aa36-+-role::analytics_cluster::launcher: add sqoop_mediawiki

af2189fc7e-+-role::analytics_cluster::coordinator: absent sqoop_mediawiki

f1e314ef2c-+-role::analytics_cluster::launcher: add project_namespace_map

b24c4524f5-+-role::analytics_cluster::coordinator: absent project_namespace_map

bebfaa1cf7-+-ci: remove blubber Debian package

96c2c3dea4-+-phabricator: remove firewall holes for port 80 from caches

24175f0044-+-role::analytics_cluster::launcher: add hdfs_cleaner

4dac29ed43-+-role::analytics_cluster::coordinator: absent hdfs_cleaner

c13dd2e1de-+-zuul: fix dependency on /etc/zuul and package if on buster

f9dbc3faed-+-profile::analytics::refinery::job::refine: add failed flags checker

cb0180bf74-+-Openstack tooz hack: don't explicitly depend on python3-tooz

2adff8306f-+-Openstack Designate: fix an encoding issue in the memcached tooz driver

2b7d59b895-+-maintenance: Migrate parsercachepurging to periodic_job

bf18368c33-+-cescout: additional changes for metadb sync

8cd6a7e12a-+-maintenance: migrate cleanup_upload_stash to periodic_job

28f11fe578-+-role::analytics_cluster::launcher: add Camus jobs

05cd3ebc01-+-role::analytics_cluster::coordinator: absent camus jobs

d98049cec2-+-role::analytics_cluster::launcher: add Spark refine jobs

f00d154906-+-Absent spark refine jobs from an-coord1001

4e4864913a-+-zuul: provision the scap repository

14b7c44748-+-tlsproxy: allow capitalizing headers when connections are http/1.1

5974894a31-+-cescout: update metadb's data directory

610cadb8b3-+-toolforge: bastion: bump nproc limit to 250

bb67fc8cae-+-Setup idp-test2001 as IDP staging host

17213704a9-+-make sure machine vision dumps dir is created on all dumps servers

1e361df5fd-+-installserver: include preseed in apt role, not in light role

059f801c82-+-mediawiki::web: nice envoy with the same priority as php-fpm

df6ce0f053-+-prometheus: job definition for purged

537e5bdc14-+-purged: use processorcount with explicit namespace

e3f70bcef9-+-weekly dump of machine vision tables from commonswiki

aa0eb5c55b-+-profile::kibana: add the package_name parameter

d640e356d0-+-Designate: typo fix

d4c6142c19-+-Designate: fully puppetize the designate pool config yaml

6f9cf82da0-+-raid: add lsscsi to required packages for hpsa raid

2c3cd4b79b-+-cescout: add OONI's metadb sync scripts

4cc1dba4f6-+-purged: set concurrency to 'processorcount'

8404d5cbef-+-ci: Use docker.io on Buster

06712c9974-+-profile::docker::builder: Add buster, drop jessie

6f749c8b6f-+-ci: add parameter to stop or mask zuul-merger service in codfw

ae543f95ed-+-cache: add support for purged to profile::cache::base

a4cedb758e-+-purged: add puppet module

c2bf9fbe8b-+-idp: only manage the keystore if ssl is enabled

a15c1bcde9-+-ci: allow rsyncing of data dirs for server migrations

52ff29ca11-+-role::elasticsearch::relforge: add kibana

723c1b149b-+-profile::services_proxy: allow adding XFP header, enable on parsoid/restbase

eff9dec4b2-+-maintenance: Migrate echo_mail_batch to periodic_job

749f6972c5-+-maintenance: Migrate updatetranslationstats to periodic_job

3a9dbd9c3b-+-cloud-vps: add vm client packages for Rocky

17ca4de272-+-mediawiki/maintenance: add startupregistrystats for test.wp.o and mw.o

a81bb9d495-+-Neutron/rocky: add l3_agent_hacks that include the dmz_cidr change

7bf5af85a2-+-cloud eqiad1: Remove references to old cloud-puppetmaster stretch hosts

5d6c1cee15-+-Add support for deploy-mode client in spark refine jobs

dcdb5f2f3f-+-profile::tlsprox::envoy: update request_timeout parameter

7a35c60934-+-profile::analytics::refinery::job::data_check: set deploy-mode client

3a5ec743ca-+-Add site.pp entry for idp-test2001

828e95760a-+-refine - look for schemas both primary and secondary schema repositories

635098126c-+-Add refine failure flag check for Eventlogging data

ca47e41ee6-+-Move profile::refinery::job::data_check to an-launcher1001

15de0adbf1-+-openstack: queens: drop python2 packages

8647583539-+-ATS/phabricator: configure aphlict certificate

a1a90b1550-+-Revert "Revert "Revert "profile::analytics::refinery::job::refine: exclude TwoColConflictExit"""

058dd8ba74-+-decom miscweb1001 and miscweb2001

c78a3f693f-+-ADD backup2002 to role spare

71161c5cd6-+-openstack: codfw1dev update neutron haproxy config

9faccec733-+-openstack: update haproxy healthchecks for openstack services

ea75ce9b86-+-kibana: move httpd proxy authentication to a separate profile

82ce03597f-+-maintenance: Migrate translationnotifications jobs to periodic_job

8167fb98ee-+-prometheus: alert on stale textfiles

5e84ec3e63-+-openstack: update nova-placement healthcheck in codfwdev1

a5e5ac0c3f-+-amd: update package list after 3.3 upgrade

7a36511a77-+-profile::statistics::gpu: upgrade stat1008 to ROCm 3.3

e51650b9d3-+-superset: handle upgrade to 0.36.0

bc11cc0826-+-wdqs: Initial configuration of wdqs200[78].

fd47b022ad-+-prometheus: additional external_labels for Thanos

d06aecae62-+-dbproxy1010: Remove all puppet references

786744fe66-+-Keystone: Drop in a backported fix to token_formatters.py

2746002fb6-+-neutron-api: create /var/run/neutron

ea90166f93-+-Neutron: move uwsgi socket file to /var/run/neutron

fdaee5bfdf-+-Neutron: add management of neutron-api-uwsgi.ini and api-paste.ini

06a2950710-+-OpenStack Rocky: pin uwsgi-plugin-python3 uwsgi-core for Rocky

9c41b85433-+-OpenStack/Rocky/Stretch, avoid upgrading systemd

59b61be162-+-OpenStack: add config and manifests for version Rocky

7736d7c3b5-+-Openstack Neutron: add neutron l3 hacks for Rocky

3cc56d1ec1-+-toolforge: update the package_builder role so it can be neatly used

071847ab66-+-OpenStack: remove config and manifests for version 'Ocata'

60ea34b9a8-+-OpenStack: remove config and manifests for version 'Newton'

104350a8ca-+-OpenStack: remove config and  manifests for version Mitaka

2a81811e19-+-Add class ::openstack::clientpackages::vms::queens::jessie

5dfaa477e1-+-installserver::migration: fix rsync dir name

9580a42d3a-+-Openstack client packages:  define for queens/jessie

2fdfe44967-+-installserver: rsync home dir data for migration

c6663bb998-+-Revert "Revert "profile::analytics::refinery::job::refine: exclude TwoColConflictExit""

a64a802163-+-jenkins: Adjust CSP header to allow inline CSS and video playback

f81a1e4723-+-Add python3-setuptools to package builder packages

6d1163e33e-+-Add dh-python to package builder packages

e4f6991843-+-aptrepo: add MOTD warning to not use old install servers for APT

72969d629d-+-Revert "profile::analytics::refinery::job::refine: exclude TwoColConflictExit"

a21fc70972-+-site: add role(dumps::web::htmldumps) to htmldumper1001

60797a63c1-+-labsdb: Prepare basedir for Buster and 10.4

9d39339760-+-Use bsd-mailx, not s-nail

4d3e8ebc88-+-Add s-nail to send mails after package imports

e825d126b9-+-profile::mediawiki::maintenance: Migrate pagetriage jobs to periodic_job

38df9661d2-+-Remove hosts hiera for cloudmetrics1001 and 1002

4fea9eead0-+-site: Fix Debian release name (*B*uster) in comment

9617a9c662-+-decom planet1001 and planet2001

8408dbb12b-+-envoyproxy::tls_terminator: update accesslog directives

846ea3cae3-+-smart: stop smartd on Buster + hpsa

032ede822d-+-ATS: increase check_trafficserver_log_fifo timeout

6f9cbcdfb1-+-systemd: add support for network accounting

ae458bf59c-+-site: fix comment about public/private IPs of apt repo

fc3a7fa017-+-Add peer_ip_src dimension for netflow in Druid and Turnilo

dc03976088-+-parsercache.pp: Prepare basedir for buster

00b7679cd2-+-site,install_server: Restore cp2027 as cache::text

03b726920b-+-site,install_server: Decommission cp20[16,19,23,27]

bfc5051979-+-site: decommission cp20[18,20,22,24-26]

5eea3b0774-+-tftp: if service is told to be stopped, do not monitor it

cbb1437cce-+-profile::pmacct: use kafka TLS connection string when needed

10c1c11dcc-+-installserver/tftp: add missing ensure_service parameter

fc5abf42c2-+-site: Reimage cp2042 as cache::upload

91a6ab66ee-+-ATS: check if fifo-log-demux is logging

f37c46df08-+-installserver: stop tftp service on old install servers

62ad45a849-+-site: Reimage cp2041 as cache::text

08af066830-+-site,install_server: Decommission cp2013

42f7e517d5-+-maps: add parameter to disable tilerator

02041ed678-+-profile::scap::dsh: fix typo

007ee1bb80-+-scap: define MW canaries dynamically

17547bae1c-+-firewall: ensure abuse network blocks are placed first

3a35193906-+-tendril.pp: Set default basedir depending on the OS

04982bc7a6-+-conftool::scripts: add ispooled

310f0c50f8-+-site: Reimage cp2040 as cache::upload

189e7f6c51-+-site,install_server: Decommission cp2017

f20b4d5d90-+-site: Reimage cp2039 as cache::text

820c298953-+-site,install_server: Decommission cp2012

13e2f6c177-+-profile::swap: add mysql credentials for analytics-privatedata-users

8b61cb76bd-+-site: Reimage cp2038 as cache::upload

b1f64150e4-+-Revert "jenkins: Adjust CSP header to allow inline CSS and video playback"

c53fa90b69-+-cescout: add HTTPS proxy support

9170b1d547-+-jenkins: Adjust CSP header to allow inline CSS and video playback

f6f5f8f7fe-+-decom mw1254 through mw1258, remaining rack D5 appservers

5fd40e2271-+-site,install_server: Decommission cp2014

796eaac278-+-site,install_server: Decommission cp2010

ca482e8edb-+-site: Reimage cp2037 as cache::text

de3e173b0c-+-contint: add acl package for file permissions tweak

0065776a5b-+-site: Reimage cp2036 as cache::upload

6e958fab9e-+-profile::base::firewall: add support for abuse_networks

e578122425-+-network: add new function to return ip lists used in ACLs

536614d91c-+-site,install_server: Decommission cp2011

03bbaeb5eb-+-eventstreams: revert removal of monitoring class

495be7c934-+-site: add planet[12]002

d263aff00d-+-site: Reimage cp2035 as cache::text

26e4689a0d-+-site,install_server: Decommission cp2007

102b21b207-+-site: Reimage cp2034 as cache::upload

188629ab52-+-eventstreams: Remove profile

7814ecf4dc-+-toolforge-k8s: mount /var/lib/docker on appropriate volume

d70a7f24f2-+-systemd: Replace the Datetime regex with a call to systemd-analyze.

6b8a09b9e5-+-toolforge: remove the old docker builder code

bc49dd48af-+-ssh-key-ldap-lookup: keep a python2 version for Jessie

1bad9b6d07-+-ssh-key-ldap-lookup: port to python3

81250a73e4-+-site,install_server: Decommission cp2008

2c5cd05d19-+-toolforge/mailrelay: Fix wrong source URI

a46ab9d271-+-site: Reimage cp2033 as cache::text

40567509c1-+-otrs: Add 2 new CPAN dependencies

b39ad02b99-+-site,install_server: Decommission cp2006

e158bb707a-+-gerrit::proxy: Switch to strong SSL settings

ca57bb862e-+-site: Reimage cp2032 as cache::upload

5294a0fc39-+-prometheus: add http redirects for the default instance

eead6bdecc-+-site/DHCP: remove cp1099

a85d36df3f-+-site,install_server: Decommission cp2005

b5190769a3-+-site: Reimage cp2031 as cache::text

caf7485004-+-puppetdb: Remove support for < buster

10e7d97297-+-site,install_server: Decommission cp2004

f4a38b0c00-+-toolforge: legacy_redirector: fix toolsbeta support

93fa5360bb-+-icinga: relax check interval for selected checks

815065e645-+-site: add miscweb2002.codfw.wmnet

0886011425-+-tlsproxy::envoy: fix rspec and TODO comments

573726bd20-+-profile::tlsproxy::envoy: allow users to override the cluster addr

4157565d00-+-envoy: introduce use_remote_address parameter

800e462db8-+-toolforge: introduce role/profile for legacy URL redirector

0896735829-+-mariadb-backups: Move friday backup to Saturday to avoid 3-day old ones

91fa5f6ee9-+-site: Reimage cp2030 as cache::upload

e7847d7c86-+-site: Remove cp2029 from insetup_noferm role regex

91a14f4244-+-site,install_server: Decommission cp2002

3495de5903-+-site: Reimage cp2029 as cache::text

e66e803644-+-site,install_server: Decommission cp2001

5b9063b394-+-postgres: Remove support for jessie

1bb12e9124-+-nagios: Remove support for jessie

bc69cd2cb6-+-Remove jessie support for puppetmasters

52b230a7fc-+-Don't include component/thirdparty-k8s on Buster

93b8ad7114-+-site: Reimage cp2028 as cache::upload

63918d35e2-+-site: Reimage cp2027 as cache::text

931ae9aee0-+-profile::analytics::refinery::job::refine: exclude TwoColConflictExit

1a925f799b-+-Add rate limiting to profile::toolforge::mailrelay with warn action

1683968913-+-fix check_trafficserver_log_fifo UNKNOWNs due to timeout

fa91a57530-+-Openstack: add Designate manifest and config for version Rocky

51703ae605-+-toolforge docker: fix image_builder profile

60c5d706f9-+-openstack: codfw1dev add ceph common profile to control and virt roles

b13aa8f1e0-+-toolforge: rebuild the docker::builder setup as buster

1c92706f42-+-openstack: add ceph common profile to control and virt nodes

b6bf71b471-+-ceph: refactor ceph-common for clients with no configuration

12cf8ca69d-+-Add a profile for the cescout role

8538c929b0-+-Adapt deb src to Buster being the primary build host

fca886a5e2-+-racktables: fix php.ini path for buster support

c15326b9c4-+-iegreview: use mariadb-client instead of mysql-client

952ac64f54-+-wikimania_scholarships: fix php-mysql installation on buster

4dd125603d-+-Make the docker package name configurable and use docker.io on deneb

66f661df16-+-misc_apps/httpd: add support for PHP on buster

a5e4d874b6-+-add webserver_misc_apps role to miscweb1002

f528eb643f-+-Temporarilty disable webrequest deletion for 1 week

2bc9ac3fff-+-cdh::hadoop: use line instead of match for file_line

ee0030d532-+-site: add miscweb1002 with insetup role

6454a8b8c2-+-cdh::hadoop: allow hadoop daemons to override ipv6 settings

74f9f6903f-+-eventstreams: Remove from scb role

9dedce4349-+-Make image pruning toggleable

e33f048a46-+-trusted['certname']: use facts['fqdn'] instead

da6328ebbb-+-openstack: queens: don't install libpam-systemd from bpo

8cef859d8a-+-profile::idp::client::httpd: add check for sso redirect

38ee0d9e19-+-Add new cp nodes cp2027 to cp2042 to site.pp

080db2f008-+-noc: add another missing bracket in ferm rule syntax

08b227920b-+-noc: add missing brackets in ferm rule for cumin masters

c2c448a12a-+-realm.pp: trusted facts unavailable when performing a lookup or pcc

0be1050426-+-noc::site: close port 80 for caching servers

79932d4639-+-openstack: queens: apt pin systemd harder

3fe1260541-+-Add more precise notes_link for mediawiki originals uploads alerts

9376583bcf-+-Use builder role for deneb

de1d1b63bb-+-logstash: add new SSD hosts to ELK7 cluster with disktype attr "ssd"

6a953b9088-+-toolforge cleanup: remove the ferm_handlers profile

2f7b1097f4-+-profile::tlsproxy::envoy: allow defining timeouts, disable retries

89196a9eab-+-Revert "Neutron l3_agent: refresh on config changes"

d04a8178ba-+-microsites::httpd: close port 80 for caching servers

de6b916289-+-Revert "Remove puppet-common"

4e48446ef9-+-Remove puppet-common

c82abae865-+-cloud: novaproxy: fix default value for String typed hiera keys

75c751a825-+-cloud: refactor novaproxy role

0a34eec141-+-site: decom mw125[0-3] and mw123[2-5]

58067a78a2-+-profile::presto::server: add nagios process check

8c687118fb-+-Add deneb to site.pp

36ae1a5c4b-+-toolforge: clean up the now-unneeded ferm_handlers

d5f7e143d7-+-k8s: purge flannel from the environment

3735ba15b8-+-Keystone policy: merge keystone policy with horizon identity policy.yaml

98aa6c2bc6-+-Horizon: integrate neutron policy with the actual Neutron policy.yaml

c3d8a09a6b-+-Horizon: integrate Horizon policy with actual designate policy.yaml

10d137dcd8-+-Horizon: unify horizon glance policy with actual glance policy.yaml

9eb473d61e-+-Revert "openstack: switch cloudvirt101[56] to ceph storage"

8aac2ee128-+-site: add insetup role to otrs1001

1df426a277-+-nova-compute: require python3-libvirt for Queens

ac20d34f95-+-Avoid overriding Hadoop's core files to allow IPv6

c1b2149586-+-toolforge: support canonical redirects in urlproxy

58e35d19f4-+-profile::analytics::client::limits: add slice settings for cron

2e7d6ae676-+-Make profile::mariadb::ferm_public actually public

4bd100f1a2-+-Neutron l3_agent: refresh on config changes

07b7373e6d-+-Horizon: fix path to nova policy.yaml

d5e7861bb3-+-Horizon: unify horizon nova policy with actual nova policy.yaml

e9a5b46389-+-Horizon: add datatypes to source_deploy profiles and class

3da3e123e2-+-horizon: use lookup() in the source_deploy profiles

032a483adc-+-Horizon: split $version into $horizon_version and $openstack_version

e1cb9dbb1b-+-mariadb-backups: Skip Saturday snapshot to prevent a retention of 4 copies

d6d43ba47e-+-profile::tlsproxy::envoy: use the chained ssl certificate

0a117d6354-+-logstash: don't require full logstash heap on plugin installation

103aed130d-+-icinga: add 'patch' to requirements

0873c9bc7d-+-kibana: assign httpd_extra_modules in all cases

59bb2ef27b-+-Add profile::base::no_firewall to load balancers

bec015b091-+-New ferm sub profile for public mysql proxies

acaa9fd21b-+-icinga: use fqdn_rand

cdaabd827c-+-Add wdqs blazegraph's alerts only for non-test clusters

ba982e401a-+-icinga: manage 'metamonitor' user home

175d149f63-+-statistics::discovery: run the timer under the user.slice

8fb337c34f-+-systemd::timer::job: add a parameter to change the systemd slice

2aa70de6a5-+-profile::idp: update profile to use tlsproxy::envoy

9a18b39570-+-Improve the old_jvm_gc_checks's elasticsearch alarm

a7f3942596-+-statistics::sites::analytics: remove reference to statistics-web-users

dd047a364c-+-Horizon: convert disabled_policy.json to yaml

d31a31cddd-+-site/conftool: decom mw1244-mw1249 and mw1227-mw1231

b03701e6b8-+-neutron: replace policy.json with policy.yaml

2a9d7b0e84-+-Revert "neutron: replace policy.json with policy.yaml"

e8a26c2f4c-+-neutron: replace policy.json with policy.yaml

819633abad-+-gerrit: replace hiera() with lookup()

01bbc9af5d-+-contint: use ensure=>present when cloning composer

ca141ba2f4-+-contint: use ensure=>present when cloning slave scripts

e1bb5983d1-+-toolforge: remove the last toollabs role

7d95190b9c-+-profile: set icinga exporter scrape_timeout to 20s

174b6b8a0a-+-designate: move policy.json to yaml

63afe72cd3-+-toolserver: refactor into profile and move off "toollabs" name

4be1b69aec-+-profile::services_proxy: refactor to simplify cluster definitions

81a68171d3-+-Revert "profile::idp: update profile to use tlsproxy::envoy"

1411d66672-+-profile::idp: update profile to use tlsproxy::envoy

76e0806308-+-profile::docker::engine: Remove support for jessie

b2fff856c0-+-profile::java::analytics: Switch to apt::package_from_component

0e4909ddd8-+-toolforge: refactor docker builder to remove toollabs module

28f8aedbd0-+-nova-compute: install version-specific config

7bb199930c-+-toolforge: fix file location for grid override.my.cnf

48c18b01fa-+-releases: close port 80 for caching servers.

edb3abeb64-+-role::prometheus::analytics: correct presto targets

76d908e6c0-+-toolforge: remove almost entire toollabs module and related roles

9d3bd5d246-+-Remove apache-fast-test, now replaced by httpbb.

381c4b2d3f-+-role::prometheus::analytics: add presto targets

4fd669ec6b-+-profile::mariadb::cloudinfra: Allow overriding of hostnames

a2b7904f98-+-CFSSL: add cfssl module

1c80634268-+-no second dumps run this month due to vslow dbs serving live traffic

b6969f5ae4-+-planet: close port 80 for caching servers

f5e9943f1c-+-Introduce new role for cescout

9b5ef1eed1-+-site: add cescout1001

5f6cec055d-+-glance: move policy.json files to yaml

2a0b8772e0-+-Keystone: convert policy.json to yaml

78968dc6f5-+-site: add CI ganeti nodes

3224079cf0-+-kibana: refactor kibana role to kibana profile

8c3682d6e0-+-services_proxy: allow setting a keepalive timeout

4f50c82cbc-+-racktables: remove port 80 firewall hole

0037adb342-+-prometheus: add icinga average latency checks

672bb5c0cf-+-Add initial Prometheus monitoring config for Presto

a0ec7827b3-+-atskafka: specify TLS configuration

83b3005a6a-+-atskafka: rdkafka configuration support

2be20bd6f0-+-misc_apps: add firewall rule to let envoy talk to port 80

98277ac718-+-iegreview: remove port 80 firewall hole

c6881d3bd7-+-site/conftool: remove mw1238 through mw1243

a53dedd7da-+-base: relax interval for selected checks

606c041197-+-role::analytics_cluster::superset: add kerberos settings

f04c44b27a-+-mediawiki::webserver: split tls proxy config out of profile

8722490088-+-squid3: bump max open file descriptors

f80c9e1586-+-envoy: check for runtime variables set for a long time

ec1425793b-+-ATS: Add session_ticket_number to Inbound_TLS_settings

7b473dce90-+-cache: add atskafka webrequest test instance

041052fdbd-+-atskafka: add puppet module

cc930b295b-+-cache: decrease varnish-frontend malloc cache size

4f50ccd1cc-+-toolforge-k8s: remove old legacy-cluster code from bastion

5066d29b65-+-site/conftool: remove mw1221 through mw1226

8bd4ca325a-+-nova policy: convert from json to yaml

da437067c7-+-Revert "site: let labtest* use role(test), not spare::system"

f6d69acafa-+-site: let labtest* use role(test), not spare::system

814716ac37-+-Fix typos (boostrap -> bootstrap)

34ddd3134c-+-Fix typo, accesible -> accessible

b0c77a894f-+-Prometheus Squid exporter, specify proxy port

276a6f6c22-+-profile::services_proxy: allow defining a retry policy

bc42d9af7b-+-mariadb-backups: Change bacula backup frequency of dbprov to weekly

3c369bb9f4-+-mariadb-backups: Change bacula backup frequency of dbprov to weekly

b7aa74ed6d-+-wikimania_scholarships: remove port 80 firewall hole

14e97fec22-+-phabricator: add warning about /srv/dumps

ecc16e81e2-+-dumps-distribution: Fix smartmontools so it doesn't trigger alerts

cef591b1ce-+-profile: increase inotify instances in core DCs

379761fdb2-+-installserver: disable squid monitoring if service is absent

be3b04a908-+-prom@ops: increase inotify watches in core DCs

910f962df6-+-installserver: allow configuring squid as absent in Hiera

9e78cc3432-+-OpenStack/Queens/Stretch: fix pinning rule

2936e7f756-+-OpenStack/Queens/Stretch, move priority to 501

332b4ecf95-+-Set kafka-main[12]00[4-5]-main as role::insetup

4e5bda7c9c-+-OpenStack/Queens/Stretch, avoid upgrading systemd

c9cedbaf37-+-cpjobqueue: Add jobrunner_host & videoscaler_host to deployment vars

91b22d55de-+-openstack: l3_agent: introduce dmz_cidr-only l3 agent custom hack

348e41d05c-+-puppet agent: add parameter to change certificate_revocation behaviour

7e5a9b316f-+-puppetmaster: add parameter to control ssl_verify_depth

8e58a1d127-+-openstack: neutron: l3_agent: relocate depedency on Package resource

2cae26be20-+-Remove obsolete kafka[12]00[1-3] from site.pp

5c1d0ba394-+-assign codfw logstash ssd hosts role::insetup

19624a2f5c-+-doc: add envoy for TLS termination on doc1001

0689695dd4-+-elasticsearch: add 'disktype' param to configure node.attr.disktype

174cc82c06-+-profile::statistics::gpu: add stat1008 to the list

885e64b8d5-+-Add stat1008 to the list of Analytics statistics servers

a1f5745eee-+-Assign role::statistics::explorer to stat1008

a6d4647641-+-Designate: add wmcs-populate-domains script

c8befb8852-+-decom elnath.codfw.wmnet

82d80c4d85-+-Remove some stray Puppet references to cp1008, cp1071-cp1074

18c647a55a-+-DHCP: Add MAC address and role insetup for ganeti2019 to ganeti2024

7dc52b38d8-+-remove references to grafana1001

33b52b090d-+-puppet/site: fail if no role has been assigned to a node

1e0d438735-+-logstash: add ES 7 compatible logstash template

1e14dbdca6-+-Add srestest100[12] role(insetup) in site.pp

4c91e1bd27-+-site: let new dbproxy machines use role(insetup)

49d3dc2da0-+-site: let new logstash machines use role(insetup)

e427b2ce88-+-site: let new ganeti nodes and logstash1008 use role(insetup)

6ac7a3b8c7-+-dns: add the Netbox driven DNS zonefile snippets

0a6f3a4149-+-site: add role(insetup) to wdqs200[78]

d2db207832-+-site: add missing parse2010 to regex

f858cd44ee-+-use new role(insetup) on a few hosts in setup

d9c11fdcb6-+-Create roles for the initial setup of a server

61cab68dbe-+-Add htmldumper1001 to site.pp

bd5fa893b4-+-profile::analytics::refinery::job::data_purge: purge wdqs query logs

9d33fc2e84-+-spicerack: add auth secret for cf cookbook

d08fd9f2d3-+-Add xmldumps to stat100[4,5]

8358f69577-+-profile::envoy: check that envoy is running

ea1aed8e0a-+-statistics::rsync::eventlogging: run crons as root

9b02fec23b-+-Follow up after Analytics client host refactoring

5efda59523-+-site: fix duplicate regex and row for mw2366-mw2376

a3b90a422e-+-typo fixes: s/ preform/ perform/

40f8b06361-+-add mw2350-2376 as API and appservers, codfw rack C6

4ac468eb4a-+-Add stat1008 to site.pp role spare

b63289b3f9-+-Fix incorrect name of safe_service_restart parameter

69e62d4375-+-hiera/aptrepo: rename install_server variables to aptrepo_server

07eb4f4342-+-Move stat1006 to role::statistics::explorer

aa8175e6fc-+-admin: deprecate statistics-privatedata-users

97a502e0cb-+-ATS: Turn on TLS Session tickets on ulsfo

2f6fc0aad7-+-Adding wdqs101[1-3] to site.pp role:spare

5100ae9a56-+-bacula: Increase max total size of backups to 35 TB

e1a968dddf-+-Introduce profile::statistics::eventlogging_rsync

d374ff549e-+-statistics::mysql_credentials: use require instead of defined

a84c825d63-+-Enable ssoSessions endpoint

97720ed826-+-statistics::compute: deploy mysql credentials only when needed

9dd91cc421-+-mariadb-backups: Increase snapshot frequency and retain those on bacula

0b3208a7a2-+-Openstack queens packages: absent some python2 packages

435f98c49d-+-monitoring_agentrun: fix typo

0d4537e733-+-puppetdb: monitor agent runs

2c2f0891bf-+-lvs: delete legacy eventgate monitors

475d50fa6b-+-logstash: adjust client error topics for eqiad/codfw

092f0d76e9-+-jupyterhub: use http_proxy pid file for Buster

d266ba3e35-+-ATS: Support TLS Session tickets

1d3164be4f-+-keystone: Backport the Rocky version of ldap integration

685d26a037-+-systemd::syslog: ensure log dir is removed if resource is absent

095803aea7-+-icinga::monitor::elasticsearch::old_jvm_gc_checks: fix grafana URL

582fb64125-+-role::statistics::explore: add profile::swap

86250fc865-+-cirrus: initial configuration of elastic20[55-60]

69a60d394c-+-prometheus: fix file sd path for envoy

8b6977f952-+-profile::swap: use nodejs 10 by default

564656e2b4-+-envoy: purge undeclared listeners and clusters definitions

aec99d8fba-+-profile::oozie::server: allow to set the sharedlibpath

4ed34b082a-+-prometheus::squid_exporter: service is called 'squid' again on buster

ccbbe0b10f-+-Add Prometheus exporter for Squid

1693b6dd3f-+-Add dhcpd/netboot.cfg and site.pp (role::spare) logstash102[6-9]

e676597e6b-+-Fix permissions on /srv/parsoid-testing

62e8bab0cf-+-httpbb: Replace apache-fast-test with httpbb in deploy_apache_change.

eeb2bfd44a-+-toolforge: remove old k8s client material for Jessie

29f4288c72-+-site: switch install1003/2003 to public IPs

b0dc79ff67-+-netbox: consolidate naming of resources

435408c119-+-codesearch: Prevent ferm from deleting Docker iptables rules

fb41dc361e-+-haproxy nova-placement: fix typo

fd1f9cef93-+-nova-placement haproxy: update the health check route

7d35749848-+-openstack haproxy: change glance-api health check

f17e07c8b4-+-profile::swap: pass use_nodejs10 parameter to jupyterhub

b4f50624f9-+-jupyterhub: add the option to use nodejs 10

4eff43fa2f-+-add mw2325-mw2334 as API and appservers, codfw rack B6

1fb5df4fde-+-homer: actually manage the git hook directory

9a43af2168-+-CAS: Make the actuators a profile argument

426b361bc7-+-profile::services_proxy::envoy: refactor around listeners

7a9a783d23-+-Change CAS actuator base web path to api/

6ccf8927cb-+-jupyterhub: force systemd spawner to use the user.slice

ac449cca29-+-mariadb: Set 10.4 as default for buster

24c10468a8-+-Neutron: override the default neutron init script from Queens

f80d554e5c-+-site: add mw2301 through mw2309 as api and appservers

54d86810e1-+-toolschecker: Update to monitor the new etcd cluster

09c26023ce-+-Openstack glance queens: override package-installed init script

0f565ab68e-+-site: Assign appservers and API servers in eqiad row C.

ca5472948c-+-keystone: use python2 mod_wsgi for pike but python3 for queens

a1be8f2ce0-+-Keystone: Include python3-mwclient

aa62f3a177-+-Install python3 version of designate/makedomain

8c1fbc2084-+-add mw1385 through mw1392 as api and appservers

9045c51870-+-tools-prometheus: removing material related to the legacy k8s cluster

7015db37d1-+-Remove profiles from stat100[6,7]'s roles not used anymore

07da4779ce-+-facilities:monitor_pdu_service: Add types to parameters

158967c6f7-+-Check out parsoid from git on paroid::testing machines

517db528b2-+-mjolnir: Install python3.7 to older debian versions

1225fc2d22-+-toolforge: remove monitoring for old k8s cluster nodes and flannel etcd

25866cecda-+-envoyproxy: run validation as user envoy

3f9882b1e3-+-neutron: update l3_agent hacks for Queens

24e540718c-+-grafana: remove the obsolete X-WEBAUTH-USER hack for grafana logins

1355c4d4b5-+-Scrape webperf Prometheus metrics

6b0dc71f15-+-mediawiki::maintenance: force removal of directories

2ce2ce8dd8-+-prometheus-mysqld-exporter: Workaround upstream package regression

eb8f49bb49-+-envoyproxy: support tcp fast open

51382dbfdc-+-prometheus:fix typo

a19013b97b-+-prometheus::ops: collect envoy stats from all servers

c336cd7cf5-+-DHCP: Add MAC address for mw2350 to mw2365, Add those servers too to site.pp

0be7b71bce-+-site/conftool: add new appservers in eqiad row B

fa55f718d2-+-cloud-vps client packages: add Queens manifests

5f08fbf8b5-+-keystone: add Queens service manifests

20d21ef1c9-+-glance: add queens service manifest

242cd86c59-+-nova: add openstack queens manifests

cf938eb8ef-+-Neutron: add manifests for queens

a2527342af-+-LVS: add alert on CPU saturation, which causes pkt drops

01739ac9b4-+-openstack: switch cloudvirt-wdqs servers to Ceph

2c62f2b3bd-+-keystone: port some custom .py files to python3

36618ab9d4-+-Blacklist mediawiki_job_CleanTermsIfUnused from refinement

cd9ee0047a-+-installserver: ensure interface for DHCP server is configured

52c817ff31-+-toolforge: clean up maintain_kubeusers and legacy proxy puppet code.

9152463132-+-profile::superset: allow to deploy Presto TLS CA

fa826b00a2-+-toolforge: remove special configuration for kubernetes on proxy servers

5a0e1cdd37-+-Add check_eventgate_analyltics_external_cluster

f7abaab742-+-Remove system::role from role::logstash::collector

c66e1f4dac-+-Add kerberos credentials/config for Superset Staging

b4be0f7c5f-+-role::lists: use mod_cgid on buster instead for mod_cgi

4d330bd569-+-Revert "Ensure readability settings for home dirs of Analytics clients"

18bf62e8d3-+-Ensure readability settings for home dirs of Analytics clients

975f283ec3-+-icinga: allow to specify port for https redirects

50882a2fcc-+-role: openstack: eqiad1: net: cleanup old comments

09b33396f0-+-icinga: add check_https_redirect missing command

2b4c8b23b9-+-debmonitor: make icinga check desc unique

373ccbd5c5-+-openstack: serverpackages: include pubkey for osbpo repository

af6d4276c4-+-Remove system::role from role::prometheus::ops

46729e1f71-+-profile::services_proxy: remove from puppet

0b51c01009-+-profile::swap: add auto_ferm settings for rsync

5597971aa3-+-profile::tcp_fast_open: create tiny profile

4d9909af05-+-monitoring: remove hostname from mgmt definitions

71facccf5a-+-installserver: allow stopping DHCP server in Hiera, apply new role

5f803c5b43-+-lists: don't assume lists IP is an interface::alias

5a5073ddc2-+-httpbb: Add python3-clustershell to required packages.

231cd1d467-+-keepalived: add initial module and toolforge profile

274fb2f030-+-Install httpbb on deployment servers, alongside apache-fast-test.

6106195b3a-+-wmcs::monitoring: add envoy for TLS termination for grafana-labs

7c36e5fadc-+-designate: include python3-git -- we need this for wmfsink

7297a1e8cf-+-designate: install python3 versions of sink handlers

6a072235cb-+-pdu: Fix type for $breaker variable

2fabd7366d-+-prometheus-mysqld-exporter: Fix options for multiinstance hosts

bfe6728a6a-+-check_bgp, add more AS# to --critasn

e3cdc4f67e-+-Remove monitoring and alerting for eventgate to-delete services

6d7e38be30-+-wdqs: added link to runbook entry for categories update lag.

025d596082-+-GoBGP don't restart automatically the deamon

b6f49db897-+-designate: add queens service manifest

8b46db8c00-+-lvs: Decommission lvs2001.codfw.wmnet

c616149d37-+-lvs: Add lvs2007 as a high-traffic1 load balancer

e6c96b249e-+-statsd: allow DOMAIN_NETWORKS

0210dd9605-+-icinga: allow DOMAIN_NETWORKS

3228a3d51b-+-graphite: allow DOMAIN_NETWORKS

d96781be4d-+-syslog: allow DOMAIN_NETWORKS

69243931ea-+-lvs: Decommission lvs2002.codfw.wmnet

4999503ed1-+-openstack: serverpackages: introduce repo configuration for rocky/stretch

2ccd99531d-+-openstack: serverpackages: queens: stretch: introduce some apt pinnings

af82050ac8-+-openstack: serverpackages: queens: stretch: add nochange repository

067d188960-+-Bump max CAS session life time to a day

5f84332408-+-installserver/apt: allow setting gpg_user different from reprepro user

674f917a1a-+-installserver/apt_repo: add homedir parameter, move dirs to Hiera

ab86b2a748-+-aptrepo: puppetize gpg sec and pub keys for apt.wm.org

e3135fc414-+-cloudmetrics: clean up the grafana-labs-admin endpoint

50e8739163-+-profile::wmcs::nfs::backup::primary::base: include a standard firewall

e90ec4c6cf-+-releases: remove superfluous lint-ignore line

4f507d33e5-+-codfw1dev: include clientpackages on keystone service host

4fd0f6b49b-+-keystone: allow setting the bastion project id via heira

e1e4a174bd-+-aptrepo: puppetize REPREPRO_BASE_DIR env variable

db5287c92a-+-keystone hooks: create new default domains for new projects

2bbc57ece5-+-Openstack Queens: use mirrors.wikimedia.org for the Queens backport

3e7cf3206d-+-Add root's home to the backup for apt*

b9272d93df-+-Convert all the apache-fast-test URLs to httpbb tests.

8e13db278a-+-nova: remove the custom scheduler pool filter

4f868a2655-+-install_server,lvs: Decommission lvs2004.codfw.wmnet

b306892f76-+-Allow analytics client nodes to set user.slice global limits

bda23c96ec-+-mediawiki: install phpdbg on mwdebg hosts.

1cc9df51d4-+-install_server,lvs: Decommission lvs2005.codfw.wmnet

f76d840945-+-lvs: Add missing mapping of lvs2008 as high-traffic2

ac8a7c780a-+-profile::services_proxy: enable envoy everywhere

46e7afddd8-+-Fix some incorrect uses of the lookup function

613b89a9d2-+-puppetmaster: enable strict_hostname_checking[1]

b758c130c4-+-Fix system role names for restbase

8708f0d565-+-toil: probe rsyslog tls listener every 5 min

8e5a08639b-+-Remove role::prometheus::k8s in favour of including the profile

16bf129e21-+-lvs: Add lvs2008 as a high-traffic2 load balancer

54403f0f0a-+-grafana: remove the distinction between readonly and admin domains

32004fff7e-+-toolforge: remove the ancient version of kubectl

abd2da3269-+-profile::hive::metastore: add prometheus monitoring by default

08d9daf757-+-profile::hive::server: add prometheus exporter by default

41852dc233-+-role::prometheus::analytics: add jmx job for Hive in Hadoop test

c47259438e-+-profile::analytics::refinery::job::refine: fix el blacklist

0895e80bed-+-sonofgridengine: prepare for new domain name

f40073ba0f-+-access_new_install: remove superfluous lint-ignore and FIXME

6e6642fabc-+-toolforge-kubernetes: shut down the old maintain-kubeusers

bc3454760c-+-site: add second batch of new eqiad appservers as spares, by rack

494a5e3676-+-mariadb: Place db1111 into s8 eqiad

c3b500eee2-+-mariadb: Move db1111 into s8

af9b05f87f-+-add load balancing for kibana-next

a3d18d2a5b-+-profile::statistics::dataset_mount: add an-launcher1001

2aec1f0229-+-prometheus: Update ops file names for labs mysqld exporter scrapping

fd056440cc-+-role::analytics_cluster::launcher: add statistics xml dataset mounts

3dc6f79f66-+-Revert "mariadb: Move db1114 to s8"

f172bbdcf1-+-Move kowiki to xml dumps bigwikis list with appropriate settings

ee6f0e5360-+-mariadb: Move db1114 to s8

7fab6c514f-+-Move import_wikidata_entities_dumps timers to an-launcher1001

2a0b0c7851-+-Move import_mediawiki_dumps timers from stat1007 to an-launcher1001

0f16e4427e-+-cloudstore: Add cloudbackup servers to the ferm rules

604cadd465-+-puppetmasters:  remove the install-console script

eabbd70824-+-Move all Report Updater Jobs to an-launcher1001

7f080cb99f-+-site: add new parsoid nodes with spare role

aa1cb61478-+-Add cloudvirt-wdqs hosts

3263abfd34-+-labstore: one more nfs ferm fix for the primary cluster

563809c8f7-+-logstash, mediawiki: minor fixes in log streaming

09236d9f46-+-labstore: fix ferm

370bc37b00-+-labstore: finish setting up the firewall on the old primary cluster

c9f625d66f-+-labstore: introduce a firewall for the old primary NFS cluster

0bd5aed776-+-thumbor: remove nginx code leftovers

8288e8dbd7-+-toolforge: add prometheus exporter for elasticsearch

5b206c0391-+-profile::analytics::search::airflow: fix group require

df5127d269-+-toolforge: upgrade elasticsearch and add debian buster support

0277498816-+-Enable CAS endpoint for Kibana

a988dc231c-+-role::parsoid: base it on role::mediawiki::common

de77c41d82-+-role::mediawiki::common: install envoy as a forward proxy everywhere.

be5b572e2e-+-lvs: Decomm lvs2003

da0a48cf45-+-lvs: Decomm lvs2006

c2af89ab2e-+-Re-enable CAS authentication after enabling CASValidateSAML

80f77eff66-+-Enable CASValidateSAML for tendril

7b788f3140-+-icinga: Fix disc_desired_state mode

251f9693dd-+-configmaster: Add DNS Discovery discrepancy check

61d4e753b3-+-airflow: Drop old airflow user/group statement

33bce800ff-+-Openstack: add apt definitions for version 'queens'

1ebe1b2a3b-+-nfsfix: unbreak stretch (and likely jessie) nfs clients

ce0c97e197-+-add mw2291 through mw2300 as API appservers

68c4e5fd71-+-cloudstore: fix the scratch mount on clients

41611887d6-+-cloudstore: remove dependency on bind mounts

50c0e87cfd-+-profile::tlsproxy::envoy: add support for acme certs

06232e4f3d-+-profile::tlsproxy::envoy: add custom SNI type

c334885abd-+-profile::tlsproxy::envoy: add type checking and defaults

cf4db1af98-+-Add profile::base::no_firewall

be7bf69ef7-+-spicerack: add http_proxy to config file

684059e393-+-reprepo: remove user and group as they are create by the admin module

d441a45184-+-admin: add support for system users and groups

da897f3314-+-add codfw appservers in racks A3 and A6 as spares

fd8b16872b-+-site: add mw2366-mw2376 with spare role

adb1511613-+-neutron.conf: remove/update some deprecated settings

f723fb0607-+-nova: use memcache for keystone_authtoken cache

bd5dac4dba-+-Keystone: cache with a memached pool running on each controller

01b551fe79-+-Openstack control nodes: add a local memcached instance

2fa6f1cc54-+-icinga: add contact group to base host prometheus checks

67b5648d51-+-mediawiki: stream apache logs to logstash

5e19502062-+-role::statistics::private: remove rsync to /mnt/hdfs

3ea812c2b8-+-reportupdate::job: use kerberos when needed

9ac14e3e13-+-puppetboard: log to logging pipeline

21aaf680ee-+-debmonitor: log to logging pipeline

f43035f6c0-+-microsite::people: add cas configueration

4f97cf7933-+-lvs: Set up lvs2009 as a low-traffic LVS

428204d15f-+-tendril: disable cas and enable ldap

abb256a357-+-netbox: log to logging pipeline

92dc3c2877-+-lvs: Set BGP peers for lvs2010

69361fe9d8-+-logstash: write kafka inputs to es by default

f7c7989564-+-lvs: Set lvs2010 as a secondary LVS

34efb3cf2d-+-pybal: Allow overriding BGP med

0fc1ae1308-+-Add specific settings for libcrypto in Hadoop Test

f42f0466ae-+-Enable CAS authentication for tendril/dbmonitor

5e8e6a66d2-+-swift: optimize ferm rules

e7f160da5c-+-Update wm-bot hostname

e680adc1ab-+-httpbb: Tiny script to work around import path issues.

a75f43bbb8-+-aptrepo: add support for buster, install python-apt package

9fc60fe5a0-+-site: add apt[12]001.wikimedia.org with role::apt_repo

8b1633b1ad-+-airflow: mysql replica credentials must be owned by service_group

b9d7541afb-+-airflow: Deploy data necessary to connect to analytics sql replicas

115d56dfc7-+-httpbb: Update symlink target, following https://gerrit.wikimedia.org/r/574066.

b5b3a1e1c4-+-ganeti: Remove makevm.sh

d67d786151-+-prod_sites: Apache configuration for gr.wikimedia.org

e97678a079-+-delete role::repositoryserver, duplicate of role::apt_repo

9986455a37-+-role::analytics_cluster::launcher: add hdfs RU jobs

5d9fb5bfc6-+-services_proxy::envoy: avoid duplicate declarations

e484ab847a-+-ganeti: absent to the makevm script

6ff7fdccbf-+-profile::services_proxy: envoy-based version

3c8a7b01c6-+-ripe atlas alerts: allow more ipv6 failures

f203ca7fd1-+-wmfkeystonehooks: make region-aware

5ad6a8ffbb-+-profile::dns::auth::discovery: only add services in production state

a3966b805c-+-lvs::configuration: drop the lvs service hashes

659f6f9a9b-+-Revert "netbox: log to logging pipeline"

8d501aecbd-+-role::elasticsearch::cloudelastic: use profile::lvs::realserver

8c1d8d1f0f-+-netbox: log to logging pipeline

3ee65c815a-+-cloud: codfw1dev: fix instance flat range

3ee68f1c0d-+-Add CAS authentication to tendril

15dd85fd6d-+-Remove support for < Buster from Phabricator class

f31830804b-+-prometheus: use class logstash for jmx_logstash job

a70c9572d6-+-service: fix uwsgi logstash_port_logback

05c34edbfd-+-role::analytics_cluster::launcher: add git proxy config for Analytics vlan

0ddf8cc49e-+-role::analytics_cluster::launcher: add Analytics Refinery scap repo

448dc93843-+-role::analytics_cluster::launcher: set hive-site.xml in HDFS

a5de7e30b0-+-site: add apt1001/apt2001 with spare role

bc4dc99847-+-aptrepo/install: move https monitoring to aptrepo profile

9017125187-+-installserver: allow for multiple failover servers at once

499f024065-+-role::analytics_cluster::launcher: add kerberos and base profiles

8faa51fb1e-+-role::lists ensure apache mod_cgi enabled

ac14c608d2-+-Add a new Analytics role to an-launcher1001

eb80f71c11-+-Introduce an-launcher1001

33f73771c8-+-Add configuration for a flowspec controller

82f25be458-+-Remove system role from role::swift::stats_reporter

06b2e67df7-+-Add a separate class parameter to toggle the auth Icinga check for tendril

1fc5af7426-+-Add system::role for k8s staging roles

d9f832c19d-+-otrs: Remove mod_remoteip

28fb052579-+-profile::lvs: use wmflib::fetch

2a0b5fc06e-+-mariadb: Productionize es1025

3719ae8387-+-role::noc::site: refactor role/profile, stop duplicate include

daad47de78-+-site: add mw2317-24 in rack A3 as API appservers

aeef34786d-+-tendril: change Icinga monitoring from HTTP to HTTPS

e0fe8a20f1-+-Refactor statistics mountpoints to be included in all stat roles

b76d65b05f-+-assigin lists1001 role::lists

5725c054fe-+-refinery data purge - fix command checksums on refine event drop jobs

9138ee7242-+-systemd: Support multiple intervals on job::timer

3ef111dba9-+-mariadb: Productionize es1024

99aca2ab83-+-Add system::role for role::logging::webrequest::ops

29dceb5935-+-turn snapshot1010 into an xml dumps testbed

51ea79138e-+-mariadb: Productionize es1023

b84fa1752c-+-mariadb: Productionize es1022

ee00a6f97f-+-mariadb: Productionize es1021

b39921574d-+-profile::microsites::static_rt: disable the rsync service

2fd87413ba-+-site/conftooldata: add more new eqiad MW API appservers

6725361a24-+-site: Assign mw13[64-73,84] as mediawiki::appserver.

6cf1941c7c-+-site: add 7 new codfw appservers in rack B3 with mw role

f65b0fff6d-+-site: add new codfw mw appservers with spare role

4b655a4225-+-site: Assign mw13[56-62] as mediawiki::appserver::api.

652d61928e-+-noc: change Icinga monitoring from HTTP to HTTPS

06356e0a9c-+-microsites: change Icinga monitoring from HTTP to HTTPS

38e324ca8a-+-peopleweb: change Icinga monitoring from HTTP to HTTPS

b791c787b9-+-toolschecker: check node ready status on new k8s cluster

bfb29fd765-+-Remove Hadoop Pig from puppet codebase

24c5ffd5aa-+-prometheus: add cadvisor jobs

3ecdd37ec5-+-mariadb: Productionize es1020

89cd9668e2-+-profile::cache::base: remove the useless inclusion of lvs::configuration

2fecd837ba-+-Unify stat1004's and stat1005's roles into one

bf9f7896f5-+-Add new LVS services for new eventgate-main and eventgate-analytics ports

6cb8ec20a6-+-dns::auth::discovery: ensure unique identifiers

6740351354-+-librenms: librenms and puppet managing files with different permissions

8af9538899-+-cache: add cadvisor exporter

3f5dbd6f05-+-profile::prometheus::ops: ensure rsync service is stopped

08da788f4e-+-prometheus: add cadvisor_exporter module and profile

8c59e4b14d-+-swift::swiftrepl: force directory removal if resource absent

acf148e440-+-Remove system::role from role::swift::swiftrepl

e46e259623-+-ores::base: myspell-nl is provided by hunspell-nl in buster

df36d2dac7-+-restrouter: Remove restrouter LVS icinga config

a7ac387a75-+-icinga: remove wmflabs.org HTTPS cert check

74c0c9696f-+-profile::hive::site_hdfs: fix exec using bash -c to execute commands

babf2957e5-+-Add system::role for role::kubernetes::worker and role::kubernetes::master

1cf3061f38-+-query_service::common: ensure we dont run exec on every run

b35d6dca8c-+-envoy: split base profile out of tlsproxy

20bdb22d01-+-dbproxy1007: Decommission

39205445c7-+-Add script to track OS migrations status

de303effc2-+-Analytics refine: blacklist MobileWebMainMenuClickTracking

bdb8156512-+-releases: change Icinga monitoring from HTTP to HTTPS

b16a1dec57-+-assign mw1350 through mw1355 as MediaWiki appservers

200a699f08-+-netbox: Update configuration to support v2.7

db402f4954-+-site: Assign mw1349 as mediawiki::appserver

e8a15d5f24-+-site: Fix racking comments for MW hosts to match what's in netbox

d403290857-+-add new eqiad mw appservers with spare role

3c977fea6f-+-logstash::collector7 ingest deprecated logs from kafka

44116b934f-+-profile::puppetdb::database: add ability to override replication alert threshold

953abca566-+-logstash: remove defalut value from kafka input type field

292a73ab6e-+-Add system::role for role::configcluster

fe552e163b-+-Add system::role for role::graphite::production

0416f7fc02-+-Add system::role for role::deployment_server

c0fec4239f-+-Revert "LVS: add alert on CPU saturation, which causes pkt drops"

babe6e8a4a-+-lvs-cpu-saturation: fix prom query mis-quoting

14cb6087cc-+-LVS: add alert on CPU saturation, which causes pkt drops

2a00d10fb5-+-Add system::role for role::backup::offsite

3352b07105-+-logstash: output logs ingested by deprecated inputs to kafka-logging

7c3e2f2b82-+-tlsproxy: remove lua_support

e198e1e854-+-cache: consolidate common text/upload hiera

98b297c127-+-Designate: start using '.eqiad1.wikimedia.cloud' domain in eqiad1

17f93ce52f-+-profile::prometheus::ops_mysql: change exec to a system timer

56992b05da-+-openstack::clientpackages::mitaka::buster: change notice to warning

4b0981fa6b-+-profile::ci::docker: manage all group membership in data module

ada7b75f6d-+-profile::ganeti: update the permissions of the users file

fedaa1d748-+-profile::ganeti: update the permissions of the users file

2a142f7cf7-+-Support /entity/ and other Wikidata URLs for Commons

bc8574c53d-+-dbproxy1002: Decommission this host.

5852d35d72-+-elasticsearch::packages: Switch to apt::package_from_component

9c265170b4-+-acme_chief::server: change exec job to a systemd timer

e1696c0aa1-+-tlsproxy::localssl: change duplicate definition detection

4a38750202-+-Misc work to make puppet run in codfw1dev again following Icad66f70

fe4e393bbe-+-Switch component-pyall to apt::package_from_component

e34e1d9c41-+-profile::lvs::realserver: use wmflib::service::fetch

3be3976120-+-profile::configmaster: use wmflib::service functions

496da4b903-+-discoverydns: integrate into servicecatalog

3d65948938-+-ATS: Disable DNS resolution on ats-tls

e7b256f089-+-keystone fernet key rotation: delete files during rsync

3f76452dd1-+-icinga: add cloudvps ceph alerts

2b66bc73ed-+-osm::planet_sync:hours is a list of ints, not of strings

c44d6f4809-+-Fix a few invocations of osm::planet_sync

a93438a173-+-puppetmaster: notify apache2 when the hiera.yaml file is updated

88980e2a19-+-Add new role to irc2001.wikimedia.org

45e5f941ea-+-apt: finally remove absented apt2xml file

a0d215f23b-+-apt: remove unused package_updates custom fact

ab2d7f2079-+-Double escape \\\\w to get \w via puppet -> systemd -> shell in hadoop purge job

db3d73e6f2-+-Drop all raw event data and specific PII event data after 90 days

823525583e-+-prometheus: remove nginx jobs

d1f7442865-+-netbox report alerts: Remove trailing full-stop

645f166fcb-+-Remove unused absented avro hadoop deletion jobs

5cc53183de-+-ATS: Puppetize allow_half_open HTTP setting

24aa80a981-+-Ensure absent no longer needed mediawiki Avro data Hadoop purge jobs

00095675a1-+-varnish::instance: remove 'layer'

c580fa9996-+-vcl: simplify backend listing

ea7c7035e3-+-vcl: merge wikimedia-common into wikimedia-frontend

a0f79578ef-+-introduce new role to install nginx and APT repo without DHCP/TFTP

082a649c18-+-profile::mediawiki::php: allow varying the slowlog limit

7c97413cfc-+-prometheus: bump snmp scrape timeout

c7e44a3ef2-+-Configure forensic logging of Apache requests; enable on beta

003f5a6e27-+-puppet_compiler: bump the version

1c7f50a4fb-+-ATS: Don't assume that http_settings is mandatory on ats-tls profile

b6623f4019-+-Introduce irc2001.wikimedia.org

a2a5c17842-+-site.pp: Productionize dbproxy1015

578e8b34f0-+-profile::analytics::refinery::job::data_purge: add kerberos support

9c1efdfbab-+-site.pp: Remove dbproxy1001 puppet references

ffaed5a650-+-dynamicproxy: set kubernetes variables to optional

4378f18f22-+-openstack: add script to manage instance extra specs

9aa4b2eafc-+-gerrit: make db_pass configurable from (private) Hiera

60f87f13a4-+-gerrit: for db_user, remove default and replace hiera() with lookup()

7866320a28-+-adding monitoring for eqsin pdus

aba8b8db6d-+-profile::graphite::production: add idp::client

39141167f0-+-Global aggregation for authdns stats, round 2

22c1467175-+-Symlink wikistats v2 at stats.wikimedia.org/index.html

9f55ac693c-+-Remove absented rsyncd module for stats.wm.org

e0da161490-+-realm: use correct syntax for split

929de70711-+-realm: puppet 4.8 dosn't support any so update

8c058b0ab3-+-realm: don't check for Stdlib::Fqdn as .wmflabs is not a valid domain

88c11f500b-+-realm global: make the realm variable a global in labs

9ee6aa31c4-+-Global aggregation for authdns stats

31d157c1a9-+-ATS: Avoid hardcoding Connection: Close on ats-tls when keepalive is ON

e9b28f7d36-+-dbproxy1001: Set it to spare

3bf47dc05c-+-installserver: create new role without HTTP/APT, rename existing role

23d2dfb2a6-+-site: define 2 more canary appservers in codfw

99e463db0c-+-fastnetmon NRPE: page on FNM alerts & tweak name

4c2857c662-+-profile::mediawiki::monitor_versions: fix path, cli option

f80742d36d-+-grafana: setup sync grafana1002/grafana2001

fbdf681ff9-+-cassandra: move single_instance to logging pipeline

543413df61-+-mediawiki: Correct pathing issues for version monitoring script

e00e1c659c-+-mediawiki: check mw versions match those on the deploy server

762b77e689-+-cassandra: default to sending logs to logging pipeline

94a71e3673-+-puppet_compiler: update the puppet master --compile command to support pson

24a28a5c0b-+-swift: add compat symlink /var/log/swift

382573033a-+-profile::presto::client: deploy ca public crt to client nodes

1f8c823057-+-profile::analytics::refinery::job::import_wikidata_entities_dumps: cleanup

699711a189-+-profile::analytics::refinery::job::import_wikidata_entities_dumps: fix typo

a750ed4652-+-profile::analytics::cluster::packages::common: add libkrb5-dev

d2b0634fb7-+-profile::swap: add the option to skip nfs dumps mountpoints

f5db2d6d7f-+-Add profile::analytics::refinery::job::import_wikidata_entites_dumps

571274ee3c-+-site: add new install servers with private IP, spare role

b1e6815a4f-+-ceph: configure osd cluster network on boot

953736c636-+-ceph: configure jumbo frames on OSD interfaces

46222875e1-+-presto: fix client settings for stat/notebook hosts

800503d6c4-+-Add grafana2001

12d880423e-+-profile::presto::client: set file ownership to root:root

5fc55c29d1-+-Add presto client to stat and notebook hosts

d8a1f5882f-+-keystone key sync: update rsync remote path

e32c836174-+-presto: refactor TLS passwords parameter to be more sharable

855d5e30af-+-realm.pp: Add watchlist_expiry to private tables

20a49aa480-+-ldap: fix python path

eaecb2e11a-+-ldap:  fix case statment

618865b16e-+-ldap - idp:  add ldap helper script for enabling u2f on cas

7cec137fe0-+-cassandra: restbase-dev logs to logging pipeline

1287625115-+-site: define 2 codfw appservers as canary_appservers

58b99670cd-+-fastnetmon: connect to Icinga via NRPE

50a08cb406-+-Keystone: rotate and sync fernet tokens

1d04a05b40-+-profile::cdh::apt: add bigtop repository

38a917a413-+-pybal to both routers for eqiad

14d2132ef4-+-pybal to both routers for codfw primary

da3eb15078-+-sslcert: ensure we run update-ca-certificates managing any services

0b93f2eb32-+-pybal to both routers for ulsfo

8befd3da83-+-pybal to both routers for eqsin

749b468a14-+-openstack: switch cloudvirt101[56] to ceph storage

584d86ceb5-+-profile::mediawiki::webserver: increase canary keepalive_requests

32ed08c7cc-+-site.pp: Add new ganeti codfw hosts as role::spare

4c64a0c7ae-+-ATS: Allow configuring via hiera server session sharing settings

d36e38bd79-+-tlsproxy::localssl: allow setting keepalive_requests

b3b037df84-+-standard: Add linux-perf to standard packages

db1eba090d-+-site: add new ganeti hosts for refresh/expansion with spare role

216b1b29e7-+-ATS: Allow configuring via hiera KA against origin servers

a89750e670-+-uwsgi: fix removal of init.d script (revisited)

9bc3f003b5-+-profile::presto::server: use FQDN when workers communicate with the coord

495a330469-+-uwsgi: fix removal of init.d links on buster

62971457ed-+-profile::presto::server: use kerberos auth between worker nodes

c04041b1cd-+-uwsgi: update check for buster

dc04a51a42-+-mariadb: Productionize dbproxy1012

895d80017a-+-wmcs::toolsdb_secondary: fix a comment about what this class does

7b772fb1a7-+-Remove initial attempt at libraryupgrader puppetization

44e04ce321-+-define 2 API appservers per row in codfw as canary API appservers

b53e3ac99d-+-librenms API scrape alert: make critical & change name

a983a7e664-+-Temporarily allow hadoop test cluster workers to talk to JupyterHub on analytics1030

8231532e7a-+-profile::memcached::instance: add the theads parameter

9a1ba7526a-+-presto: add kerberos and tls support

d864b21bac-+-Revert "cassandra: use wmflib::secret for binary files"

e3261bd509-+-cassandra: use wmflib::secret for binary files

8c25ecf41f-+-mcrouter: run at nice -19 as php-fpm

16d6dfcc27-+-Explicitly add theemin to site.pp

98bf72a456-+-Buster/Mitaka vms: include python3 versions of openstack clients

5a7b84007d-+-lvs::monitor: use unique identifiers for services

c41ed7f53e-+-acme_chief: Hit auth dns servers on port 5353

7f9ef2ac5e-+-lvs::monitor: fix most technical debt

8d31411843-+-swift: move logs to /srv/log

18fd80da83-+-Enable base::service_auto_restart for nfacctd

fe2818218c-+-Add Icinga check for SMTP on Phabricator

07197dbe48-+-doc: stop using wikidev group, use doc-uploader group

6e270f00b4-+-doc: use doc-uploader group for docroot privs, stop using shared=>true

5aacb5ac63-+-varnish: switch logs from syslog to logging pipeline

0450a65696-+-cache: collect varnish fd count everywhere

7ecb96069d-+-Set Spark2 encryption options as default for Hadoop

237b1ab728-+-Scrape perception survey alerts from Grafana

96291c8e5f-+-profile::analytics::cluster::packages::common: add libcrypto.so link

118d82826a-+-ulsfo cp-text: Prometheus export # of vcache fds

b9ef3e8e4a-+-Buster vms: include python3 versions of openstack clients

cf0cf0d3b8-+-codesearch: Restart hound_proxy if port configuration changes

d42eb5262c-+-prometheus: wmcs_scripts: drop package requirements

0616c9c6f5-+-prometheus: wmcs_scripts: refresh package requirements

8a1ea5f35e-+-CloudVPS: set domain for VM instances using nova-api metadata

76207e5000-+-Add role to mc-gp100[1-3]

57a015660c-+-openstack: puppet: encapi: not declare python-yaml

520d5a150e-+-cloudstore test: add the last couple ferm rules to let drbd work

ba320ad291-+-Icinga alert for LibreNMS critical alerts

39175c15ea-+-labstore: finish up making this class work on VMs

0e5fc5f052-+-labstore: remove profile from top-level module

0d359cab6d-+-nfs: fixup the test class to work on VMs a bit more

0629ad2fdc-+-wmcs: instance: introduce per-deployment openstack profiles

fdbd2cf66a-+-toolforge: elasticsearch: nginx: fix dependency cycle

eaffeec49f-+-site: remove etherpad1001

9e60edc94e-+-toolforge: refactor elastic role/profile into modern layout

cb4b6cf4af-+-realm: introduce global variable $wmcs_deployment

f984f4ec46-+-site: add etherpad role to etherpad1002

57ef6a17f0-+-nfs: fix the test profile up to work better with an instance

429cea334d-+-nfs: puppetize a cloud-vps nfs testbed

6c97e7d70b-+-lvs,ATS: Switch from nginx to ats-tls service name on text & upload

746ae232b6-+-cache: remove unused parameter 'varnish_version'

d103dc71c6-+-cache: move fe_runtime_params out of varnish::common

9a05b2e81f-+-cache: remove be_runtime_params

6b01639295-+-cache: remove 'inst' VCL template variable

dd15e22b45-+-ATS: Move to a hiera parameter the ats-tls conftool service name

df4aa4b577-+-prometheus: Clean up varnish-backend cluster config

3895d60f97-+-cache: remove unused parameter 'cache_route'

57d5aecef7-+-cache: remove app_directors and app_def_be_opts

80f446722a-+-prometheus: Remove varnish-backend cluster config

0f9873e33a-+-mirrors: fix openstack rsync command

d9e6560993-+-Remove tor relay profile/role

3d8c849577-+-mariadb: Productionize es2025 as es5 codfw slave

4e83f3983d-+-profile::mediawiki::php: remove useless inclusion of lvs::configuration

597509c420-+-site: add etherpad1002 with role::spare::system

cacb5ad2b7-+-ci::docker: add same docker version also for buster

e7d71f95eb-+-codesearch: Use iptables from buster-backports for docker compatibility

3d16ce5441-+-ci::proxy_jenkins: add data types

e8839d2bb7-+-ci::httpd: add support for buster PHP 7.3

77b086c350-+-prometheus: Clean nginx cache cluster config

656857d90c-+-prometheus: Remove nginx cache jobs

20cd9ec06c-+-cache: Remove nginx from text and upload clusters

ec5f6bf25f-+-varnish: Set buster python version

2acf9d5aa4-+-cache: remove 'enable_geoiplookup' from vcl_config

93692ab212-+-mirrors: mirror Debian openstack backports repositories

65f69a99f7-+-role::puppetmaster::standalone: support multiple puppetdb servers

eb839faee2-+-role::prometheus::beta: add mcrouter metrics

a03f908a2f-+-Remove Puppet references to torrelay1001

da1f7d78bb-+-toolforge: toolviews: don't run it if not in the tools CloudVPS project

80e1e05e33-+-toolforge: migrate toolviews puppet code to the toolforge namespace

836585af83-+-cache: icinga check for high varnishd_mmap_count

c3cac31ceb-+-ATS: Trigger update-ocsp-all iff non acme-chief certs are deployed

720042b14e-+-mariadb: Productionize es2024 as es5 codfw slave

e5b514b351-+-Switch role for torrelay1001 to spare

164729e86f-+-mariadb: Productionize es2023 as es5 codfw master

15d724f9ee-+-profile::mediawiki::webserver: use service catalog directly

bfaece7629-+-openstack: Create codfw1dev puppetmaster frontend_vm role to mirror eqiad1

f2c31e54d3-+-dumps-distribution: the nfs export for dumps has changed

8edff73a35-+-gerrit: allow multiple rsync destination hosts in migration class

e05909ed96-+-ferm_misc/db: allow connections from gerrit1002 in ferm

cf37610463-+-gerrit: assign host gerrit1002 role::gerrit

f3c0d9b24f-+-switch filtertags labs-project-phabricator to labs-project-devtools

ef9ba4b81b-+-Remove references to labstore2001 and labstore2002

f27c076933-+-Remove references to labstore2003/2004

0fec1b2311-+-labstore2003/2004: change to role(spare::system)

fbe3d6333a-+-dumps-distribution: switch to sharing out only the pertinent dir on nfs

a220f3721c-+-scap::source: use wmflib::service::fetch

8351dcea8a-+-mediawiki::php::restarts: count nodes only once

4cd19d2a23-+-CloudVPS: codfw1dev: Fix default SSH rule to use correct range

8b3d41531e-+-wmflib::service: add get_pool_nodes function

1502ca0db5-+-ripeatlas alerts: link to the grafana dashboard too

e295c4bea0-+-netconsole: add server to esams ganeti

73c5619b08-+-netconsole: add netconsole::server

199ec6f5df-+-netconsole:: rename to netconsole::client

8c3e980510-+-thumbor: ship logs to localhost / logging pipeline

103d860886-+-dnsrecursor: Remove support for jessie

6c188bcd92-+-mariadb: Move es2022 from spare to es4 slave

bffde3f418-+-cache::varnish::frontend: fix for no-lvs case

1e2c4e5be5-+-profile::netconsole: use ipaddress and interface_primary

899d26f6b5-+-puppetmaster: install cassandra-ca-manager

af6cb406b4-+-puppetmaster: ensure puppetmaster[12]002 have the puppetmaster::backend role

ea72214cf8-+-cache: configure netconsole on cp3061

8bb3eefaf8-+-puppetmatser: add new puppetmaster2003

720931a264-+-etcd: enable ssl validation

26be4b1017-+-profile::url_downloader: Remove support for jessie

1e58dfb172-+-Remove actinium|alcyone|alsafi|aluminium

453d901bab-+-role::cloudelastic: fix the deep reference to lvs::configuration

c64652f08f-+-Revert "etcd: enable ssl validation"

0647beb1d1-+-etcd: enable ssl validation

b46f1300ab-+-ATS: Deploy wikiworkshop TLS certificate

b8b353a305-+-wmflib: Introduce a more usable data structure to describe services.

a63d794220-+-conftool::safe_service_restarts: better support for non lvs servers

1c3d392abb-+-Revert "Deploy Apache BigTop's apt repository on analytics1031"

e4cb709a8b-+-mariadb: Move es2021 from spare to es4 slave

fe4491bbdd-+-phabricator: make deploy_user configurable and change it in cloud

b94b3418df-+-assign kafka-main200[45] to role::spare::system

e659aff916-+-jenkins: Switch to apt::package_from_component

bf289f66a1-+-codesearch: Work around bootstrapping problems

f183f59fd8-+-codesearch: Open up port 3002

dad4499867-+-maps: increase warning limit on postgres replication check

eb98e1467d-+-mwopenstackclients: add python3 version

f047f77f5e-+-Clean labstore fetcher after hdfs-rsync move

b5900e414c-+-librenms: Switch to apt::package_from_component

9ecb1ae30a-+-smokeping: Serve traffic directly and using TLS

6a353223b8-+-prometheus: node_local_crontab: fix sudo permissions

d02e51f67f-+-Fix the name of the logrotate config file for Squid 4

41e0f673eb-+-Enable Kerberos for Analytics Refine Spark jobs on the Hadoop coords

e453847f29-+-Convert labstore stats fetcher left to hdfs-rsync

a432ce34cc-+-toolforge: Monitor local crontabs with Prometheus

07530a41ff-+-Consistently capitalize MediaWiki properly

23be56e8c8-+-profile::hadoop::backup::namenode: reduce the fsimage retention to 20 days

756992cd50-+-Fix role name

ea765fcc4e-+-mariadb: Move es2020 from spare to core

fb58b65f7c-+-wmcs-dns-floating-ip-updater.py: retry if we encounter an exception

3b0b32d07f-+-site: replace gerrit-test with gerrit1002

90b2f249c2-+-codesearch: Generate hound-${name} systemd units

4b17e06fe5-+-codesearch: Migrate ./write_config.py cron job to systemd timer

90bfce564b-+-Create separate role for repository servers

8965881523-+-profile::aptrepo::wikimedia: Use types for arguments

8d628f754c-+-grafana1001 to spare in prep for decom

5a0d65e433-+-ncredir: Remove TLSv1.0 && TLSv1.1 support

46e42d6502-+-Add restbase2[123] to restbase::production

b85201b9be-+-Add mediacount fetch using hdfs-rsync on labstore

9c4e3de39d-+-Deploy Apache BigTop's apt repository on analytics1031

20afd60bc0-+-Remove etcd100[456]

d884514988-+-dumps::web::fetches::stats: add another $$ to the rsync command

aa8c27f594-+-Correct labstore hdfs-rsync

79790adc6c-+-Correct labstore hdfs-rsync

f1c1d7bfd2-+-Add mediawiki-history-dumps rsync to labstore

d853a45e5c-+-prometheus: bump 'ops' retention to 4.5 months

65b940c1dc-+-site.pp: Add two comments

084d71a9c9-+-labs prometheus: convert apache config to template

3f8b0d9831-+-labs prometheus: only bind localhost and update vhost config

3ce35f5213-+-assign puppetmaster2003 role::spare::system

de532c0052-+-netbox: fix user passwords (take 2)

d346baebe1-+-netbox: fix user passwords

b046e78328-+-wikiworkshop: define internal microsite setup

c6c8d569f3-+-Switch Thumbor to apt::package_from_component

d84de3df5c-+-prometheus: bump 'global' retention to 2.25 years

68ac75dafe-+-install_server,ncredir: Install ncredir500[12]

784c775f18-+-cache: add systemd config to profile::cache::base

ed2a553f97-+-systemd: allow setting global accounting options

56cf9ee766-+-ATS: Re-enable DNS resolution for ats-tls

521db12c01-+-cache: add CAP_KILL to varnish-frontend capabilities

12d29f3d9a-+-Add ping3001 to site.pp, DHCP and netboot

92c175c7ce-+-prometheus: collect varnishd_mmap_count for varnish-frontend

144f8bdf22-+-aqs: replace logstash host/port with rsyslog localhost/port

01502d0b42-+-ores: ship to logstash via the kafka logging pipeline

8a9d73602e-+-codesearch: Use full path to git in exec commands

71c4f66dbf-+-codesearch: Alias production branch to master in /srv/puppet

ec7f3a1a0f-+-installserver: Convert tftp/dhcp ferm rules to ferm services

e2ff86744a-+-codesearch: Ensure /srv/hound is writable by codesearch user

8ffcb65b32-+-Add ng.wikimedia.org as chapter site

a512f05b19-+-mariadb: Place db1107 in s1

cc5c177b94-+-mx: increase exim queue check monitoring threshold

19c44fa2c1-+-gridengine: set the webgrid queues to not rerunable

6c45dfd6a8-+-Set up transparency-archive microsite

2a9ff900fe-+-nova-compute monitoring: support multiple python versions

6fdc3287a3-+-openstack: neutron l3 agent: pike: fix radvd mask

4b5e883f8d-+-openstack: neutron l3 agent: pike: disable ravd

36dce6de46-+-cache: raise vm.max_map_count sysctl

8deb0106cd-+-profile::puppet_compiler fix call to conftool

6c7ac70559-+-haproxy for neutron:  As of pike, the healthcheck url returns 405.

80f7fb2d23-+-nova monitoring: allow for different python versions in service

35420f7039-+-puppet-compiler: fix double owner definition

c14a923e98-+-Remove debug proxy roles/classes

8c22f5a45a-+-designate monitoring: allow for different python versions in service monitoring

5cd119a3bd-+-designate: include designate-mdns package

a83f55682f-+-codesearch: fix parameters of apt::package_from:component

6b9d61fd99-+-codesearch: Install docker-ce from thirdparty/kubeadm-k8s component

23f4fab5f4-+-microsites: replace hiera() with lookup()

f9cbd1a861-+-releases: replace hiera() with lookup()

e723421b9d-+-gerrit: Switch to apt::package_from_component

ae93a7b729-+-tor: switch to apt::package_from_component

afe2331d0d-+-site: remove hassaleh and hassium

a39572cda7-+-install_server,ncredir: Install ncredir400[12]

3ebd9a929a-+-Revert "openstack: change cloudvirt1022 to ceph based virt role"

5c5f878915-+-statistics::site::stats: create symlink only when dir is ready

24523bbf66-+-toolforge: new k8s: prometheus: scrape metrics from each individual ingress pod

9a75654687-+-Set up dumps for mediainfo RDF generation

499a136788-+-Add role to mc-gp200[1-3]

f0ab76949b-+-role::memcached: move base::mysterious_sysctl into the perf profile

dad7ae862f-+-role::memcached: move interface::rps settings to dedicated profile

7e88027b76-+-codesearch: fix dependency cycle with git::clone

76dbe56e4f-+-codesearch: fix dependency cycle over clone directories

f9f40fb971-+-codesearch: fix typo in user groups attribute

c7d263b674-+-codesearch: create system group, fix system user membership

19f58e69db-+-Initial puppetization of codesearch

b018375162-+-aptrepo: replace hiera() with lookup()

c8f058b5ee-+-smokeping: replace hiera() with lookup()

afb69825e2-+-planet: replace hiera() with lookup()

4ac1fff315-+-docker-report: remove failing images, fix logging

e7a0507b80-+-Fix condition for conditional application of apt::pin

ec3964fc3c-+-apt:::pin: allow callers to override the notify resource

65d8f82e52-+-oozie: add spark conf directory in oozie-site.xml

1cefe18fac-+-spicerack: Switch to apt::package_from_component

e342c332f9-+-Switch cergen to apt::package_from_component

06abb84939-+-etcd: add parameter type checking and clean up

135a6bc256-+-lvs, monitoring: prometheus expects params value as string[] type

684cbaedbb-+-site: remove phab1003, decom

7d89851c6a-+-Revert "monitoring, profile, prometheus: bugfix, prometheus params values"

d25aa29dbd-+-monitoring, profile, prometheus: bugfix, prometheus params values

26f60689dc-+-Revert "apt:::pin: allow callers to override the notify resource"

2df48795ba-+-gerrit: make db_user configurable in Hiera

a353071ce4-+-lvs, monitoring, prometheus: bugfix openapi exports

6dc32560a6-+-lvs, prometheus, profile: add blackbox job helper and enable openapi scrapes

b685ed2f93-+-grafana: Switch to apt::package_from_component

1054357c9d-+-ceph: add wmcs prometheus scrape config

a995f71b42-+-install_server,ncredir: Install ncredir3[00]12

d901923c34-+-varnish: fix varnish_mgt_child_start prometheus query

051a917504-+-varnish: raise severity of child restart to critical

232293aec0-+-amd_rocm: Switch to apt::package_from_component

b9da0003d8-+-Don't install the Postgres contrib package on Buster

b760553861-+-Apply url downloader role to new hosts

6967a5cd3a-+-apt:::pin: allow callers to override the notify resource

5eced529f3-+-gerrit: make scap user configurable in Hiera

6bf6658aea-+-gerrit: adjust bacula backup behaviour to deal with multiple hosts

cce3c31fe3-+-mediawiki::php: allow setting PHP version to 7.3 for buster

ecc43a843f-+-Revert "ATS: assign 8G instead of 2G to RAM caches on ats-be"

e079d62bc0-+-airflow: Provide wrapper script to invoke airflow

6d8e4b94b2-+-toolforge: prometheus: fix regex for cadvisor in the new k8s cluster

d841dbd666-+-Switch eventgate-main LVS to use TLS port 4292

ce51042c38-+-wdqs: enable async_imports by default

591b0f6fc2-+-toolforge: new k8s: fix metrics directory

c44baf3804-+-toolforge: new k8s: cleanup metrics manifests and files

144dea4bac-+-Set up new LVS service eventgate-analytics-https

176ca30406-+-Initially assing spare role to gerrit-test.wikimedia.org

c9aa6b3b3b-+-url_downloader: Adapt auto restart for Buster

bdad33e2fb-+-confd nrpe: link to new docs section

4bd4683345-+-wmcs: stop the rpcbind service

93d5e58be6-+-gerrit::proxy: fix typo in "reploca_hosts"

dc1043b0af-+-ceph: add prometheus servers to ferm rules

8341154dab-+-Revert "ceph: update ferm for prometheus exporter"

2908058c70-+-ceph: update ferm for prometheus exporter

32a87b4155-+-Use https://schema.wikimedia.org for client side pretty-autoindex js

559bbb3b52-+-ceph: Update ceph role desc and lvs pool map

824a8b5007-+-Enable structured-data report

fab7ed55ce-+-mediawiki: Drop the rebuildItemTerms cron

22839c3521-+-lvs ceph: add cloudceph service and cluster

baeabc74cf-+-ganeti: assign ganeti500[123] role::ganeti

5361a6d3cd-+-Use https://schema.discovery.wmnet for refine mediawiki_events job

38ed639d14-+-profile::docker::reporter: periodically generate reports to debmonitor.

94da1f5c82-+-profile::ganeti switch from hiera() to lookup()

10a18eb33b-+-Readd conditional pinning

92f8cc9ad9-+-ganeti: apply ferm regardless of ganeti_cluster fact

81c8d5aa9a-+-toolforge: new k8s: move metrics-server and kube-state-metrics to new namespace

66874bd269-+-profile::analytics::client::limits: add cpu limits to Analytics clients

1f85c34357-+-apt::package_from_component: Switch to a per component apt-get exec

3800de9d14-+-varnishkafka: remove incorrect comment about X-Client-IP

ca563f5912-+-profile::hue: correct typo in kerberos parameters

3bc7dd531a-+-site: add new URL-downloaders as spare systems

f171531709-+-airflow: Share kerberos cache via /var/run

abb3b3ee9b-+-ganeti500* setup info

64aa8c57bb-+-cache: merge common_vcl_config into fe_vcl_config

ac0c92a396-+-cache: do not pick varnish-be as origins for varnish-fe

df14370a16-+-cache: remove varnish::logging::backend

9d37cdc89f-+-cache: remove varnish-backend-restart

b3ce6eab3d-+-cache: remove profile::cache::varnish::backend and cron_restart

fc5e4d909b-+-Pass the package list to the apt::pin

68d84a9a36-+-Remove conditional application of apt pin

1129636e4d-+-cache: make backend_services default to 'ats-be'

894e4b0d19-+-prometheus: re-add varnish-text_mtail jobs

dab7ed6b5f-+-cache: rename cache::text_ats role to cache::text

1fc65263a2-+-profile::mediawiki::videoscaler: Switch to apt::package_from_component

58346c4080-+-mediawiki: Stop rebuildItemTermIndex job

b7744938c6-+-Extend the docs for selecting packages to install from a component

afafd5225f-+-cache: hiera setting to apply performance tweaks

c4fb1ddcda-+-graphite::wmcs::archiver: move warnings to /dev/null

fb1e6e6e43-+-toolschecker: update k8s config reading

2e4c606359-+-toolforge: replace diamond redis monitoring with prometheus

02d9ced35d-+-phabricator: skip LVS-realserver setup in "labs"

b83446957c-+-toolforge-k8s: renamed files don't get changed

57284caf14-+-toolforge: prometheus: fix regexp for cadvisor discovery

fae8c810a4-+-apt::pin: manage the apt preferences directory and purge unmanaged resources

6e78b6d050-+-apt::package_from_component: Don't ping if already covered

394c1fccb1-+-toolforge: prometheus: fix label config for cadvisor metrics

0e14ebeaf4-+-toolforge: prometheus: collect metrics from cadvisor in the new k8s cluster

7028b22c18-+-toolforge: new k8s: deploy cadvisor.yaml

b96109688f-+-Add a define to install a package from a repository component

361861edcd-+-haproxy for neutron:  As of pike, the healthcheck url returns 405.

08d8ef8d48-+-site.pp: Add new external store hosts as spare

c00ea45a7e-+-neutron: update l3_agent_hacks for Pike

7713edb014-+-Enable envoyproxy tls for schema.svc

50c94fddc4-+-Clone new primary and secondary event schemas repos for eventschemas site

5825531180-+-xhgui: use ensure=>present instead of ensure=>latest

3c2ecdd30a-+-graphite::wmcs::archiver: add python-novaclient to list of deps

52f3e6c4b3-+-toolforge: new k8s: drop misleading comment

4682c3e34b-+-swift: Fix icinga+prometheus+grafana alert link (Dashboard not found)

0c8111d9e2-+-role::analytics_cluster::presto::server: add kerberos config

ecf5b2fcb4-+-mtail: port varnishbackendtiming to ATS

141c11a527-+-graphite::wmcs::archiver: fix more errors in archive-instances

d21097fbea-+-Revert "toolforge: replace diamond redis monitoring with prometheus"

00da38df87-+-toolforge: replace diamond redis monitoring with prometheus

56eb3ca813-+-openstack clientpackages: add manifests for openstack pike

7c83290637-+-neutron: add service manifests for openstack Pike

ad9bac292d-+-keystone: add service manifests for openstack Pike

cc7f544055-+-glance: add service manifest for openstack pike

3e781fc97a-+-nova: add service manifests for pike

8e6e1a80ed-+-nova: Remove manifest for the spiceproxy service

fa86124e1d-+-graphite::wmcs::archiver: fix daily cronspam

6c1a89c936-+-contint: downgrade docker on Stretch to match Jessie

37053241ef-+-nova: remove hotpatch of nova/api/manager.py

7713f8585b-+-extdist: Drop pre-stretch support

9ad7b11d1a-+-wdqs: use RecentChanges API for updates on all WDQS servers

7454b34d53-+-cloud-vps: use internal apt repo for pike packages

77873a5b71-+-aptrepo: actually install the update filter for openstack-pike-stretch

6a4ab3e6ed-+-Openstack Designate: add manifests for Openstack Pike

aa426f7054-+-openstack: don't show puppet diff in files which may contain passwords

0fc8d026ba-+-openstack nova: rename firstboot.sh to userdata.txt

f472fa68aa-+-maps: fix type constraints for OSM crons

1098e81c52-+-Change OSM replication to hourly

9c303daf74-+-ceph: allow lvs traffic to manager exporter

487aecb067-+-ceph: add support for dedicated cluster network

b38f31ff60-+-airflow: Enable kerberos configuration

81ac231f5c-+-Remove remaining Puppet refs of old jessie LDAP corp servers

86347c93e3-+-Openstack keystone (ocata/stretch): pull in python-ldap v3

503377a62e-+-toolforge: Move package 'fish' from shell_environ to exec_environ

0d59a820d6-+-netbox: Adjust permissions of Puppet-managed git files

5c431587cf-+-analytics::search::jobs.pp: Move last deletion timers to drop-older-than

f733c3986e-+-analytics::refinery::job::data_purge: Correct timer syntax

cadc0008ca-+-puppet-merge: ensure puppet is only run from one server

560c392d26-+-analytics::refinery::job::data_purge: Add timer to delete old MWH dumps

74325e2046-+-analytics::refinery::job::data_purge: Add growth deletion timers

834248489f-+-netbox: fix path for dns snippets repo

1e0824222a-+-netbox: create home directory for the user

cbedebece8-+-netbox: add dns.cfg configuration file

66c239a16f-+-netbox: fix path for file

8d0051060e-+-netbox: create also parent directory

eeeded150c-+-netbox: Add automation git machinery

662d25c96d-+-toolforge: prometheus: add job for kube-state-metrics

fc3ec14af4-+-package_builder: ensure title is dynamic

400ab72e25-+-package_builder: manage source repositories using apt::repository

e13c14c380-+-Fastnetmon: add thresholds overrides

f029ded6a6-+-toolforge: new k8s: add kube-state-metrics.yaml

8be495c7ac-+-site: turn phab1003 into a spare::system

80c3bba1a6-+-maps: Use correct puppet cron syntax

62f60155b3-+-maps: Increase replication frequency

0bd0319486-+-toolforge: Add CORS header to docker registry

166747806a-+-Add a comment on ganeti-instance-debootstrap

a0cc966c3b-+-Revert "ganeti: apply ferm regardless of ganeti_cluster fact"

4299425647-+-toolforge-k8s: add a script to grant "observer" access to a tool

c033bb6506-+-Remove all references to Wikimetrics

22552f5795-+-ganeti: apply ferm regardless of ganeti_cluster fact

10f1d94989-+-ganeti: ensure package ganeti-instance-debootstrap installed

95fcb029be-+-cloudvps: rename+reimage labmon1001 as cloudmetrics1001

cde06cdfa6-+-ganeti: assign ganeti300[123] role::ganeti

b04cd20d5e-+-cache: reimage cp1089 as text_ats

0dbbfc338e-+-Revert "Revert "cache: reimage cp2023 as text_ats""

358df0452f-+-netbox: create netbox_frontend global variables

cbdcea41ee-+-profile::puppetdb: refactor

db8c77d98b-+-analytics/hive: Support for kerberos sasl auth

5bcb49551d-+-Revert "Revert "cache: reimage cp3064 as text_ats""

a41eef90f1-+-cache: reimage cp1087 as text_ats

acf7de65f6-+-cache: reimage cp1085 as text_ats

f7d2f0a72c-+-Set vcs user password to '*'

9ebecae8c6-+-cloud-vps: allow per-deploy customization of site name in resolv.conf

2be78fae8c-+-Prepare Puppet to apply netinsights to all sites

72c02c94be-+-Phragile: Added PHP extensions needed by PHP 7 dependencies

f05028153b-+-openstack: add ceph rbd support for nova-compute

68967e4e34-+-Remove roles from old k8s etcd hosts

839a65e68d-+-Change eventgate-logging-external TLS port to 4392

bdef54d315-+-Revert "mwdebug1002: add motd warning"

554cc20d01-+-network: data: cleanup unused WMCS ranges

8e4c232227-+-Make the images proxy configurable and add boron

b82a212a76-+-calico::cni: Pass datastore_type as well

646adef830-+-toolforge: proxy: adjust setup for the new k8s cluster

7bf30bdbf6-+-logstash: remove base::expose_puppet_certs.

f5b8507e0c-+-growthexperiments: fix interval declaration

5809ad21a6-+-mediawiki: maintenance script for purging old GrowthExperiments data

e79f91c84c-+-nginx::simple_tlsproxy: remove class

27f26303c3-+-Install libsasl2-modules-gssapi-mit on jupyter notebook servers

58476fc027-+-dotls: use haproxy exporter profile

95a6a8d7d3-+-toolforge: bastion: raise default value for nproc

8589f2c3b2-+-elasticsearch: decommission elastic10[18-31]

34cc0dbe11-+-wmcs: make cloudmetrics1002 the primary instead of labmon1001

af1c335e6c-+-search: decommission elastic10[18-31].eqiad.wmnet

553197368b-+-wmcs: monitoring: remove rssh

7d235aa4d4-+-calico: Parameterize calico datastore type

409e3751c4-+-vhtcpd: convert service to systemd

6eb1220083-+-Homer: add Netbox config

5a5e87f6f0-+-profile::analytics::cluster::client: refactor hdfs mount code

14679804ae-+-ganeti: use 'drbd-utils' package

014b048862-+-icinga: Add WebPageReplay alerts for ru.wiki

2e82d231bd-+-Fix Analytics /mnt/hdfs readability checks after Kerberos

25c5e56ef4-+-mariadb: Set 10.4 as default on buster

f9df1190bf-+-toolforge-k8s: typo in encryption config

b11a9dc21e-+-dotls: enable on all servers

2aef2b0207-+-cloud: add ::apparmor dependency to ::profile::wmcs::mediawiki_vagrant

73bc56f06b-+-ganeti: assign ganeti400[123] role::ganeti

e4b3d516a2-+-toolforge-k8s: Add a service and notify around kubelet

9e6ca6d44a-+-role::dumps::distribution::server: simplify hdfs mountpoint code

856cf8d1d9-+-toolforge-k8s: enable encryption at rest

ae397a8829-+-Avoid to deploy spark2 on labstore nodes

4e56d81a02-+-role::dumps::distribution::server: fix include

a2fea35fb2-+-Enable kerberos on labstore nodes

34acb4d582-+-Move Analytics systemd timers on labstore nodes to local /mnt/hdfs

ec0ac8be69-+-Put hive-site.xml into HDFS as analytics user

5dea0c55c3-+-netbox: move to netbox-extras repository

a8ad579fa2-+-prometheus: bump Logstash Elasticsearch indexing failures thresholds

3ab68ae3c7-+-Allow labstore hosts to contact Hadoop

0cff3e448a-+-role::etcd::v3::kubernetes: Add role for etcd3 backing k8s

cc8c079684-+-ATS: allow to configure server_session_sharing.pool

174b37721a-+-profile::etcd::v3: Fix reassignment of $adv_client_port

e0c9cf8fd9-+-profile::etcd::v3: parametrize adv_client_port

1110f91ea8-+-Install pygerrit2 on releases server

43324aa61f-+-ATS: assign 8G instead of 2G to RAM caches on ats-be

1ed8cdf06f-+-labs_bootstrapvz: remove remaining references to firstboot.sh

9b92673659-+-Set up hdfs-rsync symlink in /usr/local/bin

d2af06a9ae-+-Deploy hdfs-tools to profile::analytics::cluster::client hosts

d2fd1af4c1-+-Deploy analytics/hdfs-tools/deploy to hadoop clients

0e00a5135d-+-ceph: add rbd secret to libvirt keystore

5d793153c5-+-dbctl: diffs nrpe: allow extra time to execute

940a09f671-+-ceph: disable log output on virsh define

3ff99f22c8-+-ceph: disable show_diff on keyring files

85bc1a308b-+-toolforge-k8s: set required kernel params for current kubelet options

1006bb487e-+-ceph: add libvirt uuid and keydata

08a4f25390-+-etcd: Align better etcdv2 and etcdv3 profiles

69864892ea-+-toolforge-k8s: harden the init config a bit

f434fa4f0e-+-ceph: fix rbd client keyring format

b123270eef-+-ceph: add libvirt rbd configuration

1f891ba805-+-Analytics refine: blacklist fetchGoogleCloudVisionAnnotations

5a43820dcf-+-contint: remove role ci::slave::browsertests

80c54080fa-+-contint: remove role ci::slave::saucelabs

c322d4f762-+-prometheus::k8s: drop envoy metrics about the admin interface

e454513554-+-nova: add nova-api middleware to inject a default user_data file

d96745cd24-+-dotls: add OCSP stapling support

cf4246e652-+-dotls: glue haproxy to gdnsd in systemd

5ad10270a2-+-dotls: haproxy gdnsd dep and smooth reloads

f4bb7e87e6-+-dotls: add ferm and NRPE monitoring via kdig

0332d004a8-+-dotls: simpler and clearer listen config

f22367e073-+-toolforge-k8s: fix a missing space in the config

c8fb81c7ba-+-toolforge-k8s: harden the kubelet a bit

461f3e56ef-+-dotls: main implementation

ac5ef43bdb-+-Temp fixup for acme_chief challenge validation

1352b12a70-+-dumps::web::fetches::analytics::job: add absolute path to bash

30f5193182-+-dumps::web::fetches::stats: move to systemd timers

0f8b72c969-+-role::search::airflow: add kerberos config and keytab

f4ec470e47-+-openstack: change cloudvirt1022 to ceph based virt role

a8e63fa4bd-+-ceph: add rbd client support

03a6dc6d67-+-role::search::airflow: add analytics cluster users

32937d0f4a-+-Extend cleanup list after upgrade with "git-core"

5950d3a2a5-+-prometheus: add alerts for eventgate-logging-external latency/errors

71c6abe98f-+-Complete package list for slice pinning on stat/notebook

372a4f1e7a-+-puppet-merge: refactor

d4b707f833-+-ATS: add icinga check for logs skipped by trafficserver{,-tls}

ada95b7026-+-ci: remove zuul-cloner package from Jenkins agents

bea932bc29-+-apereo_cas: update build logic

922583fef7-+-Decom puppetdb1001/2001

3f8d8d9e43-+-systemd: add icinga check for journal patterns

14ea6ce1b7-+-cloud-vps nfs: mkdir -p our mount points

1fcd2b7dc9-+-cdh::hadoop: replace augeas with a file resource

dfb90eead5-+-cdh::hadoop: set a lens in augeas - follow up of previous commit

390bb06dbb-+-cdh::hadoop: remove ipv6 constraints

c048bd7da8-+-site.pp: Remove puppet references from db2070

46147c673e-+-p::dns::recursor: bugfix for new ferm rules

66693ffad1-+-p::dns::recursor: bugfix for new ferm rules

32ed07600e-+-Refactor DNS ferm rules

b02180e9ad-+-ferm: add destination support to services

e8f5569d6b-+-mwdebug1002: add motd warning

b10ffd4f6c-+-ceph: update firewall rules for peers and clients

a2ba741f25-+-p::dns::auth: remove create_resources use

fc9b89917b-+-p::dns::auth: split up the monolith

e8cb81b9be-+-mediawiki: Remove unused HHVM files

b9ba9a5c11-+-rename authdns module to gdnsd

77da7ac0e0-+-authdns: move update system to profile and refac

fce59229e7-+-authdns: move config to profile

25c745b791-+-authdns: invert require on exec

44762544fa-+-authdns: move discovery check out of scripts

247f129af3-+-Revert "wmcs: make cloudmetrics1002 the primary instead of labmon1001"

61c74a656d-+-authdns: move discovery to profile and refactor

b1879ce515-+-toolforge-calico: Set up yaml and config to use calicoctl as a pod

7e0235ad22-+-authdns: refactor conf monitoring

fb37e9eba6-+-authdns: move host monitoring to profile

31f1d38d84-+-authdns: move global monitoring to profile

c3b3a3eae3-+-authdns: remove stretch clause

9f8df5c915-+-authdns: fix comment in scripts.pp

54f1f161aa-+-wmcs: make cloudmetrics1002 the primary instead of labmon1001

7ca6231c1d-+-toolforge: k8s: metrics: include some hints and comments

cf4e64ab8c-+-toolforge: k8s: include metrics-server

f0a0176607-+-toolforge: k8s: introduce admin script to add x509 certs to k8s secrets

3fee44028e-+-monitoring: page on low HTTP global availability

d7bc9c14d3-+-monitoring: fail on single-quote Prometheus query

1875b56e3a-+-mariadb: Set db2070 to spare

b2539c98e2-+-site.pp: Remove puppet references for db1062

e7e5371d9a-+-ceph: add ceph object store role to cloudcephosd servers

0b1f1a27f6-+-ceph: require service account before package install

3873970050-+-ceph: update mon ferm rules and manage ceph service account

649871d1ce-+-ceph: add ceph monitor role to cloudcephmon servers

0a52ceac04-+-ceph: initial monitor and mgr daemon modules

344534587e-+-lvs recdns: clean up realserver def

f3ce62fc9c-+-lvs recdns: eqiad and codfw keep old addr, for now

4869af600f-+-lvs recdns: decom lvs-specific parts

ed2440d0dc-+-profile::hadoop::worker: add set_yarn_dir_ownership script

32fd0bb4d9-+-Setup apt pinning for puppet 5 / facter 3 on stretch/jessie

1c9f9a8ba3-+-wmcs: use hiera for labmon/cloudmetrics instead of harcoded values

264459965a-+-icinga: Add all WebPageReplay alerts.

668bfa0248-+-dnsrecursor: remove redundant listen for prod case

bb43c97c15-+-dnsbox: eliminate extra profile layer

8d7b758b1e-+-dnsbox: replace glue with bind_service

95f8f21e08-+-dnsrecursor: add parameter bind_service

9886a8af23-+-dnsrecursor: rename ulimits to override

97ea348ac6-+-Turn old LDAP replicas into spares

338f320ede-+-mariadb: db1062 set it to spare

34363638fe-+-dnsbox: remove include_auth switch

28e22b1746-+-dnsbox: move profile::standard up to role

2017d4084a-+-authdns: remove host:53 monitor listener

8b4ef4a870-+-Fix jdk-8 path for alternatives::select in profile::java::analytics

971ebb8126-+-java::analytics: Make java 8 the default on buster

28e7b9ebfc-+-traffic drop: require minimum absolute rps

b253250fd7-+-atlasexporter: generate metadata metric

8be5f3b80f-+-varnishmtail: install varnishttfb.mtail

e52e20df9b-+-statistics::discovery: move cron to timer and add kerberos support

a2ba5530ad-+-prometheus: change default tools proxy to tools-proxy-05.tools.eqiad.wmflabs

b30d2ba034-+-labs.yaml: amend some comments to add the project name to VM fqdns

927c626549-+-horizon: remove PUPPET_GIT_REPO_PATH config

8178003b06-+-Revert "configure adds-changes dumps to skip locking for now"

a7b896d397-+-Horizon: set SECRET_KEY to the same value across a deployment

02a7c04ad4-+-phabricator: limit mysql access for admins to production realm

db1b862862-+-ceph: remove rook.io based ceph modules

db88f6529b-+-contint: role for CI package_builder instances

9c40a15153-+-Add openstack client packages for train

2d0361df22-+-prometheus/ops: add atlasexporter

770e212623-+-phabricator: remove wstunnel for aphlict from webserver config

e9d71c7ed9-+-Install prometheus-atlas-exporter on netmon hosts

23b86c2098-+-Revert "Revert "dumps/phabricator: switch dumps host from phab1003 to phab1001""

fc3af02573-+-make ffmpeg installation depend on apt-get update exec

1e647d7778-+-prometheus: drop Logstash 7 unnamed plugins

5863cfaedb-+-dnsrecursor: param threads and lce for prod

c8cbe1842f-+-anycast: bind to real service

90482cdbc6-+-anycast healthchecker should be able to bind

80ba7249e9-+-Add exec for apt-get update for ffmpeg component/new job runner installs

fc126bd2f1-+-backup::host: use fqdn_rand_string for password generation

f0c7419b5a-+-Also extend package declaration for ffmpeg with libav packages

f32f8261b1-+-Extend pinning for ffmpeg with libav libraries

6d2a44abbc-+-Fix apt pinning for VP9-enabled ffmpeg build

9c74718ba2-+-ATS: allow to toggle request coalescing

e6e3993255-+-deployment_server::helmfile: allow injecting secrets

a6486cf2b7-+-Revert "mediawiki: Stop rebuildItermTerms temporary"

d9f4f8b6e3-+-mariadb: Decommission db2065

eefc494a1a-+-Revert "dumps/phabricator: switch dumps host from phab1003 to phab1001"

10da12f3da-+-phabricator: simplify rsync setup for migration, part 2

d6e6dba583-+-base: document statsd DNS kludge

64dbfd86ab-+-hardcode statsd IP via profile::base

25ba7af7b3-+-phabricator: simplify rsync setup, step 1

11e2189e91-+-Phabricator: remove validate_hash, it's deprecated

619f81ff3b-+-profile::puppetdb: update elk logging

35505e27f8-+-bacula: Increase offsite backup retention to 90 days

e4dcd0c614-+-profile::opennstack::services: Ensure the mdadm cron is not managed

1d32238929-+-toolforge: set a new package builder role

9695ec8da6-+-bacula: Increase production and Databases retention to 90 days

469140a753-+-Revert "ganeti3003: provision as authdns::server"

39605b550e-+-puppetdb: change old puppetdbs to spare role

a245b0dd95-+-role: toollabs: drop unused role classes

339e915725-+-mediawiki: Stop rebuildItermTerms temporary

eec9b97f83-+-kubernetes::node: Enforce upstream nf_conntrack_max

0ab3dfc2a9-+-neutron dhcp: reconcile dhcp_domain and dns_domain

67fa4ea5f2-+-profile::refinery::job::spark_job: allow to pass a keytab

53f49ad088-+-phabricator: temp. disable automatic rsync of repo data

f83833327c-+-keystone ocata service: fix keystone-wdgi-admin.py filename

77d830a09a-+-Phabricator: install python3-pygments instead of python-pygments

beca2f438f-+-dumps/phabricator: switch dumps host from phab1003 to phab1001

429dccc723-+-airflow: use correct data type for config file name

e4af2d62b8-+-airflow: move parameters, use lookup, style changes

0c93912fcc-+-logstash: add kafka ssl_endpoint_identification_algorithm param

5f745ec9ed-+-rsync: readd incoming and outgoing chmod

4611ecaf72-+-logstash: remove non-kafka inputs from elk7 cluster

5355c9761b-+-Import sparql-query events in mediawiki_analytics camus job

779f8a4f47-+-[wdqs] fix async-import option

0e065e5e2a-+-[wdqs] add async-import option

2c318608b3-+-logstash: create elk7 logstash collector profile

e9ed1d97b9-+-database-backups: Fix database jobdefaults for database dumps

f544ce19fc-+-database-backups: Use a different pool for database backups

0a3600a525-+-Revert "Revert "bacula: Setup new pool for databases as well as its configuration""

da118215b2-+-Revert "bacula: Setup new pool for databases as well as its configuration"

904766a9f6-+-bacula: Setup new pool for databases as well as its configuration

4dd3918a45-+-bacula: Rename schedule to monthlys., split schedule & jobdefaults

584c7c6d32-+-Import *sparql-query topics and refine them

b9de504cea-+-authdns: ferm for ssh hardcoded as well

ca8555947d-+-authdns: add explicit hosts entries

83063773a5-+-refactor authdns_servers to include host IPs

21fb2e5d56-+-calico: Keep FQDNs for calico felix prometheus targets

5f37042220-+-md: Globally set lower sync limits

050772994d-+-prometheus: Allow keeping FQDNs as targets

c0c08e40d0-+-labmon: update graphite-web to be compatible with buster/stretch

8d98fd8095-+-backup::host: refactor

b875b0ed8f-+-profile::idp: update file source to content

63e99f2bb3-+-profile::idp: add jmx prometheus exporter

d14985f33d-+-cache: reimage cp1083 as text_ats

5f5f0d0571-+-service.pp: Change vendor to: percona-server

6afea0abbf-+-mariadb: Add wmf-mariadb104,percona 8.0 as a possibility

06b498da2b-+-keystone ocata: include custom wsgi script

858927f187-+-prometheus: Scrape kube-proxy metrics

abbc219e13-+-mariadb: Set db2065 to spare

ee847b075c-+-site.pp: Remove puppet references for db2067

6f716f86ca-+-toolforge calico: Can no longer copy binaries like this

49818fa157-+-require, not after

25fb35e455-+-pdns-rec-exporter should depend on pdns-recursor

0fb8e09f7c-+-kube-proxy: Fix toolforge kube-proxy

5f468dd164-+-toolforge-k8s: simplify calico upgrades and distribute calicoctl

8cce45c48c-+-kibana: add kibana_package param and set elk7 hosts to -oss variant

e7d27a1369-+-logstash: add logstash_package param and set elk7 to -oss variant

ea2f56d402-+-logstash: create elk7 logstash role and assign to elk7 collectors

84387fa6a0-+-kube-proxy: Allow overriding metrics bind address

ea8d38bfe1-+-elasticsearch: add buster openjdk 8 repository

abba1a023e-+-toolforge: new k8s: introduce apt pinning configurations

0c63ec8465-+-logstash: create elk7 ES role and assign to elk7 ES hw hosts

6e9fc07c31-+-explicitly start rpc.statd service on dumpsdata servers

6962d12f9c-+-httpbb: Install python3-requests-toolbelt.

498151a452-+-profile::prometheus::ops: add tls server name

65cc2f1405-+-openstack admin_scripts: stop installing wmcs-nova-quota-sync

bf017a8f08-+-profile::prometheus::ops: add scraper for apero_cas idp service

f157e6c89a-+-package_builder: cant use spaces in job title

3f13f3bf9f-+-package_builder: add leading 0 to time spec

d7948b0887-+-package_builder: clean up build and results directory

7afd5b237e-+-packages_wmf.pp: Remove libaio1, libjemalloc from requires

3f29ba7bae-+-query_service: use the correct script for autodeployment

2333c6f7c4-+-packages_wmf.pp: Install libjemalloc2 on buster

43501a4fef-+-mariadb: Reimage db1107 and place it as core_test

9bf5ff84d5-+-Openstack Neutron: add missing files for Openstack Ocata

e99ee4014d-+-Openstack keystone: add more missing manifests for Ocata

e35ee19a13-+-prometheus: scrape calico felix agent

c3a4af9423-+-Revert "package_builder: clean up build and results directory"

859275a629-+-package_builder: clean up build and results directory

c135174bf2-+-apereo_cas: add prometheus actuator

4403aef6b5-+-keyholder: notify only the proxy on proxy changes

697dab115a-+-prometheus: fix link to logstash indexing errors

f65d7e6be1-+-mariadb: Remove db2062 from puppet

7c1dc2345d-+-prometheus: fix wording and link for exporters availability

e9461966da-+-profile::idp: proxy to localhost not the real ip address

47a13666e0-+-profile::idp: ensure upstream_port is a stdlib::port not string

d8496f5209-+-tlsproxy::localssl: allow users to specify an upstream ip address

fdeea6be78-+-tlsproxy::localssl: add parameter type checking

100a9a13c7-+-Switch log level back to DEBUG

67a2f982ba-+-cloudvps: rename+reimage labmon1002 as cloudmetrics1002

8d8e1fd27a-+-Add ripe-atlas-esams to monitoring

045b06987b-+-prometheus: alert on exporter's 'up' metrics

ba5fa18e04-+-otrs: add envoy for TLS termination behind ATS

1e6d94c1ee-+-turnilo: limit logs to daemon.log/syslog

2b0c55317a-+-mariadb: Remove references for db1061

87b829b286-+-mariadb: Set db2067 to spare

934ccc8b09-+-logstash,hiera: add logstash performance tunables and tune batch size

c3be89f239-+-airflow: require_package python3-mysqldb

70efe57c76-+-airflow: fix ensure => directory

6940ea2690-+-airflow: Run webserver and scheduler processes

f0c5280a09-+-role::dumps::distribution::server: add analytics refinery

5a3c0d9eff-+-nova: add nova config for the placement service, enable on eqiad1

4974082561-+-role::dumps::distribution::server: add kerberos

643b694803-+-profile::idp: set loglevel to WARN

56d5012c4e-+-Add LVS for eventgate-logging-external using TLS port

63a89d410d-+-authdns: restrict 5353 to production

02902ad11a-+-Absent sync systemd timer for the primary IDP

0e503b395e-+-ATS: ensure Lua conf Icinga checks produce output

dcc6746239-+-mediawiki: Disable mostrevisions for wikidata

a691980e4d-+-labmon: add compatibility in buster

eaba1f2bff-+-authdns: use system user flag for user/group

073d495864-+-acme-chief: parallelize gdnsd-sync

ae1a351999-+-dnsbox: set up rec/auth machine-local dependency

20106ba38f-+-Update IDP rsync to also account for future additions to the devices directory

b32bbdad2e-+-package_builder: Add ordering rules for new hooks

0812496bf3-+-package_builder: Add the bullseye distribution

8afd999d3a-+-package_builder: Remove tests/ directory

305033b2a8-+-ATS: enable reload for global Lua script

f22b7ca38f-+-Enable ldap-corp1001/2001 as additional LDAP replicas

5b6d08e2bc-+-Add IDP device data to backups

0b7bddb5df-+-role::statistics::explorer::gpu: add systemd user limits

5969e471d5-+-systemd::slice::all_users: add Debian Buster support

dd68cc38a4-+-Apply profile::analytics::client::limits to stat100[6,7] and notebooks

d874f1e169-+-mariadb: Set db2062 to spare

46529e7c13-+-nova-placement-api: fix permissions on init script

490a7fbf3f-+-nova-placement-api: update firewall and monitoring for new port

ed870d345d-+-nova-placement-api: Make service port configurable

81b7512188-+-authdns: define gdnsd user/group explicitly

00cb8e12de-+-prometheus: Specify metrics_path for the new poolcounter exporter, whoops.

f106bdb3ad-+-prometheus: Scrape the poolcounter exporters.

7d3d4bcd4a-+-Draft fully-blended role

0b452c4633-+-dns roles/profiles refactor, part 3

224767f0a0-+-dns::recursor: move role bits down to profile

4a681c14ce-+-openstack: add health check options support to haproxy

2b76176d58-+-mediawiki::maintenance: add envoy for TLS termination for noc.wm.org

9588c85445-+-authdns: port 53 monitor made optional

aae6f502f6-+-nova-placement-api: fix service name

b0449ac19d-+-nova-placement service: Fix type of 'active' param

c47d243685-+-nova: add support for the 'placement' api service

7be2b4f19f-+-authdns: move per-server monitors to 5353

e1cddc0feb-+-authdns: add ferm rules for 5353

1427b8ce97-+-Add missing protocol prefix to idp-u2f-sync systemd::timer

a93c7d5869-+-prometheus: alert on low job availability

14428cbe28-+-Introduce systemd cgroup memory limits for stat1004

e76f741041-+-Setup systemd timer for rsync of U2F devices config

4fd7956a8a-+-authdns: configure explicit service/monitor addrs

c2ac1a3ccf-+-toolforge: prometheus: fix port for nginx exporter

a19e8d80a0-+-Fix rsync devices path

ce1f7aba05-+-toolforge: prometheus: add job for nginx metrics in the front proxy

4b78da50cf-+-Add and use check_dns_query

2b1ea6a038-+-backup: Move filesets to a separate file

2e5e594154-+-toolforge: proxy: enable nginx prometheus metrics

97a8723fab-+-Disable Juniper alarm check for cr3-knams

007669fc1b-+-profile::mediawiki::httpd: use SetEnvIf, not setenv

8629c61f5d-+-puppetboard: add proxied_as parameter

b17a31a2f7-+-profile::mediawiki::httpd: set a SERVERGROUP env variable

0109bd2d18-+-Setup rsync config for U2F device storage

c875f99214-+-mediawiki: Remove apache systemd override for tmpreaper

35d692df05-+-Remove unused ganeti-instance-debootstrap

2985723894-+-mariadb: Set db1061 to spare

f7d091fe0b-+-Rename cr2-knams to cr3-knams

2f4b9eb714-+-mariadb: Promote db1086 to s7 primary master

3a63a30ec4-+-grafana: okay, *now* remove the obsolete rsyncs

1a5aea5ddd-+-grafana: first, ensure=>absent the obsolete rsyncs

643e283311-+-grafana: remove rsyncs after complete migration

db3a7da88a-+-poolcounter: Add ferm rule for the exporter; move it to profile::poolcounter.

e351a3879a-+-poolcounter: Refactor: In role::poolcounter::server, use profile::poolcounter.

6b74559a89-+-poolcounter: Set restart => true for the exporter service.

e64dd9d7ee-+-poolcounter: Install and run the prometheus exporter alongside poolcounter.

42f1f7f5a5-+-logstash collector: use proper ferm syntax

6bcb40a342-+-grafana1002: is now the server for grafana.wm.o

3826d6452a-+-profile::analytics::search::airflow: fix directory ensure

b244f47240-+-profile::analytics::search::airflow: fix file resource and add deps

b2eb9ceaab-+-Revert "ATS: enable reload for global Lua script"

2e5bc6718f-+-airflow: Initial deployment for search platform

e40cba521f-+-admin: add analytics-privatedata system user

63c29d1202-+-Move DNS roles together under role::dns::

103ba315f9-+-Move DNS server profiles under profile::dns::

38fe8a251f-+-Unify and simplify DNS server ferm rules

a827ea6602-+-ATS: enable reload for global Lua script

0132e36905-+-authdns: refactor role/profile/hieradata bits

b46d450b3c-+-Revert "cache: reimage cp3064 as text_ats"

b6ca2cdda3-+-puppetboard: Add cas authentication

3d3f171a46-+-profile::mariadb::misc::eventlogging::database: set db to read only

c396e41e9f-+-toolforge: new k8s: haproxy: enable prometheus metrics

1f7e089d24-+-deployment_server::helmfile: use the correct prometheus nodes

2828588a72-+-protmeheus: haproxy: add support for Debian Buster

c1a336b414-+-profile::idp::client::httpd: refactor

d45e4eeaab-+-prometheus::snmp_exporter: rationalize hiera calls

9af6242d41-+-kubernetes::deployment_server: Add a private/general.yaml file

abf23bef21-+-prometheus: add scraping of k8s envoy sidecars

8c93d4f8bf-+-prometheus: support configcluster and configcluster_stretch

bb76e59ad2-+-mariadb: Remove db1067

b5cdceab07-+-mariadb: Promote db2134 to m3 codfw master

fe94b12270-+-designate: fix puppet_git_repo_name for codfw1dev

dca8d2fca9-+-configure adds-changes dumps to skip locking for now

71926f53b7-+-homer: move git peer to hiera

5f8251a4a5-+-move misc crons to dumpsdata1002 nfs server

dc57628377-+-wmf-sink: include python-git package

d7598b61d2-+-wmf_sink: Prepare to delete instance puppet config from git on instance deletion

e63cb6e485-+-Remove puppetpanel.pp -- unused

05b2a6b23d-+-prometheus-bacula-exporter: Restart service on code change

759c0e2208-+-profile::idp::client: remove SAML validation, fix trailing slash

c37840ba48-+-profile::idp::client: add a profile for configuering apache sites

f3e197f52e-+-prometheus: lower threshold for logstash indexing failures

17a13e2be6-+-profile: add esams/eqsin snmp_exporter configs

2dba7bfc4c-+-cache: reimage cp1081 as text_ats

8715c6b5f5-+-ATS: Enable log rotation via logrotate

22c562e371-+-role::prometheus::analytics: remove old burrow configuration

d57a2fee99-+-netbox reports alerts: fix notes_url from variable rename error

acd8fdff43-+-xhgui: disable automatic rsync, keep it manual

29a1ad669a-+-xhgui: also copy tungsten mongodb data to xhgui2001

e488039c32-+-xhgui: rsync mongodb data from tungsten to xhgui1001

0f5e38ede6-+-xhgui: install unpuppetized apache php module

69bd7618c7-+-add xhgui::app role on xhgui VMs

0700db8e11-+-xhgui: add support for stretch/PHP7.0

21a4c01c3c-+-webperf: Remove xhgui profile from webperf::profiling_tools role

f2cb93041a-+-netbox reports: run as netbox instead of nagios

6bc325f039-+-facilities: fix esams pdu name

c822b3fdd5-+-netbox report alerting: Simplify icinga check and cleanup

b11606c308-+-openstack: serverpackages: ocata: fix missing thirdparty keyword

4007e4a05b-+-ceph: preserve docker iptables chains

b5af5c505d-+-openstack: serverpackages: ocata: drop trusted spec from repo declaration

e65362fca0-+-Parallelize authdns-update with clush

760343a141-+-analytics::refinery::job::refine: Bump up refinery jar version

e4489d78fa-+-openstack: bootstrap ocata puppet code for servers

760b5fe2ef-+-apereo_cas: use CAS protocol instead of SAML

5c4160b143-+-cache: reimage cp1079 as text_ats

96dfdb38a2-+-otrs/phabricator: do not assume text nodes are defined

40f5659ec8-+-cache: reimage cp1077 as text_ats

d8729a380c-+-fix up role name for the misc crons dump worker

76ed5e5139-+-mediawiki: remove all hhvm related files and hieradata

adc29ac34f-+-make dumpsdata1002 a spare dumps server with no special jobs

ddc92ecbb1-+-prometheus-bacula-exporter: Setup bacula collection on prometheus

0ca2042541-+-Revert "cache: reimage cp2023 as text_ats"

0ed10603eb-+-mariadb: Prepare to decommission db1067

c5f6f0d8e8-+-centrallog: remove quickdatacopy after sync

ca970f2d5a-+-prometheus-bacula-exporter: Fix systemd unit and permissions

192df604ad-+-prometheus-bacula-exporter: Setup service on bacula director

5d90c59875-+-mariadb: Promote db2133 to m2 codfw master

d98d6f9796-+-phab: avoid failing to load trusted_proxies in codfw after ATS migration

2eded6390f-+-phabricator: write my.cnf for db access into each admin home dir

b06e56212b-+-xhgui::app: add support for buster/PHP7.3

36c8293836-+-pdns monitoring: try to resolve target_fqdn rather than target_host

28fe2e978f-+-pdns: Fix typo re: pdns_api_key

d5835aae69-+-cloudservices: move from pdns3 to pdns4

bc08aa4c12-+-cache: reimage cp2023 as text_ats

e1cfc4fad4-+-analytics::refinery::job::druid_load: fix neflow sanitization

6e38b1029f-+-cache: reimage cp2019 as text_ats

e776a78254-+-logstash: introduce logstash 7 and openjdk-11 support

7fb50fb6ae-+-wdqs: move wdqs1007 from internal to public cluster

be187ed5b9-+-hhvm: Remove hhvm module from puppet

c1624afb64-+-profile::mediawiki::maintenance::wikidata: use systemd logging

bf3e26fc76-+-mediawiki/wikidata maint cron for updateQueryServiceLag

aea18bcb75-+-cache: reimage cp2016 as text_ats

2b162303d3-+-logstash: remove HHVM references

224ea33c99-+-rsyslog: setup temporary secure rsync for logs transfer

7c0b1bf099-+-prometheus: Remove dead HHVM code

fce863aa58-+-cache: reimage cp2013 as text_ats

aac73a3bb2-+-cache: reimage cp2012 as text_ats

4b8b6b4108-+-cache: reimage cp2010 as text_ats

115b970d7b-+-tlsproxy::envoy: restart envoy when certificates change

2907741f3e-+-role::debug_proxy: remove old/unused aliases, depool mwdebug1002

bc252ed7ca-+-mariadb: Remove db2061 from puppet

5be2a7d32a-+-profile::analytics::refinery::job::data_purge: fix timer commands

aa82835045-+-mariadb: Promote db2132 to m1 codfw master

6433428a49-+-profile::analytics::refinery::job::data_purge: add systemd env variables

8eb8bbb639-+-deployment-prep: Migrate to new logstash host

8c903a582b-+-Add some standard maintenance access to clouddb2001-dev

19825712de-+-netbox: fix alert notes_url

03c5f381d9-+-phabricator: if aphlict is disabled also unload wstunnel httpd module

0d03ec1714-+-interface: Add a config option to avoid CPU 0 in RPS.

418986e476-+-phabricator: stop aphlict service if disabled in Hiera

ac5d50c8d4-+-netbox: Set URL in report alert to the URL of the report

09d3b3fac8-+-site/xhgui: add xhgui eqiad and codfw nodes as spares

a5373ab5b9-+-profile::icinga::ircbot: Add log for dcops channel notifications

bcc1ed14dc-+-site/centrallog: unify nodes into a single stanza

109242ff53-+-netbox report alerts: Notify dcops group on failures

d3e788343a-+-site/webperf: remove superfluous lint-ignore comments

cc1ade4bd1-+-analytics::refinery::job::druid_load: Add sanitization for netflow

48a824a265-+-cache: reimage cp2007 as text_ats

87656ce3dc-+-cache: reimage cp2006 as text_ats

b44e832802-+-Revert "profile::analytics_cluster::coordinator: add geoip database"

e0e4eb8b3f-+-profile::analytics_cluster::coordinator: add geoip database

2416e6de95-+-cache: reimage cp2004 as text_ats

c4965a2cbe-+-toolforge: prometheus: fix syntax for label in the new-k8s-nodes job

1940a7cb25-+-cache: reimage cp2001 as text_ats

0b086155bc-+-toolforge: prometheus: fix syntax in the inlined config yaml

27f379d0d8-+-monitoring: remove nginx availability alerts

fe4b61c0b6-+-toolforge: prometheus: enable scraping for the new k8s cluster

f395525a50-+-logging: add logspam utilities

3beaa5d42e-+-toolforge: new k8s: add wmcs-k8s-get-cert.sh script

52bef19ac5-+-puppet_compiler: ensure we dont reset the permissions of the repo

611b08c699-+-mediawiki: Remove HHVM references and includes

b06f6bb61f-+-query_service: add updater mode option

1a5564d39c-+-allow storage generated misc cron dump output on secondary nfs server

283441c5fe-+-[wdqs] Fix event service configuration

ca26c55ca0-+-admin,mediawiki: Remove hhvm related sudo privileges

04b071c1f6-+-mariadb: Set db2061 to spare

995eb007e7-+-mariadb: Promote db1131 to s6 master

e99e15eb0b-+-grafana: quickdatacopy 1001->1002 for plugins and for pngs

4f42665233-+-rsync: fix multiple usages of quickdatacopy

2816a43072-+-Revert "zuul: Remove zuul Gearman queue alert"

4d575dff5c-+-grafana-beta: rename to grafana-next

064d72e5ac-+-graphite: add grafana-beta to cors_origins

7ee2251fea-+-Revert "packages_wmf: Install 10.1 with buster"

65a0c84b68-+-prometheus: Use the correct parameters to build jmx wdqs-* targets

f6dacc7a41-+-aptrepo: actually install file reprepro-update-filter-wmcs-openstack-ocata.sh

40712090ea-+-apereo_cas: update systemd to run as a system user

d62ca83fbf-+-prometheus: Update prometheus target config for wdqs

720c83c41e-+-ATS: network settings for ats-be

5c110d1b30-+-Rename wezen to centrallog2001

713ab170b8-+-dbtree: add https VirtualHost

023626858c-+-profile::analytics::cluster::client: rework nagios' sudo permissions

3c6d273220-+-profile::analytics::cluster::client: fix nagios' sudo permissions

b3eab03908-+-realm.pp: Add oauth2_access_tokens as a private table

32e05baede-+-mariadb: Provision db2135 into m5

0debf2931c-+-pdns/cloudservices: add all_from list to dns api

e69ad4cf43-+-make dumpsdata1002 spare before reimaging

b2817b84b6-+-profile::analytics::cluster::client: add sudo to nagios command

1fa4a3c64a-+-Typo fix, followup to d119b955d908fecad021c8427b5078ec1295112e

3da3c6aca2-+-pdns: support api server for pdns4

17faf7e11d-+-varnishxcps decom: remove mtail rules and code

94e9feaadf-+-varnishxcps decom: remove xcps manifest

96997a4d06-+-varnishxcps decom: undefine the mtail program

e7fae2a866-+-make dumpsdata primary nfs server rsync to dumpsdata1003 now

05909080ae-+-cache: reimage cp3064 as text_ats

c406233887-+-Remove tor_exit_node_update cron from wikitech::web

f4411f9668-+-configure wikidata dumps to generate empty abstracts files

73b86fcde5-+-cache: reimage cp3062 as text_ats

003344c5f0-+-mariadb-client: Install 10.4 on buster, unblock os upgrade

69480e954d-+-buster doesn't have mailx, replace with s-nail

0babee85fd-+-mariadb: Provision db2134 into m3 codfw

3d671ec409-+-make dumpsdata1003 another secondary dumps NFS server along with dumpsdata1002

a59568e356-+-zuul: Remove zuul Gearman queue alert

84f4195604-+-profile::homer: throwa warning if no homer::peers are returned

21c64883e3-+-Install httpbb on cluster-management hosts.

9d13e29d78-+-cache: reimage cp3060 as text_ats

21d89b8232-+-Unified cert: undeploy digicert-2019

e699d63dd0-+-cache: reimage cp3058 as text_ats

63a92d0f07-+-mariadb: Place db2133 into m2

003f0c0ba2-+-mariadb: Promote db1083 to s1 master

23ffae716a-+-ceph: upgrade to latest upstream docker-ce version

85f445bd5d-+-presto::server: add the presto user to the catalog

3dabaccb8c-+-Unified cert: deploy digicert-2019a to infra

bdfaa39c61-+-ceph: add ceph storage cluster profiles and modules

9ed9a8e5df-+-cache: reimage cp3054 as text_ats

fe95746bc7-+-debmonitor: expect 302 on successful TLS termination

ce6f6a9d96-+-debmonitor: terminate TLS on port 7443

fa4acf27b2-+-Add Icinga check for correct application of microcode mitigations

d21e56a185-+-logstash: move ingestion alerts to be site-local

1a9c042627-+-openstack: clientpackages: vms: refresh comments and messages

f93dc01d5a-+-logstash: alert on indexing failures

2faaa9d700-+-elasticsearch: initial configuration for new elasticsearch servers

4237a3418b-+-wmcs: prometheus: delete datatype spec for kubernetes user

e508d521c9-+-cloud: refactor prometheus role

c22b944c5d-+-[beta] configure sparql/query logging to deployment-eventgate-3

10505e9368-+-Introduce Elastic 7 support

1e4c2eee1c-+-mariadb: Pool db2132 into m1

cedbd11302-+-Add GlobalSign R3/R5 cross-signing intermediate

1bf92bbfc6-+-cp1071: mark as test

1e0813b2a2-+-Remove globalsign-2018 puppetization

22fe019a68-+-cache: reimage cp3052 as text_ats

af29d1e0e1-+-Cloud puppetmasters: replace ruby-httpclient package

01af805cad-+-mediawiki: Make the rebuildItemTerms slightly script slower

1f8471dc1d-+-Remove Eventloggging sanitization automation from log databases

91dcfed027-+-profile::mariadb::misc::eventlogging::sanitization: restore eventlog group

d4acfc502e-+-toolforge: new k8s: etcd: enable TLS for metrics endpoint

dd717bb561-+-profile::mariadb::misc::eventlogging::sanitization: ease clean up

b6fb305f67-+-prometheus: collect logstash mtail metrics

4f3c0a9d4e-+-monitoring: add alerts for ats availability

fe6d6cb027-+-packages_wmf: Install 10.1 with buster

16afeed408-+-mariadb: Remove db2048 from puppet

aecc4d2226-+-add dumpsdata1003 to peer hosts for rsync, part 2

79133a9ba1-+-ceph: add spare::system role to ceph mon and osd

fa04a0e5d9-+-Revert "mediawiki: Make the rebuildItemTerms script slower"

9568c00714-+-cache: reimage cp3050 as text_ats

8fbaf14835-+-Adding elastic10[53-67].eqiad.wmnet to site.pp role::spare

54921846b5-+-profile::kerberos::client: set up motd properly

59f9eb53e3-+-ATS: X-Wikimedia-Debug request routing implementation

c102b15f5b-+-profile::kerberos::client: add MOTD to help users

40f69e665b-+-prometheus: add lists server mtail scrape to mtail jobs

49f5400800-+-mariadb: Set db2048 as spare

f790333320-+-rsync: provide a hiera default to unbreak cloud

a340535d9e-+-phabricator: monitor the PHD process if PHD is set to running in Hiera

edec49730e-+-toolforge: Add missing Package[python-yaml] dependency

7c71eecc01-+-icinga: add notes_url to aggregate ipsec alerts

65a9b948e9-+-toollabs::maintain_kubeusers remove cleanup code

dc980efb6d-+-Revert "systemd::timer::job: add typing for $interval"

788bd015a4-+-systemd::timer::job: add typing for $interval

28e0595c5f-+-kubectl: upgrade /usr/bin/kubectl to 1.15.5

d2ec4431c9-+-gerrit: remove pre-buster support

84d095def0-+-acme_chief: cloud: fix typo in prometheus_fixup profile declaration

48bbc482c8-+-toolforge: enable tools-prometheus to monitor by SSH serveral servers

112a08a4ed-+-Deploy (but not use) new 2019 globalsign unified

f25fd33d9c-+-phabricator: proxy websockets at the httpd level

6a5945f5ba-+-analytics::refinery::job::data_purge: remove data quality deletion

136b2697a7-+-analytics::refinery::job::data_purge: absent data quality deletion

e507cf93de-+-wikistats: change mysql datadir to /var/lib/mysql

da2c93b596-+-prometheus: add ipsec_status to prometheus/global

1066d685b4-+-gerrit: raise log retention from 7 to 30 days

d3c861bcaf-+-doc: make published files group writable

f81c7a2e78-+-wmcs puppet: remove the mwyaml hiera backend

ac8da96eb3-+-Fix some typos in code comments

ef7595045a-+-profile::hadoop::kerberos: remove unused parameter

ba93991582-+-cloud-vps: remove duplicate definition of node_puppet_agent

3350a74af8-+-cloud: Replace diamond::collector::minimalpuppetagent

30c0af73e0-+-httpbb: Add httpbb module and baseurls test suite cribbed from apache-fast-test.

a934ceb416-+-puppetmnasters: use localcacert setting for CA file in apache

9a9306a483-+-cloud: labstore::nfs_mount remove cleanup code

7af791b669-+-CI rspec: update puppet version used in spec tests

a6e952342b-+-profile::puppetmaster: update to allow managing the CA file

392c739471-+-profile::base::puppet: move the puppetca to a global variable

dd1e840efa-+-envoyproxy: support 'websocket' connection upgrades

1607ffd189-+-profile::base: reorder class

7faa69f30b-+-base: certificates: add new GlobalSign CA files

44aab36b0a-+-profile: get exim metrics from lists

3609745f0a-+-HDFSCleaner - change command args

2fb62bbe65-+-rsync::server::module: ensure hosts_allow is an array

c4fdb42b32-+-mtail,profile: add smtp metrics collection with mtail

585eab1dfe-+-cloud: Replace SSHSessions diamond collector with prometheus

d603f77b1d-+-role::analytics_cluster::coordinator: add missing kerberos profile

5708862c5c-+-toolforge: Distribute the roles for toolforge users

86dcc29ea3-+-Grafana alert for WebPageReplay enwiki tests

21a4c1e422-+-Include Kerberos profiles in the Analytics infrastructure

b060bcd207-+-httpbb: Create a new Puppet module for httpbb.

a3f4f9e169-+-query_service: properly adapt hiera configs

6fe907301d-+-swift: don't clean up swiftrepl user/group

c8a2e56905-+-query_service: properly adapt query_service profile

966be5e21a-+-query_service: separate categories from main blazegraph profile

c082d1aff1-+-query_service: rename profile/wdqs to profile/query_service

cf3684b566-+-query_service: prepare query_service for reusbility

c06ec93f82-+-query_service: rename wdqs module to query_service

c227e74ee5-+-toolforge: toolviews: add default hiera values

b4e08ab7d7-+-toolforge: proxy: prevent variable from reassignation

a6286f49c0-+-toolforge: proxy: make https fully optional

1ec3192fa8-+-toolforge: Reload/restart services as appropriate on certificate change

97a59e5ae6-+-profile: add mtail to logstash

8982948548-+-profile::analytics::database::meta::backup_dest: clean up hdfs configs

c4f652d9fa-+-profile::analytics::database:meta::backup_dest: absent hdfs uploader

9ff8bc82ba-+-Add Bacula backups for Analytics Meta's mylvm snapshots

22d371b1ae-+-profile::analytics::database::meta::backup_dest: fix typo in hiera

9014159513-+-toolforge: Remove old absented star.wmflabs.org certificate

0487468b9a-+-rsync stunnel: always accept from localhost

426d2b1e8d-+-rsync stunnel: need to enable in /etc/defaults, apparently

fda4a5d904-+-rsync stunnel: fix typo

878e0dd5d9-+-rsync stunnel: enable for netmon1002 & /var/lib/smokeping

110de90ba2-+-rsync stunnel: the client needs stunnel4 installed too

6ed6232312-+-rsync stunnel: ferm support for both clear & TLS

3a6d53a321-+-site: remove node cobalt.wikimedia.org

0565b3b136-+-Bump refinery-job versions to 0.0.105 for Spark 2.4.4 upgrade

163bb47232-+-rsync stunnel: allow both cleartext and encrypted service

e8becc71ec-+-tools-static: Fix old cert absent line

1d1d031368-+-toolforge: Remove direct TLS termination support from static-server

624c4fee17-+-rsync: add option to TLS-wrap communications

200955ce58-+-aptrepo: move thirdparty/kubeadm-k8s packages from stretch to buster

a8b65271ff-+-Icinga, fix mgmt_parents hiera call for cloud

8cc7fe8d12-+-Include hdfs_cleaner an an-coord node to clean HDFS /tmp dir

71f6d54746-+-report updater job: produce Reference Previews metrics

13c73abd10-+-Icinga: add parents to mgmt devices

653bc0a593-+-ps1-b7-eqiad model setting

dab11c6fba-+-swiftrepl: add ensure

ba2a83fa8f-+-role::prometheus::beta: add memcached metrics

dca722fe6b-+-prometheus: Switch trafficserver configuration exporters to cluster_config

ee2aa81b3d-+-monitoring: add dashboard links to grafana_alert

e9275c5ab6-+-puppetmaster::frontend: remove test_servers logic

a337b74548-+-mediawiki::packages: re-add ploticus for EasyTimeline extension

5ff2bcd8db-+-prometheus: Tell between upload and text on trafficserver exporters

0a41b81d17-+-Add druid/analytics/search system users to all Hadoop worker nodes

44b1b614eb-+-bacula-director: remove unused /a/sqldata, /mnt/a filesets

48aa57e262-+-eventlogging: run sanitization script on all the db records

ef78c2909b-+-Revert "mediawiki: Temporary disable rebuildTermIndex"

92f7108cf2-+-labweb/cloudweb: fix path for backup jobs

6396dfcd97-+-gerrit: keep the mode on the tmp dir 0700

043e7c55dc-+-gerrit: ensure tmp dir under review_site exists

f655b2df5f-+-gerrit: link /etc/gerrit to /var/lib/gerrit2/review_site/etc

5558d0fc5d-+-gerrit: also monitor gerrit process on replicas

a7ba2d1460-+-elasticsearch: ensure python prometheus client in installed

b7a350802f-+-toolforge-k8s: rotate docker logs

4913919ff1-+-TLS Analytics: pick up VCL Log in webrequest

5b667ba5de-+-backups: remove bugzilla backup directory

efd71b267b-+-netops: add host monitoring for scs systems (serial console servers)

990a56c796-+-cache: reimage cp5012 as text_ats

4a819c1bd1-+-Enable idp2001 as second identity provider

2ec77a34d7-+-puppet_compiler: update permissions

a2f008c910-+-puppet_compiler: ensure all working dirs have correct owner

8a4a1b074d-+-logging: remove hhvm references

320404c4bd-+-role::analytics_test_cluster::client: add git proxy configuration

71cd7de11c-+-openstack: Update comments on pdns3hack

62b28f9ee4-+-gerrit: always include migration profile

7b33e5616c-+-gerrit: fix migration class, allow syncing data to gerrit2001

ad563e4516-+-cloud: encapi stuff for new puppetmasters

cfed4132d4-+-Remove old absented star.tools.wmflabs.org cert

e0f06dcbba-+-cache: reimage cp5011 as text_ats

32839d419f-+-cache: reimage cp5010 as text_ats

9fb6cc1544-+-hhvm: minor fix in hhvm exporter removal

f2942e0a4e-+-prometheus: remove hhvm stats gathering and stop exporters

b8337379cb-+-scapify design/style-guide microsite (2 of 2)

a14327583e-+-ps1-b8-eqiad update for monitoring

3c7b2a87c1-+-mariadb: remove cobalt from ferm_misc rules

4d4597afd0-+-site: turn former Gerrit server into a spare system

ff192dcd46-+-gerrit: allow rsync of home dirs for server migrations

f2e6a88c72-+-Refactor profile::analytics::refinery::job::import_mediawiki_dumps

5aceceb610-+-ipsec: remove check_strongswan in favor of prometheus check

bcc823f313-+-grafana: set default undef on wpt_graphite_proxy_port

985c1d16b8-+-Un-submodule for nginx: rename to orig path [2/2]

59f284e6eb-+-Un-submodule for nginx: move to prod env [1/2]

0ada9aa5d2-+-toolforge: k8s: introduce switch for etcd role

3007d6c9a7-+-toolforge: new k8s: rename node to worker

9478c593ee-+-Setup wikidata alerts from grafana dashboard

f49db142fb-+-toolforge: new k8s: rename hiera keys for consistency

3a4773217e-+-Replace old star.tools.wmflabs.org certificate with new one from acme-chief

e5b9bcc407-+-toolforge::proxy: Remove old star.wmflabs.org absent resource

18b293885d-+-cache: reimage cp5009 as text_ats

836a79b81b-+-profile::graphite::alerts: remove old Eventlogging alarms

3a5199f221-+-parsoid-php: on beta, add sudo privs for php-fpm restarts

47e3aa797d-+-labsaliaser: remove the cron entry and add monitoring

28e6d8b4a0-+-Adds hunspell-eu to ores/manifests/base.pp

3083e4b252-+-labsaliaser: wrap up the systemd timer command in a script

c37a49eb51-+-labsaliaser: switch to systemd timer and use root

e971dfbc77-+-ci: remove cobalt from firewall rules

b56dc9dca8-+-Remove now unused eventlogging::replica puppetization

ae149aadcc-+-Absent eventlogging 'replication' between db1107 and db1108

6909644069-+-Design microsite: Set the scap deploy_user to "deploy-design"

1a50be0722-+-mediawiki: Temporary disable rebuildTermIndex

325947140e-+-mediawiki::web:prod_sites.pp: Apache config for ge.wikimedia.org

683490e1a0-+-Sync geoeditors data to dumps and add links

6e9bcca941-+-kubernetes: allow full opt-out of rsyslog config

a961761a84-+-puppetmaster: Add feature flag for geoip provisioning

3a4294e59e-+-hhvm: force the removal of some directories

bb0602cd9f-+-toolforge: old k8s: refresh reference to ferm handlers

6e842aeb67-+-hhvm: remove mwrepl and /etc/hhvm/fatal-error.php

c635a55a46-+-statistics - rename published-datasets to just published

70ecc4c071-+-Swap toolforge proxies to use acme-chief certificates

ee13e52ef1-+-Install php-readline on deployment servers instead of 7.0 version

977cb79a80-+-grafana: double-proxy for wpt-graphite

94f467b27e-+-Revert "apereo_cas: migrate keystor to wmflib::secret"

345a5ce60b-+-apereo_cas: migrate keystor to wmflib::secret

ba7950de07-+-cache: reimage cp5008 as text_ats

df41154181-+-profile::acme_chief::cloud: Require python3-designateclient etc.

e461231ca4-+-prometheus::cluster_config: add $ensure in definition

58090f8260-+-Revert "lvs::monitor_services: increase number of tries before MCS is critical"

f43262cf7a-+-Revert "apereo_cas: migrate keystor to wmflib::secret"

ee357dd178-+-apereo_cas: migrate keystor to wmflib::secret

19c6d23960-+-prometheus: Add new prometheus mysqld exporter group: test

caac0e4395-+-swift: default to multiple object servers per port

9002f6dfc9-+-ATS: Set the default activity timeout to 300 seconds on ats-tls

de857d27eb-+-ATS: Disable HTTP/2 max error rate threshold

7866cb105c-+-ATS: Enforce POST size limit of 100mb on ats-tls

7dba841d2f-+-zuul: change gear queue monitoring threshold

bde882e0d1-+-requesttracker: remove rsync and special cases for jessie

ccefe010cd-+-requesttracker: rsync the database dump to new server

f456aa4f41-+-mariadb::ferm_misc: remove ununpentium from allowed hosts for RT

621bee47a4-+-site/install_server: decom ununpentium

3f45daa9f6-+-prometheus, profile: add file count feature and enable lists queue tracking

787be31d1a-+-Also pass down mfa-additional-method and mfa-force-method attributes

2785248f3c-+-filter_log: Avoid spaces in file name

ae43135885-+-profile, prometheus, role: install swagger exporter on prometheus nodes

006656767f-+-releases: remove php-xdebug

46f8141715-+-releases: expand list of packages

9128b80855-+-setting ps1-b2-eqiad model info

a8f5b5a7c0-+-Remove an extraneous 's' character

38e556b7e1-+-jessie: Downgrade to TLSv1 for backup

c0bb3fa4a4-+-Dots have meaning in regexes :P

f0cd37cd1d-+-backup: Migrate bacula director from helium to backup1001

c48bd0c0a7-+-puppet_compiler: bump puppet-compiler version

fc8d859769-+-base:puppet: update permissions on the ca

643242b925-+-puppet: manage localcacert in puppet

fa6371b2d1-+-puppet_compiler: manage facts dir permissions

532812da10-+-eventlogging::dependencies: remove py2 dependencies

1a2940e34a-+-eventlogging::dependencies: avoid absent for python-dateutil

f0a77d30b3-+-eventlogging::dependencies: absent python2 dependencies

ecece60926-+-Revert "cloudvps: ignore stderr in labs-ip-alias-dump.py"

1a32af3426-+-Fix labsaliaser script to be executable

8c41e3a80f-+-parsoid: fix path to systemctl for php-restart sudo command line

1e53ee3b2e-+-requesttracker: rename config files to have a .pm extension

e063b3f76e-+-horizon: create directory to hold the instance-puppet-user key

8599da1595-+-Horizon: set up access to a git repo to archive instance puppet config

e13322ac34-+-EventLogging refine - Unblacklist ChangesListHighlights, it has been fixed

2399aeab5d-+-adding esams pdus to monitoring

a0863eca06-+-Introduce an-airflow1001

40b2bbef97-+-toollabs: delete unused proxy code

0bf50099b8-+-puppetdb: only filter job_id on old puppetdb hosts

a9b571595f-+-dumps::web::fetches::job: update require to use directory

91c1a97695-+-logstash: remove deprecated elasticsearch options

a9d4f92cc3-+-jobrunner: rename hhvm_jobrunner_port to jobrunner_port

15d25c3e35-+-cache: reimage cp5007 as text_ats

9c6b7211db-+-hhvm: remove hhvm leftovers from apache configs

12983f81e7-+-envoyproxy: configurable route_timeout

29ed5d8355-+-toolforge: k8s: delete kubeadm keyword from things not related to kubeadm

00c3a87b1a-+-cache: add default weights for various objects

706fc39d72-+-cloud vps: Add support for Buster to LXC module

416ab7db84-+-profile::cache::base: include initialize script

372db8a87c-+-conftool::scripts: add a helper script to initialize a node

a32fd9fc0b-+-metamonitoring: skip logdir for timer

0eb9eded61-+-metamonitoring: add sync of Icinga contacts

74f35c10b6-+-ripe-atlas-eqsin-ipv6: raise alert threshold

ecd714340c-+-requesttracker: re-enable envoy if on buster

995f22ca26-+-scapify design/style-guide microsite (1 of 2)

daab056238-+-Remove old esams networking devices from monitoring

22af0c2d12-+-Puppet setup for cloudbackup2002

f6eef7e296-+-netbox: Enable CSV dump rotations.

37e295de6a-+-openstack::wikitech::web: don't include python-keystone package

cbc27801f9-+-decom multatuli in puppet

425a2c2962-+-prometheus: load text_ats varnish targets

e39784ee4a-+-bacula: Actually run the check with sudo -u bacula

05639cc0c6-+-Revert "apereo_case: use Binary for storing the keystore"

db3fb8dae0-+-bacula: Allow nagios user to execute bacula check as bacula user

62d85631ec-+-apereo_case: use Binary for storing the keystore

f63030be76-+-Decom bast3002

d743d6388f-+-ganeti3003: provision as authdns::server

18d1c7c033-+-prometheus: add text_ats mtail targets

200ebcefb3-+-Include hadoop client packages and config on dumps distribution servers

dc5d8f0d08-+-cache: reimage cp4032 as text_ats

e993864aea-+-Rename groovy script

a6f338d82b-+-bacula: Fix bacula_check.py location

146d3a307a-+-bacula: Create new backup jobs status check for icinga

a2c379da56-+-Reference the correct groovy source

37ac668f0b-+-Fix groovy_source

ca800e08dd-+-bast3002: decom phase 1

dbc0667765-+-cache: reimage cp4031 as text_ats

9b1c15a5eb-+-apereo_cas: add ability to use groovy script to determine MFA

57728b662d-+-cache: reimage cp4030 as text_ats

dcec24a9c0-+-Also use wmf-user LDAP schema on "labs" LDAP servers

a40af25efd-+-toolsdb: pin mariadb version

4432205f28-+-ATS: Provide a generic ats-{instance_name}-restart script

05477a23f2-+-ATS: Enable the SSL handshake timeout and set it to 60 seconds

57802fd83c-+-labweb: add TLS termination with envoy

bfe553cfa8-+-cleanup for old cp3007-10

87d3a26e2b-+-puppet decom for cp3030-3049

b0b36a9d8d-+-puppet decom for nescio and maerlant

6e0f5037dd-+-lvs3001-4 decom puppet removal

4231be07bc-+-bastionhost::migration: comment out rsync server, duplicate

72955ed604-+-bastionhost: fix migration class fqdn comparison, rename vars

87962e1933-+-bastionhost: recreate migration class, convert to profile

a512bd1284-+-mediawiki::webserver: disable hhvm-needs-restart cron

8f9045e5f3-+-lvs3001-4: unconfigure and move to spare

67a6cfa3bb-+-esams text lvs: 5 is primary, [13] are backups

f1adf71a5f-+-swift alerts: check over https when appropriate

437dac0a20-+-setting sentry4 for ps1-b4-eqiad

f1105a72c2-+-monitoring: alert on reduced global http availability

27b60bed8a-+-esams upload lvs: 6 is primary, [24] are backups

b7cfc12c7c-+-hhvm: fixes in removal

3b891136dc-+-hhvm: make all files and packages absent by default

81e2c69a82-+-esams cp nodes: size storage correctly

cd3a8685a3-+-puppet_compiler: install ruby-multi-json on buster for PUP-8715

9f16392ca3-+-jenkins: also update alternatives for java

79241974d5-+-jenkins: update java version for buster installs

91dc654e63-+-puppetboard: add TLS termination with envoy

a11e552012-+-jenkins: use correct java version on buster

fd82d95fa0-+-hiera,netops: Fix asw2-esams hostname

230d6d3757-+-lvs300[567]: LVS puppetization

c540f646d3-+-puppet: clean up unused parameters

847cc7412b-+-Add asw2-esams to monitoring

d44b47b67f-+-parsoid: actually support safe restarts at deploy time.

cf9a3e6c48-+-site.pp: Remove puppet references for db1070

6ece1c8075-+-Basic install for new esams hosts

e5982df8ed-+-webperf: add backups for arclamp application data

291dbe4a2f-+-gerrit: increase heap_size from 20G to 32G

217f033c56-+-parsoid: switch command with sudo rule to check-and-restart-php

aa635eda51-+-parsoid: allow restarting safely php-fpm during deployments.

e2db098cb5-+-Revert "jenkins: use correct java version on buster"

8be447cb4b-+-jenkins: use correct java version on buster

cd0882c794-+-toolforge: add package and service deps to etcd profile

13066e9b8a-+-Rename cr1-esams to cr3-esams (same IP, new box)

bb07bf3416-+-toolforge: k8s: haproxy: tell the service to load all config files

436cd6c224-+-toolforge: k8s: haproxy: don't use haproxy base module

6ac0c444c8-+-puppetdb: enable multiple service urls and command_broadcast

9c0f32db52-+-graphite: add TLS termination with envoy

b9ae5f6a09-+-ATS: Send "100 continue" responses on the ats-tls instance

7c1dab1a80-+-dbmonitor: Install the right apache modules for buster

866d2257f7-+-dbmonitor: Deploy git repo as mwdeploy, otherwise no write permission

9bd1d325ab-+-mariadb: Remove puppet references from dbstore1001

8afa59462c-+-mariadb: Remove puppet references for dbstore2002

39d1cd14b2-+-ATS: Adjust timeouts in ats-tls and ats-backend instances

2bc88c0d98-+-wiki replicas: Add the labsdb1012 replica to maintain_dbusers

553ca03db1-+-gerrit: add colordiff package

9ed0caee52-+-host monitoring: add optional contact group for mgmt interfaces

e838c6163e-+-openstack: patch python-designateclient header values

0b200b6701-+-Gerrit: Remove All-Avatars from gerrit's module

ae70789823-+-setting new pdu models

c61aa1642a-+-mariadb/ferm_misc: allow moscovium to connect to rt database

bca296a328-+-dbmonitor: Install the right apache module packages for >jessie

29de8970e7-+-toolforge: rename k8s::apilb role/profile to k8s::haproxy

1455a2d421-+-ATS,tlsproxy: Reload TLS material on acme_chief::cert updates

e5e9cbb915-+-kibana: add TLS termination with envoy

b95edd7bcf-+-logstash: config readable by logstash only by default

6a619a598a-+-swap: Redirect stderr to /dev/null to prevent cronspam

ad6579f596-+-ATS: Use a common base path for /etc/ssl and /etc/acmecerts certs

f0b32f2e02-+-mariadb: Set db1070 to spare

69b939ec6e-+-site.pp: Remove puppet references for db2060

a212d56ac8-+-mariadb::ferm_misc: allow connections from gerrit1001

d10c7513d1-+-gerrit: gerrit::migration coexist with ::gerrit

e354367b73-+-Gerrit: Rsync /var/lib/gerrit2

a6de50eeab-+-Revert "gerrit: add role on gerrit1001 and remove gerrit::migration"

479c0218ed-+-Add Icinga check for monitoring correct application of CPU microcode updates

635697765f-+-swift: use systemd::timer::job for swiftrepl

83aaa5feaf-+-profile::base: add adduser module to profile:base

5155de9fe2-+-decomission rhodium: completely remove rhodium from puppet

32cefc1499-+-decommission rhodium: move rhodium into the spare::system role

ff6f7e8c82-+-swiftrepl: ensure system user and service runs as 'swiftrepl'

81e3878bf5-+-wdqs: TLS termination with envoy

3231f62ac7-+-swift: use resurce for swiftrepl tidy

97bb0544dd-+-site: turn on swiftrepl on swift frontends

e1ea7de22c-+-cache: reimage cp4029 as text_ats

515829a4c1-+-site.pp: Remove puppet references for dbproxy1006

fcd970f4cb-+-lvs::monitor_services: brown paper bag fix

c85e766a64-+-site.pp: Remove db2053 from puppet

fe5e47fff4-+-Reduce arclamp .log file retention from 90 to 45 days

55eca390fe-+-cassandra: Pin Cassandra packages to version 3.11.4

3c590bfcb0-+-Remove remaining eeden puppet references

c7243a9ef6-+-toolforge: reintroduce profile::toolforge::k8s::client

74ca6bd1ff-+-profile::backup::host: Add the ability to configure ferm rules

5a6eb5d3f0-+-lvs::monitor_services: fix the echostore stanza

d24db14a11-+-echostore: add LVS configuration stanzas

4e8f741e07-+-toolforge: refresh puppet code for the new k8s

893a9debed-+-profile: sanity checks for cluster

0ddd2bbd8f-+-cache: reimage cp4028 as text_ats

f0d4e41694-+-site.pp: Remove references to db2059

7648af318b-+-labtestwikitech.pp: Specify the new location for labtestwiki

6c1148dbd6-+-requesttracker: use mod_scgi instead of mod_fastcgi on buster

d066e520ec-+-requesttracker: install libapache2-mod-perl2 on buster

47881abb3f-+-site: add requesttracker role on moscovium on buster

e1664a7cc3-+-codfw1dev: correct lookup for the nova proxy ldap password

f3a7faf221-+-site: add moscovium.eqiad.wmnet as a spare system

888da413bd-+-clouddb2001-dev: open firewall for cloudweb to access the database

2b10d39fce-+-updating pdu model for ps1-a8-eqiad

8dcdc71c99-+-netbox: add max-requests parameter to uwsgi

af2ddf1e1f-+-logstash: apply throttle filter to all log levels

4330ee35fc-+-Revert "cloudweb2001-dev: remove wikitech profiles"

66b3d93711-+-swift: add swiftrepl

fb6e980beb-+-openstack: update eqiad1 clients to wikimediacloud auth url

017825e48c-+-ATS: Pick the unified cert using hiera key public_tls_unified_cert_vendor

87f2756544-+-puppetdb: remove activerecord db settings from servers using puppetdb

6977ff308a-+-cache: reimage cp4027 as text_ats

2bc9358bd5-+-ATS: include tls profile in cache::text_ats role

17cbc16d1e-+-openstack: drop jessie code

8e73392ab1-+-labpuppetmaster: Remove remaining puppet references

b44f9e0086-+-mariadb: Allow installation of es1020-es1025

ccd413125e-+-reportupdater::jobs::hadoop: Add wmcs job

a3202fb684-+-site.pp: Remove puppet references for db2052

93330568b6-+-site.pp: Provision new hosts as spare

b5c3737123-+-Workaround for GenerateFancyCaptcha not running as expected in prod

3669026795-+-Upload versioned Spark assembly file to HDFS

5c2552e164-+-parsoid: also include php restarts profile

c670226f9a-+-bacula: Fix error on bacula director install for older hosts

19de4fd798-+-bacula: Force install bacula-director, not a dependency on buster

ae0916ca58-+-archiva: ensure /var/run/archiva

6bacbbab89-+-Revert "profile::pupetmaster::frontend: manage ca.pem used in apache config"

c0b51662a4-+-Add DHCP config for idp2001

6beb7df34e-+-puppet: update serialization format to json

ac24942cd8-+-profile::pupetmaster::frontend: manage ca.pem used in apache config

0293296b8a-+-Logrotate fastnetmon logs

d0d90abd63-+-hhvm: stop hhvm service from all hosts

043ce76957-+-profile::base::puppet: move defaults to hiera

f6b8acd4c6-+-hhvm: stop monitoring hhvm

8d00386a33-+-profile::base: remove puppetmaster parameter

24380fd7a1-+-adduser: create module to manage /etc/adduser.conf

1a7b9e1709-+-site.pp: Remove puppet references from db2066

69f770ccf5-+-keystone: change monitoring some details to email rather than paging

96610b2adb-+-Set up presto single node on analytics1030 in hadoop test cluster

da2882db8d-+-nova-fullstack: add puppet cert monitoring

ac79c1da67-+-cloud puppetmasters: allow nova controllers to use the certmanager account

04804a5187-+-ferm: remove hadoop_masters from puppet config

f42ce67157-+-toolforge: introduce new proxy role

4482ac7b54-+-Remove remaining Puppet references to graphite2001

36e1ced996-+-profile:bird::anycast_healthchecker_monitoring: add python3-docopt

830705e477-+-mariadb: Remove dbstore2001 references

d4a2420655-+-site.pp: Remove puppet references for db2051

61e9ae15e0-+-Remove unused/unnecessary passwords::postgres include

d59d853d9c-+-mediawiki: Split cronjob for updatequerypages to multiple modules

33b0e44724-+-mariadb: Promote db1100 to s5 master

99e0382250-+-Install python3-lib2to3 on buster

e99f4c4dee-+-Add component/cergen to cergen class on buster

99fae3d083-+-Actually install pbuilder hook

299a091b90-+-mediawiki: remove the PHP/HHVM conditionals from the code

9bd3822281-+-lvs::monitor_services: increase number of tries before MCS is critical

cb8ade30ad-+-toolforge: Remove updatetools script

081df0a0e3-+-puppet: change $::cluster variable to a hiera default

df1ceb0cd8-+-profile::analytics::cluster::client: remove old code

2504d2ec4e-+-mariadb: Remove db2068 from config

5f92ec21b0-+-role::analytics_cluster::zookeeper: enable monitoring

447becd9fe-+-eventlogging::dependencies: remove python3-pykafka dependency

102acb03ff-+-toolforge: aptly: add buster-toolsbeta repository

b7d84f45eb-+-eventlogging::dependencies: add python3 dependencies

61ec1a0a2d-+-toolforge: aptly: add buster-tools repository

87970faeef-+-PDUs: add model sentry 4 to eqiad b1 and a2

aa262204eb-+-site.pp: Remove db2056 from puppet

39550dfaa3-+-phabricator: install s-nail instead of heirloom-mailx on any distro

c13b5f5505-+-Phabricator: Remove support for mod_php and default to php-fpm

900a02bcc4-+-profile::kerberos::kadminserver: fix typo in monitoring

072825dcbd-+-Ensure eventlogging-consumer mysql is absent on eventlog1002

794aacc04d-+-beta: dont include scap::scripts twice

7bcfe6dea1-+-remove references to no-longer-in-use labpuppetmaster1001/1002

196cde67ac-+-kerberos: ensure resources that might change during failover

99f5625d95-+-Bumping up refine to newest version

e68c6b85f4-+-kerberos: add nagios process monitoring for kpropd

e37272aaa6-+-kerberos: ensure kadmind and rsync only on the master node

95dd62643e-+-kerberos: add nagios process monitors to kdc/kadmind daemons

d4d9c19d1e-+-site.pp: Remove db2063 from puppet

9b4a0446a7-+-site.pp: Remove db2057 puppet references

a3487fd00c-+-phabricator: install s-nail instead of heirloom-mailx on buster

13f23a7016-+-phabricator::httpd: support stretch/buster with/without php-fpm

610d17bc36-+-phabricator: support buster with PHP 7.3 packages

000f656b9a-+-wikitech: switch runtime from HHVM to PHP 7.2

e63634985a-+-toolforge: apt_pinning: add Buster support

12e18816ec-+-profile::analytics::cluster::users: ensure user druid

1273587c89-+-certgen: only use install options on jessie

aca35b7325-+-Restrict NTP servers to production networks (including frack and network gear)

4d0d873720-+-puppet::rsync: disable chroot on volatile and ssl rsync

a281e6c187-+-auth1001: Remove remaining puppet references

e8bf01e93f-+-Fix sessionstore lvs monitoring typo

348a2c4d9c-+-site.pp: Remove puppet references for db2069

93df95ac98-+-site/phabricator: apply phab role on phab1001

582f9e8fd1-+-Fix phatality deployment script

2a8b693d2c-+-lvs::monitor_service: partial refactoring

56847d8d71-+-profile::analytics::refinery::job::test::druid_load: use analytics1041

ee0e7921bb-+-profile::analytics::refinery::job::druid_load: add kerb support

e8204bd83e-+-reportupdater: fix typo in config-file param

25723db306-+-role::analytics_test_cluster::coordinator: add druid load

5b97553ed6-+-bacula: Change pool/storage names for new bacula director

bef3266a95-+-ORES: Make redis AOF configurable

f7ddf50c15-+-mediawiki::packages: remove packages for math rendering

30b8a5c85e-+-Remove tmpreaper from mediawiki servers

e804302ef3-+-profile::kerberos::kdc: add support for bacula backups

923c70adce-+-site.pp: Remove references to db2058

66dfeb93c7-+-gerrit: Remove master_host variable from profile::gerrit::server

46cddd1d23-+-role: fix Prometheus global metric relabel config

9e5a4b04f3-+-role: drop Thanos labels from global Prometheus

171f1a79a8-+-logstash: parse nested json from mmkubernetes

6f152e4b64-+-nova: don't install nova libvirt originals on cloudvirts

220b4e388b-+-::reportupdater::jobs: Migrate MySQL jobs to Hive

6c372cc300-+-reportupdater::jobs::mysql.pp: Absent jobs affected by migration

ba6d236f88-+-Openstack: move eqiad1 glance/keystone/nova/neutron to Newton

3a694bf021-+-Remove old Toolforge Clush master files

ebae8afaeb-+-bacula: Add conditional storage device setup

753a2fa36a-+-backups: Change file owner of bacula storage&director config

affd18cf03-+-eventlogging::analytics: remove specific python-kafka constraints

6b96d00958-+-mariadb: Decommission dbproxy1006

68061e9bde-+-site.pp: Remove references to db2055

b4b9093ee6-+-Deployment servers: install pygerrit2 for python3

aed6a9232b-+-cloudbackup2001: make a backup server

adf365ff68-+-labstore backups: make backup interval configurable with hiera

52557dabfd-+-profile::eventlogging::analytics::server: allow to specify python-kafka version

4957d9ff5e-+-wmcs: monitoring: cleanup unused puppet code

9213b4d9cf-+-Decommission kerberos1001

d95729eb8c-+-site.pp: Remove references to db1071

682c171d65-+-gerrit: add role on gerrit1001 and remove gerrit::migration

844af80ed4-+-openstack: update codfw1 keystone clients for wikimediacloud domain

cc32662561-+-reportupdater::jobs::mysql.pp: Absent flow reports

25c988e76b-+-designate: remove mitaka files and templates and a mitaka-specific arg

5fee918640-+-Revert "openstack: set glance image dir permissions on controllers"

2c95929200-+-openstack: set glance image dir permissions on controllers

6ea2b87dcd-+-parsoid: introduce parameter to use parsoid/PHP

1c4d8f6315-+-Deploy inactive digicert 2019 unified certs

485ac67144-+-Revert "openstack: set glance image dir permissions on controllers"

ea200bcbd2-+-openstack: set glance image dir permissions on controllers

9dcd0c6a51-+-Revert "Revert "rsyslog: populate kubernetes configuration""

fe59910434-+-profile::analytics::refienry::job::project_namespace_map: fix syslog id

544db3f629-+-openstack: glance: image_sync: cleanup unused cron

23c80f1cc3-+-site.pp: Remove db2050 from puppet

a43fe34eaa-+-Revert "gerrit: add role on gerrit1001 and remove gerrit::migration"

aa214952c4-+-gerrit: add role on gerrit1001 and remove gerrit::migration

780ab65a69-+-toolforge-kubernetes: restructure pod security policies

b4dba75e70-+-logstash: throttle duplicate normalized_message with level:ERR*

da96cc9ae6-+-wikistats (cloud): fix duplicate declare of mariadb-server package

dc0c77b429-+-wikistats (cloud): fix template path, refactor db, httpd to profiles

dbd46e888d-+-wikistats (cloud): add deployment info to motd

15d07ae99e-+-Add ensure parameter to dumps::web::fetches

510071e4ca-+-web::fetches::stats.pp Absent mediawiki history rsync

022a0ad108-+-mariadb::packages: support buster, drop libmariadbclient18

257fdf68c3-+-analytics:refinery:job:data_purge: Re-enable deletion of geoeditors

07992390a3-+-elastic1017: Remove puppet references

51755ac200-+-elasticsearch: move rsyslog profile to cirrus profile

9f2c3115c0-+-service-checker: bump to python3 version on stretch+

33e16ef3a1-+-profile::kerberos::replication: add AAAA ferm rules

251c3526f9-+-site.pp: Remove db1073 references.

cb171adcd3-+-gerrit::migration: add base::firewall, rm superfluous ipresolve line

eb41b2bda7-+-gerrit::migration: add firewall hole for rsync over IPv6

d0e5cf2e10-+-gerrit: install openjdk dbg package

d020c7638e-+-gerrit::migration: ensure user exists and sync has right owners

86f259056d-+-openstack: increase arp cache table for cloudnet hosts

35e19ddff4-+-gerrit::migration: ensure data dir exists and is configurable

eed7a51772-+-gerrit1001: allow rsyncing Gerrit data from cobalt

f532605483-+-dologmsg: ensure the directory exists before trying to add the man page

abdbd0e442-+-swift: open per-port object server ports

dd13903f1c-+-gerrit: G1GC tuning. Increase NewGen space

54412b8679-+-ores: Alert on aberrant amount of celery workers

a70bfe1f12-+-config-master: ensure perms on puppet-merge sha files

01ab422da5-+-profile::kerberos::replication: fix kprop acl file

8c711cfea0-+-profile::kerberos: add missing service resource ensure

39a5b993f9-+-Remove analytics1032 from puppet

619ec4068f-+-site.pp: Remove references to db2054

72eed76a48-+-wikistats (cloud): support buster with PHP7.3, httpd module

8313d91b45-+-wikistats (cloud): support buster with PHP 7.3

b77b6980af-+-openstack: neutron: newton: customize l3_agent_hack manifest for newton

081ccac301-+-wikistats (cloud): set host_name to $::fqdn

728e5d6706-+-Add ferm rules for presto ports

9fa6d71518-+-Gerrit: Introduce 'is_replica' paramater and rename slave_hosts

85f40f3fef-+-openstack: move haproxy exporter to controller role

7edfa62d64-+-Gerrit: Support java 8 under buster

4204349bdf-+-Set up Presto on an-presto nodes

e8dfbd869d-+-dologmsg: add manpage

1197ebe335-+-grafana1002: autoinstall/netboot/role data

b5c774d4c8-+-Revert "rsyslog: populate kubernetes configuration"

4ee4c04549-+-wmcs postgres: make 'includes' an array

7a96cc3d70-+-openstack: add designate to eqiad1 haproxy

40c0441645-+-rsyslog: populate kubernetes configuration

4553bbddc5-+-Blacklist MessageGroupStatsRebuildJob from Hive refinement

f8e6d6c7c0-+-profile::kerberos::kadminserver: add motd

dca4ba86f1-+-profile::kerberos::replication: whitelist the correct krb host in ferm

cf0be74b2a-+-profile::idp use correct variable names

7ece318d7a-+-apereo_cas: configure to used MFA based on ldap group membership

5fefcae582-+-Remove some old Trusty/Jessie stuff

8d1286174a-+-homer: cleanup absented resource

864f858630-+-Homer: setup private repo

5fea3e5343-+-profile::swap: automatically remove jupyter trash files

5331a0908d-+-site: merge mwmaint servers into a single stanza

9a9807ba71-+-memcached: add the (now required!) notes_url arg for nrpe_monitor

92fcc162c7-+-openstack: fix nova standby host in designate ferm rule

13924c43ac-+-profile::kerberos::replication: fix typo

3595112b17-+-openstack: add desginate API ferm rules to haproxy

503a660ca3-+-toolforge: k8s: haproxy: add proxy redirection for nginx-ingress

9fe42d8a48-+-noc: switch catch_all to php-fpm

d1f8080af2-+-site.pp: add role::kerberos::kdc to kdc2001

a7b02835d1-+-site.pp: Remove references to dbproxy1005

0b54bf608d-+-swift: introduce servers_per_port for object-server

30e896c7ed-+-site.pp: update comments for krb2001

4fb711e892-+-rsyslog::config: Support passing a file mode

af6b54079b-+-site.pp: Remove db2047

99e17ca5bf-+-rsyslog: Support adding cee tag to input file

276dbb45ad-+-rsyslog: Support adding metadata to input, default to off

cbc25d31f9-+-rsyslog::input::file: Fix regular expression

e10b88745c-+-mediawiki: fix and comment alerts based on logstash metrics

227067fa09-+-mediawiki: Make the rebuildItemTerms script slower

483309c654-+-analytics::refinery::job::Refine: bump up refinery jar version to v0.0.101

fbf3c436c4-+-Use correct database name for PuppetDB Postgres replication check

83de05ca0a-+-Switch auth1002/auth2001 to role::test

08624cf533-+-Remove absented python2 libs from Analytics profiles

4c7ea74d28-+-novaproxy: support hiera config for blocking ips, user agents, referers

d0d8f23d60-+-Homer, remove rsync

2ace1f3475-+-Start mediawiki_analytics camus as a with a new history, include api-request

4c8c0b4758-+-Homer: add bash wrapper to make it easy to run it

ef9641ac7a-+-openstack: add designate to haproxy

218a5884c9-+-openstack: update haproxy ferm rules for remote services

da425f7fb6-+-Homer, add make package for scap deploy

944dad8016-+-dumps::manifests::web::fetches::stats: correct path for mediawiki history

c3f0e69af8-+-Rsync analytics mediawiki history dumps to dumps.wikimedia.org

14246542a9-+-Homer, use deploy-homer user for deploy + fix files perms

85d95c29a5-+-krb2001 install params

9029692600-+-Add role::kerberos::kdc to krb1001

3bf94a1b75-+-profile::analytics::cluster::packages::hadoop: absent python2 packages

529033d0c0-+-profile::analytics::cluster::packages::common: avoid absent python-yaml

c84afc652e-+-Remove Python 2 packages from Analytics Client nodes

fd26642bf5-+-Script to upgrade phatality

0c4f543a80-+-nrpe::monitor_service: Make notes_url optional for ensure=absent

90dcc04ff9-+-homer: add missing dependency virtualenv

ed184e7672-+-Deploy homer

38c324489d-+-site.pp: Remove references to db1063

726a39c753-+-Remove ferm rules for labpuppetmaster

e8cfbd4f33-+-site.pp: Remove all references to db1066

18b68c3894-+-prometheus::node_amd_rocm: use Python3 deps

55d3769ec4-+-prometheus::node_puppet_agent: use Python3 and its deps

ea46ff9d2c-+-mariadb: Promote db1138 to master

a9bbb4f091-+-Fix maintain_dbusers class lookup

6ba654f736-+-profile::analytics::cluster::packages::statistics: add python3-mock

b49f35f64d-+-role::prometheus::analytics: add Analytics Zookeeper cluster's metrics

0aa87c2cd2-+-Decom ms-be201[345]

dd6334c3e7-+-profile::zookeeper::server: enable prometheus metrics by default

de0487c461-+-Revert "profile::zookeeper::server: use openjkd-8 on Buster"

e7ad023c1f-+-profile::zookeeper::server: use openjkd-8 on Buster

26ce444fb6-+-kibana::phatality: fix sudo line

254ba2bc67-+-LVS for RESTRouter.

0a27e90d37-+-profile::analytics::refinery::job::data_purge: remove absent timer

66dab8cf8c-+-Allow file:// in the kibana-plugin install command sudo rule

ea9bca63b0-+-profile::prometheus::alerts: add monitor for netflow realtime druid data

52a0b1bd8e-+-kibana: switch to user kibana for phatality plugin-install

52d87973f2-+-openldap_corp: Hierarize existing setup to allow adding a second server pair

3027fbd20c-+-Set up scap target for deploying the phatality plugin into kibana

3e80c91cd2-+-mariadb: make core_test hosts not page on replication/process issues

84f5ded27d-+-reportupdater::job: use python3 in the systemd timer

2d0ae5918d-+-mariadb: Remove db1072 from puppet

6bc5817a8c-+-mariadb: Remove entries for db2037-db2041

3e6ec788ef-+-mariadb: Remove db2035

6a38c52ddc-+-gerrit: get LDAP server from ldap_config, use ro server, simplify

fb0414dd1b-+-openstack: Update backend API ports for haproxy

ff618eaf44-+-openstack: configure haproxy for eqiad1 APIs

47bc1ac0c9-+-Temporiarily disable monitoring of camus api-request import

22d7f6ea7d-+-icnga::cas lower http::site priority and correct error path

2c40ad649c-+-Kafkatee, mask default (package provided) systemd service

a6078d5a29-+-icinga::cas: use unique ssl certificate

30875054d6-+-Make accessStrategy configurable in the service definition

25d4b27edb-+-prometheus: tweak widespread puppet failures thresholds

09a62d2c35-+-wdqs: cleanup logging config after switching to new pipeline

b8ff6bec9e-+-Add ferm rules to allow bacula backups for Matomo and Analytics meta

060784e326-+-mariadb: Remove db2036 from puppet

7c2dbff1e7-+-puppetmaster::frontend: add locale backend and promote puppetmaster1003

8ccc9867e6-+-Write the service ID to the JSON service defition

f99a10bc43-+-profile::java::analytics: correct relationships with Exec

0ee21abf9b-+-profile::java::analytics: deploy openjdk-8 on Buster

0965947c24-+-Fix path name

f1e7280d55-+-base::puppet: add preferred_serialization_format = pson

b3c0040237-+-Revert "Set up scap target for deploying the phatality plugin into kibana"

07e2aecb13-+-Set up scap target for deploying the phatality plugin into kibana

e999ac6582-+-mariadb: Decommission db2046

48456b9e3e-+-mariadb: Decommission db2049

d8e8a6f61c-+-mariadb: Remove db2044 from puppet

1573532825-+-mariadb: Decommission db1066

d9fbeb9f08-+-profile::analytics::refinery::job::druid_load: add dims to netflow

d2a967fdca-+-mariadb: Promote db1123 to s3 master

53880b1359-+-Create new camus job for mediawiki analytics events

17a7082815-+-Fix timer interval for camus::job { 'mediawiki_events

029528e143-+-camus mediawiki_events - increase map tasks to 50 and run in essential queue

b0412df342-+-openstack: configure eqiad1 keystone for apache wsgi

638abf7140-+-krb1001 install params

991ccd034e-+-Revert "puppetmaster::frontend: add locale backend"

87e46f0f96-+-Neutron: add newton manifests

86a3e528b1-+-openstack: add keystone URIs to neutron in newton

ca91b7bc21-+-puppetmaster::frontend: add locale backend

04dcce2f9a-+-netops: add proxy for ripe-atlas-tools, fix atlas user

aaa364bcff-+-elasticsearch: decommission elastic1017

dffa2be6d4-+-icinga::cas: fix cas errors and add spec test

0b68a9992c-+-icinga::cas add ssl_settings

e73733643d-+-icinga::cas apply correct type checking

e09642c02e-+-icinga::cas: fix incorrect attribute name

570864c3c0-+-profile::icinga: Add apereo_cas authenticated vhost

7fc72fd498-+-Add pbuilder hook to build packages with/against forward-ported JDK 8

c49f3ed208-+-Convert openldap/corp to profile

0e00241097-+-install_server: Reload nginx instead of restarting it on cert updates

5daf5105b1-+-acme_chief: Simplify notification handling on acme_chief::cert

8a9bc072d5-+-ncredir: Notify Exec[nginx-reload] instead of Service[nginx] on cert changes

883691dc91-+-acme_chief: Allow specifying a custom resource to get notified on cert updates

b3d89a1a76-+-facilities: add phase monitoring for single phase PDUs

059e909214-+-swift: point Prometheus alerts to the their site

adcf501750-+-ATS: Move libhwloc5 pin to trafficserver class

15c4309302-+-cache: Deploy ats-tls in the text cluster

6bed34486e-+-ATS: Provide HTTPS check

a315257dec-+-ATS: Unmask trafficserver.service iff it's actually being used

79d5cb85b4-+-Keystone/newton: explicitly exclude the python-ldap package

148f4e8a51-+-set start date for partial dumps back to normal

e462a23ea7-+-zuul: mask service when not enabled

fd9a37deca-+-Revert "zuul: mask service when it is disabled"

fa749b0713-+-zuul: mask service when it is disabled

2c135023ab-+-Add python-pygerrit2 to scap master

a16fed16a1-+-openstack: add haproxy prometheus exporter

f6c2e576cf-+-role: add ripe atlas cli to cluster::management role

9f6c3a1ed9-+-netops: add ripe atlas tools class

99db233675-+-contint: pin Docker on stretch

0c61554ec9-+-apereo_cas: add icinga service

3d3e5dfe25-+-profile::icinga: update to use lookup instead of hiera

de568f38d8-+-prometheus - bastion: use per-resource default attributes not resource defaults

e2ec4f60e5-+-backups: Fix wrong dependency on buster bacula storage servers

7016c155cb-+-backups: Install bacula-sd instead of the sql variant on buster

e1ed9b7abf-+-Adds git::lfs class and include it respectively

e7f299906d-+-backups: Setup new director and storage daemons hw in parallel

06b7fac16f-+-ATS: Adjust OCSP freshness check for acme-chief managed responses

2b35e32622-+-Remove site.pp entries for neodymium/sarin

2c9cd5f4f3-+-prometheus: alert on overall puppet failures

5329cb2129-+-db2043: Remove it from puppet

20cc2c9b35-+-bacula: Make bacula db parameters configurable on hiera

e1ed4a1bac-+-install_server: Fix https check_command

f0fb55f04e-+-install_server: Enable OCSP stapling and SSL monitoring

a5b4ca7fe3-+-delay start of xml dmps for one day while wikidata run finishes up

f4c12c8654-+-Revert "gerrit: add role on gerrit1001 and remove spare"

0f10552b4a-+-gerrit: add role on gerrit1001 and remove spare

973a48774e-+-hiera: disable statsd_exporter::relay_address on logstash nodes

a9ba48f7c8-+-racktables: set db host in Hiera, set to eqiad, use lookup

67968bf39c-+-wikimania_scholarships: set db host in Hiera

e402f21471-+-iegreview: set db host in Hiera

1f98b0c300-+-designate monitoring: remove def for designate-pool-manager monitoring

7e056f2dcc-+-designate: update monitoring for producer/worker model

a33caf930d-+-designate: ensure designate-zone-manager is not running

9cf2a31209-+-designate: switch to the worker/producer model

0762bf6973-+-site: allocate mw1298 as a jobrunner, add to conftool

0bc9087e44-+-Pmacct, add source and destination countries based on GeoIP DB

c4dc5b5368-+-codfw backup LVS: BGP sessions with both routers

f198f9ee63-+-Purge CheckUser logs every day rather than weekly

a5d4776356-+-Remove remaining Puppet references for iron

4470c4840a-+-RESTBase: Configure wikifeeds_uri

67f73ffc23-+-Decom lithium

8a0b225a2b-+-ATS: Provide websocket support

6fda2d6647-+-ATS,tlsproxy: ocsp parameter for acme_chief::cert is not needed anymore

8270b61a44-+-acme_chief: Remove update-ocsp.d leftovers

2565ac4e3d-+-wdqs: switch production clusters to new logging pipeline

8b302b1f0b-+-acme_chief,ATS,tlsproxy: Move to acme-chief centrally managed OCSP responses

bf3cdbe00b-+-mariadb: Decommission db2055

8c93ba309f-+-profile: use prometheus for logstash alerting

15c553a875-+-openstack: add codfw1dev keystone APIs to haproxy

7a36b4e7a9-+-site: remove krypton.eqiad.wmnet

419132f86b-+-Openstack/Newton/Stretch: more config for keystone, designate, nova

27d54c0b6e-+-facilities: set model for ps1-b3-eqiad

80ced5cad7-+-Remove absent job camus eventbus

ed093084ba-+-Don't render camus::job properties file if not ensure => present

244bd14ecd-+-Use $ensure param for camus job properties file

e8f466f09c-+-Rename camus job eventbus to mediawiki_events

94f0d884fa-+-Remove absent job eventlogging_eventbus_job_queue

b6ce4af9db-+-graphite: use per-resource default attributes not resource defaults

61ba2f69bd-+-swift: use per-resource default attributes not resource defaults

025e862515-+-Rename some analytics related eventbus jobs

cd52628c85-+-facilities: support sentry4 for 3 phase monitoring

99aadfb60a-+-Rename 'eventbus' grafana alerts and notes_urls

79a1c9265e-+-Remove unused eventbus puppetization

fb5a8005f9-+-openstack: configure apache wsgi for keystone api

28e91e69db-+-wdqs: setup new logging pipeline

24cde94d39-+-envoy: add command-line options to be used for zone-aware routing

09ec60e01e-+-prometheus: make statsd.relay-address toggle-able

cef2896a8d-+-kafka-main: move kafka1003 to role spare system

08fd55d16a-+-site.pp: rework the regex pattern for the Hadoop test cluster

e4aa7e28fd-+-Switches ores.wmflabs monitoring to use new ores-web-(04,05,06)

a426ba7c26-+-tools-prometheus: add clouddb100[12] node targets

c8c2357fcf-+-anycast recdns: enable globally

55e4f148a8-+-kafka-main: replace kafka1003 hardware with kafka-main1003

ccbca32af6-+-tools-prometheus: Update toolsdb target file extension

83ab2190be-+-tools-prometheus: add toolsdb mariadb metrics

67e939f203-+-Prepare analytics1032 for decommission

23c16a59d9-+-Ad-hoc Cassandra clusters for deployment-prep

8b043242c7-+-Parsoid: Change the beta port to 8001 to avoid conflict with PHP7

c08a30c922-+-mariadb: Decommission db1063

9004387e31-+-profile::mediawiki::php: Add rlimit_core php.ini variable

4e5e748a6b-+-ATS/acme_chief/varnish: remove wikiba.se

5b526a30b1-+-profile::mediawiki::common Enable systemd-coredump on all mw servers

42025493d6-+-Revert "profile::mediawiki::php: Add rlimit_core php.ini variable"

ec72ebfd39-+-profile::mediawiki::php: Add rlimit_core php.ini variable

bd58cefcf4-+-mariadb: Promote db1122 as s2 primary master

404a23b6b4-+-mediawiki: Remove loadExitNodes.php maintenance script

6e58361da3-+-mediawiki::maintenance: remove TorExit node periodic job

6c70ece462-+-kafka-main: move kafka1002 to role spare system

653278ddc0-+-Revert "mediawiki: Disable loadExitNodes.php maintenance script"

55eafb2647-+-LibreNMS: use proper permission

ae9b971f99-+-LibreNMS: fix more files permissions

73ebec4ef4-+-kafka-main: replace kafka1002 hardware with kafka-main1002

363f0f121b-+-Add LVS for wikifeeds

04a52766b5-+-cloudweb2001-dev: remove wikitech profiles

fa5a8b5fba-+-mediawiki: Disable loadExitNodes.php maintenance script

389ee2e864-+-Move labpuppetmaster1001 and 1002 to role::spare

8a4d9b2101-+-calico: Enabled felix prometheus endpoint

e17b8789ed-+-prometheus-ipsec-exporter: subscribe service to /etc/ipsec.conf

5d766691ce-+-thumbor: stop relaying to statsd/statsite

1ddac0d0b9-+-mediawiki: Start rebuildItermTerms for wikidatawiki

663d5b4fd8-+-profile::mediawiki::webserver: ensure cron_splay is called correctly

5d492c42a5-+-ncredir: Monitor TLS handshake + OCSP stapling for every configured cert

08c6e79817-+-ncredir: Check OCSP stapling on HTTPS icinga check

d536db87e0-+-systemd: Add support for coredump.conf

5f7fe02e1c-+-statsite: don't enable service when statsite is absent

de005eb6d5-+-ATS: Fix check for do_ocsp

ee57d59842-+-statsite: set ensure for instance config file

a996d7bf1c-+-statsite: support for ensure/removal

7933a9949a-+-mariadb: Productionize dbproxy1021

e52dd0851d-+-mariadb: Decommission db2054

250308b73f-+-codfw1dev: First pass at building out cloudweb2001-dev

61c0644c01-+-site: apply spare::system role to phab1001

8ae9b10675-+-Phabricator: Make a separate hiera option to ensure phd stopped/running

ec3558ba48-+-gerrit: do not link to mysql-connector-java.jar if on buster

f98d40d5f9-+-profile::kerberos::kdc: add debconf settings

63f157b270-+-Puppet CAs: rename a local '$puppetmaster' variable

a715986e5f-+-eventlogging: move comment about python-kafka version

d64b1a37db-+-eventlogging:dependencies: allow to specify python-kafka version

0e32614d55-+-mw-maintenance and scap: Revert changes for PHP7 transition

afacbea75a-+-In PHP FPM, enable process.dumpable everywhere

c89ef78714-+-Add role netinsight to netflow2001

a575b08e59-+-requesttracker: comment out envoy inclusion for now

98042fcb74-+-Bumping up jar version to correct typo

8dae212e53-+-gerrit: switch from mysql to mariadb db driver if on buster

f1d55fce1b-+-gerrit: switch JDK package to version 11 if on buster

bf99b02143-+-LibreNMS: fix new deployments permissions errors

218dd6517d-+-ci: allow ssh from new gerrit server gerrit1001 in ferm

261a2df97f-+-Revert "Temporarily connect all eqiad pybal to cr2"

038f875d64-+-Revert "Temporarily connect all eqiad pybal to cr1"

506f6de43b-+-Ensure python-kafka at 1.4.1 on eventlogging server

e807850aad-+-Temporarily connect all eqiad pybal to cr1

a20728029a-+-prometheus: switch to per-site aggregate ipsec checks

4e62a88731-+-Generalize Piwik's db backup profile for Analytics

87c28014d0-+-Temporarily connect all eqiad pybal to cr2

b41c8c297d-+-debconf::set: use set-selections instead of communicate

97fa6eeed8-+-envoyproxy: use the hot restarter everywhere.

cc6369e2c0-+-facilities: ps1-b6-eqiad replaced with newer PDU

064d6a9e98-+-swift: stop relaying to statsd/statsite

b89ea1bd88-+-profile::mediawiki::webserver: remove hhvm restart cron when needed

063875b3ff-+-wdqs: allow port 8888 for domain networks

5f97ed070c-+-sudo: use validate_cmd

a2dc153822-+-mariadb: Decommission db1073

59227e2e2f-+-profile::eventbus - Declare kafka $config in scope

6909bc2a16-+-Ensure eventlogging-service-eventbus is absent

f59aac3050-+-Remove eventbus graphite threshold alert

b527d33d35-+-profile::puppetdb: Fix ferm rule for netbox frontends

da156e5994-+-gerrit: allow customizing LDAP config in Hiera

9d3386d755-+-Remove profile::lvs::realserver from profile::eventbus

a59f886368-+-netbox: Various remaining fixes.

46762f3679-+-Remove LVS/pybal config for eventbus service

2452eea77a-+-eventbus: class service::configuration has no ensure parameter

80e25cac24-+-Drop symlink for /etc/puppetdb and update default file

e3dd3dcec1-+-Remove ensure parameter in service::configuration

3fa786949b-+-envoyproxy: use the hot restarter

18850e11f1-+-Really fix motd

8e5f5f1b97-+-Fix motd script

1b4abbc5c4-+-On Ganeti servers print the current master node in MOTD

aa71a942ef-+-envoyproxy: fix settings for jessie

ab28260d17-+-amd_rocm: add support for 2.7.1

0ab30f8b98-+-profile::statistics::gpu: update ROCm version to 2.7.1

986f78c4ba-+-mariadb: Promote db2112 to s1 codfw master

b3a538411f-+-prometheus: aggregate ipsec_status and add alert

17953cf5e3-+-Add $ensure params with defaults for eventlogging service - no op

efe5e8c852-+-analytics::refinery::job::data_purge.pp: fix checksum again

dcf1c15039-+-labpuppetmaster1001/1002:  Clean up after moving puppetmasters to the cloud

4e097daeb3-+-analytics::refinery::job::data_purge.pp: Correct checksum

9bfafed05d-+-mariadb: Promote db1135 to m1 master

77ccafbfe0-+-Prep for installing an-presto nodes

1fc591faa2-+-Remove roentgenium/tureis

a9764226b0-+-swift: escape exclamation mark in alerts

2006a1b4fe-+-ip6_mapped: add ip6_mapped to profile::standard

fc1f29cf4c-+-Enable puppetdb1002/2002 as puppetdb hosts

0959ccfc47-+-ip6_mapped: add missing nodes

9f5559a3ce-+-swift: exclude temp objects when checking eqiad/codfw difference

bca731f64b-+-mediawiki: Add rebuildItemTerms for Wikidata

d7eec26cbe-+-wmcs::nfs: add ipv6 mapped address

9a183797f4-+-swift: port alerts to Prometheus

fdd4d159bd-+-Revert "lvs: allow access to wdqs lvs on port 8888"

156d804c0b-+-lvs: allow access to wdqs lvs on port 8888

24e45621b5-+-Decom iron

251209993a-+-mariadb: Decommission db2047

f93ad3ccc1-+-mariadb: Promote db1109 to s8 master

9c951fa9e9-+-postgres::slave: Fix various minor issues with slaves

640666bec0-+-Make puppetmaster CA content key be a hash keyed by puppetmaster

21688bfe13-+-Revert "Make puppetmaster CA content key be a hash keyed by puppetmaster"

b41f1246eb-+-Make puppetmaster CA content key be a hash keyed by puppetmaster

3f711a5c4e-+-Decomission eventlogging-service-eventbus in beta / deployment-prep

a733561430-+-Remove unused eventlogging mysql consumer eventbus puppetization

9b4fbe231f-+-postgres::slave: remove type hint to address debt

c58692ed76-+-Use $ensure for all resources in eventlogging::service::consumer

d6d368e246-+-Disable mysql-eventbus eventlogging consumer

090a9c7120-+-profile::netbox: Fix https ferm rule

7a6a7f4f2c-+-netbox::postgres; fix username for netbox connection

abaa0e11d7-+-netbox: add python3-pynetbox

5b6023cc2e-+-etherpad: TLS termination with envoy

06b26a39b4-+-analytics::refinery::job::data_purge.pp Add skip-trash to timers

42022a39a9-+-ATS: Disable server session sharing across clients on TLS instance

65ff27281d-+-ATS: Disable keep-alive on outgoing connections on TLS instance

b970fdf520-+-prometheus: collect swift account/container stats globally

6f974b5f20-+-profile::cache::kafka::varnishkafka_delivery_alerts: fix description

751f7fa1d1-+-ATS: Disable hardening for the TLS instance on cp5001

210cbe82ca-+-ganeti: add ipv6 mapped address

f55212c6b7-+-wmcs::openstack::codfw1dev: add ipv6 mapped address

64fa1aff18-+-realm.pp: Update certname validation for cloud VMs

b395502c49-+-codfw1dev: move some designate/pdns things to 'codfw1dev.cloud'

e8d43e1460-+-graphite: fix mediawiki alerts dashboard link

5fd929b758-+-excessive LVS RX alert: page

60f51839ab-+-toollabs: update maintain-kubeusers timer command to use timeout

1eccf977bf-+-openstack: add haproxy health check path support

282d69d26a-+-Revert "openstack: add haproxy health check path support"

d8577f117c-+-openstack: add haproxy health check path support

75a7796a67-+-openstack: Add codfw1dev glance API to haproxy

a481892276-+-ATS: Disable DNS resolution for TLS instance

adeef790b9-+-Add initial site.pp entry for ldap-corp*

8deff9d04d-+-webperf: add envoy for TLS termination

6490d0ebf6-+-releases: add envoy for TLS termination

bda46dadf0-+-mariadb: Decommission db2046

79e5422176-+-netbox: Undo some mistakes in the netbox user

d0c07a7eb5-+-netbox: fix role includes for really reals

262e898636-+-netbox: fix includes of ::profile::base::firewall

079a9b50cf-+-codf1dev: move the puppetmaster enc database to cloudb2001-dev

c64af8e803-+-Revert "toolforge: add CORS header to docker-registry"

9879555fd9-+-kafka-main: move kafka1001 to role::spare::system

c459eca98c-+-toolforge: add CORS header to docker-registry

bb52c4f84b-+-elasticsearch: add syslog logging option

a92fbbe8ae-+-netbox: Add dhparam

75f8e717c2-+-kafka-main: replace kafka1001 hardware with kafka-main1001

eaf199adcf-+-restbase: TLS termination with envoy on port 7443

de30a0a67e-+-mediawiki::php: only enable tideways/mongodb where needed

19193c0cc5-+-Decommission neodymium

157ab49693-+-Decomission sarin

e507bbd55c-+-mariadb: Fix typo on dbproxy1005 spare role

ad3e27d684-+-mariadb: Decommission dbproxy1005

71e1050cf0-+-ATS: Disable SSL Session tickets

8bcb37652c-+-realm.pp: Remove filejournal table from private list

25ff215fcb-+-designate: create pdns zone records with both designate servers as 'master'

37463ddbc9-+-powerdns: correct some database variables in my.cnf

45f037a935-+-netbox::postgres: Finally fix firewall

330c93cc0d-+-toollabs: fix maintain-kubeusers-timer command arguments

49cbf2ff50-+-netbox::postgres: Fix conditional on rule inclusion

1bedf90c91-+-openstack-pdns: don't run the mdadm check where the database runs

3bd896c6f5-+-toollabs: convert heredoc to variable type for interpolation

8b1b53a316-+-icinga: check number of parent nova-compute procs

ff66f40a6a-+-RESTBase: Temporarily allow access to port 7233 as well

2e923fedab-+-envoyproxy: do not hardcode 443 in ferm rule

00ba638ee4-+-prometheus: deploy prometheus-ipsec-exporter to all sites

0ee64f8828-+-admin: convert maintain_kubeusers to systemd timer type

a46da2ccb1-+-envoyproxy: create a python 3.4 version of build_envoy_config

32760b40f7-+-varnish: reload service upon -common separate VCL changes

7f43ef8e28-+-envoyproxy: allow overriding TLS port

e80f8dba6f-+-profile::lvs::realserver: remove absenting of old restart script

997065c853-+-requesttracker: do not load httpd ssl module

7fb121ddce-+-mariadb: Provision dbproxy1017 to replace dbproxy1005

29cd774dc7-+-wikistats (cloud): remove php5 support

ebf183d6b1-+-remove wikiba.se microsite puppetization

12d82a4e62-+-tlsproxy/envoy: create user/group if on jessie

0acc10da6e-+-Remove role::ci::slave::webperformance

0fe95f09f6-+-netbox::postgres: Update ferm rules for FEs

8dcea07b25-+-postgres: Fix deps for Buster

a65cdf59ee-+-profile::netbox: Reorganize for splitting front and back-end.

0298c2c522-+-mediawiki: remove per-host high CPU alerts

39c5979c64-+-mariadb: Promote db1133 to m5 master

be465fcd7f-+-role::lvs::realserver: remove from puppet

afad74eab0-+-openldap,labweb: convert to profile::lvs::realserver

a92c1a74da-+-requesttracker: include envoy for TLS termination

ab8fae7b0f-+-tlsproxy/envoy: fix package name for envoy on jessie

51cfbe6aa5-+-proton: convert to profile::lvs::realserver

133bcabf2d-+-ores: convert to profile::lvs::realserver

8fe20aa7e2-+-scb: convert to profile::lvs::realserver

8129099b26-+-restbase: convert to use profile::lvs::realserver

490a988a6d-+-wdqs: convert to profile::lvs::realserver

d8dab7fd05-+-peopleweb: add TLS termination with envoy

75f6bbd268-+-mariadb: Promote db2118 to s7 codfw master

a281dcce84-+-Revert "package_builder: Install debhelper from backports"

89e71c3298-+-Revert "package_builder: Fix debhelper dependencies on stretch"

e2717f449f-+-maps: convert to profile::lvs::realserver

122b066d2a-+-prometheus: Ship a custom metrics file for trafficserver_exporter

a23a26a284-+-package_builder: Fix debhelper dependencies on stretch

3d3b01efa9-+-package_builder: Install debhelper from backports

627c0f3b04-+-elasticsearch::cirrus: convert to profile::lvs::realserver

0e413f8747-+-icinga: add old JVM GC check for elastic

ebfb0146ef-+-monitoring: alert on availability over two minutes

a234b1be37-+-k8s::worker: switch to profile::lvs::realserver

071c4396c5-+-openstack: Add codfw1dev neutron server to haproxy

f4c898d8a9-+-Fix mwvagrant sudo rules

f4f9633672-+-openstack: Add codfw1dev nova API and metadata to haproxy

1a5b890729-+-trafficserver: fix grafana link

eb694d8eb4-+-planet: add Hiera keys and include class vor envoy

2ea99dff3f-+-netbox: add role spare::system to new VMs

7ab9574ab4-+-mariadb: Decommission db2060

9ea870fe38-+-toolschecker: remove showmount check

457ff2f6e3-+-profile::openstack::codfw1dev::db: allow designate host to access db server

18826448f1-+-toolschecker: remove webservice grid and k8s check

85fd9a9eff-+-labstore: Open NFS between secondary servers

734eb381c7-+-Revert "planet: include envoy for TLS termination"

7d66165a4d-+-planet: include envoy for TLS termination

f26eaf93f3-+-Add bash script between FNM and notify script

d4432ff7cd-+-ncredir: Enable HSTS with max-age set to 1 week

8275d911c6-+-labstore: check nfs v4 cluster status with rpcinfo

99ecb3f55c-+-prometheus: add some cloud-dev dns metrics to the codfw prometheus host

8b9d4bd2f7-+-site/install_server: decom krypton.eqiad.wmnet

caa0a94019-+-misc_apps::httpd: remove jessie/php5 support

bc94fd99bc-+-Revert "webserver_misc_apps: only include envoy if on stretch"

a770c14b3f-+-wikimania_scholarships: remove jessie/php5 support

0dce45de47-+-mediawiki::webserver: send stderr of hhvm-restart script to /dev/null

f81e60574d-+-iegreview: remove jessie support

16ceb4d8f0-+-racktables: remove jessie support

8ace6604a9-+-mariadb: Decommission db2053

aa28008afd-+-profile, varnishkafka: remove logster cron entries from varnishkafka hosts

bce6ea2dd6-+-phabricator::main: whitelist ATS hosts

7e56ec1c36-+-docker_registry_ha: allow eqiad/codfw varnish/ATS text nodes

e56940c8ee-+-ATS: Allow configuring HTTP/2 settings

6c6c200213-+-ATS: make sure that the systemd service is enabled

eacd134c81-+-webserver_misc_apps: only include envoy if on stretch

4d21fd6ac9-+-iegreview: require a mysql client to be installed

e70dd78f43-+-misc_apps::httpd: allow port 80 from deployment servers

11a75388bd-+-misc_apps::httpd: do not load SSL httpd module

0749c52870-+-prometheus: bump logstash rate of ingestion threshold

48b4c8ccba-+-dbproxy1018: Productionize dbproxy1018, will replace dbproxy1010

7985a190d5-+-ATS: Fix indentation on Trafficserver::Network_settings

913bbb3fc5-+-Fastnetmon, add notification script

bd2a4fe08a-+-tools-prometheus: add an allowance for ssh monitoring

6a748e7820-+-analytics::refinery::job::data_purge.pp: fix geoeditors retention period

420b42ce6b-+-k8s::master: switch to profile::lvs::realserver

37df414c88-+-anycast recdns: enable for codfw clients

5a90f03ccd-+-logstash: replace krypton with grafana1001 in collector ferm rules

6d31da3d06-+-prometheus: fetch cache_text atsmtail@backend metrics

56f57decf4-+-labs::db: add ipv6 mapped address

03273879ca-+-site: add miscweb role to miscweb1001

d78c7bd1bc-+-mariadb::core - eqiad: add ipv6 mapped address

42229338e7-+-aqs: convert to profile::lvs::realserver

b24904cc34-+-mariadb: Productionize dbproxy1016

8d86400b70-+-backup::offsite: add ipv6 mapped address

5ce0f9c590-+-mariadb::core_multiinstance - eqiad: add ipv6 mapped address

cb7e60a3b2-+-mariadb::parsercache - eqiad: add ipv6 mapped address

8e9d2bdc54-+-ATS: Allow configuring connections_throttle

84d178daef-+-cache: reimage cp1075 as text_ats

ca9a6f54ad-+-Add services_proxy to wikitech

ed293c3a9d-+-mariadb: Promote db2129 as codfw master for s6

fc0bfe427b-+-set analytics-database-meta-snapshot-copy-to-hdfs contact to analytics

f382d18147-+-Own analytics_meta_hdfs_backup_dir as root

760e0e2189-+-Run analytics-meta-backup-to-hdfs as root to be able to read source files

c7a4cd52f2-+-Make analytics-meta hdfs backup executable by analytics user

989406c56a-+-prometheus: add prometheus ipsec exporter service & config in ulsfo

54fbe21309-+-Keep daily backups of analytics-meta MySQL instance in HDFS

8620f17c5a-+-hhvm: fix restart script path

c224f9682a-+-profile::lvs::realserver: only use safe restart scripts

5c6993c45e-+-prometheus: add trafficserver prefix to global metrics

4f22f6f74f-+-ATS: Fix port definition on trafficserver::monitoring

1a8ce5bae5-+-ATS: Set origin TTFB timeout to 180 secs for TLS instance

fa99afe077-+-ATS: Allow specifying timeouts to TTFB in connections to origin servers

3749f063fd-+-cache: Add use_trafficserver_tls parameter to unified profile

c5677f1abb-+-VCL: add support for blacklisting IPs

60a82416ed-+-cache: Add missing tls_port parameter

94282e0b97-+-conftool::scripts::safe_service_restart: add pool/depool scripts

23ef1e073a-+-cache: Allow setting an arbitrary port for incoming TLS connections

42787d2492-+-decom db2034

551052ce61-+-db2045 decom

980876b4c2-+-decom use of graphite2002 hostname

002129a1c2-+-mariadb::proxy - eqiad:  add ipv6 mapped address

94622cfb42-+-mariadb::core - codfw: add ipv6 mapped address

72fe80ae83-+-role::mariadb::misc - eqiad: add ipv6 mapped address

7b0f764b14-+-mariadb::dbstore_multiinstance - eqiad:  add ipv6 mapped address

934bf6c9a1-+-Revert "Enable puppetdb1002/2002 as puppetdb hosts"

b52802fa7b-+-Add support for Buster in postgres manifests

245cbf22d6-+-Enable puppetdb1002/2002 as puppetdb hosts

3cf4a04f08-+-mariadb::backups - eqiad:  add ipv6 mapped address

d101fbbf2a-+-mariadb::misc::phabricator - eqiad: add ipv6 address

66b586b193-+-Remove explicit config for mapped ipv6 address from a few spare systems

3bba7b40c9-+-mariadb::sanitarium_multiinstance: add ipv6 mapped address

92db24f147-+-mariadb::dbstore_multiinstance - codfw:  add ipv6 mapped address

9f97db5842-+-ATS: add icinga check for traffic_server restarts

2bd71ffb4a-+-mariadb: Decommission db2066

d0e13bdd9b-+-removing ipv6 call while role spare

a295fd3407-+-gerrit1001 base install params

996e0a808b-+-Fastnetmon add python3-geoip2

a9516f4a2e-+-Fastnetmon, add GeoIP DBs

d75c67b873-+-logster: add ensure parameter

412675fe93-+-Decommission analytics-tool1002 (old turnilo Ganeti vm)

7c8e638302-+-Remove unused/untrusted IP ranges from trusted lists

68380bdf2a-+-profile::analytics::refinery::job::druid_load: remove absent job

7ffb7fe52e-+-Revert "ATS: add icinga check for traffic_server restarts"

92e92a1a7f-+-authdns: Stop cloning over /p/

e6b82da91c-+-profile::analytics::refinery::job::druid_load: absent readingdepth job

43fab7d562-+-ATS: add icinga check for traffic_server restarts

3fdc9475e4-+-failoid: add ipv6 mapped address

68c9e46ab0-+-profile::mediawiki::alerts: Increasing alerts for mw request time

e800d4e2d0-+-Create the new Analytics Zookeeper cluster

642b46257d-+-wdqs: improve alert description

d558e3bc89-+-mediawiki::memcached - eqiad: add ipv6 mapped address

e865649591-+-mediawiki::memcached - codfw: add ipv6 mapped address

d97993b9f9-+-etcd::kubernetes: add ipv6 mapped address

057dcf44d6-+-etcd::networking: add ipv6 mapped address

ef00502bdf-+-Remove ipv6 mapped conf from an-conf100[1-3]

eceaf8581d-+-ores: add ipv6 mapped address

c6d6a832a7-+-kafka::main: add ipv6 mapped address

0c3565117f-+-eventschemas: add ipv6 mapped address

6eaf470983-+-poolcounter: add ipv6 mapped address

4a190fd333-+-docker_registry: add ipv6 mapped address

79144b70f3-+-xhgui::app: add ipv6 mapped address

0d3c838079-+-otrs: add ipv6 mapped address

f7883c6bd8-+-parsoid: add ipv6 mapped address

8897bcbaae-+-redis - eqiad: add ipv6 mapped address

096413d66e-+-redis - codfw: add ipv6 mapped address

8ad88a3b10-+-mariadb::misc::multiinstance:  add ipv6 mapped address

dacc8f32a4-+-role::mariadb::misc - codfw: add ipv6 mapped

503a70b181-+-mariadb::backups - codfw:  add ipv6 mapped address

dc861974f2-+-mediawiki::common: Allow mwdeploy user to restart php-fpm

d775dc050e-+-mediawiki::users: Allow adding privileges to mwdeploy user

0787fa46a0-+-prometheus: Identify trafficserver instances using the layer label

3b3f4ef36f-+-mediawiki: alert on 2xx latency

fbeec50949-+-dbproxy1019: Provision dbproxy1019 to replace dbproxy1011

6a62e4e9be-+-mariadb: Decommission db2059

59325b4b4e-+-logging::mediawiki::udp2log: add ipv6 mapped address

ec8a58d7a9-+-etherpad: add ipv6 mapped address

f2b3daddfd-+-thumbor: add ipv6 mapped address

ac6975dce7-+-sessionstore: add ipv6 mapped address

5d3ce275ca-+-swap: add ipv6 mapped address

5628108896-+-openldap: add ipv6 mapped address

2a853f6b67-+-webserver_misc_apps: add ipv6 mapped address

c204aa033b-+-graphite: add ipv6 mapped address

55b543b704-+-maps - eqiad: add ipv6 mapped address

57ca826610-+-maps - codfw: add ipv6 mapped address

0eba05ec6b-+-debug_proxy: add ipv6 mapped address

b411288d8e-+-grafana: add ipv6 mapped address

a434dc6fca-+-mediawiki::php: remove legacy php restart script

71b0538c25-+-MW servers - eqiad: add ipv6 mapped address

3e698ad1e6-+-wqds: add ipv6 mapped address

80d6511bca-+-swift - eqiad: add ipv6 mapped address

21e5ea315d-+-swift - codfw: add ipv6 mapped address

e3a510a711-+-Add more tunables to Eventlogging to Druid

119993ef63-+-deployment: add fix-staging-perms command & sudo for it

c05118822b-+-logstash: add ipv6 mapped address

3fb61ca8b7-+-mw servers - codfw: add ipv6 mapped address

e9581815d1-+-mariadb::misc::phabricator - codfw: add ipv6 address

2a9206bb0a-+-elasticsearch::cirrus - eqiad: add ipv6 mapped address

ca50051491-+-elasticsearch::cirrus - codfw: add ipv6 mapped address

db29a3cc90-+-mariadb::misc::tendril: add ipv6 mapped address

f74cadd429-+-puppetdb/postgres: Drop support for jessie, add support for buster

75bc3bb398-+-elasticsearch::relforge: add ipv6 mapped address

16af172ca7-+-restbase: add ipv6 mapped address

602c4098db-+-MW servers - eqiad (canary and debug): add ipv6 mapped address

255711fce2-+-mariadb::proxy - codfw:  add ipv6 mapped address

872b36dd8d-+-mariadb::temporary_storage: add ipv6 mapped address

008761f647-+-mariadb::core_multiinstance - codfw: add ipv6 mapped address

c962b1f820-+-mariadb::parsercache - codfw: add ipv6 mapped address

359d51b847-+-puppetboard/puppetdb: add ipv6 mapped address

475641c38f-+-debmonitor: add ipv6 mapped address

c0837cfb59-+-dumps: add ipv6 mapped address

125bec94df-+-dumps::generation::server: add ipv6 mapped address

0baaf47572-+-dumps::web::htmldumps: add ipv6 mapped address

4be380a87e-+-wdqs: restrict port 8888 to analytics networks

3ae4cc783e-+-Add base configuration for an-conf100[1-3]

43ad970a80-+-mariadb: Decommission db2052

032c22a012-+-ATS: Enable TCP Fast Open for the TLS instance

212b6d1d11-+-ATS: Disable config status check for TLS instance

0dd0452353-+-ping_offload: add ipv6 mapped address

6cc76a5f08-+-kerberos::kdc: add ipv6 mapped address

7841091b2e-+-analytics_cluster::hadoop::client: add ipv6 mapped address

039f99c360-+-mariadb::misc::eventlogging: add ipv6 mapped address

fdea4134ba-+-syslog::centralserver: add ipv6 mapped address

f558b1ed1d-+-ipv6: add mapped ipv6 to yubiauth server

cd21cfcee8-+-Add -XX:NewRatio=3 for cloudelastic-chi

9a28fbfded-+-profile::swap: add push_published_datasets tunable

b24ccfb6e6-+-IPv6: add static IPv6 addresses to spare hosts

992ceb5704-+-builder: add ipv6 mapped address

512539cd9e-+-mediawiki: bump POST latency threshold and retries

acfcaa6a80-+-mediawiki: alert on latency for non-error status

358f9b48b0-+-mariadb::core_test: add mapped ipv6 address

b5a57c81a6-+-mediawiki: filter out NaN values for latency alerts

ed780b28eb-+-role::analytics_test_cluster::client: include SWAP/notebooks

5bbbbbf535-+-Add failoid1001/2001 to site.pp

d2990a08de-+-profile::tlsproxy::envoy: use full systemd unit on jessie

e8bdc8abcf-+-profile::kerberos::kadminserver: add support for replication

0c2e47a7e1-+-mariadb: Decommission db2051,db2056

d666d41b3c-+-mediawiki: remove dashboard_links urlencoding

b712c63c2a-+-mediawiki: add cluster latency alerts

36ca6610f4-+-mariadb: Promote db2123 to s5 codfw master

551d1f3413-+-profile::analytics::refinery::job::druid_load: add more dim to netflow

c5f6d3d672-+-mariadb: Decommission db2044

f815d8a3ff-+-mariadb: Decommission db2049

75d756e6c2-+-ukwiki and viwiki are now configured as 'big wikis' for xml/sql dumps

7f7b9cb91f-+-icinga: disable autocomplete.js in icinga search text input

3778ae9d8a-+-ATS: Only monitor OCSP Stapling freshness for acme_chief if it's being used

37419f2d33-+-ATS: Only allow writing on /etc/acmecerts if acme_chief is being used

1cb20ceac2-+-profile::tlsproxy::instance: do not autostart nginx

911a301412-+-ATS: Fix non-default instance traffic_server path in check_procs check

d4aaaa91be-+-ATS: Fix traffic_server --run-root parameter value in check_procs check

9a7612c40f-+-ATS: Include TLS instance in cache upload role

5a82e826b8-+-mediawiki:errorpage: Make content default undef

d9d2084597-+-Add an-tool1007 as replacement for analytics-tool1002

8d63f86e5a-+-confserver: enable ipv6 mapped address on the conf200* servers.

c7867c58bb-+-swift: stop monitoring individual daemons

1a36d0f8ba-+-statistics::mysql_credentials: add file only if group is defined

4bbf7f8d45-+-mariadb: Move db2067 to m2, decomm db2063

e0685b53c6-+-envoyproxy: support debian jessie

b3ee2119cc-+-toolforge: rebranding k8s control plane to control

0c91a25c70-+-mediawiki: Introduce startupregistrystats.pp to record RL modules registry

f91a23924a-+-profile::analytics::cluster::packages::common: temp remove python3-tk

0923406105-+-profile::analytics::refinery::job::data_purge: remove shell redirect

4ee996fd3e-+-toolforge: provision zstd

bf494f4a0e-+-phabricator::main: correct the php extension list

02e41a3653-+-ATS: do not autostart service upon package installation

0111899702-+-toolforge: treat all compute nodes as submit hosts

ff0e01a161-+-Disable DCAT-AP updates - will be moved to separate endpoint

499b20baed-+-idp: correct typo

fb0533305f-+-idp: add dhparam and disable ssl_ecdhe_curve

0e0cf5d89c-+-idp: use correct cert name

32852d9abd-+-idp: use tlsproxy::localssl directly

39678c3ec4-+-openstack: add core filter to nova scheduler

1d895625fd-+-idp: add tls proxy

1eac435b86-+-openstack: cleanup nova-network version of nova

11fc51577f-+-Add TLS termination for grafana

6d468b92f9-+-idp: add prometheous and htst parameters

f4ec23e467-+-idp: add port paramater

3cf09d4c49-+-apereo_cas: use unix path for the prefix

201aa405b9-+-idp: move service to port 443 and open firewall

763ed3172e-+-idp: enable mapped ipv6 address

22521332ec-+-icinga: add the option separator for elastic shard size alerts

50e952e8e7-+-idp: add gauth crypto keys

bf1facc22c-+-idp: add google authenticator

417763d205-+-icinga: add timeout option to elastic checks

cf37700afc-+-envoy: configure tls_terminator if ensure: present

60ca62eb2c-+-Add TLS termination for webserver_misc_apps

35b1ca75f4-+-openstack: add glance image sync to codfw

af5bbedf4b-+-idp: add crypto key support with spec tests

b01f92bf0e-+-apereo_cas: dont use starttls

d038fa6186-+-apereo_cas: ensure we use the latest git repo and add some notifies

8a78ae439c-+-apereo_cas: correct some settings

81c8582bef-+-idp: add keystore password configueration to apereo_cas

dc6b62a938-+-envoyproxy: rebuild configuration when the admin file is changed

53cdf2169a-+-envoyproxy: only run build-envoy-config from puppet

b16466be42-+-Add TLS termination for phabricator.discovery.wmnet

9e38d9caa4-+-mariadb: Move db2063 from s2 to m2

01b456c878-+-netbox: Add configuration and timers for csv dumps

d802cd58d9-+-Netflow: install and configure Samplicator

ba2c022dad-+-netbox: Add configuration for Netbox spicerack backend

4497455597-+-monitoring: Change the showmount check from toolforge to be email-only

83f631ea47-+-elasticsearch: reduce sensitivity of master eligible check

dee682c93a-+-lvs: isolate cloudelastic icinga check

da8f2df596-+-openstack: initial haproxy profile

980ef7e75f-+-labstore: restore original sense of the load alert with prometheus

10a5027bda-+-idp: update the apereo_cas module to accept a content param for keystore

6680e7bf83-+-idp: include the correct password class

dcbcf4104a-+-idp: ensure we include the passwords class

c52bbcd885-+-idp: enable idp role on idp1001

6f7b5745c5-+-Initial stub role for the IDP (WIP)

10c4809182-+-prometheus: fetch active netmon server from hiera

ed5b958392-+-mariadb: Decommission db2057

b53e39ebbe-+-mariadb: Decommission db2050

7246c8ba24-+-prometheus: generate targets for single phase PDUs

261baa6a3e-+-facilities: introduce monitor_pdu_phase for ulsfo PDUs

d17caaa8db-+-Remove RESTBase graphite alerts.

df05f9a1a4-+-ATS: restart atsmtail upon trafficserver restart

4a231ff8b0-+-ATS: add hiera flag to disable systemd hardening

6ae7bbf6c0-+-mariadb: Provision db2122 into s7

9bcdca6648-+-systemd: add support for mask and unmask

3af2a89cb9-+-profile::mediawiki default php to php7

8e7884a249-+-mariadb: Decommission db2043

7e9cbd28ae-+-ATS: Fix OCSP stapling configuration

716c1e086b-+-mariadb: Promote db2105 to s3 codfw master

efff352713-+-mariadb: Provision db2121 into s7

8c5aec5e16-+-parsoid::testing: remove parameter use_parsoid_php again

6f3358917c-+-mw-maintenance: switch generatecaptcha cron to PHP 7.2

7310a6eaf1-+-design.wikimedia.org: fix directory name and rename httpd config file

31a43ac597-+-design.wikimedia.org: add new dir and repo for strategy site

dff61e46d6-+-mw-maintenance/cirrussearch: switch cron jobs to PHP 7.2

9dfb2c46e7-+-mediawiki:maintenance: switch pagetriage cron to PHP 7.2

deced2e869-+-cirrus: increase alerting threshold for Cirrus update rate check.

bf39c97335-+-systemd::timer::job: fix the default logging paths

50a849d340-+-refactor wikidata entity dumps into wikibase + wikidata specific bits

2d0be6c045-+-Add Hadoop Native libraries path to spark2 default

6d2093726a-+-dump exception checker uses python rather than bash

914afcaf6e-+-look at dumps logs every so often for exceptions and report them

a6c56bf911-+-Add kerberos support to Analytics Spark Refine

f79cfd941c-+-mariadb: Decommission db2069

cc2466abc5-+-profile::kerberos::kdc: fix (again) source of script

0fcfed7582-+-fifo_log_demux: Remove socket activation

e7931fd161-+-profile::kerberos::kdc: fix source content of file

fc5b14822e-+-profile::kerberos::kdc: use absolute path in timer command

9e668c89ac-+-profile::kerberos::kdc: add daily backup for the KDC database

3bcff336e8-+-deployment_server: install benchmarking tools, wrk, siege

3076e91973-+-mediawiki:maintenance: switch translationnotifications to PHP 7.2

5164c1fb63-+-profiile::analytics::refinery::job::test::refine: use refinery 0.97

722a89745d-+-netbox: Make it so that failed reports dont also systemd alert

7fd8046208-+-envoy: use newer definitions for clusters, other fixes

483104e951-+-parsoid::testing: allow switching parsoid/JS to parsoid/PHP

33c7cba1ca-+-cas: Switch overlay repo to internally forked version

dddb8b24ff-+-envoyproxy: further small fixes

8a14f15098-+-envoy: several fixes

1352f73be3-+-profile::cache::ssl::wikibase: ensure dhparam creation

ff96f4021c-+-puppetdb: enable lua filter to munge puppet reports

adf0505672-+-puppetmaster upgrade: add a lua filter to remove the job_id

178df46329-+-ATS: Propagate config_prefix to trafficserver::lua_infra

3dae2f18f6-+-ATS: Toggle X-Forwarded-For header

87760090b2-+-Use Java's G1 GC for the Hadoop Analytics HDFS Namenodes

06b08abe06-+-envoy: fix file path, service name

10cb75c3e4-+-role::webserver_misc_static: add TLS termination with envoy

9eb1758f7c-+-mariadb: Productionize dbproxy2003 into m3-codfw

78a626545b-+-mariadb: Promote db2096 to x1 codfw master

0bc9b90483-+-profile::tlsproxy::envoy: new TLS terminator for services

dc515217ff-+-varnish: Remove support for jessie

deb54c21d3-+-envoyproxy: create module, add tls terminator definition

b4335431c6-+-mediawiki::php: tune after an appserver 100% in production

f84895756f-+-mariadb: Decommission db2035

3de96b2409-+-parsoid-testing: add Hiera switch between parsoid/JS and parsoid/PHP

2acee6f628-+-mediawiki::maintenance::purge_checkuser.pp: Switch to PHP 7.2

4d336d3a5a-+-monitoring: Switch a collection of WMCS alerts to email-only

6d5e309563-+-extdist: Switch to gerrit-replica for cloning

265ada0822-+-monitoring: change WMCS services to paging WMCS only

ecb56b6491-+-toolforge: modernize updatetools script

dbf9de987d-+-mediawiki:maintenance: switch wikidata to PHP 7.2 (prod)

32cbace49e-+-mediawiki:maintenance: switch wikidata to PHP 7.2

1ac2764811-+-prometheus: bump timeout for pdu jobs

18ee5ffcd2-+-noc fetch_dbconfig: fix script mode

560b606d7b-+-noc fetch dbconfig: fix logging snafu

5dc91209b0-+-Revert "lvs: isolate cloudelastic icinga check"

ae88ef51d8-+-noc: fetch dbconfig from etcd to local disk

7638c8daf8-+-lvs: isolate cloudelastic icinga check

a4aa291407-+-profile::mediawiki::webserver: remove hhvm-restart for php-only hosts

0d2b9b2d81-+-mariadb: Provision db2131 into x1

67eb0a643b-+-Remove old jessie-based pool counters

1172c746f0-+-profile::cache::kafka::varnishkafka_delivery_alerts: fix dashboard link

65773a48bb-+-profile::cache::kafka::varnish_kafka_delivery_alerts: fix query

6e55dea85e-+-Icinga: Remove support for Jessie

3bf0609d0e-+-profile::cache::kafka::alerts: move alarms to prometheus

532f771299-+-mariadb: Decommission db1071

5cf2cdf184-+-mediawiki:maintenance: switch db_lag_stats to PHP 7.2

dc5edf6eb4-+-Revert "mediawiki:maintenance: switch translationnotifications to PHP 7.2"

185b0d7311-+-mediawiki:maintenance: switch translationnotifications to PHP 7.2

6add4f811a-+-Install libpython3.7 with python3.7 on analytics nodes

d49983ab2c-+-Declare python3.7 package explicity to avoid circular dependency

8fde58579d-+-Install python3.7 package on analytics cluster

b007f867c4-+-profile::piwik::webserver: fix profile import

5d16acc9a2-+-role::piwik: add TLS proxy

4154236e2d-+-logstash: manage currently unmanaged log4j2.properties file

8ebe5d0a98-+-swift: 'nobarrier' for xfs has been removed in linux 4.19

ae489b769a-+-apereo_cas: Initial module

e8fe2bcc7f-+-prometheus: stop polling varnish on upload backend

c22b77d1a2-+-toil: rsyslog_tls_remedy log to journald

ec394ee4eb-+-toil: add rsyslog TLS remedy

403a7cc396-+-cloudelastic: remove ocsp_proxy

1255e25e14-+-kubernetes: expand alert description

03caa6b0c4-+-profile::mediawiki::nutcracker: Remove support for jessie

20676ae17c-+-role::mediawiki::common: Remove support for Jessie

9b2ff8435b-+-mariadb: Provision db2130 into s1

5f1805229b-+-ncredir: Allow prometheus nodes to reach mtail port

0d8b92aeb3-+-prometheus: Collect ncredir nginx metrics

de6ae72503-+-netbox: Fix parameter that didnt get passed

b609e68838-+-mediawiki:maintenance: remove non-working jobqueue_stats cron

dac869ecff-+-mediawiki:maintenance: switch readinglists cron to PHP 7.2

51851d0e39-+-netbox: Fix additional swift parameters

d28eb0b4ff-+-toolschecker: Remove a lot of paging of all SRE

69893fb0be-+-camus: allow to choose the CamusChecker's alert email

4de1bb6a35-+-ncredir: Ensure that the default mtail service gets masked

48c2e1c8bb-+-ncredir: Use pipes instead of files for the access_log

afbebfd2c1-+-systemd::tmpfile: apply changes when we change the files.

192056658b-+-prometheus: alert on widespread puppet failures

1cbf119546-+-cumin: remove old scripts converted to cookbooks

2962a4b046-+-fifo_log_demux: Allow to specify a service that requires fifo_log_demux

f2d39f8382-+-fifo_log_demux: Provide pipe creation capabilities

b74a7af5aa-+-relforge: allow cumin to access elastic search ports

b4b431aa63-+-mariadb: Provision db2127 into s3

8c615659f8-+-monitoring: tweak description for paging alerts

10fdaf402b-+-mariadb: Promote db2107 to codfw s2 master

f262deb3b3-+-profile::analytics::refinery::job::test::refine: fix refine regex

6f5a3ca505-+-gerrit: fix sshd listen address if on a slave

b33c7bffd2-+-profile::mariadb::ferm_misc: Add gerrit2001.wikimedia.org to the firewall

d1c1cee96b-+-Revert "dbctl: diff PHP vs dbctl configs"

e104b57b0d-+-prometheus: generate targets for sentry4 PDUs too

73ba867c01-+-prometheus: query pdu resources based on model

4152eb891d-+-monitoring: fix HTTP availability dashboard links

72ea73a47b-+-role::parsoid::testing: remove unnecessary php additions

90b2e36856-+-mariadb: Provision db2124 into s6

96388d88bc-+-mariadb: Decommission db2058

c2de714365-+-parsoid::testing: temp. comment out php-restarts include

6a1128af1e-+-logstash: update statsd exporter mappings and use exporter

5270c249ef-+-Remove cache::canary stuff

f7c4b1c006-+-cloudelastic: add mapped ipv6

80db10c7d2-+-parsoid::testing: add mediawiki appserver profiles to role

41d0333e7d-+-Attempt to fix cloudelastic LVS IPs

4a00cb2791-+-LVS for cloudelastic

edc3703a97-+-analytics::refinery::job::data_purge Migrate webrequest timers to new script

77d723ae22-+-analytics::refinery::job::data_purge Migrate EL timers to new script

478812efe3-+-eqiad cp decom cleanup

108327047f-+-acamar/achernar: site.pp cleanup post-decom

5bbe8b4655-+-facilities: add model to pdu monitoring

666748d55e-+-check_anycast_healthchecker, add sudo bird rights

d5bf65777c-+-puppetm,aster - canary_hosts: allow hosts top be IP addresses as well as fqdn

b2a8130a87-+-site: lithium to spare

7bdb6ceb64-+-puppetmaster: Fix regression

f882eea028-+-mariadb: Provision db2129 into s6

862e2eddde-+-mediawiki: allow installing php7 only

5f691ce9e0-+-Bird anycast, add monitoring for anycast-healthchecker

1ada6462a5-+-pmacct, remove tee plugin

5e14d4b0aa-+-pmacct, send more netflow data to analytics

befe3ed19d-+-analytics::refinery::job::data_purge Migrate geoeditors timers to new script

8ac9a03c96-+-Deploy refinery to an-tool1006 in Hadoop test cluster

b910ce596e-+-netbox: Fix various swift errors

7b45a7d84a-+-populate kubeconfig resources if both token/username

4ed368ca10-+-anycast recdns: edge sites via realm.pp (nop)

d70f8106ae-+-Prometheus add bird prefix export count to global metrics

380d962615-+-puppetdb (buster): dont install the puppetdb4 component on buster servers

8db1071030-+-ATS: add support for the compress plugin and enable it

2ec5a3a724-+-prometheus: fix pdu_ metrics prefixing

0dcece61f1-+-prometheus: add sentry4 PDUs support

071ebd253b-+-prometheus: prefix pdu metrics

247c339a54-+-prometheus: add sentry4 snmp_exporter config

2196f749aa-+-mariadb: Provision db2126 into s2

1d1b1dcf07-+-role::analytics_cluster::hadoop::master|standby: increase NN heap size

1b96b223f0-+-profile::druid::turnilo::proxy: add health check

3fba7167b2-+-mariadb: Provision db2125 into s2

2f028e1929-+-mediawiki: use a better notes_url for the "DSH groups" Icinga alert

1672a6847f-+-Prometheus, set bird class name to profile::bird::anycast

fbd08f2949-+-netbox: move config to /etc/netbox

1e71dec2a5-+-Anycast: Add Prometheus exporter to Bird (take 2)

26c9792adc-+-analytics::refinery::job::data_purge Migrate banner timers to new script

fd73d4b16a-+-gerrit: UseStringDeduplication in jvm

995472a44e-+-netbox: Add configuration for REDIS

b6ea4c052e-+-buster-backports: add the buster backports repository to puppet

31689c3073-+-profile::analytics::cluster::packages::hadoop: limit snakebite's deploy

a6438ccf4f-+-puppet: fix config permissions on puppetdir

a664e4c537-+-Introduce cdh::mysql_jdbc

730bac06db-+-role::analytics_cluster::webserver: add TLS proxy

072abd0e15-+-Remove unsed refine job refine_eventlogging_eventbus

86a7248f14-+-role::druid::turnilo: add TLS proxy

2e7785724d-+-Use schema aware refine for revision score and resource change

329e7fedb0-+-toolforge: k8s: add nginx-ingress configuration.

43eea80336-+-puppetmaster: use mod rewrite for conditional proxypass

4fe9b0b4b7-+-profile::analytics::cluster::client: use s-nail in Buster

ece5c62025-+-Consolidate 'critical' and 'contact groups' logic

18f545d2ec-+-analytics::refinery::job::data_purge: Remove WDQS extract timer after absent

28d519908d-+-Introduce role::statistics::explorer::gpu for stat1005

37441c52d1-+-analytics::refinery::job::data_purge Remove timer for WDQS extract

595e19ea78-+-analytics::refinery::job::data_purge Migrate mediawiki timers to new script

d87e9cb171-+-mariadb: Decommission db2038

df02e8011b-+-dbctl: fix temporary diff alarm

8b775ee866-+-mariadb: Allow reimage of db2131

7dea143836-+-tlsproxy: conditionally add ssl_ecdhe_curve to XCP

ece84050c2-+-mariadb: Promote db1104 to s8 master

2c8128ece7-+-dbctl: diff PHP vs dbctl configs

5f50d669ee-+-Revert "Anycast: Add Prometheus exporter to Bird"

f6a51ac47d-+-Anycast: Add Prometheus exporter to Bird

03733eee11-+-Anycast, fix runbook url

d9dede959c-+-Add an anycast endpoint to syslog centralservers

54d4737eb8-+-profile: cleanup per-site varnishkafka deploy flags

ff418edd56-+-prometheus::ops: collect mtail from the application servers

2580b7d81e-+-puppet: add facter.conf and cache some facts

be918e3821-+-dbctl: monitor for uncommitted changes

b43c6d3391-+-tlsproxy: toggle dynamic ssl_buffer_size settings

2797fee270-+-mediawiki::webserver: fix mtail's group

486dd134de-+-mediawiki::webserver: add mtail to gather latency, error rate metrics

287caf1336-+-role::druid::public::worker: add conftool config/scripts

d2da140723-+-profile::mediawiki::mcrouter_wancache: set async behavior as default

cc16666ac0-+-varnish: remove varnishreqstats and varnishstatsd

d8466ef282-+-mariadb: Provision db2128 into s5

f406610866-+-Decommission old jessie-based ORES pool counters

045c906afc-+-role::analytics_test_cluster::coordinator: add el refine job

a25a604ef8-+-mariadb: Decommission db1072

02f077a7e9-+-return sulfur to spares

3c05bf2ddd-+-decom lvs100[1-6]

5ef69545a9-+-monitoring: add logstash 5xx dashboard to availability alerts

6c43718a31-+-monitoring: allow logstash in dashboard_links

ff78c3fe24-+-site.pp: Remove db2123 from spare

a0fb033d7c-+-mariadb: Provision db2123 into s5 codfw

83cb81fe8c-+-db1069 decom

44c10980ae-+-db1064 decom

c1218d2f12-+-decom rhenium

e17d7c0b7e-+-decom restbase10(0[7-9]|1[0-5])

adbe217021-+-decom db1068

51a464c1dd-+-decom labsdb100[67]

c05143af35-+-decom old kafka brokers

ee60ae109b-+-Increase size of cirrus curl pools

bf8366a443-+-contint: remove arcanist

3c3d59fa62-+-toolforge: Update the version string to match our software

44bd5eb46b-+-decom dbproxy100[49]

98f6c17164-+-install etcd-client on cumin hosts

0a06c0460f-+-Anycast recdns mon: use raw IP, for real this time

a15156910b-+-analytics::refinery::job::druid_load: add netflow job

b4d2e996f6-+-db1065 decom

f1929d8cc7-+-Anycast recdns monitoring: use raw IP

a54fac46a9-+-Anycast, make recdns VIP alerts page

0ef6a42387-+-profile::prometheus::jmx_exporter: allow IPv6 polling

a1bb7bfd37-+-mariadb: Decommission dbproxy1004 and dbproxy1009

30092320c0-+-openstack: enable L1 cache flushes in base Nova class

2e6627e01b-+-puppetmaster: pass canary_host via the profile class

9950ad70c7-+-Fix kernel option

07b4502d1a-+-puppetmaster: Add the ability to have canary backends

c01799d308-+-Fix name for kmod::options, it needs to match the kernel module name

3683eada52-+-Configure unconditional flushes of the L1 cache during VMENTER

7a6c800267-+-mariadb: Promote db1128 as master for m3

5fcf6436a3-+-toolforge: fix typo kubelet file content

9e47415cd0-+-toolforge: add internal pause container to all the other kubelets

a8bd6bbd0e-+-Fastnetmon: disable Graphite, fix notify script path

eec1760171-+-role::alerting_host: Remove support for jessie

d5634aa837-+-Enable seccomp-based hardening for apt on Buster and later

e56ac5fa52-+-varnish: fix varnishreqstats systemd::service usage

46e27d429b-+-varnish: ensure varnishreqstats is absent

08de6f960d-+-varnish: remove varnishreqstats-based alerts

6939b65a86-+-profile::kerberos::kadminserver: add script to create principals

1defd77b7c-+-mariadb: Provision dbproxy1013

9899b1c832-+-registry: introducing read only mode for maintenances

72d247efcf-+-Phabricator: Remove support for jessie

9d848d68f4-+-Clean up eventlogging_service_uri from maps.

4520ae113f-+-Clean up eventlogging_service_uri from RESTBase profile.

a5b9a7f5cf-+-icinga: update toolschecker webservice interval

0b98be2562-+-toolforge: k8s: kubadm: calico requires ipset

8c3748abfb-+-Stop installing pear packages on MW Application Servers

541de71673-+-Add net-tools to standard packages

3b11b7deb9-+-maintain_dbusers: Read LDAP servers from Hiera and switch to read-only replicas

7ac5b83e82-+-profile::tlsproxy::service: add more granularity in monitoring

c51b26e4cd-+-contint: remove contint::php

b19f5f5514-+-contint: no more include ::contint::packages::ruby by default

f630ac021a-+-contint: remove sqlite3 debian package

c8c2a970ef-+-contint: apply apt::unattend_upgrade at role level

090694ade2-+-contint: remove php packages

65c6b2408a-+-releases: inline php packages installation

88fae08086-+-mariadb: Productionize dbproxy2002 into m2-codfw

8d1c353da9-+-xhgui: Read LDAP servers from Hiera and switch to read-only replicas

a7705f4295-+-replace hiera calls with lookup() for dumps distribution manifests

8d34a3772e-+-netbox: add missing notes_url for Icinga

f26651b807-+-etherpad: add missing notes_url for Icinga

1d8c2768f4-+-otrs: add missing notes_url for Icinga

5cbef3cef6-+-acme-chief: add missing notes_url for Icinga

ee7e481c5e-+-mx: add missing notes_url for Icinga

8f8be74d85-+-logstash: add missing notes_url links for Icinga

3e652cd3af-+-wdqs: add missing notes_url for blazegraph icinga checks

dcbcf5e1d7-+-nrpe/icinga: make notes_url a required parameter of nrpe::monitor_service

6130168c15-+-Remove changeprop::eventbus_uri variable.

73e6073d3e-+-librenms: Read LDAP servers from Hiera and switch to read-only replicas

3686a4eade-+-tendril: use ldap-ro, use Hiera, refactor to profile

1f5ac8ada2-+-netbox: stop using ::passwords::ldap:wmf_cluster

3c90a0e303-+-static-rt: LDAP config, use ro, Hiera and new password classes

69e5c601e5-+-xhgui::app: use ldap-ro, stop using ldap-labs

f6bb832407-+-prometheus: refresh prometheus-varnishkafka-exporter on configuration change

0d3320e64f-+-prometheus: add varnishkafka job to prometheus scrapes

8d71b8cf9e-+-tooforge: actually place the default-psp file on the master server

ac938d5a69-+-profile::hadoop::master/standby: add CMS old gen monitors

ae6b1b92fb-+-microsites/transparency: use ldap-ro, stop using ldap-labs, use Hiera

d4c3967175-+-role::analytics_cluster::superset: add TLS proxy

7cd1c93193-+-k8s: introducing cluster-dns flag for coredns

dcfbc5e470-+-grafana: Read LDAP servers from Hiera and switch to read-only replicas

a6a54a38eb-+-Superset: Read LDAP servers from Hiera and switch to read-only replicas

f94695b7ee-+-yarn: Read LDAP servers from Hiera and switch to read-only replicas

65245ed43f-+-turnilo: Read LDAP servers from Hiera and switch to read-only replicas

bfca33e664-+-icinga: Read LDAP servers from Hiera and switch to read-only replicas

b1f876adb0-+-mariadb: Replace dbproxy1006 with dbproxy1014 in m1

032a43329e-+-debmonitor: Read LDAP servers from Hiera and switch to read-only replicas

8f0eebb54d-+-profile::mediawiki::jobrunner: Configure php7_only flag

b2ef5bae73-+-replace all hiera clls with lookup() for dumps generation manifests

7cc06d1df7-+-Revert "librenms: use ldap-ro, stop using ldap-labs, use Hiera"

0fd0c361dc-+-librenms: use ldap-ro, stop using ldap-labs, use Hiera

b788e69b65-+-cache: add role::cache::text_ats

c855836b6d-+-netbox: Read LDAP server from Hiera and switch to read-only replicas

41266bf77b-+-graphite: use ldap-ro, stop using ldap-labs, use Hiera

bf7d953059-+-puppetboard: Read LDAP servers from Hiera and switch to read-only replicas

c89afc4527-+-superset: move httpd proxy config to a profile

93b73680c1-+-mariadb: Provision dbproxy2001 into codfw m1

3cd0a9e551-+-icinga: stop using ::passwords::ldap:wmf_cluster

c69d0545d8-+-Remove support for jessie from Phabricator classes

09a4fc5263-+-Add Fastnetmon to the netinsights role

26db93816b-+-cloudstore: allow rpc.mountd traffic between hosts

a9b8f37864-+-build_notes_url(): Don't quote if single url

e997dd51ec-+-profile::tlsproxy::service: allow to modify the Nagios contact_group

34f3506288-+-puppetmaster: add type checking ro puppetmaster::web_frontend

a9667bc15f-+-role::analytics_cluster::ui: add health check for Yarn and Hue

22a7238c34-+-piwik: Read LDAP servers from Hiera and switch to read-only replicas

e2ca85e3b8-+-helmfile,deploy: bug: secrets.yaml should be inside private folder

600455b461-+-profile::mediawiki::jobrunner: Enable feature flags

399d6bca2b-+-Pass use_nodejs10 to proton

d1e3079362-+-Add idp1001 to site.pp

19b1df5855-+-Correcting package name in transform function

272bc3f95a-+-Make Icinga alert on Grafana RPKI alerts

064dc0d0db-+-prometheus: wire up prometheus-varnishkafka-exporter for deploy

b76ec2c917-+-Bumping up jar version of refine and adding transform function

4396dad312-+-nrpe: remove tests directory

93e9e20e33-+-toolforge: remove class redeclaration

5b3112f855-+-Switch RESTBase event production to eventgate. Step 1.

f798f99d31-+-Add change-prop event_service_uri and point at eventgate-main

f868248fcc-+-toolforge: Enable pod security policy

a560faa760-+-Add monitoring for unmerged patches in the /labs/private repo

fb2ee3353a-+-toolforge: include the kubeadm_docker_service

7be550afa6-+-Switch profile::openldap::management to obtain the LDAP server from Hiera

d3d92ffa14-+-Revert "toolforge: Enable pod security policy"

5dcae940cb-+-ReportUpdater: change repo of all queries to reportupdater-queries

9897b00828-+-toolforge: Enable pod security policy

ed38b41c23-+-role::analytics_cluster::hadoop::ui: add TLS proxy

bc1f32e2d2-+-Add profile::tlsproxy::service

9096ea983d-+-toolforge: k8s: kubeadm: reorganize and cleanup module code

c8a0c8c3a6-+-toolforge: k8s: calico_workaround: convert from profile to module

24745bfebe-+-Extend Hiera LDAP config

ab928d531a-+-tlsproxy::instance: allow overriding ssl compatibility mode

037e36416f-+-toolforge: k8s: introduce calico workaround for the iptables backend in buster

c4904bb934-+-standard: remove has_admin global variable

af3cb31bf6-+-Remove sarin/neodymium from grant/mysql root hosts

229057b6fc-+-logstash: add consumer for client errors

227a536851-+-Don't page on mgmt failures

a7e034f94f-+-amd_rocm: add support for ROCm 2.6

0d6d34f652-+-profile::statistics::gpu: upgrade to ROCm 2.6

8349d84617-+-mariadb: Set db2045 to spare for decommissioning

5ea5466f5a-+-postgresql: add icinga notes_url for postgres repl lag

0073d939e1-+-proxysql: add icinga notes_url

5e0de907b2-+-Refine mediawiki_revision_create events using schema aware Refine job

4345aecc2a-+-trafficserver: add Icinga notes url for nrpe_monitor_script

0c90472cea-+-profile:service_proxy: Add more hiera variables

cbde75de49-+-Set cloudvirtan* to role::spare::system

a4c3ec0ffe-+-standard::base - reorder: Ensure admin runs early

3bf35175a1-+-maps: Remove support for jessie

b32ec97d76-+-prometheus: fetch ATS origin server metrics

b27b6a30ce-+-puppetmaster1003: convert puppetmaster1003 from spare top puppetmaster::backend

65cbef5d7b-+-Icinga - prometheus::alert: ensure dashboard links are not url encoded

253a5199f9-+-ATS: add atsbackend.mtail

70ce290330-+-ATS: add support for atsmtail systemd services

6943841872-+-Revert "ncredir: Fix notes_url"

3eaf29a4e4-+-ncredir: Fix notes_url

b9e559f664-+-ncredir: Set notes_url for https_ncredir

e170e19483-+-Add rsyslog delivery actions failure alerts

e5d17dd5e6-+-prometheus: add kafka logging consumer lag alerts

6436dabfea-+-Remove lithium from service

b034aac9a9-+-db1065: Prepare decommissioning

71a42b097c-+-profile::mediawiki::deployment::server: Remove support for jessie

cf95791df9-+-Move revision_visibility_change  Refine job to schema aware version

75cd4744a3-+-noc: Remove support for jessie

52ce0e137b-+-kafka-main100[1-5].eqiad.wmnet install parameters

aeebd40bc4-+-toolforge-etcd: tell etcd to check client certs

df958cb082-+-toolforge: Switch up using etcd client certs in k8s a little

d26771d0af-+-profile::grafana::production: Remove support for jessie

cb2502ca16-+-systemd::timer::job: Add optional $max_runtime_seconds

342b60130d-+-nrpe::check_service: add dashboard_links; add one for disk_space

1bb44a9733-+-monitoring::build_notes_url: add spec tests

ead5c71a02-+-striker: Update package dependencies

e6ce9825fb-+-Introduce module amd_rocm

49de27f7f2-+-toolforge: kubeadm master nodes shouldn't use client certs for etcd

850b9b1cf5-+-Revert "syslog: add temp rsync to copy data"

8f97d5369f-+-lvs: Add ncredir service to high-traffic1

c294b98ba6-+-monitoring: extract build_notes_url() function

37b9fc9205-+-mariadb: revoke servermon grants

d34d086eaa-+-mariadb::ferm_misc: remove firewall rule for servermon

7f0c16ba8b-+-mcrouter: allow async foreign set/delete WAN cache operations

1702881d38-+-helmfile: bug, it also needs the parent directory

9a907c0ad4-+-deploy,helmfile: little refactor and introduce admin_services_secrets

617ed28f0c-+-decom db2042

7896626f26-+-toolforge: k8s: kubeadm: now using external etcd servers

3ac1ac8035-+-Add wikishared DB to databases available in superset

657888a684-+-install parameters for puppetmaster1003

4d85ae87d2-+-sssd: fix path for pam-auth-update

5641f727ca-+-profile::hue|swap: use new ldap hiera configuration

016879f3d5-+-Create two LDAP replicas in codfw

0d0a4eebca-+-role::swap: add profile::base::firewall

19a0d82d1d-+-nrpe: $critical is a boolean, NOT a string! 😤

4bf4f60d41-+-wdqs: update response time check to new prometheus metrics.

89834163e0-+-ipmi - pxe: Ensure ipmi is not overriding the boot order

c6c705fc99-+-contint: remove zuul-cloner from Docker agent

17fd9eb119-+-contint: remove unneeded profile::ci::hhvm

4997ab4f96-+-contint: remove several unused packages

03220077c5-+-contint: remove unused contint::packages::python

370b0b9029-+-ntp: move the include of standard::ntp out of role and into profile

eba83e2a30-+-syslog: add temp rsync to copy data

3afb8303f1-+-Remove standard::diamond and fold into profile::wmcs::instance

c3d199c4d9-+-Remove sudo users formerly used by Diamond collectors

06d7ee81d2-+-Remove jessie support from Kafka class

a46b7acc73-+-Remove sudo user for already removed Diamond collector

cab4408e99-+-Drop jessie support from tor class

2d391a2782-+-planet: Remove support for jessie

a9a79c2020-+-netmon: Remove support for jessie

5f37172591-+-delete servermon role and module

f84861685a-+-toolforge: install fish shell

cb661fb126-+-check_prometheus: done allow unescaped exclamation marks

0e5af16c77-+-wmcs: scale iowait to number of CPUs

4270e42aea-+-wmcs: swap check_graphite for Diamond metrics with check_prometheus

543f37a459-+-dbctl: install package on cluster management hosts

2996044289-+-conftool::client: convert hiera->lookup

f6667148b7-+-Remove sudo rule for removed PowerDNSRecursor Diamond collector

1d91849b93-+-Remove CherryPickCounter Diamond collector

d5de99189d-+-mariadb: Promote db2069 to be the new x1 codfw master

fcd6990165-+-Remove Diamond from production hosts

e1bb13d853-+-contint: remove MySQL related configuration

2f89228a2a-+-contint: drop contint::tmpfs

56bfa22aaf-+-contint: remove colordiff

b937520d0a-+-analytics: add notes_urls for cluster client and mysql

93b8831df8-+-remove netmon1003 from site.pp

0fad41926b-+-swift: hierarize container_replicator settings

89257e5408-+-swift: hiera-ize object server number of workers

e26eb8728f-+-swift: hiera-ize object-replicator interval

dc767875c3-+-geoip::data::archive: remove parameter

4af7adf656-+-Removed checks for Trusty in os_version

d3e6b9ab3d-+-geoip::data::archive: move to kerberos::systemd_timer

f1c35196d7-+-profile::hadoop::spark2: fix port range

047e6a1a81-+-mtail: pass either 'present' or 'absent' to ensure

1590a7e2d4-+-varnish::logging: mask mtail.service

5bd46fb369-+-keyholder: hiera setting for require_encrypted_keys

acf8146485-+-Use 640 mode for swift auth env file

b6d2455145-+-Allow analytics-privatedata-users group to access swift auth env file

61d3c69d39-+-varnish: remove varnishstatsd

59027e162a-+-Revert "Revert "Revert "Revert "prometheus-mysqld-exporter: Automate targets based on zarcillo db""""

7169062bce-+-Revert "Revert "Revert "prometheus-mysqld-exporter: Automate targets based on zarcillo db"""

7b9ee46b9d-+-Revert "Revert "prometheus-mysqld-exporter: Automate targets based on zarcillo db""

4eb8bdfd65-+-Add prometheus node exporter for AMD ROCm's GPU stats

a627aea1d9-+-puppetmaster: remove severmon custom reporter

e3feb63f3c-+-profile::statistics::gpu: fix relationship

67a19b95b6-+-profile::statistics::gpu: switch to thirdparty/amd-rocm25

5661f3ee21-+-profile::statistics::gpu: add rocm-libs

57c3d481e2-+-profile::statistics::gpu: add rccl package

30edcdc7fd-+-profile::hadoop::spark2: limit the driver block manager's ports

9a4e5e3e8a-+-icinga icon: Use correct icon for notes_url

a9c58d56fb-+-phabricator: add forensic apache logging and enable on phab1003

23100e0081-+-Revert "setting install params for gerrit1001"

62238aa5a8-+-Disable DNSSEC for pdns-recursor in prod as well

c9787c00ee-+-cloud: Disable DNSSEC for pdns-recursor

9cc009816b-+-setting install params for gerrit1001

f7053105a8-+-rpkicounter, fix https proxy typo

99c9aef89f-+-Add rpkicounter

9c4a600248-+-profile::spark2: specify the spark.ui.port and its firewall range

bcdc41300d-+-pam/sssd: enable mkhomedir if needed

a89a8013c3-+-puppet: update puppet-termini package name on buster

5d07ea3214-+-puppet: refactor remove puppetdb_major_version

e23b2a3d9c-+-netbox: Add parameters and settings for storing things in Swift

69cc75d573-+-varnish: remove WP Zero puppetization

d33a58c37b-+-Remove obsolete comments

923fbed00f-+-Revert "prometheus-mysqld-exporter: Automate targets based on zarcillo db"

202be15e99-+-Revert "mysql-prometheus-exporter: Fix typo on puppet requirement"

cb93a874aa-+-Revert "mysqld-prometheus-exporter: Require python3 pymysql and yaml pkgs"

79abc5e1f9-+-mysqld-prometheus-exporter: Require python3 pymysql and yaml pkgs

4182dac5a1-+-site: Set ncredir role for ncredir[12]002 instances

8d4ebcf4e9-+-mysql-prometheus-exporter: Fix typo on puppet requirement

fec36be72b-+-prometheus-mysqld-exporter: Automate targets based on zarcillo db

06071f300e-+-Add orespoolcounter[12]00[34] to site.pp

f06252393d-+-Undeploy pdfrender: remove remaining classes.

de081b433b-+-gerrit: stop including passwords class in module

b1bcb08f09-+-ipmi: add icinga notes_url for IPMI sensor

7da1e1d66f-+-Disabling temporarily the 3rd party filter for EL events

f1bc74cf81-+-uwsgi::app: add notes_url for services using uwsgi

67e1e84735-+-Move all cloud VMs to the read-only ldap replicas

c2b135860c-+-Remove references to pdfrender from RESTBase.

772583cc90-+-Refine mediawiki_page* with schema aware Refine job

1cf3c85954-+-helmfile,k8s: bug: we should require the directory if not fails

5887498c30-+-eventstreams: add admins contact to eventstreams check

732a0826c0-+-helmfile,k8s: bug: we should require the directory if not fails

301f3b4df5-+-wmcs: fix type in variable names

0bbf63650d-+-labs_bootstrapvz: ignore /etc/nslcd.conf on buster

c729cde037-+-cloud: sssd: more checks to ensure we use sssd on Buster

67d8f78f3e-+-wmcs - ldap: ensure buster uses sudo not sudoldap

059190ebb7-+-helmfile,k8s: creating hfenv variables

bbf2570baf-+-Enable base::firewall on stat1007

c97cfba0d9-+-cloud: sssd: use by default for Debian Buster

66a657b4a9-+-No need to remove eject any longer

6d9199d085-+-profile::statistics::gpu: add rocm-smi to the packages required

d965845cb1-+-profile::statistics::gpu: fix packages installed

fc5e5cb0e9-+-profile::statistics::gpu: add packages from thirdparty/rocm

fe7d31f68b-+-package_builder: install the equivs package

19d95d42f4-+-profile::prometheus::mcrouter_exporter: enable per-server metrics

a4b863e0f5-+-monitoring: update icinga links to varnish-aggregate-client-status-codes

2f7b8466c6-+-mariadb: Prepare core for buster

ae4926ab99-+-kmod::blacklist: Cleanup initramfs trigger

42ee3330da-+-profile::base: exclude fuse.fuse_dfs from disk space checks

91da4c9e4d-+-apache::mod_conf: Remove support for Ubuntu

9da24f06c5-+-mariadb: Promote db1132 to m2 master

7fcca546cd-+-monitoring::graphite_threshhold: allow url encode  strings

2308719c7d-+-labstore: fix paramter name notes_url vs notes_link

dfa0a282f9-+-labstore: fix paramater type

b86e478568-+-labstore: ensure graphite_threshold uses numerics

19b32e8d8a-+-monitoring::graphite_threshold: add notes_link

060c745918-+-monitoring: Add type checking to monitoring::graphite_threshold

79b6125766-+-ntp/systemd: add notes_urls for timesyncd and systemd timers

ffd4fc5e1d-+-Revert "mariadb: Promote db2069 to x1 codfw master"

648e5de7e0-+-mariadb: Promote db2069 to x1 codfw master

f245443246-+-mariadb: Enable performance_schema on parsercache/misc

a3fdf5d570-+-prometheus: fix dashboard_links in k8s cache alert

9a1d14a9e9-+-prometheus: alert when k8s cache isn't updating

74d16f8e0d-+-ncredir: Use a custom access_log log_format

732382b284-+-base::monitoring::host: ignore /mnt/hdfs from disk checks

17967e96cf-+-Add poolcounter1004,1005,2003,2004 to site.pp

30ac150742-+-ncredir: Notify nginx when redirection_maps.conf is changed

868ddbb3d1-+-cache: rename cache::upload_ats role to cache::upload

612317d658-+-role::statistics::explorer: add base firewall

3c40cbbe09-+-mediawiki: add notes_urls for app servers

58df05fea3-+-adding a buster docker base image

535bf3e739-+-cache: reimage cp1090 as upload_ats

c10a39aad4-+-prometheus: Fix prometheus_puppet_agent_stats dependencies

ee16019571-+-cache: reimage cp1088 as upload_ats

e247338d54-+-site: Add ncredir[12]001 instances definition

25e8e201e7-+-cache: reimage cp1086 as upload_ats

592b6ae22c-+-cloudelastic: use the proper check for SSL certificates

51398e7121-+-Revert "prometheus-snmp-exporter: Switch to systemd::service"

a24363783a-+-prometheus-snmp-exporter: Switch to systemd::service

205614fee7-+-ncredir: Provide initial puppetization

9de8b8e708-+-acme_chief: Introduce the concept of shared certificates

3c26f0634b-+-mariadb: Decommission db1069

705896ac2f-+-cache: reimage cp1084 as upload_ats

d068f0290c-+-Update a number of comments still referring to Ubuntu

bb369a9eca-+-cache: reimage cp1082 as upload_ats

671fe50f97-+-profile::analytics::cluster::client: fix sudo::user declaration

a44a869527-+-profile::analytics::cluster::client: enable krb auth in test cluster

02ce7e1768-+-cache: reimage cp1080 as upload_ats

d89706f45d-+-profie::analytics::cluster::client: add kerberos support

129dcd6530-+-profile::hadoop::master: allow nagios to authenticate as hdfs

987122e2ce-+-icinga: revert regression

2fb51583de-+-icinga: notes_url remove trailing whitespace

525bb1069c-+-cache: reimage cp1078 as upload_ats

4d8097d694-+-profile::hadoop::spark2: allow a port range for the driver

6395108c4f-+-icinga/elasticsearch: remove notes_url param where it does not belong

0295eb77a3-+-icinga/elasticsearch: fix notes_link->notes_url parameter name

3e2cf745b8-+-gerrit: only ship gerrit.json to logstash, not *_log

4f10da4ede-+-toolforge: create etcd dir for the certs

aea387e398-+-toolforge: set up cert distribution for additional control plane nodes

c369eefef6-+-toolforge: correct the values for bootstrapping a cluster

660d733891-+-decom ms-be101[345] puppet repo entries

9eb2d9b029-+-cache: reimage cp1076 as upload_ats

3d83700768-+-Revert "Revert "cache: reimage cp2026 as upload_ats""

73d78ba2b7-+-Decommission cp3037

c0dfc73052-+-monitoring: add notes url for memory errors

a0797e072e-+-toolforge: k8s: apilb: specify path for systemctl call when reloading config

de7fad8301-+-toolforge: k8s: fix half-done code factorization for kubadm_join

c445296805-+-toolforge: refactor to join a node to the new cluster

16f2c5056c-+-helmfile: Set owner for secrets values

09bff0a7d2-+-wdqs: remove "mdc" prefix from logs.

447f191957-+-profile::hadoop::master: add Yarn unhealthy workers check

925db1f35c-+-toolforge: k8s: factorice preflight checks to the common profile

613496bbf9-+-install_server: Allow reimage db21[21-30].codfw.wmnet

24128046e8-+-Move the zookeeper submodule into the repository - part 2

53c819e94c-+-Move the zookeeper submodule into the repository - part 1

4b615e81f6-+-mariadb: Promote db1120 to x1 master

214cd52dfc-+-phabricator: Manage ownership of /var/log/phd/ssh.log

4877d14f58-+-toolforge: a firewall default of DENY is maddening for kubernetes

ceef469bf6-+-toolforge: reload haproxy on subconfig changes

c369e2165c-+-toolforge: add a join configuration to the init setup

ae2a26c8da-+-Revert "grafana: also install sqlite3-pcre"

4ce575285b-+-Revert "cache: reimage cp2026 as upload_ats"

56db066f8e-+-cache: reimage cp2026 as upload_ats

a48da75cd7-+-nova-fullstack monitoring: allow for more leaks before we alert

b1ac647f03-+-cache: reimage cp2025 as upload_ats

37b2e4be48-+-toolforge: add calico CRD config

74f9addfc1-+-excessive-lvs-rx-traffic: fix quoting error

89163d955f-+-Bird anycast: add anycast_healthchecker

47624e9f1e-+-lvs: alert on excessive network rx traffic

ea04c35bc7-+-toolforge: make kubeadm config allow stacked control plane

dd355e9a85-+-cache: reimage cp2024 as upload_ats

eb75780917-+-toolforge: k8s: more robust swap deletion operations

f68e64b4a7-+-role::puppetmaster::puppetdb Add postgres_exporter

547244f7a3-+-cache: reimage cp2022 as upload_ats

d81a7165de-+-helmfile: bug: contint* timers require full command path

e72bbdd7a8-+-set dump cron start dates and times back to normal

77f0b4dc85-+-cache: reimage cp2020 as upload_ats

83ac96db68-+-cache: reimage cp2018 as upload_ats

e306fd06ae-+-role::analytics_test_cluster::client: add kerberos config

451d789d3b-+-Assign role::analytics_test_cluster::client to an-tool1006

9a1f3118f8-+-Introduce an-tool1006

5d16b0dd15-+-grafana: also install sqlite3-pcre

26e1c8ae7a-+-start July 1 dump run at 10 pm utc

c95dd845fa-+-Limit EventStreams per X-Client-IP connections

4368cc2b66-+-toolforge: declare service for docker

510f75af9d-+-defer start of dump run until July 2

044bbd57f0-+-toolsforge: fix up the kubeadm config a bit more and configure docker

9f5b033619-+-toolforge: k8s: handle common kubeadm preflight checks

ba6f81d659-+-toolforge: k8s: introduce basic config file for kubeadm

fec5749787-+-cache: reimage cp2017 as upload_ats

97ecb5d1ef-+-Add 'Z' suffix to webrequest log dt format

892bd34afb-+-mediawiki::php: only install wmerrors where fpm is present

6fdca1d704-+-Skip ganeti[12]009 in site.pp

b6e681fe82-+-k8s, deploy: introducing helmfile for manage charts

d3391388b6-+-aptrepo: thirdparty/kubeadm-k8s: add cri-tools

a8eb2ca54a-+-kubernetes: Move k8s::infrastructure_config to profile

58fe8de7cd-+-mediawiki::php: install wmerrors everywhere

4e9c78073b-+-aptrepo: fix the kubeadm packages to include containerd.io

864c6a75aa-+-svwiki officially 'big', 6 dumps jobs in parallel like the others

d4c5a5d5b4-+-mediawiki::php: add a fatal error page to go with the proposed wmerrors feature

ffec68d2c2-+-defer start of July 1 2019 dumps until evening

12f022a3a1-+-cache: reimage cp2014 as upload_ats

67362d5fee-+-icinga: fix tools checker stretch jobs

241add3a7c-+-toolforge: the kubeadm repo can't be labeled trusted in puppet apparently

030884deeb-+-pdns: add rec_control profile to codfw1dev

9a55a1828d-+-cache: reimage cp2011 as upload_ats

32ba763d4e-+-Apply role netinsights to netflow1001

8ded84b5c4-+-profile::hadoop::balancer: remove unused kerberos wrapper

6e1d9fbc24-+-profile::hadoop::backup::namenode: move crons to timers

c03471a143-+-cache: reimage cp2008 as upload_ats

ce13a1a37d-+-profile::hue: add more specific alarms for kerberos

433b6c4d90-+-cache: reimage cp2005 as upload_ats

cac9f84406-+-nova-fullstack: fix name of nrpe check

09508805a4-+-prometheus restarts: clarify alert for global proms

5508477115-+-nova-fullstack monitoring: fix a misnamed file

cc0a59dee0-+-nova-fullstack: add a watch on the number of leaked VMs.

0764d7dd97-+-toolforge: k8s: add basic kubeadm infra

e173202b70-+-Move page_links_change back to new schema aware refine job

b517207b9c-+-kafka2001 move to role::spare::system

133ef14c49-+-decom db2039

aca01cb621-+-kafka-main: replace kafka2001 hardware with kafka-main2001

15a4509591-+-druid: ensure that the druid user is in the pupept catalog

f629bd1d0b-+-k8s: Make $extra_params type an array of strings

e60898fb39-+-nova-compute: fix dependency for cacert.pem

10887e9241-+-nova-compute: fix dependency for cacert.pem

8cfa81e93a-+-nova-compute: use puppet certs for libvirt

1309ad71b7-+-nova-compute: remove libvirt_type params

c12d06d250-+-nova-compute: consolidate a bunch of code that isn't distro-specific

3b27a32f3e-+-cache: reimage cp2002 as upload_ats

28f725b85d-+-icinga: Add a script to parse and query the status.dat file

8f2a9d2bdf-+-role::druid::test_analytics::worker: remove hadoop client config

4d3205bba9-+-Use more specific data types in k8s module

4b3b33d4f1-+-Add data types to k8s module

350969080a-+-role::druid::test_analytics::worker: add kerberos support

331ded7074-+-RESTBase: Remove restbase10(0[7-9]|1[0-5]) and set them as spares

4b8223dc3b-+-Move analytics client profile from hue to druid

f1fddf010b-+-role::analytics_test_cluster::hadoop::ui: add client config

b4cbf68e7b-+-toolforge: k8s: node: fix template path

c014a3c24f-+-profile::analytics::refinery::job::data_purge: avoid saturday

44a24ed6f8-+-toolforge: configure kubernetes node using TLS instead of token auth

df1947c514-+-icinga: fix zero division error for mjolnir bulk update alert

427183a6b0-+-wdqs: fix pattern in log configuration

270e2280bb-+-wdqs: publish full MDC in file based logs.

52910e22fb-+-Mask the default uwsgi service on puppetboard hosts

4a66b7de60-+-mariadb: Decommission db1068

fedf06c291-+-analytics::refinery::job::data_purge add deletion for data_quality_hourly

801d757f58-+-kafka2002 move to role::spare::system

c77d30eb70-+-profile::hadoop::common: set r+o to the trustore file

bfc2adeaf2-+-toolforge: correct a bunch of the apilb profile

8a96107d06-+-kafka-main: replace kafka2002 hardware with kafka-main2002

c5358d031a-+-cache: reimage cp5006 as upload_ats

4c6f936d22-+-mediawiki: run the cron for php restarts everywhere

03dafd848d-+-php-restarts: fix typos

76a4537679-+-haproxy: make monitoring code optional

934153067b-+-mediawiki::php: add daemon restart cronjob

147ed0457d-+-cache: add cp3043 back to the text cluster

56f9962fde-+-kafka2003 move to role::spare::system

6b647b4463-+-camus: add support for kerberos

7269a0ce1f-+-Replace profile::analytics::systemd_timer with kerberos::systemd_timer

1887852fa0-+-toolforge: k8s: master: allow connections to the API from any cloud VM

bd8cf4a295-+-profile: introduce lvs_poool_nodes

2b7fd81dbf-+-Re-enable TCP selective acknowledgements on hosts running a fixed kernel

c32c88c3cb-+-cache: reimage cp5005 as upload_ats

7d17ef2edc-+-role::mediawiki::jobrunner: convert to profile::lvs::realserver

d036d0582c-+-dsa-check-hpssacli: make compatible with ssacli

c64f466276-+-cache: reimage cp5004 as upload_ats

d79a52ed80-+-profile::graphite::alerts: remove unused code

932d268b27-+-cache: reimage cp5003 as upload_ats

73d53e673e-+-toolforge: remove junk from k8s::apilb

b5bdd776ff-+-toolforge: k8s: worker: disable swap

774a618bfb-+-toolforge: k8s: introduce basic k8s node puppet code

dd10436e2c-+-mariadb: Upgrade db1114 (testing buster host) to MariaDB 10.3

4e76cdcf2b-+-decom bast4001

84b8f7f88d-+-kubernetes: Incoming BGP should work over IPv6 as well

b29c19a714-+-kafka-main: replace kafka2003 hardware with kafka-main2003

531dc2cd72-+-raid: adjust sudo permissions for new HP RAID checks

3f461168e3-+-Remove now unused role::kafka::analytics*

0b3a1ee6fb-+-Set role spare::system for old analytics Kafka brokers

97624ccd64-+-Remove monitoring and alerts for kafka analytics cluster

ab4bcdaba5-+-safe-service-restart: require conftool::scripts

d9cd317c0d-+-profile::lvs::realserver: fixes to safe restarts

4c15d7a3db-+-cache: reimage cp5002 as upload_ats

bbca6c098b-+-etcdmirror: Ensure etcdmirror is disabled on the inactive hosts

b1637ba1f5-+-profile::mediawiki::webserver: count all nodes once

40d5ade168-+-profile::lvs::realserver: introduce ability to use safe-service-restart

30676721b9-+-conftool: add safe_service_restart define

52ddcc043a-+-ATS: mask varnish.service

16c04e1759-+-Introduce the kerberos module

348c2ac81f-+-cache: reimage cp5001 as upload_ats

da50e1fe53-+-Move cdh module from env/prod to modules

6541ed0985-+-Add missing /modules/ to cdh in environments/production

919c9d07f2-+-profile::hadoop::common: remove '::' in front of cdh::hadoop

a9abf83b5a-+-mariadb: Provision db1133 in m5

42ac5dedb0-+-Move the cdh submodule into environments/production

12d81e4a76-+-fix ganeti host entry

664ccd61d3-+-adding install params for ganeti400[123]

fd02d948c0-+-Allow $NETWORK_INFRA to use syslog/kafka

4c10ec80b0-+-Remove mediawiki-analytics (avro) camus job definition

ffdf0e5bed-+-Ensure mediawiki-analytics (avro) Camus job is absent

a1ddef8cbf-+-Refine page_links_change data using old Refine job

d2d52eba88-+-toolforge: k8s: specify scheme:// for etcd servers

88d2e4f7ca-+-toolforge: k8s: specify the port of etcd servers

19159879d6-+-toolforge: migrate k8s code from toollabs

bddde44f45-+-Revert "mariadb: Disable checks of database snapshots"

b63985dfef-+-peopleweb: Remove php module from httpd

2c6430e125-+-mariadb: Move db1135 from s4 to m1

31fbd809eb-+-Removing page_links events from refine whitelist

5e96ada39d-+-releases: Rely on cron alone for helm charts updating

1cb8bf036e-+-Add ferm rules for kpasswd

faebc5c536-+-toolforge: k8s: etcd: also create /etc/etcd

1610fdecc2-+-toolforge: k8s: etcd: refresh server with certs changes

40cd49bec4-+-toolforge: k8s: etcd: enable 2379/tcp for peers as well

7c156a1f76-+-toolforge: k8s: etcd: use domain names instead of IP addresses

680bf1eeef-+-profile::hue: add a parameter to selectively enable oozie security

7fd0fa805c-+-cloudstore: add sudo config for the nagios user

301cb59d7e-+-role::mediawiki::jobrunner: Add php_fpm_exporter

d74b8035e4-+-profile::kerberos::keytabs: add parent_dir_grp option

c34b72e2af-+-mariadb: Move db1077 from s3 to test-s4

2833a4a08a-+-toolforge: k8s: etcd: use complete fqdn in node name

bf620dd577-+-toolforge: k8s: etcd: add etcd user to the puppet group

3dfca34f09-+-dologmsg: move this little script out of toolforge profile

6bd92fa49c-+-toolforge: k8s: etcd: specify more certificates

2465efef78-+-toolforge: k8s: etcd: don't wrap profile::etcd, and use base etcd v3 directly

f922d95f87-+-cloudstore: move secondary monitoring stuff into profile and fix it

d22c39d671-+-dumps distribution: enable the service for nfs to start on reboot

c5cf87c061-+-CI: Create lightweight agent role for Jenkins

a078910b88-+-firewall logging: make profile::base::firewall::log  a private class

f885a99669-+-firewall logging: clean up old roll-out class

a8c9bfe7a0-+-firewall logging: clean up old roll-out classes

c77b0b4f36-+-firewall logging: enable ulog by default

7f30829cc1-+-firewall logging: Enable logging on external servers

0738c7e81c-+-profile::kerberos::keytabs: fix typo

639ba6cf37-+-icinga: cirrus masters eligible check

35d86941f6-+-profile::kerberos::keytabs: ensure the keytab's parent dir

54f7307077-+-Allow Hadoop-related profiles to deploy Kerberos keytabs

0b96aeaef8-+-db1112: Move to s3

f469712a27-+-mariadb: Promote db1081 to s4 master

2595b78bc5-+-phabricator logmail requires /usr/bin/mail be installed

8841bafe66-+-phabricator: change owner / mode on redirect_config.json

e86a9bf871-+-sysctl: fix new fact

332d031746-+-cap mss: to 538

b3d12a9c54-+-Make eventlogging_eventbus Refine job use more explicit whitelist regex

b34a4065a0-+-Move newly migrated eventgate-main tables to new Refine job

fbfedcf0d0-+-Network monitoring, make core router down page

2e8cf317bd-+-termbox: Use HTTP for WMF service checks

22b0c95bf1-+-Introduce termbox LVS configuration

794be706d8-+-mariadb: Set db2039 to spare

37d46ab4e8-+-Disable TCP selective acknowledgements

86dfa3947f-+-varnishlog: implement varnishfetcherr

06412fe78c-+-Update timer descriptions

50cc44cf69-+-toolforge: make backup registry optional (for toolsbeta)

6753d67f42-+-Revert "gerrit: bump heap limit"

9694f8087f-+-Puppet certs: Move old client certs away when Puppet CA changes

72e50df4ee-+-Puppet CAs: Make it easy to swap CAs by hiera change

56f9b6273a-+-profile::hive::*: add jvm heap usage alarms

9a56052989-+-Deprecate the use of profile::hadoop::users

318dfdf106-+-profile::analytics::refinery::job::refine: restore filter

49bda47c8f-+-install_server: Allow installation of new dbproxy

b7763c8eec-+-profile::discovery_dashboards: remove Wikipedia Portal dashboard

4f2a436eee-+-labsdb: Setup labsdb1010 as a web wikireplica

fdf6ff0f11-+-labsdb: Move labsdb1010 from analytics to web to ease the extra load

97b24d5421-+-Eventlogging - Blacklist the PageIssues schema

fc9647d678-+-A more flexible approach for mjolnir update lag

e967cc2f29-+-Remove unused geoip archive cron

70b7dfaae6-+-Convert geoip::data::archive to systemd timer

0f892d3a10-+-Fix incorrect to_emails parameter for analytics Refine jobs

b197f3a6a1-+-Include Swift analytics_admin auth .env file in HDFS

e936a98f2a-+-Use method gt instead of ge for eventgate validation error throughput alerts

38581a0994-+-Add monitoring::alerts::kafka_topic_throughput and use it for eventgate

ee321ea13a-+-Enable HCatalog support in hadoop test cluster

6ac6be7389-+-profile::analytics::refinery::job::refine: remove transform function

93b0e9b043-+-cp3037: normalize config of dead node

f9215af21e-+-dologmsg: fix error in file definition

30d3dee8b1-+-dologmsg: extract variables from Toolforge dologmsg

310c51f6a2-+-cache: reimage cp3039 as upload_ats

0478608fd5-+-systemd::timer::job: always provision NRPE plugin

7f56f7d8b4-+-cache: reimage cp3043 as upload_ats

9c24a0cc8e-+-mediawiki::php::monitoring: use runbook links in notes_url

e1890272d8-+-mariadb: Move db2051 from s4 to s2

2d49b79878-+-openstack: allow designate to access puppet encapi

6d596279e7-+-mediawiki::php::monitoring: fix some numbers

c77b058b0e-+-mediawiki::monitoring::php: fix path of source

d0ada68ef3-+-mediawiki::monitoring::php: remove redundant reference to the runbook

18aee07bf1-+-mediawiki::php::monitoring: fix path

30ea7136bc-+-mediawiki::php::monitoring: add checks for opcache status

85aa82c39a-+-profile::kerberos::kadminserver: add auth_users to rsync's module config

0f817b214c-+-Increase priority of php-mailparse

cb5c068574-+-analytics::refinery::job::refine Bump up refinery_jar_version

ce8cc2d716-+-phabricator: Install php-mailparse

82d5c2ac38-+-toolforge: migrate etcd code from toollabs

0202a4c257-+-Remove support for Ubuntu in apt/debmonitor base classes

5bbddc1d26-+-icinga: fix permission of contacts.cfg

8c9ef56a4e-+-ATS: Provide a TLS terminator profile

c66bc4ab0e-+-profile::mediawiki::mcrouter_wancache: set timeouts_until_tko to 10

236351a49f-+-icinga: manage metamonitor known_hosts

806ff8846a-+-mediawiki::php: use the safe script to restart php-fpm

394152f208-+-conftool::scripts: add a safe-service-restart script

2daf8fbd71-+-Remove support for Ubuntu/trusty in monitoring/metrics base classes

3814799432-+-swift: Remove support for Ubuntu

05c84a9a06-+-cpufrequtils: Remove support for Ubuntu

d89dfdbb95-+-sslcert: Remove support for Ubuntu

542fcc8374-+-profile::kerberos::kadminserver: fix rsync module's ensure arg

c957d1b525-+-mariadb: Provision db1132 into m2

7b1868b984-+-ntp: Remove support for Ubuntu

7d7c5270c8-+-profile::kerberos::kadminserver: add generate_keytabs.py

1fb45bc658-+-profile::kerberos::kadminserver: allow puppetmaster to rsync keytabs

1c88374ee5-+-mariadb: Promote db2046 to s6 codfw master

554d997c58-+-mariadb: Prepare db2042 for decommission

5414ecc75a-+-certmanager: Set up config for running inside labs realm

d67133f567-+-mcrouter: allow to tune timeouts until tko

84901e4dde-+-openstack: eqiad1: services: unify primary/secondary roles

7427e25b78-+-firewall logging: enable firewall logging on external servers

3e16cd0f0d-+-openstack: remove unused common class

5f144ac6ee-+-ATS: Avoid using traffic_layout

2d7ab46304-+-ATS: Ensure proper permissions for ATS layouts

bf850a9ada-+-Include grub::defaults unconditionally

71113577d7-+-mariadb: Temporary: place db1135 into s4

aa89e98562-+-cache: reimage cp3035 as upload_ats

e1e230676a-+-base: Remove support for trusty/Ubuntu in multiple places

0a4bf554f7-+-Stop using transitional package names for Icinga plugins

1d17ce2073-+-mariadb: Promote db2090 to codfw s4 master

07bae63807-+-rsyslog: remove syslog json template from netdev_kafka_relay

660d121e6f-+-Remove type of $port; it doesn't work via horizon hiera interface

96ec7cf529-+-rsyslog: add netdev_kafka_relay compatibility endpoint

5a294b37f8-+-profile::eventschemas::service - allow server_alias to be configured via hiera

9b62efdd0b-+-Allow configuring eventschemas service port via hiera

9c826a930b-+-remove labstore100[123] repo entries

06b501490c-+-Remove duplicate /openapi from sessionstore OpenAPI checks

c467f37196-+-sessionstore: Use /openapi, not /?spec for validation

6fae564bf5-+-ATS: Provide parent proxies support

3029c04231-+-Add zh variants to beta wikivoyage

ec91ddb94d-+-ATS: Provide a unified logs define

2b7d5a8172-+-cache: reimage cp3035 as upload_ats

69a6f8c67f-+-Remove support for trusty/Ubuntu in kernel/sysctl settings

6aba194c35-+-firewall logging: Enable firewall logging on mediawiki

c1355dc5db-+-Remove support for Ubuntu/trusty in base packages

70a05c3d6f-+-Decommision darmstadtium

786f3df64a-+-prometheus: fix missing parentheses in openstack/rabbitmq exporter

87d1628ff7-+-Fix sessionstore LVS monitoring duplicate stanzas

47cb6ab7ef-+-openstack: drop hiera key profile::openstack::base::monitoring_host

5c13c7e3d5-+-Introduce sessionstore LVS configuration

38113870a8-+-openstack: designate: service: fix ferm syntax

805e4f682c-+-openstack: designate: allow prometheus servers to reach the API endpoint

3a000ea2a7-+-profile::memcached::instance: Add -R 200 option

5ecde2d8f5-+-firewall logging: enable logging on ores

122515931b-+-profile::memcached::instance: Migrate to lookup()

2645d136f5-+-prometheus wmcs: store metrics from the secondary pdns server

8685ee2ff5-+-icinga: add metamonitor user and its keyholder

001eb10252-+-ATS: Provide more accurate monitor descriptions

cdcbf7f6df-+-ATS: Fix trafficserver-exporter nrpe check

f81bc1d652-+-ATS: Provide a unified monitoring define

70f91f474e-+-mariadb: Move db2058 to s6

f2044f9220-+-mariadb: Move db2065 to m3

9f291c71bd-+-modsec: deployment modsec rules with scap

68b9e45420-+-cloudstore: add the rest of the monitoring for cloudstore1008/9

5d9bad043d-+-Add profile::kerberos::client to the Hadoop testing cluster

ac2ec253f5-+-cloudstore: fix ldap check

c0ea5e88be-+-cloudstore: enable more monitors on cloudstore1008/9

fc66b06968-+-labstore: switch labstore1003 to the spare:system role

c9a9aa17dd-+-acme_chief: Enable SNI prevalidation for non-canonical certificates

88fab13a06-+-cloudservices: use prometheus pdns exporters in all roles

3fc500b96a-+-cloudservices: use unified prometheus_pdns_rec_exporter

fafa52b3fe-+-prometheus: Toggle SSL certificate verification for trafficserver-exporter

151f9e897c-+-prometheus: pdns_exporter: use hiera keys to define prometheus nodes

1a6a7ff8d2-+-db1064: Prepare for decommission

bc621e2a60-+-varnishkafka webrequest: log Server: in response as 'backend'

34448f53ae-+-db2037: Prepare for decommission

758edc0969-+-Update password file paths for the monthly Analytics sqoop jobs

531eebd96e-+-labstore: remove hieradata for labstore1003/misc and strip down puppet

1801c3d870-+-cache: reimage cp3034 as upload_ats

e4febae6f1-+-cloudstore: scratch is a rw mount

44480cc1fe-+-cloudstore: switch maps mounts from labstore1003 to cloudstore1008

f50925e314-+-remove orderrevs param from dumps manifests

48e679c7a2-+-prometheus: Support TLS enabled pods

406591316e-+-mediawiki::php: use 10 seconds as revalidate frequency everywhere

06cc94b74e-+-cache: reimage cp3049 as upload_ats

f2559bfdb3-+-firewall logging: enable firewall logging on remaining roles

9a44045045-+-Revert "Phabricator: Fix aphlict to not try and start service if ensure == absent"

a17bd7862b-+-Phabricator: Fix aphlict to not try and start service if ensure == absent

f82cbca84d-+-Add IPv6 to RPKI hosts

1c5c1f6192-+-firewall logging: Enable logging on misc services

8f0a771634-+-flake8: Add python extension so theses scripts can be picked up via CI

adffb34d9e-+-cache: reimage cp3047 as upload_ats

7725b1f0ca-+-flake8: update python file extensions so they are detected by CI

0b0f1cb27e-+-firewall logging: add firewall logging to kafak servers

a0af7bed2f-+-sssd: include the /etc/ldap.yaml file

28de949577-+-Introduce profile::analytics::search::jobs

61954fd127-+-mediawiki: if guard php72_only blocks

baa7aa09e8-+-openstack: keystone: install mysql client binary for cleanup operations

5ebd76bab2-+-Fix passing ssh key on releases hosts

ec0814fd89-+-phabricator: remove role from phab1001

307e057f86-+-profile::netbox: Tweaking report alerts

78b9605075-+-add miscweb2001 to role webserver_misc_apps in site.pp

dcb0c1fbf9-+-cache: reimage cp3044 as upload_ats

7ee443a798-+-Prometheus, add Routinator endpoint

e32998e290-+-profile::netbox: Fix user that runs netbox reports

d640b8873e-+-nfs-exportd: get essential openstack information from yaml files

537dbd1d2c-+-dns_floating_ip_updater: fix some broken rename changes

7edcba6392-+-Routinator, make routinator user system

f59a0a9ff9-+-rabbitmq: open firewalls for rabbit communication both ways

a08ef5322b-+-Puppet, add RPKI validation daemon

1ca0afa106-+-cassandra: Support client IPs in ferm

ca8d6b046d-+-site: remove duplicate node definitions

f05726805e-+-Convert cirrus data retention from cron to systemd.

456bdb71c7-+-firewall loggin: enable firewall logging on analytics servers

9b56b29a5f-+-mariadb: Disable checks of database snapshots

0f43b407d8-+-phabricator: remove cron to restart httpd

854c814f12-+-phabricator: stop paging SRE for process checks, keep for https

67f1ed2ce8-+-Revert "webserver_misc_apps: add PHP7.2 APT repository on stretch"

086c582fa0-+-glance: remove --delete from the image sync command

0167a2d55a-+-delete the cgred module

f092258000-+-Add jenkins-agent user to releases-jenkins

baad4e41ba-+-cloudstore: switch scratch mounts from labstore1003 to cloudstore1008

d25b96f8f8-+-profile::netbox: stop using icinga as remote cron

abbeee4678-+-keystone: make the api service active on both controller nodes

fbee4fd7bf-+-firewall loggin: enable firewall logging on wmcs servers

a9af9f64cd-+-logstash: add deprecated-input tag to deprecated inputs

aa11ea403a-+-parsoid: add local udp syslog shim

61ea671654-+-Reclaim sulfur to spares

1de60dd664-+-firewall logging: enable loggin on internal servers

9b1fc0f3f8-+-sudo: decouple sudo from sudo-ldap

dc6eff91a6-+-Add a pbuilder hook for the VP9 component (used on the video scalers)

7c21fe7ce5-+-keystone: add firewall rules to acess from the nova controller

ecaa6770f2-+-autoinstall: add support for EFI

449b9f8cb9-+-designate/pdns: allow db access from standby to primary

e9783b9e8f-+-designate: improve firewall rules for memc access

7be4d8d1c6-+-pdns3hack: don't pin pdns-recursor to the old repo

fdff096208-+-openstack: designate: mitaka: stretch: use pdns 3.x

034ba2eb8e-+-Convert cirrus data retention from cron to systemd

dcd08f1285-+-graphite: more robust swift thumbnail alerts

0394c2e957-+-graphite: fix dashboard links for thumbnail alerts

56c91b5db8-+-Revert "cloudcontrol: temporarily mark out prometheus classes on Stretch"

883f7b97b2-+-openstack: clientpackages: mitaka: stretch: special case for py3 client libs

c1b940d5fa-+-openstack: mitaka: stretch: don't install python3-msgpack from jessie-backports

79a6c5beb1-+-cloudcontrol: temporarily mark out prometheus classes on Stretch

ba75d047cb-+-openstack puppetmaster roles: duplicate for set of profiles to be used in labs

b93f94062c-+-openstack puppetmaster profiles: don't include clientpackages

3cf128b98b-+-profile::netbox: Add librenms configuration for reports

f671575019-+-icinga: fix location of meta-monitoring script

51fef28cf7-+-icinga: correct cirrus settings file name

57cc0e4cd7-+-icinga: create and apply cirrus settings check

b7bb137e45-+-Decommission rhenium

7fd71436bb-+-mariadb: Move db2062 from s1 to m1

325a7045c5-+-profile::librenms: Fix irc password

063c19a451-+-profile::librenms: Minor refactor for parameters and type hints

cd0f9652c1-+-striker: add example documentation

844071dea9-+-webserver_misc_apps: add PHP7.2 APT repository on stretch

9f55bb5656-+-webserver_misc_apps: move httpd setup to a profile

c54217a6d4-+-neutron: make the neutron api server ('neutron-server') active/active

2bf8e9629a-+-designate: make designate nodes active/active

3f6daf27eb-+-nova: make all services active/active

6ab34828e1-+-Install python3-swiftclient on analytics cluster nodes

14d2994514-+-phab: Configure sapis for all php extensions

5c3bc6948f-+-eqiad low-traffic: re-order LVS array

9598145cf5-+-lvs1001-6: remove prod cfg for spare reimage

8282e14146-+-profile::mediawiki::php: make apc size configurable, bump for appservers

2eb3f7dd6d-+-Set spares for ms-be[12]01[345]

8b799c03fb-+-mariadb: Provision db1128 into m3

a88fefe922-+-mariadb: Remove db2040 for decommission

507578321f-+-phab: include php-ldap in the php-fpm config

b69456f1f7-+-Revert "phabricator: rsync /srv/repos from 1001 to 1003"

1961c07368-+-switch phabricator from phab1001 to phab1003

1dfca7aa05-+-phabricator: rsync /srv/repos from 1001 to 1003

0724d167de-+-strongswan: add an Icinga notes_url

8b2be7cb11-+-update node exporter metrics to 0.16+ names

ad25d2b6f4-+-clouddb2001-dev: adjust firewall rules to allow access to both cloudcontrols.

c1bd3a1a78-+-cache: reimage cp3046 as upload_ats

7696070efa-+-flake8 - misc: add py extension so CI can run

7977508c54-+-Make the openldap class compatible with Cloud VPS

2537631fbd-+-role::deployment_server: fold in the base class

b8c93ffabe-+-profile::mediawiki::deployment::server: rationalize puppetization.

208301164c-+-profile::mediawiki::scap_client: rationalize scap2 installation

050189f830-+-profile::keyholder::server: profile for keyholder installation

e97f7c6c95-+-ATS: Fix service definition for non default instances

372bc77e71-+-ATS: Toggle use of elevated privileges to load TLS material

1b4cecfa4d-+-mariadb: Move db2070 from s1 to m5

842dd549e1-+-elasticsearch: add new attribute

70b86a6b9a-+-profile::hadoop::balancer: run timer as hdfs user

4966d3bd43-+-mariadb: Provision db1136 into s7

b6a3b1e9d8-+-neutron: support primary/secondary rabbitmq hosts

2cd572941b-+-postgres: correct an issue in the wmcs profile around replication user

1378c23c7f-+-monitoring: add Icinga notes_url for unmerged changes check

ba2a07a230-+-vagrant::mediawiki: base::service_unit -> systemd::service

53c9c71719-+-wikilabels: add secondary db role for replication

122cefa5b8-+-swift: stop including ::nrpe class

0684fa94cb-+-gerrit: don't include nrpe in jetty

e907754411-+-nrpe: add notes_url to monitor_systemd_unit_state

0d80968e97-+-memcached: base::service_unit -> systemd::service

0f294613d3-+-transparency report: remove git cloning of private site

6fe6cc0edb-+-designate: support primary/secondary rabbitmq hosts

ede9ef8161-+-nova: support primary/secondary rabbitmq hosts

441ee0acc8-+-lvs1016: add to high-traffic[12] classes

9247fc2b91-+-microsites: comment out git cloning of TransparencyReport-private

fe038a78ad-+-eqiad LVS: All hosts to intended class/primacy

f364124c13-+-role::deployment_server: reorganize code, step 1

7bc60aebe3-+-nova: remove some old nova-network manifests

f8432836de-+-mariadb: Decommission db2041

694c31da22-+-Decommission analytics-tool1003

36fa22bf81-+-role::deployment_server: depend on base role

36b144ce54-+-keystone: set logdir group to 'keystone'

5d4831478a-+-Introduce role::analytics_cluster::superset::staging

1b7fa4d5cd-+-grub: Remove fallback code for augeas < 1.2

60ccf39c57-+-grub: Remove fallback code for augeas < 1.2

3fee731f2a-+-mediawiki::php: bump the APC shm size on php7

2165200147-+-Set file group ownership to 'analytics' for hive-site.xml on Hadoop coords

84bc7f94bc-+-Update various comments

fad38dc72e-+-Move the remaining Analytics Hadoop job launchers to the analytics user

f3ece93647-+-mariadb: Provision db2118,db2120 into s7

0ebc32340c-+-rabbitmq: open port 25672 for clustering

6bb95703e6-+-rabbitmq: allow epmd access from secondary rabbitmq server

6ef008ef48-+-rabbitmq: set erlang_cookie for cloud deploys

01bf99d8c7-+-Gerrit: Add flogger javaopts

843d6dd216-+-contint: add more repositories to the gitcache

e50c4ad45e-+-openstack: drop compat-network bits

c8c56b14ac-+-profile::analytics::refinery::job::data_purge: move analytics user

d0eafc9a87-+-Move eventlogging_to_druid_job Hadoop jobs to the new analytics user

f5bdcce7a6-+-ldap::client::utils: don't require python-ldap if already declared

8ecc04ce4b-+-openstack: don't include designate::makedomain all over labs

044ec054bf-+-cloudstore: increase sync speed for data migration

030ca82a06-+-tlsproxy::localssl: Don't include tlsproxy::ocsp if we're not doing OCSP

f9dabe64f8-+-postgresql: relocate .pgpass file

0d524c0caa-+-Move camus and refine Hadoop jobs to the new analytics user

687f824598-+-mariadb: Remove db2036

cd7e863bd4-+-profile::reportupdater::jobs::hadoop: move to the analytics user

39190acb8f-+-db2114: Provision it into s6

db548b1d9d-+-lvs101[345]: Add classes to lvs config

4bb7702c8a-+-Setup for lvs101[345]

df672d1bf2-+-contint: puppet-lint is no more needed

f2998945da-+-Remove unused profile::analytics::refinery::{job::guard,source}

9991e6493c-+-Remove unused statistics::aggregator

fb095cf347-+-Add script to log to SAL from Toolforge servers

b2246be81c-+-codfw1dev control node: include ldap classes

5b5734abc8-+-mcrouter: bug(T221346)

9b5d943a1d-+-network::constants: kill special_hosts

75fecea51c-+-mcrouter: feat(T221346) add icinga check for certs

09550f53e6-+-install_server: Prepare to install dbproxy in codfw

3aa641aad2-+-profile::analytics::refinery::job::data_check: run checks as analytics

4e97a0d5a4-+-Expose cloudelastic to wmfcloud

9edb410e55-+-Revert "mcrouter: feat(T221346) add icinga check for certs"

ebf58d6d21-+-mcrouter: feat(T221346) add icinga check for certs

905d5dbfb8-+-mariadb: Pool db1134 into s1

60d42aba56-+-lvs: add runbook for check_rp_filter_disabled

7488b0bd51-+-profile::wmcs::instance:  Ensure that /root/firstboot_done exists

c723b7e45b-+-labstore: add Icinga notes_urls

c1b0d21249-+-acme_chief: add Icinga notes_url

1f8b810b5a-+-zuul: service was always set to running

9f6ad1676e-+-contint: git_daemon: turn max_connections into a proper parameter

56d9f90c41-+-prometheus::ops: Fix gerrit parameter passing

470d8b386e-+-profile::refinery::job::camus: move camus-webrequest to the analytics user

8120764967-+-prometheus::ops: Fix gerrit parameter passing

32112a2ba3-+-prometheus: Adjust gerrit configuration part 2

e7f1b2ab07-+-mariadb-backups: Monitor snapshots alongside dumps on icinga

011a633fe9-+-profile::openstack::eqiad1::cumin::target: kill auth_group

0ca7f76009-+-ATS: Provide support for TLS certificates with different SNI

1446cf1772-+-Update jar versions for Camus and RefineMonitor

af8fe87a8d-+-Move all $DEPLOYMENT_HOSTS usages to ferm::service

4c04e7f619-+-Add DEPLOYMENT_HOSTS ferm macro

6f28a6ecea-+-Move deployment_hosts out of network::constants

6dbff44144-+-kube-apiserver: Don't alert on long CONNECTs

6d64409442-+-profile::redis::master: Switch hiera() to lookup()

6545c25167-+-Move monitoring_hosts out of network::constants into hieradata

4099b4e6d9-+-mariadb: Provision db2111,db2113 into s5

348600f8f4-+-site: move restbase102[0-7] to production

7c6fc3ae57-+-mariadb: Provision db1126 into s8

ddd1364dce-+-Prometheus: Adjust configuation for gerrit slightly

29378f39a9-+-contint: bump git-daemon max connections 32 -> 48

7780d8dbe8-+-rsync::quickdatacopy: add data types

690d6b36cc-+-prometheus: Add gerrit.yaml under targets

3a8854054c-+-local_dev: Add config for dev-images docker-pkg

e07a149141-+-network::constants: Move mysql_root_clients from special_hosts

bfc3d15749-+-Replace git-sync-upstream on labspuppetmasters, remove from puppet-merge

aa8fc8fc24-+-Skip profile::rsyslog::kafka_shipper on trusty

a2fc8fba94-+-mariadb-backups: Refactor dumps and snapshots

09c17aefa4-+-site: add restbase1019 to production

19153d5d6e-+-ATS: Improve paths handling for multi-instance support

53187e3680-+-nutcracker: monitor the redis socket when memcached is not present

12093fb9c9-+-eventlogging: add Icinga notes URLs

176d844c62-+-labstore: fix a couple errors and tidy mounts for migration

b41868df6c-+-labstore: shut down old rsync and export materials for migration

b870f8f959-+-logstash: obligatory typo fix for filter-truncate

ed84e599e3-+-logstash: enforce max length on "message" and "msg" fields

a3f6925cf2-+-cloudstore: start syncing data off labstore1003

7002866d73-+-Add prometheus server for gerrit javamelody monitoring

f05871eaaf-+-profile::netbox: Move reports config to /etc/netbox

3f4f93b91c-+-flake8 - ldap: add extension so file is detected by CI

ef1a902c1b-+-Gerrit: Set plugin.javamelody.prometheusBearerToken

bccd2dbabc-+-mariadb: set some more Icinga notes URLs for nrpe checks

3200f6647d-+-flake8 - diffscan: Add python extension so CI is run

eedfb41646-+-flake8 - letsencrypt: Add python extension so CI is run

deaf67d664-+-mariadb-backups: Reduce frequency of snapshots to 3 times a week

0afcb3bae8-+-profile::netbox: Deploy gsheets config for reports

abc3de6160-+-mariadb: Fix typo on multi-instance dbstore role

f790d3fb46-+-flake8 - misc: update python file extensions so they are detected by CI

e23d60acad-+-flake8 - varnish: update python file extensions so they are detected by CI

cce5cfe164-+-flake8 - rabbitmq: update python file extensions so they are detected by CI

afcf14d287-+-flake8 - arclamp: update python file extensions so they are detected by CI

fccbf76399-+-flake8 - cassandra: update python file extensions so they are detected by CI

bf3e11b3d9-+-flake8 - grafana: update python file extensions so they are detected by CI

66e2d41ea8-+-flake8 - mwgrep: update python file extensions so they are detected by CI

8eb19bd169-+-flake8: update python file extensions so they are detected by CI

03cc95c694-+-openstack: base: rabbitmq: fix typo in ferm rule

962d9bf669-+-openstack: fix weird systemd state in standby controller node

134d1aa0ea-+-flake8 - sslcert: update python file extensions so they are detected by CI

4b5727eae2-+-flake8 - mediawiki: update file extensions so they are detected by CI

22dce28d54-+-flake8: update python file extensions so they are detected by CI

97ad7ecdcc-+-flake8: Add python extension so theses scripts can be picked up via CI

64ee5b4dc2-+-cache: reimage cp3036 as upload_ats

6f2cae6966-+-mariadb: Prepare to decommission db2034

552a87bdb4-+-ATS: require explicit Cache-Control/Expires

1bf2767af5-+-stdlib: use Stdlib::Port in place of our local definition

2dffdcbd35-+-Revert "prometheus: enable metrics relabel"

4dcadc6449-+-prometheus: enable metrics relabel

4afae4ed87-+-mirrors: add Icinga notes_urls

c2c4a5b3e2-+-rsync: add a bwlimit option for quickdatacopy

0894f68a4a-+-statsd: add Icinga notes URL

317c534de7-+-nrpe: add Icinga notes_url for systemd_unit_state check

f7680d2261-+-icinga: add notes_url for bad_directory_owner check

2141aeeccb-+-openstack: Disable legacy vlan naming for cloudvirt1024

f41b4e308c-+-lvs: Toggle VLAN legacy naming

4f007fd11b-+-LVS for eventgate-main

f6de4d72ef-+-openstack: in stretch don't use libjs-jquery from openstack-mitaka-jessie

67ebaabe90-+-facter3/puppet5: change default versions

3d298ac427-+-flake8: puppetmaster - Add python extension so scripts can be picked up via CI

660677f366-+-flake8: Add python extension so theses scripts can be picked up via CI

fb6c416d49-+-role::spare::system: replace standard with profile::standard

e8322254da-+-Revert "lvs: Avoid tagged network interfaces to hit IFNAMSIZ (15+\0) limit"

1334fb99e3-+-Revert "Revert "Revert "sshd_config: Increase MaxAuthTries"""

4fbcc11f32-+-httpd::mod_conf: Remove support for Ubuntu

b39595cad4-+-prometheus: remove v2 feature flag

0eafa3e596-+-ores::worker: allow celery to emit a core dump upon segfault

3a2b5018d6-+-dump url shorteners for wiki projects

b194f3657a-+-enable use of lbzip2 for revision history dumps for all big wikis

564abdffb9-+-mariadb: db2106,db2110,db2119 into s4

7b03a8cdb3-+-profile::prometheus::alerts: fix dashboard URL

c2a4792fd6-+-profile::prometheus::alerts: tune EL kafka consumer lag

a43a996402-+-profile::prometheus::alerts: add EL processors kafka consumer lag alert

4bc818c10f-+-burrow: add Icinga notes_url

b9d0e43d90-+-udp2log: add Icinga notes_urls

9b5e81e3e9-+-toolforge: remove memory overcommit limitations on cron host

4d8e61231d-+-flake8: fix file refrence

d34a3a3a8a-+-flake8: Add python extension so theses scripts can be picked up via CI

4da02a2348-+-haproxy: add Icinga notes_urls

0822a85b63-+-ATS: disable Negative Response Caching

5ee553faa9-+-Keep using $title for service config dir name, not $image_name

2efb3dcc7c-+-service::docker - add $image_name parameter

fbd0054fb4-+-profile::eventlogging::analytics::server: remove unneeded max_poll_records

083e52ef2e-+-profile::analytics::refinery::job::data_purge: fix saltrotate command

b2dd89ddae-+-cache: reimage cp3038 as upload_ats

c62804682c-+-profile::eventlogging::analytics::server: remove timeouts settings

9fd299465d-+-profile::eventlogging::analytics::server: raise timeout limits

e1cb16118c-+-profile::eventlogging::analytics::server: add max_poll_records for client-side

2eba74d44f-+-mariadb: Provision db1130 into s5

dcb7c54181-+-role::wmcs::services::ntp: Fix standard::ntp

d4539a5041-+-wikitech/labweb: remove code to absent runJob cron

d7f520f184-+-cloudstore: the maps exports on cloudstore1008/9 may just work with this

b881a086b4-+-Adapt saltrotate and EventLoggingSanitization params in data_purge.pp

e69f6ea62f-+-reportupdater: Stop cloning over /p/

7da753c076-+-beta: Stop cloning over /p/

45e040f6ef-+-Enable schema aware eventlogging hive refinement

ab8356c63b-+-mariadb: Provision db1138 in s4

d61690b4f9-+-netbox: Mask the default uwsgi service for Netbox

a1ea359375-+-ATS: Negative Response Caching

58fa3ca061-+-mariadb: Provision db2105,db2109 into s3

a7e5e92181-+-profile::analytics::refinery::job::data_purge: remove --verbose

3cc182f28e-+-mariadb: Provision several hosts on s2

cccd422b35-+-toolforge: update origin URL for integration/composer.git clones

41df29d7d0-+-git-sync-upstream: Rebase on top of prod's copy of the puppet repo

61b99b2082-+-puppetmaster: Stop cloning over /p/

0729c3b48e-+-mariadb: Productionize db2117 as an s6 replica

523df3a8ec-+-Remove obsolete kmod class

50edae449d-+-Icinga: Add OSPF check to routers

2c85e694e0-+-maps: remove nodejs-legacy

b51c793b0c-+-mediawiki::web::prod_sites: add the rewrite rules for blankpage

fa4ce80374-+-maps: upgrade to nodejs10

2e279c67ef-+-prometheus: Support several instances of the trafficserver exporter

c47d4fc2a2-+-prometheus uptime alert: fix scraping of 'global' instance, plus more

d3c9700d72-+-profile::mediawiki::nutcracker: make memcached configuration optional

f32308df8f-+-mariadb: db2103,db2112,db2116 into s1

019b4ee488-+-ATS: remove role trafficserver::backend

e3f1ea6d89-+-mediawiki::web::prod_sites: allow forcing engine for testwikidata S:BP

09ff44fa4f-+-mariadb: Pool db2115 on x1

868126e066-+-site.pp: Remove db1131 from spare

0cd3345faf-+-mariadb: Provision db1131 on s6

76183240c1-+-adding restbase10[19-27] install params

d11738f179-+-Designate: remove dependencies on some obsolete init scripts

8f222a2f38-+-labspuppetmasters: remove git-sync-upstream

ec786a490e-+-openstack: Remove support for Ubuntu/Upstart

81af638d04-+-Allow puppet-merge to merge the labs/private repo

ab34e46453-+-php-fpm: revalidate opcache every 60 seconds.

8d228f3fd9-+-cp-ats: reimage as test nodes

ff9b480ed5-+-dbstores: Set the right role for dbstores to be spare

4ea93bb8dc-+-mariadb: Provision db1127 and db1137 on x1

63477a32f4-+-toolforge: refactor redis role from toollabs

8e371d38fe-+-mariadb: Chmod /srv/backups/dumps o+x so the disk space check works

dd69bd69af-+-backups: Decommission dbstore1001, dbstore2001 and dbstore2002

4473a56760-+-Move import_wikitext_dumps to analytics user

3eecb679df-+-Move Analytics' project_namespace_map timer to the analytics user

64a17db7b7-+-toolforge: refactor static role puppet code

aaaf45cc12-+-profile::analytics::refinery: use analytics in /var/log/refinery

969197ba89-+-toollabs: drop old node puppet code

682de32936-+-Update analytics sqoop scheduling

2bfa88a139-+-trafficserver: Allow disabling caching requests

76d0e9358b-+-Remove obsolete openstack::nova::compute::audit

96c10aa424-+-mariadb: Promote db2045 to codfw x1 master

60fc4b7b36-+-zuul: stop pinning python-pbr

b998273706-+-phragile: Stop cloning over /p/

a4155cb81a-+-profile::netbox: Move ganeti sync config to /etc/netbox

aa351961b5-+-mediawiki: remove comment about 'enable_profiling'

1831cc6b87-+-profile::spicerack: Add timeout parameter for ganeti module.

978dfc27c2-+-lvs: Avoid tagged network interfaces to hit IFNAMSIZ (15+\0) limit

2e1fe5df30-+-prometheus uptime: fix typo

0d2043dc38-+-prometheus uptime alert: fix query

a764308e4f-+-trafficserver: Provide support for inbound TLS traffic

d82dd3d856-+-prometheus: one-shot alert on restarts

ed595c433f-+-cache: reimage cp4026 as upload_ats

71e2d9ed3c-+-Revert "sudo: decouple sudo from sudo-ldap"

317a5f97cf-+-dnsrecursor: Remove support for Ubuntu/trusty

0d22d540db-+-sudo: decouple sudo from sudo-ldap

73820b7f34-+-prometheus: add glob for ATS to file_sd_configs

93ac3ce2dc-+-cxserver: Clean up old scb cluster stanzas

da491ce740-+-netbox: set the uwsgi's systemd LimitCore setting to 30G

9bd76ada71-+-service::uwsgi: add the core_limit parameter

ca06cc55b1-+-prometheus: add upload_ats mtail targets

99d2ae6267-+-Switch neodymium/sarin to spares

763387e774-+-LibreNMS, follow the symlink to $install_dir

92caec89c3-+-LibreNMS, change $install_dir to group librenms

b097237069-+-profile::netbox: Remove explicit directory creation causing failure

ea46ad85b6-+-kafkatee: base::service_unit -> systemd::service

b75e8439d3-+-profile::netbox: Deploy config for icinga checks

61f92a56df-+-puppet_compiler: add cron to delete old output files

b3e964a533-+-Add a check_netbox_report icinga check

85c0262337-+-cache: reimage cp4025 as upload_ats

6cd37df035-+-cache: reimage cp4024 as upload_ats

ce4282271e-+-LibreNMS, file files permission, add app key, add logrotate

6b9680ccb2-+-gerrit: bump heap limit

0e51ddee13-+-role::analytics_cluster::coordinator: add system users

0473ab5736-+-trafficserver: Provide support for multiple ATS instances

389e23ef45-+-openstack: labtest: drop unused observerenv profile

d648bd2ed4-+-profile: add labmon1002 together with labmon1001

a79aa704e2-+-openstack: base: fullstack: fix hiera lookup for wrong key

4952a13d57-+-mariadb: ferm_wmcs: update references to labtest

382a8ee85b-+-openstack: drop labtest/labtestn unused code

b91b028fac-+-labtestpuppetmaster: use a codfw1dev role

8c70490c34-+-mariadb: Prepare db1139 and db1140 for reimage

aee9511dca-+-profile::hadoop::master: add alert for HDFS NN RCP queue length

609f092884-+-cache: reimage cp4023 as upload_ats

3d7f5ca0fb-+-mariadb-backups: Set db2102 as a backup test host on codfw

2a97da73eb-+-profile::elasticsearch::cirrus: Don't duplicate udev stuff

4f16250fa4-+-admin: add the 'analytics' system user to analytics-privatedata-users

7acfdd814f-+-prometheus: update references to the no-longer-existing 'main' deploy

2be566d034-+-wmcs: update or remove some old references to the main region

17d259620c-+-labtest/codfw-dev: remove some dangling references to the main region

f5c18b1f38-+-OpenStack: Update firewall defines to remove references to things in ::main::

f63afaaac9-+-wmcs: Remove puppet code for the 'main' region

00f7316706-+-Only install eventlogging::dependencies on non buster

e7c2437004-+-Include eventlogging::dependencies on stat boxes to help with backfilling

974d15b842-+-LibreNMS, set IRC alerting to single line messages

539e791820-+-profile::ganeti: Add cumin hosts to RAPI and cleanup

719ce36e3a-+-LibreNMS, remove email_from from config.php

72dc942f9f-+-logstash: add ulog parser to logstash

571c88ffa8-+-LibreNMS, add log dir

76dde277d8-+-librenms: ensure php7.2-ldap is installed

b2d4a3921f-+-netmon: switch from PHP 7.0 to PHP 7.2 for LibreNMS upgrade

ef0202ec61-+-Add PHP 7.2 to LibreNMS

da3e4859fd-+-transparency report: allow members of LDAP 'nda' to see private site

0ac2e235d6-+-kafka: add icinga notes URLs

c63ece746c-+-wikitech: Provision gerrit api auth credentials

5752deccdc-+-swift: hiera-ize object-replicator concurrency

584eb875e7-+-base::firewall: add runbooks for check_ferm and check_conntrack

a750e4ec38-+-mariadb: Hide diffs on files that contain passwords for puppet

17a43231db-+-profile spicerack: Add Ganeti module configuration

af0c77edf1-+-base: make RAID optional

0b377f9a0a-+-cache: add hiera setting for varnish backend restarts

b2ce4d3df0-+-decom labservices100[12] references

00763ce000-+-Include profile::standard and base::firewall in role::eventschemas::service

9ad634217f-+-Revert "Revert "package_builder: move lintian out of require_package""

753f458528-+-Update cdh module to its latest version

4ffb1087a9-+-eventschemas::service - Don't render config.js.erb, it is in files/ now

3489e23f23-+-kafka shipper: move kafka rsyslog shipping to base profile

cc1f7c401d-+-cache: reimage cp4022 as upload_ats

c53b1e93b9-+-Revert "sudo: decouple sudo from sudo-ldap"

5f0c714683-+-sudo: decouple sudo from sudo-ldap

5a67308363-+-cache: always define fe_transient_storage

641f8cd7b5-+-Fix coal syslog logging

f89a1d7705-+-cache: add ATS nodes to cacheproxy::cron_restart

9c74a3c663-+-registryha,lvs: bug: modifying check LVS

94882711a4-+-cloudvps: introduce proper base role/profile for VM instances

5c1f1547a0-+-vagrant: refactor roles into profiles

91a8fb81d7-+-facter3: fix interface check on lvs systems

a369c3d745-+-registryha,lvs: bug: bad icinga check for lvs service

b720851b2e-+-mariadb-backups: Productionize db2100/1 for backup source of s7, s8 & x1

3210a43b1b-+-labtestvirt2003: now a spare system

1d772f61df-+-facter3/puppet5: update interface fact parsing

34b026a221-+-registryha: feat: introducing LVS configuration

8a26b58425-+-Add profile::cache::varnish::frontend::text

c243d7b4a1-+-hadoop: raise dfs.namenode.handler.count from 10 to 80

0ce3c0dad5-+-Revert "package_builder: move lintian out of require_package"

dbd933670f-+-zuul: Stop cloning over /p/

4f58492be0-+-cloudstore: add to role for the syncing

1c8cd16442-+-cloudstore: add to the script for syncserver

e199b4b3fa-+-cloudstore: the cluster ip must be passed through

570850aba8-+-cloudstore: cleanup extraneous bits

f9ea58cdb3-+-cloudstore: finish up the script for sync

dbc4bef49e-+-cloudstore: change direction a bit on the rsync methods

fdf5711c86-+-cloudstore: edit ferm rules a bit more

558d85ec65-+-gerrit: Enable G1 GC

04e6eb712f-+-cloudstore: correct problems in ferm rules

3c8f427200-+-cloudstore: add ferm rules for rsync on the scratch/maps cluster

e3ce67db0d-+-cloudstore: introduce rsync framework for secondary cluster

58e2344926-+-gerrit: deploy gervert via scap3

59c5bd1515-+-profile::mediawiki::periodic_job: add syslog identifier

1dfed2067a-+-wikitech::web: re-add manually the cronjob for tor exit nodes

b4ad6b8449-+-profile::mediawiki::maintenance: run tor job every 20 minutes, not 20 seconds

50d889b334-+-profile::mediawiki::periodic_job: use a shell-safe name

0dabb1b8b1-+-rename standard: update site.pp default

05bfbb1f51-+-rename staging: remove standard from site.pp

a75b60769f-+-rename standard: move standard out of site.pp and into role::ores::redis

40adba7699-+-rename standard: move the standard out of site.pp

6f2a3bbba8-+-rename standard: move standard out of site.pp and into pybaltest role

d017a1c117-+-profile::mediawiki::maintenance: migrate tor job to periodic_job

6295471519-+-rename standard: update the mx role

fde34ece36-+-rename standard: roles with hiera updates

40bd1c3919-+-rename standard: update roles

4653f16c9e-+-rename standard: update all profiles

176e3b8bb2-+-rename standard: update comments

94fb7403f1-+-rename standard: cp3022.esams.wmnet dose not appear to exist anymore

944bd7dd4b-+-profile::mediawiki::maintenance: systemd-timer based periodic jobs

edac556d57-+-varnish: run VTC tests against remote PCC

c5f6042425-+-Add ferm rules for the Kerberos KDC

bd5392e166-+-standard: introduce a wrapper profile and use it in CloudVPS

cd131a03f9-+-standard refactor: remove standard class from base classes

21a7912a29-+-mariadb: Productionize db2099 for backup source of s4 and s5

30a5963bf1-+-openstack: clientpackages: decouple configuration

c07133693f-+-mariadb-backups: Productionize db2098 for backup source of s2 and s3

720ea95a36-+-profile::analytics::refinery::repository: use the 'analitics-deploy' user

21fee15a82-+-Remove support for trusty in two Prometheus exporters

e2dada1703-+-mariadb: Move db2045 from s8 to x1

11562160f7-+-cloudstore: add ping check for ip conflict

9633612fb9-+-cloudstore: make comments more verbose

1864576595-+-cloudstore: fix the interface name and add a comment

d56e6bbfc7-+-designate/pdns: added a comment about how to bootstrap the pdns database

ff08b34fa1-+-cloudstore: fail over ip address via hiera for scratch/maps cloudstore

36c1beac42-+-raid: add Icinga notes_urls

47e56def26-+-Move labservices1001/1002 to role::spare and clean up

7697ce5e99-+-mariadb: Productionize db2097 for backup source of s1 and s6

d0edf58c6d-+-Temporary hack: turn off designate on labservices1001

d3c3b60793-+-ulogd: rename nflog comment

0fd7d9b392-+-labstore::fileserver::exports: convert to systemd service

49dc925a4f-+-package_builder: move lintian out of require_package

adfc074fc8-+-Keystone: remove ferm rule for keystone in the 'main' region

575374719f-+-Revert "Move labservices1001/1002 to role::spare and clean up"

eb7ba9383b-+-package_builder: install lintian from backports

2ca370ee0c-+-Move labservices1001/1002 to role::spare and clean up

610d31a0c8-+-elasticsearch: rename "update lag" check to "update rate"

3c15acda32-+-cache: hiera setting to list backend services

d718d0ed5b-+-Make role::analytics_test_cluster::coordinator a client of our Kerberos realm

6ee20c4404-+-facter3/puppet5: add version glue back

2f54ddad12-+-cache: multiple keyspaces support for directors.frontend.vcl

5dafab73ee-+-site.pp: Remove pc1004-pc1006

5621c2d285-+-labnet100[12] decom

d3676b2375-+-decom labcontrol100[12]

5472d5b75f-+-installserver: add icinga runbook for tftpd down

72b094136a-+-Move labnet1001, 1002 to role::spare, clean up other references

860125515a-+-Move labservices1001/1002 to role::spare and clean up

d551671e1f-+-Revert "Move labnet1001, 1002 to role::spare, clean up other references"

72f6fc0b9d-+-Move labservices1001/1002 to role::spare and clean up

54f16f7e0c-+-Move labnet1001, 1002 to role::spare, clean up other references

ef9d179f3b-+-Move labcontrol1001/1002 to role::spare and clean up references

aefafc0e38-+-refine mediawiki-events  - remove use of http proxy after T221690

8027e91952-+-mariadb-backups: Setup dbprov eqiad servers, remove dbstore1001 backups

b4fefc76e9-+-cleanup puppet refs to labsdb1006/1007

4fe1ac4a6c-+-canary testing:  Role back this isn't working

892bb43a7a-+-canary host: test method for having canary hosts

58464cccea-+-canary host: test method for having canary hosts

e7d4d90fc6-+-cloudstore: refactor nfsclient role into profile

5717825dce-+-cache: move varnish etcd-based directors to profile

0b675df8a0-+-varnish: add reload_vcl_opts function

c7c8315931-+-Revert "Canary roles: create a canary role for the aqs canary server"

448d4f407e-+-Canary roles: create a canary role for the aqs canary server

f74259c081-+-openstack: neutron: l3_agent: increase conntrack table size

55849d2cfc-+-nflog: add logging prefix to firewall log entries

b741f2ff94-+-cache: distinguish between Varnish and ATS nodes

5f7f5481de-+-debdeploy: make filter_services default to empty hash

e5fc3b54c2-+-Remove misleading comment

d99b08e897-+-mariadb: Promote db2079 to s8 codfw master

a21c28bc54-+-toolforge: iotop was added to standard_packages, removing from exec_environ

274345ff43-+-standard_packages: add iotop

a9a2062a12-+-registryha: fix: bad regexp pattern on check (again)

23ca96b318-+-mariadb-ferm: Update comment to clarify intention of generic define

e95acc4089-+-registryha: fix: bad regexp pattern on check

9507e29a70-+-registryha: registry health check was querying wrong port

e6505be202-+-cache: unify cache nodes definition in hieradata

74a7863372-+-registryha: better description for health

06ca6e130c-+-registryha: reenable alerts on registry[12]00[12]

0172c6cfe7-+-puppet-compiler: clean up hiera config

329c7f6834-+-icinga: change dashboard uid of ores to the new dashboard

2a57de2ca5-+-openstack: clientpackages: vms: fix assert for realm

2d772eaa3f-+-openstack: clientpackages: split profile for VM instances

74d3c48425-+-prometheus: use ATS profile instead of role in job definition

a51efcdc97-+-maps: add pgpass file

5090c5961c-+-mariadb::ferm: Switch ferm::rule => ferm::service

b030bb96d2-+-trafficserver: wrap TLS settings using a type alias

e488dd8692-+-cache: move check_varnish_expiry_mailbox_lag to backend profile

c519b30c01-+-maps: align tilerator CPU usage across all nodes

b0de37cf43-+-profile::superset: add libmariadb3 for buster

64ddf6fe30-+-site/mw/conftool: assign spare mw1297 as API server

9f029eaf2b-+-puppetdb: adapt the module so it works on Cloud VPS simply again

fe5436beca-+-db2033 decom

1644db4275-+-decom of labtestweb2001

50a826b4e5-+-Revert "cloudstore: add python3 clientpackages for all"

69553d50d6-+-Use proper port for schema.svc in refine_job

c4c8535a07-+-Use webproxy for mediawiki_events refine job

37a77f7844-+-New Refine job to refine events using remote JSONSchemas

3a346792ef-+-phab1002 decom

363e36843f-+-cloudstore: add python3 clientpackages for all

0473a3a11a-+-restbase200[78] decom

1d344b612b-+-icinga: remove google safe browsing monitoring

b54b5e5513-+-decom labtestservices2001

88c888eb1d-+-trafficserver: avoid apt dependency cycle

bb3c59ab1e-+-trafficserver: run apt-get update before installing

964a42f1bf-+-cache: reimage cp4021 as upload_ats

dc293063f3-+-Puppetise kadm5.acl

f03c67de02-+-redis::instance: Remove support for Ubuntu/Upstart

9a85edb79c-+-role::cache::upload_ats: Varnish frontend / ATS backend setup

f58df1e662-+-ldap: sssd: add missing bits for sudo

bd40ce10d9-+-profile::trafficserver::backend: do not configure vhtcpd

7e8232730a-+-raid: add ssacli class

7940e500fd-+-webperf: Remove arclamp subscriber from mwlog servers

7fccf73f0a-+-mariadb: Allow install from db2103 to db2120

38576ffcff-+-mariadb-backups: Set dbprov100[12] as spare for reimage

441952e42a-+-cache: stop passing route_table to varnish-fe

f2ccd822c1-+-archiva::proxy: remove old letsencrypt module stuff

a7f027f979-+-wikiba.se TLS: Make support for different certificate sources clearer

9062d8b7ba-+-acme-chief: Add script for Designate integration

eb7c5cb3ef-+-cache: remove unused purge-related hiera settings

d7d212ab76-+-tlsproxy::localssl: No hardcoding of prod webproxy hostname

b77666484c-+-profile::analytics::cluster::packages::statistics: install git-lfs on buster

14177d1143-+-openstack: pdns: auth: use mariadb 10.1 on stretch

79b1e9f02f-+-labtestservices2001: use spare role

bc8a22f4fa-+-network::constants: Move puppet_frontends to using existing data instead

d009d6df96-+-ldap: Add support for sudo rules in sssd client config

fae6a1454d-+-network::constants: Move various analytics special_hosts to hiera

b602b4bc53-+-network::constants: Remove seemingly unused druid_analytics_hosts

879851b98d-+-auth pdns: bind on IPv6

153e9e4fd4-+-profile::mediawiki::php: remove doc_root setting

423d7278fd-+-profile::mediawiki::php: tweak ini settings

90e2b96d89-+-cloudstore: fix up some params around the rsync jobs

5022265167-+-base/monitoring: add Icinga notes_url for 'long running screens' alert

e9c5eab76f-+-site/conftool: assign mw2150 jobrunner, mw2244,mw2245 API servers

9244be7f99-+-site: turn phab1003 into a (but not the prod) phabricator server

cf0f12a5a7-+-cloudstore: deploy maps/scratch cluster as nfs::secondary

e47b130157-+-wmcs: Respect LDAP locks in ssh-key-ldap-lookup

d17c2e7f57-+-LVS for schema.svc

3b5301e1b1-+-Give roles to the new kubernetes[12]00[56] VMs

812f0971ce-+-eventschemas service fixes

260a68a776-+-Fix reference to subscribe eventschemas::mediawiki

2a78052b8a-+-Fix source url for eventschemas service document_root

80fa4c77a9-+-Use Optional[String] for eventschema::service server_alias

f0348fcb5c-+-Puppetize event schema http service and refactor eventschemas module

682a14abba-+-profile::mediawiki::jobrunner: allow reaching the local endpoint

a73de144cf-+-site: add phab1003

8d3bb24d62-+-thumbor: Inlcude mtail in ferm configuration

202e8459b8-+-setting backup1001 to spare for now

afa59e0e7d-+-site: turn phab1002 into a spare::system

e771f2d89e-+-decommission labsdb100[45]

edb8e89f59-+-prometheus: Fix haproxy mtail stats for thumbor

5175513a72-+-Puppetise initial KDC config

3e11d9933e-+-Support node labels and taints in kubelet

6fd4b99f15-+-cache: remove cacheproxy::instance_pair

2e87fd7aa7-+-cache: remove profile::cache::{text,upload}

9299b4a31d-+-cache: implement profile::cache::varnish::backend

f2e33f8bd0-+-cache: add profile::cache::varnish::frontend

6db50ce370-+-prometheus: don't require Prometheus::Server when writing k8s token

182aa42d07-+-Fix broken profile::swift::storage::labs

0325b3e7f1-+-aptrepo: validate deb822 files

d1cd6ab81c-+-icinga: generate config for Icinga meta-monitoring

4aa460c8b5-+-role::swift::proxy: Move TLS stuff out into profile

0bfaaa4926-+-acme_chief: Add security::access::config on passive host in cloud

c627dd3945-+-tlsproxy: Ensure OCSP stapling nginx reload hook present for acme-chief

378f8a459e-+-profile::analytics::cluster::packages::statistics: add python3-venv

4aa3c2c739-+-site.pp: make cloudvirt1001-1007 virt nodes

4d6f9817f2-+-icinga/base/prometheus: add notes_url to DISK space checks

4a5daf044a-+-registryha: fixing ferm rule

07b2a9ed3b-+-cassandra: prometheus exporter for single instance

af818dd468-+-prometheus: add maps cassandra job

823b264209-+-registryha: open 5001 to prometheus nodes, removing nginx metrics endpoint

b805b11d48-+-registryha: added prometheus scraping new registry

c312ec2337-+-Add profile::kerberos::client to KDC role

5a0292def8-+-Align profile::kerberos::client with new profiles

e81880704f-+-Assign role for kerberos1001

f6e8692c83-+-labstore: refactor the backup roles so they will match the main roles

5c91642c9a-+-openstack: Replace main clientpackages/observerenv stuff with eqiad1

30e2c480c3-+-Rename more labvirts to cloudvirts

4dbd13fafb-+-maps: enable prometheus exporter for cassandra

8b17b4a2ba-+-nova: turn off nova-fullstack monitoring in the 'main' region

74ba59a644-+-Set restbase200[78] as spares and remove them from conftool

4bca22bb4a-+-fix wmcs puppet: Add a default value for ca_server in labs

39d26610be-+-remove bast2001 from site.pp

8c4d4fde7e-+-puppet: Refactor of the base::puppet class

e3632aa375-+-cloudnet2002-dev: use codfw1dev role instead of labtestn

db27747f3e-+-Fix data type for krb_kdc_servers

f911893d00-+-Revert "ATS: use 'swift-ro' as the origin server for thumb traffic"

9aca4b141d-+-raid: refactor structure

59e8473c66-+-profile::kerberos:*: only use global variables

2b106d1c9c-+-thumbor: enable haproxy mtail metrics

7861b68527-+-profile::hadoop::spark2: auto upload of spark2-assembly.zip

3cf815a270-+-labtestcontrol2003: reimage and rename to cloudcontrol2003-dev

b02d7e21c1-+-cloudvirt200[123]-dev.codfw.wmnet: update role name

ee8f78f86c-+-openstack: codfw1dev: update DB for neutron-server

2fef8a4b38-+-profile::docker::builder: fix logging basedir

d5190bef71-+-profile::docker::builder: add periodic job to prune old images

3342b019da-+-haproxy: improve metrics (via mtail) and logging

e70ec8203e-+-puppet_major_version4: remove old puppet_major_version variable.

aacc6dec84-+-Revert "cache: hiera flag to use ATS as local backend"

3a0c32f095-+-Make caching of static performance site explicit

a5bb6e1905-+-Rename some labvirts to cloudvirts

df6b7537ab-+-bastionhost: remove rsync and motd warning for bast2001

21a4ee653a-+-bast2001: use correct class name for spare host

184a856be5-+-turn bast2001 into a spare, replaced by bast2002

e8fd3dd1bf-+-Gerrit: Enable gc logging

608d694080-+-Remove obsolete rsync::quickdatacopy

156bbe8198-+-Move caches out of network::constants into hieradata

1aa4f3712d-+-facter3/puppet5: remove defaults from hiera

7d8ac69da5-+-Initial Kerberos KDC/kadmin server profiles/roles

d02b91449a-+-cache: explicitly pass cache_route to varnish::wikimedia_vcl

f0b107b983-+-openstack: deisgnatemakedomain: factorize

1021e56398-+-openstack: codfw1dev: keystone: delete invalid relationship

e6f9f068c7-+-openstack: codfw1dev: db: use mysql-server directly instead of mariadb

d5c2f1763f-+-debdeploy: add zsh autocompletion script

43d278852a-+-labs: Remove nova_dnsmasq_aliases stuff

a24a0e65be-+-registryha: minor fixes

3d7f9efa67-+-add services proxy setup for snapshot hosts

d2d75ca8d5-+-maps: check OSM replication lag on all nodes in codfw

cec5c32f91-+-puppet exec { } doesn't like a bash builtin.

bce81f6ad9-+-Rename role::labs::shinken to role::wmcs::shinken

221b511105-+-shinken: Convert to role/profile

7724367a05-+-toollabs::maintain_kubeusers: switch to systemd::service

34de9b9419-+-toollabs::proxy: switch to systemd::service, delete upstart template

ea7591a762-+-toollabs::kube2proxy: switch to systemd::service

0462ce09ab-+-remove labtestcontrol2001 from site and DHCP, decom

1b4aa07f42-+-openstack puppetmaster: Make it possible to disable ferm in hiera

660db19c60-+-openstack::puppet::master::encapi: Avoid nginx-apache conflict

983766962a-+-Add missing parentheses in ferm rule

1e83c0ff24-+-Move bastion_hosts out of ferm macros

204b77c9ef-+-Enable profile::base::firewall for profile::openstack::codfw1dev::db

31683db02b-+-cloudcontrol2001-dev: drop local keystone db

7fdb1ceb99-+-clouddb2001-dev: include ferm configuration

9353a286e1-+-labtestweb2001: decommission

27859fc51a-+-labtestcontrol2001: decommision

f907756596-+-openstack: nova: compute: mitaka: stretch: refresh comment about libss1.0.0

074f7c6ae2-+-openstack: virt: reallocate libssl1.0.0 package exclusion

c3a0782b75-+-Move bastion_hosts out of network::constants into hieradata

2bf9944dc7-+-openstack: keystone: stretch: use python-openssl from stretch

2833bd1817-+-Move maintenance_hosts out of network::constants into hieradata

f23ef87705-+-ores: use hiera for statsd host

54e60ddac0-+-Toolforge: cleanup unused puppet code

3726f2a9c6-+-striker: factor out common code to a shared profile

74f5343ef0-+-decom cloudnet2001-dev.codfw.wmnet

1a510d2212-+-sessionstore: create profile class to fix password lookups

42dd64ab4b-+-confluence::kafka::broker: update outdated comment on base::service_unit

d500259d97-+-Revert "confd: base::service_unit -> systemd::service"

1908f2878c-+-profile::analytics::cluster::packages::common: add libsasl2-dev

0775f68b7c-+-confd: base::service_unit -> systemd::service

c9c6dd0426-+-sonofgridengine: cleaning up old intermodule dep

2eba0c3033-+-apertium: base::service_unit -> systemd::service

de31c0a825-+-sonofgridengine: don't use old gridengine code

446b93118b-+-sonofgridengine: don't use old gridengine code

9d6935139d-+-apt: remove redundant Install-Recommends

66f0957d3e-+-cache: move varnish storage config to varnish-be profile

88eb7b9275-+-maps: maps2001 is now a slave after migrating to stretch

b4b333233e-+-webrequest: set logger max message size

5344a71a1c-+-wmcs: Add profiles for oidentd proxy and client modes

3b3f7175ff-+-clouddb2001-dev: add mariadb role

e0989e5587-+-Also fix mariadb-backup installation for mariadb::packages_client

ecfefe5aad-+-Fix up installation of mariadb-backup

caf909f333-+-mariadb: Remove support for trusty

86122a711b-+-logging: move webrequest-5xx to logging pipeline

0341f7acea-+-Enable base::service_auto_restart for rsyslog

9fe2ad29d3-+-mariadb: Promote db1075 to master

f6869cdc34-+-zuul: fix MAILTO for cron

0797acf7b3-+-debmonitor: add self to the list of hosts

fa5821510d-+-swift: don't show container-sync-realms diff

1343670593-+-cache: add profile::cache::varnish::backend

85eb6cbf0e-+-acme_chief: Set up acmechief-test[12]001

41ce1d6dce-+-Enabling docker registry swift cross dc replication

c5c802152a-+-archiva: Offer an ECDSA certificate along with the RSA one

7c0064149f-+-labs: remove references to deleted project-proxy hosts

88510cf195-+-Run published-datasets-rsynced module as stats:wikidev

fd430ec268-+-Remove unused rsync module on thorium for stats.wikimedia.org

956dea7823-+-postgresql: set max_wal_senders on slave conf

4dce69d4fe-+-Rely only on ores::base for common packages deployed to Analytics misc

3f2c46a362-+-icinga::monitoring::services: remove analytics from eventbus alerts

fc16c1be2e-+-labtestnet2002: rename and repurpose as cloudweb2001-dev.wikimedia.org

610449e0e2-+-ldap: include sssd cleanup in the classic stack

0338cef11c-+-cumin: allow everyone to read /etc/cumin/aliases.yaml

268dd78fd2-+-Enable base::service_auto_restart for mongodb

37156f5d3c-+-elasticsearch: minor cleanup of directory creation and services

42cc04dca5-+-Add PrefUpdate as event schema to ingest to druid

2b8f546018-+-toollabs: Remove support for trusty/Ubuntu

605fe141f8-+-clouddb2001-dev: add mapped IPv6

023eca9cdd-+-Move cumin_masters out of network::constants into hieradata

f6c941d089-+-maps: migrate maps2003 to stretch

0ad683cd51-+-clouddb2001-dev: fix typo in site.pp

25bb2dddfe-+-Remove now obsolete tools-checker-grid-start-trusty monitoring service

9b56526b73-+-labstore: a touch more cleanup of the secondary modules

ce15a1a418-+-toolforge: add python-bs4 package

4e74ffdeca-+-kube2proxy: fix typo in the apt::repo bit

82ad0d7a29-+-Revert "dynamicproxy: Prevent STS header from non-TLS connections"

66fc117ee3-+-dynamicproxy: Prevent STS header from non-TLS connections

cc8a1f698e-+-profile::puppetmaster::frontend: Allow getting allow_from from hiera

043de85ae1-+-cloudstore: A bit more cleanup

1bcaa1a70b-+-labstore: Adapt nfs-exportd to be used on more than one cluster

bcd84c4260-+-labs cumin: Allow running nfs_hostlist script outside a puppetmaster

2e024599ad-+-labtestmetal2001: repurpose as clouddb2001-dev.codfw.wmnet

2dce6b72b0-+-apt::repository: fix paramater validation

0d53c69f00-+-Revert "ores: ship to logstash via the kafka logging pipeline"

b7e4fcdbe1-+-restbase: add restbase2019 / restbase2020

04c885a07e-+-ores: ship to logstash via the kafka logging pipeline

3b4a989c2d-+-facter3/puppet5: Introduce parameters to introduce  facter and puppet

66740041cc-+-install_server: bare minimum puppetization to install acmechief-test[12]001

58790ba3d4-+-ores::base: fix package requires for Debian Buster

661bd48fc3-+-labs central puppetmaster: Allow cumin functionality to be disabled

bbe5db6cfb-+-thumbor: Fix package declaration in init.pp

e5449d85b2-+-thumbor: Fix apt pinning for wikimedia-thumbor

3c4cb0d06e-+-openstack: serverpackages: mitaka: stretch: drop puppet cleanup code

02f59fecc3-+-profile::cache::ssl::unified: Allow passing certs/certs_active by hiera

6b54f22914-+-service::node: Set config-vars.yaml's mode to 0440

bcae822327-+-eqiad1::labweb: Remove realm ifguard for waf

ec5b9cc142-+-waf: Remove realm if guards

92e81ef65e-+-waf: Move to httpd::conf instead of httpd::site

84c13e0016-+-add Icinga notes_url to various NRPE monitor checks, pt 3

c5fbfa83b5-+-bird: add Icinga notes_url

1ba23f7bbc-+-puppet-compiler: install latest version

f45c27cf83-+-site.pp: Make cloudvirt1008 a cloudvirt host

e614de768f-+-Revert "labstore: Adapt nfs-exportd to be used on more than one cluster"

b64a98b9b4-+-labstore: Adapt nfs-exportd to be used on more than one cluster

575679e4c9-+-Toolforge: remove old trusty-specific indic font packages

1dc62493bd-+-Fix last common packages for Analytics hosts for Debian Buster

b8d126041a-+-Fix more common packages for Analytics hosts for Debian Buster

3b7c8e1069-+-Fix more common packages deployed to Buster based Analytics nodes

cf0c8f14e1-+-Revert "sessionstore: include cassandra passwords"

9b335a4222-+-sessionstore: include cassandra passwords

a2d38961ed-+-postgresql: set recovery.conf to writeable by postgres user

fc4ffa224c-+-profile::an::cluster::pkgs::statistics: add better handling of myspell pkgs

40ea487fb9-+-profile::analytics::cluster::packages::statistics: add myspell guards

f5853548a3-+-openstack::puppet::master::encapi: work on stretch with python3.5

87f2d5dda2-+-role::statistics::gpu: add common statistics packages

e7d78e2600-+-icinga: correct direction of check

9e6ff0e5f0-+-ATS: make config files depend on package

89bd4c4218-+-labtestnet2002: spare server in stretch

333326a9f6-+-toollabs::bastion: remove trusty cgred code

3752a853f5-+-ATS: make error template directory depend on package

04784f3aba-+-openstack: codfw1dev: cloudservices2002-dev: include openldap profile

a46d04c79d-+-openstack: pdns: give mariadb stretch support

7a81b35ec3-+-openstack: pdns_recursor: in stretch, don't use the package from jessie

86e7bcc1a2-+-pbuilder: add security updates repository

65cf43540e-+-jessie-backports: remove redundant pins

37935029d5-+-ATS: install libhwloc5 from stretch-backports

1392a6c87d-+-elasticsearch: fix single quotes in graphite check

0ce5160e20-+-icinga: add mediawiki cirrus update lag check

97e6c89743-+-cloudservices2002-dev: typo in site.pp

be8b555b49-+-Allow ensure absent in monitoring classes without description/nrpe_command

d9ec76aaef-+-role::labs::instance: Remove support for trusty

1f32c90d20-+-druid: add Icinga notes URLs

10b13f09a8-+-labtestservices2002: rename to cloudservices2002-dev and put into service

1d350256be-+-elasticsearch: raise the alerting threshold on unassigned shards

b847929a03-+-toolforge: Remove support for trusty

4d0e306524-+-ssl::wikibase: Fix le_subjects hieradata key name

b67c35c9cf-+-Revert "profile::cache::ssl::wikibase: Simplify"

3f74a33f6e-+-osmdb: set old osmdb servers to spare for decom

7753e2ece9-+-cloudstore: add extension and get nfs-manage-binds passing linter

902734ac88-+-labstore: cleanup the remaining files after Icc89332f0e779

a13adf1fdd-+-cloudelastic: use acme_chief to get ssl cert

95f9c73dde-+-fix notes_url for RIPE Atlas ping alerts

2becb63ccb-+-puppet-compiler: restore the ability to export facts without puppetdb

b1ad1eb366-+-graphite: correctly set Cache-control: no-store

5583e76708-+-tlsproxy::localssl: split title and acme cert name

a00ca2ec27-+-uwsgi: allow setting routing rules

bf1c5582be-+-debdeploy: change merge behaviour

efee305941-+-Remove citoid role/profile

1c63d3ed4f-+-ATS: add request/response details to error message

c962950d68-+-ATS: fix template_sets_dir

32c05f0a3e-+-ATS: custom WMF error page

4819596e87-+-ATS: add support for custom error messages

63ca847fac-+-cloudcontrol2001-dev: add IPv6

450f55d2cb-+-openstack: serverpackages: require apt-get update before moving on

9186505b1f-+-wikitech: Provision phabricator api token

4b68cd223f-+-icinga: sync only if config is valid and log it

988e46aa0b-+-profile::cache::ssl::wikibase: Simplify

5900978145-+-mariadb: db2033 set to spare

b06f75e5f2-+-labstore: fix mistake in maintain_dbusers service

e423fffa65-+-cloudstore: start refactor for role switch up around the labstores

6fba530e3f-+-wdqs: expose revision-fetch mechanism

0dbb8d857f-+-Revert "Enable using revision-fetch mechanism for test & internal clusters"

3be17d316e-+-Enable using revision-fetch mechanism for test & internal clusters

ef9b96550d-+-wmcs: Migrate tools-checker to Stretch

4eabddbf6d-+-jenkins: ensure secrets and logs are only readable by jenkins

3b03f533ea-+-labs puppetmaster migration: Puppet role for encapi/labspuppet DB hosts

955cec403a-+-jenkins: prevent reading IRC passwords

dee7376eb8-+-profile::hadoop::master::standby: remove page to SRE

bacbc62d90-+-profile kubernetes node: Adjust latency alert thresholds

6ab85e7e31-+-openstack::monitor::spreadcheck: add cloudinfra config

d13934dd4f-+-openstack::monitor::spreadcheck: rm old renaming absent file resources

65d66360f9-+-wikilabels: update alias for database

f178c72307-+-openstack::monitor::spreadcheck: Use a list of projects

2dbcfcb7a7-+-confd: remove upstart support

1a05f8a515-+-Update sqoop number of processors to 10

47b6a8f72a-+-openstack: codfw1dev: drop even more usage of clientpackages

e419af4b3f-+-aqs: better handling of contact groups

f617331698-+-profile::aqs: add the analytics contact group to aqs's alarms

fafcc13802-+-openstack: codfw1dev: don't include clientpackages in cloudcontrol servers

a1727f5fa8-+-Remove passwords::ldap::production from role::webperf::profiling_tools

5cee761e06-+-xhgui: Properly include passwords

34e802bf1c-+-Revert "openstack: clientpackages: fix missing deb repo installation"

606b154c93-+-openstack: clientpackages: fix missing deb repo installation

e93ac47e34-+-openstack: drop serverpackages profile

d0eaec7edc-+-elasticsearch: only expose HTTP ports where needed.

b50268fddd-+-tendril: Open firewall only from tendril web to tendril db backend

22368a6b46-+-openstack: designate: introduce openstack/debian split layout

652b6f1601-+-ATS: add ats-backend-restart

6411f9847e-+-haproxy: Remove Ubuntu support

18c958031b-+-network constants: dbmonitor hosts are not general monitoring hosts

9181b9d499-+-mariadb: Move wikimedia_editor_tasks_entity_description_exists

9e0aa82646-+-labpuppetmaster: move from 'main' region to 'eqiad1' region

f962f98fc5-+-hadoop/hue/systemd: add Icinga notes URLs

979f23d799-+-mariadb-backups: Setup dbprov2002

f0dd0191d3-+-varnish: add Icinga notes URLs

10c6cc235c-+-labweb: move from 'main' region to 'eqiad1' region

5d9c9e07c0-+-profile::puppetdb: Remove ensure absent ferm::service

b2a45415b9-+-uwsgi::app: Handle ensure absent

86987ce14f-+-cloudelastic: Add cloudelastic configs

e4d62b024e-+-monitoring: use internal graphite url

2b5b8fea88-+-icinga: align elastic base and nrpe check titles

078793837b-+-openstack: serverpackages: stretch: factorize negative apt pinning

a62617efd0-+-openstack: serverpackages: stretch: don't install python-sphinx from our repo

44b912fb8e-+-openstack: neutron-common: fix relationship with sqlite3

4a20d2a4c4-+-service::node: Only try to define node10 repository if it is not already defined

a047875084-+-openstack: serverpackages: drop file cleanup declarations

3681724f4f-+-serverpackages: mitaka: stretch: additional pinning fixes

ab88a593ec-+-k8s:proxy: remove upstart support

231bc6d880-+-icinga: remove unwanted character from elastic check

06f966ab38-+-elasticsearch: add profile for icinga checks

7a83e36cc7-+-site.pp: Clarify labsdb1004 and 1005 status

1292208e09-+-Remove labs_vmbuilder

6fd3c2aa62-+-Expose rsyslog_udp_port to services configs.

7ddb45eb6c-+-realm.pp: Add urlshortcodes to private table

c322636152-+-admin_scripts: add a case for Trusty

213eeb237e-+-cloudstore: add py extension to nfs-exportd and apply nfsd-ldap everywhere

393760af83-+-Revert "elasticsearch: add profile for icinga checks"

29dfd44843-+-elasticsearch: add profile for icinga checks

37d455134f-+-cache: serve wikiba.se traffic using cache::text servers

ba8f18d585-+-Add rsyslog kafka to service nodes.

b89d0e4e98-+-cache: serve wikiba.se traffic using cache::canary servers

6015a9cc17-+-localssl: Avoid acme-chief puppetization triggers nginx restart

2ff7e9f544-+-openstack: admin_scripts: libvirt-bin doesn't exists in stretch

f1fcfb4516-+-openstack: add some missing bits for codfw1dev

8f3e27d678-+-pbuilder: fix backports hook and add archive hook

970bd55fc9-+-facter3: add augeas-tools

4f069f6ec1-+-Pass flag use_nodejs10 for maps services

e02d4c68e6-+-labtestnet2003: rename to cloudnet2003-dev and reimage to stretch

a62432b1c6-+-Allow acme-chief to provide unified cert

095d7b1b5b-+-labsdb: decommissioning labsdb1004/5

a1ac936340-+-netbox ganeti sync: Fix path to logfiles.

955a7e1aba-+-base::firewall: rm seemingly unused realm branch

162ba95a76-+-xvfb: replace base::service_unit with systemd::service

012dca8cd0-+-docker: Remove support for trusty images

fea3cc18b3-+-cloudcontrol2001-dev: assign proper role

d9d3eb0043-+-wmcs: introduce codfw1dev puppet code

9a9e83c624-+-openstack: keystone: mitaka: stretch: use python-pyldap instead of python-ldap

59e679e0f1-+-openstack: keystone: drop jessie-backport install option

cae753edfb-+-role::piwik: simplify profile's parameters and remove dead code

a01f2e02f0-+-profile::mediawiki::php: raise mysql.connect_timeout to 3 seconds

a711ec8bb6-+-openstack: admin_script: delete code used for renaming cleanup

033835b61a-+-openstack: admin_scripts: add missing directory dependency for root ssh key

f398023f7d-+-profile::mediawiki::php: remove references to tideways

0e2b3ea3e8-+-openstack: serverpackages: mitaka: stretch: ignore python-cryptography from bpo

45c03d7367-+-xvfb: remove upstart support

c1071bca76-+-openstack: add mitaka/stretch support for neutron server in cloudcontrol

a32cbacc62-+-Stop serving trusty repositories in aptly

dbd7dbd14c-+-Enable base::service_auto_restart for rsync/namenode standby

725e7f4eeb-+-acme_chief: Provide OCSP stapling support

d2ea4e0ac9-+-wikilabels: Update toolschecker to monitor the live DB

180064bf1d-+-designate ferm: remove some commas that were upsetting ferm

664033f43b-+-designate: open API to the backup nova controller

68af2fbee2-+-jessie-backports: remove pins for jessie-backports

c13e60d424-+-jessie-backports: add component/kube2proxy apt repository

10fbec7054-+-service::uwsgi: Allow instances to disable logging config

6c07e6804c-+-openstack: add nova support for mitaka/stretch in cloudcontrol servers

a58ebc9d57-+-role: add kafka_shipper to elasticsearch::cirrus role

255effdd9f-+-openstack: add glance support for mitaka/stretch in cloudcontrol servers

78e3b48fb5-+-Revert "wmcs: instances: require clientpackages from eqiad1"

8ad62747a5-+-gridengine: fix the dedicated class up a bit

40b0c19370-+-wmcs: instances: require clientpackages from eqiad1

c8d4522e03-+-elasticsearch: split plugin into base and cirrus

7953af612d-+-prometheus: clean up node exporter transition code

68aefa655d-+-k8s::flannel: remove upstart, use systemd::service instead

9a66184249-+-remove ms1002 from site.pp

d05094c927-+-jessie-backports: remove pining from packages

dd2fd3f8f5-+-jessie-backports: add components/ci repository

b3abcf43d2-+-elasticsearch: use standard resources for icinga checks

f79885c911-+-mariadb-backups: Once transferred, chown and prepare them as non-root

a6b24f73ba-+-jessie-backports: remove pins for packages in openstack-mitaka-jessie

67a5898775-+-jessie-backports: remove pins files as its redundent

59f5d61bb3-+-arclamp: add a second instance for excimer logs

4224cf47c1-+-jessie-backports: remove jessie pinning.

93477b4773-+-profile: kafkatee instance for udp2log compat

2d7dd5f299-+-jessie-backport: Remove the jessie backport

2249fc4e0e-+-logrotate: add old_dir parameter

309100fcb1-+-mariadb-snapshots: Require wmf mariadb package present

8384a6f670-+-install_server: Allow image of the new codfw DBs.

a0d7388506-+-enable use of lbzip2 for compressing revison history dumps

0e0778bdfb-+-Follow-up Id61b31ad: Don't error by default in mediawiki::errorpage

a31c3e6dad-+-Cron to run script to purge old CX drafts

9461654272-+-labs puppetmaster backend: set second region designate host correctly

103fc7cb16-+-Follow-up Id61b31ad: Make dynamicproxy instances not error

d3118f938f-+-arclamp: remove previously absented files

386a2685a4-+-mariadb-backups: Setup dbprov2001 as the backup server

51e579c967-+-arclamp: abstract arclamp::instance out of arclamp

a28dbe69b9-+-role::memcached: apply interface::rps to all the hosts

5df66d5bfa-+-prometheus: collect session storage Cassandra metrics

c940575a95-+-Trivial comment change: s/labs/cloud

ac4a348d98-+-puppet-merge: merge to wmcs puppetmasters as well

306a9bb07d-+-add Icinga notes_url to various NRPE monitor checks, pt 2

7b0e620ba7-+-set up for testing misc dumps crons in beta

9c496e2f94-+-add shutdown warning in MOTD on bast2001

57afe0a007-+-add wikidata entity dumps settings to its config file, make labs version

d393962b1e-+-rsync home dirs from bast2001 to bast2002

d7e81312fb-+-network::constants: add bast2002

757d42de73-+-acme_chief: Clean old file based certificate files (2/2)

65df71ace8-+-mariadb: Prepare dbprov2001/2 and future dbprov1001/2 for production

4353cc7da1-+-acme_chief: Clean old file based certificate files (1/2)

c6a9b608f3-+-Update sqoop timers configuration

5eeb7d5509-+-apache: simplify naming scheme for administrative

878da03a3e-+-WMCS: introduce sssd, replacing nscd/nslcd

fd4535a6ba-+-Add WikimediaEditorTasks tables to the private tables list

3bb8ad0ea9-+-Add system timer for running ganeti->netbox sync.

5845d3de4e-+-decom of labtestvirt200[12]

8f56492499-+-Logstash: add Icinga notifications parsing

8a9a9c18d5-+-add bastionhost role to bast2002

3a24bfe24f-+-network::constants: remove seemingly unused bastion_hosts extra hiera key

8ebc13732a-+-add mapped IPv6 address to bast2002

ec22c5887e-+-phabricator: send apache access logs to logstash

5bdc7a69eb-+-arclamp: Rename provisioning of xenon-log to arclamp-log

c8ffa57073-+-arclamp: Rename xenon-grep to arclamp-grep

ab0d94ad9a-+-create a new role/profile 'hmmp' to replace role(simplelamp)

598571ef12-+-arclamp: Rename xenon-log script to arclamp-log in Puppet

5f7c34cf04-+-arclamp: Make Redis subscription channel configurable

631d809cd2-+-osm: add Icinga notes URLs

edd40afc29-+-arclamp: Rename YAML file from xenon-log to arclamp-log-xenon

7ad2ab4b22-+-gerrit: send apache access/error logs to logstash

0d43443c4b-+-icinga: increase mjolnir bulk update check frequency

0b28833164-+-Define asoranking scap target

6e14157526-+-toolforge: remove deleted Trusty host aliases

d0c5701ce1-+-mediawiki: revert scap dirs to params, forward_syslog data type

6b9b2cfb4f-+-add Icinga notes_url to various NRPE monitor checks, pt 1

6da7866b9b-+-mediawiki: add data types to parameters

d4ee2ffafe-+-site.pp: Add db1139 and db1140 as spares.

1a1741b25e-+-puppet compiler workers: include the cloud puppet enc tool

3549167b34-+-Add Icinga alert to ping-offload dashboard alerts

05de8f2dae-+-Revert "mediawiki::maintenance: run tor_exit cron with PHP 7.2"

7cc4c576dd-+-icinga: delete any commands not explicitly added by puppet

ec4f2202d2-+-icinga/planet: fix seconds->hour calc and add comments

3045a11a61-+-mediawiki::maintenance: run tor_exit cron with PHP 7.2

b1873a9126-+-elasticsearch: convert check to py3

28b27c390e-+-icinga/planet: merge monitoring into a single host and class

c318568e1e-+-nagios_common: remove duplicate config, check_command already uses it

db1f747cac-+-nagios_common: another fix to check_lastmod location and naming

b39074b0ba-+-Fix pinning for smartmontools

315ba64e06-+-Create and mtail parser for ulogd and install it on the syslog server

fe4cd17835-+-nagios_common: add check command check_lastmod

092b051fcf-+-icinga/planet: add generic check_lastmod plugin and check planet updates

934b431056-+-openstack: Add an instance spread check for deployment-prep

6c1de0b241-+-network: labs: remove outdated entries

bd21d3f470-+-network: Allow customisation of cumin list on a per-project basis

be4b16f644-+-Toolforge: "Tool Labs" legacy name updates

e9fa666245-+-contint: change `/r/p/` to `/r/` for gerrit links

875cfb3ae3-+-Revert "Revert "openldap: Switch to the directory based deployment used by acme-chief""

8ed91c5ea7-+-Revert "openldap: Switch to the directory based deployment used by acme-chief"

db7e456962-+-openldap: Switch to the directory based deployment used by acme-chief

53dbd1aa6b-+-archiva: Switch to the directory based deployment used by acme-chief

4179fc6036-+-striker: let uwsgi container and app logs flow to stdout/stderr

15e386155d-+-git-sync-upstream: support a mode where only the /labs/private repo is updated

5db0f8be3d-+-logstash: elasticsearch-curator is now managed in its own component

eac0577a91-+-parsoid::testing: use profile::mediawiki::php to get PHP 7.2

04fb0e5da4-+-mf-auto-restart: Exclude NFS mountpoints (alternate)

ee83a83954-+-elasticsearch: use the new elasticsearch-curator APT component

377de3eb63-+-contint: Remove curl package

f995344263-+-profile::hadoop::common: explicitly set if TLS keys are deployed or not

87635b0656-+-profile::base::labs - Fix timer definition

0af9b5ef6c-+-profile::base::labs - Convert cronjobs to systemd timers

34e6bd689a-+-backup_mariadb: Output Log to /var/log

b537f15b4f-+-parsoid::testing: install PHP 7.2

102a35c6c9-+-Add curl to standard packages

8f437d0fc6-+-cloudvps: Fix error in lookup for diamond::remove

069c63d874-+-modsec directive @ipMatchFromFile broken for apache 2.4

fa2c7bd9e6-+-role::labs::instance - Do not instantiate diamond if diamond::remove is true

f192e8c680-+-debdeploy: add config to filter out services

472863b08f-+-openstack::keystone::cleanup - Do not hide `keystone-manage token_flush` output

966fea1d85-+-openstack::glance::image_sync - Fix systemd timer user

6a413a849f-+-Add lvs to the read-only ldap replicas

e30081fc35-+-move various 'misc' ('other') dumps to using separate config file

8217b01f2c-+-wmcs: decommision several codfw servers

f6e882b17c-+-toolforge: remove obsolete mailrelay manifests

5349935d63-+-Enable base::service_auto_restart for rsync/releases

ac3afb5ef2-+-wikitech: Add missing zero in time specification

10ef12ae3d-+-wikitech: Fix error in timer specification (every 1s -> 1min)

9b2c259a1c-+-wikitech: Do not hide output from mwscript runjobs

a7e431ad4d-+-generate a minimal config file for 'misc' dumps

ed85d14a2e-+-acme_chief: Update acme_chief::cert resource to fetch several cert versions

392bdabd50-+-parsoid::testing: install PHP7

b859bd6621-+-openstack - Fix errors in timers definitions

a9499c9c66-+-openstack: Follow-up I71678b27: Remove stray MariaDB reference

d00c36a747-+-openstack - Convert cron jobs to systemd timers

2ef5f8737e-+-profile::base::labs - Ability to disable Puppet failure emails

b6375b0d3f-+-Revert "Re-apply "openstack::clientpackages::common: include python3 packages""

d40b3b9ce8-+-Re-apply "openstack::clientpackages::common: include python3 packages"

effb0bf745-+-labmon: Delete archived Graphite directories

dd45ef70c0-+-Ensure auto_restart is a dependency of auto_restart_service

a9f4c80e12-+-ATS: use 'swift-ro' as the origin server for thumb traffic

d491092ced-+-profile::hadoop::common: add new Yarn RM properties

2fdd2880a2-+-dumps: add Icinga notes URL

edf1bebfd7-+-redis: add Icinga notes URL

95a2904075-+-pybal: add Icinga notes URL

1071f019ab-+-jenkins: add Icinga notes URLs

86ccf6f07b-+-Revert "Revert "Revert "acme_chief: Update acme_chief::cert resource to fetch several cert versions"""

ab4692b3c3-+-Revert "Revert "acme_chief: Update acme_chief::cert resource to fetch several cert versions""

740e348850-+-Revert "acme_chief: Update acme_chief::cert resource to fetch several cert versions"

a1463e10a9-+-acme_chief: Update acme_chief::cert resource to fetch several cert versions

b216f27d53-+-acme_chief: Remove stretch support

8aa01f773b-+-phabricator: enable modsec waf administrative

ba00f16bc8-+-wikitech: enable modsec waf administrative

69b044258e-+-gerrit: enable apache modsec ipaddress ban list

9fc5894f44-+-add notify service apache2 on change to administrative file

cfdb2107db-+-move to apache administrative

e60b57449c-+-apache2: add generalized global IP address ban

19bbcb0a86-+-mariadb-snapshots: Fix snapshot statistics db credentials

6949ff4400-+-logstash: move mediawiki syslogs to logging pipeline

300a12588f-+-openstack: add keystone support for mitaka/stretch in cloudcontrol servers

f2ed606485-+-prometheus: use yaml rules for prometheus v2 k8s-staging

3262a71500-+-mediawiki: move logging pipeline rsyslog shim from role to profile

703f81dee9-+-Add component/ci wikimedia repository to CI hosts

62223a66ad-+-Remove unused reset-ldap-password script

51b8aed88a-+-confluent::kafka::broker::alerts: fix dashboard links

dc1533e5e6-+-Remove asw-a-eqiad from monitoring

2fb1ba122a-+-fix up a bunch of global config values for dumps

dbe819cd37-+-Add configuration file for netbox reports

d8735ae7e8-+-mariadb-snapshots: Run transfer as root, not dump

da152d88f5-+-Add LimitCORE support for uwsgi units.

ebc53098c0-+-toolforge: Install qstat-full in /usr/local/bin

5f817d24b3-+-Create an empty openstack::clientpackages::**::buster manifest

72278baba0-+-cloud-vps: Remove mysql packages from openstack::clientpackages::mitaka::*

bd93463a48-+-profile::mediawiki::php: re-disable display_errors

09ddcc7819-+-dumps: we use maxretries for multiple jobs, reflect that in config file

3dc613e15e-+-profile::mediawiki::php: only reload php-fpm if the config is valid

bf40b4acd7-+-ATS: set RAM cache size

41388ba801-+-profile::hue: configure Yarn|HDFS|MapRed SSL ports for analytics1039

36447abb4f-+-mariadb-backups: Make backups.cnf on managements hosts owned by root

56237a8fb6-+-mariadb-backup: Deploy new snapshot cycle to cumin and provisioning hosts

3d530cac81-+-Don't set a fixed package version for prometheus-node-exporter on buster

ad3bd45353-+-Revert "profile::mediawiki::php: disable display_errors in FPM mode"

a98fb58389-+-profile::mediawiki::php: disable display_errors in FPM mode

20451dfc35-+-prometheus: maximum connections to proxypass

4c4fe6ee42-+-acme-chief: Update certs-sync to mirror the new directory tree

7eb8918ad4-+-Enable base::service_auto_restart for prometheus-statsd-exporter

a120682902-+-labpuppetmasters: disable automatic syncing of the puppet repo

f58958ef20-+-Specify the actual correct parameters to the uwsgi::app

b8fe46f7d7-+-sonofgridengine: remove gridengine-client from shadow_master class

4230caaeb2-+-Expose some PuppetDB values to netmon via microservice

7200594ac7-+-sonofgridengine: move the client package out of master.pp

e7348b3800-+-sonofgridengine: Correctly set masters and shadow masters as submithosts

40e38d28cd-+-Revert "openstack::clientpackages::common: include python3 packages"

3f48eecf82-+-openstack::clientpackages::common: include python3 packages

c137461124-+-Revert "Add lvs to the read-only ldap replicas"

878ca9bfb9-+-Add lvs to the read-only ldap replicas

49c2338bbf-+-mediawiki::webserver: add missing notes URL

6ea4e01eca-+-netbox: add missing Icinga notes_url

bf6a8e25bb-+-grafana: add a missing Icinga notes_url

5198c8a73b-+-icinga: add notes_url for toollabs checker

dc8d96cc8d-+-icinga: make notes_url a required parameter of monitoring::service

053981bf2e-+-mediawiki::webserver: Icinga link for etcd config check

667b0303a8-+-openldap certs: allow group 'openldap' to read them

586910dcb0-+-openldap: switch to using acme certs

908755cdbb-+-service: add Icinga notes URL in defined types

34eb0f645b-+-rm mediawiki::generic_monitoring (Apple bridge)

1fd50ff361-+-rsyslog: restart service on kafka_shipper lookup table change

df1ae89c50-+-openstack: Only perform VM startup/shutdown on Stretch

964b24d314-+-openstack: Automatically start/stop VMs on hypervisor boot/shutdown

3f729a4cb9-+-Use tesseract-ocr-all instead of a list of most Tesseract packages

ff5d0e075e-+-puppet_alert: Email projectadmins instead of members

f3799bc3ae-+-service::node: Stop supporting trusty/upstart

c13fc1873b-+-base::monitoring: link to new runbook page for SSH checks

79f7d23add-+-Add firewall logging to url_downloaders

92c3829bd7-+-cache::ssl::unified: Icinga link to HTTPS on wikitech

73e60d260a-+-apertium: Icinga link to CX page on wikitech

71f7c32202-+-icinga: modify cirrus prometheus checks threshold

8bfb47dd28-+-monitor_replication: Change notes_url link

16d4555207-+-graphite: add Icinga notes_url for graphite_freshness check

0a87647c5d-+-monitoring: link to dcops runbook page for mgmt interface checks

23e26e9ca3-+-logstash: add udp json logback localhost compatibility endpoint

8255eeb011-+-openldap: make ldap-eqiad-replica01/02 ldap replicas

dfbfe368c0-+-Revert "dumps distribution: remove labstore1006 for failover"

122752b89d-+-openldap: add read_only switch for ldap servers

212ca63ffc-+-Icinga, assign bfd check to routers

7f085b08a7-+-Swap journalnode hosts in Hadoop test cluster

fb5a15d52b-+-openldap profile: remove profile::openldap::secondary_hostname arg

4433f97e1c-+-elasticsearch: mjolnir bulk update lag

5b3af6a6cc-+-Expose CA cert to netbox ganeti sync.

2c998bdd5a-+-diamond: Do not collect disk usage for devicemapper devices

e0cf393332-+-Remove ::profile::prometheus::openldap_exporter from labtest

693b407ed4-+-openldap: role/profile refactor for 'labs' and 'labtest' roles

3179417aa1-+-logstash: tune shard size check to reflect the current known good sizes

1909923089-+-Add logging to cumin nodes

7726fcde11-+-mariadb-backups-monitoring: Link to more specific subpage on icinga

ae7a93fc23-+-openstack: nova: common: add proper ordering for nova policy

519654f6f4-+-mariadb: add Icinga notes URLs to monitoring checks

61fbf93dce-+-elasticsearch: create default elasticsearch config for all versions

cffed7ea65-+-Revert "openstack: nova: mitaka: stretch: install python-dogpile.core from jessie"

874d540ac5-+-Initial configuration for session storage service

caffaf21e0-+-profile::hadoop::firewall::master: break down ssl config

0b6dfe2592-+-k8s: Remove old unused $master_ip var

a8e503c5c4-+-profile::hadoop::common: fix a missing '.'

32b10c21b8-+-hadoop: allow the configuration of ssl-(server|client).xml configs

393dd6e18f-+-toolforge: install python-mwclient with grid exec_environ

2669149bde-+-toolforge: limit file size to 50 GB

310ee79f22-+-Initial site.pp entries for ldap-eqiad-replica01 and 02

0ccb1f4177-+-elasticsearch: allow a version of configuration independant of the package

6c31b4ee19-+-elasticsearch: expose elastic65 APT component to hiera

00f89e6db9-+-webperf::profiling_tools: include ::passwords::ldap::production

1683b48a87-+-xhgui: setup git cloning and apache site

aa43282db2-+-use hostname instead of fqdn

ab919db0c8-+-openstack: drop -t jessie-backports for openstack component installs in stretch

292a06f9d1-+-Enable base::service_auto_restart for rsync on doc1001

d25161577a-+-mediawiki: add notes URLs for Icinga

f54bde73e6-+-Add openjpeg2 libraries to config file

201cb72168-+-systemd: slice for all users: also add pinning for libpam-systemd

82313ca750-+-systemd: slice for all users: fix apt pinning

baaf580e4d-+-profile::kafka::broker: move java.security settings to its own class

a66820caa5-+-lvs/icinga: add eqiad monitoring for Kartotherian

9598f82d32-+-lvs/varnish: add notes URLs for Icinga

d6be17329c-+-systemd: slice for all users: drop cleanup code

9b6378bf90-+-elasticsearch: refactor elastic icinga checks

e1d9f50728-+-icinga: add notes URLs to various monitoring checks, part 6

43eb4f5f69-+-swift: add notes URLs for Icinga

1d90ce5061-+-icinga: add notes URLs to various monitoring checks, part 5

59572c1d2e-+-Install xauth on Toolforge Stretch instances

eff518716f-+-Add certs for RAPI and adjust config to use them

3d2c852613-+-Add configuration for the ganeti->netbox sync.

0b5d5f2994-+-xmldumps: set notes URL and contact group to wmcs

72ce5284a0-+-Add support for elasticsearch 6

f1cd63b343-+-debmonitor: add notes URLs for Icinga

a150810ac5-+-mail: add notes URLs for Icinga

b0c323cb82-+-Add pycountry to analytics cluster

e625ee9faa-+-elasticsearch: add Icinga notes_urls part 2

f6943d3794-+-aqs/archiva/druid/turnilo/eventstreams/superset: add notes URLs for Icinga

764dbebe1f-+-DNS: add notes URLs for Icinga

03f1de5b94-+-icinga: add notes URLs to various monitoring checks, part 4

b7a48edfc1-+-puppetmaster/puppetboard: set notes URLs

24f3e87de5-+-Add config file and exclude_mounts options to debdeploy

ce0dc52b31-+-decom of rdb100[123478]

5e69a9e62b-+-toolforge: switch from thirdparty/php72 to component/php72

7c5fe9b50e-+-Reenable reportupdater jobs after analytics replica shard fix

9a3db84b08-+-openstack: monitoring: add notes URLs

2cb7ab9f8a-+-Have coal watch the PaintTiming schema

e2bb18ea44-+-Revert "Revert "icinga: merge https and http checks""

4e667fbf62-+-Introduce role::labs::db::wikireplica_analytics::dedicated

44c9e79a01-+-logstash100[456] decommission

6bb479bbe6-+-rdb200[12] decom

556539446c-+-conf100[123] decom

25dba01824-+-Remove asw-c-eqiad from monitoring

aed554f1e0-+-icinga: set notes_url for Icinga meta checks

d07365687b-+-lvs1007-lvs1012 decommission

b6865f0896-+-Install ack instead of ack-grep

4608a86c1e-+-Revert "icinga: merge https and http checks"

338163e0c1-+-icinga: merge https and http checks

96f8dc08c5-+-phabricator: switch PHP on stretch from thirdparty/php72 to component/php72

750c61d7a0-+-icinga/restbase/eventbus: add notes URLs

2f71e0fb10-+-icinga/toollabs: set notes URLs for toolforge related checks

95647a3bf2-+-icinga: add notes URLs to various monitoring checks, part 2

512a1db88c-+-Update file path to match debdeploy-restarts

c1305ca1fa-+-dumps::nfs: set notes URL

5f24a105fc-+-doc.wikimedia.org: switch from PHP 7.2 back to standard stretch/7.0

61b8b3b797-+-mariadb: Remove mariadb::dbstore

60938eb0e9-+-icinga: add notes URLs to various monitoring checks, part 3

19878a2723-+-icinga/gerrit: add missing closing quote in health check

62ef16e9c6-+-Gerrit: Add icinga check to use healthcheck endpoint

e2bd2a6f16-+-decom analytics100[12]

15d4e7d415-+-decom oxygen

4a17ffc0ed-+-osmdb: refactor the password framework to not use the module

a8289999d0-+-prometheus: change escaped to character classes to work around systemd bug

2f8873b2a6-+-labstore: convert our first systemd timer to the new format

3f1f1535ae-+-decom dbstore1002

8a5866fd0a-+-Sync /srv/published-datasets from SWAP hosts

d73e1c568a-+-ATS: listen on port 3128 by default

ff52939bbf-+-trafficserver: set notes URLs

722a823aea-+-mysqld-prometheus-exporter: Fix typo on configuration

6a39730771-+-Assign role::analytics_cluster::superset to analytics-tool1004

60909081b9-+-role::trafficserver::backend: add conftool client

a97684c194-+-mysqld-prometheus-exporter: Change the default arguments for buster

6d89713195-+-profile::trafficserver::backend: install conftool scripts

4621aff533-+-graphite: uwsgi workers: set timeouts + max RSS

307fc336c4-+-cache: hiera flag to use ATS as local backend

954f7eaf04-+-icinga: add notes URLs to various monitoring checks, part 1

5c54a6dca4-+-elasticsearch: move nagios check to profile

13b1197034-+-cache: get rid of the wikimedia-kernel-updates apt component (2/2)

4ba1356b5c-+-Add an-tool1005 to site.pp/DHCP/partman configs

7f5c0ab168-+-cache: get rid of the wikimedia-kernel-updates apt component (1/2)

51af71b0db-+-noc: apache -> httpd module

c2f74d3482-+-xhgui: require php-mongodb package

42d27d46e3-+-webperf: Rename /xenon to /arclamp on performance.wikimedia.org

7f841b7366-+-dbstore1002: Set it to spare

eb57e7af0c-+-bootstrapvz: work around Buster not yet identifying itself as Debian 10

0b8a05262c-+-bootstrap-vz: use a custom build of bootstrap-vz on Buster

5c341ff343-+-decom ruthenium

1aea91b032-+-decom cp10[58-68] repo entries

4fd073b130-+-wmcs::nfs::misc - Fix ferm rule

65cc0b3ef4-+-wmcs::nfs::misc - Allow incoming SSH from backup server

b1e31783a0-+-wmcs::nfs - Refactor snapshot_manager

f90775c839-+-wmcs::nfs::misc - Fix roles

b030264b31-+-icinga/elasticsearch: add notes URLs

7ae323e5bb-+-Improve CI checks to ensure a basic catalogue compiles on all supported OS's

7e0dc37499-+-icinga: add notes_url for Google Safe Browsing checks

435ca04f51-+-Switch app servers to component/php72

d2e7143710-+-wmcs::nfs::misc - Fixes and backup role

84f8e41161-+-Add analytics-tool1004 to site.pp and dhcp

3cf4a2745e-+-xhgui: fix class name in comments

ca767dc50e-+-boostrapvz: update buster manifest and install on build hosts

fad290c1c9-+-osmdb: stage the roles and profiles for virtualizing the servers

c98eeddb5c-+-move labstore1006 to a role that does no rsync fetches for now

259e48b81b-+-pybal: switch lvs5002 BGP peering from cr1-eqsin to cr2-eqsin

a3ab55b420-+-Add timer to delete analytics EL unsanitized events after 90d

1d0b984d58-+-Disable all reportupdater jobs

4019f07110-+-Remove mcelog on systems which were upgraded from stretch

6eb74ae33d-+-Assign role labs::db::wikireplica_analytics to labsdb1012

9f84ea62c8-+-jenkins: add data types to parameters

76c03d47c5-+-contint: phaseout android slave

1d6e00b4c4-+-Set right owner for admin grants sql

cd53a7c66c-+-profile::mediawiki::php: stop revalidating opcache

0a9ad1a694-+-wikilabels: stage the postgres roles for virtualizing the database

61a08dfa50-+-logstash: disable persisted queue

778ad3ae81-+-Create /etc/debdeploy-autorestarts.conf which lists all automated restarts

e7a0d84f70-+-Revert "Create /etc/debdeploy-autorestarts.conf which lists all automated restarts"

da93ac6fc5-+-Create /etc/debdeploy-autorestarts.conf which lists all automated restarts

62db890cad-+-scap: fix php version, add php7 admin port

d60d454d62-+-decommission old eqiad cache entries

bb70872b13-+-Remove asw2-a5-eqiad from monitoring

b44ff29906-+-kafka-logging: replace logstash1006 with logstash1012

58465d5af7-+-ganeti: Fix path to etc/default file.

266d669ada-+-Add /etc/default/ganeti to allow rapi to listen to 0.0.0.0

f46a8942e6-+-package_builder: Remove support for trusty

65abf829b0-+-kafka-logging: replace logstash1005 with logstash1011

3580a6e2ad-+-confd: Remove support for upstart

a459dbcf8a-+-scap: do not manage package versions via puppet by default

8571acd956-+-add interface::add_ip6_mapped to default production node definition

beab7dd4a7-+-php::monitoring: allow deployment hosts to reach the opcode endpoint

ba87d213d5-+-Find db host and port using refinery

d21f51d269-+-php::monitoring: allow deployment hosts to access the admin port

62f68442e4-+-role::analytics_cluster::coordinator: deploy common analytics repos

45e36481af-+-Enable base::service_auto_restart for atftpd

423c5b5c3a-+-deployment_server: ship logs through logging pipeline

8edc84ddd1-+-mediawiki: Move hhvm-fatal-error.php to Puppet

b4d29ee2b0-+-Add labsdb1012 basic puppet settings

5f6d770279-+-network::constants: replace logstash1004 with logstash1010

62660c2da2-+-logstash101[12]: add ipv6 mapped address

c310e29233-+-logstash1010: add ipv6 mapped address

51f0f58953-+-kafka-logging: replace logstash1004 with logstash1010

6180998b7d-+-network: Fix list of bastions for labs realm

1c75368883-+-Set up eventgate-analytics.discovery.wmnet

754e2fb545-+-icinga: allow meta-monitoring bot user

35635ff6a8-+-nagios_common::commands: Remove support for trusty

27e99fd9ed-+-cirrus: fallback option to use localssl via acme subject

e773a8751b-+-ulogd puppet profile.

bcab2ccff8-+-icinga: Make use of the strong TLS ciphersuites configuration

c9731d3579-+-Pull every minute from git the charts

d18a64085c-+-Run helm repo update more often

55c094dcd8-+-deployment_server: Remove deprecated deployment-charts clone

24c159ab17-+-logstash: remove log4j input

99e8ba9fcb-+-acme_chief: Avoid showing diffs of private keys

f9feb7fec0-+-ganeti: Change ownership of rapi users file to match required ownership

443523c509-+-webserver_misc_apps: unbundle grafana

e4dfdeea8e-+-logstash: remove elasticsearch role from logstash100[456]

1b23266b50-+-prometheus: require package before masking services

b7f37664dd-+-Pin EventLoggingSanitization to current refinery-job jar version

592e76e97c-+-gerrit: stop sending logs directly to logstash

3c73ecbbbf-+-certcentral: wipe certcentral from our puppet codebase

e5daa8d13f-+-hadoop: store Yarn rmstore state on HDFS

e14207c255-+-Install maven and ivysettings on all hadoop workers and clients

b5a0bf7207-+-Make lvs5003 peer with cr2-eqsin

0ca9fe4812-+-install_server: Get rid of certcentral instances

87115900f8-+-librenms: Make use of the strong TLS ciphersuites configuration

1b41aea881-+-netbox: Make use of the strong TLS ciphersuites configuration

2554aa515a-+-Scap: upgrade to 3.9.0-1

814c0e91d0-+-authdns: Drop certcentral hosts access (2/2)

fd3aa54c99-+-authdns: Drop certcentral hosts access (1/2)

5df0fef63a-+-prometheus: disable shipped node-exporter ipmitool and smartmon timers

ac3dc4e0b2-+-logstash: disable syslog-tls input, unused

1c364cd0ea-+-update pdns-recursor pin on jessie

99b40f1569-+-tendril: Get rid of certcentral certificates

700023e139-+-netbox: Get rid of certcentral certificates

1fcac85e97-+-mail: Get rid of certcentral certificates

bc9489677c-+-mirrors: Get rid of certcentral certificates

021741ce47-+-lists: Get rid of certcentral certificates

b16ebf1033-+-librenms: Get rid of certcentral certificates

bd172cb67d-+-icinga: Get rid of certcentral certificates

478d8a4a02-+-postgresql: Remove support for trusty

bd92dedfde-+-gerrit: Get rid of certcentral certificates

08348fd455-+-parsercachepurging.pp: Increase TTL from 24 days to 30

06362990a7-+-Explicitly install ruby-safe-yaml to fix Puppet Icinga check

838c66e8c0-+-toolforge: remove use of '::imagemagick::install'

3efb031430-+-Use user/group root for icinga check command for eventstreams

204a3b9f35-+-Use nagios_common::check_command::config to define check_eventstreams

ded2f1de64-+-Monitor stream.wikimedia.org public endpoint

f4779358e4-+-dumps: Get rid of certcentral certificates

0f32fb6f4e-+-archiva: Get rid of certcentral certificates

6569a4bc4f-+-archiva: Switch from certcentral to acme-chief certificates

bdd8fb98ce-+-install_server: Get rid of certcentral certificates

b1ff5b928f-+-tendril: Use strong cipher for tendril

dbae01e26c-+-Revert "ircecho: Convert script to python3"

998a888b69-+-Create module for managing ulogd

19ac1de2da-+-mirrors: move to syncproxy2.wna.debian.org

8ee510e87c-+-tendril: Deploy acme_chief TLS certificates

b045b3228d-+-netbox: Deploy acme_chief TLS certificates

0545be0bd2-+-mail: Deploy acme_chief TLS certificates

78732d29ef-+-mirrors: Deploy acme_chief TLS certificates

1723e0e6d5-+-lists: Deploy acme_chief TLS certificates

e53fc2cd0f-+-librenms: Deploy acme_chief TLS certificates

a01680d449-+-icinga: Deploy acme_chief TLS certificates

a154839e26-+-gerrit: Deploy acme_chief TLS certificates

84ccd09b6d-+-dumps: Deploy acme_chief TLS certificates

b31fbc9aeb-+-archiva: Deploy acme_chief TLS certificates

72fef3e111-+-installserver: Deploy acme_chief TLS certificates

c01a1390a1-+-Add ganeti read-only user deployment

72eb3e83c9-+-imagemagick: Resolve version conflicts between toolforge and prod

c712d431a0-+-openstack: use new repository for mitaka packages

beae8547de-+-aptrepo: pull openstack mitaka packages into reprepro

5a7658cd40-+-profile::analytics::refinery::job::test::camus: fix checked topic

bf20523dc2-+-profile::analytics::refinery::job::test::camus: fix topic whitelist

d984f686bc-+-Icinga: add cr2-eqsin mgmt interface

c210efdbc5-+-elasticsearch: add a file with the list on elasticsearch instances

c0f834553e-+-profile::analytics::refinery: ensure log dir only for 'hdfs'

62525a8780-+-Add profile::analytics::refinery to notebook100[3,4] and stat1006

73533ae1f7-+-Monitoring: add cr2-eqsin

f8f8060c6f-+-toolforge: Allow pods to mount /mnt/nfs

c29526d842-+-profile::analytics::refinery: add a wrapper for analytics-mysql

f116c001e9-+-Revert "imagemagick: Unconditionally use /etc/ImageMagick-6/"

f2a60c3e51-+-logstash: remove cycle for apt::pin in collector

0d8569ccd8-+-Remove usages of ::cdh::spark, we use ::spark2 now only

3dfea1448c-+-logstash: force use elasticsearch-curator 5

c2c5590743-+-Rename kafka webrequest test topic

d4c744e4ff-+-install_server: purge old files from /srv/autoinstall

260f10c14f-+-profile::prometheus::nutcracker_exporter: Remove trusty support

05ea3db06a-+-instance.pp: Make read-only check use the variable

9cf51b58da-+-mariadb: Make staging not read-only

3452bcc187-+-Restore privileges to admin table after script

ad7a89a241-+-Correct analytics-drop-xmldumps systemd-timer name

cc226dc638-+-Add analytics purge job for xmldumps on HDFS

b016fda44a-+-profile::mediawiki::php: install tideways-xhprof, remove tideways

4fadd1ae82-+-logstash: apply role::logstash to new logstash101[0-2] hardware hosts

c436f44ce5-+-uwsgi: Remove support for trusty

17c8761160-+-Remove stray packages after dist-upgrade on buster

33e6ebcb74-+-Add role::spare::system to kerberos1001

aa6a1c169a-+-toolsdb: Enable monitoring

a99f92254c-+-toolschecker: Replace labsdb1005 with clouddb1001

e447df597e-+-maintain_dbusers: add the new database VM

ac36def5e0-+-aqs: add the possibily to deploy nodejs 10

ae6c7c6ece-+-Revert "NFS: allow the clouddb-services project to mount tools home and project dirs"

2afcebb249-+-Revert "wmcs services: introduce profile for maintain_dbusers in services nodes"

6fdb2af049-+-Revert "wmcs services: fixed a few resource paths for maintain_dbusers"

f5371f870e-+-tools-bastion: need the checksum type

8af7be7174-+-service::node: add the 'use_nodejs10' parameter

7dca34bea2-+-toolforge: Use a really old version of kubectl for the current k8s

0b6d2b8ff5-+-mariadb: Fix dependency typo on backup directory

187d317ebf-+-mariadb: Update mariadb logical path location

221ab17a47-+-tlsproxy::instance: move under profile namespace

615c3b2c73-+-imagemagick: Unconditionally use /etc/ImageMagick-6/

b2176c29dc-+-wmcs services: fixed a few resource paths for maintain_dbusers

3f7002ecb8-+-wmcs services: introduce profile for maintain_dbusers in services nodes

c319c92c4a-+-NFS: allow the clouddb-services project to mount tools home and project dirs

e41bb2a59d-+-wmcs: introduce new toolsdb primary role

1bbc95963e-+-dumps:nfs: add data types, move variables to parameters and Hiera

76316958e8-+-toolsdb: fix up the config for the new server

1e60bf907f-+-labsdb: open up some firewall ports for VM access

9205fbc2c6-+-toolsdb: refactoring some of the mariadb things for toolsdb

2c36332633-+-cloudvirt1009 - Define correct role

828d6a628e-+-Reactivate refine_eventlogging_analytics after maintenance

9644a70493-+-Temporarily deactivate refine_eventlogging for maintenance

10b62d8e6b-+-rasdaemon: add hiera overrides for testing on stretch

381cb2008e-+-profile::hue: set default database password (to ease testing)

3fb278a4c7-+-Drop requires_os checks for trusty

2d6da67cbc-+-Upgrade docker in CI

2a58197b8d-+-profile::analytics::refinery:job::data_purge: absent timer

a5a986bf1e-+-Define the zookeeper rmstore path on each Hadoop cluster

8c8f4dfd5d-+-profile::services_proxy: make declaring services optional

f56985b717-+-ci: Permit git traffic between zuul mergers over ipv6

42aeefdf25-+-elasticsearch: both relforge clusters are accessible from mwmaint

164621d873-+-Rename labvirt1012 to cloudvirt1012, with Stretch

19f2500cfd-+-service::deploy::gitclone: set 'shared' param to true

b349d9a1b3-+-service::deploy::gitclone: let wikidev group own files

b557f20208-+-decom graphite100[12]

fda02769e4-+-visualdiff: create empty testrun.ids but don't change content

da8aba374f-+-logstash: move role::ls::eventlogging to profile::logstash::collector

368b00c545-+-service::deploy::gitclone: add '/deploy' suffix to clone dir

63e7bac2ff-+-decommision analytics1003

a6fb183424-+-systemd: slice: all_users: use proper syntax for apt::pin

383694b14e-+-systemd: user slice: pinning for libsystemd0 as well

3bc7af1c55-+-prometheus: attempt to force apt update

21fe5f3073-+-HTTP availability alerts: Decrease retries to 1

2e000e4cdc-+-maps: restrict OSM sync check to maps2001

61fe753e32-+-profile::analytics::refinery: require python3-dnspthon

7e4235fed5-+-thumbor: add support for debian stretch

38b93d19ca-+-cassandra: package should be installed after apt-get update

57c7d23a23-+-Remove all non kubernetes related zotero stuff from repo

3f5d1db38a-+-thumbor: add support for debian stretch

882abbf1b3-+-profile::redis::multidc: Remove trusty support

f0b3e5c3ae-+-memcached: Unconditionally use systemd

ac6a5f89fa-+-services: add missing 'mediawiki/services' prefix to git cloning

3307cd5abd-+-phabricator: Remove old mail config

e8cb4afc7e-+-tor: add data types to parameters

aba55dac69-+-prometheus: do not change trusty hosts

0388ea939c-+-mediawiki/scap: do not install sql scripts on canary appservers

6e2e66bc60-+-Revert "role::eqiad::scb: Switch rdb1006 to redis::misc::master"

767bdf1800-+-start to decom ruthenium, turn into spare

429a99123b-+-service::docker s/directory_ensure/ensure_directory/

e06f27df3f-+-testreduce: pin npm to backports, use install_options

01443ed099-+-mediawiki: Remove beta-cluster specific auto_prepend_file override

fb511f191f-+-prometheus: use yaml rules files for prometheus v2

0d20de2950-+-Add rasdaemon service to systems which support it.

8817c8ce79-+-graphite: use unique descriptions for icinga check

f9777af9fb-+-role::analytics_test_cluster::coord: add kafkatee instance

33533270d3-+-elasticsearch: add parameter to set elasticsearch version

6c7db2a761-+-profile::mediawiki::php: allow to fine-tune request timeouts

cc28691262-+-authdns: Allow acme-chief servers to fulfill ACME DNS challenges

d095fe4a40-+-uwsgi: Take buster into account

a8f79756ad-+-netbox: set ADMINS to default empty list

108ba276b5-+-site: Switch acmechief[12]001 to acme_chief role

488522b2a1-+-acme_chief: Create acme_chief module as a duplicate of certcentral

8da3d7e900-+-Make base::service_auto_restart for SSH conditional on jessie as it depends on systemd

cb457230ab-+-Enable base::service_auto_restart for SSH

978b1c36ee-+-prometheus: use eqiad for mirrormaker alerts

e0b9409eaf-+-Revert "Cloud vms: enable a default tty"

f8e05e00fe-+-Monitoring: add VRRP check

a38276b735-+-toolforge-k8s: set up an haproxy load balancer for HA api servers

ad4baeae50-+-wmcs::monitoring - Fix typo

cc5c1171b5-+-wmcs::monitoring - Convert cronjob to systemd timer

dc114fe3ac-+-logstash101[012] puppet repo updates

61bf9c51d5-+-prometheus: use non-namespaced hiera key to enable site lookup

e705ccc9e4-+-logstash::collector: pull logs from both kafka-logging clusters

6a7227e6de-+-sca: Remove the cluster

420e6f20ee-+-Cloud vms: enable a default tty

935a0add00-+-toolforge::clush::master - Fix typo

be03d48af5-+-toolforge::clush::master - Fix systemd timer definition

87bc9c6b20-+-site: Add acmechief[12]001 as spare servers

65d1f64462-+-toolforge::clush::master - Convert cronjob to systemd timer

f1b1c6f495-+-admin: ensure correct ordering of resources

052ec18955-+-Revert "Revert "Move evaluation of wikimedia_trust/nets to puppet""

9ab5588709-+-role::statistics::gpu: Install AMD GPU firmware

e26b16460a-+-role::statistics::gpu: Enable ferm

d81078c9f9-+-elasticsearch: cleanup typo

16566c32c6-+-elasticsearch: unassigned shard icinga check

471de6853c-+-role::analytics_test_cluster::coordinator: add basic camus support

34ecd88f05-+-prometheus: upgrade prometheus-node-exporter to latest patchset

57903a2821-+-profile::mariadb::dbstore_multiinstance: add a note for Analytics

fb751c461f-+-testreduce: no require_package for nodejs, avoid dependency cycle

784ace3514-+-icinga: fix manual sync procedure during failovers

e0ba1637f9-+-ircecho: ensure=>running not necessary/is harmful

0920dda459-+-icinga: cleanup legacy code

697d8d199a-+-toolforge: Install Tesseract from stretch-backports

ce2a3a682c-+-Revert "Move evaluation of wikimedia_trust/nets to puppet"

2da485a67f-+-Move evaluation of wikimedia_trust/nets to puppet

46addadaf2-+-maps/osm: Stop supporting trusty

b93c18d96e-+-profile::analytics::cluster::repo::statistics: fix directory (again)

b7b5843285-+-profile::analytics::cluster::repositories::statistics: fix mw directory

b1d49cb4a4-+-icinga: enable check for psi and omega clusters

d541f639c3-+-Add common statistics repositories to stat/notebook hosts

d0072935cd-+-Only install mcelog on jessie and stretch

c150c6b6f9-+-Don't install pxz on buster

500d7225a4-+-Only enable backports up to stretch

38681bae93-+-certcentral: Fix validation_dns_servers key name

5faaa5b0fe-+-role::beta: introduce docker_services

85e98027c4-+-tmpreaper: do not break systemd units using a PrivateTmp directory

1de01c71a1-+-mariadb: Change staging DB to 3350

9e93a9bd40-+-superset: add ability for superset to connect to new staging DB

a175b1d654-+-contint::packages::php: Remove support for trusty

30aa84831a-+-Remove role::wikimetrics::staging

4b91a55312-+-Refactor mysql::config::client to mariadb::config::client

b07bcee820-+-prometheus::node_exporter: Change OS detection for buster

60ee68059a-+-Icinga: add ping check for ulsfo PDUs

da5dd42aff-+-profile::toolforge::bastion::resourcecontrol: fix class definition

69e65f78e5-+-Introduce systemd::slice::all_users

c876429c09-+-Add file resource for translation-engine.inc.vcl

82427f63ae-+-mariadb: Switch db1114 and db1118 roles

d892ff03ee-+-toolforge: grid: exec_environ: use libmariadbclient-dev* packages

7fdb74ba61-+-redis: Stop supporting trusty/upstart

a65ca4bd7e-+-openstack: add some ipv6 firewall rules

d45a46d7ee-+-phabricator: Add new cluster.mailers

8d43e9b45c-+-contint: add data types to parameters

2525717a48-+-librenms/smokeping/rancid/netbox: add data types to parameters

dfc977a50a-+-openstack: include 'envscripts' on compute nodes

216170c1a4-+-logstash: add input identifier tags to kafka logstash inputs

dc7d9fc31f-+-openstack: refactor 'envscript' bits into their own profile

f814bac67c-+-prometheus: upgrade to node-exporter 0.17

1c236fbb67-+-toolforge: shuffle some packages into and around genpp

4f0df0bc7e-+-maps: migrate maps2004 to stretch

dff454a5a8-+-Revert "icinga: enable check for psi and omega clusters"

dac9c85d63-+-icinga: enable check for psi and omega clusters

d5b366c45b-+-Separate logfile for production sqoop

d176a2363b-+-ssl: get rid of the expired digicert-2017 certificate

bf50ea6143-+-cloudvirt200X-dev: add roles in codfw1dev

b5d3e4ddfc-+-cloudcontrol2001-dev: spare system for now

b78987fa97-+-spamassasion: Skip localhost entries

7db354ca4b-+-mariadb: Set read_only monitoring for core_test hosts

9755e15017-+-Use correct command from systemd timer

be64ab2766-+-icinga/gerrit: add double quotes around URL part in check command

8347c39c41-+-nova: install libguestfs-tools on compute nodes

7488ee2eaa-+-Remove unused role::wmcs::web_interfaces

4d40f067a8-+-Revert "icinga: enable check for psi and omega clusters"

a43f444456-+-icinga: enable check for psi and omega clusters

e1a4f43ad7-+-networks: Remove old and deprecated all_networks var

2e0d052f61-+-varnishkafka: Remove support for upstart

08bd294ea0-+-dnsrecursor: Switch to using aggregate_networks

9cd6b60c84-+-prometheus: reuse exec from ::server in ::rule

3b50c4c5c9-+-prometheus: fix prometheus::rule beta invocation

75d60207a8-+-mx/otrs/lists: Move spamassasin to aggregate_networks

dddc5d769f-+-role::deployment_server: add the services proxy profile

c38215a2c0-+-profile::wmcs::monitoring - Fix IPv6 lookup

a6f0d3f5cd-+-role::analytics_test_cluster::hadoop::worker: add hadoop users

c9d829bf70-+-profile::wmcs::monitoring - Fix missing package

b6afd27b81-+-profile::wmcs::monitoring - Use openstack clientpackages

594b810b09-+-prometheus: use .yml for v2 rules

02f2df11da-+-prometheus: use v2 rules for beta

01ad75150c-+-role::wmcs::monitoring - Include profile::wmcs::monitoring

5c0f288730-+-prometheus: add feature flag for v2 compat

dfe813ccb1-+-mediawiki::common: add proxy for services

337d2049eb-+-Fix system::role for analytics_test_cluster's roles

c479991f81-+-statsite/statsd: Unconditionally use systemd

a9a5c6408b-+-role::graphite::base: Unconditionally use systemd

76bafd5f63-+-lxc: Remove support for trusty

e420919e97-+-icinga/gerrit: move gerrit monitoring to icinga module

090e32bb54-+-gerrit: add icinga https check for actual JSON content

2b3e393beb-+-rsyslog::kafka_shipper: raise rsyslog MaxMessageSize from 8k to 64k

c611fe0f02-+-releases::reprepro: Remove trusty

aa4d9bf2a4-+-jenkins: stop purging nodepool agents config history

a756bcfb37-+-ntp: Update comment for usage of all_networks

35154e1f3d-+-graphite: nodepool is gone, drop whisper_cleanup

37a3393c25-+-openstack: spreadcheck: typo in relationship

b3c0f2e9d0-+-openstack: spreadcheck: use the 'wmcs-' prefix

c5f80e3bfb-+-openstack: admin_scripts: also rename puppet dirs to include the prefix

8dd8fd841e-+-openstack: admin_scripts: fix relationships

b3c17f4c3b-+-wmcs: prefix all of our customs scripts with 'wmcs-'

af828514e2-+-wmcs: monitoring: refactor code into roles/profiles

5a8d789c0e-+-graphite: refactor into role/profile

caa821fadd-+-certcentral: Get rid of authorisedhost exported file resource

ccd62773f6-+-striker: Remove support for trusty

5afd5b339b-+-Ditch certcentral config template, configure in puppet

87a375a010-+-shinken: Remove trusty support

85ff59da87-+-strongswan: Stop supporting trusty

813761576b-+-vagrant: Remove support for trusty

f9482fee84-+-planet: add data types and hardcode https link, not proto-relative

02940c8676-+-delete ifttt roles and module

052f92d9e4-+-logstash::collector add input identifier tags

5e262ebe16-+-toolforge: bastion: also apt pin udev

c6cfb0e1ad-+-toolforge: bastion: split resource control puppet code

1af5c13f62-+-graphite: Remove support for trusty/upstart

f96a7a4c20-+-hhvm: Remove support for pre stretch

aefc2f61b8-+-Remove unused statsite::decommission class

cb03ff1a9d-+-keyholder: Remove support for Ubuntu

7a49f20ab5-+-Add apt pinning for buster

16cf1a9a25-+-Revert "Revert "Revert "Add apt pinning for buster"""

7d56e2df29-+-Revert "Revert "Add apt pinning for buster""

76569af0d1-+-Revert "Add apt pinning for buster"

403e13f993-+-Add apt pinning for buster

7af26ae81a-+-toolforge: bastion: introduce apt pinning for systemd

93bf1a4c25-+-Fix ports for wmcs/labs' Prometheus Memcached exporters

bdeb19cd41-+-openstack: reallocate openstack wrapper script

473ae62098-+-mariadb: Rename sdb instance to staging

3561a60435-+-toolforge: fix script naming for run-parts

9a2e249a04-+-decom baham

6e34363925-+-mw2213 decom

964b16761d-+-wdqs: make free allocator check unique

c0e80eb581-+-icinga alert for syslogged EDACs

048a45ad40-+-profile::services_proxy: simple local proxying for remote services

23557c9cdd-+-profile::mediawiki::php: conform error reporting levels to HHVM

71856da1d0-+-Revert "Add apt pinning for buster"

e3febad9fa-+-Add apt pinning for buster

02f9919db6-+-maps: re-enable OSM lag check

ed2e3b622f-+-testreduce: pin npm to stretch-backports

2e817c0546-+-toolforge: install libexiv2-dev on grid nodes

2db259227b-+-toolforge: upgrade the stretch grid to openjdk-11

32a763d793-+-toolforge: install libboost-python-dev on grid nodes

5f44b08737-+-toolforge: change dev_environ into shell_environ

f4fc09c42c-+-Designate: allow monitoring access to the designate api over ipv6

5c4b0e81ce-+-prometheus: replace nova API endpoint for eqiad1

74801d90bd-+-phabricator: allow http from deployment hosts on stand-by servers

6ea39c74f1-+-prometheus: update for new eqiad1 service hosts

fc6d2af984-+-wdqs: add icinga check of free blazegraph allocators

dbdce3f1de-+-phabricator: firewall hole to allow http from deployment hosts

acf01a31ee-+-Revert "labs dnsrecursor: require clientlib before labsaliaser"

ab342600f7-+-labs dnsrecursor: require clientlib before labsaliaser

ae4b183b3c-+-toolforge: Rotate SGE accounting file from NFS master

15c7200c95-+-prometheus: drop rsyslog_exporter default metrics not containing ':'

748063fe8b-+-prometheus: set retention period for v2 compatibility

fc3d0905fb-+-ircecho: Drop sysvinit support

e8d1887699-+-Sqoop actor and comment from production monthly

7753d9c55a-+-Normalize field names in eventlogging_to_druid_job calls

52e09b722e-+-ores: Enable checking of celery list key

88e23a9613-+-toolforge: cleanup unused code for services nodes

d921742fd7-+-elasticsearch: remove search_thread_pool_executors param

58950ee84b-+-maps: migrate maps1001 to stretch

379dd35a47-+-wdqs: convert prom exporter script tp py3

89de1e120f-+-puppetmasters: Remove support for trusty

fe3cefcdf4-+-dbstore_multiinstance: Add staging db

dec61193de-+-mariadb: Provision dbstore1005

fece35d5dd-+-toolforge: process dynamicproxy access logs

5343174087-+-publichtml: add data types to parameters

41f9cf9b24-+-toolforge: change the default proxy options to real proxy servers

def9a8c81f-+-toolforge: remove nodejs-legacy from the stretch grid

d316b289cc-+-Deactivate EL Druid loading job for PageIssues schema

90be96b1df-+-toolforge: ensure stretch grid nodes use backports for nodejs

c80a2f8f42-+-geoip::maxmind: add data types, rm deprecated validate_string

f9432126d2-+-toolforge: Prometheus replacement for sge.py diamond collector

a18931cc2e-+-webperf: Document which class is which regarding xhgui

ed532a6764-+-role: add storage_retention for prometheus beta

633203d8a3-+-toolforge: add npm to the stretch grid nodes

cd6be0f7cd-+-profile::analytics::packages::statistics: deploy git-lfs

afb1c0a321-+-cloudvps: neutron: l3_agent: drop redundant hiera keys for interface names

6314383688-+-cloudvps: neutron: l3_agent: merge similar code for eqiad1/labtestn

d7b0ef48bd-+-cloudvps: neutron: introduce base interface hiera key

f8e40f287a-+-profile::analytics::refinery::job: remove old cron-related parameters

753fbf05bd-+-Clean up old code in  Analytics' classes using systemd::timer::job

400b98eadd-+-Create a testing Analytics Druid cluster

668bec0fe8-+-profile::analytics::refinery::job::spark_job: handle ensure and cleanup

8bd7393e13-+-systemd::timer::job: add proper handling of ensure

8e4b4accc0-+-parsercachepurging: Increase keys TTL

b18a2a3f7b-+-site: mw2151 should not use spare role anymore

70bf0fd6c0-+-site: add mw2151 as another jobrunner host

657a5d3fd2-+-wikistats: cron job minutes are integers, not strings now

aa312339a8-+-wikistats: add data types to parameters

11cd978a41-+-package_builder: add data types to parameters

eb61ed7819-+-webperf: add data types, split statsd host/port params

ae81aa34c4-+-profile::analytics::refinery::job::project_namespace_map: fix timer's script

86e26b060e-+-spreadcheck: fix path to spreadcheck-tools.yaml

5a956bf836-+-cloud: rewrite spreadcheck.py NPRE check

d6654478f0-+-mariadb: Provision dbstore1004

0d33f6fc81-+-logstash: set consumer_threads for kafka input

a4162e6dc6-+-profile::statitics::private: remove stat1007 specific bits

725b77426e-+-profile::analytics::refinery::job::project_namespace_map: move to timers

0ceee97df3-+-profile::analytics::refinery::job::eventlogging_to_druid_job: move to timers

9ee6b81c24-+-profile::refinery::job::refine: move all crons to timers

3d02d7630d-+-mariadb: Demote db2040 from being an s7 master to just a replica

2f8ac4ee9f-+-mariadb: Promote db2047 to master on configuration management

74957753da-+-helm: add data types to parameters

65da428255-+-profile::analytics::refinery: move sanitize_eventlogging_analytics to timer

aa15ea3d2d-+-labtestneutron2002: reimage in stretch + rename to cloudnet2002-dev

27867b19b8-+-reportupdater: move all jobs to systemd timers

f97b76ee5a-+-package_builder: Remove support for trusty

720ef6113b-+-prometheus: install wmcs_scripts dependencies from jessie-backports

75e0911616-+-prometheus: move ::scripts to ::wmcs_scripts

e700b71d68-+-prometheus: update prometheus-labs-targets to use keystone/nova clients

d194f0c74e-+-admin: allow users to be deployed without ssh keys configured

510211ec44-+-reportupdater::job: use absolute paths in timer's definition

5d11bbed2a-+-profile::reportupdater::jobs::hadoop: move jobs to systemd timers

9c174562f8-+-labstore - Allow multiple bdsync jobs per host

c82f79c932-+-toolforge: update the version of php-cgi to 7.2 as well

ecde8da67d-+-toolforge: remove phpunit from the stretch grid

217dd07ca6-+-releases: add data types to parameters, move vars to params

038e338542-+-toolforge: upgrade the stretch grid to PHP 7.2

43cace62d8-+-toolforge: move SGE diamond collector to cronrunner on Trusty grid

cac85ec97b-+-labtestneutron2001: reimage to stretch and rename to cloudnet2001-dev

82aa0c1fc1-+-labstore::device_backup - Expose systemd OnCalendar syntax

fd42558232-+-Assign role::analytics_test_cluster::hadoop::ui to analytics1039

8113d4fa25-+-kartotherian: install nodejs-legacy module

eda7ce2a1c-+-apt: repository: trust also the source repo

fad0086804-+-Assign the Hadoop coordinator role to analytics1030

6edd146861-+-eventlogging: Remove all mentions of MongoDB

15a027ce1c-+-Remove unused python-pymongo from eventlogging::dependencies

2b170f691d-+-toolforge: use new instance for aptly server

c87840f95a-+-toolforge: fix the services role in case we need to rollback

3c7b3963fd-+-toolforge: move webservicemonitor to the cronrunner

56b3e61f85-+-docker_registry_ha: package installation missing

1b0c080329-+-role::prometheus::analytics: add Hadoop test cluster metrics

4d5529f6f7-+-aptly: add required ferm rule

4afe1499c8-+-maps: migrate maps1003 to stretch

819cb707f2-+-network::constants: add Hadoop testing masters

a24f0a6687-+-Enable base::service_auto_restart for uwsgi-striker

69d3e8a3d2-+-Configure analytics1028->41 as Hadoop Analytics test cluster

a36cb5724f-+-role::eqiad::scb: Switch rdb1006 to redis::misc::master

e58ee2dde1-+-mariadb: Promote db1078 to s3 master

99eff8b01a-+-testreduce: remove "Before" for apt:repo dependency cycle

120cd8564a-+-testreduce: use component/node10 for node 10 on stretch

31d60c4e42-+-webserver_static: add proxypass LDAP password for static RT

7c5ff8914e-+-Add Blubber directory to releases server

fb38b7f72f-+-xhgui: Remove outdated clone of xhprof mirror

fa546330f1-+-toolforge: change exec-manage to not try submissions and set up on masters

f365971306-+-Revert "SGE: move exec-manage script from bastions to grid masters"

f1f126a888-+-mediawiki: Stop logging each run of purge_abusefilter.pp

fe762d7563-+-sge: second attempt to get exec-manage installed on the master

5302438d5f-+-SGE: move exec-manage script from bastions to grid masters

91516aad7c-+-toolforge: refactor docker registry profile

018ae0e66c-+-wmcs::nfs::misc - Add nfsd-ldap package back

15b15bbce3-+-Elasticsearch failed shard allocation check

cfa170d39e-+-toolforge: services: sync aptly repo

192b9f7196-+-visualdiff: ensure git clone happens before creating pngs dir

8dff31eb21-+-service: ensure parent dir exists before git cloning

af8df96525-+-Switch category endpoint config to 9990

017e84218f-+-contint: delete unused doc.wikimedia.org site config

9df5dd5f95-+-wdqs: prometheus-blazegraph-exporter supports multi instances

b08800d584-+-toolforge: pin python3 requests to backports for jessie on proxies

ddda7b3369-+-Revert "wdqs: prometheus-blazegraph-exporter supports multi instances"

30e4132fa6-+-wdqs: prometheus-blazegraph-exporter supports multi instances

9c8a39ed80-+-Initial docker::registry::ha puppetization.

4cf7484e24-+-profile: introduce kafka::broker num_partitions

787cd2589c-+-site.pp: Convert dbstore1003 to multiinstance

caa1176173-+-elasticsearch: mask default exporter

e609786617-+-Revert "elasticsearch: mask default exporter service"

7eb541e584-+-elasticsearch: mask default exporter service

d0f0374166-+-Introduce role::analytics_test_cluster

9f2727a3b2-+-service::node: do not install nodejs-legacy if on stretch

95f3c262ea-+-profile::mediawiki::webserver: inline mediawiki::conftool

af4636a9a0-+-wdqs: removed unused port parameter on wdqs::monitor::blazegraph

4a778a9bd4-+-wdqs: monitor blazegraph process per instance

9979e75950-+-doc: ferm, allow http connections from deployment hosts

dce248ca33-+-doc: force users umask for wikidev group

69542f024a-+-Create second Blazegraph instance for categories

8c812677f2-+-wmcs::nfs::misc - Second attempt to fix nsswitch.conf

bc5b7ed6b6-+-cache: Add kernel-proposed-updates component for cp1075-99

347d8ad59f-+-toolforge: aptly: create stretch/jessie repos

831b943e44-+-Reference grafana dashboards by UID for alerting.

0706ef5301-+-Introduce $aggregate_networks, deprecate $all_networks

a47b45a72c-+-wmcs::nfs::misc - Fix typo and nsswitch.conf file

faf325cd22-+-hhvm: Remove support for trusty/jessie

90df904a55-+-wmcs: add a script to update VPS proxies

4f15654f91-+-testreduce: also pin nodejs,nodejs-dev,npm to stretch-backports

8710dbd645-+-sonofgridengine: control the global and scheduler grid config in puppet

db004e464a-+-Fix grafana alert check to accomodate new grafana version

50f1da812c-+-Add new nova proxy IPs to some firewall defs

d08ff5418c-+-dynamicproxy api: include sqlite3 package

50d493fbd9-+-authdns: reload (replace) gdnsd on config changes

3cf87c273b-+-authdns: add NRPE for gdnsd checkconf

cd728641cd-+-Prepare for multi-instance Blazegraph

5fe7921e9c-+-toolforge: docker builder: missing infrastructure profile

2e329fc777-+-wmcs::nfs::misc - Refactor into profile/role

1c88049b5f-+-toolforge: refactor docker builder profile

89b8c4116e-+-tor::relay: make Tor family configurable and move to Hiera

26b870e4a0-+-wdqs: wdqs profile was renamed

3e27f1d978-+-create static microsite for RT ticket archive, copy static Bugzilla

e1ee215681-+-wdqs: force creation of /etc/wdqs/RWStore.properties as a file

fc1958ce93-+-wdqs: force creation of /etc/wdqs/RWStore.properties

65741aeff5-+-Puppetize blazegraph config for cases where deployed one is not enough

3dcb941ce1-+-wdqs: preliminary work to manage multiple instances

da452fc127-+-webserver_misc_static: move backup::host to role

4e4320fce3-+-Remove support for older distros in some Apache classes

b7ac1d2568-+-conftool::client: remove obsolete trusty distribution check

eee6e54b61-+-ATS: use stock request coalescing settings

d4cc6c131f-+-openstack: remove redundant sqlite3 declaration in cloudvirt hosts

014f4479b1-+-openstack: enable net nodes in the mitaka/stretch combination

91c5e362f3-+-camus: clean up references about crons

181977ba5e-+-profile::analytics::refinery::job::camus: move all crons to timers

fa382d4dc6-+-Swift: Drop support for older distros

933b840592-+-profile::analytics::refinery::job::camus: move more crons to timers

063af46c47-+-systemd::timer::job: allow to specify SyslogIdentifier

0454754172-+-Enable base::service_auto_restart for passive Icinga node

f9b4b74191-+-camus::job: properly clean up crons when systemd is used

ee0fafca02-+-profile::refinery::job::camus: conver netflow to systemd timer

ee3aa62aad-+-systemd::timer: allow more normal forms for datetime type

aca4fc3ca0-+-doc: add php7.2-xml package

1e32fefd80-+-authdns::scripts: no more python-jinja2

a3e32a119f-+-Assign role::spare::system to analytics1028->41

d647444aa3-+-wdqs: reduce heap size to 31G to keep compressed oops

306cf6a808-+-wdqs: reduce heap size to 31G to keep compressed oops

8990f8889c-+-wdqs: dashboard for WDQS lag has moved

b3b642c7a5-+-Remove ci::publisher, no more used

5614cce1b9-+-openstack: virt: dont install libssl1.0.0 in mitaka/stretch

6db6a5a6e2-+-wmcs: Add postgres maps users for eqiad1-r region

37a25c86cc-+-videoscaler: remove last references to videoscalers as a separate cluster.

4337badd6c-+-site.pp: fold videoscalers into jobrunners

2431e5663c-+-systemd: introduce timer::job define

86630974db-+-ci: add some gated extensions to git cache

f85c37c0fb-+-mediawiki: rename the maintenance role to match other roles

1a39138077-+-httpd::mpm: add support for a content param

edbfabda0c-+-profile::statistics::private: allow geoip to use kerberos

e1f82bd38c-+-zuul: allow email connection

0876838784-+-Bump up refinery_version in refine.pp to v0.0.83

96e887189e-+-Switch on RefineMonitor for Analytics EventLoggingSanitization

1c3635215e-+-profile::hive::site_hdfs: move exec to cdh::exec

0ff3c22fb7-+-jobrunner: support php7

c75b314b1f-+-puppet:Reduce cronspam from modules/mediawiki/

8b92f2548c-+-icinga: fix URLs to dashboard links

b2fa7cd42d-+-Add fu-berlin.de networks to our poolcounter whitelist

040b854e99-+-toolforge: remove duplicate stretch python packages

c4f6e0d39b-+-toolforge: Add missing php packages

5cbe69d35a-+-Update analytics eventlogging_to_druid_job.pp to mirror changes in scala job

1264712cc7-+-Allow pull based rsync between stat & notebook boxes only

aac54c0e92-+-Add kafka reporting topic to Puppet config

65a610f595-+-site: Keep lvs2010 as a spare system while T203194 is not solved

17dc45eab2-+-toolforge: Add python3-venv to exec nodes

2f62b29e60-+-profile::analytics::systemd_timer: force syslog stop

2f98254da5-+-systemd::syslog: allow to add the 'stop' rule when needed

60f8d2cb09-+-make addschanges dumps quieter

479d6cfc1a-+-elasticsearch: allow cross cluster communication

85464d8a82-+-Add Google Translate MT config

3cb36a9466-+-profile::hue: allow password definition via hiera

d4c8634a81-+-profile::oozie::server: add jdbc parameter

c171d8b988-+-profile::hive::client: add jdbc parameters

c65ff09f6b-+-role::analytics_cluster::refinery: unused, deleting it.

67ea40403b-+-Revert "testreduce: use regular package{} instead of require_package"

c4ac41e648-+-testreduce: use regular package{} instead of require_package

4a5510079c-+-testreduce: break dependency cycle between apt::pin and require_package

e2b821241f-+-testreduce: if on stretch, use stretch-backports to get npm package

f08688d171-+-site.pp: consolidate cloudvirt entries

1822add5cb-+-Re-add blacklist for /sbin in thumbor profile

95018b3994-+-profile::mw::php::monitoring: make page check conditional

199374719f-+-jobrunner: add php monitoring

2f182ad6a0-+-prometheus::ops: convert role to profile

a7795aaad5-+-toolforge: Redirect GET & HEAD to https (take 2)

939d5a77d8-+-Revert "toolforge: Redirect GET & HEAD to https"

dfd25cb14e-+-toolforge: Redirect GET & HEAD to https

b42b64719d-+-delete systemd::sidekick

fe33f7beb3-+-cloudvps: add roles for new cloudvirts

95e34bdf87-+-Add test-commons.wikimedia.org to prod_sites.pp

d061774227-+-cloudvirt1029: introduce it to the openstack eqiad1 deployment

c104b14bb6-+-openstack: nova: mitaka: stretch: install python-dogpile.core from jessie

f1fe02e92f-+-openstack: linuxbridge_agent: typo in libosinfo package name

15ee555619-+-Enable base::service_auto_restart for uwsgi-certcentral

49797d8376-+-profile::mediawiki::jobrunner: convert to use class httpd

53a56039ad-+-role::analytics_cluster::hadoop::ui: update documentation

9f1e9d99ec-+-httpd/phabricator: revert using template for mpm config, adjust values for phab

15d6f9ef98-+-profile::phabricator::httpd: Update's worker config

774a4fb1bc-+-contint: remove unused classes

bfe70219ac-+-openstack: nova: mitaka/stretch: require packages before installing nova

ef4b72382f-+-profile::hadoop:master/standby: support a custom hosts.exclude file

bc5577070e-+-openstack: virt: introduce per-component per-openstack per-distro classes

3b7e1fe764-+-wmcs: Add a cli script for managing dynamicproxy entries

b3bf6146dd-+-Adjust params for Analytics data_purge EventLoggingSanitization job

54d6f1f910-+-apache basic auth: Use term "developer account"

fd86900e8d-+-toolforge: disable lighttpd service on webgrid nodes

4bfd3b0f0d-+-ferm rules for rsync from dumps peers to dumps primary nfs server

cc2a820353-+-permit rsync pulls from dumps primary nfs server to a peer

de644198ef-+-convert snapshot1005 to a regular dump runner

dd79f48ab4-+-convert snapshot/dumps python scripts in puppet to python3

3d615000ef-+-phabricator: Load mysqlnd extension before other PHP extensions

f9046fdb29-+-sonofgridengine: add submit host functions to web exec nodes

e833156691-+-Move labvirt1013 to cloudvirt1013

781f0979a0-+-openstack: nova: compute: the libvirt service in stretch depends on other pkgs

9e6caaed36-+-druid::middlemanager: fix argument documentation

0151dc0367-+-Fix grafana's dashboard links using the .json suffix

3ebc788596-+-profile::hadoop::backup::namenode: add kerberos wrapper

1d34959f67-+-Remove obsolete rsync::repo

33891a99c5-+-profile::hadoop::spark: use cdh::exec where needed

6f20dcc464-+-authdns-local-update: use check-deploy.py

2311574200-+-hadoop::httpd: fix typo in name of xml2enc module

ec66c6fc35-+-hadoop::ui: migrate from apache to httpd module

c1964f030b-+-doc: relocate from /srv to /srv/docroot

4583ea2ccc-+-cloudvps: swith cloudvirt1030 to openstack newton

04dccc7338-+-Make cloudvirt1025 a nova compute node

46b0842ca8-+-labstore: remove temp exfat setup

1f640a04c6-+-Revert "stat: add exfat for temporary narrow and approved workflow"

83b7636565-+-profile::hadoop::mysql_password: move to cdh::exec

483af871fc-+-openstack: add more stretch/mitaka support

ef195a80fb-+-site.pp: add role for cloudvirt1030

f0a3b45847-+-openstack: introduce basic support for running Mitaka on Stretch on virt nodes

f9450c7077-+-Adding registries VMs.

1d54201dbc-+-druid: reserve middlemanager ports from 8200 onward

61328f8558-+-doc: clone integration/docroot

8b4203bf37-+-git: git::clone requires the git package

2360075629-+-profile::grafana::production: datasources as YAML

763c558e49-+-doc: copy new httpd config for doc.wm.org to its own place

4400fcae34-+-logstash::collector: pin curator to components/spicerack on stretch

59a29b7d0c-+-profile::grafana: install sqlite3

8dc415b351-+-doc: add Apache config for doc.wikimedia.org

b39b9ff7cb-+-CXServer: Pass the IP address to the service's config

79f51244ef-+-stat: add exfat for temporary narrow and approved workflow

d7f8953cf0-+-ircecho: Convert script to python3

0207b15de9-+-Configure cxserver ratelimiter

5eec92c313-+-nodepool: cleanup database related settings

8ed2dfc8f5-+-doc: add rsyncd config to let contint servers push docs

273152c6f9-+-nova: add Cern's nova-quota-sync

ada659b0d6-+-Set xenon.period to 5 minutes to improve flamegraph resolution

d987329bcb-+-profile: enable statsd_exporter and add matching rules to logstash::collector

294af689aa-+-ci::httpd: add support for stretch/PHP 7.0

a174cf16eb-+-Remove specific settings from profile::hadoop::common and put into hiera

917d77a908-+-ci::master: convert from apache to httpd module

96f952592d-+-sonofgridengine: correct default file configuration

2fed426a75-+-wdqs: reduce hiera configs via profile defaults

220f780957-+-doc: ensure /srv/org/wikimedia/doc exists and has backup

328a7bf9fa-+-Add proxy info to toolkit analyzer cron job

917e866d89-+-sonofgridengine: removing commented manual db init

58c20497c5-+-Delete unused Analytics role (already moved to profile)

fa208e7d0f-+-Remove unused cron and logrotate config, replaced by systemd timer

1023c5f6c7-+-Enable Kerberos support for hdfs-balancer systemd timer

2af6b5655b-+-profile::spicerack: install python3-requests

c980530d93-+-role: include kafka_shipper on mediawiki hosts

a76bebbb09-+-role: add rsyslog::udp_localhost_compat to mediawiki hosts

c10ef576f4-+-profile::kafkatee::webrequest::ops: remove unused code

f5e61d243e-+-Set role(spare::system) for oxygen

9f827e4b20-+-profile::kafkatee::webrequest::ops: absent quickdatacopy

2eb525d45a-+-doc: remove single quotes around variable for package name

aec9ccc093-+-sonofgridengine: restore ssh knownhosts hack for tools

f20a18b49d-+-doc: fix Invalid relationship, rm notify for apt_update_php

a8641d3638-+-doc: dependency issue using require_package, fix path worker.conf

fcbd4e6fe7-+-doc: don't make APT repo dependent on package

cf19f70b82-+-doc: fix for dependencies between APT repo and httpd

c851954af2-+-doc: try to break dependency cycle for php-fpm7.2 package

3964cfa867-+-doc: ensure apt-get update is executed before package install

a1eb985367-+-add httpd for doc.wm.org, using php-fpm, php7.2

74786bb966-+-sonofgridengine: restrict the cluster from initializing itself

eccfad1072-+-create skeleton role for docs.wikimedia.org

a125c6fc9d-+-stat: add exfat for temporary narrow and approved workflow

0bc6f1d433-+-profile: enable statsd_exporter and add matching rules to ores::worker

f9289f5697-+-prometheus-node-exporter: Ignore Docker/Kubelet mount points

86d6a0b7e6-+-logstash: add lvs::realserver to codfw logstash collector nodes

1906d0579c-+-toolforge: webservicemonitor is now in cron nodes

ba5ef417fb-+-switch all invocations of scripts in dumps rep to use python3

503978fba5-+-ores: Allow cross origin requests if 'X-Wikimedia-Debug' header is sent

aeae1e87a4-+-toolforge: declare sonofgridengime::submit_host from a central point

422bad2d15-+-ci: Remove minikube from pipeline instances

f0a26fdd83-+-role::statistics::gpu: include standard

9a58017697-+-role::maps::{master,slave}: add tlsproxy

7f4fdb7969-+-profile::kafkatee::webrequest::ops: widen allowed data via rsync

141b69a4d8-+-logstash: add new logging kafka consumer

19f9585ce1-+-Temporary assigning role::logging::webrequest::ops to oxygen

e627fbb85d-+-profile::kafkatee::webrequest::ops: add quickdatacopy

5992ee18b3-+-profile::kafkatee::webrequest::ops: ensure archive directory

ab53fcf0b2-+-spicerack: configure APT component/spicerack

96c6fc461e-+-contint: remove references to nodepool

02ae690a17-+-decom einsteinium

a9fc38d26e-+-gerrit: Fix puppet types in jetty.pp

43913d24b3-+-Clean up remaining nodepool/labnodepool1001 refs

263b4385d6-+-gerrit: Make ipv6 optional again part 2

125d671427-+-gerrit: make ipv6 optional again

b085d1bd74-+-Bump refinery-job to 0.0.82 for refine.pp jobs

16c5d94834-+-enable lbzip2 for xml/sql dumps testing in labs

89fa72b63b-+-ATS: origin server certificate validation settings

62653bc37d-+-profile::hadoop::mysql_password: add more kerberos configs

012da8be27-+-swift: actually check https, not http

8dd8d1b315-+-profile::hadoop::master::standby: allow kerberos settings

73d078d70d-+-profile::hadoop::mysql_password: add kerberos support

3a8650a597-+-profile::hadoop::worker: Make kerberos configurable

ec3d6b56b8-+-cloudvps: make spreadcheck monitor region-aware

779d8acb9b-+-profile::hadoop/hive: introduce the use_kerberos flag

a2bb28dec1-+-Add kerberos puppet wrapper

a9f47f3533-+-Swap oxygen with weblog1001

21537d61ac-+-gerrit: use specific data types for IPv4 vs IPv6

e75e0f287b-+-gerrit: add data types for all parameters

166462ab8b-+-decom restbase200[1-6].codfw.wmnet

0222d30435-+-phabricator: use Stdlib::Fqdn data type for hostname parameters

a7265d3851-+-presto::server should set up worker only by default

8b56ffab6b-+-Puppet booleans work find rendering to string in presto properties file

0a2c44df4b-+-Fix coordiantor typo in profile::presto::server

91565bcb86-+-Fix missing $ in presto::server

561c595b5d-+-Make presto module and profile smarter

d55fc2795a-+-authdns: synchronized cookie master key

91bcbc2352-+-apt: add component/spicerack support

6125043de8-+-Add ::profile::presto::server to ca-master-2 to run Presto coordinator

649df70634-+-authdns: Remove temporary ensure => absent file entries

5d99ffb5bb-+-authdns: remove authdns-lint bits

68fd3bdf29-+-Revert "Revert "ores: Remove added celery configs""

0142644062-+-Add IPv6 mapped config to weblog1001

5d167a406c-+-profile::kafkatee::webrequest::ops: move hiera to parameters

519b4c4957-+-mx: Get rid of nginx [2/2]

cd40eff643-+-mx: Get rid of nginx [1/2]

2ed5280a27-+-osm::planet_sync: configure logrotate to use non-root user

588d4b0970-+-site: spare::system for restbase200[1-6]

7926016b80-+-mx: Get rid of the old LE puppetization

bbb2a3fc34-+-mx: Deploy certcentral managed TLS certificate

4109f88cec-+-certcentral: Allow puppet_svc to be undef

84e860a0f1-+-new sessionstore100[1-3].eqiad.wmnet puppet updates

6b14fc44c0-+-Fix service ensure in presto::server

901303326a-+-Fix typo in presto::server

dfba7dd188-+-Use fqdn instead of hostname in nodes id

8289a4034e-+-Presto Puppetization

a82c315704-+-assign codfw logging VMs logstash role

3735eac906-+-logstash: set kafka consumer group id in codfw

1f160f220e-+-adding sulfur.wikimedia.org items

13ee4ce109-+-prometheus: fix openstack-exporter cache dir permission

34c5b78647-+-Neutron: allow VMs to access the neutron API

dd547a7614-+-network::constants: add codfw logstash kafka brokers

bbd15eee38-+-add ip6 mapped interfaces to logstash codfw metal hosts

15242449e8-+-memcached: remove diamond::collector resource

c21a4a67c9-+-add icinga_jobs definition

96987e6469-+-Don't try to grant access to hive metastore db from % in labs

13f11b624f-+-profile::hadoop::master::*: move prometheus requires

fae4f09c6b-+-assign codfw logstash hardware elasticsearch and kafka roles

47295b1854-+-kvm monitoring: raise the maximum number of processes

18e59bbae3-+-profile::oozie::server: reduce oozie log retention to 7 days

db6e288f50-+-Use datadir in labs mysql_install_db creates => in analytics meta database

6fb5ace564-+-Set more sane mysql tmp dir in cloud-analytics meta database

e0cf9df5e8-+-mx: remove sslcert::certificate for mail.wikimedia.org

6cdfa9a960-+-mx: get rid of the old mail.wikimedia.org certificate

ab95a92a81-+-Add cloud_analytics roles

749543c6f8-+-grafana5: 'provision' dashboards from puppet

1729d6fa8d-+-mirrors: Get rid of the old LE puppetization

6926424bff-+-mirrors: Deploy certcentral TLS managed certificate

9a555b797a-+-Remove pointless ns[012] IPv6 in ns_addrs

0da36a3f73-+-lists: Get rid of the old LE puppetization

ec3f03f73d-+-Apply role::statistics::gpu to stat1005

3860dae616-+-restbase: remove production_ng remnants

baf2a4e940-+-Move remaining stat1005 references to stat1007

9abde88e24-+-toolforge: Remove BigBrother puppet code

7d65a94357-+-toolforge: Absent BigBrother

3311fa26e9-+-authdns config/CI refactor [5/5]

c0fcddad6a-+-authdns config/CI refactor [3/5]

92dae701c2-+-authdns config/CI refactor [1/5]

07ef462f12-+-upgrade puppet stdlib from 4.24.0 to 4.25.1

6edd07c7a9-+-rsyslog: add UDP localhost compatibility endpoint

35a03395dd-+-httpd::mpm: Also remove mod_php for 7.0 and 7.2 if not prefork

be6d1387aa-+-shiny_server: change gfortran/g++ dep

9f27e33602-+-mariadb: Install db11[26-38] new DB hosts

a30020e1a8-+-memcached: remove memcached diamond collector

b1c27a2397-+-role, profile: install, run, and collect icinga exporter metrics

32dd16e652-+-decommission bast4001

ef17e5218a-+-Add reports deployment to netbox profile

6dc56e0728-+-Undo last change and temporarily disable JMX prometheus in cloud-analytics

2afb7b6ec6-+-Attempt to get around prometheus jmx exporter race condition on new cluster

67c4517724-+-Allow configuration of $hadoop_var_directory in profile::hadoop::commmon

58c91baae0-+-Make dumps dir tagged as in-wdqs-data-dir

830b5c2c2c-+-wmcs: add prometheus-memcached-exporter

7a6ab1ae21-+-remove diamond::collector reference from role::labs::nfs::secondary

4a5a8620c8-+-profile::mediawiki::php: install excimer on newer versions of php

eeb4995a3c-+-profile::mediawiki::php: install php-tideways, php-mongodb

80dc0825c1-+-labs puppetmaster: Remove old promethium baremetal stuff

3f598075de-+-Remove all remaining wdq_mm references

819ce2bf00-+-syslog::centralserver: notify mtail when programs change

5f58428c12-+-profile::cache::kafka::alerts: set more sensitive thresholds

8441daa10c-+-remove directorysize diamond collector

6d3ef10a62-+-Openstack: monitor nova and kvm on cloudvirt hosts

3aac9e3815-+-prometheus: fix/adjust directory size collector

dafe5e959d-+-prometheus: add directory size collector

b9e7aaff0c-+-ATS: Collapsed Forwarding support

7c1f827ee9-+-profile::statistics::private: allow labstore to push nginx logs

a7648c53d4-+-nagios_common: remove commented section about contacts test file

18b4d4c7c1-+-decom elastic2001-2024

bfa902d446-+-Revert "logstash: ship kafka server logs to ELK"

5f000835a8-+-logstash: ship kafka server logs to ELK

45e2efdbc1-+-phabricator: Use hiera value for phabricator_enable_php_fpm

5f5e4b933d-+-elasticsearch: force deletion of unmanaged resources in /etc/elasticsearch

0c06e438fe-+-phabricator: Increase 'max_execution_time' to 30

869a0f0249-+-elasticsearch: Remove elastic2001-elastic2024 from codfw cluster

a3a051c390-+-elasticsearch: purge main elasticsearch configuration directory

5361c86803-+-upgrade puppet stdlib from 4.22.0 to 4.24.0

f743178abd-+-Install Imagemagick policy files for Thumbor

9d80046fd6-+-elasticsearch: ignore output of hot thread cron

c44e84cbe7-+-profile::hadoop::worker: move prometheus require before cdh class

e3f157c04b-+-profile::hadoop::common: explicitly contain class cdh::hadoop

fb78ccd076-+-ATS: define one single global Lua script

82ff43c7bb-+-profile::cdh::apt: add custom exec for apt-get update

61f698b082-+-extdist: Switch to Python 3

83ca950d0a-+-ATS: define global Lua scripts in plugin.config

19284a3226-+-profile::hadoop::common: add ordering for apt-get update

223edc8c33-+-profile::hadoop::common: remove explicit dep ordering

70d7d307c1-+-profile::hadoop::spark2: fix dependency on exec

724fb59456-+-profile::hadoop::spark2: explicitly require hadoop-yarn-nodemanager

829cdb06e6-+-profile::analytics::refinery::job::sqoop_mediawiki: remove crons

403bf26cff-+-sonofgridengine: make the shadow master override read only

54002df238-+-sonofgridengine: create the dir for the override conf

b414b5fab8-+-sonofgridengine: try setting config variables to tune the shadow master

169dd8029a-+-install_server: add codfw logstash hosts and assign spare role

04914c747d-+-phabricator: Add back debian version check to init.pp

84c3af927d-+-phabricator: Add support for php-fpm in stretch

c6a481ba2a-+-sonofgridengine: remove the rc links for the old sysV init as well

58c02591d3-+-Make cloudvirtan100x boxes eqiad1 labvirts

c4a093326e-+-phragile: add stretch/PHP7 support

f6730e0d22-+-contint: rephrase comment for castor rsync server

4446e68a94-+-Assign analytics_cluster::hadoop::worker to an-worker*

ed7c616102-+-elasticsearch: add new elastic2045-elastic2054

246273d3ca-+-druid: remove absented crons

3525578bf6-+-sonofgridengine: explicit dependency for shadow_masters file

12bdb6c9c3-+-phabricator: add data types to all parameters

e79af03d76-+-Fix race condition in ::grafana puppet module

59c3d9262f-+-Add role::grafana and switch grafana1001.eqiad to it

f04f677f11-+-sonofgridengine: remove weird accounting link

9e6242914d-+-toolforge: grid: introduce systemd service file for sge_qmaster

b1079b40c2-+-Re-enable revision-score refinement (again)

91e6c7b504-+-wikistats: fix xml dump cron jobs by specifying defaults-extra-file

7889231f1d-+-druid: absent some crons to purge logs

f691184979-+-toolforge: grid: base: extract variables into hiera keys

121050f1ff-+-Enable SPARQL logging to a separate file

f1925a09ac-+-spicerack: add dateutil dependency

228bfbb228-+-On wikimedia-stretch, add repository thirdparty/grafana

e4c85ddd08-+-prometheus::php_fpm_exporter: run as www-data

cafb03a9f1-+-mediawiki: allow proxying to php-fpm via a unix socket

6b43f36d76-+-toolforge: homogenize system::role calls

86763a3af5-+-turnilo: fix dependency cycle removing require_package

dc1e9c7b72-+-turnilo: add nodejs 10 stretch apt component

3f45f30075-+-elasticsearch: create base data dir

65ee9469ea-+-mediawiki::web::vhost: remove serve_php7 feature flag

5c49ec424f-+-profile::mediawiki::php: add auto_prepend_file to fcgi

28a073f074-+-sonofgridengine: stop the gridengine-master service on shadow nodes

ecac5c2176-+-sonofgridengine: remove yet another bad dependency

693d32b03b-+-sonofgridengine: file_line corrections

a0e5a9cf07-+-sonofgridengine: remove pointless dependency

650348d5d7-+-sonofgridengine: build a correct shadow_masters file

77c9394172-+-kibana: convert from apache to httpd module

b96d5a4c3a-+-remove pc200[456] from site.pp

ba3033f57c-+-setting cloudvirtan install params

a24584796f-+-Remove labstore::monitoring::nfsd

95b067a525-+-ores: Accept json for result serializer

8a62aa7159-+-Add DHCP and autoinstall options for grafana1001

6bc22d3eaa-+-elasticsearch: add new elastic2037-elastic2044

543c05837a-+-site: add new restbase codfw hardware

8728aa2b75-+-site: use spare::system for old graphite hosts

fcf57d0db3-+-elasticsearch: add entries in site.pp for new elasticsearch nodes

8900affaca-+-Remove the mathoid profile

b4277441aa-+-cxserver: Added update Youdao config

ecbe04082b-+-Remove Redis collector

384137f35c-+-ATS: MediaWiki and RestBASE request mangling

67df5c1079-+-osm::planet_sync: change osm log dir permission

f878d49b88-+-mediawiki: configure php-fpm logging

3e661b232a-+-Absent Redis Diamond collector on mc* servers

2c2c858498-+-profile::mediawiki::php: fix typo

359f93aa15-+-superset: convert from apache to httpd module

f761abb4d9-+-profile::mediawiki::php: fix reference to max children

6f4d91cc41-+-Correct escape chars of EL sanitization in analytics data_purge.pp

65f4daebf0-+-profile::mediawiki::php: fix function call

f88648d706-+-profile::mediawiki::php: armonize settings with HHVM

41dc74c628-+-profile::mediawiki::php: tune php-fpm parameters

9c29986426-+-profile::mediawiki::php: add opcache tuning for php-fpm

05c0e828cb-+-mariadb: Decommission pc1004,pc1005 and pc1006

af03e51101-+-Rename labvirt1014 to cloudvirt1014

734bab8ba8-+-openstack: Fix unsafe keystone token cleanup SQL query

58fbd4e016-+-sonofgridengine: found where the unconfigurable pid file is

056008ce08-+-phabricator: monitoring to profile, merge mpm with httpd profile

6c115fc387-+-sonofgridengine: correct shadow and master init issues

54b3dce7d2-+-phabricator: move httpd setup to a profile

7e4464d702-+-Switch rsync::quickdatacopy to auto_ferm

68716bfb5f-+-logstash: ship etherpad logs to ELK

27c4075d39-+-sonofgridengine: remove useless comment and fix the shadow profile

6df7599808-+-logstash: ship logstash server logs to ELK

d6124e068b-+-sonofgridengine: set up shadow_master profile

8cced1431b-+-certcentral: Fix /etc/centralcerts permissions

d156a27908-+-grafana: ship grafana-server syslogs to ELK

037651fcb9-+-lists: Fix the group name in certcentral::cert

a61dd6aff7-+-lists: Deploy the certcentral managed TLS certificate

52f1804577-+-cassandra: create hints directory

e75e6eb219-+-logstash: update gerrit multiline message start regex

fd2b06e232-+-profile::druid::turnilo: remove mod_proxy_html (not needed)

82ba214ec2-+-openstack: make ::dmz_cidr an array

9c5943528c-+-profile::hadoop::firewall::master: add parameter for https ports

68f11aa170-+-restbase: add restbase2013

dc42b0f2fb-+-turnilo: migrate from apache to httpd module

650282d4e6-+-ATS: XDebug plugin support

b8d0a9764c-+-rsyslog: input::file add multiline handling & ship gerrit logs to ELK

80d5fe825b-+-swift: Fix checks on drive/filesystem titles to allow for labs ones

fd223f5699-+-remove rutherfordium from site, netboot, DHCP

26c50c3f11-+-gerrit: Switch between old LE puppetization and certcentral using hiera

63e62df559-+-Revert "peopleweb: allow rsync of /home from rutherfordium to people1001"

32360d225c-+-remove peopleweb role from rutherfordium

1665bcd490-+-Blacklist mediawiki_revision_score from refine again until we fix problem

8b05293d1b-+-Use refinery-job 0.0.81 for refine jobs

0a94dfc930-+-Icinga, assign check_vcp to all VC switches

22b3c15bac-+-Absent NfsdCollector Diamond collector

d0152fb865-+-Icinga: add check_vcp (part 1)

05d1bb2551-+-Revert "Netbox, set the napalm_username variable and matching keyholder"

cf66d717bc-+-Revert "rsyslog: input::file add multiline handling & ship gerrit logs to ELK"

767308326b-+-rsyslog::input::file fix startmsg_regex data type

1dbc8bbc1a-+-rsyslog: input::file add multiline handling & ship gerrit logs to ELK

db4eced6cd-+-removing references to decom servers labvirt101[01]

490f3baefc-+-certcentral: Mimick letsencrypt::cert::integrated key_group

8485b02267-+-Move labvirt1010/1011 to role::spare

a6a7b3c98f-+-profile::maps::osm_master: change osmupdater and osmimporter auth method to peer

9c3faa9e17-+-profile::hive::client: move beeline's erb from role to profile ns

c37629cb48-+-openstack: Move Keystone DB credentials to my.cnf file

0b0c6a3fdf-+-analytics_cluster::webserver: apache -> httpd module

3b76e70a4d-+-Revert "ores: Remove added celery configs"

11463cc768-+-Remove Diamond from redis::misc systems

12f02a6b99-+-gerrit: Use the certcentral managed TLS certificate

6cd6aaeabe-+-peopleweb: allow deployment server to connect to port 80

31a64bfd96-+-logstash: ship prometheus logs to ELK

823928cfb7-+-shinken: Don't try to exec shinkengen until shinken is installed

5c01b1da20-+-gerrit: Avoid certcentral::cert interfering with labs instances

0071ea05e0-+-wikistats: remove jessie/php5 support

31a2318cb5-+-openstack: eqiad1: activate keystone extra services

d66aa68407-+-gerrit: Deploy the certcentral managed TLS certificate

bd1e88276a-+-ci: stop monitoring zmq on Jenkins

8678494f57-+-dumps: Get rid of the old LE puppetization

af6f442284-+-dumps: Deploy the certcentral managed TLS certificate

49d266f51d-+-Remove sarin/neodymium from network constants/tcpircbot config

8dd684b3b1-+-ores: labs celery4 config update

5d1fdb886b-+-openstack: main: keystone: cleanup unused parameters

5a04f3d880-+-ores: Remove added celery configs

1d662b5669-+-upgrade puppet stdlib from 4.19.0 to 4.22.0

fcd0f155a3-+-certcentral: Ensure that the service gets reloaded instead of restarted

d83ccdff25-+-Add mapped IPv6 to labmon1001

f275ec5078-+-icinga: Get rid of old LE puppetization

fda42bca43-+-Absent Redis Diamond collector on Redis masters

91a3419708-+-icinga: Deploy the certcentral managed TLS certificate

edb78da0d7-+-certcentral: check for already declared LE Intermediate certs

5f2def3be9-+-Absent Redis Diamond collector on Redis slaves

65794c48b7-+-netmon: sslcert::dhparam needs to be included especifically now

408ee6b593-+-archiva: sslcert::dhparam needs to be included especifically now

2410750c8c-+-tendril: sslcert::dhparam needs to be included especifically now

dcb9de6d39-+-icinga: on passive host, display a warning in the motd

287190a122-+-icinga: if on passive host, replace icinga-downtime script with warning

de5ba19265-+-Scap: upgrade to 3.8.10-1

a5e914e33e-+-Add analytics to EventBus grafana alerts contact group.

14d933d85c-+-cloud vps: google-api-proxy: Update allowed CIDR ranges

0d0757f983-+-Add analytics reportupdater job for language cx

b6648b2781-+-toolforge: add qpdf, unpaper, and pngquant to exec nodes

df5c1258b9-+-Scap: upgrade to 3.8.9-1

c49c1c5dd0-+-eventlogging/logstash: Events are encoded as JSON

a0e4290c59-+-openstack: clientpackages: introduce support for mitaka/stretch

f98d312c4c-+-Use proper Kafka cluster for sending EventLogging errors to logstash

e40b139f78-+-profile::hive::client: fix typo and update cdh module

fa692dd9d6-+-install_server: Remove old LE puppetization

d93a946416-+-certcentral: Handle common requirements for certcentral clients

c16fe44fc7-+-profile::hue: add support for Kerberos

bdf796a3d5-+-toolforge: bastion: split slice config for root/users

29d7fca117-+-Remove IRCDStats collector

8fa9379389-+-profile::hive::client: fix typo in parameter

21ad5bda80-+-toolforge: introduce bastion systemd-based resource control

7a8f939d14-+-openstack: serverpackages: fix path to ubuntu cloud repo key

338a88f8dd-+-openstack: relax dependency on virtual-mysql-client

e87f8d269d-+-openstack: rearrange repos, packages and pinnings

237cde7c57-+-mariadb: Provision pc1007-pc1010

ef67470043-+-service::uwsgi: Stop using --autoload in uwsgi

367e384cc7-+-installserver: Deploy certcentral managed TLS certificate

dd069da606-+-decom einsteinium remove from netboot and DHCP

a198f75ad5-+-icinga: remove jessie support

133ad82d3a-+-icinga: stop having separate configs for jessie/stretch

b295981b5f-+-icinga::web: do not use PHP anymore

d6fe4ceaee-+-mw_rc_irc: ensure diamond::collector absent

d313ea7feb-+-Make labnodepool1001.eqiad.wmnet a spare system

ba0efe4a10-+-puppetdb: ship puppetdb logs to ELK

aedd72d86b-+-icinga/NSCA (passive checks): remove jessie support hacks

c8214a26f9-+-dbstore100[345].eqiad.wmnet base isntall params

6cae54d096-+-profile::icinga: stop using mysql module, rm jessie support

a1170406ad-+-pc1009-pc1010 install params

6bfae02aaa-+-rsyslog: ship logs with tag 'icinga' to ELK

1eb8ac1bfe-+-icinga: remove einsteinium as an alerting_host

54e4e33e26-+-prometheus: gather metrics for php, php-fpm

0e2a232580-+-certcentral: Notified puppet_svc on certificate file changes

913acebe73-+-Refine revision-score after schema improvements

fcf210d97a-+-Add mapped IPv6 to labmon1002

2401ff8e59-+-archiva: Remove old LE puppetization

5ac0a95972-+-archiva: Use certcentral managed TLS certificate

a109f6d1cd-+-archiva: Deploy certcentral managed TLS certificate

98d0f91a2f-+-wikimetrics::web: Stop using --autoload in uwsgi

03a7d740ad-+-quarry::web: Stop using --autoload in uwsgi

b73bf822ac-+-ifttt: Stop using --autoload in uwsgi

73e0b85462-+-graphite::web: Stop using --autoload in uwsgi

a1edf6dbc8-+-dynamicproxy: Stop using --autoload in uwsgi

99fcd73230-+-mediawiki::appserver: add php monitoring

c9cd4cc6cf-+-wikilabels::web: Stop using --autoload in uwsgi

c19a6b50c2-+-encapi: Remove redundant uwsgi::app parameter

182e797d83-+-coal: Remove redundant uwsgi::app parameter

2cabe342ce-+-cxserver: Disable Youdao MT until service is back

ec92c4946d-+-ATS: path normalization

148125fdd5-+-profile::hadoop::spark2: rename parameter to be more generic

caace07890-+-Fix alarm's dashboard links in hadoop profiles

c73c94fba6-+-profile::hadoop::master: raise RM heap alarms and fix dashboard links

fd09aa7980-+-upgrade puppet stdlib from 4.16.0 to 4.19.0

d2293476b9-+-Add grants for keystone and neutron db users

93da661c0a-+-Remove old globalsign unified certs from config

9765450d8e-+-tendril: get rid of the old LE puppetization

ac9a6a4416-+-tendril: Deploy certcentral managed TLS certificate

12fe19567b-+-profile::hadoop::spark2: get security settings via hiera

3e6cb62cfe-+-netbox: notify the uwsgi app on config change

0ea009ce93-+-wdqs: fix ensure on cron to run tests

748d9200a2-+-wdqs: run test queries periodically on wdqs test servers

6d385899fb-+-swift: cleanup stale scope sessions

9004e5c278-+-toil: cleanup failed systemd scope units

d5a22f0621-+-maps: added use_proxy flag to set proxy

34c8ac9273-+-profile::analytics::refinery::job::data_purge: add new parameters

e0f84989ee-+-netbox: Get rid of the old LE puppetization

6960046d58-+-wdqs: options should all be passed as arrays

bed4497bdd-+-upgrade puppet stdlib from 4.15.0 to 4.16.0

3773dbf06c-+-Enable dumping RDF data for debugging purposes

f8165b0dce-+-netbox: Deploy the TLS certificate managed by certcentral

134aff8e08-+-Add RefineMonitor to EventLoggingSanitization analytics refinery job

aebf1742ca-+-ATS: pass fifo filename to check_trafficserver_log_fifo

bf4ae50d03-+-phabricator: ship apache error logs to ELK

db2baf088c-+-logstash: rename 'severity' syslog field if present

d01b2aa962-+-ATS: add check_trafficserver_log_fifo

eb5e5f344b-+-ATS: add profile::trafficserver::nrpe_monitor_script

0f0ece4552-+-certcentral: Provide bare minimum icinga checks

b3c8d9404b-+-peopleweb: add mapped IPv6 to people1001

d0f9d7e5e8-+-peopleweb: allow rsync of /home from rutherfordium to people1001

4a3a496df4-+-peopleweb: set httpd MPM to prefork explicitly

7e0a56bb2c-+-peopleweb: add role to people1001

3a8c910b5d-+-peopleweb: add stretch/PHP7 support

b0b1903c5c-+-logsteralarms: better alerting logic

b72d41f643-+-sonofgridengine: correct hba manifest for this grid variant

fb7493e349-+-sonofgridengine: This may be all that is needed for now on bastions

57ece2e380-+-sonofgridengine: cronrunners need hba

a57f29288f-+-profile::hadoop::common: fix mapred_site_extra_properties variable

1aeb142afd-+-profile::analytics::refinery::job::data_purge: add purge for EL

956ac16354-+-mediawiki: add prometheus exporter for php-fpm

af4a38a5c5-+-jenkins: ship syslogs tagged 'jenkins' to ELK

21c2977de9-+-Followup fix for ores: Change configs to celery4

58b3ed2876-+-ores: Change configs to celery4 ones

bba75dfffd-+-kubernetes: Move runtime-config to hiera

5a76b78b56-+-profile::analytics::refinery::job:data_purge: remove unused items

f8df5dfc12-+-racktables: fix path to php.ini on stretch

10b200a2b2-+-webserver_misc_apps: require libapache2-mod-php7.0 on stretch

5c8db951c2-+-racktables: add stretch/php7 support

cfc80c5ae1-+-iegreview: add stretch/php7 support

2280006900-+-peopleweb: ingest apache error logs with rsyslog for shipping

f9a96304db-+-logstash: add type "apache2-error" and use logstash core patterns

0e4a92ae80-+-openstack client: Install python3 stuff on stretch

f3df8977a8-+-Set spare role for cloustore1008/1009

3b69224085-+-Revert "maps: added use_proxy flag to set proxy"

fe86b6bc60-+-Revert "profile::maps::osm_master: change osmupdater and osmimporter auth method to peer"

ba714ac781-+-rsyslog::input::file add rsyslog imfile wrapper for file ingestion

87fc58f4d7-+-Remove absented Diamond collector for NTP

aec9372215-+-librenms: Remove old letsencrypt puppetisation cert

df35bd2ed0-+-elasticsearch: only configured filtered instances on elastic nodes

805ec5de19-+-librenms: Use certcentral cert

65b0c764f4-+-Allow extra security parameters for hadoop/oozie/hive profiles

7be8b34862-+-Also drop the dashboard definition for server-board

ebf559f9be-+-Bird anycast DNS, add BFD multihop support

e57cc8bcba-+-profile::maps::osm_master: change osmupdater and osmimporter auth method to peer

7a277f67b5-+-ATS: avoid verify_config for now

ca15f823c4-+-Revert "Set default elasticsearch cluster name"

103892e089-+-toolforge: Use profile::openstack::main::clientlib in clush::master

c1a9f66e72-+-toolforge: Move ::clush::target to base.pp

64faaadf79-+-toolforge: Refactor clush

0d2e717c74-+-prometheus: update tools k8s config

205fed1925-+-mariadb: Get ready to decom pc2004,pc2005,pc2006

997727a65a-+-Remove Diamond from openldap/corp servers

aadf296b2d-+-Absent unused Diamond collector for ldap/corp

b360de1e46-+-LibreNMS IRC bot identify to Nickserv

6845f2d6cb-+-Set default elasticsearch cluster name

84ccc5582c-+-sonofgridengine: observer env and the openstack client libs for SGE master

522f633b5e-+-icinga: Re-add reload functionality

196c623487-+-librenms: Deploy the TLS certificate managed by certcentral

40663f46ae-+-Include ms-be[12]05[0-9] hosts in disk/role configuration

10b2e2a3c7-+-certcentral: Deliver same certs (with same naming) as LE puppetization

ff8749ee80-+-ores::redis: Set maxmemory-policy: volatile-lur

e1b2c2ca37-+-site: add ms-be205* hosts

2718d645fc-+-ATS: quote traffic_server check_procs arguments

322a49bd83-+-ATS: more specific traffic_server check definition

764eefcca5-+-elasticsearch: allow filtering instances to be deployed

6b2740feb2-+-ATS: add check_trafficserver_verify_config

7277cd0090-+-ores: Move all of celery configs to puppet

60f66c37b7-+-profile: introduce jmx_exporter_port to logstash::collector

30aa1e2525-+-Install gpg 1 on app servers for SecurePoll extension

cacee1209b-+-toolforge: purge jmail script

d27dfbb78b-+-Disable admin cron on maps1004

b4edec25cc-+-maps: added use_proxy flag to set proxy

a9a9b806d5-+-icinga: do not manage retention.dat in puppet

23098f629b-+-package_builder: Switch to class declaration syntax

8d24e44c37-+-nodepool: labtestservices2003 is not used for testing

0657f8c594-+-ntp: ensure absent ntpd diamond collector

e15a951522-+-icinga: manage permissions for replicated files

c33fc0b7b2-+-Phabricator: Make manifest user and pass configurable through Hiera

fb5443a83c-+-AlarmCounterLogster: add ability to check ip in range

3cee306689-+-diamond: remove diamond::collector::nginx

a1e4329c13-+-mariadb: Reimage db1118 as mariadb

b9bddaf2b7-+-url-downloader: Add kube pods in allowed ips

c898a4c717-+-ci: use statsite for localhost statsd aggregation

36110f1ec3-+-statsite: move from role to profile

c5441a67bf-+-ores: Drop old b/c configs

1bf1a2d22d-+-prometheus: ignore all rsyslog actions with default names

a5b3e0eece-+-Share keytabs directory for multiple services

b2945fb1cd-+-certcentral: update live_certs path

639a13bde6-+-profile::logstash::collector: set kafka shipper input codec to json

fde7c19cf2-+-logstash::input::kafka: add codec param

a232210846-+-peopleweb: include rsyslog kafka_shipper

22936164bb-+-mediawiki_maintenance: reverse rsync direction of /home

511603ba46-+-sonofgridengine: add cronrunner role for stretch grid

09f456bc07-+-sonofgridengine: unbreak the bastion profile

828845f3ff-+-logstash: set rsyslog-shipper input type to syslog

5aebe231f5-+-sonofgridengine: remove dependency on storage part

ddc30060c1-+-sonofgridengine: remove storage mentions from docker config for bastion

8e324a90ba-+-Gerrit: add basic robots.txt for proxy

f65ff50e9e-+-rename labvirt1015 to cloudvirt1015

b805a2ddb9-+-icinga: ensure 0644 on /var/log/icinga/icinga.log to fix webui

d3ac023a87-+-sonofgridengine: reworking bastion for stretch and docker

16e29d2ba9-+-swift: lookup statsd host/port from hiera for stats_container

910265fe43-+-site.pp: Adjust regex for parsercache

52c3b81fd9-+-logstash: remove obsolete daily restart cron

dcc2ba4e32-+-ATS: add atslog

c1d0f6cd3a-+-trafficserver: configure fifo-log-demux

7b1fbf4cce-+-Add module to install and configure fifo-log-demux

746a3489f7-+-sonofgridengine: Try directly setting a docker install

943bf45fd6-+-sonofgridengine: fighting through the dependency quirks

78cf35f8f1-+-Gerrit: JavaMelody library dependency symlink

2a758a0164-+-logstash: add rsyslog-shipper kafka input config

6c53f5e698-+-rename tegmen to icinga2001 in puppet, DHCP, and use stretch

3ef07f438c-+-Revert "logstash: add rsyslog-shipper kafka input config"

4631582255-+-logstash: add rsyslog-shipper kafka input config

c5ca2c6a7b-+-sonofgridengine: stretch bastions want libboost-dev

86a23721fa-+-logstash::input::kafka: add topics_pattern support

8f3736a352-+-logstash::input::kafka add support for SSL/TLS options

4f74e7faea-+-wikistats (vps): use mariadb classes, fix old FIXME

12d0597509-+-hiera: diamond::remove on openstack control role

7ebcdab506-+-install_server: reimage rdb2001, rdb2002 to stretch

85c39e71f5-+-php::fpm: require the package for pool.d too

4e2d89fb5c-+-cloudvps: reimage+rename labvirt1016 as cloudvirt1016

80b53e0ccb-+-php::fpm: explicitly depend on the php-fpm package

5eebb4970c-+-jobqueue_redis: Purge role jobqueue_redis

072ed29ef3-+-Increase tilerator num_workers maps1004

8b31bb55c3-+-mediawiki::web::vhost: remove the set_handler feature flag

a959b89729-+-certcentral: Run certcentral-certs-sync with user cercentral

12c34384fb-+-Revert "logstash: temp stop managing indices"

625ff7cd6c-+-certcentral: Fix ferm ssh-rsync ensure data type

8b71d64307-+-certcentral: Fix cron ensure data type

309f200bdb-+-certcentral: switch to active/passive

7616253ae5-+-Add an-worker1078-95 basic settings

eceddc6820-+-sonofgridengine: bring k8s bastion role information into bastion profile

c25eaa610e-+-shinken: Update IP after migration to eqiad1

41c2c736bc-+-Refine needs Hive 1.1.0 jars from CDH 5.10.0 to work around jar version conflict

7c24bf9409-+-lvs: configure lvs2010 interfaces

bbde1b1277-+-ATS: logging.yaml support

a4c73eb922-+-mariadb: parsercache different basedirs

faa4d4166d-+-Proton: Enable cancellable promises

e38fc0f5aa-+-toolforge: Fix mail relay certificate (mail_domain->external_hostname)

7675d20ca2-+-toolforge: Change active mail relay to tools-mail-02

5709fdca23-+-toolforge: Add default external hostname for mail relay

1597bbb83f-+-toolforge: Add TLS support to mailrelay

393c28cf21-+-Revert "role: aptly: refactor"

be8d4a8127-+-profile::mediawiki::php: allow picking a php version

ec5c50e62a-+-aptly: client: include default servername

f898011a5d-+-toollabs: servives: publish stretch-toolsbeta repo also in the old code

af06bc5193-+-toolforge: aptly: create stretch-toolsbeta repo

bf95b249ca-+-role: aptly: refactor

1abfdcc57c-+-mediawiki::php: install extensions with versioned package names

214f4b27a0-+-toolforge: Only add motd if in tools/toolsbeta projects

d4b1a14d56-+-graphite: remove old graphite hardware from receiving metrics

85003bdf06-+-Revert "Revert "toolforge: refactor mail server""

bd6fbb1035-+-wdqs::gui: extract crontasks into a new crontasks.pp

a21714a86c-+-Move import_wikitext_dumps to stat1007

127bc31f79-+-Revert "toolforge: refactor mail server"

8f91392c70-+-profile::an::refinery::job::import_wikitech:dumps: fix timer's script

8c0bf72726-+-toolforge: refactor mail server

8a1c8cd6f0-+-Add rsync module on thorium for stats.wikimedia.org

62659ad063-+-Add reportupdater job for language team metric

d41b75dc6d-+-Add timer importing page-history dumps to hadoop

0b3bed08b5-+-mariadb: add pc2008, pc2009, pc2010 parsercaches

1238c75438-+-mariadb: refactoring parsercache role to module & add pc2007

adeba3220a-+-thumbor: relay statsd_exporter metrics to localhost

b16331db7c-+-swift: add statsd_port parameter

fafc31518f-+-ATS: set X-MediaWiki-Original for upload.w.o

b9d7adab55-+-ATS: add trafficserver::lua_infra

3a9320c195-+-ATS: allow specifying remap-rule-specific Lua scripts

72a4d66dc3-+-profile::prometheus::mcrouter_exporter: alway set listen address

2f5a7736af-+-site: fix role() indentation

a162ec9a53-+-swift: disable free inode btree at mkfs time

54a64cd51d-+-profile::prometheus::alerts: avoid false positives for Druid

a046c2a20e-+-sonofgridengine: fix name conflict for checkpoint

e0ae2ce31b-+-role::labs::instance: Remove $::virtual == 'kvm' check for promethium

c29110e10a-+-sonofgridengine: Add checkpoints

c2a4b8c419-+-Reimage rdb2003/rdb2004, switch rdb100[123478] to spare::system

51718e7f5d-+-AlarmCounterLogster: move matching to regex and yaml config

94928855a9-+-profile::base: allow nodes to page when down

ed59ebe88d-+-wdqs: separation of concerns

a2d1a59587-+-cache: add cp2018 and cp2025 to cache::upload

d21e2586c1-+-Deploy inactive globalsign 2018 unified certs

dd6d7e4f84-+-network::constants labs: move deployment-prep instances out into hiera data

a7230bf598-+-icinga: add tmpfs options to stretch

dd71938c1c-+-ntp: move diamond::collector to where it will only apply to ntp servers

cbc364a277-+-icinga: fix path to retention.dat file on stretch

0b13982f18-+-statsd_proxy: add socket_receive_bufsize parameter

67bdfc6dee-+-Reimage rdb2005/rdb2006

ece8eca00d-+-elasticsearch: hotthread logger sends output to log_file

65b2178089-+-elasticsearch: hotthread logger needs python3-yaml

ac5137bdec-+-Change rdb1005 and rdb1006 to redis::misc master/slave

49d87fe856-+-tools - Remove temporary /var/mail fix

4733326b66-+-network::constants labs: add missing redundant project-proxy host

cfe4d7bcd1-+-prometheus: add rsyslog_exporter jobs

2d48c3cf7d-+-Use auto_ferm for nfs::misc rsyncd modules

1da0e0020a-+-mediawiki: Remove obsolete Firejail profile

96007f492d-+-cache: add cp2006 and cp2012 to cache::text

cef65b7f1b-+-package_builder: fixup for Ia71dc8c9

fef18bb023-+-package_builder: add ability to add the php72 component on stretch

111ac6070e-+-sonofgridengine: Make comment more explicit in dev_environ

e0a54f4f99-+-sonofgridengine: remove cruft comment

2afaff8cef-+-sonofgridengine: adapt more code for bastions on stretch

d2fbbf90c0-+-sonofgridengine: correct some issues for stretch bastions

4f2882e5de-+-Change rdb1005 to spare:system

c19b8399be-+-diamond: ensure Nginx collector absent

114e282cc8-+-sonofgridengine: remove ldapconfig materials

208e386b59-+-logstash: temp stop managing indices

925505d512-+-novastats: replaced diskspace report with expanded cloudvirt capacity report

e0d909c31a-+-profile::rsyslog::kafka_shipper: generalized log pipeline/elk shipper

7aa0f7141f-+-sonofgridengine: deploy the configurator

5daadfbe5f-+-cloudvps: neutron: don't restart l3-agent on config changes

b81a09bd9c-+-noc: move php_engine in the module

f767eea323-+-mediawiki: remove more outdated manifests

333b20064a-+-mediawiki: remove the now redundant class mediawiki::packages::php7

ed1da00748-+-mediawiki: remove legacy class web

50dd655663-+-role::mediawiki::webserver: remove from puppet

794603cc42-+-graphite: backup graphite/django sqlite database

51f356c47a-+-Revert "graphite: add interface::rps settings to graphite hosts"

d5815152d4-+-cloudvps: reimage+rename labvirt1017 as cloudvirt1017

25f9fcd4da-+-wmcs: Remove unused shinken-01 definitions

627b2a1e04-+-finish removing unused progress html from snapshots

97c468f3b0-+-docker::engine: Remove unused class

feaab98e2f-+-MediaWiki PHP7: Add php-bcmath/php-gmp

59a8045b93-+-Use auto_ferm for profile::analytics::database::meta::backup_dest

48beb08043-+-nova-fullstack: pass network ID for eqiad1-r region

6cd2960ca9-+-nova-fullstack: add systemd service for Debian

1b723944a0-+-base: Allow nrpe allowed hosts to be configured by hiera again

aafc9a5b90-+-nova: add fullstack monitoring to eqiad1-r

fe3d9fb65d-+-delete mediawiki_singlenode module and mediawiki:::install role

a2d5b6d763-+-tlsproxy::ocsp - ocsp as a prereq for nginx start

b6c4358f63-+-keyholder, diamond: remove nagios collector and diamond

5cd017fe53-+-base/NRPE: make nrpe_allowed_hosts flexible on $realm

2896942bc1-+-base/icinga: use monitoring_hosts constant as NRPE allowed_hosts

d0e85f4d83-+-ATS: allow nagios user to run check_trafficserver_config_status

d5d91b2c27-+-monitoring::host: fix $cluster name space FIXME

14a5df9182-+-ATS: run check_trafficserver_config_status as trafficserver user

c11f3a98d8-+-graphite: probe /metrics/find too

eead00e2e0-+-ATS: add check_trafficserver_config_status

6d4382fcbb-+-certcentral: override system-provided unit file

c757e71ab8-+-graphite: fix syncdb exec resource

ac10d15668-+-graphite: run graphite-auth as www-data

8c2ba47693-+-prometheus: fix redis misc role

bf71ff75b1-+-Increase pcre.backtrack_limit to 5MB

bd8fffd133-+-logstash/statsd: fix $priority variable without parameter or namespace

1645440e3a-+-icinga: fix ownership of command file dir on stretch

861f4a0e42-+-phabricator: remove diamond::collector and purge diamond

4712bb8eff-+-nagios_common: ensure libtimedate-perl is installed for check_ssl

8c4b05d10d-+-Remove asw-b-eqiad from Rancid, Icinga and Smokeping

8dbaec2b35-+-profile::cache::kafka::webrequest: filter out Timestamp:Restart logs

39cff164da-+-toolforge: factorize some common configs not related to the grid itself

345dad9dd0-+-toolforge: use the apt_pinning profile from the roles requiring it

a28bd47e18-+-toolforge: homogeinize role content style

8a6ef21919-+-prometheus: fix for redis_misc metrics

d97ba19778-+-prometheus: added redis_misc metrics

1e11bf6ef1-+-wdqs: fix some type constraints

16357be1f8-+-rsyslog: add prometheus-rsyslog-exporter support

28548013e6-+-role::memcached: enable interface::rps for mc1035

9ee55e855e-+-graphite: add interface::rps settings to graphite hosts

809da6f3b3-+-Serve WebP variants for the hottest thumbnails

e28bae1304-+-debug_proxy: install nginx lua module

38334f16ee-+-tools-services: Add updatetools_enabled key

2bebaee975-+-Add change_tag to list of tables to sqoop

4c857b9f05-+-mediawiki::appserver: use newer class structure

c5b9a6124d-+-sonofgridengine: lay out bastion hosts

66a0f077fe-+-mwlog: allow deployment to modify /etc/logster

6f32838659-+-cloud ntp: allow eqiad VMs to access these servers

6c15fe3d46-+-mwlog: logster use stdout for alarm parser for now

5d50a649e2-+-hiera: remove diamond from kubernetes masters

5941504bad-+-Add role/profile for a set of in-cloud ntp servers

19dbbea05a-+-logster: add AlarmCounterLogster parser

79472a6126-+-standard::ntp: Move wmf_peers into hiera

bb3942fd0a-+-mwlog: add logster parser cron job

1c328afa72-+-mwlog: add logster::job for CSP

3a6e980bf0-+-mwlog: remove dupe def of dir

3e0510baa5-+-mwlog: add scaffolding for custom logster parser

fa54f42097-+-Absent Kubernetes diamond collector

5b79da4b6b-+-swift: set statsd_exporter to relay to local statsd

0a699cb41d-+-profile::analytics::refinery::job::sqoop_mediawiki: fix permissions

eb1329eab6-+-microsites::bienvenida: enable content cloning

5be2d88205-+-wdqs::updater: removed dependency on wdqs. Added parameter doc

e885ba5b19-+-Rsync published datasets from stat servers to published datasets module

5d61a8da8e-+-icinga: on stretch, use systemd::service, unit file by systemd-sysv-generator

306a14ab32-+-icinga: on stretch, don't use custom logrotate config

09f86b8eae-+-labs_vmbuilder: remove a FIXME already fixed

15a5ad8c5f-+-icinga: don't install PHP httpd module on stretch

d2e323128e-+-etcd::monitoring: replace Nagios::Plugin with Monitoring::Plugin on stretch

7b8b36cd03-+-ores: Change logstash port from GELF to json lines

8cd4ddf10b-+-Remove geoip include from profile mediawiki maintenance, it is already in mw common

1c80151be8-+-Include geoip on mwmaint and mwlog hosts

b8c3758f1a-+-Ensure mmdb-bin is installed as well as geoip-bin

9df5ddb2db-+-interface::rps: always be NUMA aware

0ec317e6f4-+-graphite: move alerting to graphite1004

0ddc002203-+-wdqs: raise alerting threshold on updater lag for public cluster

828d3751d3-+-Default to not using eventlogging-valid-mixed filter

f63dcbca9f-+-maps: increase alerting threshold on OSM replication lag

6f329d9a6a-+-phabricator: remove custom diamond::collector

7ad9c41145-+-graphite: add queue_depth and batch_size options to carbon-c-relay

ebc93ec7e9-+-role::statistics::private: add deprecation motd to stat1005

c403a1e193-+-role::logstash::collector: migrate to profile::logstash::collector

ca426ea318-+-Move ::statistics::wmde to stat1007

18d2912325-+-Move statistics::discovery to stat1007

b44bb430a5-+-swift: enable statsd_exporter

77e6755470-+-mediawiki::webserver: introduce profile, use it on mwdebug*

4c82a9342b-+-mediawiki: add httpd class, alternative to mediawiki::web

9556a44ea1-+-microsites: create bienvenida.wikimedia.org apache static site

8e4d25add6-+-icinga: logging optimizations

876f04540f-+-sonofgridengine: infrastructure restrictions on the master profile

79bda7510d-+-sonofgridengine: remove puppet types for gridengine

5712cc08f4-+-Correct mjolnir class reference in prometheus

edb1913ccd-+-diamond: remove nagios collector

f2f31d105e-+-elasticsearch / prometheus: fix typo

098fadf39b-+-elasticsearch: all tls proxies for elasticsearch share the same cert

0efd5091cc-+-Collect prometheus metrics from mjolnir

10d5b0b591-+-tlsproxy::localssl: allow mutliple proxies with the same certificate

4481260f64-+-drop SAN check for *.m.wikimediafoundation.org

8c49ae6162-+-ATS: check HTTP responses from prometheus exporter

28344f0e3a-+-prometheus-trafficserver-exporter: executable renamed

0d60f4daac-+-Drop support for *.zero.wikipedia.org in SAN check

dc19a5ffc7-+-httpd: add httpd::env

6a014ccfc4-+-monitoring::service: fix $cluster FIXME

248f9ff784-+-Move mail_smarthost (and wikimail_smarthost) to hiera

3a1c623e0c-+-sonofgridengine: move queue definitions to the master

5faa5eacd3-+-sonofgridengine: Fix type reference for gridengine_queues

4976f08fff-+-wdqs: cleanup logback configuration

ecdee5e7d5-+-sonofgridengine: try using the gridengine_queue puppet type

2c579e8e7c-+-Ship base directory for keytabs

119a3d2985-+-toolforge: add missing grid base profile to services role

5af3d5b275-+-toolforge: refactor/bootstrap service node puppet code

134febf01e-+-Remove absented Diamond collector for Pybal

8fcef66fc2-+-profile::statistics::private: fix wrong file ensure

a461aa0e95-+-profile::statistics::private: move geoip archive to another dir

fc01cf51dc-+-wdqs: add wdqs1003 to internal cluster

04e238fd2d-+-wdqs: remove wdqs1003 from public cluster

a88b8d6a9e-+-wdqs: add wdqs1006 to public cluster

8c41c63df1-+-wdqs: remove wdqs1006 from internal cluster

e70564964e-+-Remove Pybal Diamond collector

c96fd6af5b-+-profile::hadoop::common: raise Yarn zookeeper timeout to 20s

a552522c6d-+-Convert udp2log::rsyncd to auto_ferm

eca1ea04b7-+-Add initial profile for Kerberos client

843408d32b-+-Disable prometheus rsyncd module for now

76832b73e4-+-mediawiki: remove now unused common includes

7a3238a787-+-icinga/alerting_host: ensure mpm_prefork is selected for httpd and php7.0

aab3f87398-+-profile::mail::smarthost add primary_hostname setting

750ceadd1e-+-icinga/nsca: fix command_file path on stretch

d82faf8d2a-+-exim smarthosts: Allow setting helo_data on transports

ee0746c985-+-icinga/nsca: fix nsca_chroot path on stretch

d83f05c007-+-sonofgridengine: Add new roles for stretch grid web nodes

4fc3fe71ae-+-When absenting an rsyncd module, also remove the ferm service

46a3ab8ce5-+-profile::statistics::private: move geoip to stat1007 - p2

2cd331391e-+-profile::statistics::private: move geoip archive to stat1007

77031824b9-+-grafana: better configuration handling

47f17f7174-+-role::statistics::private: move reportupdater to stat1007

07280418e0-+-phabricator: Switch srvdumps rsync module to auto_ferm

bb793c62a3-+-icinga: install nsca_frack.cfg in objects on stretch

3895d99752-+-sonofgridengine: prepare web exec profiles for grid

f8fa6352a2-+-Copy hive-site.xml to HDFS from a normal hive client, not coordinator node

b854cdcedc-+-sonofgridengine: clean up the old roles after moving under wmcs

4c417a59c6-+-Planet: Redesign UI

736020e30c-+-osm::planet_sync: Specify correct cron parameter

123494f2c2-+-Decrease OSM update Frequency

c72e7c4496-+-sonofgridengine: refactor roles into wmcs namespace

c4b01107ed-+-Remove all references to labs_metal

9d7e0aef2b-+-Switch carbon rsync module to auto_ferm

c6a1f73e8e-+-Disable prometheus rsyncd module for now

03346821fc-+-Switch prometheus-ops rsync module to auto_ferm

30966b2277-+-prometheus: add Burrow metrics for kafka-logging

9ee1d74d26-+-sonofgridengine: fix the sysdir variable for the HBA scripts

091ddc9cbc-+-sonofgridengine: several changes to the compute node definitions

0a2431da59-+-Puppet: rename cr1-eqord to cr2-eqord

a2570165ae-+-sonofgridengine: add compute node roles

940337f958-+-labsaliaser: don't have Python generate Lua code directly

0ded1331de-+-logstash: apply role::kafka::logging to logstash es data nodes

367e6bf085-+-mediawiki::web: only include the hhvm catchall if set_handler is not set

159efe675a-+-mediawiki::webserver: reorganize default settings

4181ef9ffb-+-Add role::statistics::private to stat1007

049bd5b15b-+-profile::analytics::refinery::job::camus: remove unused param

df57dd0763-+-ATS: stop shipping Lua format logging config file

e59a5d9cf7-+-ATS: use YAML format for logging config file

b27f3332c0-+-ATS: remove synthetic and mgmt ports configuration

94f03315b1-+-mediawiki::web::vhost: allow serving requests with php7

8eecc6c86b-+-mediawiki::web::vhost: use handler to do proxying

7deca8a302-+-profile::eventlogging::analytics::files: reduce retention to 7 days

2c0325b0f8-+-icinga: allow configuring max_concurrent_checks via Hiera

de6632938f-+-icinga: add puppet types for parameters

be391299c3-+-sonofgridengine: need to create the spooldb folder

5af1dd79ad-+-gerrit: move letsencrypt::cert::integrated to profile

30848e1cf5-+-sonofgridengine: Make an effort at causing the grid master to bootstrap

57f76cd4ea-+-shinken: Fix typo in init.pp

e320b80e9c-+-shinken: Adjustments necessary to upgrade 1.4->2.0 and Trusty->Jessie

abd3d2280c-+-sonofgridengine: Remove more paths and such from the old gridengine

98576b61c8-+-sonofgridengine: remove more cruft from the old module

f50fc5a1a5-+-sonofgridengine: old code still referenced the old gridengine module

0ccc5d4a7c-+-icinga/nsca: use systemd::service, unit file by systemd-sysv-generator

6ed2da198a-+-weblog1001 install params

1cb52ac69d-+-prometheus: set defaults for statsd_exporter

114199f2ae-+-eventbus: move to profile

a77e5da2a8-+-eventlogging: use /srv/log instead of /var/log as default logging dir

be69b872ab-+-sonofgridengine: correct the collector variables

80b049647a-+-wdqs: Assign user directory to blazegraph user

e5e3d06dd2-+-prometheus: add jobs for statsd_exporter

220d268dce-+-thumbor: use statsd_exporter

5490f94227-+-aptrepo/rsync: hosts_allow needs to be an array

bf3a35aeb6-+-rsync::module:: add missing parameter auto_ferm_ipv6

b65df86525-+-Switch aptrepo::rsync to auto_ferm

02bd0f9d5b-+-Add punjabi.wikimedia.org to Apache

4ce936300d-+-nova: remove 'ferm' from compute nodes

26d29dff5f-+-icinga: avoid hardcoded nsca_user,nsca_group for NSCA service

170bc22834-+-sonofgridengine: puppetdb known-hosts conflicts with grid custom version

351d2ac289-+-sonofgridengine: Fix a typo, clean up a type we will never use and more.

911ffe3e35-+-prometheus: add scrapes for apache on phabricator instances

6a076fccdd-+-Fine tune eventlogging_to_druid_job spark and druid parameters

7f55b61da3-+-Proton: Configure the fonts

61c69864bd-+-profile::analytics::refinery::job::camus: upgrade camus jar

63a568d320-+-scap::target: added additional_services_names param

b62b972315-+-Revert "site: enable logging Kafka on Logstash nodes"

16a8bead2e-+-eventlogging::analytics: move to profiles

6936708b2d-+-profile::analytics::refinery::job::camus: enable eventlogging-client-side

47213bb678-+-sonofgridengine: remove duplicate declaration with standard packages

42bfb22f30-+-Enable base::service_auto_restart for nginx on debug proxies

d56c108f2c-+-site: enable logging Kafka on Logstash nodes

6d2d747627-+-pdns_server: set pdns.conf mode to 0440

d63ee99e71-+-ATS: define icinga check for HTTP responses

5be04fea6c-+-confluent::kafka::common: force provider => 'systemd' for services

2a4d1eac6e-+-wikimania: use "wikipedia" for upload redirects

a72be52dcf-+-eventlogging: remove upstart/Trusty and Jessie support

f1162470d0-+-mediawiki::web::prod_sites: convert wikimania too

e70dedaaba-+-mcrouter: add the probe_delay_initial_ms parameter

e639c01559-+-site.pp: Comment fixes due to dewiki no longer being the only s5 wiki

ade0f3043b-+-mediawiki::web::beta_sites: convert to using mediawiki::web::vhost

29aba12179-+-logstash: bump default receive buffer

fb2a8842ea-+-scap::scripts: remove unneeded include of mediawiki::users

c583fe6691-+-mediawiki: remove base class, superseded by profile::mediawiki::common

b39e022961-+-labs recursor: require interface alias before trying to start pdns-recursor

108e56f3ed-+-labsaliaser: use keystone public port instead of admin port

2941f7b1df-+-eventlogging::server: rotate logs on size (not only on time)

a325d271ed-+-labstore: correct the service name for stretch

8b6a26a11f-+-openstack clients: use OS_PROJECT_ID instead of OS_TENANT_NAME

904f0bf417-+-sonofgridengine: Correct and expand things enough to deploy a grid master

f920e08113-+-mediawiki/apache: add za.wikimedia.org as prod_site

3a605a1729-+-nagios_common: set flag -2 on check_nrpe for nrpe on stretch

53cda65217-+-releases/icinga: remove trailing slash in URL to fix Icinga check

afcd1efe97-+-releases/icinga: fix releases-jenkins URL check by adding /login/ path

f6ea3a7ca1-+-Added new role::redis::misc for general purposes redis servers

8b12373488-+-authdns::lint: install latest package

dc508aeda3-+-pybal::web: convert to puppet 4.x

3465a31fb4-+-certcentral: Set HTTP_PROXY/HTTPS_PROXY environment when running backend service

46953a2f2c-+-certcentral: Replace service unit file

cd1d39b5ef-+-certcentral: Notify certcentral backend service on config change

03e039cc60-+-profile::hadoop::worker: fix yarn prometheus alert

8437bbf9f0-+-Fix analytics JVM alarms (missing left parenthesis)

48858fb39d-+-Smooth Analytics' JVM alarms over the past hour to avoid icinga noise

edbb614ecc-+-role::eventlogging::analytics::files: lower down retention

7360d03c39-+-Use auto_ferm for hdfs-archive rsyncd module

c6235fcb85-+-Use auto_ferm for eventlogging rsync module

8a44a2a579-+-Use auto_ferm to properly restrict to rsyncd on stat hosts

0666d7ce51-+-Move Analytics JVM's alarms away from fixed thresholds

3a2b34d910-+-hadoop::master|stanby: avoid hardcoded thresholds for jvm alarms

c3a6ef90be-+-profile::hadoop::master: fix threshold for alarm

a9b5d1964d-+-icinga: make icinga user flexible in update-etcd-mw-config-lastindex

58dfcfc6fa-+-releases: fix where the inactive warning motd is displayed

5615d0cfa3-+-install_server: move letsencrypt::cert::integrated to profile

407c299c60-+-Fix broken default job_class for eventlogging_to_druid_job.pp

445c930bae-+-certcentral[12]001: static mapped v6

6bc3ca89bf-+-Add druid_load jobs to analytics refinery

77aed7c84a-+-prometheus::class_config: fix deprecation warnings

ed08fb9129-+-wdqs: extract a custom type for deploy mode

8b13acbd2c-+-Use the newer statsd name for ORES nodes

d21b3eff19-+-cloud puppetmaster: allow designate in eqiad1 to clean puppet certs

dd1892b6ba-+-Revert "site: enable logging Kafka on Logstash nodes"

6921e044c9-+-site: enable logging Kafka on Logstash nodes

3fb43128fb-+-authdns: Fix certcentral_target keyholder public key path

fa96cc8443-+-Certcentral-authdns integration

2c697a57ab-+-base: move pxz to standard packages

1417829582-+-profile::analytics::refinery::job::sqoop_mw: move to timers

8b9d41938d-+-icinga: remove check_lonqueries.pl

4776819641-+-Revert "wmcs: add prometheus-memcached-exporter"

4b9adcea66-+-wmcs: add prometheus-memcached-exporter

e3c8bebc41-+-Restrict ferm service package_builder_rsync to domain networks

804b1aefb3-+-exim4: remove deprecation warnings

361fd90ddf-+-sysctl::conffile: remove deprecation warnings

639fc92123-+-admin::user: fix deprecation warnings

27fdcd65fe-+-netbox: update submodule path

79104d15ef-+-mariadb: enable replication check on Parsercache hosts

d46442985a-+-maps: restrict OSM sync check to maps1001

17a5246922-+-profile::openstack::base::wikitech::web: require profile::mediawiki::common

d1e3530998-+-role::deployment_server: use profile::mediawiki::common

4225907bc3-+-Only use service_auto_restart for ircecho on Debian

5013a828ae-+-Revert "Revert "role::prometheus::ops: collect memcached stats from thumbor/swift""

2af2edeeb6-+-smarthost: create mail smarthost profile and wmcs smarthost role

0f84f55faa-+-Conditionally pass in zookeeper_hosts to cdh::hive

1ce6cf17c4-+-cloudvirt1024: Make a cloudvirt node

85be42b9fd-+-labvirt1018: rename to cloudvirt1018

2eece98a8f-+-Use hadoop_cluster label in icinga alerts

efd61dd081-+-mediawiki: Remove unused 'role::logging::mediawiki::errors'

8e13fd622a-+-nagios_common: remove check_sslxNN

f9005694dd-+-Move analytics cluster druid deep storage out of profile::hadoop::master

982d5dfa86-+-New Kafka cluster logging-eqiad

dc19eb13fb-+-Label Hadoop prometheus metrics with the hadoop_cluster_name

cc7cb31482-+-Fix net-topology.py.erb script to render proper python dict

b7ec3dbd8a-+-profile::hadoop::balancer: move to systemd timer

b0e23053d3-+-profile::analytics::refinery::job::camus: temp disable eventlogging-client-side

016e44a81d-+-tlsproxy: allow multiple default servers on different ports

1c838029cc-+-smart: switch to syslog logging

630ef61a0c-+-Move Hadoop net topology to hiera

19a781c844-+-certcentral: Add sslcert::dhparam requirement

b1a0b0abae-+-Central certificates service

a2d1ccf8bf-+-openstack: add case for stretch and newton in client repos

8916aece12-+-profile::mediawiki::common: stop using class 'mediawiki'

8fbf939bc4-+-Revert "Assign user directory to blazegraph user"

e8f1f4cd67-+-Assign user directory to blazegraph user

5733a18596-+-wdqs: spread IRQ from NIC over multiple CPUs

d23564bb8e-+-dumps config settings to use lbzip2 for recombining page content files

c66ebe7a1c-+-rsyncd: Remove xinetd remnants

43f913ed40-+-mediawiki::web::prod_sites: convert wikipedia.org

c64731e30d-+-prometheus: clean deprecation warnings on prometheus::node_exporter

ee7700c9d7-+-Clean up removed rsyncd configs

cd1f5b1796-+-labstore: make nfsd-ldap package required for jessie, but not stretch

3b89384969-+-authdns: add interface::rps and TFO

d00e0f6251-+-wdqs: improve resource ordering for non scap deployment

e7cb80480e-+-prometheus: add collector.ntp.server option and enable on recursor nodes

7943f9fbce-+-wdqs: 'manual' is a new valid deployment mode

6080097105-+-wdqs: 'manual' is a new valid deployment mode

1f608c8113-+-wdqs: 'manual' is a new valid deployment mode

2aa62904ee-+-wdqs: labs should be deployed manually

8152147d68-+-profile::analytics::refinery::job::camus: use camus to backup el-client-side

b08b463370-+-mediawiki::web::prod_sites: convert wikidata.org

219d04d8f5-+-Turn off wikidata dispatch verbose mode

b8a531d1e0-+-interface::rps: support tg3 properly

88137b9d00-+-nagios_common: on jessie, also install libmonitoring-plugin-perl

f8e55a9279-+-mediawiki: convert to http::site

8ff2d674b2-+-mediawiki::syslog: stop looking variables up the scope

95b11fa34f-+-ores: puppet config for redis task tracker

f49a93ebd0-+-prometheus: fix deprecation warnings in prometheus::node_puppet_agent

997c0874cc-+-Recommendation API: Add MySQL connection config

2790082714-+-Fix ferm syntax

ed226150a7-+-Revert "role::prometheus::ops: collect memcached stats from thumbor/swift"

fddab1b11a-+-Switch yhsm_aead_sync to auto_ferm

f45c6a5c56-+-statsd_exporter: fix commandline flags

83b4803e2a-+-thumbor: add prometheus-statsd-exporter

8d33bc7419-+-New class: prometheus::statsd_exporter

3cc5a11701-+-role::prometheus::ops: collect memcached stats from thumbor/swift

cdc07f447d-+-profile::memcached::instance: set the -R arg via hiera

c19be03e3e-+-monitoring::check_prometheus: fix compiler warnings, adding type constraints

55a5f364f9-+-wdqs: auto restart wdqs-updater on config changes

e71ca73dfe-+-Enable base::service_auto_restart for squid/url downloaders

6632d42150-+-uwsgi: Remove the uwsgi-dbg package

6a4478d73a-+-Remove jobs for decomissioned dashboards

217550ccdd-+-Enable tracking lexemes in Updater

1213a9deb3-+-base::expose_puppet_certs: fix compiler warnings, add type constraints

ecf82dd0b0-+-motd::script: add type constraints and get rid of compiler warnings

cf2c527840-+-profile::analytics::refinery::job::data_purge: move crons to timers

2b5170d267-+-Enable base::service_auto_restart for navtiming

11224c68f4-+-mcrouter: allow defining a non-default number of backend connectors

6eb6fbe261-+-mediawiki::web::prod_sites: convert test.wikidata.org

fba4de23d1-+-base::service_unit: add type constraints on parameters

01da14086e-+-rsyslog: replace deprecated validate_numeric() with type contraints

13a8707a7a-+-mediawiki::web::prod_sites: convert vote.w.o

608796e2ee-+-logrotate: add type contraints to parameters

75d6b521bc-+-mediawiki::web::prod_sites: convert wikibooks.org

f9a03c1553-+-mariadb: productionize db2096

437eb213ad-+-mediawiki::web::prod_sites: convert wikisource.org

80994c7e47-+-profile::analytics::refinery::job::data_purge: add systemd timer

1806976253-+-Remove starting ' ' from Calendar date/tim in analytics' systemd timers

bd5a95a003-+-Icinga, add mr1-ulsfo IPv6 OOB

81139d1637-+-Refactor type Systemd::Timer::DateTime to include more normal forms

97fa55a3a2-+-mediawiki::web::prod_sites: convert wikinews.org

1802181e3d-+-WIP toolforge: write/move a sonofgridengine module and toolforge profile

0815174865-+-network::constants: remove mwmaint1001

d5b869a745-+-nutcracker: remove diamond collector resource

e72dc90d51-+-profile::statistics::cruncher|private: remove unused bacula settings

e8f558d631-+-rsyncd: Add option to generate ferm rules based on $hosts_allow

9c9046c2a4-+-ores: Add logstash config

c5d0006620-+-Enable base::service_auto_restart for uwsgi-coal

352daf5b6b-+-Cleanup systemd state on Diamond removal

f2cfa2887d-+-Make cloudvirt1023 a compute node

5bc1940de5-+-re-add mw1297 to site.pp and DHCP, remove mwmaint1001

a9bbc9a7e3-+-mediawiki_maintenance: switch home rsync to 1002->2001

7cbe99aa99-+-Revert "mw_maintenance: temp hack to avoid duplicate crons on switch to eqiad"

c35cd845d9-+-wdqs: run autodeploy on the hour, 4 times per day

9225b8e8db-+-nutcracker: ensure absent nutcracker.py

61e1e9b7f4-+-wdqs: fixed autodeploy cron logging permission issue

cd51a89983-+-move role::authdns::data::nameservers to common hiera

bfc48c4779-+-ATS: define Icinga checks

256b1c3a31-+-profile::cache::kafka: fix varnishkafka Icinga checks

2fc2e2bc5e-+-wdqs: change user for autodeploy cron task

b31aa1d9a5-+-wdqs: refactor use_git_deploy to include scap3 and autodeploy options

e103c9df03-+-wdqs: increase throttling limits for internal cluster

7e43e55b8a-+-Add stat1007 as role::spare::system

6f0ce8e002-+-Remove all absented Diamond collectors

10a1d92322-+-Stop the diamond service when removing Diamond

7088d66910-+-base/nrpe: add icinga1001 to allowed_hosts

5298d8c3ee-+-scap/tcpircbot: remove mwmaint1001 from scap and allowed hosts

30e94d4dda-+-site: turn mwmaint1001 into a spare::system

9159c64265-+-Revert "statistics::rsync::eventlogging: reduce retention for archive"

e001565d7f-+-mw_maintenance: let $motd_ensure be based on $ensure for warning motd

f74e97040d-+-statistics::rsync::eventlogging: reduce retention for archive

72bd42ea8d-+-role::eventlogging::analytics::files: reduce retention for archive

62dba7b90b-+-Decommission conf100[1-3]

5d2010fe4a-+-wdqs: correct condition for initializing git fat

0cc80162df-+-wdqs: onlyif condition should exit with 1 for git fat to run

9ff3d03c6e-+-wdqs: run git-fat commands from the package directory

028dd32550-+-wdqs: pull files from git-fat after initial checkout

11c7343d67-+-wdqs: missing dependency for ordering of git::clone

14e19f0eff-+-wdqs: fix path in autodeploy exec resources

40fb72a927-+-wdqs: auto deployment of wdqs on wdqs1009

1f24755b09-+-Enable base::service_auto_restart for coal

f24743144d-+-profile::prometheus::alerts: raise warning for EL throughput alarm

dfba46ec9e-+-Add interface::add_ip6_mapped to analytics-tool* hosts

74aa377371-+-Enable base::service_auto_restart for Druid Prometheus exporter

d9881527a9-+-Icinga: increase ripe atlas alerting threshold to 35

6f8ff4a3a5-+-Add Accept header to varnishkafka webrequest logs

15c59f9d02-+-Refine job: Fix hive_server_url, add since and until params

c9b35d003a-+-Set hive_server_url for refine job to value that hive client class uses

c1f3f2bb32-+-network::constants: fix druid ipv6

38aba913b8-+-profile, graphite: remove diamond

d489cac509-+-puppet: update puppet-lint, wmf style checker versions

32d15fcea7-+-Remove Diamond from openldap/labs hosts

03a6a23d65-+-ATS: add HTCP-based HTTP purging

cedc1c20ff-+-htcppurger: move varnish::packages requirement to cache profile

d54f734634-+-varnishmedia: post-removal cleanup

f92319d1a3-+-Set analytics1003 as spare host (prep step for decom)

f31804d459-+-role::analytics_cluster::coordinator: remove analytics1003 references

9c2a4731fd-+-profile::hive::site_hdfs: remove other permissions

05cdaa4cb3-+-mediawiki::web::prod_sites: convert donate.w.o

bef17b23cf-+-varnishmedia: remove python daemon

5ab22a51ce-+-role::analytics_cluster::coordinator: deploy jobs to an-coord1001

33119f86d8-+-Replace analytics1003's occurrences with an-coord1001

d2a87b8f67-+-mediawiki::web::prod_sites: convert wikiquote.org

4e4eaf6f77-+-Revert "SNMP: set snmp-mibs-downloader BASEDIR to Debian 9 standard"

34fbbff845-+-mediawiki::web::prod_sites: convert wiktionary.org

8774d56d92-+-cache: fix varnishbackendtiming destination directory

44138523d1-+-elasticsearch: mjolnir daemons can be autorestarted

855966a5a9-+-cache: enable varnish::logging::backendtiming

09040fb614-+-Make auto restart for prometheus-pdns-exporter conditional on Debian

fa1a6aa1ec-+-Make auto restart for prometheus-rabbitmq-exporter conditional on Debian

eeb0266c9a-+-pybal: support etcd connections to ports different from 2379

41440c60eb-+-site: add certcentral[12]001 as spare systems

9ef57af8c3-+-Backend-Timing Varnish mtail program

d2041b2583-+-Enable base::service_auto_restart for varnish-slowlog

c1f263736b-+-Enable base::service_auto_restart for varnish-hospital

8801884cbf-+-Enable base::service_auto_restart for ircecho

7f5dfa0f3d-+-Add http_proxy to profile::analytics::refinery::job::project_namespace_map

044f6fe499-+-Enable base::service_auto_restart for prometheus-rabbitmq-exporter

601c05cfe0-+-wikireplicas: enable wmf-pt-kill service

b3ca278146-+-Enable base::service_auto_restart for PowerDNS Prometheus exporter

3ac84b10c5-+-Add lexemes dump as separate dump

19d2243b4b-+-Gerrit: Lower gerrit.wmfusercontent.org priority in apache

3adf294190-+-mw_maintenance: temp hack to avoid duplicate crons on switch to eqiad

2a7e74872c-+-labstore: we really only want to know about prolonged load issues

bb0d8880ae-+-Revert "ntp: remove diamond::collector in favor of prometheus-node-exporter"

4af555ae96-+-icinga::web: don't include ::icinga

f29f0238d3-+-ntp: remove diamond::collector in favor of prometheus-node-exporter

4699343f8c-+-profile::prometheus::alerts: tune druid alerts

49f845eb59-+-openstack, rabbitmq: remove diamond

578c7bccde-+-Retrieve hive/oozie database configurations from hiera

f37baad3dd-+-Builder: add dh-sysuser for builders > stretch

73cbb96b2a-+-WDQS: Add sudo rules for wdqs-updater

36c1e4c0b2-+-Decommission bohrium

8db16fa840-+-wikirepicas: wmf-pt-kill template data only from hiera

58fba92895-+-profile::etcd::replication: fix regex in monitoring

47c5b7c07e-+-icinga::monitor::elasticsearch: throttle alerts notifications

ce4febb2c3-+-Netbox, set the napalm_username variable and matching keyholder

d9867f674f-+-Revert "wdqs: auto deployment of wdqs on wdqs1009"

bed0f075de-+-wdqs: auto deployment of wdqs on wdqs1009

b8755557ab-+-standard: remove diamond::collector declaration from standard::ntp::timesyncd

b5fddf1eae-+-ircecho: restart service on change

16ad265d99-+-profile::analytics::database::meta: fix require for stretch

c67d27690b-+-Apply a limited analytics coordinator role to an-coord1001

7d0a22ce0a-+-Install python 2 variant of sklearn on stat machines

5fa1cdcc32-+-role::configcluster_stretch: enable etcd replication

619fe38381-+-Install scap version 3.8.7-1

c0b82f3ea8-+-cloudvps: metrics: we don't require observerenv

74c4335183-+-Revert "prometheus-openstack-exporter: only makes sense in active control node"

94a7390130-+-prometheus-openstack-exporter: only makes sense in active control node

ae134dda6e-+-service::node::config::scap3: get rid of confd-controlled configs

38c47d15d6-+-Revert "base/icinga/nrpe: move nrpe_allowed IPs to Hiera, add icinga1001"

7d2b426ec6-+-base/icinga/nrpe: move nrpe_allowed IPs to Hiera, add icinga1001

ab54d19dd3-+-base: do not allow mailman server to NRPE to other hosts for no reason

b1936b8948-+-Revert "Gerrit: Add missing resource /var/lib/gerrit2/review_site"

5bc1155141-+-profile::etcd::replication: allow the config of src/dst repl ports

93fbeb5fb8-+-prometheus-openstack-exporter: add monitored endpoints

19454c1eda-+-profile::mediawiki::php: add support for php-fpm

5b1bfa1fdb-+-mediawiki::web::prod_sites: convert mediawiki.org

049585aa0f-+-profile::etcd::tlsproxy: correctly set the upstream server if using tls

60505cc4d8-+-profile::etcd::v3: allow connections to the advertised port

34f201ef8e-+-prometheus-openstack-exporter: replace instead of override systemd service file

4b1afcc155-+-prometheus-openstack-exporter: use systemd::service content parameter

8c0f4fedf2-+-prometheus-openstack-exporter: s/content/source/ in systemd::service

609f4762d7-+-prometheus-openstack-exporter: typo in puppet URL: missing /

4a84283199-+-prometheus-openstack-exporter: use novaadmin credentials

2abf612c76-+-profile::etcd::v3: do not setup firewall rules if only localhost is allowed

16e9101598-+-mediawiki: Install php-gd for ZeroBanner

a6a6bfb456-+-icinga: move configuration directory for resource.cfg

ffe4b378a3-+-icinga: use correct user for tmpfs mount

d762eda45c-+-icinga, nagios_common: use commands.cfg on stretch

7814a75879-+-icinga: add new icinga.cfg and move configuration

d96e88452f-+-Add backup parameter to saltrotate cron job

0136743ed6-+-wdqs: don't send nginx logs to logstash

3e392c4b15-+-decom lvs400[1-4].ulsfo.wmnet

be8d1b2dc3-+-Introduce cumin::selector dummy class

c663485d67-+-Kartotherian: Add wikidata_query_service var for configuring WDQS endpoint

6742095732-+-maps: change date of job to regenerate high level tiles

2463154782-+-Fix: Regenerate map tiles up to zoom level 9

b2da9bcc15-+-profile::piwik::webserver: deploy php7.0-xml

5c3bb1bd84-+-Revert "profile::piwik::database: deploy the mysql exporter on jessie"

ba4cb60700-+-profile::piwik::database: deploy the mysql exporter on jessie

ba840b01a4-+-role::prometheus::analytics: fix mysql exporter config

37aa02b20f-+-role::prometheus::analytics: add mysql jobs to the config

7d7f2ab199-+-role::prometheus::analytics: add mysqld exporter references

9148d15ea3-+-Add prometheus mysql exporter for analytics-meta and matomo

03d29f524c-+-scap: Replace an ugly hack with puppet 4 syntax

1ad248d074-+-icinga: service management depends on debian version

e11607065c-+-icinga: move init script customizations to default

989bddd3ee-+-icinga::naggen/web/raid/ores: avoid out-of-scope-vars everywhere

070c8b817c-+-matomo: replace last piwik occurrences

f7bf9dc626-+-profile::piwik::webserver: install php7.0-mbstring on Stretch

bb7c375169-+-prometheus-openstack-exporter: ensure permissions

7a5da72623-+-profile::piwik: move to mariadb

2d1f8bfbd6-+-Revert "profile::analytics::refinery::job::data_purge: add two timers"

029497972f-+-Revert "openstack: add case for stretch and newton in client repos"

d0dc580169-+-openstack: add case for stretch and newton in client repos

98f75444d8-+-etherpad: Remove the diamond collector and monitrc files

9658da7ea6-+-Add matomo1001 to puppet

54de325500-+-mediawiki::web::prod_sites: convert wikiversity.org

dd7d26f765-+-Allow multiple elasticsearch instances per host

270585910f-+-mediawiki::web::vhost: generalize the upload_rewrite mechanism.

c06a86a196-+-Filter out duplicates in allowed hosts

e059abba46-+-Only allow HTTP port for Hue

ea7193bf8e-+-yarn_http: Restrict to caches

d5c49baf25-+-profile::analytics::refinery::job::data_purge: add two timers

9e50979903-+-cloud: Enable systemd unit for MediaWiki-Vagrant

3833954f03-+-wikireplicas: ensure wmf-pt-kill service is stopped

ff244b289b-+-cloudvps: eqiad1 metrics: use labmon instead of main prod monitoring hosts

214bb674d2-+-Add an-coord1001 to puppet

af41de087a-+-wikireplicas: Config template generation for wmf-pt-kill

e26579ff3c-+-parsoid: fixup for the https uri

974c46cd4a-+-parsoid: connect to MediaWiki via https everywhere

2f55fc2396-+-parsoid: convert to role/profile

465799441b-+-profile::lvs::realserver: new profile to substitute the role

5d35fc49b3-+-profile::product_analytics::base: fix package name

714b47bad0-+-alerting_host/icinga: move "mapped v6" snippet back to site

56c10ab7cd-+-icinga::plugins: add user/group param and avoid out-of-scope vars

b1db3068b3-+-network::constancts: add icinga1001 to monitoring_hosts

d9f7bde280-+-Restrict Icinga rsync access

12f814cc8d-+-certspotter/alerting_host: don't include role inside role, -> profile

27d063c2ce-+-alerting_host/tcpircbot: remove useless role, include only profile

52bdcfae0b-+-xhgui::app: add standard and firewall includes to role

bb0325c468-+-Remove additional role include

efd26f2170-+-Labs monitoring: Authorise new shinken host

f490bcd662-+-Updates to Product Analytics profiles and roles

77439a73b1-+-prometheus-openstack-exporter: fix subvars usage

05e71601d9-+-prometheus-openstack-exporter: fix comma in ferm array

da747c470e-+-prometheus-openstack-exporter: fix ferm syntax

27b15d51f8-+-cloudvps: add prometheus-openstack-exporter

83c48d3a53-+-mariadb backups: Convert db1116 into an eqiad backup source host

a595e551c8-+-tools: Update usage of ::elasticsearch (take 2)

e95eaef39a-+-icinga: set user/group for event_handlers::raid

87359c4d9c-+-icinga::plugins: set user/group for nagios_common::commands

4ced4a71d7-+-icinga: hot fix for puppet issue with rsync and use_ipv6

bc990a4a9c-+-icinga: tell rsync server to use IPv6

c1448989f5-+-icinga: allow rsync from multiple hosts

8807b49ecf-+-tools: Update usage of ::elasticsearch

b4918ed0fd-+-icinga: linter compliance and stretch user

70a7f7878a-+-icinga: enforce mode on nagios files

5791d6ca25-+-Remove references to deleted labs project ci-staging

09c01fbe23-+-keystone: Create top-level domain for each new project

a29b2bcb8d-+-labstore: Change the dumps monitoring thresholds

9482dfc3f5-+-l10nupdate: disable temporarily

bb020a54e8-+-icinga: fix ircecho password ownership

67bfbde6e2-+-icinga: use IRC account password

1c6a225691-+-Fix: Regenerate map tiles up to zoom level 9 with notify-tilerator-regen

93f57fcfcd-+-mariadb backups monitoring: Make icinga messages more human friendly

75e613e723-+-Remove two rsyncd modules on stat hosts

3d1f99b480-+-backups: Setup new backup check for all sections on zarcillo db

aa3a0030b7-+-php: add service management for php-fpm

1b755abd31-+-mariadb: use ::profile::base::firewall

b208cb603d-+-mediawiki::web::prod_sites: convert wikivoyage.org

7505c39c5d-+-icinga: fix more places with hardcoded user name

ad72fe623d-+-icinga: pass user/group from profile, change to nagios on icinga1001

aa5053cbe3-+-Icinga, update mr1-ulsfo IPs

180aed30e2-+-icinga::ircbot: move from module to profile

debce765a7-+-Icinga, update mr1-ulsfo OOB IP

8b0da66e1f-+-toolserver_legacy: add status.toolserver.org to LE cert

797af32c5a-+-Puppet, rename all instances of cr1/2-ulsfo to cr3/4

7c914f06d4-+-cloudvirt102[0-2]: Add IPv6 address

9dc2708be9-+-rabbitmq: fix ferm list syntax

990e0d6c48-+-Rabbitmq: allow labvirt/cloudvirt access via ipv6

1497197219-+-cloudvirt1019: add ipv6 address

a99a8711d8-+-Revert "base: link documentation for negative disk space available reported"

1618f216ed-+-base: link documentation for negative disk space available reported

9f10656c11-+-profile::mariadb::misc::el::sanitization: avoid using /var/run

67335e8b7c-+-Split instance define out of elasticsearch class

9b3c4d79df-+-php: do not escape underscores in safe names

491729da8c-+-mediawiki: move php to a profile, use the php class

8182bc8e03-+-network::constants: remove analytics100[1,2]

5519b2de77-+-icinga: make group configurable, make user configurable pt2

fdcf44ff04-+-icinga: use $icinga::icinga_user in all classes

418d6a6d7c-+-icinga: make icinga user configurable

6ac4848f04-+-rsync::server: add parameter to use IPv6

44eb8e3665-+-icinga: (if on stretch) don't let puppet manage user/group

050378b937-+-Fix input regex and capture group configs for Refine jobs

086cfbae23-+-icinga: remove nsca::firewall class, use ferm::service in profile

60c4e16461-+-Use --files to upload job properties file for refine spark job

db72da1e10-+-icinga: remove icinga::group class

b41252342f-+-Fix rebase conflict error in refine.pp

7e22496214-+-Refactor refine_job to use new spark_job and ConfigHelper properties

5cfb53eab9-+-cumin: installation of cumin1001

63653511f8-+-Revert "monitoring: set mode on host and service configs"

77b5b3c0c3-+-prometheus/elasticsearch support multiple exporters per host

99e39c7f91-+-Set analytics100[1,2] to role spare system

d101400371-+-monitoring: set mode on host and service configs

06a20e0e1b-+-mariadb: Add alternative, read-only account for recomm. api db

bbb36e8249-+-Chaging populate admin cron

d6681c5ce7-+-Scrape Kafka jmx exporters in deployment-prep

19b4893c11-+-Remove unused 'style' var from Kartotherian / Tilerator modules

9834650c75-+-profile::prometheus::alert: increase eventlogging critical threshold

8edc1b39c3-+-eeden: remove from authdns set, reimage to jessie test

4a723ee2b0-+-Swap occurrences of analytics1002 with an-master1002

e942ea876e-+-mariadb: Add recommendation api database accounts to m2

f120e79cd8-+-Swap analytics100[1,2] with an-master100[1,2]

58db295f01-+-mediawiki::web::prod_sites: convert wikisource.org

5dfe09b013-+-maps: migrate maps1004 to stretch

fc934ee436-+-profile::mariadb::misc::el::sanitization: add correct user to timer

b4fa3152fa-+-profile::mariadb::misc::el::sanitization: swap cron with systemd timer

0fe92dca25-+-convert role::logstash::elasticsearch to profiles

02518ba1ae-+-mediawiki::web::prod_sites: convert meta.w.o

04e787bce4-+-icinga: don't open ferm hole for LABS hosts for NSCA

8532a082a3-+-ores: install hunspell-gl on ores nodes

4e75f3b560-+-mediawiki::web::prod_sites: convert commons.w.o

24ad6c950e-+-mediawiki::web::prod_sites: migrate wikispecies

b1efa467bf-+-mediawiki::web::prod_sites: convert usability wiki

c484c1c1d1-+-mediawiki::web::prod_sites: convert simple wikis in remnant.conf

0f9ac5ed91-+-mediawiki::web::prod_sites: convert foundation.w.o to use vhost

895d09cdfe-+-Guard analytics cron jobs to ease the hw refresh of an1003

0c6b903eb1-+-mediawiki::web::vhost: Allow if using canonical name or not

848ae809d6-+-mediawiki::web::prod_sites: convert login.w.o

61c6f2be02-+-site/admin: replace mwmaint1001 with 1002 in comments

5382366589-+-toolserver_legacy: enable ssl module for httpd

c2b508a523-+-shinken: Fix dependency on jessie

7b7f2ac7f5-+-shinken: Only overwrite init.d script on trusty

b473af8139-+-Only install python3-snimpy on debian >= jessie

67ba77ae9e-+-Add IPv6 interface to an-master100[1,2]

8284aca004-+-puppetdb: Don't try to install tuning.conf until dir/package exists

bdfa0874d3-+-elasticsearch: disable the default elasticsearch unit

044ca639a9-+-mediawiki::web::prod_sites: convert chapterwiki

d9faad389c-+-Define Haproxy Prometheus jobs

4accb43299-+-Create wikidata ntriples dump from ttl dump

f26341f34e-+-releases: fix template name for motd warning

a86fc62b2c-+-releases: add warning motd on secondary server

f7ec562822-+-make more obvious which rsyncs are automatic

1dd0075c11-+-SNMP: set snmp-mibs-downloader BASEDIR to Debian 9 standard

d67a5c6c31-+-multatuli: add to authdns server set

f969f6581d-+-site: add mediawiki_maintenance role to mwmaint1002

7b455674ea-+-multatuli: reimage as stretch authdns

f352859c1f-+-setting base install params for an-master100[12]

659dc0d986-+-Fix resolv.conf config for esams dns servers

e98f66ab19-+-Scap: upgrade to 3.8.6-1

d3be09296f-+-icinga: Update link to ORES in comments

006ab45fbe-+-dumps: monitor generation nfs server hosts for nfsd cpu usage

65dcd92cbf-+-profile::analytics::cluster::gitconfig: apply on in the prod realm

1f6e42d8e0-+-statistics::user: force git webproxy only in production

87beed0292-+-Set up Thumbor Haproxy Prometheus exporter

3f81010794-+-standalone-puppetmaster: stretch compatibility improvement

efaa1524be-+-mediawiki::web::prod_sites: reorganize code a bit

10e4ef1b71-+-mediawiki_maintenance: allow rsyncing home dirs from 1001 to 1002

fdf584d4f5-+-network::constants:: add mwmaint1002 to maintenance servers

932e65072b-+-tcpircbot: add mwmaint1002 to allowed hosts

133f5accde-+-Icinga: add check_bfd check (part 1)

7e13de65a8-+-Allow mgmt hosts to send syslog to central syslog servers, try 2

40d09e1b0a-+-Revert "Allow mgmt hosts to send syslog to central syslog servers"

d6d1856c21-+-Allow mgmt hosts to send syslog to central syslog servers

6ff303df8c-+-mediawiki: Install php-dba in PHP 7

442726daf2-+-Convert elasticsearch to systemd unit

8bfa9a1e89-+-multiinstance.pp: Fix contact_group for multiinstance slaves

38cde50b6e-+-core.pp: Fix monitor_process and monitor_disk pages

5fbb5833c7-+-mariadb: Enable read_only monitoring on core mariadb hosts

1a101db918-+-mariadb: Get only active replicas to page for mysqld process number

90ccd8a144-+-Enable ferm for role::analytics_cluster::hadoop::client

d225b98cea-+-add mwmaint1002 to site.pp with spare role and IPv6

612268bc82-+-decom radium puppet repo entries

57ce222aab-+-decom radon

7f5a4b11b9-+-decom maps-test cluster in codfw

5e8fc9ed6e-+-firewall: add new eqiad1-r bastions for VM ssh access

abb333f287-+-pushing scandium into parsoid test service

0a0bd7025b-+-parsoid: role/profile refactoring

b8bb010983-+-toolforge k8s: allow access to eqiad1-r IPs.

ac3a3c1430-+-ores: add Server response header

5478b40428-+-Reinstate poolcounter2002 as a pool counter

46afdcd4dd-+-cache_misc: cleanup leftovers

4f56431197-+-wmcs pdns-recursor: comma-delimit reverse lookup zones

95cc128567-+-mediawiki_maintenance: reverse absent/present for inactive motd

0b6a2e2599-+-mediawiki_maintenance: remove mw_primary remnant

06f65f68dc-+-mediawiki_maintenance: add inactive warning in motd

b918c2917f-+-Add SNMP classes

1a60d04204-+-Add cumin2001 to network constants and tcpircbot

2c77acb491-+-cumin: fix puppetdb query

32e1d5b002-+-Whitelist cumin2001 for profile::mariadb::wmf_root_client

e671dd0650-+-Switch role for cumin2001 to role::cluster::management

e5d639b821-+-Remove cache_misc definitions

505db927fa-+-mediawiki::web::vhost: add upload rewrites conditional

012323d5bf-+-Remove Camus jobs and checks for cache::misc

afd6044c22-+-profile::analytics::reginery::job::data_purge: fix cron job

0b3dbb448d-+-WMCS puppetmasters:  Use 'network::constants::labs_networks' for firewalls

363e5c4d50-+-icinga: add notes_url parameter to NRPE monitor service

8ee35b963e-+-icinga/phabricator: only monitor https on a single (virtual) host

b7b6a47923-+-Add support for neutron ip range in puppet master standalone

75723eade4-+-varnishkafka/icinga: remove check for misc-web webrequests

5912b90260-+-tor_relay: add Bacula backups of Tor keys

54e3d5c2d3-+-icinga/phabricator: don't declare monitoring host as virtual resource

95bdf95da9-+-icinga/phabricator: move service check to a virtual host

857a9912f0-+-site: convert cache::misc hosts to spares

1c4b5e172b-+-mediawiki: Clean up php7 package list

c975d5cbc7-+-profile::analytics::database::meta: use the same prod config in labs

5fe627ec6b-+-quarry: Get rid of ::labs_debrepo

132ca4086f-+-quarry::database: Use class declaration for mariadb::packages

101bbadbd3-+-profile::analytics::database::meta: update mariadb's basedir for stretch

981994fd2e-+-profile::analytics::database::meta: upgrade mariadb version for labs

1c0789d368-+-profile::analytics::refinery::job::camus: add parameter to enable monitors

dde5d0089c-+-Horizon: set a default network ID for neutron VMs.

d0af1b3a08-+-mtail: restart on change to exim program

4d64a185aa-+-mariadb::service: remove old require causing issues on Stretch

df1dc5957e-+-ci: Allow Docker nodes to use a dedicated /var/lib/docker volume

925208a4fc-+-set cumin2001 isntall params

5593147074-+-maps: decommission maps-test cluster

9a55fa96da-+-Allow kafka updater to have options

b565b08892-+-Update refinery-job jar used for refine jobs

6dae38e422-+-Use properties file for RefineMonitor

a4abeb65b5-+-Elasticsearch shard size check

2705eea18d-+-quarry: Move the install into a venv and upgrade to Python 3

6fb1d2ac6a-+-icinga::performance: remind users to ignore checks using notes_url

0124476146-+-quarry::database: Use mariadb instead of mysql module

c71f904a05-+-Vary camus eventbus topic check based on active MW DC

efd84e6c16-+-monitoring: enable using notes_url with grafana_alert

9970db46cb-+-cp1099: add authdns::testns and ipv6

04a9f8ed6d-+-set policy.wikimedia.org check to LE threshholds

8ff7cbe091-+-Whitelist EventLogging schemas for ingestion into MySQL

5fe85c167d-+-Remove meitnerium (old archiva host) from puppet

6354569f22-+-cloudvps: nova-network: also distribute default route in dnsmasq

ca8bf1953f-+-netops::check: add 3 playbook links to Icinga checks

075596678a-+-icinga/ripeatlas: add playbook link as notes_url in Icinga checks

1506feb275-+-profile::analytics::refinery::job::camus: ease labs testing

a931dae0f2-+-Add python-geoip2 to stat machines

7188bc5453-+-Increase ATLAS probe unreachability threshold to 25

7b1d60c323-+-cloudvps: eqiad1: add compat network link with main deployment network

0662b12847-+-multiinstance.pp: Make multi-instance slaves page

78d5d56946-+-profile::analytics::refinery::job::data_purge: add systemd timer

63669b54cd-+-mariadb: Set pages for multi-instance hosts

abd13cbf53-+-labvirt1019/1020: rename to cloudvirt and move to eqiad1

f7feb1981a-+-icinga/planet: add notes_url param to planet https check

e97c4d9d63-+-authdns::server: use ::profile::base::firewall

91aef0a2a1-+-site: turn radium into a spare system

dbe9d7252f-+-Revert "tor_relay: temp allow rsync of datadir for migration"

df446cdb10-+-Gerrit: Add owner and group to "/var/lib/gerrit2/review_site/logs"

7f231e6c14-+-Gerrit: Remove duplicate /var/lib/gerrit2/review_site/logs

1f29cadea9-+-Gerrit: Move all logging to /var/log/gerrit

644f9e1474-+-tor: ensure libzstd1 is installed and required if on stretch

6675b907ed-+-site: add tor_relay role to torrelay1001

ab933abc02-+-profille::analytics::systemd_timer: improve monitoring

871031515a-+-profile::analytics::systemd_timer: add monitoring

4ee15348e9-+-Tendril: Renaming check about authorization required

7f6de0bebe-+-tendril: Add monitoring for authorization check

1532d7bb9d-+-tor: make it possible to config service running/stopped in Hiera

938c8b36e9-+-icinga: make the apache virtual host name configurable

9d0cd72a93-+-Deploy msearch daemon to cirrus servers

bf1aa1bc61-+-labstore: load monitoring should be based on number of processors

6f7ab2e3c9-+-labstore: fix priority on sysctl file

e29d5083dc-+-labstore: Change tcp buffer settings

73e6cf2267-+-m5 grants: replace designate password hash with a private lookup

15dac6a6b6-+-realm.pp: drop mw_primary

162fd97fa2-+-ATS: ship service file as a systemd override

a4ad428546-+-profile::mediawiki::maintenance: depend on mediawiki config, not hiera

604a7e301d-+-puppet_compiler: fix typo in manifest

a5a10238b7-+-Introduce orespoolcounter[12]00[12]

8ec08298eb-+-Decommission mw2213

851a4d8fab-+-conftool: add class for writing to state to file

a121a2d192-+-piwik: add support for stretch/PHP7

8218fab4ec-+-role::deployment_server: add mcrouter

6436d4f54e-+-site.pp: Clarify db2093 current usage status

758c1d9dcd-+-profile: use mariadb-client in stretch.

80c8e2d693-+-icinga::web: install libapache2-mod-php if on stretch

7fd3834503-+-site: apply alerting_host role on icinga1001

297243e3c2-+-profile::openstack::base::frontend: remove config-master

f1939eab75-+-profile::analytics::refinery::job::data_check: remove cron jobs

51ea22d40c-+-phabricator: set smtp-host to localhost

3b1c7181e5-+-spicerack: add redis sessions configuration

85a4139b5a-+-oozie: change smtp_host to localhost

5c53739a8f-+-nagios_common: use libmonitoring-plugin-perl on stretch

546aa18aa1-+-icinga: move Hiera calls to profile parameters

d7e7907ca2-+-icinga: rename role::icinga to profile::icinga

23017aa525-+-icinga: make service_ensure status configurable in Hiera

8b7c886bb4-+-ircecho: Tidy up file absent

b0d773f98b-+-ircecho: Move ib3_auth to better place

4f689fef6f-+-ircecho: Add support for authenticating with SASL

80ceecbd5a-+-iegreview: change smtp_host to localhost

d6c15bda4c-+-scap: upgrade to 3.8.5-1

a642ab8f33-+-ATS: pass hostname as an argument to default Lua scripts

4840cb45a7-+-Add health check for categories endpoint without lag check

8d1828d4d7-+-Do not default the hiera() deployment_server call

46f708fb0d-+-profile::analytics::refinery::job::data_check: add more timers

7d89e40c87-+-systemd::timer: add a comment about RandomizedDelaySec

fadb26e368-+-ores: add PoolCounter nodes settings

5ad8ac6e1e-+-profile::analytics::systemd_timer: explicitly set splay to undef

a9a45f96e7-+-designate: open up the mdns port firewall for all pdns hosts

1bafd35567-+-Add variables for map tile invalidation

cad3d4a421-+-profile::analytics::systemd_timer: fix require

5e3fea0650-+-profile::analytics::refinery::job::data_check: add systemd timer

48b917c453-+-Remove enable_microcode logic

4d741891fa-+-designate: install memcached for coordination backend

ee936a9085-+-mediawiki: Remove unneeded file decleration on wikidata maintenance script

86d88f76bb-+-Beta: remove npm from deployment master

f34361f3f7-+-backup::host: update comment on ::base::firewall

07fe4d214e-+-openstack eqiad1: Run dns_floating_ip_updater

732b21aebb-+-Add druid snapshot removal cron job

b5f920653a-+-Use jessie-backports version of haproxy

ef45d4e1ed-+-cloudvps: rabbitmq: monitoring user is administrator

5dfec53b09-+-wdqs: redirect stderr from cron jobs to log file

62aeaced19-+-cloudvps: rabbitmq: create monitoring user

ccefd7250c-+-profile::archiva: allow rsync to bind to IPv6 interfaces

839a5fde67-+-tor::relay: add configurable thirdparty APT source

2f514549ff-+-Gerrit: Add support for avatars url in apache

b16df3fbcc-+-Gerrit: Clone avatars repo into /var/www/gerrit-avatars

98e7747a22-+-wikimania_scholarships: change smtp_host to localhost

0a3f392caf-+-Add fluidsynth to wikimedia servers

68cfb65070-+-labstore: make nfsd threads configurable

bd7d61a724-+-cloudvps: nova-network: allow extra dnsmasq/dhcp option

cbd4ee4746-+-move huwiki, arwiki to 'bigwikis' for xml/sql dumps

d945ea54b8-+-Send blind thumbnail requests to inactive DC

dce856be63-+-profile::analytics::cluster::packages::statistics: add lynx

bbe202449d-+-rabbitmq: allow designate_host_standby to access rabbit

671d195df0-+-labstore: move the load numbers yet higher

ff3508e203-+-labstore: move the load numbers for our problem children up temporarily

c170dcb944-+-zuul: base::service_unit -> systemd::service

433d656f0a-+-labstore: Allow override for load monitoring

88a504080e-+-labstore: IPs on secondary interface should match drbd settings

74439482ce-+-keystone: open firewall to a fourth designate host

5c4fc9db4b-+-microsites::sitemaps: use 'recurse => true' to manage permissions

3278f3e76b-+-microsites::sitemaps: set sgid bit on sitemaps doc root

f30b4f7063-+-designate pdns: allow ipv6 access to mysql from other designate servers

02559590f9-+-cloud pdns on Jessie: use $::fqdn rather than $host for db_host

daa0a42992-+-Add fixcopyright.wikimedia.org

7229724a80-+-Openstack glance: make a /a symlink

190712ea73-+-Removing puppet entries for decom host silver

cbba5bf383-+-labstore: set labstore1004 as the new primary

29ec67bc6e-+-Deploy wikistats from master branch

f03584fc6d-+-Remove now unused turnilo, superset, hue, yarn puppetization from thorium

06cffc68df-+-Assign role::spare::system to meitnerium

0efe64fd7a-+-keyholder: add a \n to a content => line

e49fc0bc36-+-Move archiva.wikimedia.org from meitnerium to archiva1001

f8d3f253cf-+-tor_relay: temp allow rsync of datadir for migration

402ffb190e-+-netbox: move IP addresses from class to Hiera

83766cc882-+-Install ipython on all analytics nodes

728d1cca5c-+-prometheus: alert on unusual day-over-day logstash ingestion rate change

f5475e0fab-+-cloudvps: labtestn: add network link with labtest deployment network

72262caa37-+-graphite: use keepLastValue for thumbs drift alert

69ce904a0b-+-cloudvps: eqiad1: move nova DBs to m5-master

a5e6b33225-+-spicerack: fine tune permission for config file

e6f5527c23-+-Add LingoCloud MT config

29bcd60c10-+-spicerack, cookbooks: install and configure

d690a85a53-+-diamond: send metrics to graphite1004

6094654800-+-graphite: alert when eqiad and codfw drift in number of thumbnails

5c462cc978-+-Add loadCategoriesDaily.sh script

fea4a6eaf0-+-toolserver_legacy: apache -> httpd module

a1a93a5ae0-+-exim: Permit DKIM domain to be changed by hiera

50ae3b3ae7-+-Add comment about Jessie deps in Stretch for Hue

7cdf22c820-+-Per DC alerting on sudden traffic drop

fc038a2de1-+-Move daily dump load - last one finished at 5:58

81593850fd-+-cloudvps: labtestn: allow keystone IPv6 connections from labtest

46ed1617ad-+-noc: Also allow cumin masters to access site

8ec95c7921-+-Update links to github repos of scoring platform team

f27f4422dc-+-Switch services to MW connection to https.

967187791d-+-logstash: fix default plugin_id name for elasticsearch

30a8b8d2a7-+-logstash: add plugin_id to outputs

61f903268a-+-piwik: update notify apache dependencies

ed4d86a2e2-+-piwik: convert apache to httpd module

13eb0d436b-+-Neutron: Make services subscribe to their config files

565e87d393-+-kubernetes: Dumping --require-kubeconfig, make it param

0e80f9fe73-+-wikilabels: install postgresql package as well

19334981ba-+-wikilabels: Add zlib1g-dev package and cronjob to remove expired tasks

23be33a011-+-archiva::proxy: fix tls cert names according to letsencrypt::cert::integrated

9b5543d03f-+-prometheus: Job definition for trafficserver_exporter

981d9751c1-+-profile::archiva::proxy: allow the use of a different domain/tls-cert

6d990e4be4-+-archiva::proxy: use certificate_name rather than only 'archiva'

3c70991f36-+-pt-heartbeat class for Beta Cluster

f9174ebaa0-+-deployment-prep: Make LVS config compatible with new requirements

def6398069-+-Include hue on analytics-tool1001

cfb14ddcf0-+-postgresql::slave::monitoring: make check description configurable

82db0191e2-+-Rename profile::hadoop::sites::yarn to profile::hadoop::yarn_proxy

962e42d0ea-+-quarry: add Hiera lookups for clone_path to profiles

c4d1658f4d-+-quarry: fix clone_path inclusion in celeryrunner/web template

689f43c331-+-Need mod_headers for yarn proxy

5a19eba6c1-+-Include yarn.wikimedia.org proxy vhost on analytics-tool1001

f9ed1439fa-+-quarry: fix changed class name in celeryrunner

2ca527957e-+-quarry: update include of querykiller in killer class

304c8ecf97-+-quarry: convert remaining module to profile, update includes

49b66e2ce8-+-quarry::redis: convert to profile

342cd56c43-+-quarry::base: convert to a profile

872b9a0457-+-Install libmariadbclient18 for mysql databse for superset in stretch

0a29f0e9c1-+-Puppet: rename cr1-eqdfw to cr2-eqdfw

8d3fa128a9-+-Include base firewall and standard in role::analytics_cluster::superset

2364065364-+-Include superset on analytics-tool1003

b32be53a89-+-quarry::web: replace class declaration with require for base

ffb3a2dc81-+-quarry::web: convert to profile

c75b07985c-+-quarry::database: convert to profile

5c2f1b987f-+-graphite: double quotes for carbonate.conf content

b84b2d5926-+-Create auth ldap proxy for turnilo on analytics-tool1002

67bc6181fe-+-Make elasticsearch http and transport ports explicit

13eb460aba-+-profile::archiva: add comment about rsync's firewall settings

460a859e8d-+-Remove support for elasticsearch 2.x

9e296f3624-+-Drop obsolete removal of timidity-daemon

a472de0ae7-+-Switch elasticsearch to use tlsproxy module

f658798d21-+-prometheus: add trafficserver_exporter

fbd9e708fc-+-PHP: create module for modern Debian-based distributions

dc65630092-+-netbox: fix psql client auth for monitoring check

2eb192e83e-+-Revert "releases: set owner of wikidiff2 releases back to mediawiki"

0a6e769308-+-graphite: install dummy carbonate.conf

326974383c-+-releases: set owner of wikidiff2 releases back to mediawiki

67e8c40059-+-Split releasers-wikidiff2 from releasers-mediawiki

53609e8a15-+-Include turnilo on analytics-tool1002

7d14fd1f7f-+-site.pp: add a note about archiva1001's status

5bf61d4b38-+-Inline mediawiki::packages::tex

af4759b755-+-Remove jessie-specific code from mediawiki::packages::tex, cleanups

d1376e8eee-+-mediawiki: make rebuildTermSqlIndex.log absent

1f4a6b9991-+-profile::archiva::proxy: fix ferm srange

a1138c3a98-+-Assign role::archiva to archiva1001

4386785678-+-Inline mediawiki::packages::math

324b3d8417-+-Remove Jessie-specific Puppet code from Mediawiki math class

03f7686cea-+-contint: don't include mw::packages, use contint::packages::mediawiki

b3fa434fff-+-profile::archiva::proxy: add monitoring_enabled parameter

c85ac5b517-+-mydumper: Require python3-pymysql to store backup statistics

9d39a5eb7b-+-profile::archiva::proxy: protect first run with firewall rules

806ba1b434-+-cumin: add alias consistency checker

736603d44a-+-mariadb::packages: Unversion server and client

4a66ef3377-+-mariadb: Promote es1015 to be the new es2 master instead of es1011

86c61cfa55-+-graphite: delete duplicate role(graphite::primary)

9226d8057c-+-Revert "puppetdb: add postgres backup to bacula"

7c8a1d8ca0-+-puppetdb: add postgres backup to bacula

a7e6a5f0cf-+-icinga1001 install params

69ff21ee19-+-dnsrecursor: use ::profile::base::firewall

16fb464447-+-tendril: move httpd out of module to profile

1bd3ed4068-+-adding scandium install params

b1c662a48f-+-wikistats(VPS): jessie/stretch support for php module

81ed04e530-+-wikistats(vps): convert apache to httpd module

c5a90ffad5-+-Remove stray swift backend servers from site.pp

fe2ee3b681-+-Sum eventlogging throughput rate when computing quantiles for alerts

157473dc78-+-replace a couple http links with https where possible

201273d66b-+-Add new cx translation reportupdater job

1bcf4c3280-+-Remove stray cp4 hosts from site.pp

f13c1f9fa9-+-ATS: add caching rules support

b88e0716d8-+-wmf-decommission-host: initial version

22ba785e84-+-Remove californium

d14905d612-+-Enable intel-microcode for all bare metal servers with an Intel CPU

4108a001c1-+-add analytics-tools1001[123] to site with spare role

61ebc3a886-+-mail::mx: use ::profile::base::firewall

f48c8e8b21-+-restbase: use ::profile::base::firewall

852e790c69-+-Add ability to load daily category dumps.

a71f253931-+-nova: limit metadata workers

e33b01fd8d-+-Fix librdkafka backports pin for eventlogging

521f358f67-+-Use newer librdkafka for eventlogging

5eedc4a2c1-+-nova: Limit number of worker processes

b8a9f7dc71-+-keystone: fix error in the service file

71cf11a63b-+-keystone: Limiting worker process numbers

99fdea9807-+-keystone: limit the size of the connection pool so it reuses connections

bba67aa4ba-+-Keystone: Include ldap config on eqiad1 keystone hosts

94a8da7b89-+-db backup statistics: Initial implementation of the backup stats

77c37a4899-+-cloudvps: eqiad1: move neutron db to m5-master

e193399d90-+-Openstack: added script to migrate security groups from eqiad to eqiad1

b1a159767f-+-wmcs pdns-recursor: support a list of reverse-lookup zones

c08cb3aa16-+-toollabs: use ::profile::base::firewall

0985cffc34-+-labs: use ::profile::base::firewall

ce4e6a8764-+-wmcs puppetmasters: another ferm fix to allow puppet cert cleaning from eqiad1

36b04a1aa1-+-ATS: storage configuration

ce605987bb-+-Enable logstash for mjolnir

ac6edc14db-+-releases/mediawiki: proper Icinga monitoring for both Apache vhosts

f1f30ec84a-+-Neutron policy changes:

32ca2f8d97-+-webperf: silence output of curl in cron job

9546e4a2c9-+-memcached: use ::profile::base::firewall

477a379136-+-apache: Remove unused apache::static_site type

80f4ea7a30-+-labstore and systemd: Change timer dependency to unit instead of service

c0d2a24a8b-+-Ensure coal-web caches are warm via a bi-hourly cron job

d38f9ac5da-+-Declare /var/cache/coal_web

0cac15fc47-+-Revert "labstore: trying to make dependency issues work"

e03d4369fb-+-labstore: trying to make dependency issues work

b447209d11-+-labstore: Change backup cron to a systemd timer

05051de30b-+-mediawiki::web::prod_sites: move the other private wikis to the define

42424da779-+-Revert "labstore: Change backup cron to a systemd timer"

9876d4af35-+-labstore: Change backup cron to a systemd timer

3924505ffe-+-Tweak fragmentation memory limits

2bbc412dde-+-site: Reimage radon as stretch spare system

80293324e1-+-authdns: Remove radon from the authdns host list

c206648c72-+-mariadb ferm: allow the new cloudservices boxes access to the db

0211563307-+-dbproxy host installations

b2e1f26964-+-Remove unused 'glance' profile for main deploy.

579d45aec9-+-Exclude readme.html from being deleted during dumps::web::fetches::stats jobs

c277bdc526-+-Openstack glance: remove glance service from labcontrol1001

46300b9202-+-openstack glance: move active service for eqiad1 and main to cloudcontrol1003

908cdecc76-+-ATS: add Lua scripting support

491df6abe5-+-Changing day of the cron for testing

3bd4f60ca5-+-logstash: use /etc/default/logstash to add jmx_exporter

2273300b0c-+-Add salt file path to EventLoggingSanitization cron job

8f7ea5623b-+-Remove all geowiki puppetization except for the geowiki site

a9706438ae-+-Designate: use $keystone_host for keystone rather than $nova_controller

aa135fd3a6-+-webperf: Switch webperf::site to use arclamp from webperf-2

ee62f7c608-+-webperf: Add arclamp profile to webperf::profiling_tools role

68bc11f532-+-webperf: Split Redis from the rest of the arclamp profile

b4b3a66fc6-+-elasticsearch: shards check should not page.

ac967a6bd2-+-cumin: add region_name to the WMCS openstack config

ee3a251ebb-+-graphite::carbon_c_relay: base::service_unit -> systemd::service

e2731bf6a5-+-graphite: mirror metric traffic to graphite1004

e7308a73d3-+-graphite: fix graphite-manage stretch command

1dd470950b-+-Assign graphite1004 its role

a077219d7b-+-Provide logstash host/port appropriately in analytics elasticsearch profile

d6ef441a25-+-logstash: add 'id' to inputs configuration

3ff7749b36-+-Beta: remove deployment-{tin,mira}

a2d0eef4dc-+-Enable check email reporting for camus jobs

bac49421da-+-Add parameters for camus::job to pass to CamusPartitionChecker

72f622aba7-+-nova-fullstack: specify region from hiera

86d33185d0-+-Removing puppet entries decom host lawrencium

734ede1bbf-+-cloud vps: main: restore envscripts and adminscripts

ceb3dd909a-+-Pass keystone_host to profile::openstack::main::nova::common

d7e98db2ee-+-Removing db1052 from site.pp final decommission

e5cff578b9-+-Add cron job to create and rotate EventLogging salts

0f82900bdf-+-keystone: pass the actual keystone host to openstack::util::envscripts

630440fc9d-+-mediawiki::web::vhost: add ServerAlias support

45338573f9-+-mediawiki::web::vhost: add the domain_suffix variable

99e245674b-+-cloudvps: use keytone_host instead of nova_controller

ed53b2fd3d-+-cloudvps: merge main/eqiad1 keystone services

7a59fed265-+-ATS: move verify_config to ExecReload

5577e548a2-+-phabricator/otrs: use cache::text::nodes for mod_remoteip

9c30e73fbf-+-profile::docker::registry: whitelist cache_text nodes

36005aaae2-+-hafnium decom

5ce1514d92-+-decom labtestnet2001

bd459f9083-+-Use Kafka jumbo-eqiad cluster for eventlogging consumer mysql eventbus

94a078e72c-+-cloudvps: keystone: allow IPv6 connections from foreign services

e38e4f9083-+-sitemaps.wikimedia.org: new generic microsite

4ef396c920-+-caches: set numa_networking by default

f1fe9b7a69-+-ATS: allow to specify outbound TLS connection settings

19f4e89851-+-eventlogging/kafka::analytics: use ::profile::base::firewall

b860d20536-+-decom of hydrogen/chromium

8081959241-+-eventbus: use ::profile::base::firewall

5b8a78cde7-+-mjolnir - Vary libsnappy package on  debian version

83dd8dd403-+-Install libsnappy to mjolnir daemon hosts

72aec76bff-+-squid3: use separate files for logrotate snippets, squid vs squid3

49765a7905-+-Add mjolnir kafka daemon to primary elasticsearch clusters

3e51c72141-+-url_downloader/squid3: Work on stretch

a2171d335e-+-toollabs::proxy: Fix logo_height

788300443f-+-cacheproxy: reduce fq flow limit 1Gbps -> 256Mbps

e28fed8fbd-+-ATS clusters: set IPv6 addresses

7f1db309ba-+-Deploy ATS backends on eqiad test hosts

547dd378a6-+-Deploy ATS backends on remaining codfw test hosts

29926ad9d5-+-Deploy ATS backend on cp2003

a96af7ef12-+-trafficserver: initial module/profile/role

6fec962d63-+-postgres::master: use ::profile::base::firewall

44c09b7658-+-netbox: don't hardcode db_master, use active_server from Hiera

4b37c435d5-+-netbox: make the role usable on a stand-alone host again

5d043016c0-+-xdummy: base::service_unit -> systemd::service

8e9f96832f-+-prometheus: add logstash exporter and gather logstash metrics

09ce9fcc35-+-site: Reinstall chromium and hydrogen as spare systems

1ac5bbb889-+-Spare out the unused eqiad caches for future decom

fbce92b14d-+-wikireplicas: Monitor wikireplicas are always in read only

e2d920327e-+-toolforge: Document inclusion of texlive-full package

7dada4c0d6-+-webperf: Rename role::xenon to profile::webperf::xenon

b63321f35c-+-webperf: Rename webperf profiles for clarity

5ad661293b-+-prometheus: add logstash jmx_exporter job

8f23d62808-+-logstash: add jmx_exporter

3c03535396-+-eqiad1 pdns: specify an ip for the pdns database

dc3745fcb9-+-setup new rdb10(09|10).eqiad.wmnet

1be6d67111-+-Added profile::openstack::eqiad1::cloudrepo

85b6d686bc-+-designate: set up cloudservices profiles for eqiad1

f91d3eb7b8-+-Rename labnodepool1002 to cloudservices1003

d70ada9137-+-torrelay1001 install params

e5797bbaeb-+-cloudvirt102[34] install params

3a8dbf03a8-+-Declare and manage a /var/cache/coal_web dir

c75fa628f8-+-logstash: don't restart daily

dd51b232b5-+-mediawiki: serve small private wikis with mediawiki::web::vhost

0066b48355-+-standard: Remove chromium and hydrogen from ntp peer list

8cd548f2b7-+-site.pp: remove def for labvirt1021 and 1022

732d98ba60-+-logstash: brown paperbag fix

8df633bebc-+-authdns: pin gdnsd to stretch-backports on stretch

d37179d669-+-authdns1001: add to nameservers data set

548d535db3-+-cloud vps: disable labtestnet2001 and replace it with labtestnet2003

4964b2940c-+-elasticsearch: ensure that apt is refreshed before installing elasticsearch

4ce3d82e27-+-mariadb: Setup db1095 and db1102 as db backup sources for eqiad

9570b7dc4b-+-mediawiki_test: remove mediawiki_exp module

002eec1abd-+-standard: add dns100[12] to eqiad ntp peer list

b677ad6849-+-role::mediawiki::webserver: switch back mediawiki_test

cf0709478a-+-designate: allow API access from the keystone host

dc881b4d4e-+-labs-ip-alias-dump: Update to work with pdns-recursor v4.x

da1756f993-+-decom bast1001

06e4457944-+-gridengine: remove variables that were for deleted template

b1998dd82c-+-wikilabels: Enforce SSL

af34542982-+-mediawiki: add vhost define

13bae9b651-+-gridengine: remove puppetized hosts file

7a5d7e1682-+-logstash: bump udp loss thresholds

e9c143705f-+-mediawiki: prepare the transition for the main sites

ede278f0b2-+-logstash: enable GC logs

3136b159f8-+-mediawiki: convert remnant.conf to use one file per vhost

29176f0dfa-+-toolforge: add texlive-full package

7aa56e41db-+-logstash: daily bandaid restart

fa8b108201-+-logstash: alert on udp loss ratio

83b074cfb0-+-postgresql::backup: don't run both crons at same minute

775dfee3f1-+-setting dns100[12] install params

eb867f5e8a-+-centrallog1001 install parameters

ec22816ec8-+-postgresql::backup: remove all quotes to still fix cron spam

817b1b2a6a-+-setting graphite1004 install params

6cea701a1e-+-osmdb: Change labsdb1007 back to slave and reimage as stretch

2a7444c67b-+-jenkins: add workspacesDir system property

07a6d1ca93-+-Allow PuppetDB use on standalone puppetmasters

98088dcb51-+-new auth1002 server install params

f6ad2b5306-+-assign archiva1001 spare::system role

f1db9c55c3-+-mariadb: Force as read only dbstore_multiinstance and sanitarium_m.i.

78f4c0f4fb-+-mariadb: Introduce a read_only check for multiinstance hosts

fbf33954f6-+-logstash: default workers to processorcount

f98ba4c292-+-logstash: default to 4MB receive buffer

73db8ed845-+-Beta: deployment-deploy02 is deployment host

d91325c25d-+-elasticsearch: use ::profile::base::firewall

a562911150-+-adding authdns1001 install params

c3f3910f8f-+-setup of cloudelastic100[1-4].wikimedia.org

bee4f92198-+-etcd: use ::profile::base::firewall

141a61cf84-+-posgresql::backup: fix "Unterminated quoted string" in cron tab

764e5cc47c-+-base check_disk_options: exclude /srv/nvme mounts

2626c67819-+-wmcs eqiad1: set up glance syncing within the eqiad1 glance hosts

eb515f3964-+-mediawiki::web::prod_sites: convert wikimedia.conf, wikimania.conf

61dc1e29e6-+-cp1075-99: add to hieradata, conftool-data, acls

8fdf5b98e8-+-phabricator: Use the mysql native driver

80149cdc62-+-ci: Put Blubber back on Docker integration agents

0b47cb2f7e-+-webperf: Move site vars to profile class params (set from Hiera)

99e134d4d1-+-archiva::proxy: include acme config only when needed

d226ba6477-+-mediawiki: use compile_redirects as a function

4dd7c31949-+-profile::archiva: move proxy settings to a different profile

ac1997a5a0-+-prometheus: fix udp loss alert

9c3ffcd4e7-+-mediawiki::web::site: backport changes from mediawiki_exp

69a8236ddc-+-logstash: alert on udp packet loss

a7a21b18c8-+-profile::archiva: depend on default-jdk

6e09597c74-+-Set up cron task to regen low-zoom vector tiles

a52f1a5058-+-cp nodes: use newer mke2fs on all stretch installs

bbc530b180-+-cp1075-99: further mkfs tweaks

e7ff0731fe-+-decom notebook1001 entries

87082911ea-+-cp to cp ipsec MTU set to 1450 for all cp servers

bb2258e5cb-+-labweb ferm: one last pair of parentheses

35792619ec-+-labweb ferm: second attempt at getting the @resolve syntax right

5ae6f4e2a8-+-labweb: add some AAAA ferm rules for labweb access

1be7b77ac3-+-postgresql::backup: fix "EOF in backquote substitution"

f9ab116071-+-wmcs pdns: exclude metal resolver on all non-main deploys

f89fcd1075-+-cp to cp ipsec MTU change everywhere except eqiad

5c79879733-+-Generate daily diffs for categories RDF

9392528383-+-jenkins: base::service_unit -> systemd::service

43e9d978be-+-Extend cp to cp ipsec MTU 1450 to codfw

b78632b7b0-+-Revert "Extend cp to cp ipsec MTU 1450 to codfw"

f68db57a1e-+-Extend cp to cp ipsec MTU 1450 to codfw

4ead373103-+-multiinstance.pp: Page based on the number of processess

0ed6295ad3-+-profile::dumps::generation::worker::common: add mcrouter

0e04df39ac-+-Refactor Hadoop code to allow more than one cluster in Prod

26dd3a835d-+-mariadb: Set db1052 to spare

6f4da0f402-+-profile::mediawiki::hhvm: enable TC garbage collection everywhere

552197d955-+-profile::mediawiki::hhvm: add auto_prepend_file everywhere

ef24cc3c6c-+-ores::redis: use ::profile::base::firewall

f5e4a7ad4c-+-Beta: Make deployment-deploy01 main deploy server

8eb8343c01-+-mediawiki::php: Remove support for PHP 5

a876d2a3c6-+-webperf: Set mpm=prefork explicitly for profiling_tools' httpd

badaba00b6-+-syslog::centralserver: use ::profile::base::firewall

8ad3e02214-+-decom poolcounter1002

8926f23d50-+-cache::canary/pybaltest: use ::profile::base::firewall

013715049e-+-aqs/poolcounter:: use ::profile::base::firewall

691f9a468a-+-parsoid/thumbor::mediawiki: use ::profile::base::firewall

29bebea055-+-bacula/postgresql: add a generic fileset for psql

8b04cbaf92-+-terbium decom

58c9ade244-+-Set up cron task to regen low-zoom vector tiles

7e5d453db3-+-failoid/configcluster:: use ::profile::base::firewall

dd3ff10d75-+-mariadb: Make misc multiinstance read only always

684d6e69a8-+-Drop query_clicks partitions after 90 days

9d45152734-+-Create prometheus::resource_config

8dbabbe636-+-Fix typo in postgresql::backup (2)

37598a6332-+-Fix typo in postgresql::backup

3427d16a75-+-dbproxy-master: Fix hieradata reference typo

b913fe3e36-+-haproxy: Fix bug on /run directory creation

a5219bf4f0-+-postgresql::backups: fix typo and amend usage notes

51c3dfe898-+-netbox: add psql backups

1c4ff1427a-+-ip -6 route show, don't try to find the IP, but keyword instead

7507790222-+-webperf: Move require_package for PHP from role to XHGui profile

a55d57b3cd-+-Add static routes with MTU 1450 to ipsec destinations

6594cc9a38-+-dbtree: update comments regarding required Apache

97de784d08-+-postgresql: add class to create db backups

a1315e42e8-+-Remove mediawiki::packages::php5

c4946bddc6-+-puppetmaster: use ::profile::base::firewall

9385b27e6c-+-jobqueue_redis: use ::profile::base::firewall

f7dcb27bb4-+-docker::registry: use ::profile::base::firewall

9b3270d8bd-+-avoid data=writeback on nvme formatted w/o journal

07c00b79a9-+-sca/scb: use ::profile::base::firewall

40cdc983c5-+-Revert "optimized mke2fs for stretch cp installs"

d2f1238b4a-+-cluster::management: use ::profile::base::firewall

b4f165e544-+-labtestn designate memcached: firewall fixes

554e6468a1-+-Move memcached from labtest to labtestn

339a1adbff-+-Remove conditionals for jessie in mediawiki_maintenance profile

934acfe971-+-mariadb: Test MariaDB 10.3 on db1118 (core test host)

67353d14b5-+-Designate: ipv6 access for memcached

19aba14019-+-cp1075-99: define storage size

d052a84e09-+-optimized mke2fs for stretch cp installs

e7b7d1a233-+-Designate: install memcached on labtest designate host

4d410745c2-+-Decommission terbium

bed99e7dc6-+-cacheproxy: enable scsi_mod.use_blk_mq

e4be429cb2-+-grafana-admin: Remove from production

26be1206a7-+-grafana: Allow skipping instantiation of grafana-admin

2591afa2cc-+-Front Thumbor instances with Haproxy

d0e4e8f8d2-+-varnishkafka: pin librdkafka1 package to stretch-backports on stretch

3ef58942c1-+-Split per-cluster config out of elasticsearch::curator

095685a8ed-+-Make cirrus specific elasticsearch profile

dfe4a14d72-+-mariadb: Fix mwdeploy user on tendril/dbtree

ea54b09660-+-Split elasticsearch::log::hot_threads into two pieces

5c7fc53325-+-Delete unused code in elasticsearch module

831afa1516-+-dbtree: move dbtree outside of mwmaint hosts

04bb711857-+-move hewiki to 'big wikis' list for xml/sql dumps

54299418af-+-simplestatic: apache -> httpd module

499a256db8-+-simplelap: ensure apache php module is installed

763486e15e-+-proton: use ::profile::base::firewall

7017b1c826-+-labtest: yet more ipv6 ferm fixes

fa356b8bc8-+-simplelap: apache -> httpd module

682001e53d-+-Added some much-needed parentheses to a ferm rule

d24bfd2e96-+-Allow labtestservices boxes to access the labtestcontrol db via ipv6

6c74ed680a-+-rabbitmq: allow access to designate via ipv6

8de2611bd5-+-sentry: base::service_unit -> systemd::service

c5586ca21d-+-network::constants: remove terbium.eqiad.wmnet

068e5cbe50-+-mw::maint: allow home dir rsync between mwmaint, not terbium

1d69669554-+-mediawiki::maintenance: stop including php5 packages on jessie

38f84f442b-+-wdqs: fix ensure of reload categories cron

0059abd30c-+-wdqs: disable categories reload

8badaea670-+-swift: use ::profile::base::firewall

37f4d02112-+-wdqs/labs: use ::profile::base::firewall

2148f30c88-+-prometheus: use ::profile::base::firewall

e9a759555d-+-role::archiva: move to profile

36f1e10908-+-cp1075-90: define in site.pp

3a11bc36ac-+-cp1075-90: cache storage parameterization

f48efdd9af-+-cp/lvs: add bnxt_en support in NIC tuning stuff

4847d0ef88-+-tendril: use ::profile::base::firewall

b57e8f5dd5-+-Update nova controller ferm rules for ipv6

de2bf24c0f-+-add ipv6 to nova controller nodes

c3791d81fc-+-phabricator/mariadb: Update database configuration for stretch/10.1

3d7211f69a-+-osm: Populate the osmupdater user

5967610ff1-+-EventStreams: Use the default log level (warn)

f68cd488da-+-p::cache::base: fix storage_parts typo

9ee85974c9-+-osm: use ::profile::base::firewall

68621a2fcc-+-debug_proxy: use ::profile::base::firewall

1986f29576-+-deployment_server: use ::profile::base::firewall

9273bdfe61-+-backup: use ::profile::base::firewall

8f2672fb5f-+-yubiauth: use ::profile::base::firewall

d3fbf247f7-+-maps/vectortiles_master: use ::profile::base::firewall

5578ff1d00-+-discovery: use ::profile::base::firewall (comments only)

05d262113d-+-grafana: use ::profile::base::firewall

ac44d2d2e2-+-maps: use ::profile::base::firewall

3db794ee5b-+-Verbose logging for wikidata dispatching

a62082e364-+-package_builder: install haveged

f043a0c461-+-wmcs puppet enc api: add ipv6 firewall rules

668fe2f4ac-+-Add ipv6 IPs to labservices boxes

fa90383d31-+-mediawiki_maintenance: use ::profile::base::firewall

284219a257-+-wmcs puppetmaster: allow second region designate to talk to the enc API

2aa063aa59-+-phabricator: Make phd.taskmasters configurable with hiera

09807301c1-+-network::monitor: use ::profile::base::firewall

773d373316-+-gridengine: switch back to extended locales for debian

048384efee-+-varnishkafka drerr monitoring: Fix duplicate descriptions in icinga

98359d13b6-+-designate: pass region to wmf_sink

cf1afa9621-+-wdqs: don't load kafka config if we're not using kafka

58fa8f793e-+-gridengine: correct a few issues with stretch exec packages

7b10deb371-+-planet: drop feed templates for planet-venus/jessie

f44a6e69f7-+-mariadb: Add db1120 to x1

a93e28ebe7-+-profile::hadoop::common: add ':' to hadoop trash parameters

b96e67bc1b-+-RESTBase: Add Proton's URI

c64eb1dccd-+-mariadb: Promote es1017 as the master of es3-eqiad (instead of es1014)

b2a77683d4-+-netbox: define a new Bacula fileset and apply it

0ae7930495-+-netbox: have Bacula backups of netbox hosts

47b96bdb58-+-decom dataset1001 & ms1001

f5609bb362-+-gridengine: just a couple more changes to work with stretch

2bcb1f21e5-+-gridengine: some more exec node package cleanup for stretch

91a8748f19-+-gridengine: try to translate all the Ubuntu package calls to Debian

d68d57865c-+-Enable fetching constraints for Updater

e750d40e23-+-cache_text: disable all alternate domains

473ab617ec-+-Restrict cloud dns recursors to $LABS_NETWORKS

fb2e6e6759-+-Revert "Revert "cache_text: add support for alternate_domains""

cfead0e981-+-syslog: add systemd.mtail

7f2f80fb9d-+-profile::kafka::broker: raise default max open files to 128k

85e63162ac-+-labservices: allow pdns database to talk to second_region designate

96ef2355ef-+-decom mw2017 and mw2099

10310e2280-+-gridengine: Add package information for stretch exec nodes

6fc41b48b2-+-labtestn: no longer assume labtest and labtestn use the same designate

0cc1766fc5-+-designate: allow second_region_designate_host to talk to keystone

4d85db8795-+-labservices: help pdns talk to the local database

e579ae31f5-+-generate and email a few dump-related stats each month

004be23650-+-decom db1060

22b91fac3c-+-decom of db1056

bb94f3bf05-+-decom of db1055

6d44d9ae22-+-cloudvps: rename labnet1003.wikimedia.org to cloudnet1003.wikimedia.org

48f89245bc-+-cloudvps: ignore stderr in labs-ip-alias-dump.py

7954de4b94-+-site.pp: Specify db1120 future location

768e8da44a-+-Remove ipsec from kafka jumbo nodes

c3c1c2526d-+-wmcs puppetmasters: pass in second_region_designate_host

5ca73a5c93-+-Collect slowest revision history content dump runs

f2f976ceda-+-jenkins: escape $ in tokens before passing to systemd

a92249ea54-+-Keystone: more second_region_designate_host things

f26eeec6b7-+-decom db1053

a3d9612c24-+-Collect run times for certain dump steps on the big wikis

f6e424b2d8-+-jenkins: add buildsDir system property

d2c6e96fb0-+-decom of tin

0231e239bc-+-decom of snapshot1001

9242be3092-+-cumin: explicitely require clustershell

0c516aba83-+-labtest: add some needed parentheses for a ferm list

292c3ea9a8-+-labtest: allow second_region_designate to access the database

5dab935c00-+-mariadb: Productionize db1095 and db1102 into test-s1

014944ef54-+-wikitech: remove libvips-tools as it is now on all app servers

eb848140be-+-Cumin masters in prod: upgrade to python3

8ca400cab0-+-network::constants: define all caches, not only cache_misc

b7a6a56b35-+-cumin: pin also python3-urllib3 for WMCS

fbd00826e6-+-contint: libvips-tool is provided by mediawiki::packages

8a374b0206-+-Cumin masters in WMCS: upgrade to python3

dad04b5518-+-Switch mediawiki::packages to require_package

796609e95f-+-Install libvips-tools on mw app servers

9be45289be-+-phab: changes to files in redirector.pp should restart apache

699ebcb24b-+-labtestn: use the same DB as labtest for designate

8c74971c39-+-designate: install packages from jessie-backports on Jessie

1a052097d6-+-labtestn: various puppet/hiera things for dns

513700c472-+-Add profile::openstack::labtestn::cloudrepo

2bdabe9d3f-+-labtestn: make the services node more like a normal services node

36aedb2be5-+-labtestn: pass keystone_host to designate profile

461d62ce01-+-Blacklist cdrom kernel module

d1ca44b5aa-+-cloudvps: reimage/rename labnet1004 to cloudnet1004

03e74fd08c-+-cloudvps: labtest: only have one active net node at a time

134f2454db-+-add snapshot1005 back to mediawiki scap targets

d236bd63d7-+-Add phabricator-antivandalism extension to the library path

f54cc04017-+-mariadb: Promote db1067 to s1 master

0847c9dd8e-+-foundationwiki rename: fixup trivial refs across puppet

85e144424c-+-Revert "cloud vps: disable labtestnet2001 and replace it with labtestnet2003"

4a71d2a889-+-Move foundationwiki to priority 8 before *.wikimedia.org catch all

4233332540-+-debmonitor: fix permissions for config file

48775b5946-+-debmonitor: set proxy hosts

622b9e2fc0-+-debmonitor: set up maintenance

3619653dc9-+-cloud vps: reimage/rename labcontrol1004 to cloudcontrol1004

7fcb19bf0e-+-cloud vps: labtestn: allow more connections from labtest

61991a71da-+-Revert "cloud vps: labtest: missing allowed connection"

aa0915fff7-+-cloud vps: labtest: missing allowed connection

02085893e4-+-Add global git http[s].proxy config for thorium and an1003

9f06d5323c-+-cloud vps: disable labtestnet2001 and replace it with labtestnet2003

4ca27c8648-+-labtestn: don't include 'cloudrepo' on services box

192064b0fd-+-labtestn: install designate on labtestservices2002

2471760c4d-+-base: alert on filesystem available greater than filesystem size

350bd33053-+-Puppetise script to add firmware to netinst image

60c4fe5d37-+-conftool: switch to install python 3 version by default

b151d6fc8c-+-grafana: Remove varnish-http-errors dashboard

cec738047d-+-decom db1054 from repo

9cf681c0a0-+-d1051 decom from repo

423a794340-+-Horizon: support multiple regions

a4e3d1414c-+-profile::analytics::cluster::gitconfig: fix previous pebkac

a81734c344-+-profile::analytics::gitconfig: use system level configuration for git

66d284da78-+-cloudvps: reimage+rename labnet1003 as cloudnet1003

f5c2d8de96-+-openstack: neutron: make agents heartbeats configurable

84f2c5b9d3-+-mediawiki_test: complete the transition to one wiki per template.

4338881df6-+-mediawiki_test: split wikimania.conf

c2300f6517-+-mariadb: Add prometheus monitoring to labcontrol1003

1e37c9fbe8-+-role::kafka::main: raise Kafka Java Xmx/Xms

420836d91b-+-decom db1059

28b78985d3-+-Revert "Suppress false alerts in sqoop mediawiki tables"

24fd0aab05-+-openstack: neutron metadata agent: add support for jessie/mitaka

ce84e571e7-+-mediawiki_test: brown paper back fix

e9cc13cf0d-+-mediawiki_test: fix typo

f509a9cae7-+-mediawiki: split all of remnant.conf into individual vhosts

e1af91f65b-+-Suppress false alerts in sqoop mediawiki tables

14c0e932ba-+-Reimage wasat with stretch and rename to mwmaint2001

19309746c6-+-wmf-auto-reimage: improve donwtime of reimaged host

9b9966032f-+-Correct white-list path for EventLogging sanitization in Hive

978ea38c50-+-deployment-prep: Update wikimail_smarthost

683e8a409f-+-Revert "prometheus: tools: scrape paws metrics into prometheus"

8444dd3e1a-+-realm: add regexes for detecting the new Neutron cloud VM IP ranges.

cf32f4555f-+-prometheus: timeout for jmx_kafka job at 45s

46b444fce8-+-prometheus: bump scrape_timeout for kafka jobs

349d23ea62-+-mediawiki_test: fix boardgovcom vhost url

69bc4bab9e-+-mediawiki: move private wikis to a separate virtual host

fbaec93a0a-+-Scap: Bump version to 3.8.4

669f8d958a-+-site: add lvs1015 as spare system

a250b8fa28-+-profile::mediawiki::web_testing: add script for deploying apache changes

d776f4cae7-+-Update allowed hosts for tcpircbot (terbium -> mwmaint1001)

1e4e64dc67-+-Remove terbium from allowed hosts/ferm rules

ee67f8d5ba-+-profile::mediawiki::web_testing: create profile

6b8ad26e21-+-graphite: take graphite200[12] out of service

820a5f3472-+-site: reimage baham as spare server

31652d4c4f-+-install_server: rename labvirt1022 to cloudvirt1022

a7b2f8e6ea-+-Add profile::analytics::cluster::gitconfig to stat and notebooks

73ff4d79e1-+-statistics::user: set http[s] proxy in git config

a725707ac7-+-varnish: startup process for multiple VCL files

07f0cf33c5-+-Set contact_group to admins for main MirrorMaker alerts

f0c4acfb53-+-Add HDFS whitelist path to EventLoggingSanitization job

760ec11ca5-+-openstack: eqiad1 deployment net role notes

1556184601-+-openstack: eqiad1-r metadata agent for net role

29a164497d-+-Neutron: define dns_domain in config

f74d1dce03-+-authdns: Remove baham from the authdns host list

ccd0713fc9-+-Revert "cache_text: add support for alternate_domains"

31ea1913de-+-prometheus: tools: scrape paws metrics into prometheus

f91a480544-+-authdns: Add authdns2001 to the list of authdns hosts

62c3fe8410-+-cache_text: add support for alternate_domains

569c5caf1c-+-nova: allow neutron hosts to access metadata service

c9a7814e70-+-Allow removing Diamond gradually

4bf7bc7737-+-openstack: eqiad1: enable nova-compute service

bf62e3a5c1-+-profile::analytics::cluster::client: enable by default /mnt/hdfs check

ff74141ef4-+-cloudvps: reimage and rename labvirt1021 to cloudvirt1021

62ad4848f1-+-Add interface::add_ip6_mapped to druid, bohrium, thorium and meinerium

f00bc643d7-+-wmf_root_clients: Productionize mysql.py wrapper

3e886996d3-+-Add interface::add_ip6_mapped to aqs nodes

4cca0c906b-+-restbase: cleanup remaining detritus from storage transition

2f35f30b57-+-Add interface::add_ip6_mapped to all the Hadoop worker nodes

43f5623c79-+-Add Debian conditional for prometheus-mysqld-exporter service_auto_restart

38ba288706-+-mediawiki: start splitting up remnant.conf

5ed7759fa3-+-network::constants: update ip6 addresses for hadoop master nodes

fa643d895c-+-Add interface::add_ip6_mapped to analytics1001

b1606dc0ef-+-Add interface::add_ip6_mapped to analytics100[2,3]

4ae9b37529-+-Add interface::add_ip6_mapped to stat* hosts

6b3980bcee-+-openstreetmap: add debian stretch to puppet role

728801db0a-+-labsdb1006: Reimage as stretch and make it osm::master

76220d31ca-+-Install python(3)-tk so that Jupyter can render charts with matplotlib

192ba39f67-+-Install libtext-csv-xs-perl on stat servers

e5fa549f41-+-wdqs: use kafka main cluster instead of jumbo

6cb545483a-+-pdns recursor: update allow_from

990f4bc881-+-webperf: Get graphite_host for coal::processor from Hiera

a28ce08994-+-Enable snappy compression for Varnishkafka eventlogging

1ffb0d8a05-+-profile::analytics::refinery::repository: remove logging config

33bfac31d0-+-profile::mariadb::misc::el::sanitization: fix cron require

fbf8b20d19-+-profile::mariadb::misc:el::sanitization: move whitelist to Refinery

d609a96aa4-+-Blacklist floppy driver

60ce4b317d-+-openstack: eqiad1: add dhcp agents configuration

d4c2ee62bc-+-Remove cp3048 from site.pp/DHCP config

9a8a965ea5-+-Enable base::service_auto_restart for mysqld Prometheus exporter

6c0c6f17e5-+-Enable base::service_auto_restart for Memcached Prometheus exporter

dabba08268-+-hue: change smtp_host to localhost

1a4801c572-+-mariadb/config.pp: Parse final space at prompt

a0d8b1428b-+-labstore: reduce nfs dumps read allowed while in failure mode

eed93a0321-+-openstack: stop nova-api from managing iptables for metadata service

231ad12e20-+-openstack cumin: use the new keystone_host var instead of nova_controller

b5e67481dc-+-Nodepool: pass in keystone_host rather than nova_controller

df60e650cf-+-Add an explicit keystone_host var to hiera

91e0fbd5c2-+-mediawiki_test: use local defines for mediawiki::site

cc04a1ad06-+-mediawiki: followup for Idb594ddeb

bc1011a0a8-+-mediawiki_test: convert all of main.conf to individual sites

8c8ddcdef4-+-openstack: eqiad1: enable neutron-l3-agent

7abb020a30-+-mediawiki_test: use compile_redirects as a parser function

3375ed6e65-+-mediawiki: use alternative module for the apache sites in the test env

aadb7954d6-+-webperf: Add statsv, navtiming and coal to scap::sources

86c597f80c-+-wdqs: fix logrotate configuration

17d99abb9e-+-Move php5 packages to contint class

9f90a621be-+-openstack: add openstack-cvps wrapper script

aa466214af-+-graphite: start sending metrics to graphite2003 too

cd94bb5f16-+-mediawiki::web::prod_sites: fix relationship name

509cb9b5f3-+-mediawiki::web: move mediawiki.org, test.wikidata to individual files

b722673e59-+-profile::analytics::database::meta::backup: set socket

14fd54069d-+-Revert "Explicitly set database password for hive/oozie"

91691393ab-+-profile::analytics::database::meta: add socket auth option

1467e53b39-+-cache_misc: decommission cp3009

98bb297a09-+-Decommission esams ex-cache_maps: cp300[3-6]

e5f7877b40-+-statsite: deprecate Diamond udp collector

50fc9afe24-+-Adjust kubelet latencies thresholds

4473c61ce6-+-labsaliaser:  suppress stdout in the cronjob

adaa3ea965-+-Deprecate Diamond tcpconnstate and nfconntrackcount

c94963fd58-+-switch en wiki dumps to run on snapshot1009 for now

04ebe40283-+-openstack: eqiad1: enable nova-api

485eeccbc3-+-openstack: eqiad1: add nova scheduler profile

2f1fed561c-+-openstack: pass version hiera key down to nova conductor service class

c49034bc3e-+-labs: move libapache2-mod-uwsgi to graphite::web

382d8dfc72-+-openstack: eqiad1: add nova conductor profile

c4cc25f1ba-+-graphite: fix require_package

026af37c5d-+-graphite: fix for stretch/django 1.9 compat

7e595a4ee3-+-site.pp: change priority of the motd, fix script

77aade9375-+-terbium: Add a decommission notice.

9546de3075-+-openstack: eqiad1: add nova common profile

a033370fdc-+-mw-maintenance: switch to mwmaint1001.eqiad.wmnet

131ba30353-+-Use backports version of osm2pgsql on Stretch for improved memory handling

383e7b3a3a-+-redis: remove now-useless specific classes

4a09672a3e-+-wdqs: create log files during log rotation

2cc55e0591-+-redis: remove cronjob for restarts on slaves as well

f48aa67060-+-graphite: add graphite2003

d28ec8efa0-+-role::eventlogging::analytics::zeromq: delete unused role

7e20d13e84-+-cache::text: ship cache_misc VCL

1a5f987438-+-service::node: Expose the MW appservers' host to modules

07e349c003-+-Set spark2 spark.sql.catalogImplementation=hive if hive enabled

c973bb2200-+-webperf: Make performance::site apache config more dynamic

b1a7edf125-+-Explicitly set database password for hive/oozie

9539137896-+-jobqueue_redis: remove restarting cron in redis

2994c0009c-+-profile::jobrunner: remove references to mediawiki::jobrunner

73aabd2048-+-docker: Create the configuration before installing the package

9e580c41a0-+-Enable smater logging for wdqs

06cc7618fa-+-profile::mediawiki::jobrunner: remove the old jobrunner service

16ed77b58d-+-site: add authdns2001 node definition

10bf0f676a-+-puppetdb: change hardcoded nginx client cert setting to ca_path param

22a7c45a7b-+-varnish::instance: separate VCLs support

faf5da9068-+-Add component/vp9 to video scalers

d5e0eef5f5-+-Revert "maps: remove "style" parameter"

a4a4f2b4de-+-maps: remove "style" parameter

5c31c779bf-+-profile::cache::kafka::alerts: move per host vk alarms to aggregates

addab29463-+-phabricator: fixup for If4fd73de

d983caeb59-+-openstack: eqiad1 initial neutron l3-agent manifest

8ce67bb303-+-nova region-migrate: move region-migrate.conf into the envscripts class

ad385b29f9-+-Openstack: add region-migrate script and config

3c3c44c8df-+-varnishkafka: Set TLS curve list and sigalgs list defaults

c27be30b3c-+-labtestn: use proper labtestn db password from hiera

40ff510560-+-WIP labstore: switch labstore1005 to primary in pair

a1357b8fdb-+-Upgrade the piwik module to matomo

95c4eb7e13-+-cassandra: add another package version to the 2.2 list

4219f68812-+-openstack: glance: install from jessie-backports if running mitaka

38e30d6339-+-openstack: eqiad1: enable glance in control boxes

beef708774-+-openstack: neutron-common: install from jessie-backports if running mitaka

2c09794c5f-+-openstack: eqiad1: enable neutron in control boxes

ce42ae3221-+-openstack: eqiad1: keystone bootstrap done

73aab8b342-+-varnishkafka: Enable TLS signature algorithms and curves lists config

eb953891da-+-debmonitor: fix trusty crontab redirection

8042994818-+-maps: isolate maps-test2003 and reimage it to stretch

69d13168a0-+-debmonitor: install debmonitor-client

eab044c69b-+-Remove ORM jar from sqoop cron command

b8c0a047cc-+-nova: move glance_host into hiera so it can be configured per-deploy

1b0bdde386-+-openstack: basic net role to labnet100[34]

eec845ebdd-+-hieradata: openstack: eqiad1: fix value of nova_controller_standby

d8ed56aa1f-+-openstack: eqiad1: fix keystone local db ferm rul

062a90bbf7-+-openstack: eqiad1: allow mysql connection for keystone

56573ef971-+-deployment-prep: Add new deployment host

10bdb92b21-+-Scap: Bump version to 3.8.3-1

d4ae75ba83-+-debmonitor: set shell for system user

153ca7968e-+-debmonitor: fine-tune client user creation

6998bd8cbf-+-grafana: Fix ldap.toml permissions

a84d4b61ff-+-grafana: Enable grafana LDAP in production

1bd35e5c68-+-site: Reinstall acamar & achernar as spare systems

4e46ba4318-+-profile::hadoop::spark2: explicitly require hive client's config

9e73518a64-+-profile::piwik::instance: allow hiera settings for trusted hosts

e4eecaf10c-+-openstack: eqiad1: bootstrap keystone

12643ca07c-+-Add python3-streamparser to apertium

a8678749b0-+-Remove upstart support from apertium service_unit

a6892c00bc-+-prometheus: alert on config reload failure

dd0281c931-+-role::cache::kafka:*: add more alarms for varnishkafka

83861207de-+-mariadb: Set db1102 as spare

930b452fc5-+-mariadb: Set db1054 as spare

a47adbf9a7-+-mariadb: Set db1095 as spare, remove unused code

eec48f7b9e-+-Cloud puppet enc api: Allow read/write access from labservices host

a23c29d929-+-Fix typo in python package name on stat box

1c9eaf993b-+-Install python oauth libs for Google Search Console data

298128e5d2-+-Allow the nova controller node to talk to the cloud puppet API

b347052863-+-Glance: typo fix

110bf193dc-+-standard: Remove acamar and achernar from ntp peer list

795e336a36-+-standard: add dns200[12] to codfw ntp peer list

377ac3a4ac-+-confluent::kafka::common: fix copy/paste mistake

34abc00809-+-confluent::kafka::common: add workaround for apt on jessie hosts

0d8a56a2df-+-Move away jmxtrans/kafkatee's modules from environments/production

cc771aa29b-+-Move jmxtrans and kafkatee submodules to environments/production

ac8bbea01f-+-site: set proper role for dns200[12].wikimedia.org

2720117252-+-profile::prometheus::alerts: remove old checks

9be8f79bf6-+-profile::prometheus::alerts: tune druid alarms

ea27ece7f6-+-Proton: Increase the monitoring time out to 10 seconds

24e809913d-+-Remove unused MirrorMaker old consumer parameters

82dc0ee99d-+-Remove Kafka MirrorMaker jmxtrans puppetization

7eeb1c8966-+-Disable main-eqiad -> analytics MirrorMaker

ba75e64e4c-+-Move camus mediawiki_job to use kafka jumbo instead of analytics

17f7db6a5a-+-Remove unsused webrequest-analytics.erb camus and irrelevant TODO comments

bfeff079bf-+-site: add dns2001/dns2002 with role(spare)

7a7b19ed7d-+-site: add spare role to bast2002

eef5f605d0-+-ci::kubernetes_config: fix spurious space in filename

e4e99088cb-+-role::ci::master: add kubeconfig to access the ci namespace

1de6c36201-+-icinga/wikidata: add new check_command for dispatcher

56e665ecf0-+-icinga/wikidata: add secondary dispatcher critical check

8c85979850-+-noc/dbtree: require libapache-mod-php

9816000812-+-kafka: Ensure JVM AES intrinsics usage if AES ciphersuites are enabled

dc35180628-+-Move the varnishkafka submodule back to its original place

7e8ce72261-+-nova-api: allow access to port 8774 for api access

b24061014f-+-Move the varnishkafka submodule to environments/production

5c9c98c224-+-Restrict prometheus-pdns-rec-exporter auto restart to jessie and later

8e62c6abbd-+-Enable base::service_auto_restart for PDNS recursor Prometheus exporters

ce68e4ee4f-+-monitoring: Remove unused 'graphite_anomaly' command

ce902f006d-+-toollabs: install python{,3}-pymysql on exec_environ

dff8770c22-+-statistics::discovery: re-enable cron job

98d0cb3858-+-Move kafka_mirror_maker ssl path to /etc/kafka/mirror/ssl

df6ea09de5-+-vcl: disable show_diff for browsersec.inc.vcl

dc512ee19a-+-SSL for Kafka MirrorMaker

c65b176749-+-mw-maintenance: switch only wikidata maint jobs to mwmaint1001

e8d53bf852-+-cache: allow installing separate VCL files

7484387b94-+-Add Icinga alert for varnish http traffic drop

31ddcb0d96-+-cassandra: all 2.2 clusters should use the cassandra22 APT component

6e3907b0fa-+-Switch from 5 mins to 10 mins for wikidata dispatch check

f3add9879b-+-Need to install mongodb on xhgui machines

10100aeb47-+-openstack: allow designate in labtest to contact labtestn keystone

fccd973865-+-mariadb: Remove references to db1053 and db1059 and set them as spare

8ede313b84-+-openstack: eqiad1: disable keystone hourly cron

a60987b31e-+-mw-maintenance: require GNU time from time package

a8e3e204d3-+-mw-deployment: remove rsync for tin home dirs

0ed619a0b4-+-mariadb mediawiki maintenance: Update comment

8c6b1f5630-+-mw-maintenance: rsync home dirs from terbium to mwmaint1001

f026d57236-+-openstack: eqiad1: enable keystone local database

0a65e81a23-+-varnish: install libvmod-re2

abad5bd2cf-+-systemd: add define specific to timers

172ff84f61-+-cumin: simplify role description for MOTD

d07fc57754-+-profile::geowiki: remove unused/old crons

f22eee19ef-+-mariadb: Promote db1066 to master

6892cb2cc5-+-esams rebalance: add 3043 to upload

68948b2982-+-get snapshot1001 ready for decommissioning

6c40988a3f-+-add snapshot1009 as dumps testbed

d046cf070f-+-Mask the default uwsgi service for ores

a95ed44965-+-prometheus: use validate_cmd for rules and config files

0db66d1288-+-openstack: base: keystone service requires false as boolean

7ed34550f8-+-openstack: keystone: also install python-routes from jessie-backports

6520f5062f-+-openstack: keystone: fix syntax for install_options

a2deb143d3-+-openstack: keystone: use install_options to install from jessie-backports

61b16f5d8b-+-mariadb: Introduce replication password on mariadb root clients

c2f456b4e8-+-kubernetes: Remove deprecated --api-servers parameter

71536a5fd4-+-debmonitor: fix directory creation

3936b384f0-+-debmonitor: client side setup

cb8fd5cc4a-+-debmonitor: finetune Icinga checks

fac71f766b-+-Enable base::service_auto_restart for mcelog

298f14bed7-+-Scap: Bump version to 3.8.2-1

2af7fdb5be-+-deployment_server/package_builder: use ::profile::base::firewall

1623a25f3f-+-openstack: eqiad1: enable more components for labcontrol boxes (keystone)

6b581792bf-+-kubernetes: use ::profile::base::firewall

4725f29e5e-+-profile::mediawiki::jobrunner_tls: fix monitoring definitions

43475ee4bf-+-reload-vcl: fix shell injection, add .py suffix

5fe53c9e83-+-debmonitor: add explicit dependency on libldap

1671e9d508-+-debmonitor: add basic HTTP Icinga checks

dda87e12f5-+-debmonitor: use Nginx snippets

208277512c-+-Revert "Enable base::service_auto_restart for mcelog"

244c27cd90-+-Enable base::service_auto_restart for mcelog

f229c4505f-+-Enable base::service_auto_restart for uwsgi-netbox

82894a2043-+-Enable base::service_auto_restart for smartd

85d9035ac7-+-maps-test: use ::profile::base::firewall

f7621a59ef-+-site: include ::base::firewall -> ::profile::base::firewall

b933290dd2-+-realm.pp: Add id_internalwikimedia as private wiki

852e237672-+-wikistats: update name of miraheze import script

6c50ec2612-+-openstack: labtest hw refresh initial role

a64202bb7a-+-realm.pp: Add idprivatewikimedia as private wiki

accabe22f5-+-profile::kafka::mirror::alerts: tune retries and its interval

f5bdb8b535-+-phabricator: add role to node phab1002

3f33f4ac08-+-openstack: eqiad1 deployment (neutron in eqiad)

171aaa1ff5-+-role::kafka::monitoring: raise burrow api-version for most clusters

e111ef9439-+-conftool: Only populate scripts if service in LVS

80dc9e55fa-+-cassandra: upgrade 3.x version to 3.11.2

fbf2492ea0-+-phabricator: Add mysql slave port parameter and provide value via Hiera

0aebd8c1ee-+-profile::analytics::refinery::job::sqoop_mw: avoid root cronspam

50592c996c-+-Cleanup after migration of deployment servers to stretch

660e67a0a7-+-Include analytics cluster users on stat1004

d773d36b91-+-Ensure analytics cluster users are on notebook machines

cb434193fa-+-Ensure system_members are in user groups

b819f9b488-+-Reverting https://gerrit.wikimedia.org/r/#/c/379004/

cad8eb3444-+-deployment::server: require libwww-perl

dc06ad99ab-+-Fix default_member in groupmembers.pp

3b8489aead-+-Allow admin module to ensure system user membership in managed groups

c81f4c123f-+-openstack: keystone: add proper active parameter for service

6c6bad0e05-+-planet: remove jessie support and venus references

6579b30822-+-planet: move plugin dir out of feeds dir

175b5e4e5c-+-Kafka - Change default message.timestamp.type to CreateTime

1eb4eb67e1-+-decom and remove remnants of tin.eqiad.wmnet

4075f4d0cc-+-proton: Add standard, base::firewall, lvs classes to role

1aca61d124-+-Revert "scap3 - deployment of package requires configuration to already exist"

50ae0a0a3b-+-Proton: Apply the role to proton hosts

6451f08843-+-Enable base::service_auto_restart for varnishreqstats

85b11f1352-+-Enable base::service_auto_restart for varnishstatsd

0296ed0eaa-+-Enable base::service_auto_restart for prometheus-mcrouter-exporter

9591f10272-+-Delete mediawiki::monitoring::graphite

b81497fe05-+-ores::base: deploy hunspell-bs only on stretch

fca2647342-+-Create profile::analytics::cluster::packages::* classes

beb6a5eb48-+-mariadb: Switchover m3-master to db1072

400dc58498-+-Toolforge: Update toolforge description in bastion banner

988bc23d90-+-labtestnet2003 install params

970dfb849a-+-mariadb: Decommission db1051

4b2e140e58-+-openstack: labtest: keystone: delete service (collapsed)

d5ce11861c-+-mariadb: Switchover m2-master to db1065

51c6b8825f-+-Also remove at from gridengine

d503373d17-+-Remove at

14108c0d81-+-prometheus: export intel-microcode information via node_exporter

8a8811628d-+-jobrunner: add profile::mediawiki::videoscaler

98244a0d0e-+-profile::mediawiki::videoscaler: remove global Timeout setting

4764a2a58d-+-Switch video scalers to a profile

d2166db093-+-jobrunner_tls: server_aliases, not server_alias

f6a82e96ea-+-mariadb: Convert db1116 to spare

f7375abe92-+-profile::mediawiki::jobrunner_tls: add server alias for discovery

aadb2c0030-+-profile::mediawiki::jobrunner: manage both videoscaler, jobrunner

9dfb38ba2a-+-elasticsearch: alert when cirrus writes are frozen for too long

ff86b18756-+-Revert "Revert "mariadb: Add extra_port on port + 20 for multiinstance hosts""

5f17b56844-+-Revert "mariadb: Add extra_port on port + 20 for multiinstance hosts"

26ce4117e4-+-Move microcode hiera call to profile::base

f37ed02853-+-mariadb: Add extra_port on port + 20 for multiinstance hosts

bf8c024ed3-+-Bump lvm puppet module to 1.0.1

e4a1986882-+-Install HPSSA diagnostics tool on servers with HP RAID

fcfc938a1d-+-Remove unused jobrunners.

a12515537b-+-profile::mediawiki::jobrunner: do not run the service when there are no runners

4a79669683-+-ganeti: Remove DSA ssh key

513e9e0d08-+-ganeti: Absent DSA SSH key

af8097b28b-+-mariadb: Set db1120 to spare

3c9280c8a7-+-Specify videoscalers uri in hiera/changeprop manifest.

845fb4ca67-+-videoscaler: up the TLS termination read_timeout to 1 day

b5cdd3ba9c-+-tlsproxy::localssl: allow tuning of timeouts

efc71893ca-+-profile::kafka::burrow: use localhost as smtp server

a1bc7ae105-+-scap::target: List allowed service commands, instead of wildcard

c2e9494c5b-+-webperf: Make the different webperf roles explicit

d9433d6b7d-+-wdqs: cleanup declarration of blazegraph options

22328c0e9a-+-elasticsearch: raise unassigned shard alerting threshold

347391c439-+-lvs::configuration: Add configuration for the videoscaler service

c3066f951b-+-webperf: Fix jumbo-eqiad reference to be compatible with Beta Cluster

f766999100-+-role::mediawiki::videoscaler: add TLS termination

5bd68a194c-+-jobrunner_tls: generalize to support videoscalers as well

d1c7af27ca-+-cassandra: cassandra-tools always make sense to be available

3adba82931-+-toolforge: fix duplicated sqlite3 package declaration in toolforge bastions

26315e8ee5-+-profile::mediawiki::jobrunner: disable PrivateTmp everywhere

85a5d61483-+-Toolforge: add sqlite3 package to exec_environ

142b599d7b-+-toollabs: add /etc/aliases file for tools-mail server

08cbe170af-+-Enable base::service_auto_restart for Burrow Prometheus exporters

ce59fdb2c8-+-geowiki::job::limn: add MAILTO env variable to avoid root@ spam

44f972479e-+-profile::analytics::refinery::job:data_purge: fix webrequest datasource

70288db94a-+-deployment::server: add rsync for home dirs

b5438bd1a5-+-Revert "planet: rm planet-venus feed templates, rename feeds_rawdog to feeds"

d648ed2d96-+-planet: rm planet-venus feed templates, rename feeds_rawdog to feeds

4f5f934a02-+-openstack: allow glance to call back for token validation

121e0aaae0-+-openstack: specify keystone_host for main deployment

30f588d8d6-+-openstack: labtest use labtestcontrol2003 for keystone

f1b86b5d2c-+-icinga: remove Logstash syslog TLS listener check for troubleshooting

853532ee81-+-install/cumin/scap: update/remove tin-related comments

4c7b49513b-+-switch deployment_server from tin to deploy1001

cda12f0a06-+-logstash: set exposed puppet cert ownerships to logstash:logstash

e3dc401cb8-+-logstash: add tcp tls input for syslogs

3de24be581-+-profile::mariadb::misc::eventlogging:db: remove unused heartbeat

a5bb154f79-+-profile::mediawiki::mcrouter_wancache: use ferm service, not rule

0fcc3c8191-+-mcrouter_wancache: expose the TLS-protected port

a07f471fae-+-role::mediawiki::common: temporarily add an os_version guard

9661f05ac1-+-role::mediawiki::common: install mcrouter everywhere

f322300c4e-+-role::prometheus::ops: collect mcrouter metrics

9020641e61-+-role::mediawiki::common: add prometheus exporter for mcrouter

10992cc552-+-mcrouter: run as user mcrouter

3a84ccd4d8-+-mcrouter: fix logrotate rule

c6b920b486-+-mcrouter: add rsyslog/logrotate configuration

45cc296d3a-+-mcrouter: fix ssl options

a188d6923c-+-mcrouter: fix hiera labels, install on mwdebug servers

cb6fb2321a-+-profile::mediawiki::mcrouter_wancache: update the ssl paths

1e8f686a38-+-Enable base::service_auto_restart for librenms-syslog

79316edbf8-+-Remove pivot from puppet

4bd3749447-+-Remove now obsolete os conditional

db0e7bdac6-+-mariadb: Move db2075 back to s5

8cc9b5f48d-+-site: add phab1002 with spare role and mapped IPv6

3b88cf12b8-+-ci: add VisualEditor and Wikibase to git cache

6b12fd40c0-+-use 6 parallel jobs for xml/sql dumps of big wikis

e4526174a0-+-standard::mail::sender: run a smtp daemon on localhost:25

fc02c5fd7b-+-Blacklist mediawiki_revision_score from Hive refinement

92fb97cf6d-+-profile::docker::flannel: Use systemd::service

3eb4569f77-+-puppetmaster::frontend: add cergen-managed CA for mcrouter

fe0679a6c6-+-role::analytics_cluster::webserver: deprecate pivot

80fff1d654-+-Remove obsolete mediawiki Upstart jobs

b8654b59f3-+-Delete sshknowngen

f5279a79ef-+-maps: fonts-noto-unhinted only available on stretch

e2d0abbfa3-+-realm.pp: check storeconfigs setting for use_puppetdb

107c49aa94-+-mariadb: Move db2092 back to s1

fcb4e51b4a-+-maps: install fonts-noto-unhinted

f0f599e296-+-Allow use of PuppetDB in labs for ssh_known_hosts

f072203379-+-Planet: One more fix for library

d5fd8f0fce-+-wiki replicas: fix a mistake in the maintain-dbusers refactor

e03936233d-+-Remove warning about using labs-vagrant on stretch

e7621f3c9b-+-Planet: Update libs and some ui tweeks for rawdog

8174c5527c-+-role::mail::mx: Permit changing certificate

7a5365fe8d-+-ELK: change elasticsearch index prefix to logstash-syslog for syslog type

8b172e0b74-+-Wikidata dispatching: Update comment

8c5cfac65f-+-Remove support for trusty in mediawiki classes

ac8d5a3681-+-apertium: Pin python3-tornado to jessie-backports

c6cced1345-+-network::constants: remove decommed zookeeper nodes

e0924c56c8-+-Kafka - Don't manage Cluster ACLs

6e20a87bc7-+-Kafka vary ssl_client_auth only if auth_acls_enabled is true

11efa4fd5c-+-Kafka - set super.users even if auth acls is not enabled

9b9ef0056e-+-debmonitor: fix path for source code

43c6716a12-+-Planet: Redesign UI for rawdog, add theme files

2a70096eb8-+-debmonitor: add missing scap dependencies

63200515b2-+-Add notes about conf100[1-3] -> conf100[4-6] migration status

3e9ced0b96-+-debmonitor: add server side puppettization

135764500c-+-ores: Install hunspell-bs on ores nodes

08801b0e7e-+-Swap zookeeper from conf1003 to conf1006

d36847b257-+-Remove os conditionals in statistics::packages

acc38b2560-+-icinga: Populate additional hostgroups based on LLDP

8a25e924c6-+-profile::hadoop::common: selectively deploy Ores packages

37a16e635c-+-network::constants: update kafka-jumbo ipv6 addresses

08bc4bda20-+-network::constants: update kafka[12]00[1-3] ipv6 addresses

1462b948f6-+-Swap zookeeper on conf1002 with conf1005

d0dc6dff93-+-Revert "ores: Install hunspell-bs on ores nodes"

995341e507-+-ores: Install hunspell-bs on ores nodes

cf56a54caa-+-maps: don't fix postgresql version

a3327b4c43-+-maps: enable prometheus metrics for cassandra on maps-test2004

9b9f67f216-+-varnishrls: post-removal cleanup

187ad48520-+-varnishrls: remove python daemon

9dd03bbd27-+-add snapshot1008 role and hiera settings

990f3a543b-+-role for new misc dumps cron host

84a98c8a92-+-turn off misc dump crons on snapshot1007

2752358971-+-mirrors: update the rsync server for Tails

6b5ca9f3ee-+-ircecho: remove restart => true parameter, unbreak

ff0fded2da-+-standard_packages: Remove atop from every WMF machine

0de2086691-+-Revert "ircecho: replace base::service_unit with systemd::service"

546a9e138f-+-mediawiki: Stop replacing term_search_key with empty string

31883e0def-+-maps: add fonts-noto and fonts-noto-cjk

b00184e0e0-+-facter: refactor the net_driver fact

a416dfaad1-+-keyholder: base::service_unit -> systemd::service

bb686f0ada-+-otrs: base::service_unit -> systemd::service

3224b59772-+-mariadb: Add the new sanitarium hosts to the config

e3f6e12913-+-profile::mediawiki::mcrouter_wancache: add ssl, proxy support

030ef944a3-+-Monitor dump output file production

8b6470ea2a-+-remove naos from network::constants and kubernetes staging

daf25c1433-+-remove naos from site.pp, tcpircbot. update scap comment

f77c7df7d0-+-Add comment to refine command about extraClassPath

76505b5ea7-+-add deploy2001 to site.pp with deployment_server role

140de9027f-+-ores: Add hunspell-sr library

c4f3c5a851-+-mariadb: Convert db2078 to multiinstance

5575ac3986-+-Redirect pivot -> turnilo

4823ba2795-+-mariadb: Move db1065 from m1 to m2

13f3f95591-+-Revert "k8s: remove trusty/upstart support"

4923327d80-+-k8s: remove trusty/upstart support

ce29563366-+-ircecho: Add restart => true to systemd::service

0b98911a38-+-mariadb: Fix duplicate definition of monitoring at misc_multiinstance role

2e28a4e5f5-+-mariadb: Fix reference to misc_multiinstance template

71f403e223-+-mariadb: Setup db1117 as misc multiinstance

64a1e84754-+-Proton: Require the standard MW fonts

f322c6b667-+-mariadb: Allow to setup a custom template for individual instances

3637937b58-+-profile::druid::*: move prometheus jmx exp's config to /etc/prometheus

0502673fb0-+-dumps/snapshot: add 'restart => true' to systemd::service

d647d4fee2-+-Icinga: reduce checks frequency for SMART and EDAC

d165250fb7-+-Icinga: add check and retry intervals for prometheus

67eebe06b8-+-profile::prometheus::alerts: disable druid realtime alert

cb35953156-+-snapshot/dumps-monitor: replace base:service_unit

dafd160a7a-+-mariadb: Set db2064 to spare

6be3ff8af8-+-Wikidata dispatch, remove cron params, use values from mediawiki-config

5bcffe3706-+-Add fonts-noto to support priting non-latin characters

de211b9841-+-profile::prometheus::alerts: fix druid alert

ec13ef857a-+-role::analytics_cluster::coordinator: remove refinery-relaunch-banner-streaming

e5992139b3-+-tcpircbot: restart upon config changes

3f3bc7c59f-+-tcpircbot: base::service_unit -> systemd::service

819eb95bd8-+-varnish: use systemd::service instead of base::service_unit

dbecb6824a-+-reprepro: fetch mono suite from upstream apt repo

42122b8696-+-keep around dump prefetch files from small wikis too

01ab7b567c-+-mcrouter: add support for listening on the ssl port

ca9851a096-+-Log wikibase dispatchChanges script for testwikidatawiki

74cd8fdd2c-+-mariadb: update TODO about base:service_unit

cb4651885e-+-webperf: add IPv6 mapped addresses to webperf1001/2001

76e85bd26a-+-xenon: replace base::service_unit, rm upstart template

c0dc52673c-+-Use separate consumer group names for EventLogging log files

2f9758365c-+-profile::druid::common: add the use_cdh_hadoop_config parameter

a43dab9483-+-ganeti: add interactive script to create VMs

c0e8a9a3ae-+-Provide EventBus URI to change-prop profile

e74f28c4a5-+-druid: set the default druid.storage.storageDirectory even without cdh

25155a5e4a-+-dumps: replace base::service_unit with systemd::service

c1ec7a5a4d-+-Increase Kafka MirrorMaker max.request.size to 5.5Mb

ea5962101b-+-move last dumps generator hiera settings into the profile

d51487dcc7-+-move some dump generator hiera settings to common yaml

8e87123bfa-+-keep partial dumps on the dump generation nfs servers, not the web servers

ec91b76f99-+-keep dump prefetch files longer on dumps generation nfs servers

20c8292ab1-+-UDP2LOG: Remove sysvinit config file

aace7d42ac-+-ensure => true to ensure => 'present' in web.pp

376ae3dd14-+-Load Tor Exit Nodes on labswiki

606e47f134-+-ircecho: replace base::service_unit with systemd::service

b8c181335e-+-network/tcpircbot/kubernetes: add deploy2001 to allowed hosts

735f57ad3b-+-Make labvirt1019, 1020 labvirts

3127dbd446-+-maps: disable crons for maps-test2004

f0e9dd86f6-+-maps: fix typo in cron hours

6d721b70e3-+-maps: fix typo in cron hours

03e1094a43-+-maps: add crons for different update types

d88804d473-+-Enable webrequest deletion

4c9b129008-+-webperf::profiling: require libapache2-mod-php7.0

ed43933d67-+-webperf: add ferm rules and basic role/profile for xhgui

64b225a765-+-puppet: Add /var/lib/puppet/server/ssl to backups

d88da8b2e8-+-profile::hadoop::worker: drop Debian Jessie support

d16605eba2-+-Change deploy-mode to client for EventLogging sanitization cron job

fa72f5d5dd-+-wdqs: configure new wdqs test cluster

6f1fe45548-+-add webperf1002/2002 as spare systems with IPv6

09a375eb4d-+-librenms: base::service_unit -> systemd::service

150917145c-+-phabricator: base::service_unit -> systemd::service

52fcc5ad20-+-Shorten cron commands by using shorthand flags

325bb55829-+-Use standard logging approach similar to sqoop job

38c5e17bec-+-tor: add icinga check_tcp for ORPort and DirPort

1a94982718-+-role::configcluster: fix zookeeper role config

338c63f82c-+-Proton: Add role and profile

1769e50650-+-Set jdk.tls.namedGroups=secp256r1 for Kafka TLS

faa598e3ad-+-Allow enabling microcode updates gradually

056b85bc25-+-profile::prometheus::alerts: blacklist some change-prop old cgroups

9a4d28a9f2-+-mariadb: Convert db2075 to temp sanitarium

f295535661-+-role::configcluster: decom zookeeper on conf1001

c2594dec3c-+-Use proper path and fqdn for eventstreams check

51b5cb9a4e-+-check_eventstreams - exit 2 if critical

ad1f11cf25-+-Reduce sensitivity of Kafka Broker Under Replicated Partitions alert

1687d5be4c-+-Fix type in check_eventstreams script

9384a401d8-+-Alert if EventStreams recentchange endpoint has no messages

ed982c41e2-+-enable IPv6 for tendril

119046adc5-+-role::prometheus::ops: add new zookeeper hosts' monitoring

4ebdfbb639-+-Swap conf1001 with conf1004 in Zookeeper main-eqiad

dea04143f3-+-Migrate eventbus camus job to Kafka jumbo

fa914b407e-+-Kafka: increase group.initial.rebalance.delay.ms to 10s.

9e498db2ce-+-base: alert on correctable errors over a period of time

40c2ac1ccd-+-role::aqs: follow up after druid's config refactoring

f3bb1f7ee9-+-role::aqs: refactor druid's configuration

3124831dd0-+-Add output-format parameter to sqoop cron

44f4724036-+-Increase MirrorMaker max request size to message.max.bytes + 1Mb

beb8aeac0c-+-Drop private data used for geoeditor aggregation

88c4678d8b-+-openstack: neutron: nova.conf: enable options

c34896e823-+-Puppetize Turnilo (Pivot replacement)

9e7c1415c9-+-mariadb: Convert db1120 to a temporary sanitarium

f6fc09e096-+-lists: rate limit HTTP subscriptions

2662bf492f-+-profile::prometheus::alerts: reduce the noise for the Druid alarms

1e3bf677ba-+-bacula: remove unused fileset var-lib-carbon-whisper

fe77c4cc97-+-graphite: add backup of /var/lib/carbon/whisper/coal/

783c9f468b-+-nova: whitelist a kernel version with spectre fixes

310748d17e-+-mediawiki: remove stopped deleteAutoPatrol script for wikidata

bb3135f46a-+-mariadb: Move db1066 from s1 to an s2 master candidate

c791e29952-+-prometheus: rabbitmq_exporter: add missing directory

8028a45913-+-openstack: resolve in puppet for labtest keystone ferm

37c7cc6b6b-+-openstack: allow codfw control servers to connect to labtest mysql

745b088294-+-swift: add prometheus-memcached-exporter

88ea964ba9-+-mariadb: Prepare db1072 for stretch reimage and move it to m3

15b6a323b3-+-Set default eventbus kafka log level to WARNING

555b2e65f8-+-thumbor: add prometheus-memcached-exporter

88a4b47c44-+-don't configure any settings for a labs copy of dumps

cb56565954-+-debmonitor: add hosts to the spare role

a8a14472ec-+-mediawiki: Stop cronjob to delete autopatrol actions

1b5231ee32-+-install_server: Reimage lvs1003 as stretch spare system

54eca52bb8-+-Use gelf port for eventbus logstash

a445bf8f23-+-eventlogging service logstash with gelf

3576532374-+-Use mirror_name label for produce rate alert

517e42952a-+-Remove profile::kafka::mirror from role analytics b

ab860a8ae0-+-Enable 1.1.0 MirrorMaker main-eqiad -> jumbo-eqiad

1d9b8d01f6-+-pybal: switch lvs1016 to cr1-eqiad

fcdb2be0ad-+-Kafka main-eqiad - remove api.version

71269e2919-+-Add cron job to sanitize EventLogging data in Hive

49a8b1134d-+-mariadb: Setup db1123 into s3

b155b01325-+-Provision RSA keys for ganeti root auth

386aaee7b9-+-performance website: remove from graphite hosts

9464470296-+-Remove version requirements for kafkacat and librdkafka from kafka brokers

0e78f7de1a-+-mw-maintenance/wikidata: set $ensure for rebuildTermSqlIndex.log

837d725659-+-performance website: allow traffic

a4a40f7c90-+-Scap: bump version to 3.8.1-1

ec24bb5a8f-+-Force statsv varnishkafka api.version to 0.9.0.1

86951ff292-+-Kafka main-codfw - remove api.version

25db31d1d8-+-base: sum EDAC correctable errors

a3b6b620b6-+-mariadb: Set db1055 as spare before decommission

dab3194497-+-base: alert on EDAC correctable errors

2f7a5514f2-+-mariadb: Move db1064 from s4 to x1

70f24dc51e-+-proxysql: Changes added (simplifications) to the proxysql class

f7e3ee01ae-+-Install parallel gzip (pigz) and parallel xz (pxz) on all servers

019c5a556a-+-proxysql: require proxysql package installation for module proxysql

70e3244d42-+-cassandra::metrics: propagate ensure parameter to wmf-auto-restart

c53d1556f7-+-mariadb: Convert db2092 to sanitarium multi-instance

1a6cbdaa04-+-role::aqs: deprecate cassandra-metrics-collector

c2eb309dfe-+-tendril: Explicit perl package dependencies on maintenance

d97c355c6d-+-tendril: Move cron jobs to dbmonitor, remove proxysql from terbium

a8e9797ba2-+-mariadb: Set db1060 as spare

f34ada1bc1-+-Set kafka api_version on statsv instance if provided

8852a51d39-+-coal-web: needs proxy_http module as well

59be486bcc-+-Small improvements to the geoip archive script

598917fb48-+-performance::site: load apache mod proxy

b2798b5ba6-+-performance::site: require libapache2-mod-uwsgi

652326e673-+-coal: require requests module; deploy to webperf

bd23746405-+-Unbreak maintain_kubeusers.pp from dependency cycle

06633b6982-+-Ensure scala and kafka version on kafka analytics-eqiad cluster

b45839d41d-+-Ensure confluent package systemd units are disabled

7380e9fa7c-+-network: add mwmaint1001 to network constants

22dbaff623-+-toolforge k8s: allow /etc/wmcs-project to be mounted

17baae342c-+-Revert "coal: require requests module; deploy to webperf"

830bdcd614-+-coal: require requests module; deploy to webperf

ff00fab2c7-+-no-op: Add $enabled parameter to profile::kafka::mirror

bc05758e01-+-vim: don't use Stretch's default, infuriating mouse mode

570a0acefe-+-Deprecate Diamond pdns collectors

686f50176f-+-maintain_kubeusers.pp: use require_package and add python3-yaml

721f6800b8-+-prometheus: alert on per-site HTTP availability

91e83d5fb8-+-Enable base::service_auto_restart for clamav-freshclam

a3f6c1fe54-+-remove a bunch of manifests only used on dataset1001, ms1001

25b1676670-+-remove production roles from ms1001, dataset1001

8b6791f3f9-+-prometheus: Add buddyinfo collector to node exporter

bec994d15e-+-profile::druid::common: set java 8 as default

57f8d4f03b-+-mw-maintenance: enable crons based on fqdn, not mw_primary

099efa697e-+-Revert "Revert "mwmaint1001: add mediawiki-maintenance role""

0ebe772a16-+-tcpircbot: add mwmaint1001 to ferm rules

4ab522d394-+-mw-maintenance: add PHP7 support, php-readline version

b21f333156-+-varnishtlsinspector: Stop collecting TLS data

1fe39e9906-+-pybal: Set lvs1016 bgp peer address

f3daf10ba8-+-mwmaint: add mapped IPv6 address on mwmaint1001

6bd8f659b4-+-lvs: lvs1016.eqiad.wmnet configuration

61b00ab2a4-+-mediawiki: Add clearTermSqlIndexSearchFields for wikidata

839a776848-+-openstack: rabbitmq_exporter package was added to jessie-wikimedia

326a6bbab1-+-mariadb: Decommission db1056

fd90784ffe-+-varnishlogconsumer: do not install python-logstash

b32836acff-+-varnishlogconsumer: restart services on file change

f9e92c14b5-+-mariadb: Add db1119 to s1

9615b3b0a6-+-Revert "mwmaint1001: add mediawiki-maintenance role"

658368af36-+-mwmaint1001: add mediawiki-maintenance role

bcd8312bcd-+-Enable base::service_auto_restart for jenkins on release servers

adbd8719f6-+-relforge/mariadb-labtest: adjust terbium comments, rename ferm rule

16d06e93f2-+-rename mw1297 to mwmaint1001, partman for mwmaint*

ff5eae4205-+-coal: require python-tz

64bd709d33-+-Remove duplication ghostscript package declaration

29f43ed4d9-+-varnishtlsinspector: send TLS connection details to logstash

4fa55501bc-+-Refactor varnishlog consumers

2b675f9fcc-+-Revert "Remove mwdebug1002 from debug proxies for stretch reimage"

f5f56d6761-+-role::prometheus::analytics: fix cassandra relabel config

f4b011f66a-+-role::prometheus::analytics: rename cassandra metrics/labels

b28dbcc9ae-+-Remove mwdebug1002 from debug proxies for stretch reimage

f367ec290f-+-No-op Smart vary security_inter_broker_protocol

91c3f5ba6b-+-No-op Remove Stretch conditionals for Kafka brokers; all are on Stretch

3d43d3f843-+-No-op organize kafka broker hiera in prep for main upgrade

214cec60f3-+-Make webperf role install coal things

71f3b37c9b-+-cassandra: increase `vm.max_map_count` to 1048575

3756e265d3-+-Increase dispatching resources by about 10%

d3cef4d67d-+-base: alert on SMART health failure

07d7731560-+-mariadb: Setup db1121 into s4 section

6300e3f4cc-+-kubernetes: escape exclamation mark in apiserver latency check

a20d52cf57-+-profile::prometheus::alerts: add druid alerts for available segments

5bb93b4b18-+-kubernetes: allow NaN for Prometheus alerts

d57b68068d-+-k8s: simplify prometheus alerts with recording rules

1cac2a4f83-+-openstack: collapse net and net_standby into one role

ea261468fb-+-openstack: nova-network service stopped on net secondary

a36dd4f6b4-+-Add logstash tag 'eventlogging-service-eventbus'

9d6dd5c7f0-+-openstack: switch nova-fullstack over to service

6fa86841ab-+-openstack:  add nova-fullstack to net_standby

4f2abce58b-+-eventbus - Install python-logstash if using logstash logging

d688fd2be9-+-Log eventlogging-service-eventbus logs to logstash

19b8702814-+-mediawiki: Remove updateArticleCount cron

20bf107863-+-Puppetize cron job archiving old MaxMind files to stat1005 and HDFS

6917b01ee3-+-Remove references to hafnium

032522ca52-+-wdqs: enable UseNUMA on blazegraph and updater

f0adb0e73c-+-mobileapps: Add contactgroup for mobileapps

3e398ac640-+-Enable HHVM's JIT for Wikidata dispatchers

0ae426dc2c-+-remove site.pp & dhcpd entry graphite1002

c262703bf0-+-role::druid::analytics::worker: upgrade Druid to 0.10

737071c439-+-wdqs: add standard prometheus JVM monitoring to blazegraph

076e5079c4-+-provide all scripts for dumps misc crons on testbed host

02213294c7-+-mariadb: Move db1069 from s7 to x1 and enable its reimage

6a659c4d51-+-ganeti: Default hiera call to empty array

e2b44f74a8-+-Add puppetization for mcrouter_exporter

9fffe9a0d8-+-stop rsync of web logs from dataset1001

3bbc01979b-+-remove all references to dataset1001 from rsync and related manifests

09c8937b1d-+-fix up source dir for sync of phab dumps to public webserver

74616077ce-+-pull phabricator dumps from phab server to dumps web server

ceab84c328-+-Revert "disable cron for partial dumps temporarily"

1e2c9e4ca6-+-decom db2011

18972c788a-+-openstack: refactor 'cloudrepo' setup

4ab1812c46-+-wmcs puppetmasters: make cert_secret_path configurable per deploy

b7a91c9e2c-+-elasticsearch: deprecate Diamond collectors

1afbe6a56b-+-mediawiki: remove --from-id from deleteAutoPatrolLog script run

b631a903b0-+-mariadb: Use mysql-specific template for non-mariadb test host

7a85a7ca51-+-mariadb: Convert db1118 into an s1 test hosts with MySQL 8.0

bc01ddd43a-+-Revert "Remove mwdebug1001 from debug proxy config  (being reimaged)"

f1614b674b-+-mediawiki: Delete pre-2016 autopatrol actions from logging table of wikidata

ae4c399af4-+-Remove mwdebug1001 from debug proxy config  (being reimaged)

011ced72a3-+-ores: deprecate Diamond redis collector

33c4d8d8d6-+-Stop installing oggvideotools

3a1baefe97-+-webperfX001: start using the webperf role

f4d19fb6e1-+-openstack: fixup keystone logrotate

2c243efacd-+-Use /etc/prometheus as config_dir for kafka broker jmx exporter

a1f85a9837-+-profile::hadoop::master: avoid paging all for process down

59f2ecdfb6-+-Remove obsolete mediawiki multimedia packages

73ca41f702-+-Enable eventbus Kafka producer snappy compression

f7c8c29da0-+-Remove obsolete mediawiki::packages::fonts from mediawiki::multimedia

f9831d3089-+-Don't include mediawiki::multimedia on labweb*

c1cc5af060-+-Scap: MediaWiki Canary: setup swagger checks

907e069646-+-mariadb: Add db1090:s7 to configuration

a419a3e0ea-+-Stop including mediawiki::packages::multimedia for contint

a25866f499-+-mariadb: Convert db1090 into a core multiinstance host

ba4f51f687-+-Ping offload, dhcp, partman and puppet for ping2001

73ca3a855b-+-graphite: allow data requests from performance.wikimedia.org

031cce4670-+-Add add_ip6_mapped to kafka100*

4a5b513c3d-+-coal: Point systemd and uwsgi config to scap-deployed version

859f7a2cc2-+-Blacklist job|change-prop proper mirror maker instance for main -> analytics

9b46843fae-+-flaggedreviews-maintenance: Avoid cronspam by sending error output to /dev/null

7091c3eebe-+-Add add_ip6_mapped to main-codfw hosts.

a63178679c-+-Blacklist job and change-prop topics from lag check for main -> analytics

0f7c2f030a-+-Removing db1039 site.pp entry

1e9c8cb888-+-Assign role spare to poolcounter1002

1b39298380-+-profile::hive::client: blacklist a UDF builtin for CVE-2018-1284

4f500c68b1-+-Install params for proton[12]00[12]

8deb64946c-+-mediawiki: Disable updateArticleCount cron

ae5735a9ec-+-Install params for poolcounter1003

36ec6d05fe-+-base: Disable atop daemon everywhere

034e1cc12d-+-mariadb: Setup db1122 as an s2 core eqiad database

c269ef5538-+-Remove mediawiki::firejail

81d18324e3-+-mediawiki::packages::fonts: Consistently use require_package

75b815dc05-+-Remove obsolete fontconfig/imagemagick code from mediawiki::multimedia

a1b19a1d42-+-mariadb: Convert db1116 as sanitarium multi-instance

be95e5593d-+-dumps: Copy web server logs to stat host

992a7897f3-+-Removing db1034 from site.pp (decom)

b70ab65668-+-decommission db1029 and db1030

51c1fa5ef5-+-Fix kafka alert dashboard link

0f7fab6bb9-+-Remove unused role::kafka::main::broker

72db43c1d4-+-Use profile::kafka::broker in main-eqiad

79dea54adc-+-Add instance_selector param to jmx_exporter_config and use for Kafka

461303e52f-+-Use profile::kafka::broker for main-codfw

49acee8ea9-+-Use different GC opts for Kafka in Java 7 vs Java 8

2b1b6d303c-+-profile::hadoop::monitoring::journalnode: correct port

f79a5a4ed2-+-Use kafka_cluster label instead of cluster for broker alerts

0650dd0003-+-realm.pp: allow hosts in .labtest

76e5cd4083-+-Add ms-be104[0123] to swift::storage

00d0ae3869-+-Add kafka_cluster label to Prometheus Kafka metrics

25bfbe7f14-+-profile::hadoop::worker: deploy the journalnode prometheus config

d5d1ef5c32-+-Set defaults for replica_maxlag broker monitoring thresholds

dcec49d00b-+-profile::hadoop::common: allow jvm opts for journalnodes

17e8997d7b-+-Set default 'cluster' for profile::kafka::broker::monitoring

87e095d632-+-role::kafka::main - only include MirrorMaker in prod

8c4da8208f-+-mediawiki: stop deleting autopatrol logs temporarily

7e2ea7d485-+-mediawiki: Add explicit dependency on ghostscript

284efd70fd-+-Move static ipv6 configuration for analytics hosts to site.pp

507a158f5a-+-netops: add asw2-a-eqiad and asw2-c-eqiad

c0a1e11837-+-atop: Disable atop on core&dbstore roles to test jessie/trusty

91c0a854e7-+-base: Add disable atop functionality and test it on dbstore hosts

af4830ef59-+-Fix MirrorMaker alert dashboard alert url (take 2)

4a050bf243-+-Only require specific version of python-tornado in < stretch

76f370e127-+-Only require java.security if declared (with Kafka ssl_enabled)

d815c42aeb-+-Include proper profile::kafka::broker class in Cloud VPS

68214a0111-+-Use realm conditional in role::kafka::main::broker so we can test

66f6adeef9-+-Prep for profile::kafka::broker for main Kafka

10f5d87953-+-osm: make post-replicate command optional

ed872dc96d-+-certspotter: temporarily disable cron job

8316270c7b-+-Add prometheus based alerts for main-eqiad -> analytics eqiad

a2f43df928-+-Fix MirrorMaker alert grafana dashboard url

65b946b2d2-+-Use --new.consumer for main-eqiad -> analytics MirrorMaker

d8da695c47-+-Target kafka jmx exporters by profiles instead of roles

e753111507-+-Install libjson-perl (JSON.pm) for ezachte

54969f1e7e-+-mariadb: Fix tmpfiles.d configuration on mysql hosts

746f56e57a-+-mariadb: Create /run/mysqld on server start with tmpfiles.d

eebaec9bc2-+-Restrict HTTP availability alerts to Varnish/Nginx text/upload

7f8ef676b2-+-alerts: add varnish/nginx HTTP availability

5bb41d51b1-+-mariadb: Do not create /srv/sqldata and /srv/tmp if datadir is false

1ea5b74502-+-Enable base::service_auto_restart for cassandra-metrics-collector

bb8577ff6d-+-Enable base::service_auto_restart for prometheus-nutcracker-exporter

e8dcb9fa9c-+-Enable base::service_auto_restart for prometheus-snmp-exporter

5cf74fa846-+-profile::druid::pivot: move monitoring from module to profile

baefc6bcb7-+-add lbzip2 to the snapshots

108f10db6a-+-disable cron for partial dumps temporarily

4b7d620acf-+-openstack compute: Fix monitoring of kvm processes on Debian

b4677e14c2-+-openstack: Pin a bunch of packages for mitaka/jessie

650d5bda2a-+-graphite: add a specific retention rule for coal metrics

f95fc8562a-+-Wikitech: change maintenance jobs to use the 'wikitech' dblist

4a03bd34ff-+-Bump scap version to 3.8.0-2

86bbfd61d6-+-set actimeo=0 on snapshot1006 nfs mount for the next dump run

7ed8049546-+-Revert "Revert "varnish: restart backends every 3.5 days""

b959e9af5d-+-ntp: Cleanup jessie only code

3e6e0b4709-+-puppetdb: add service enable => true

80ea380695-+-m5: allow labtestweb2001 mysql access

ab95bc52ab-+-releases-parsoid: setup rsync between releases servers

dd8a5e31bf-+-maps: disable OSM replication during tile regeneration

f0f7d4ea46-+-mtail: pin package to stretch-backports on stretch hosts

011b782bf6-+-Temporarily look up main kafka cluster name for labs testing

8d5894121a-+-wdqs: tune performance limits for the new wdqs-internal cluster

eb4e972be0-+-Make tilerator_storage_id to kartotherian

4d25ed8000-+-releases-parsoid: add directory and fix permissions

173a4c5983-+-maps: cleanup of sources.yaml code

2695597df1-+-maps: remove sources.yaml

730377b651-+-Simplify threedtopng::deploy after image scaler removal

ba5aba5778-+-role::kafka::analytics: get rid of ipsec

e4bd5969de-+-role::prometheus::ops: fix new kafka analytics role class name

584c8fc9d9-+-contint::packages::php: fix lua package name

ed89906a8a-+-Revert "releases: add directory for parsoid archive"

618c78e540-+-releases: add directory for parsoid archive

e6f232409b-+-labtestservices2003: mark as spare

0bd6a88893-+-don't install the external hhvm extensions on trusty

15d721f38b-+-for hhvm on trusty for the snapshot hosts, disable extra hhvm extensions

718a21e6f2-+-openstack::cloudrepo: Tentatively support Stretch + Ocata

33db5b8475-+-cloudvps: add apt pinning for mitaka on jessie

c625f763d5-+-Add task reference

803b11760f-+-Split role::kafka::analytics into 2 roles so we can apply different hiera

407ca34b08-+-Remove role::mediawiki::imagescaler

f6ac265696-+-Remove unused jupyterhub_old module

1c5f1bf7b0-+-Icinga: do not start service managed by timer

c34ac93cfa-+-puppetboard: notify service on settings change

87b908f23b-+-icinga: extend screen/tmux warning time from 4 days to 10 days

5655a2a929-+-Revert "labtestweb: Allow access to db from maintenance hosts"

0fdef7c123-+-labtestweb: Allow access to db from maintenance hosts

dd65c9dc78-+-labtestweb: remove puppet classes for syncing with wikitech-static

f4f9e17d88-+-Puppet: add ping_offload role and profile

b766064243-+-Don't need to pin backports for R on jessie anymore

3fb7353254-+-mediawiki: Remove now unused parameter portal_dir

8d517e685f-+-beta: Combine commons, deployments, meta and zero vhost (3)

66973be15f-+-labstore[12]00[12]: apply spare system role

39344b644a-+-Install R on Hadoop workers

eb8ea69b3c-+-helm: Allow users to fetch charts in HELM_HOME

376c537f1b-+-Fix mirror alert parameter

bb4fd65bea-+-helm: Add a relationship to HELM_HOME directory

d065be1e57-+-Reduce warning_threshold for main eqiad -> codfw MirrorMaker

02bf584deb-+-Remove Prometheus config for image scalers

fe349a4606-+-mariadb: Add dbstore_multiinstance profile to dbstore1001

01a6c3eabb-+-Rename mirror::alerts source prometheus url paramater

2a7cc5bd6e-+-helm: Add write bit for user on HELM_HOME

cf3eb5e25a-+-helm: Remove dependency on helm-init for /etc/helm

752ff05300-+-helm: Fix call to helm init

3644673285-+-Add a new helm puppet module

2b4addf71f-+-Switch former image scalers to role::spare

947ac3118d-+-profile::zookeeper::server: fix typo os.version

9fc1075cff-+-profile::zookeeper::server: introduce the zookeeper349 component

0ace13f2c9-+-profile::kafka::mirror::alerts: introduce prometheus_url_lag_check

5ed0ac7892-+-maps: icinga alert if tiles are not being generated

297935f240-+-profile::prometheus::alerts: set correct prometheus url for kafka mm

eef09c93d0-+-Fix main-eqiad_to_main-codfw Mirror alert

1029272f79-+-Remove unused role::kafka::main::mirror and set up main MM alerts

b0657fb495-+-Configure jmx_exporter prometheus config for kafka main (mirror)

029e25c2cf-+-Use --new.consumer for main codfw -> eqiad MirrorMaker

d1fffbdc60-+-Use profile::kafka::mirror with --new.consumer for main-codfw -> main-eqiad

5520617ace-+-Blacklist mediawiki.job and change-prop from cross DC main <-> main mirror

ac4c344fef-+-kibana: fix short URL issue

04d0eee3c8-+-kubeconfig: Allow setting the namespace for a context

912edbe0f0-+-Point refine job at 0.0.62 jar version

513078d056-+-Add $delete paramater to dumps::web::fetches::job

b3303eb6ec-+-Remove trailing / from rsync locations

f880f422f8-+-Re-enable dumps/other fetcher rsync job, simplify jobs

255470b53f-+-Enable base::service_auto_restart for prometheus-ircd-exporter

baecd6a3d9-+-wdqs: LVS and conftool configuration for new wdqs-internal service

649e622eab-+-Add mcrouter module and mcrouter_wancache profile and enable on beta

6920d6fcc4-+-Add varnish::trusted_proxies

5f30bf9875-+-Remove obsolete imagescaler logic from swift proxy

ca9e97ef51-+-Enable base::service_auto_restart for prometheus-blazegraph-exporter

a3368300f7-+-Enable base::service_auto_restart for prometheus-wmf-elasticsearch-exporter

48c4367b85-+-maps: fixed typo in populate_admin() cron

6ae742d968-+-maps: run populate_admin() regularly

d7cefaf872-+-Enable base::service_auto_restart for zuul-merger

358f36f357-+-netbox: add postgreSQL slave monitoring

7a88bede95-+-Use ::exim4 consistently when applying class

2e18a0a86a-+-webperf and coal: add scap_target stanzas

44c778df9c-+-aptrepo::wikimedia: convert from role to profile

f97ae91bd0-+-installserver: convert nested roles to profiles

d1e7125723-+-Revert "beta: Combine commons, deployments, meta and zero vhost (2)"

d44a54bc93-+-beta: Combine commons, deployments, meta and zero vhost (2)

e4bd4a49a0-+-Openstack version -> Mitaka almost everywhere

5cde621e86-+-Deprecate --autoload in uwsgi::app

68d3196de3-+-Add maven-debian-helper to package list

6159e77053-+-Add ivy-debian-helper to package list

232d6c95dc-+-stop dumps-related cron jobs on labstore1003

bc8560a30f-+-role::beta::mediawiki: remove inclusion of base::firewall

e1fdc17f40-+-role::analytics_cluster::coordinator: add the eventlogging whitelist

fa16342ac4-+-no stat1005 /sv/dumps rsyncs to dumps servers until there's data

d53058c1e1-+-toolforge: add mr (Marathi) language pack and locale

8f05752cea-+-Fix rsync module refernce for stats_dumps

8dcf0d79bb-+-Use valid minute for stat_dumps fetch job

637bc97a06-+-Fix typo in stat_dumps jobs

ab6918571a-+-dumps: Add rsync fetch jobs for datasets in stat1005

127d267548-+-Mark notebook1001 as spare and remove unused paws_internal classes

f9e7e83239-+-Host deployment charts at releases.wikimedia.org/charts

860482004d-+-Revert "Revert "Run initSiteStats twice a month""

e5ce0f9abd-+-Revert "Run initSiteStats twice a month"

64936d391a-+-Run initSiteStats twice a month

32d60189e5-+-Revert "beta: Combine commons, deployments, meta and zero vhost"

f4af48d2c8-+-beta: Combine commons, deployments, meta and zero vhost

e90fa8f458-+-Move sqooping of mediawiki to the 5th of month

b8e159679e-+-puppet-agent: log puppet runs via syslog

388d0141ef-+-Disable PrivateTmp via systemd override for video scalers

db315ecf46-+-Enable base::service_auto_restart for uwsgi-puppetboard

728b36cd8b-+-pybal::monitoring: install libwww-perl

4b86b37184-+-Turn off incoming rsyncs of various datasets to dataset1001

be345c2baf-+-remove ms1001 from dump rsync targets

e805c66914-+-Disable PrivateTmp via systemd override for stretch-based app servers

09d80d9f11-+-Remove profile::beta::icu57

efb9e00695-+-Update ORES venv path to use versioned cache

50cc18d8c8-+-WMCS puppet enc api: remove --autoload from uwsgi service settings.

0b9152c8fe-+-base: auto logout idle bash shells after 2 days

5a5a0b8e2b-+-dumps: Clean up code that rsyncs to labstore1003

003a1ba893-+-dumps: Turn off cron that rsyncs to labstore1003

a79e61d505-+-nfsclient: Cleanup absented dumps mount from labstore1003

4f5c3194eb-+-cassandra/icinga: make monitoring configurable, skip on dev

27f13ac31c-+-Install git-lfs on scap source and target

3d2113e06c-+-role:mariadb::misc::el::replica: add new yaml whitelist to db1108

316fcdf56a-+-profile::mariadb::misc::el::sanitization: add package

7d534bce2e-+-profile::prometheus::alerts: tune mirror maker alert

7cb8bbf0cc-+-network::constants: add conf100[456] to zookeeper_main_hosts

2dec827471-+-mariadb: Move db2069 from s1 to x1

10dbf9052c-+-openstack: apt proxy allowance for instances

bf11992b3c-+-Use spark2 for Refine job and banner-streaming job

d523cc0511-+-Install the Spark 2 yarn shuffle service jar over Spark 1's

9362deda50-+-turn off public dumps mirror rsync access to dataset1001

2b7e4a4e94-+-remove dumps web server from dataset1001 and ms1001

19a4a54265-+-maps: add Java proxy to cleartables_sync cron

4b9769146d-+-varnish: varnishxcache post-removal cleanup

12060ae327-+-logstash: add icinga check of logstash TCP ports

3636238ca9-+-role::configcluster_stretch: add IPv6 static addresses

0f6890bc0c-+-lvs: Get rid of interface names on site.pp

bd3d914634-+-varnish: Remove varnishxcache python daemon

5a1bb469b4-+-openstack: when applicable setup bridge interface

37952bb087-+-check_http_varnish: bump check_interval

eaf20798ad-+-Allow for different storage_id in kartotherian and tilerator

4cb3ece21e-+-tilerator: Add sudo rule for tileratorui

0d95c283c6-+-mariadb: migrate sanitarium to role/profile and abstract instances

b9659cedf4-+-Remove mw1259/mw1260 from site.pp

185baa758b-+-mediawiki: increase speed of deleteAutoPatrolLogs in wikidatawiki

4b2e5d171f-+-profile::kafka::mirror::alerts: escape some unusual chars in the query

5098a4c986-+-installserver: add monitoring for TFTP

b71b5e93ea-+-bastionhost::pop: use profile instead of role for TFTP

389c49c93d-+-installserver: convert tftp role to profile

6136d7b59e-+-Logstash: Add initial network syslog parsing

235946ac1c-+-profile::kafka::mirror::alerts: skip some topics while checking lag

6d276d808d-+-Revert "Logstash: Add initial network syslog parsing"

78d183f78b-+-Logstash: Add initial network syslog parsing

36dd660913-+-Revert "varnish: restart backends every 3.5 days"

ef45d1ea5b-+-profile::zookeeper::server: fix prometheus query string

b21446c08d-+-profile::zookeeper::server: move monitoring/alerting to Prometheus

6bb5ac9ca6-+-Set zookeeper_cluster label for Zookeeper server prometheus monitoring

0b1a32743f-+-Enable icu57 component for jessie-based app servers

302e4ab6df-+-burrow: fix creation of pid file under /var/run

9865b6d83d-+-mediawiki: Start deleteAutoPatrolLogs from Wikidata logging table

11ed35f1a8-+-mariadb: Move db2092 to s1

b91532b43b-+-burrow: configuration upgrade to support 1.0

c0f20e3fde-+-static_bugzilla: ensure absence of rsyncd after maintenance

0692ed737d-+-static_bugzilla: reverse rsync direction after bromine reinstall

89bbc1a92d-+-Gerrit: Add missing resource /var/lib/gerrit2/review_site

c3f04ca5b9-+-Gerrit: fix invalid relationship for motd file

bbc9030d88-+-Gerrit: symlink in motd.config from deploy repo

1e464b5153-+-mwvagrant: add lxc-update-config to sudoer commands

e30c26c3ad-+-rsync bugzilla-static content from bromine to vega

9bd5b3adf1-+-decom eventlog1001

ceaed7e817-+-Set jmx exporter instance common labels at host level

be793bd4a6-+-decom mw1201-1220 puppet repo entries

e2ee4a2ccd-+-openstack: linux bridge agent physical mappings

5c39d4487e-+-toollabs: apt_pinning: add apache2 package pinning

7601ffa8b5-+-wmcs: monitoring: purge archived metrics every 90 days

d2f7c0a4b1-+-striker: mask out default uwsgi service

05c2c918dc-+-mwvagrant: Add sudoer rules for `vagrant up`

34ffa8660f-+-Make labtestservices2003 a temporary nodepool test box

77c1dd083b-+-remove nitrogen and nihal from site.pp and install_server

e8e3d7d8ef-+-Fix parameters for statistics::dataset_mount on swap

b4cca8aa6c-+-Fix typo

3b1ffbc85f-+-Mount dumps on swap nodes

fa58805011-+-Enable base::service_auto_restart for prometheus-postgres-exporter

9f238c64a6-+-wdqs: configure new servers wdqs100[6-8]

10af72637d-+-dbstore1001: Set puppet role as mariadb-backups

6dee4f3e59-+-wmcs: monitoring: rsync directories as well

f8fe99a5dd-+-wmcs: monitoring: rsync recursive

f99b3df179-+-more aggressive cleanup of temp dump files on generating servers

1ea8337d0a-+-decom ocg100[1-3]

734dac4f16-+-updating for wdqs100[678]

5bc5b1828a-+-profile::restbase: add sysctl settings to improve tcp performance

834ef0600f-+-swift: deprecate webob usage in rewrite.py

f20956c329-+-apertium: Add apertium-separable package

11c227297e-+-mediawiki: remove old and finished wikidata cronjob that has been stopped

110631df78-+-smart: fix apt::pin package definition

bbb8a46177-+-base: enable exporting SMART metrics by default

e02b174d48-+-varnishxcps: post-removal cleanup

6005616fa0-+-varnishxcps: remove python daemon

2b6321fa81-+-Enable base::service_auto_restart for Parsoid services on ruthenium

3c71c2ca16-+-installserver: cleanup roles including other roles, pt.1

a3d4fc9ea7-+-Gerrit: Remove requiring /var/lib/gerrit2/review_site/etc

1d90ccde0b-+-Gerrit: Change /var/lib/gerrit -> /var/lib/gerrit2

94656bd653-+-Revert "Revert "Gerrit: Simplify directory structure""

ac955602fe-+-Add osmium and osmborder to maps machines

5532d9100f-+-Revert "Gerrit: Simplify directory structure"

24c32f8f7f-+-Gerrit: Simplify directory structure

1a82eeb2ca-+-Revert "install_server: add Icinga monitoring for TFTP service"

78c0070461-+-wiki replicas: set the index script to run without args in expected ways

38bf9c3003-+-install_server: add Icinga monitoring for TFTP service

7cd2f40338-+-wmcs: monitoring: delay cron running time window

05fb7110f0-+-role::prometheus::ops: rename cluster label for zookeeper

5e71c7a1c3-+-Make 'style' and 'storage id' available to maps services

a9025f67da-+-role::prometheus::ops: add zookeeper jmx configuration

602e9390d2-+-openstack: manage bridges and bridge mappings for l3 and compute

e6c5fc1325-+-role::configcluster: enable zookeeper prometheus monitoring in eqiad

f551e1d7c2-+-Revert "role::prometheus::ops:: add jmx targets for zookeeper"

8c0451a45f-+-role::prometheus::ops:: add jmx targets for zookeeper

3682ddb056-+-Use $mirror_name in produce rate alert

24fdff86b4-+-Enable base::service_auto_restart for cron

fb0cf59160-+-mediawiki::packages::fonts: Remove support for trusty

a82ed42b82-+-wcms: monitoring: use double quotes for puppet to understand \n in file content

d11c10bb85-+-wcms: monitoring: add more rssh configuration for _graphite user

f0fad2432b-+-wmcs: monitoring: fix rsync mechanisms

04d79723a7-+-wmcs: monitoring: fix ssh userkey name

efcac17586-+-wmcs: monitoring: fix usage of puppet variable inside ferm @resolve

efdc45e3f9-+-wmcs: monitoring: rsync whisper files between mon servers

f1b563611e-+-Puppetmaster: store reports also in puppetdb

dfa1a327a6-+-profile::hadoop::common: allow to enable/disable the HDFS trash

c27cd6bd89-+-profile::kafka::mirror::alerts: fix monitoring query string

75831e2b90-+-Can't use ':' in client.id

0dd88b9c44-+-wiki replicas: tighten permissions on some configs

b7c2986b52-+-Fix client_id with ${::hostname} MirrorMaker

47f8f43094-+-Use consistent client.id for mirrormaker producer and consumer

1177cdce74-+-Use proper value of mirror_name prometheus label

ff43f2cbe4-+-statistics: Create /srv/dumps directory to host dumps datasets

29bdf929a0-+-Multi process MirrorMaker

9003e404cc-+-statistics: Symlink /mnt/data to nfs share from active server

626266cc9d-+-statistics: Absent existing dumps mount at /mnt/data

0202d1d5c8-+-statistics: Mount dumps share from labstore1006|7 on stat1005|6

bfe37062c2-+-wiki replicas: refactor views to be a profile

6724c23079-+-dumps: Set up symlinks on instances under /public/dumps

f14b92e508-+-dumps: Absent /public/dumps mount served from labstore1003

0e698f853c-+-Removing db1020 site.pp entry

f8212acfe7-+-wiki replicas: record grants and set user for index maintenance script

b94c0525f4-+-nfsclient: Setup dumps mounts from new servers

25398b5bfb-+-dumps: Add labstore1007 to list of hosts for rolling rsync

2b78fc39d0-+-Revert "dumps: Set xmldumps server as localhost for testing"

008a6bce0e-+-dumps: Adjust network saturation thresholds for 10G interface

9df9904735-+-labstore monitoring: Move throughput thresholds to class params

d01a4c77f9-+-network::constants: remove bast1001

3a91862f11-+-site/install/bastionhost: remove bast1001

c0fa677ed5-+-profile::prometheus::alerts: fix new eventlogging alarms

c465a33640-+-eventlogging: move alarms from graphite to prometheus

d4bffb97bf-+-profile::zookeeper:server: add the support for prometheus monitoring

dca73ee621-+-Refactor hadoop/hive monitoring profiles to a simpler structure

2a7d206b30-+-dumps: Move nfs exports config to template

b862d87926-+-site: enable mapped IPv6 on bromine/vega

661816db0c-+-dumps: Add nfs, load, network monitoring for dist servers

f19ca27370-+-Include ores::base on stat nodes

749cddb62a-+-Install python google api client on stretch stat and notebook boxes

4054b799a2-+-profile::kafka::mirror:alerts: fix prometheus query

2c84586c0a-+-Use promethues based alert rather than burrow lag check alert

80034c0bf8-+-labtestweb: correct wikitech_nova_ldap_proxyagent_pass

dce980caa8-+-coal: Need to use a unique consumer group in each data center

babb60219d-+-turn off production of single meta-current page content dump for wikidata

31482cb241-+-clean up internal rsync client list for dumps servers

3736a727aa-+-toolforge: Add tmpreaper with a custom config to web nodes

01a5842ec7-+-Revert "openstack: neutron bridge set default to undef instead of ''"

283c21b9bb-+-openstack: neutron bridge set default to undef instead of ''

500330ae90-+-openstack: add manual bridges for linux bridge agent

e7efee6a14-+-openstack: neutron l3-agent custom iptables behavior

849ee3b5e3-+-openstack: add nbd kernel module to compute nodes

72c825a0b8-+-Store all dataset/dumps mirrors info in one hiera structure, and use it

459fe0f73b-+-coal: be smarter about consuming from Kafka

7e47c3c384-+-dynamicproxy: run logrotate hourly

266ab67f13-+-Be more lenient about MirrorMaker numDroppedMessages alert

e2ba1b5c82-+-Alert on lag in last 30 minutes, alert mirror maker lag for analytics

13165c809c-+-labs: monitoring: fix permissions of /var/log/graphite

3a2551ce09-+-Add profile::kubernetes::deployment_server::git_*

6283c96af7-+-ci: Add kubernetes deployment classes to CI

1876251ff2-+-haproxy: Remove older templates (haproxy<1.7)

17366f9b5e-+-Allow to selectively run time servers on Chrony

08c105cdb3-+-nagios_common: switch to check_prometheus_metric Python implementation

c611ca083e-+-Revert "switch deployment server from tin to deploy1001"

3fc94ab116-+-mariadb backups: Start backups earlier

1b28c7e991-+-bastionhost: add MOTD warning of imminent bast1001 shutdown

e9e3131404-+-switch deployment server from tin to deploy1001

a78343e00a-+-Use scalar in dropped messages prometheus check for mirror maker

b70a0b08ca-+-Fix prometheus_url for mirror maker alert

67ce5e77a3-+-Revert "deployment_server: allow rsyncing of /srv/ to new server"

915cc59d57-+-Fix path to check_kafka_consumer_lag nrpe check

667d15f4cd-+-Add check_prometheus alerts for Kafka MirrorMaker instances.

fb9909afbe-+-Add mirror_name and host as labels for mirror maker prometheus

421fef7bc1-+-Install nrpe check for Kafka consumer lag by checking burrow

e7bb7ba2a9-+-calico: Use the kubelet specific kubeconfig

b26f92f2d6-+-ci: Refactor pipeline deps using separate CI role

05c0afe9ee-+-puppetmaster: swap ssl/server with server/ssl in ca_server

6dd3105796-+-puppetmaster: install keypair for 'puppet' when running as CA

149fee3bc2-+-role::prometheus::analytics: poll cassandra aqs metrics

0a505daff1-+-dump_section.py: Allow manual run of the backup

e520de71af-+-cassandra: upgrade version 2.2 package settings for aqs

63234b5a55-+-statistics::packages: deploy 'python3-protobuf' only on stretch

3029876cf8-+-cassandra: include conf files in both 3.x and dev versions

ba86d15d6d-+-deployment_server: allow rsyncing of /srv/ to new server

e21195d894-+-icinga/mobileapps: add mobileapp contacts to service

2905f1305e-+-Add interlanguage reportupdater job

def9ab7328-+-Install python protobuf package on stat and notebook hosts for python facets

91a9cfa5e1-+-Puppetboard: add HTTP monitoring

ffa381e5c8-+-Don't include mediawiki fonts list in toollabs::exec_environ

640eafef7f-+-etcd::v3::monitoring: actually monitor the endpoint from NRPE

f47f012b96-+-Add prometheus::jmx_exporter_config for main -> jumbo MirrorMaker

09227350e1-+-Enable base::service_auto_restart for prometheus-hhvm-exporter

9fae3b68a4-+-profile::etcd:v3: fix peer port

661eea7bda-+-Use profile::kafka::mirror for main -> jumbo

76b98c5785-+-coal: move conf to systemd only and add dedicated logging dir

2d0dd9c44f-+-profile::etcd::v3: make private key readable by group etcd

ba16098b0a-+-etcd::v3: use the correct fact as default

3ebd05cc09-+-Use --new.consumer for main -> jumbo mirror maker

275a4d520c-+-profile::etcd::v3: fix some configurations

b54f0cfd84-+-profile::etcd::v3: fix monitoring declaration, and monitoring script

ce0cc53bc1-+-site: apply configcluster_stretch to conf1004-6

0180b149a1-+-role: add configcluster_stretch

49e9d5cd9e-+-lvs1007-12: remove LVS config bits everywhere

fed536530c-+-lvs - use new fact to determine bnx2x

c8bf121599-+-site: add ms-be204[0-3]

eb6727773d-+-etcd::v3: add basic monitoring

621c0e62bb-+-etcd: add class for v3 basic installation

9d5ac16086-+-Puppetboard: ferm, open port 80

55202d4c9a-+-Assign role::spare::system to eventlog1001

a749fdc152-+-Puppetboard: enable apache proxy modules

3f9622d330-+-Don't add IPv6 in Cloud VPS

7c2924ee1f-+-Phabricator: Support php 7.2 under stretch

45f4988bea-+-wiki replicas: script index creation for easier maintenance

1217055eeb-+-graphite: labs: create /srv/carbon/whisper/archived_metrics/

056cd2050e-+-labs: monitoring: get libapache2-mod-uwsgi insalled

014df8bbba-+-decom of db1001, db1011, and db1016

a32fe92690-+-labs: graphite: install uwsgi

3991cbfa96-+-labweb: remove obsolete wikitech code

1f786f3f4b-+-labweb: clean up a bunch of obsolete horizon code

dd23e4b17a-+-horizon: add a maintenance page, switched on via a hiera setting

55f5ae21f2-+-Add cron job for expired userrights maintenance script

01fe4da203-+-labs: graphite: enable several required apache modules

313d6a0bcb-+-varnish: cleanup after upgrade to v5

0d116db5a2-+-lab: monitoring: include apache mod rewrite

64c351362a-+-labs: monitoring: install python-novaclient

3b5b3f0613-+-labs: monitoring: include openstack client libs

f3f872f716-+-remove lvs1007-10 from lvs_class_hosts

6d2ed2d334-+-Remove the slow-parse logs dataset cleanup job

14bf9d0fcd-+-Restrict inclusion of full PHP packages on deployment servers to jessie

56a2dee0c1-+-mediawiki::php: re-add mail.ini to jessie

3246c148cd-+-php7 manifests for mediawiki on stretch

ffbba9a1fa-+-Abstract Gerrit's public key out of gerrit::jetty

3bc1b0906e-+-Gerrit: Allow enabling of tls encryption for SMTP

57f162d5be-+-tmux/screen: retry_internal set to 10 mins

d67b712b9a-+-base/icinga: add Hiera override to skip systemd monitoring

996940b9ce-+-coal: Process from Kafka instead of from ZMQ

580371dd9b-+-Install python3 packages; configure user venvs from requirements

a4b5a948c9-+-Add blubber to docker integration agents

26193c5968-+-pybal: Fix prometheus bgp sessions query

221f9998a7-+-eventlogging_cleaner: add a new parameter to ease labs testing

d24bf45dd5-+-pybal: Prometheus based icinga check for BGP established sessions

7c5763424c-+-Enable base::service_auto_restart for systemd-journald

9f30a6a61c-+-mariadb: Move parsercaches socket location to the default one

3a2d1ce2fc-+-Enable base::service_auto_restart for systemd-timesyncd

c7b38713c1-+-mariadb: Remove db1001

c6b3db7bee-+-mediawiki::deployment: stretch support for php-readline package

986443ad84-+-mediawiki::deployment: don't use mysql module, fix stretch suppport

fdb8f97158-+-Revert "cloud novaproxy: Set a custom logrotate config for nginx"

358164195a-+-cloud novaproxy: Set a custom logrotate config for nginx

18c54a0560-+-add deployment_server role to deploy1001

7c5e48c2a8-+-Puppetboard: use Puppet CA to verify SSL cert

295b77b7a8-+-role::eventlogging::analytics::mysql: follow up previous commit

c1b49507eb-+-role::eventlogging::analytics::mysql: allow a labs config

27d468e27d-+-role::eventlogging::analytics::server: allow deployment-prep usage

b781301b3c-+-openstack: stop managing l3-agent external ip manually

ef0a10a378-+-remove 'puppet' module

6053d38605-+-remove role::puppet::self

629e7733ab-+-openstack: ml2 settings and allow disabling l3 agent

ffd6d36ce9-+-network::constants: add deploy1001 as deployment server

28d66ff1f1-+-Revert "bump vcl reload delay by 3.6s"

325f50966e-+-profile::mariadb::misc::eventlogging: create dirs for maintenance scripts

8a2a166b2c-+-Puppetboard: allow to connect to puppetdb

cbf80589c0-+-site.pp: fix typo

ef87d48ad8-+-labtestwikitech: remove prometheus monitoring of this db

4a4607ba55-+-codfw: assign roles to the new appservers

0f64dfedb4-+-prometheus: Add kubernetes pods jobs

b830d966c4-+-Horizon: remove singular horizon_host hiera setting and all uses

ed7416b662-+-Puppetboard: adjust uwsgi config

a18d448b72-+-Enable base::service_auto_restart for nagios-nrpe-server

8aad17f455-+-profile::hadoop:balancer: fix logrotate source

d674c7695f-+-prometheus: server: remove apt pinning declaration

61cb00dacb-+-mediawiki: Remove unused python-pygments package

8f6d477d55-+-Refactor the last bits of the Analytics code not following role/profile

24da7698e8-+-prometheus: server: install depends packages from jessie-backports

02ab0d7f91-+-Add conftool::scripts to Prometheus servers

e21a9a244a-+-site.pp: put labmon1002 into work

24629b510f-+-mariadb: Move db1065 to misc

cd74bb203b-+-profile::analytics::cluster::client: remove useless sudo for nrpe check

152a8c7c49-+-cumin: point cumin master to puppetdb1001

f642c8400b-+-misc.pp: Fix typo

24d5b34803-+-prometheus: unbreak pdus, redis exporters

643fe2fc56-+-mariadb: Move default socket for misc services to /run

ceb3d8a985-+-prometheus: unbreak all jmx-originated metrics collection

a015920e66-+-mariadb: Get ready to decommission db1020

60a1f03d5b-+-Add ping1001 to puppet (test)

f5af9065ab-+-tcpircbot: add deploy1001 as allowed host

8192643602-+-site: add mw2259-mw2290 with role spare, per row

5f119ead8c-+-Puppetboard: add make, required for its deployment

db10473b21-+-puppetdbquery: upgrade to 3.0.1

064d27ea35-+-decom db1009

0fe29452e2-+-bastionhost: sync /home from bast1001 to bast1002

9ddef84d72-+-Puppetboard: add missing call to httpd class

d173ccab71-+-network::constants: add bast1002 as bastion server

c6d80eab77-+-Enable base::service_auto_restart for librenms-ircbot

018b079d09-+-varnishospital: send origin servers health logs to logstash

578c98e168-+-Puppetboard: add role, profile and configuration

519467a27d-+-labtestwikitech: use default mysql socket file

83c4099b74-+-mariadb: Switchover m1 master from db1016 to db1063

4e0f8b4f3c-+-puppetmaster: disable puppet-master service

89dec0de45-+-labtestwikitech: second attempt to set proper $basedir

6e3f7ab5fd-+-Bump scap package version to 3.7.7-1

5d1ff0a187-+-labtestwikitech db: set proper $basedir

e16569e016-+-Revert "mediawiki::packages::fonts: Remove support for trusty"

1338bb6b52-+-toollabs: exec_eviron: drop fonts-ipafont-gothic package declaration

4c41f13da1-+-Clone operations/deployment-charts on deployment servers

23f65ec408-+-mediawiki::packages::fonts: Remove support for trusty

85f4e53c89-+-mediawiki::hhvm: move to profile

dba88e00ac-+-Add advisorswiki to $private_wikis

eab3d25621-+-hhvm: remove deep hiera_hash call inside the class

922b921141-+-Refactor stat1005's roles into role/profiles

3195aca75e-+-profile::analytics::cluster::client: add check for /mnt/hdfs

8bb7600fce-+-dumps: Enable fetcher for labstore1006|7

e1da3b27d0-+-dumps: Remove slowparse rsync related code

40666f6792-+-dumps: Absent slowparse logs rsync config

9f3a913e6e-+-slow-parse: Remove code for rsync to dumps servers

208986d995-+-slow-parse: Turn off rsync from mwlog1001 to dumps servers

cea3c0b0db-+-site: unify bast1001/1002 stanza, add IPv6 for bast1002

bafcd8462d-+-Netbox: Move configuration to /etc/

3dc6bebd21-+-microsites::design: enable cloning from 2 new repos

d35252a7bf-+-site: turn bast1002 into a bastion host

9459c5f874-+-openstack: ml2 and linuxbridge_agent setup

5689865b5c-+-bump vcl reload delay by 3.6s

c5223449ba-+-auto-discard vcls when reloading

c18ca272e8-+-puppet_compiler: add support for puppetdb4 and local postgresql

e9f388eb4d-+-NFS: add custom script to generate target hosts

e422043db1-+-requesttracker: remove NameVirtualHost

d8e4b1e7f3-+-Include proper eventloggingctl script for jessie

cf715f7e51-+-Set retries=3 for eventbus kafka producer

f05e2c98d3-+-role::analytics_cluster::client: move config to a separate profile

e1263c92ad-+-hhvm: remove legacy diamond collectors

29dc27ca2f-+-hhvm::admin: fix location of references

537fcb6e54-+-Repurpose four image scalers as video scalers

6bef605829-+-mariadb: Set db1009 to spare

faf823642b-+-profile::hadoop::common: force the datanode to tolerate two disk failures

39dfa46ad9-+-Enable base::service_auto_restart for prometheus-apache-exporter

b386830c47-+-mariadb: Move db1106 from s5 to s1

92ed1a67c0-+-geowiki::job::monitoring: disable old/not-useful cron

749348cdb0-+-site/webserver_misc_static: add vega as codfw node

5a159bd63c-+-openstack: pass down network_flat_name variable

49808a8fa8-+-openstack: labtestn values for ml2 and linuxbridge setup

dbb05b2f6b-+-Exclude change-prop topics from main -> jumbo MirrorMaker

3cb1f9c5a5-+-californium: mark as spare system

4daad2d579-+-openstack: neutron-server ferm rule for default port

01bede05e7-+-openstack: labtestn pass in dhcp_domain for dhcp-agent

89c7005212-+-openstack: neutron component annotations

921882a0d6-+-Rename role::mariadb::wikitech to role::mariadb::labtestwikitech

459aaeaf73-+-hhvm::admin: convert to using httpd instead of apache

223b2e32e7-+-profile::hadoop: add explicit ordering between daemons and jmx agent

8a74935793-+-Revert back to Kafka analytics for eventlogging eventbus mysql consumer

7e79228cd0-+-Remove support for experimental section

3ca89d3cef-+-openstack: trial of mixed mitaka/liberty nova compute

3ad095a764-+-hhvm::admin: remove inclusion of apache::mod::proxy_fcgi

288de80f7c-+-openstack: neutron l3-agent sysctl settings

12bfc26274-+-profile::etcd::tlsproxy: allow more configuration options

3801d36e8f-+-Revert "Temporarily remove mwdebug2001 from debug proxy aliases"

a85a243b77-+-Assign role::analytics_cluster::hadoop::worker to analytics1077

806faea21d-+-profile::hadoop::monitoring: add explicit dependency to cdh::hadoop

ffac26b163-+-LibreNMS: IRC alerts on -operations

a022c547dc-+-dumps: Open up nfs ports in labstore1006|7 to analytics_networks

ab49ce6165-+-openstack: neutron ml2 for labtestn virt

f580f72fdd-+-openstack: neutron change for agent registration

5bfc82afca-+-Puppetization for newer SWAP (JupyterHub)

0ec9ea7422-+-mediawiki_singlenode: apache -> httpd module

7ad90fdc16-+-decom elastic1021

df66217587-+-openstack: ml2 for neutron server require package

38dfde373c-+-wdqs: add pigz package

4f3e46dcda-+-elastic: decommission elastic1021

0add469166-+-openstack: enable audit check for kernel versions

21589870c4-+-openstack: pass network_flat_interface to ml2 setup

fa14b22bf6-+-Toolforge:puppet-apt-pinning upgrading kubernetes version for PAWS

654584baff-+-openstack: apply profile::openstack::labtestn::neutron::ml2

5987e08748-+-Assign role::analytics_cluster::hadoop::worker to analytics1076

74b18ea530-+-profile::hadoop: refactor depencencies to reduce confusion

08a19feac2-+-openstack: pass in relevant params for template fulfillment

d123bf1c6f-+-Remove the now defunct ops-staff-group

079c43c190-+-kubernetes: Allow setting service-node-port-range

e73027b7af-+-dbproxy: Allow exim hosts to connect to misc proxies

0c801543bf-+-Add Thumbor private container user configuration keys

49e91f5778-+-mariadb: Switchover master from db1020 to db1051

3da53b8f4f-+-Netbox: change the owner of conf files so scap can use them

ded4858226-+-Prepare kubernetes nodes for serving mathoid traffic

11eecedafb-+-dumps: Add static ipv6 to new distribution servers

26fa172630-+-db2012 decom

bf40d8fd31-+-setting new labvirts to spare role

e6a548b7f7-+-openstack: neutron file permissions adjustments

a2bbf12262-+-dumps: Set xmldumps server as localhost for testing

a89f23bb13-+-dumps: Setup web server config in distribution hosts

348c3dbded-+-labtestweb: refactor to more closely resemble the labweb* deploy

1ace5f26f0-+-Remove eventlogging-analytics camus job

0f285945d7-+-wikitech-static: monitor using check_https_url_at_address_for_string

c1e855b81b-+-toolforge: Update role and hiera for elasticsearch 5.5

77c230f127-+-decom db1043

d284f78d47-+-dbproxy: Add netmon1003 to the list of misc allowed services

59bb0ae1a1-+-Whitelist not set, but still getting validation error from puppet, trying false

1ecbdb7ad9-+-Blacklist mediawiki.job topics from replication main -> jumbo

1c8db6692f-+-Enable base::service_auto_restart for lldpd

3625fdf329-+-horizon: one more cleanup of default 'newhorizon' arg

c374df4105-+-dbproxy: Reenable firewall on passive m1 & m2 proxies with holes

0f5853da1f-+-wdqs: collect prometheus metrics for both wdqs clusters

b2fdc8c54e-+-openstack: labtestn initial neutron components

e1c074cea9-+-Point eventlogging analytics and webperf processes at Kafka jumbo

5c30c76221-+-Remove further package leftovers after jessie->stretch upgrades

98983f0d3f-+-Assign role::analytics_cluster::hadoop::worker to analytics1076

6594914c3c-+-profile::hadoop::monitoring: add require for hadoop common config

0c1f7def66-+-bacula: remove trailing slash for /srv/backups file set

8173a112c6-+-bacula: restore fileset mysql-srv-backups to fix director

e60a12d2ff-+-restbase: allow to skip monitoring, disable on dev hosts

3651d14c22-+-rm restbase::monitoring, remnants of module

c6a8895e6e-+-decom of xenon, cerium, & praseodymium

797ff4e641-+-decom restbase-test200[123]

6d2b61d021-+-decom db2030

f1eefec4ea-+-openstack: labtestn initial neutron framework

3d3bc6e3e5-+-icinga: refresh wikitech-static monitoring and alerting

97b5031893-+-rabbitmq: handle dynamic resource names for deduping

628fcd707c-+-openstack: rabbit codify nova user

a8e87be905-+-Enable base::service_auto_restart for prometheus-node-exporter

a322c7504b-+-Populate kubeconfigs on deployment server

277afc07ab-+-Assign role::analytics_cluster::hadoop::worker to analytics1074

66e70345f7-+-profile::hadoop::worker: use require instead of include

e3842a40f2-+-Use roundrobin partition.assignment.strategy for Kafka MirrorMaker

92b4b8e672-+-kubernetes: Ignore WATCHLIST latencies as well

7733995c99-+-eqsin: add ripe-atlas ping measurement monitoring

df49507a24-+-varnish: restart backends every 3.5 days

202ba6372e-+-Assign role::analytics_cluster::hadoop::worker to analytics1073

a6553ddb63-+-mariadb: Move db1063 and db1051 to m1 and m2 respectively

b46b555a3a-+-Assing role::analytics_cluster::hadoop::worker to analytics1072

f68e89f99d-+-Enable base::service_auto_restart for exim4/sender config

479729c712-+-statistics::wmde::graphite: depend on generic php-xml

b8f5234417-+-statistics::wmde::graphite: Use non-virtual package name on stretch

8dfcdef1ad-+-Enable base::service_auto_restart for diamond

e846fc1f2d-+-statistics::packages: Use non-virtual package name on stretch

acfd2b15e1-+-statistics::user: avoid adding 'stats' to 'wikidev'

10dce5dd59-+-profile::geowiki: disable periodic data quality check (cronspam)

fdcf4894e4-+-tendril: add support for stretch/php7

ecebfa076d-+-tendril: apache -> httpd module

b2b804891e-+-gerrit: skip gerrit process monitoring if on slave

3ca48af991-+-remove outdated references to wikitech on silver

63ea9a64e8-+-Blacklist InputDeviceDynamics schema from Hive refine

18eac0483f-+-Icinga: Add WebPageReplay Grafana performance alerts

7337aa4c21-+-openstack: labtestn/net role uncomment config

02bc1d9d51-+-openstack: labtestn neutron* host eth1.2120 ip

fc188ce2a2-+-openstack: dealing with libvirt differences trusty vs jessie

495c2b8a3c-+-silver: remove wikitech, mark as spare

cf6a62a629-+-Add --queue opt default to production for Refine jobs

9e6f1702dc-+-Apply geocode, deduplicate and monitoring for refine jobs

9468a3970b-+-Use proper kafka protocol version for varnishkafka webrequest

fbe45e491c-+-openstack: set certname libvirt group

2ef1f04431-+-puppet: remove all references to mw2097-2134

9f02429cf5-+-Add consumer ID to Updater launch string

72bb21d336-+-eventlogging: reduce eventlog1001's scope

c8b00f7555-+-openstack: nova-compute on mitaka and jessie changes

56087771bf-+-labweb: add wikitech-static monitoring to labweb hosts

51ab991c6a-+-Decom restbase-test cluster and role

ee1bda7d40-+-Use versioned refinery-job .jar for json_refine job

1b16567092-+-openstack: labtestn comment out base::firewall for now

b53985dfb2-+-openstack: nova-compute jessie mitaka setup

e48ea5badd-+-Mariadb backups: improve role puppettization

1d31c3c6e6-+-Enable grafana alerts for jobqueue-eventbus dashboard.

3ce77e471d-+-codfw: remove stale references to mw2118-9

c01b8bdd0a-+-scap::target: Install git-lfs

aac4d5119f-+-codfw: decommission mw2097-mw2134

22030176ff-+-wikitech_static_sync: fix broken file dependency

1e504fe827-+-wikitech-static sync: tidy up the dump process

ab6d776bd9-+-wikitech: move wikitech-static backup job from silver to labweb1001

653177d3d6-+-systemd: various fixes

7ec658111d-+-statistics::rsync::eventlogging: change rsync target to eventlog1002

3088dbabb2-+-fix puppetdb terminus package conflict in ::puppetmaster

260178a55c-+-mariadb: Initial setup for db1113

fd0af13999-+-site.pp: Remove comments about db1113

fda02ea144-+-wdqs: configure new servers wdqs200[4-6]

8dcf3eb039-+-dumps: Refactor fetcher profile

cf63eb4bb6-+-site.pp: Clarify db1113 status

1b6beefa31-+-dumps: Rename and move distribution hiera rsync config

b71a7a71e7-+-add puppetdb4 support to puppetmaster::puppetdb::client

15d64e8587-+-Having trouble with too many tcp connections!

b52852f599-+-Conditionally include MirrorMaker instances

cc54d33af7-+-Set up temporary secondary EventLogging camus-analytics job

40c462196b-+-Refactor cache::kafka::eventlogging into profile

7314e832c8-+-eventlogging: fix the nagios check when using systemd

7a4a97d02b-+-Global scheduler_maximum_allocation_mb, vary nodemanager_resource_memory_mb

aabe7f8276-+-openstack: nova bootstrapping with mitaka and debian

4c95b3aacc-+-puppetdb: add puppetdb4 apt component when puppetdb_major_version == 4

38290692f5-+-add puppetdb role to puppetdb[12]001 servers

4bc490d399-+-openstack: Refactor dns-floating-ip-updater.py script

553218b499-+-site.pp: db1009 is not a master anymore

79fd5f277c-+-Remove no longer needed camus mediawiki-analytics job

17d56f2900-+-site.pp: Make db1073 master

648fb0b40c-+-eqsin: configure public endpoints monitoring

bf50db8599-+-Revert "Add consumer ID to Updater launch string"

e144310794-+-Add consumer ID to Updater launch string

b5284918f7-+-Temporarily remove mwdebug2001 from debug proxy aliases

f8464b3004-+-Apply role::eventlogging::analytics to eventlog1002

ee09a54b53-+-wdqs: configure the new internal cluster

053a40cf47-+-wdqs: cleanup reference to wdqs class as default parameter of wdqs::gui

b5a76e9bf3-+-Icinga: add EtcdConfig sync check on MW hosts

76eeb855fe-+-mariadb-backups: Allow backup consolidation and recovery

7522d8e12f-+-icinga::monitor: fix mw_etcd_config

d1e4e264df-+-role::eventlogging:analytics: include zmq config only on eventlog1001

fb034f9fe5-+-Icinga: use systemd::service for etcd_mw_config

7d78297b06-+-Add analytics1071 to role::analytics_cluster::hadoop::worker

5264c2be70-+-Icinga: add sync check for MW config on etcd

f38da016ef-+-codfw: decommission mw2017-2099

2f96d8a60b-+-mediawiki: add a decommission script

69c3a0f650-+-Switch mjolnir kafka broker to jumbo-eqiad

4d34ee6345-+-openstack: Refactor /root/novaenv.sh

f0e2790bee-+-icinga: script to send custom SMS to Icinga contacts

a0d21637f9-+-openstack: initial nova setup for mitaka

1a967346c2-+-SWAP: set web_proxy and admin groups for new notebook100[34]

a12c439170-+-use hiera3 role/nuyaml backends only in production realm

34c5eb4bd9-+-Set up notebook100[34] with new swap role and jupyterhub profile

e74f008a15-+-Cloud VPS: update bastion banner

8d381d0635-+-Don't require jessie backport version of pyton sklearn in stretch

291e9ba80d-+-Configure YARN memory settings based on total node memory

9c7f32285e-+-role::eventlogging::analytics::files: set su directive to logrotate

3d8f64a548-+-Use hiera3 role/nuyaml backends on >= stretch

720a4b3a63-+-debug_proxy: point to the new codfw test servers

c0fc9015bb-+-labs dns: add some docs for labs-ip-alias-dump

076192030f-+-dns labsaliaser: reload lua script whenever it's updated.

4627e847bd-+-Archiving data on piwik every 8 hrs

763a6489d3-+-role::eventlogging::analytics::files: limit retention of logs in labs

a9af65f325-+-dumps: Rename and move profile with distribution ferm rules

eefe76f253-+-mwdebug: create the two VMs in codfw

d37ca92836-+-site.pp: reorganize MediaWiki appservers in codfw for role/row

86bc7d32bb-+-toollabs: apt_pinning: add NFS package pinning

5f5db43e48-+-dumps: Fold distribution related rsync config to profile/ path

6e831e3212-+-toollabs: apt_pinning: pin more nss/ldap/pam packages

877f259c73-+-wdqs: enable LDF server is now configurable

7c6bcb8710-+-dumps: Split up rsync config to base, mirrors, and datasets

1639a0e2d7-+-dumps: Move rsyncer to distribution profile path and rename

8608e660ae-+-dumps: Switch rsyncer profile to use host settings from hiera

536333cada-+-Add apertium-ukr and apertium-rus-ukr packages

b715db0c62-+-wdqs: replace ::base::firewall with the appropriate profile

a1ca743b35-+-Allow specifying kubelet/kubeproxy username/token

f7ccc2ac51-+-Remove Kafka analytics-eqiad webrequest camus and kafkatee instances

d4a2d20629-+-set new analytics hosts to role spare

b8313635a6-+-Revert: Use hiera3 role/nuyaml backends on >= stretch

6ceda2e631-+-Use hiera3 role/nuyaml backends on >= stretch

6080c83820-+-dumps: Refactor profiles and hierakeys in web/

ddec679b58-+-Add pingback reportupdater job

cf4fe5f79a-+-Migrate webrequest text varnishkafka to Kafka jumbo

b68ccf72df-+-Parameterize kafka_cluster_name for streams_check job

407c856663-+-openstack: set region to codfw1dev-r for labtestn

0d6a8b849b-+-openstack: keystone bootstrap setup for mitaka

28c5a4b076-+-labweb: one and only one host syncing with wikitech-static

84db2177fe-+-profile::tcpircbot: remove eventlog1001 references

37c1726256-+-wdqs: cleanup after removing diamond collectors

733063f1ca-+-wdqs: remove diamond collectors which have been replaced by prometheus

c33c5dbdf0-+-wdqs: wrong escaping of quotes in prometheus check

53b2d39e29-+-role::eventlogging::analytics: deprecate mw.errors.* metrics

b81ec8dcfa-+-wdqs: query used for alerting should be a scalar

31ee8e4e6c-+-wdqs: switch alerting to prometheus instead of icinga

f86031a92e-+-openstack: kvm monitoring threshold 75=>90

210d034020-+-eventlogging: add eventloggingctl script for systemd

1cc338db4e-+-mariadb: Move db1073 to m5

3a65091967-+-labweb wikitech: add a few more apache confs

66a4c6e48e-+-Revert "burrow: ensure pid file is created under /var/run/burrow"

19877723ee-+-burrow: ensure pid file is created under /var/run/burrow

b47ec1351c-+-labweb: disable wikitech-static sync crons

7f935c2716-+-wikitech: remove crons to backup the mediawiki database

9e67562b7b-+-wikitech: remove smw update cron

6c60957761-+-jupyterhub: apache -> httpd module

79044cbda5-+-Remove mariadb from silver

df5f9355e3-+-locales: convert to profile

3a5bc349cc-+-icinga: add stretch compat for php-gd/php7.0-gd

a5a225a19a-+-transparency: add/adjust Apache config for private site

cba8af3009-+-labweb: include scap::scripts

1a57d7d2e6-+-toollabs: base role: adjust system role string

663c38f525-+-toolforge: change test tolerance for paws and trusty grid

df76362214-+-labstore: monitoring: interfaces: reduce check timeframe to 10 mins

b3ffae3530-+-toollabs: introduce role::toollabs::base

c425a422f8-+-apt: unattended-upgrades: don't install apt-show-upgrades

1d441971a5-+-ci: Upgrade docker image version

f290c74878-+-labweb: include equivalent functionality to hhvm::admin

424496e90f-+-icinga: fix php version number on stretch, 7 -> 7.0

9334b3a5d3-+-design.wm.org: prepare for second dir for style guide

99c0c04e9c-+-icinga: apache -> httpd module

f6bbfdf635-+-labweb: include standard vhost snippets from mediawiki::web::sites

4759a42eb4-+-Revert "labweb: include standard vhost snippets from mediawiki::web::sites"

2874310b24-+-labweb: include standard vhost snippets from mediawiki::web::sites

debe10e865-+-Fix kafka configuration ports & cluster string

58a7858960-+-Properly install spark2_oozie_sharelib_install.sh

b5d14d8d1c-+-labweb: include mediawiki profiles

30127814d3-+-xenon: apache -> httpd module

2ee74d5088-+-mariadb: Move db1114 to s1

3f2528c939-+-Automate installation of spark2 oozie sharelib

5f107e4b20-+-Add duplicate mediawiki avro Camus job to consume from Kafka jumbo and analytics

60106d4b91-+-Temporarliy run banner impression spark streaming job from 2.2.1 .jar

fd273e48ba-+-elasticsearch: raise alerting threshold of unassigned shards

60da8d5531-+-varnish: remove service dep on defaults file

b65e25f3c4-+-reload-vcl refactors/improvements

94c4f5a41d-+-mediawiki: move ::hhvm::admin include out of mediawiki module

a767048c51-+-eventlogging: add systemd support

6c8e10f5ed-+-toollabs: introduce base class for all toolforge roles

9cd5442001-+-mariadb-backups: Fix typo on config file

676a47e4cd-+-mariadb: Set up es2001 as the temporary backup target

6c053ff99c-+-wdqs: fix reassignment of existing variable

8d8337e017-+-LibreNMS: fix puppet resource cycle

8abf351db4-+-LibreNMS: Allow librenms to write file in $install_dir

3e0bcb5c18-+-Update the cron command with the new sqoop script

4fbfb3bfea-+-add dhcp netboot and site.pp entries for ganeti VM elnath

b847e8db9c-+-netmon: fix PHP version, 7.0 not 7 is correct

5e6b0d8b1b-+-librenms/netbox: fix dependency cycle apache<->letsencrypt

456556f574-+-netmon/netbox/smokeping/librenms: apache -> httpd module

3acec0752a-+-servermon: apache -> httpd module

1ddb732497-+-wdqs: fix path to new nagios check

7c87a5a603-+-wdqs: icinga check for categories updates

644a8eb83b-+-puppetmaster: clarify why python-mysqldb is present

2c37ec0ddf-+-puppetmaster: naggen2 depends on python-requests

d6eae174dc-+-openstack: glance for mitaka

b2f170eb66-+-openstack: include rabbitmq::plugin for management plugin

da24fe5f40-+-rabbitmq: move management to plugins manifest

a838d3f4d6-+-Fix for eventlogging cache kafka in deployment-prep

dd336cec59-+-wmf-upgrade-and-reboot: upgrade the given host and reboot it

8a93cb8328-+-openstack: labstore monitoring typo fix

4ab384cf28-+-labstore: monitoring changes for critical and contacts

31b1e077ca-+-wdqs: allow configuration of kafka based updates

08610ada7f-+-conftool: add json-schemas for MediaWiki variables validation

8da9e80b37-+-role::netinsight: remove output include directives from config

fbfa01bc9b-+-logstash: removing LTR plugin configuration

94cf84ada9-+-icinga: change alerting for openstack things

6874fa2b63-+-prometheus::tools: add httpd declaration

9d63b84601-+-phragile: apache -> httpd module

7ef9be3b70-+-icinga: create irc-cloud-feed channel for ircbot

2bdaaa753e-+-prometheus::beta: add httpd declaration to role class

9c9ac0a5f9-+-bastionhost::pop: add httpd declaration

093f2335b7-+-labs::graphite: add httpd declaration to role

1322bc13f4-+-prometheus: move httpd declaration to role class

0a129bdd02-+-prometheus: apache -> httpd module

b54fb251fc-+-puppetmaster::frontend: re-add testing vhost

4974e5c4d3-+-rps: change IRQs without reboot on bnx2x

91b53d6956-+-cassandra: use prometheus-jmx-exporter Debian package

02ba74f12a-+-openstack: admin_scripts for mitaka and prometheus package logic

6083353121-+-openstack: keystone running on mitaka setup

a99f22a5c4-+-toollabs: fix path of new canary server list

fbc1b97329-+-toollabs: include clush hosts group for canary servers

50b2e7087b-+-puppetmaster: document 'offline' worker option

07b2b4e415-+-puppetmaster: ruby-activerecord-deprecated-finders not in stretch

bb9e481000-+-Restore ORES celery worker count; kill defaults

339a083a47-+-wikitech: grants for the new labswiki db on m5

86d6acbf4e-+-grafana/racktables/iegreview/misc: apache -> httpd module

cd2307f444-+-openstack: deal with competing version priorties on jessie

fa367a8e71-+-openstack: groundwork for labtestn on mitaka

29977359f2-+-xhgui: apache -> httpd module

f94676bce0-+-lists: move httpd class to role

dc79764752-+-lists: apache -> httpd module

a6fa23c92a-+-numa_networking: remove "isolate" experiment

d2b8634391-+-site.pp: Add a comment about db1113

8514957cf8-+-toollabs: apt_pinning: extend pinnigs for pam libs

e08b3ee992-+-role::kafka::monitoring: add lag monitoring for Jumbo

8e79e66dcc-+-maps: Icinga alert when OSM replication lags

eac7aeedcb-+-prometheus::ops|analytics: update Kafka Burrow's exporter config

ab83aad04a-+-Resize the Cirrus LTR model cache

9cb5e9d9d8-+-tendril: Add memcache to tendril web frontend

7f213ee587-+-Introduce role::kafka::monitoring

52fd26b62d-+-microsites: profile to setup design.wikimedia.org

f4a3a771fe-+-role::striker::web: change distro behavior

a77e7579b9-+-toolschecker: Add the toolschecker word to alert msgs

a94c43dcba-+-kafkamon: add IPv6 mapped IPs

668c4ee3e1-+-role::striker::web: Update to work on Stretch

8430a27846-+-toolforge: tools checker contact_groups add admins

231bd99d1c-+-toolforge: set alerting for tools.checker things

26857baf5c-+-openstack: nova-fullstack test alert on 2 tries

d20f46679f-+-openstack: monitor nova-scheduler as critical

ee11653865-+-toollabs: apt_pinning: extend linux pinning in jessie

15256823d7-+-openstack: nova-conductor critical by deployment

4541e4149e-+-openstack: nova-api set to critical based on deployment

beea7a3f5b-+-openstack: nova-fullstack alert after 1 retry

5c5610301a-+-ferm_wmcs: fix copy/paste error

684dbccc37-+-m5: add ferm rules for new labweb hosts

3fa8b2471a-+-tendril: Fix typo for role on firewall definition

fb180f0f4a-+-mariadb: Fix and standarize firewall holes to all cloud-related mariadbs

ce667192a6-+-toollabs: apt_pinning: be more strict in linux kernel pinning

f4658e5c14-+-site: add kafkamon1001/2001 with role test

622fe5fdc7-+-openstack: designate pass critical from deployment typo

690e68b8b9-+-openstack: designate pass monitoring values through deployment

cac4a6a412-+-openstack: pass critical from deployment

c2524648c8-+-openstack: glance monitoring main should alert wmcs-team

33c615e1e0-+-labweb: create /var/run/nutcracker

96a54b9f5e-+-openstack: nova-fullstack alert wmcs-team

0f2d4c79ba-+-openstack: monitoring change for nova-network and conntrack

bfddedcb85-+-openstack: nova active kvm check to alert multiple groups

5b7405a288-+-openstack: make nova compute kvm monitoring optional

59d2ee933d-+-labweb nutcracker: add non-functional redis host list

d17cfa3bc7-+-labweb nutcracker: re-use profile::mediawiki::nutcracker

e56d382f13-+-tools-static: Change to reverse proxy of cdnjs

4d012201f9-+-tendril: Enable mysql binlog with format ROW

eabdf8f0a9-+-labweb: install nutcracker

10644d03e6-+-Fix logrotate files for ops webrequest kafkatee

c3e9ed9af2-+-role::cache::canary|misc: remove testing vk instance

0699168ce0-+-tendril: MariaDB fixes and tunings

c366bc5b13-+-tendril:Migrate target host of mariadb maintenance to db1115

3471c28d18-+-toollabs: apt_pinning: bump pinning value for kubernetes packages

632434d40a-+-toollabs: apt_pinning: fix typo in nginx-* version pinning for jessie

ec8ae6c7b9-+-Remove ORES profile from scb

1a1de2ce7e-+-mariadb: Add db2090 to s4 section

b327183631-+-role::prometheus::analytics: add Hive Prometheus poll config

d3f67c5cbd-+-role::analytics_cluster::coordinator: rollback oozie prometheus config

7cd90832f1-+-elasticsearch: fix ferm rule for prometheus-wmf-elasticsearch-exporter

e10e8a60e9-+-elasticsearch: fix source instead of content for prometheus-wmf-exporter

116fcd6961-+-elasticsearch: collect elasticsearch metrics on per node percentiles

aad679526a-+-Revert "Revert "MariaDB: Setup db1115 and db2093 as new tendril databases""

2f09983b06-+-Revert "MariaDB: Setup db1115 and db2093 as new tendril databases"

1e8aa897d0-+-Revert "tendril.pp: Fix typo"

1c4ed40c72-+-tendril.pp: Fix typo

2b339f2b4d-+-MariaDB: Setup db1115 and db2093 as new tendril databases

0da185a28b-+-mediawiki: Enable auto_prepend_file setting for HHVM on Beta Cluster

d4dfb0c81e-+-Set up secondary webrequest camus job to consume from jumbo

cf90e8d864-+-Phabricator: restart apache every sunday night

da9e114ebf-+-Set two webrequest kafkatee instances consuming from analytics and jumbo

20ddb154fc-+-Update kafkatee submodule with multi instance support

79ed2c9122-+-Revert "Remove kafkatee as a submodule and re-add it into ops/puppet preserving history"

c180746370-+-Remove kafkatee as a submodule and re-add it into ops/puppet preserving history

865efb58a0-+-toolforge: update pin for kubernetes-client

cbcfec3e2c-+-toolforge: apply pinning to k8s components

320ab89dcd-+-toollabs: add apt pinnings for key packages

f1861835da-+-Revert "toollabs: add apt pinnings for key packages"

e9f5a36fb6-+-toollabs: add apt pinnings for key packages

7cc091a54b-+-horizon/labweb: open firewall to internal IPs for port 80

f7e0be3781-+-labweb: inclued role::lvs::realserver on labweb hosts

53c87869bc-+-horizon: add a missing arg

edda937b7f-+-labweb horizon: share memcached among labwebs

3f11794077-+-Enable base::service_auto_restart for prometheus-openldap-exporter

c56b849a8d-+-mariadb: set db2011 (old codfw:s2) as spare

f339096442-+-profile::hadoop::master|worker: tune again JVM Heap size monitors

1c3c595254-+-profile::hadoop::master|worker: relax JVM heap size monitors

c8a65aab84-+-mariadb: Move db2044 from codfw-core-s4 to codfw-misc-s2

f2a731f74e-+-site.pp: Remove db2037 from s4

939727006b-+-cassandra: create data directories only when needed

eec9ec3416-+-cassandra: create parent data directories with exec

f13f554a1f-+-role::prometheus::ops: correct Kafka Burrow exporter's port

9ba13a68cd-+-mariadb: Move db2037 from s4 role to m5

1f350ffd2b-+-openstack: eth1.2120 for labtestneutron200[12]

1c5c6f9c86-+-Parameterize webrequests from varnishkafka to jumbo Kafka cluster via TLS

6d2ab8951a-+-openstack: use labtestmetal as a virt for now

9a3dff27d1-+-horizon deploy: special weird venv sudo rules

7f7c1bb6c5-+-horizon: include 'gettext' package

de0c12095a-+-Icinga: add asw2-b-eqiad

f92f1dbbd9-+-striker: on Stretch, include libmariadbclient18

a4bb45fcc6-+-role::prometheus::ops: remove broken Kafka burrow config

3513b78ea5-+-thumbor: stop checking individual instance status

e4c606c5b5-+-Give officewiki read access to Thumbor

2db4cd4532-+-Avoid Puppet restarting Thumbor instances agressively

d10a3a4b71-+-Revert "Use security mirrors in cowbuilder apt config"

e6d310168a-+-eqsin: configure cache storage correctly

c45bd1758a-+-Revert "Give officewiki read access to Thumbor"

5436bf34c5-+-Use security mirrors in cowbuilder apt config

1ccae0fc20-+-Give officewiki read access to Thumbor

d092582bdc-+-role::prometheus::analytics|ops: add Kafka Burrow jobs

8ac1fa73c2-+-pybal: check established TCP connections to etcd

a72678b3e2-+-openstack: neutron l3 and service for labtestn

d98319ff89-+-profile::conftool::client: fix pysocks package name on stretch

8530a989f5-+-prometheus: tweak node_exporter ignored_devices and ignored_fs_types

cf23d51886-+-profile::conftool::client: also install pysocks

452453b0cd-+-conftool::scripts: update scripts to work with conftool 1.0

45633cf7bf-+-profile::zookeeper::server: add the correct package name for default-jdk

d3ee7a42ba-+-profile::zookeeper::server: remove explicit java-7 dependency

314c9a76a5-+-striker::build: require libmariadbclient-dev

ea45f950d9-+-striker::build change requirement to debian stretch

032e682227-+-remove role::toollabs::puppetmaster and toollabs::puppetmaster

c5e711c25c-+-labweb: include lbmethod_byrequests

5be298cd9e-+-labweb: include apache proxy_balancer mod for striker

4d68cc1d3c-+-labweb: include apache proxy_http mod for striker

d61ca596a1-+-labweb: include apache expires mod for striker

e689d624a3-+-labweb: include apache proxy mod for striker

18844c1d94-+-dbproxy: Apply followup to fix load balancing syntax

be8c335c2f-+-dbproxy: Fix load balancing syntax and apply it to labsdb1010

21bb6dc466-+-striker: alternate package requirements for Debian

e36ca70563-+-striker::uwsgi: remove requirement for Trusty

dd7a528cd0-+-labweb: add integrated hiera settings, mostly for Striker

8530afc11e-+-labweb: add striker role/profile

d8f6c307aa-+-profile::prometheus::burrow_exporter: set 0.0.0.0 as default listen addr

934d3a2aeb-+-profile::kafka::burrow: add prometheus monitoring

bfcbceef92-+-prometheus: default retention to 24 weeks

06a3f5eb1d-+-Enable base::service_auto_restart for prometheus-etherpad-exporter

8bcf136aeb-+-Remove python3 installation from tools, it is installed everywhere

b276f245d5-+-Move python3 into standard packages, it's 2018 after all.

5375cb8136-+-Decomission old video scalers in eqiad

730c849172-+-mail: switch icinga check to LE variant

4d787858bd-+-site.pp: Clarify db2033 and db2034 status

c249424852-+-labspuppetbackend: rewrite of the read-only security layer

0c53078f17-+-wmcs encapi: preposterous hack to limit POSTs to horizon hosts

df0bb77579-+-Revert "mediawiki: reduce frequency of purge_abusefilter to weekly"

a574799242-+-servers: install hp-health on all HP servers

eaa6629395-+-Mariadb: Schedule db1043 and db2012 for decommission

cb732b313c-+-Mariadb: Set default basedir for phabricator (Mariadb 10.1)

c9174f01c6-+-icinga: add check_established_connections plugin

8f74c12e00-+-mariadb: Change phabricator db config to modern defaults

e3e589ee04-+-mariadb: Move db1053 from eqiad:core:s2 to eqiad:misc:m3 (phabricator)

5d7b9e68c8-+-mariadb: Move db2042 from codfw:core:s1 to misc:s3 (phabricator)

7de7cdb1f9-+-Add support for selective automatic restarts of stateless services

4de54bd236-+-httpd: Make sure we purge package's status.conf

7760147d8f-+-profile::oozie::server: remove symlink installed by Oozie's package

a3f11c2be0-+-otrs: apache -> httpd module

763e6e3e0b-+-lab puppetmasters: allow labweb access via ipv6

3f2eacb05f-+-Re-enable cron job for purging ReadingLists data

f2068d87c2-+-httpd: Bump mod_status priority to 50

7a27403f99-+-Blacklist v4l2-common

081a87fa36-+-uwsgi: Use systemd::tmpfile

c174f36e3f-+-Force jenkins-slave being member of docker

01591f4ab0-+-role::phabricator: add prometheus apache exporter

03134b02bf-+-profile::hive: remove jmx trans and java 7 support

87a93e0dad-+-mariadb: promote db1059 to be the new m3 master

97b5e4342a-+-httpd: add server status page config from apache module

af7dd67b8d-+-icinga: rm temp testing setup, add test-robh to ops

f251153327-+-openstack: monitor kvm processes on labvirts

3d582032d8-+-openstack: fix overlapping descriptions for nova-compute check

045e197c88-+-openstack: alert on down/unreachable nova-compute early

8cd211372c-+-graphite: fix duplicate httpd declaration conflict

5df021b0df-+-eqsin: add bast5001 to network::constants

cb81c83745-+-profile::hadoop::master: fix hadoop-hdfs-capacity-gb-remaining alert

b9e142ec79-+-profile::hadoop: force prometheus critical/warning threshold to int

f30904c0e8-+-profile::hadoop::worker: remove jmxtrans support

fc41cb753c-+-mediawiki: reduce frequency of purge_abusefilter to weekly

1bd233b321-+-cassandra: actually enable component/cassandra311 (not component/cassandra33)

c71da7fb5c-+-cassandra: enable component/cassandra33 where applicable

72192700db-+-statistics::packages: deploy only java 8

0444d1eab1-+-profile::java::analytics: deploy only java 8

0a213d06dc-+-Force JAVA_HOME to openjdk-8's jre for all Hadoop daemons

d09e45504f-+-role::webserver_misc_apps: add kafka burrow lag monitoring for main

e5d4e3265c-+-burrow: add systemd support

5fb8c80aee-+-role::kafka::analytics::burrow: move to profile

d07c4777e2-+-site: decom graphite1002

3b0b00b6b6-+-mariadb: Redo mariadb::backup class into role/profile style

4cbe52c04d-+-swift: add conftool client to proxy

3abec9a6ca-+-Specify the ops-staff-group correctly

4e653bf796-+-Gerrit: Set gerrit.baseUrl in gitiles.config

aa1ec4fe29-+-mediawiki: fix for I3544d91a

1e16cb2777-+-mediawiki: log next run of purge_abusefilter.pp

3e2a66772f-+-wmcs puppetmaster: allow labweb to access apis

01d30d5a01-+-horizon source deploy: allow scap to restart apache2

b65ee2c221-+-keystone: bootstrapping framework for install

71bde69739-+-eqsin: use LVS recdns for normal hosts/installer

2639e8f710-+-graphite: add httpd to production role, not just primary

92a5c5180a-+-keystone: ldap-util issues with differing roles

dc31be5a78-+-keystone: ldap-util can come from multiple places

d96b515cb6-+-keystone: websockify package comes with spiceproxy

ed5600805f-+-keystone: pair down installed package list

b441ef76d2-+-keystone: add missing for installed packages

813d2c5201-+-openstack: labtest codify mysql settings

a44d2e2421-+-EventLogging: emit X-Client-IP and parse as `ip` field

9bd6328c0f-+-pybal::monitoring: use host IP address in check_pybal_ipvs_diff

84b3d90c89-+-Add apt configuration to switch deployment-prep to the ICU57-enabled HHVM build

c2231967b3-+-wmf-upgrade-varnish: initial release

040da7771e-+-RequestTracker: apache -> httpd module

09569f2c0d-+-gerrit: apache -> httpd module

118b9502b9-+-decom db1030

da9169bacb-+-logstash100[1-3] decommission

9fb8d05a60-+-graphite/performance::site: apache -> httpd module

3c2731f461-+-wmflib/prometheus: get_clusters, update Ganglia related comments

8920faf4f7-+-hiera/wmflib/pybal: rename ganglia_clusters to wikimedia_clusters

f7fa8ac34f-+-ntp servers/peers option tweaking

fb32148be6-+-toolforge: add user requested packages

5dfddc1efd-+-ntp server config tweaks

ab55ec549e-+-eqsin: use local NTP, define peers

0065d4f94d-+-phabricator: remove requires for libapache2-mod-php5

3ff33ace11-+-phabricator: apache -> httpd module

e98f03de13-+-icinga: set contact group for paging test host

114f2fc690-+-stat1003 decom

0b86f46fbe-+-eqsin: lvs+dns configuration bits

c63c7c1ca9-+-ulsfo: use local ntp

88c083e05e-+-ulsfo: use local DNS

3a5e1a7fe0-+-designate: allow labweb hosts access to designate api

b947db9668-+-keystone: allow api access to labweb hosts

5afadec1eb-+-Revert "keystone: allow api access to labweb hosts"

a56f4a22ea-+-keystone: allow api access to labweb hosts

4a55db4dc3-+-puppetdb: add support for puppetlabs puppetdb 4.4 package

28b661ff0b-+-puppetdb: add major version parameter and add data types

e6ecf8083b-+-horizon: provide sudo rights to deploy-service, the actual deployer

f759ecd8e0-+-horizon: sudo policy for deploy-service user

f35f3b0727-+-profile::cache::kafka::webrequest::jumbo: fix default kafka cluster

263ddee4e1-+-role::cache::misc: add a ad-hoc varnishkafka instance to test TLS

6e4e747bad-+-ntp: add dns400x to peer lists

21f500f343-+-dns400x: configure role::recursor for ntp+dns

8434cf68eb-+-ntp: use "pool" and "restrict source" on stretch

07de10c8b8-+-ntp peering refactor

6d08e61b42-+-role::logging::kafkatee::webrequest::base: move out code related to outputs

122f4f9e24-+-Enable base::firewall for labweb*

67524107c4-+-apt: merge report-pending-upgrades script into apt-upgrade

a005d1ce8a-+-ircecho: Enable ssl by default

fbc480bcbf-+-ircecho: Support ssl when connecting to irc

7f3fec2b18-+-profile::analytics::refinery::job::json_refine: change netflow's db

0e1cbe3b7d-+-profile::analytics::refinery::job::json_refine: standardize netflow conf

17da5f6799-+-eqsin: netops monitoring defs

4370ae916e-+-kafka1018 decommission

8a634009ff-+-Move labweb1001 and 1002 back to public IPs

01806163a9-+-Reduce redundant default value for ORES worker count

983323f953-+-Reduce ORES workers everywhere

aa307b4f45-+-role::kafka::jumbo::broker: add ipsec configuration to cache hosts

8fbec2b290-+-mariadb: Remove dbstore1001 role

a3e32f36e0-+-role::kafka::jumbo::broker: add static IPV6 mapped addrs

cbe0c6d46a-+-ores: Set oresX00X hosts as role::ores

fc4c6ca60c-+-Remove ores::stresstest as its no longer needed

f6b93fe845-+-Add Matxin MT config

ab02b289af-+-profile::analytics::refinery::job::json_refine: add netflow job

80c822a8ad-+-openstack::common: Add version switching so this can be applied on Stretch

52b133d47c-+-horizon: managehome => true for horizon service user

f547134d04-+-labweb: add profile::openstack::main::horizon::dashboard_source_deploy

6a65eaafb6-+-setting bast1002 install params

02189465aa-+-openstack horizon: rough in manifests for source deploy of Horizon 'queens'

4404189fd1-+-microsites/research: re-enable git cloning

beb4f15e7a-+-openstack: nova-network and neutron nova::common split

815d289219-+-profile::etcd: stagger software RAID checks

2cbfb44307-+-profile::analytics::refinery::job::camus: add netflow hourly job

d1972e8d10-+-aptly: add more attributes to published repos

4efa331a94-+-etcd: fix (again) the parameter type for peers_list

88bb9bc941-+-etcd: fix parameter type

71da209b3b-+-profile::etcd: allow tuning RAFT timeouts

69a2b7c614-+-toolschecker: remove labsdb1001 and labsdb1003

a02d9413b4-+-Gerrit: Remove certificate params

1637fd60e3-+-decom of labsdb100[13]

a09470b4df-+-add puppetdb[12]001 to site.pp with role spare::system

348b750269-+-apt: disable daily cron job from apt-show-versions

95d7007bb9-+-openldap::management: refactoring to profile

56acd64cbb-+-labstore: move to require_package

e7de04d6d6-+-wdqs: remove cleanup code after migrating to prometheus jmx exporter

4fb322d1c8-+-ldap: move things from ldap::role to profile::ldap

f803c91925-+-Gerrit: remove libbcprov-java and libbcpkix-java packages

dcc88d6687-+-Postgres: remove hardcoded version

2f873c9401-+-decom iridium

26ebb5e8dd-+-setting remainder of notebook100[34] install params

fcc997a447-+-openstack: move log permissions handling out of nova::common

1a23080b42-+-remove references to dysprosium and diadem

96f9824e3e-+-openstack: pull appropriate hiera password for cleanup

99a31ca622-+-rabbitmq: handling users and initial setup

7b56d9b3d4-+-designate: ensure consistent state for logrotate mess

12dd7b955e-+-prometheus: aggregate nginx requests and availability

0c567d6ce3-+-netbox: Add IPv6 postgresql::user resource

e816d3c398-+-netbox: Add IPv6 ferm rules as well

96e3fee0bc-+-netbox: Allow slaves to to connect to master

0fc71d0089-+-wdqs: corrected source of jmx exporter configuration

989a90847c-+-netbox: Remove hiera default value

c685f256fd-+-wdqs: fixed typo after introducing prometheus-jmx-exporter

cac8221739-+-wdqs: replace prometheus-wdqs-updater-exporter with prometheus-jmx-exporter

9e0b5dddb8-+-netbox: Only create users/db on master

c3528b5b43-+-netbox: Switch to 4 space indents

1ff6760e4e-+-postgres::slave: Reuse $service_name

d969081582-+-eqsin: deeper configuration details

967563d337-+-postgresql::slave: Granular relationships

8a74898e15-+-thumbor: add conftool client

2b66d38a57-+-Renaming asw-ulsfo to asw2-ulsfo in Icinga, Smokeping and Rancid

60bb9f6233-+-wmcs/wikitech: follow-up for apache->httpd conversion

b3ca877584-+-openstack: unified role wikitech/horizon/striker,apache -> httpd

64385d854b-+-rename piwik::server to just piwik

83224b9332-+-Set ores1* as spare::system

63f35a50e5-+-prometheus: default to storage encoding version 2

57a9c4c2e8-+-prometheus: bump global retention to 15 months

caf0cb11d5-+-mariadb: Remove db1030

88c43843c3-+-Cumin: add custom backend in WMCS

4ae3b351de-+-Add log_segment_bytes param to kafka broker profile

788d2bce4a-+-icinga: add temp contactgroup/host/service for testing SMS content

7614794a09-+-icinga: fix host names for ORES web node monitoring

c09a41fee0-+-Revert "openstack horizon: rough in manifests for source deploy of Horizon 'ocata'"

c57f373713-+-Update location of wikibase-rebuildTermSqlIndex script

431b71d20b-+-openstack horizon: rough in manifests for source deploy of Horizon 'ocata'

d0e25120d7-+-Revert "ci: replace apache with httpd for proxy/website"

31ab59f7a5-+-Revert "ci: replace apache module with httpd module"

937846bc0e-+-ci: replace apache module with httpd module

4b35b7f34e-+-ci: replace apache with httpd for proxy/website

52da8d06c7-+-ganeti: Remove long absented resource

50b8058702-+-package_builder: require dh-make-golang only from stretch onward

b2d13fbc83-+-kubernetes: Enable IPv6 forwarding and accept_ra SLAAC

440f58ea59-+-eventlog1002 install params

cf1cc46706-+-openstack::main: move standard/firewall includes to roles

2b937394d1-+-wmcs::puppetmaster: move standard/firewall include to roles

b88324fa3b-+-horizon: move standard/firewall include to role

7ff1be3eb0-+-site: remove duplicate firewall include on some appservers

abbd20a2f5-+-labtest: move firewall/standard includes to roles

d6c5a2db2b-+-labs::nfs: move standard includes from site to roles

10c50e96d9-+-apache: rm helper_scripts class, mv script to deployment_server

59856ccc7b-+-package_builder: add dh-make-golang to the list of req. packages

9bc0128f56-+-Revert "ircecho: Remove support for sysvinit script"

974bc4c030-+-admin: Use the debian staff group for ops

398d70bde5-+-Revert "role::client::labs: remove hiera defaults that rely on ::global vars"

6b2733c3e0-+-lxc: Fix support for stretch

9e2459acd0-+-mediawiki: Update path to loadExitNodes.php

218543a121-+-ircecho: Remove support for sysvinit script

c6cd7bb82a-+-role::client::labs: remove hiera defaults that rely on ::global vars

845bf5b91c-+-mariadb: Move db1063 to s6

8bd3f21bd5-+-mediawiki_vagrant: for distro warning, use notify

d8dd363c08-+-role::labs::mediawiki_vagrant: one last attempt to understand os_version

41314b968a-+-role::labs::mediawiki_vagrant: another try at excluding stretch

e9bebcfaed-+-role::labs::mediawiki_vagrant: rephrase logic to os_version

77b0f88470-+-role::labs::mediawiki_vagrant:  Warn if not on Jessie

468715891d-+-Make Shiny Server a separate profile

ff27680700-+-Decommission db2016, db2017, db2018, db2019, db2023, db2028, db2029

2842c26570-+-restbase: reprovision restbase200[789]

cc224e360f-+-mariadb: Decommission old codfw masters

64aeafd9ea-+-Create module for docker-pkg software

79a937f77f-+-mariadb: Decommission db1031

531d1da36f-+-profile::hadoop::worker: install spark2 package after Hive config

686efc9193-+-Remove firejail config for now-unused ffmpeg2theora

32843720bc-+-mariadb: Move db2034 from s1 to x1 master

f68ded96f6-+-releases: ensure /srv/patches directory exists

34626388b5-+-releases: Sync security patches for MW from deployment to nightlies server

f082acd013-+-Add druid defaults for easier setup in Cloud VPS

363be4a79a-+-Use jumbo Kafka for EventStreams in deployment-prep

46b3edffe9-+-Fix etcd request latencies alert typo

d05acadea0-+-grafana: Break dependency cycle

5c55f6e63d-+-add support for SSLCARevocationCheck setting in puppetmaster frontend

7f8d9de8c2-+-puppetmaster::ssl: fix crl file suffix

b9f87b545f-+-grafana: Allow to modify the config in hiera

8f979527c3-+-Simplify profile::grafana::production

48f6cfe35d-+-Remove role::grafana::labs

97b91834f3-+-Move role::grafana::base to profile::grafana

c7f0ba22ba-+-mariadb: Promote db2043 to be s3 master

5204b5a3cd-+-ganeti: Remove KSM diamond collector

527816184a-+-ganeti: create profiles, split monitoring/firewall classes

595d2c2433-+-scap: require sudo rules to be in place before deploy

7396797013-+-Allow to set the JAVA_HOME env variable in hadoop/hive/oozie

a95d7d7d05-+-restbase: reprovision restbase201[012]

fa556f0c9a-+-Phabricator: Add translations library to phabricator profile

46a20cf830-+-site: use role(test) for unused labs nodes

4e32de9dea-+-druid: move firewall includes from site to roles

3abeaa1553-+-No-op for refinery job camus to ease future analytics -> jumbo kafka

d4af280aaf-+-mariadb-temporary_storage: Do not monitor mariadb

5b3383611a-+-mariadb: Add small tunings in preparation for es200[1234] reimage

d8055e9752-+-apt: unattended-upgrades: ensure python3-apt is installed

fd38ffeddf-+-Use log_retention params in profile::kafka::broker

e61977ebcb-+-wdqs: simplify logging of categories reload

9cb54579d7-+-Blacklist gwtoolsetUploadMetadataJob from Hive json refine job

a924dc86dc-+-Parameterize varnishkafka certificate name for easier setup in Cloud VPS.

a27cec7066-+-restbase: reprovision restbase101[35]

bd16ba11ac-+-apt: unattended-upgrades: add targetted upgrades script

33af820c86-+-restbase: reprovision restbase1016

e935d96074-+-site.pp: decommission mw1209-1220

bd4b1f616c-+-site.pp: decommission mw1201-1208

fd0de0658f-+-site.pp: reorganize appservers in eqiad by function/row

1bce79d58e-+-mariadb: Set as spares labsdb1001 and labsdb1003

e2b94adb64-+-parsoid::testing:: Switch to YAML configuration

0d96b16a7d-+-cloud: labvirt settle on meltdown kernel

73436c0380-+-Add $monitoring_enabled parameter to cache::kafka::webrequest profile

2f497ab6e0-+-parsoid::testing: convert role to profile

fad25c385f-+-remove ganeti VM puppetcompiler1001.eqiad.wmnet

a867c8f6e9-+-Netbox: remove tunning.conf include; PGSQL fix 9.6 deprecated option

b00341d4d3-+-nova compute: whitelist meltdown-safe kernel version

fbd841b74d-+-prometheus: allow override of fs-related node-exporter options

2b0b0f6040-+-Rename role pmacct to netinsights

d0624008e3-+-mediawiki::scap: fetch mediawiki after mwdeploy has its sudo rules

e269af863e-+-restbase: reprovision restbase1018

6ab1c0be67-+-mariadb: Promote db1055 to be the x1 eqiad master instead of db1031

1953c4d6e5-+-apt: make apt::conf happen before removing apt.conf

6db1780d72-+-mariadb: Switchover s3 codfw master from db2018 to db2036

e9386d2b8a-+-site.pp: add mw1338->48

ca2c419f15-+-Scap: bump version to 3.7.6-1

a4d478f88a-+-role::prometheus::ops: add puppetdb metrics

b10e8879be-+-Smarter Varnish slow log

f895eab728-+-mariadb: switchover s2 codfw master from db2017 to db2035

9b87b3cd8f-+-restbase: reprovision restbase1017

1625c5888f-+-Stop distributing the 2016 digicert unified certs

a13c307f81-+-puppet_compiler: puppetdb::app no longer takes a heap_size arg

d639a39a90-+-Revert "Add cron job for purging ReadingLists data"

becccc40f4-+-Upgrade scap package to 3.7.5-1

60f6abd829-+-base::resolving: explicitly pass arguments

6eb7465e74-+-aptrepo: move Hiera calls into parameter of role class

1fbb39d46e-+-dumps_distribution: Set up initial NFS exports

83c98ed6d1-+-mediawiki::fonts: fix noto font inclusion on jessie

1eeacebfbb-+-Add Noto fonts to mediawiki::packages::fonts

6d62014a5c-+-mediawiki: Move font packages onto individual lines in require_package()

6f64dc6ab8-+-contint: convert Apache proxying to profiles

dfa90b7901-+-releases-mediawiki: replace apache module with httpd

2f5216d202-+-statistics: Install php5-dom for wmde scripts

aff15467bb-+-profile::analytics::refinery::job::streams_check: set correct spark jar

adaed2967f-+-mariadb: Promote db2040 to be the codfw-s7 master instead of db2029

d61c507058-+-profile::analytics::refinery::job::stream_check: fix refinery path

ac54b3b79e-+-role::analytics_cluster::coordinator: add a profile to restart streaming jobs

ebe37e46dd-+-base::resolving: remove useless "else" clause

d201f7baa6-+-graphite: cleanup stale ORES metrics

9860e17991-+-role::puppetmaster::puppetdb: add Prometheus monitoring for puppetdb

19c4373950-+-cumin: stop cross-referencing the puppetdb master

9d55c2e6b0-+-puppetdb: refactor to role/profile

2c933265b3-+-site/logging/kafkatee: move includes from site to role

f119e5cd8f-+-confluent:kafka:jmxtrans: remove Ganglia support

5477215d14-+-wikilabels: fix profile class name in role

7eb807e2f7-+-wikilabels: convert roles to a profile and 2 roles

c97092173d-+-rename phabricator_server to just phabricator

34e9ea733b-+-rename planet_server to just planet

230efd5d29-+-Revert "labvirts: whitelist the post-meltdown kernel version"

c76190d117-+-labvirts: whitelist the post-meltdown kernel version

d885a72675-+-Set jdk.certpath.disabledAlgorithms in java.security on Kafka brokers

f9f81d9644-+-Fix role::tcpircbot lookups for tegmen/einsteinium

00d511059c-+-tools: rm source from /usr/local/sbin/ferm_restart_handler

bc40fcee5d-+-tools: ferm pre hook to stop kube-proxy

5f85297940-+-restbase: reimage restbase1011 as cassandra 3

9cb945c00f-+-pybaltest: accept RAs even if forwarding is enabled

3e04190b23-+-site: spare::system vs system::spare

39325dc8ed-+-decom legacy restbase/cassandra 2 cluster

95bc551423-+-planet: missing Hiera, rename params, rm scope.lookup in erb

3394053d38-+-wikibase: include missing httpd profile for apache2

59e4634843-+-tools: ferm handler updates

0622691c1d-+-toolforge: ferm hook to restart components post updates

c6de75d446-+-decom esams swift machines, rm from puppet/dhcp

3590aa4c19-+-Use hadoop cluster name variable in camus templates

ffd9ac07ec-+-CI: Add php7.0-zip stretch and beyond

5d48740175-+-Add DELETE to list of allowed methods for text varnish

8f7851e376-+-Removing mw1180-1200 from site.pp for decom

ae4a36c7d5-+-don't send mail on dumps failures from labs

992d32854c-+-Tweaks to profile::cache::kafka::webrequest::jumbo test

1833274950-+-Create profile::cache::kafka::certificate to DRY require of cert

2fad65cf07-+-Create profile::hadoop::apt_pin to ensure zookeeper is the correct version

645963badc-+-proxysql: Correct path for proxysql persistance layer

ea8110cf1d-+-profile::analytics::database::meta: add ferm rules hiera parameter

709c4b0194-+-profile::hive/oozie: add a hiera parameter for the ferm srange

f7051d9ee1-+-RESTBase: Set up RESTBase for the production_ng role as well

3b6c9affad-+-mariadb: Add s8 to dbstore config and monitoring

56031c9d1d-+-site.pp: one role per node called with role()

84184be75d-+-prometheus: remove duplicate firewall include

0a4cb2ada1-+-Revert "prometheus: move duplicate include, use profile::base::firewall"

23389f1c4d-+-prometheus: move duplicate include, use profile::base::firewall

531d038d59-+-mediawiki::jobrunner: move firewall includes to role

8fb7b4edff-+-shinken: remove references to 'wmt' project

b2583d0884-+-ircbot: add a separate logfile for #wikimedia-cloud-feed

e6e4660465-+-Followup Ia5d07908: Fix sentry's base::service_unit to require correct class

0f6ac9df20-+-Allow superset to submit jobs to Hadoop as logged in users

3e0ffce7e9-+-bastionhost::twofa: re-add the new install access keystone

49a51e72c6-+-Render role's analytics refinery logrotate from profile

dca8ec93e1-+-Move refinery::job::data_check from stat1005 to analytics1003

99004cc7ca-+-Parametersize kafka_cluster_name in refinery job camus

8a56ec247b-+-Move role refinery::job::* to profiles

adc9331ccd-+-site.pp: one role called with role() for stat1005

48340cee98-+-site.pp: one role() call in ruthenium, tungsten

b481f1bf56-+-site.pp: fixup for Icd70ef861dcadeeae7df0415a5c2779679c5e144

e002fdd119-+-site.pp: rationalize prometheus, puppetmaster frontends

e2c5620990-+-site.pp: fix more cases of multiple roles being declared

58bc91a5ea-+-logstash: create compound role

c6d97932cd-+-site.pp: reorganize labs host to use one role() call per node

c112156379-+-kripton: one role() call

3c5863b000-+-apt: Do not use experimental on stretch

08b7947ca3-+-kafka: create compound roles, one role() call per node definition

edf4f1d9c6-+-site.pp: one role() call for iron.wikimedia.org

443df7ce01-+-role::installserver: create meta-role for installserver

e1ba825df5-+-profile::analytics::database::meta: simplify labs deployment

2dd29dd0fa-+-graphite: reorganize roles, one role() call per node

586acf8b20-+-profile::hadoop::backup::namenode: improve labs support

5f76719c64-+-profile::analytics::database::meta::backup_dest: allow labs dir perms

6e779cc53f-+-Add cron job for purging ReadingLists data

ea9f303e09-+-mariadb: Remove db1039

a1c6816598-+-fix up dblist and related config setting of bigwikis for dumps in labs

baa6e723a4-+-add dumps config settings stanzas for labs testing

28048b3629-+-snapshot testbed role for deployment-prep

1c6f4a13a2-+-restructure the snapshot dumps data directory setup

efb1d4fd09-+-make the snapshot labs lvm stuff specific to a snapshot profile

0e84030b3b-+-add labs lvm setup for dumps snapshot instances without nfs filesystems

d70acd76eb-+-research: re-enable git cloning of page content

20b24eb267-+-research: re-enable Apache, disable cloning

d40901cc17-+-research: temp disable landing page

b72db3e0a4-+-microsites: create research.wikimedia.org static page

d9388d6c8b-+-Releases: Include all contint PHP packages

7785d31e2a-+-network::constants: add fake CACHE_MISC for labs

d2dd6c248e-+-Use python3 async gthread workers for superset

9284611226-+-Rename the servermon::wmf role back to servermon

f0c128ab1f-+-servermon: Use the new WSGI invocation pattern

e90b2ba42f-+-servermon: Remove tests directory

55e686fe91-+-admin: Flatten 2 levels of arrays in unique_users

f6be955e59-+-mediawiki-maintenance: Run maintenance on new s8 replica set, too

fcbb63b7b7-+-varnishmtail: notify daemons upon mtail program modification

1938cd9b2b-+-profile::hadoop::firewall::master: fix default ferm srange

31ecc72e62-+-labtestservices2001: one role() call

e1ff39f2a0-+-profile::hadoop:*: add ferm srange defaults to allow labs deployments

b7501e0a4f-+-snapshot hosts: empty nfs server name means no mount

0062afe9cf-+-Add loading DCAT-AP data into dcatap namespace on WDQS

19a4490a07-+-role::analytics_cluster::hadoop::master: fix order in profile inclusion

496ddcd2e3-+-peopleweb: re-add ferm rule for http

273dc15d2f-+-peopleweb/publichtml: use module httpd

f636cb3a2a-+-webserver_misc_static: switch apache to module httpd

760193c987-+-planet: switch from module apache to module httpd

3ecd454905-+-apache: add httpd module as a replacement

1780b6eb86-+-Releases: Install composer alongside Jenkins

1501d1820e-+-wmcs: maintain-meta_p missing python-requests

d079c2ef0f-+-openstack: these servers should be an HA pair

e8097a2eb2-+-role::analytics_cluster: avoid to expicitly instance the standard class

e2c71720ba-+-prometheus: add backend varnish mtail job

da1bbb751f-+-tools: need overlay module for overlay2 for k8s

d2a6d415ce-+-kmod blacklist: allow ensure => absent for a given blacklist

eec53f2d97-+-profile::hadoop: set hiera defaults to ease labs deployments

217be96662-+-Use intermediate script for json refine jobs

da85de7059-+-role::cache::text: do not include ipsec role for pinkunicorn

28886c972c-+-Refine mediawiki job queue events into Hive event database

59d385d90e-+-Refactor thorium's roles in one

1a918b5625-+-Add ReadingLists tables to Toolforge filter config

8d272c2860-+-profile::hadoop::master: remove the last hadoop cdh auto-lookup

3f9fe70ad5-+-ifguard $realm and $cluster with defined()

fd65d47865-+-use strict var syntax in snapshot/dumps modules

c61d7d2ea1-+-role::prometheus::analytics: add configuration for jmx hadoop agents

4ad7204f3b-+-eventlogging: create compound role, consolidate hiera

127895a1a2-+-monitoring: create role::alerting_host

a1c26af410-+-site.pp: one role for dbstore2001.codfw.wmnet

ce9645c408-+-site.pp: simplify role() keyword call for cache::canary

3518ac6075-+-mtail: add program to count varnish backend metrics

57df5cdccc-+-varnish: add varnishmtail instance for varnish backends

f3b3d90eb1-+-cache: add ipsec to basic roles

48e586f758-+-site.pp: use role keyword for striker::web only on californium

30a4b8ea6a-+-bastionhost: add role for caching PoPs

927e4c0fa7-+-site.pp: Add db111{3,4} to spare

095153acd2-+-role::analytics_cluster::coordinator: fix system::role

818c03d5fa-+-site.pp: convert dns recursors to single role

864e3d5822-+-microsites::peopleweb: convert role to profile

da1966edc4-+-librenms: convert role to profile, variables to params

4dcbfc2d2a-+-decom: remove uranium from site,DHCP,netboot

d7dbfac656-+-contint: Install php-xdebug (disabled by default) for PHP 7

1e9b733f53-+-rancid: convert role to profile

2f0091e227-+-Force more exact protocol version for varnishkafka statsv

d3efca8349-+-profile::prometheus::alerts: fix Druid ingestion Prometheus query

ebf0e0eb24-+-mariadb: Decommission db2028 - set as spare

31874a8c35-+-Move statsv varnishkafka and service to use main Kafka cluster(s)

69950c61b0-+-elasticsearch: move prometheus classes to conform with best practice

ba7ac00e9f-+-role::icinga: add prometheus alerts profile

5c3ff7cbed-+-apparmor: remove service provider attribute

70a5280e6b-+-smart: pin smartmontools to backports on Debian

6caad0acc5-+-nova: fix dependency order on dir and mount for instances

05706aff14-+-aptly: Update published repo distributions

2ccebe350b-+-nova: add compute profiles for labtestn virt role

be33c09424-+-Set cipher.suites and ssl.enabled.protocols for jumbo and varnishkafka (canary)

b028781f1b-+-Bump specified kafka version to 1.0.0-1

2fb96cc06b-+-api: move mw1189-1200 to role::spare::system

49060a58e2-+-appservers: move mw1180-1188 to role::spare::system

9a020b2894-+-mariadb: Promote db2039 to be the new master of s6-codfw

2db4b19f66-+-mediawiki::appserver::api: add load monitoring

125fa26734-+-role::puppetmaster::standalone: rename ferm rule to be more explicit

ba89126707-+-role::puppetmaster::standalone: add ferm rules to allow connecting to tcp/8140

444405264d-+-mariadb: Set db1029 as a spare and ready to decommission

256db3f729-+-mariadb: Decommission db1029, former x1 replica

8cc9909e2c-+-thumbor: use the canonical definition of logstash host

95f659a527-+-tcpircbot: convert role to profile

b1880e5004-+-ntp: convert role to profile

c7baa63011-+-Mirror Kafka 1.0 from confluent in stretch and use 1.0 protocol version

10672a704b-+-wmcs puppet: Support instance agents using the 'puppet' master hostname

f1f089cdee-+-Puppetmaster web frontend: support specifying different certs for a hostname

52a7c685a7-+-Revert "l10nupdate: don't run over holidays"

e8805a21b6-+-mtail::program: allow to specify destination directory

e9858961fe-+-ores: install myspell-ca

f220899922-+-mtail: stop sending metrics to graphite

53abe99dc8-+-Add and link readme pages for analytics datasets

675f2bee04-+-cloud puppetmasters: fix an erb issue with the big puppetmaster list

351df47353-+-prometheus: add mtail to varnish-text job

5822a87b08-+-puppet enc getter: only allow acccess to VMs and puppetmasters

f239cda461-+-openstack: whitelist kernel versions for compute

1a6c7540f0-+-rabbitmq: drain_queue is defined dupe

cbf3fed273-+-openstack: only run rabbitmq cleanup on active control node

98ceda279f-+-service: remove trebuchet references

1b1aedc812-+-zotero: convert role to profile

195b6fa644-+-dumps: Set up NFS on the dumps distribution servers

32b1526176-+-dumps_public: Cleanup the public_server profile

f13700a0a8-+-public_dumps: Remove module path and rename to distribution

592cdd7859-+-Revert "dumps: Turn off dumps auto-sync to labstore1006 for reimaging"

551424829e-+-enable pagelogs to be dumped by several processes in parallel

da59c8967e-+-make all misc dump jobs plus xml dumps config use hiera setting for php

0beaddcc24-+-get rid of redundant code in dumps nfs server manifests

091aad98df-+-get rid of redundant code in dumps web server manifests

67aac2eb13-+-move ipv6 setup for dump web servers to the appropriate profiles

68f076797b-+-create a profile for nginx-extras package for dumps

7de99c7598-+-allow dumps nfs server to be configured without clients if needed

4269b7884f-+-move ferm rules for nfs out from dumps module to a profile

5100c1e7db-+-manage directories locally on dumps workers if there is no nfs server

f9d89b43d1-+-move dumps nfs server name into hiera param for worker profile

2cfda3a229-+-smokeping: convert to profile

7439e3b8ac-+-Add language-pack-eu to toollabs exec

1307fbd0e7-+-l10nupdate: don't run over holidays

a6b3589f69-+-apache: remove comments about Ganglia monitoring

40d2b6811a-+-mediawiki: remove comment about Ganglia, replace with Statsd

a3ab4d2a10-+-Add Digicert 2017 certs to deployed ocsp set

1401fa3d81-+-Set proper kafka log_dirs default

eae2ae59d6-+-wdqs: use the canonical definition of logstash host

b871e2e1ba-+-ores: basic role for a worker-only node

c630b609df-+-mariadb: Move db1055 and db1056 to x1

2ec7c19912-+-gerrit: use the canonical definition of logstash host

287e34bea9-+-kafkatee: use the canonical definition of logstash host

9056e5a425-+-aqs: use the canonical definition of logstash host

fcf517fba3-+-Remove GS 2016 unified certs from active set (expired)

1e3712cd8b-+-kubernetes: Allow parameterization of prometheus_url

663e23e8c4-+-labs: split pdns-rec jobs

a59e6c778a-+-Add PowerDNS Recursor scraper config on labmon1001

2276f62890-+-Use custom profile for PDNS exporter on labservices1001

bd86b8e1d4-+-ores::stresstest: fix style violations

eb575973a0-+-horizon: Update logos and file naming

f22b91b770-+-Extend sudo configuration for pdns-recursor on labservices

8f1aaac991-+-Add pdns-rec Prometheus exporter to labservices1001

d8235d425e-+-prometheus: Define $postgresql_jobs and use it

1fd304dacb-+-Move prometheus::postgres_exporter to a profile

bef5745fdc-+-Adapt sudo config for Prometheus exporter

335decab84-+-Add labmon Prometheus scraper config for PowerDNS

46e6e8212d-+-Instruct prometheus to gather postgresql metrics

f939dbbc7e-+-Introduce profile::prometheus::k8s::staging

65ee46005c-+-Reclaim lawrencium

d71d3e62e1-+-Add PowerDNS exporter to labservices1001

4ef1ba6e46-+-prometheus: add nutcracker job

36b481aeae-+-haproxy: Update haproxy systemd.unit to that of stretch

cd50a1ba51-+-move one more hardcoded path from dumps profiles to hiera

816679ee5e-+-use hieras settings for a few more hardcoded paths in dumps profiles

59f8b8eb60-+-enable dumps of big wikis to run in a fixed order

a689e98987-+-Allow nagios to sudo to check analytics backup newest file age

c4929e90d0-+-add dumpsgen user to labstore1003 for dumps cron cleanup job

1c0e272fbe-+-dataset1001 rsync to labs of dumps can now use explicit inclusion list

86460d076e-+-Add nrpe check_newest_file_age; monitor some analytics file backups

aad6756cbd-+-contint: worker_localhost had the jenkins user hardcoded

22ab4a8892-+-ganglia: delete the module

dfe7091638-+-contint: disable XDebug by default

1bd6a9b697-+-Migrate contint::worker_localhost to a profile

3a4e152730-+-tools exim: Fixes for our simple route-to-mail-relay setup

3f0abad921-+-LibreNMS: fix issue where service ircbot is declared twice

6d72899bd7-+-postgresql::user: Differentiate augeas on type=local

d440d95989-+-mariadb: Fix bug causing too restrictive firewall on some proxies

1d366d608f-+-osm::slave: Correct dependency of prometheus

58566f4dea-+-Remove single quotes from netbox prometheus

76b29ff65d-+-Add prometheus::postgres_exporter class to users

0ec38b1a2d-+-mariadb: Fix bug by which the wrong role was being set up on dbproxies

420b2a62ac-+-network::constants: drop uranium from monitoring hosts

db306e98cf-+-Set superset auth_settings => undef if not using ldap_proxy

0f85e2596a-+-dbproxy: Apply both regular and cloud only exception for 'cloud'

3e9695e9f4-+-openstack: labvirt role shuffle

07313ead31-+-mtail: add varnishreqstats.mtail

737dddaa8e-+-mariadb: Preparing reimage of dbproxy1001 and setup proxy firewall

fcc78ecbdf-+-Move role::prometheus::k8s to profile

b106fa0048-+-Add Prometheus scraper configs for WDQS updater and Blazegraph

d165ccbf69-+-Add Prometheus exporter for Blazegraph

e30b26272b-+-Update mariadb::proxy to the latest style and path locations

2f82c847ad-+-Add nutcracker_exporter profile

aadf60faee-+-clean up directory setup manifests for dumps nfs and web servers

4c26db4026-+-rename 'otherdir' in the dumps modules

2f53c0f34f-+-profile::mariadb::misc::eventlogging: fix group/user dependencies

652dfd09ec-+-profile::mariadb::misc::el::master: apply data sanitization policies

95ba4da856-+-Bump puppetdb on puppet compiler to 3G

c30cb547cf-+-Fix texlive dependency for stretch onwards

f233b1fe20-+-uranium: remove mapped v6, add decom comment

8de78f99c7-+-rm role/manifests/ganglia/config

d0f7bb6375-+-ganglia: delete ganglia-web classes and role

7a3b1f320a-+-standard: actually drop 'has_ganglia' param entirely

8a60977030-+-icinga: Add scoring-team for alerts of ores-extension

86771b23bf-+-standard: decom ganglia plugin everywhere by default

ffdba1503f-+-LibreNMS: IRCbot puppet fixes

106fbd7c1c-+-LibreNMS: Add an IRCbot process

808acd1362-+-statsd: remove ganglia backend support

052c8ff7c1-+-site/uranium fix "spare" -> "spare::system" typo

d5588370d1-+-ganglia/site: decom ganglia-web node, rm eqiad/codfw aggregators

09f2793967-+-osm/postgres: remove ganglia diskstat plugin inclusion

99d75ffedd-+-postgresql: remove all ganglia support

666c176c66-+-osm: remove all ganglia support

de5cc6fd96-+-mariadb: Add db1112 to s4-test

6a307aba7f-+-Add Prometheus exporter to WDQS servers

f8e41eb7c3-+-Bump scap to 3.7.4-3

1f44914a94-+-puppet-compiler: extract facts from puppetDB

e670d618d6-+-Add rabbitmq jobs to Prometheus config for labmon

8c02f09813-+-mariadb: Add mydumper to misc:m4 databases

7bb0771e8e-+-Add rabbitmq-exporter to Prometheus scraper config for labmon1001

c479dd0d51-+-Add mw13[29-37] to site.pp and conftool

32019be775-+-Remove the Trending Edits service from production

5ea2b5352b-+-base: fix dependency relationship

9bc5be404f-+-Revert "Scap: bump version to 3.7.4-2"

53424c8eff-+-maintain-dbusers: Stop managing account creation for labsdb1001 and 1003

8b7eae257c-+-Scap: bump version to 3.7.4-2

a004a3c90b-+-labsdb: Switchover labsdb1009 to labsdb1010 for maintenance

7465bc0895-+-labtest dns: fix a one-letter typo

2c72b8e4a2-+-labservices: rearrange hiera for recursor::aliaser_extra_records

ceee1fc0cf-+-Add clickstream rsync for external visibility

a1f9619f9b-+-labtest dns: allow hiera to set aliaser_extra_records for labtest

98bc9e88ab-+-openstack: set monitor_password as var for rabbit base

10bdae50c9-+-Fix srange for prometheus-rabbitmq-exporter

b412a9145f-+-openstack: type for rabbitmq base

dcbce95edb-+-openstack: profile/manifests/openstack/base/rabbitmq typo

9e2e5a8bd9-+-Add Prometheus RabbitMQ exporter

7fbd9bb5a7-+-openstack: remove duplicate definition in compute/service

ce44111906-+-openstack: nova/compute/server.pp manage nova shell

000dc65bdf-+-profile::cache::kafka::webrequest::jumbo: add graphite metrics

eb6e4ed6c1-+-profile::cache::kafka::webrequest::jumbo: force TLS kafka broker port

2757a17911-+-prometheus: add xcps aggregation rules

e6e2e2f1f8-+-profile::cache::kafka::webrequest::jumbo: fix TLS config

555fa8b034-+-profile::cache::kafka::webrequest::jumbo: fix TLS configuration

a27fc57c1b-+-mariadb: Add db1111 to s4

b3176576da-+-Revert "site.pp: Failover labsdb1011 to labsdb1010"

b53503df48-+-profile::cache::kafka::webrequest::jumbo: fix require parameter

7a7377ee3f-+-profile::cache::kafka::webrequest::jumbo: fix private key path in private repo

db55615295-+-role::cache::canary: add a test Varnishkafka instance

5326e90ba8-+-mariadb: Remove db1034

5f44b101be-+-labsaliaser: handle requests for the simple hostname 'puppet'

9438a4d05b-+-Replace kafka1018 with kafka1023 in the Analytics Kafka cluster

9d385152d1-+-Allow ipsec in iptables/ferm rules for kafka1023

54e735cbcd-+-Add interface::add_ip6_mapped to kafka1023

9f353ca26e-+-Establish ipsec session between kafka1023 and the cp nodes

67a257567b-+-apt: unattended-upgrades: add reporter script

83e7f654fa-+-Revert "base: fix dependency relationship"

625fdb7ad0-+-base: fix dependency relationship

1d41a31d7b-+-Add postgresql::prometheus class

2f5b922b29-+-postgresql::user: Allow password to be undefined

317ec34068-+-openstack: nova::common dependency handled higher up

d0e17e5c5b-+-Revert "Revert "cloud: setup for attended upgrade process""

209d0bc8f9-+-Revert "Revert "mariadb: Remove mariadb.pp and move some old roles to profiles""

478daf53ed-+-Revert "mariadb: Remove mariadb.pp and move some old roles to profiles"

ea71c8fe2f-+-Revert "cloud: setup for attended upgrade process"

8f9bdd5b83-+-cloud: setup for attended upgrade process

c698af4785-+-mariadb: Remove mariadb.pp and move some old roles to profiles

a7aa0b0c30-+-profile::hadoop::master: fix dashboard_links param - part2

1021a1bbe8-+-profile::manifests::hadoop::master: fix dashboard_links parameter

5f2c7a895e-+-Add PUT to list of allowed methods for text varnish

aff62a5ec2-+-modules::varnishkafka: update to latest sha

3578bb6b33-+-site.pp: Failover labsdb1011 to labsdb1010

e78f05bca5-+-Add Icelandic dictionary for ORES on iswiki

73721d9941-+-labsdb: Point DNS at equivalent web.db.svc.eqiad.wmflabs hosts

8be3046950-+-openstack: sane class dependency handling for labtest[n]

f66780459f-+-openstack: labtest and labtestn roles for net

edd469afae-+-openstack: consistent style for ensure present

67f2c25b13-+-openstack: dependency changes for require_package

36578fc2ae-+-openstack: dedupe packages and reduce require_package

ebd2d47b16-+-mediawiki::appserver: move firewall from site to role

73428c7810-+-exim4/ganglia: mx,otrs,lists,phab: rm Ganglia exim stats

6abdadb97c-+-openstack: cloud repo  explicit apt-key update and apt-get update

4d628a19ae-+-Releases jenkins: Ensure php-curl is present (version doesn't matter)

b17295fd7e-+-elasticsearch: configure prometheus to collect metrics from elasticsearch

1b06681902-+-elasticsearch: configure prometheus to collect metrics from logstash

ba6b22ddc2-+-openstack: contain classes for dependency handling

4e3bf9225e-+-Removing site.pp and dhcpd file entries for mc1001-18 T164341

6b8c892451-+-elasticsearch: activate prometheus elasticsearch exporter

6dd05a3abe-+-logstash: activate prometheus elasticsearch exporter

8fd54a1519-+-elasticsearch: deploy prometheus-elasticsearch-exporter

ba40a8ee8f-+-Fix ferm port for prometheus-etherpad-exporter

55b57b5bea-+-Add Prometheus scraper config for Etherpad

9057ca2632-+-prometheus: add mtail to varnish-upload job

2f43e91ce9-+-Add config file with access credentials for Prometheus RabbitMQ exporter

54943710ac-+-Add pdns rec exporters to Prometheus scraper config

b1906d9074-+-Add Prometheus exporter to DNS recursors

a29496b9c0-+-Add Prometheus scraper config for ircd exporter

e5ae63c083-+-Add Prometheus exporter to role::mw_rc_irc

bc3d930ef5-+-clean up all references to a 'public dumps dir' on web/nfs dumps servers

5c867f95be-+-proxysql: Add proxysql user to mysql group for tls certs access

8268338540-+-mariadb: Create profile::client for non-root mariadb clients

49c4adad84-+-Releases: Also include release tools for releasing

828c66bf67-+-Releases jenkins: Only clone MediaWiki core, and make it a bare clone

8e3d7eff1d-+-logstash: use profile::base::firewall

cdef133d28-+-contint: remove browsertests role from permanent slaves

fa3c98f0f8-+-site/cp: convert "not true"-spare systems to role(test)

371e2a170c-+-mirrors: move standard include out of site

e6f315057a-+-pentest::tools: add missing system::role

a696c8070f-+-gerrit: add fallback default undef for IPv6 parameter

74515bfc0d-+-mwlog: style fixes, move firewall include

1091451c19-+-tools k8s workers:  add a mostly-permissive firewall

3a3f47ddbf-+-openstack: contain relationship for needed classes

bcb509afee-+-planet: drop duplicate standard include

a00478eb41-+-wmcs: move standard includes from site to roles

330b66b126-+-Removing site.pp entries and dhcpd file entries for decom'd db1015,21,46-49,50

5c07c79a50-+-maps: update style to match latest kartotherian version

dc4bee61fb-+-Removing decom'd server eventlog2001 from site.pp and dhcpd file T182397

dd8f884aa0-+-prometheus: add mtail to varnish jobs

2d760460ec-+-Rename notebook1002 to kafka1023

71e2cb8432-+-maps: extract style used by kartotherian / tilerator as parameter

46e425044d-+-openstack: first install control node dependency issues

287fc65464-+-cache: install varnishxcps.mtail

0a963adfc3-+-Escape the exclamation mark in icinga k8s master checks

60dcbf686f-+-mediawiki: Remove Score firejail wrappers

c74ac01a21-+-Add kubelet operational latencies check

a0d0f5d825-+-Add 3 prometheus checks for kubernetes

260a16b1d0-+-snapshots only have one nfs filesystem mounted, remove cruft

4ce351b1a9-+-Refactor web workers for ORES

e4ff53ef84-+-fix up some style violations in dumps manifests

66b1c06b59-+-Varnish instance: fix child restarted check

283fd61ae5-+-Remove torrus role, module, varnish backend and references

5120396e3b-+-Metric alarms: convert dashboad_link to array

00317413d5-+-get rid of datasets1001 mount on snapshot hosts

0431aff9a8-+-icinga::nsca: drop system::role not in role class

c43729cd69-+-labnet100[34]: use role::spare until used

9a838f6ec6-+-Add superset password mappings for analytics mysql dbs

7d0aa0aaaf-+-mediawiki:appserver:api: move firewall to role, use profile

686b69384c-+-Move contint::browsers to a profile

3f00238c61-+-Move contint::browsertests to a profile

3cef57af97-+-contint: Install hhvm dev packages from the profile

9557616365-+-role::ci::slave::browsertests: Fix $redis_port by adding string

33156c866b-+-profile::puppetmaster::backend: fix extra_auth_rules for backend masters

73d91be1d1-+-WMCS puppetmaster: modify auth.conf extra rules to account for url changes

042a4ed15f-+-Icinga web: add icons for multiple notes_url items

60e1d600da-+-Bump scap version to 3.7.4-1

e1b18a1c1e-+-prometheus: add ores redis job

29114824be-+-site.pp: set notebook1002 as spare::system

d9b03b4e8f-+-wdqs: adding "su" directive to log rotation

3129a19cba-+-convert all incoming rsyncs, all cron jobs on dumps webservers to dumpsgen user

87fce4222b-+-make all incoming rsyncs of datasets to datasets servers run as dumpsgen

b33574eada-+-add the deprecated dumps user to the labstore boxes temporarily

e230d5380b-+-move wikidata weekly dumps to new nfs server

590e26c62a-+-fix up cron job for listing last n good dumps

439f7db6fb-+-clean up temp files created during xml/sql and other dumps generation

dcd77b1271-+-remove dead vars from misc dump cron jobs

ce69037c1c-+-remove some dead vars from content translation dump manifests

e80a69e600-+-move production of lists of last good dumps from snapshot to web server

522b0e84ce-+-move content translation dumps to new nfs server

37f4d632f4-+-Use sync worker for superset

634a9cb42e-+-puppet: fix puppet/facter package pinning in stretch

33ae12e97f-+-Set default topic timestamp.type to LogAppendTime

d960571b65-+-Open druid coordinator to more networks; superset needs to query it

a2d7df0dea-+-Allow authenticated (in certain ldap groups) to auto-register for superset account

0cc9be00c2-+-puppetdb: remove (cleanup) ferm allow for puppetcompiler1001

cbfee47806-+-Configure LDAP proxy and authentication for Superset

ada4684a61-+-site: add eventlog2001 as spare::system

536f8730e1-+-site: add ores200[19] as spare systems

af1f7dabee-+-Revert "Wikidata weekly json and rdf dumps disabled temporarily"

d107ae9d9c-+-logging/kafkatee: remove ganglia monitoring

c5604c5de3-+-elasticsearch: use the canonical definition of logstash host

71460e2bab-+-ganglia: delete views for kafkatee, hadoop, varnishkafka

3b33da229d-+-Fix superset hiera admin_password var name

8644424dde-+-Puppetization for superset

e179038481-+-Fix mylvmbackup for analytics-meta

750ba94b1d-+-kibana: increase max payload size

a4b9ec056b-+-kibana: increase max payload size

b6ec7db7e6-+-puppetcompiler1001: add role(test)

1d649e1ece-+-site: fix another "spare" -> "spare::system" mistake

de2f84ba47-+-site: add stat1003 ghost back to site

b396a97248-+-site: fix "spare" -> "spare::system" for conf100[456]

be36ae0f90-+-site: add conf100[456] with role spare

a0cea34782-+-logstash: dedicated components in our APT repository

82ab2c8498-+-Revert "Revert "Deploy MjoLniR with new deploy repository""

2c5a3e1174-+-contint: libcurl4-gnutls-dev is now absent

1cf191cc65-+-Move contint::hhvm to a profile

cefd4f4554-+-move adds-changes (so-called incrementals) dump cron to dumpsdata hosts

1fb3e4bcba-+-Pass enable=>true for all kubernetes components

7957c65385-+-Make wikidatawiki cronjobs use the Wikibase extension and not the build

8975935a08-+-profile::oozie::server: add Prometheus monitoring and tune jvm

207568baf3-+-profile::hive::server/metastore: add Prometheus monitoring

17dd01c90c-+-Move contint::package_builder to a profile

546ddd6f64-+-role::analytics_cluster::[hadoop::standby|hue]: fix hiera config

c66fd7866c-+-role::analytics_cluster::hive/oozie: move to profiles

daa95bd6ca-+-logstash: decommission logstash100[1-3]

4478e10716-+-eqsin: basics

1c039a181b-+-Make wikidata cronjobs use the Wikibase extension and not the build

4d861b79c5-+-planet: Add stretch check in init.pp around rawdogplugin

105b1b1ab7-+-planet: Add RSS plugin to rawdog

63222d4115-+-wdqs: schedule cronjob to reload categories

67f7d5e903-+-remove extraneous cleanups for misc dumps from scripts and crons

60bd197e65-+-Enable async for eventbus kafka producer

f6462643c9-+-logstash: move eventlogging collection to logstash1007

a3625116ba-+-Grant Create (topic) and Describe on kafka cluster resource for User:Anonymous

dbb882f3cb-+-Add Prometheus exporter to profile::etherpad

27a7ea367d-+-contint: a slave script will require 'jq'

d47e2f9633-+-geoip: add GeoIP2-ISP to the list

e01119f53b-+-wdqs: use the /readiness-probe in WDQS icinga checks

0f68010610-+-Use super.users instead of kafka-acls exec to authenticate broker principals

4ca9350cdd-+-profile: add redis_exporter to ores::redis

43ac96d5fa-+-Improvements for Kafka + SSL

2c4f83f766-+-Wikidata dispatching: randomness to 15

579d5189e3-+-Wikidata dispatching: randomness to 10

7aecef147a-+-Remove wikidatabuilder LABS ONLY

0cbb35ddb9-+-Revert "Install lilypond from stretch-backports"

98ea0102e6-+-Install lilypond from stretch-backports

c20f4ef853-+-Wikidata dispatcher: Choose a better value for --randomness

ed06b35406-+-role::hadoop::master|standby: add Prometheus JMX exporter config

655637cbad-+-fix subdir name in misc dumps cleanup, make script quieter

db69a2e56c-+-puppetdb: add command-processing threads setting to puppetdb::app

aad9bf5a09-+-ulsfo: lvs, bastion, remove ganglia and aggregator

32971b5474-+-remove esams ganglia aggregator

0eb56f2325-+-Revert "contint: a slave script will require 'jq'"

5b8bed3e3d-+-labnodepool: move standard/firewall includes to role

29de8001df-+-diadem/dysprosium: introduce skeleton role

e61675573d-+-contint: a slave script will require 'jq'

7d3b3a3551-+-clean up old slow parse log datasets via cron

3b936e65c9-+-cassandra: reprovision restbase1014 with cassandra 3

5e5a955dbc-+-udp2log: use LVS endpoint for logstash

108a199785-+-make misc dump cron scripts owned by root

cadbda7e62-+-move various misc dump cron jobs to new nfs server

4159504325-+-varnish: prometheus equivalent of statsd metrics daemons

65816cc3ac-+-Grant prometheus user to run rec_control on DNS recursors

45ef874c7a-+-mtail: add 'ensure' parameter, remove 'enabled'

37083e26e5-+-mariadb: Convert db1098 to multiinstance

3ec37a1733-+-add dumpsgen user to labstore1006/7

89ba3357db-+-make config subdirs for dumps on web servers owned by root

430df3e721-+-mariadb: Decommission db1044

ac9de486bd-+-cleanup xml/sql dumps on all hosts that have them

5fde110a6a-+-simplify cleanup of old xml/sql dumps

befda525d9-+-clean up old misc dump output files from cron jobs on dump hosts

0485d87042-+-Wikidata weekly json and rdf dumps disabled temporarily

1281026cd3-+-move last hiera calls out of snapshot modules into profile

2ebb65fdac-+-move one more setting out of snapshot hiera and into profiles

806df01c49-+-wmcs recursor:  allow labtest to override puppetmaster_hostname

ddec1f2566-+-labsaliaser: handle requests for the simple hostname 'puppet'

52b7f863b0-+-monitoring: workaround puppet 4.x bug with created_resources

9bce3ab945-+-mariadb: Set db2092 as spare explicity

3444f84bd2-+-Set db2085 with s1 and s8; make db2092 pending to be deployed

f1ca73f0f9-+-Revert "user homes: Allow git to control +x for $HOME files"

65d7a672d0-+-toolforge: bastion local throttling

aa21c86e64-+-Set role::system::spare to db104[67]

31e4991f0a-+-Restrict access to ferm service on mwlog* hosts

3d646df5e3-+-user homes: Allow git to control +x for $HOME files

afa2615ab2-+-diamond: skip DiskSpace for Docker containers

82e6d1acbd-+-mw_canary_appserver: mv firewall incl to role, use profile

1c9a4581f7-+-dumps: Turn off dumps auto-sync to labstore1006 for reimaging

f9f839a406-+-base: qualify syslogs::readable defined type call

99994544ec-+-chgrp server.properties to 'kafka' so daemon can read it

929caf7a26-+-Puppetize SSL for Kafka broker

6c170325d7-+-rename requesttracker_server to just requesttracker

d883b13747-+-add labstore1007 to list of hosts permitted to rsync from dumps servers

523e06fbe9-+-apt: add --force-confold/--force-confdef dpkg option to apt calls

d084b9b413-+-mariadb-eventlogging: Move prometheus monitoring to /run socket

9ab2335346-+-Use install_options instead of manually specifying cergen deps

3cc6375f8b-+-require python3-pkg-resources for cergen in jessie

94b73a7ef5-+-Need to specify more dependencies for cergen, create cergen module

0387fee1bb-+-Don't use require_package for cergen

d5a052e8e5-+-Remove before => cergen, this creates a circular dep with require package

5753c7ed18-+-Install some cergen python3 deps from jessie-backports

f72091505b-+-profile::hadoop::worker: add Prometheus JMX exporter configuration

ed44e99d7e-+-mirrors: puppet 4 spec compatibility

24acaa8e16-+-Install cergen on Puppet CA host

ac7da6f831-+-monitoring::host: enhance puppet4 compatibility

49ac4682d5-+-Remove ffmpeg2theora from package list

f2ed0516a0-+-Add apt pinning for Twisted from jessie-backports

b5b6e60bca-+-git::clone: define all variables for puppet 4 compatibility

ef4ae5a0d4-+-role: add ldap Prometheus jobs

d0d1423a5c-+-rsync::get: fix undefs for puppet4

a75a8391f1-+-Add Prometheus exporter to openldap/labs

2d119bc700-+-prometheus: add varnish-canary job definition

2f3dcc6fe0-+-role: split prometheus redis jobs

d4d088af9a-+-pr_index table is not private

5dd0397187-+-public_dumps: Revert inclusion of labstore::init class

7a2e11fdee-+-bootstrapvz: add nbd-client package

75f8ccc90e-+-Bird: add monitoring to the VIP and bird process

62aa2548d8-+-Fix another place where gui-vars location was wrong

c442efc7a2-+-Fix gui-vars location

08a87e4cfb-+-Create script for automatic reload of categories

e87dff2b22-+-puppetmaster::standalone: Get env_config ready for puppet 4 and cleanups

34dd79742c-+-site.pp: remove import of realm.pp

7376570c5a-+-apt: unattended-upgrades: add comment about security upgrades

0ae9a1b248-+-profile::hadoop::common: import hiera config from cdh::hadoop

de64829962-+-puppetmaster: default to the future parser

45112473a7-+-git::install: fix conditional for puppet 4

ef7d3c7475-+-cassandra: reprovision restbase1012 with cassandra 3

b5ac3e03de-+-role: allow prometheus access to mtail on syslog servers

d3d5146599-+-role: poll mtail metrics from syslog servers

8110540aba-+-Disable ORES redis persistence for queue

ff5a78e600-+-mariadb: Convert db1096 to multi-instance: s5,s6

2902ed4c2c-+-Rename ::profile::hadoop::client to commons and move some features out

7ef6dffddd-+-Enable configuration for aliasing namespaces

6c7360d6f8-+-gerrit: restore system::role for motd

8a4368c870-+-ganglia: remove service{} from decom class

74379a0330-+-phabricator: remove ganglia include

2549c202cc-+-bast4002: remove ganglia aggregator

3b73a1d95b-+-bast4002: add to network::constants for ferm rules

81854adea6-+-bast4002: add proper roles

b00d0d2aaf-+-ganglia: ensure more things are gone in decom class

55e5429c3a-+-url_downloader: move firewall to role, use profile

8cb6f78aba-+-Revert "public_dumps: Add puppet class to set up NFS for dumps servers"

4777d98e00-+-puppetmaster::standalone: include environment env

c5752991b9-+-profile::puppetmaster::common: Always enable environments

2a61b43a97-+-contint: restrict docker-pkg conf read perm

e134a6e139-+-role: use scalar() to check statsd udp loss

158cda0705-+-profile: add redis_exporter to redis multidc

1233cf0bd4-+-redis: use hostname not fqdn in redis_exporter

d747ff58a8-+-Kafka: Enable topic deletion for Kafka by default

daf363f8f4-+-graphite: fix wanobjectcache regex

efb9c798f5-+-graphite: blackhole spam from wanobjectcache

f17c1fb895-+-role: bump statsd inbound udp error threshold

b7c5e1e05f-+-profile::hadoop::client: move alarms definition to the worker profile

0416776a72-+-Delete role::mariadb::analytics

9a3c946f33-+-mariadb: Convert db1099 to multiinstance

7374a21010-+-public_dumps: Add puppet class to set up NFS for dumps servers

ba662f47d1-+-public_dumps: Set up NFS on the dumps servers

8ed59718c7-+-cp/lvs: prevent accidental iptables kmods

4eec78bc6c-+-kmod::blacklist: prevent manual install, update initramfs

8df96a57f8-+-profile::hadoop::worker: include the journalnode when needed

e08cb443ab-+-labstore: initial ferm rules shared by all labstore hosts

2b1cca77ef-+-Revert "kmod::blacklist: prevent manual install, update initramfs"

c376565cf2-+-Revert "cp/lvs: prevent accidental iptables kmods"

573604d8fa-+-cp/lvs: prevent accidental iptables kmods

2c71a7b87b-+-kmod::blacklist: prevent manual install, update initramfs

00e9c7f003-+-memcached: remove ganglia monitoring

37e72825a1-+-Revert "Revert "lvs400[1-4] to spare::system""

9056627921-+-openldap: move firewall/standard to roles, use profile

ebfdb11772-+-Revert "openstack: disable notify temporarily"

0470713cc0-+-Revert "lvs400[1-4] to spare::system"

0af50d20a9-+-lvs400[1-4] to spare::system

e5c250fc62-+-openstack: disable notify temporarily

018e6303e5-+-role: alert on statsd inbound udp errors

51f3a12f0e-+-Drop the Eventlogging support for dbstore1002

9f51b146ec-+-role::analytics_cluster::database::meta::backup*: move to profiles

8eb0a367e8-+-cassandra: reprovision restbase1007 with cassandra 3

4836cf98c8-+-Include geoip in kafkatee::webrequest::ops

db2aaab98c-+-grafana_http: Restrict to CACHE_MISC

6bf47985ef-+-mariadb: Prepare to decommission db1021

d9dea75fe4-+-keep misc dumps dirs owner on generating host same as on web server for now

ec7fdcdf12-+-role::puppetmaster::standalone:  allow specification of puppet_major_version

f778f82b30-+-use right path to dumps status file script

abc402c596-+-rsync all dumps status files to web servers and unpack them periodically

6134d32a5b-+-mariadb: Promote es2017 to master

04b2292757-+-profile::mariadb::misc::el::replication: fix logrotate config

2464f55eeb-+-Remove experimental component from contintcloud

55fdf73ab2-+-Revert "planet: Add support for http/2 on stretch"

4faa471786-+-mariadb: Move hosts to s8 replica set on codfw

d5e4aedb17-+-deployment servers: Switch to component/git

dfbd89f31b-+-role:prometheus::analytics: add druid_exporter targets

6d5ada0ed1-+-role::analytics_cluster::hadoop::standby: restore namenode bacula backup

ff0b020c5a-+-role::analytics_cluster::hadoop: move worker and masters to role/profiles

993a016bc2-+-mariadb: Move db1053 to s2

46b984f959-+-builder: use profile::base::firewall

c373a41d61-+-Revert "Revert "apache: remove ganglia monitoring""

008b62f404-+-planet: Add support for http/2 on stretch

f68b4d1aa3-+-Revert "Revert "hhvm: remove ganglia monitoring""

0b372e67fd-+-logstash: Add filter_log4j

eadcf5ae57-+-archiva: move standard include, use profile::b::firewall

60ea50a6eb-+-apache: Add http2 to mod

27e2e15a04-+-Move dataset_mount class out of statistics::compute

1325fe285e-+-Add statistics::explorer role to stat1004 to install R and other packages

cdfdb2bdf0-+-add firewall rules to permit rsync to/from labstore1006

f936adddb6-+-rabbitmq: add a giant default config

4daeef54a1-+-openstack: consolidate labtest regex matches

02f03a4623-+-geowiki::mysql_conf: fix db host configuration in the research cnf file

bac3fafbc8-+-rsync misc dumps (everything but xml/sql) to fallback hosts, labstore1006

7da9f8db59-+-mariadb: Convert db1097 to multi-instance

e526ef9de3-+-Varnish instance: fix child restarted check

33aa523ee1-+-dumps/site: remove outdated comment about firewall

b4cdb9d411-+-profile::mariadb::misc::el::replication: fix el cleaner cronjob

68c45f3699-+-mariadb: Move db1051 from s1 to s5

86b7598573-+-recdns anycast: bird class requires ferm service

f1b954f846-+-bird: enable after systemctl reload, too

5fe40bce4e-+-anycast recdns: ferm and ip before bird

d0951756ab-+-Gerrit: Fix up logstash configuation

b0b7cf742f-+-recnds+anycast: a couple more puppetization fixups

09f1360479-+-snapshots: add scap deploy key info for dumpsgen user

bfcf3a7cd6-+-dnsrecursor: send hostname in version responses

682e857716-+-Have every rdns advertise a private anycast VIP

1474bb455f-+-set cron dates back to normal for xml/sql dumps

96717bb8f0-+-proxysql: Fix invalid puppet dependency cycle

2435138adb-+-proxysql: Fix /var/lib/proxysql permissions and move .my.cnf to profile

49bf83a0f4-+-webperf: convert to profile/role

6e2347debd-+-proxysql: fix /etc/proxysql.cfg permissions

389a20cda3-+-profile::redis::jobqueue: fix default selector

aea6b61ec2-+-proxysql: Enable systemd support so it starts as non-root

39243966e7-+-profile::redis::jobqueue: stagger redis slave restarts

18a7338c44-+-Gerrit: Move apache resources to the profile instead of gerrit::proxy

6ea799dc82-+-Move role::gerrit::server to just role::gerrit

0f5412577c-+-add webperf nodes with test role, add shell for perf-roots

a789d070ab-+-proxysql: Make proxy configuration non-readable for all users

e18d5f2fd8-+-proxysql: Setup proxysql on terbium/wasat as a test

90aa559947-+-Metric alarms: fix dashboard link validation

d2549077ba-+-Icinga notes_url: do not pre-encode the URLs

5a33301001-+-Metric alarms: make link to Grafana mandatory

95f7dcb855-+-profile::pmacct: move configuration to Kafka Jumbo

fc34343419-+-profile::mariadb::misc::eventlogging:replication: add EL sanitization cron

40e9aff42f-+-mediawiki::maintenance::wikidata: remove a trailing semicolon

6ff09d57e7-+-test: use profile::base::firewall

c31a850e4e-+-mw_rc_irc: use ::profile::base::firewall

02417be200-+-planet: Improve look and configuation updates

1c7a84e2e8-+-toolforge: Replace /usr/local/bin/crontab with oge-crontab

1967ad7b0a-+-phab: email_pipe needs path to handler

bd5160f8e3-+-Remove eventlogging_refine_test temporary class

ce81ea98bf-+-phab: remove obsolete portions of email handler

80467dea33-+-openstack: openstack2 => openstack

44d03df48d-+-icinga: add support for puppet 4 in backend puppetmaster https checks

b35eb949cb-+-EventLogging analytics capsule discrepency fixes

070a8c49d8-+-netbox: rename duplicate Icinga check

109a05ff01-+-Temporarily disable EventLogging refine jobs

144d927d4c-+-openstack: cleanup hiera tree for cloud/labs things

74e3e5a151-+-role::druid::public::worker: add prometheus druid exporter

8d7327d86b-+-role::druid::*: add configuration for the Prometheus Druid exporter

4a6febb206-+-icinga: remove display_name

508ea61750-+-icinga: convert display_name in notes_url

348c0aa693-+-prometheus: fix relabeling for redis jobs

8974bab450-+-prometheus: add mtail/exim jobs

4c0d366a95-+-graphite: fix typo

bb772c8123-+-Metric alarms: add link to the Grafana dashboard

8e0a82c8d7-+-cassandra: reprovision restbase2004 with cassandra 3

d467d574ca-+-don't produce flow history dump during partial dump runs

46429e9214-+-start full dump runs on first of the month again, delay second run

d9b0961814-+-Add seperate ensure for testwiki in wikidata crons

f9bfea7fa0-+-smokeping: add $active_server parameter and use it

107d6bfcf1-+-smokeping: enable cron to auto-rsync data

d850710a34-+-Revert "smokeping: switch data rsync direction"

99146b7d7c-+-cron jobs on the dumpsdatahosts use the new dumpsgen user

43dcf15fbb-+-smokeping: switch data rsync direction

2e47271cc4-+-set up directory for misc cron dumps on dumpsdata, move first cron job

86e2ab54ea-+-openstack: labsaliases extra records move to module/profile/role

ebe692a698-+-Prep for moving misc dump cron jobs to dumpsdata host

3e88cacf21-+-openstack: update notes and descriptions in site.pp

a4c2f16fdb-+-mariadb: Add db1109 and db1110 to s5/s8

3282295ccc-+-openstack: move ferm rules out of site.pp

239dc58909-+-move remaining hardcoded paths for base dir of misc dumps out to profile

8f5337c49b-+-Fully normalize upload paths

776687020a-+-labstore: rsync server on misc (dumps hosting)

4848200b82-+-haproxy: Migrate dbproxy1004 to stretch (haproxy 1.7) format

2407d39460-+-keyholder: Use systemd::tmpfile

13aa0664d1-+-mariadb: Remove legacy parameter mariadb10

de0eb9e6ac-+-add labstore1006 to list of hosts for rolling rsync of xml/sql dumps

4fb6060a4f-+-wikireplicas: Repoint web and analytics back to the original servers

472316b753-+-Icinga: allow to set display_name

95aa7e4c01-+-statistics::sites::pivot: Restrict access

be63d074d1-+-nfs_mount: Remove showmount based blocking check for nfs shares

92435e8337-+-Revert "nfsmount: Add temporary exception to the block-for-export check"

c26caedd6f-+-enable dump rsyncs to/from labstore1006

7e9df6e411-+-public_dumps: Define directory for xmldatadumps

f9dbfd3894-+-Netbox deployment followup

b42c882dc4-+-db1070: New master in s5

a23e8399db-+-Puppetize Netbox

05d3a1e736-+-cassandra: reprovision restbase2006 with cassandra 3

cb36d6c714-+-kubernetes:node Add AAAA record resolving for masters

f8c50bba13-+-grafana,racktables,scholarships,iegreview: role to profiles

92bd7aa04b-+-apt: unattended upgrades for wikimedia packages by default

54351b8206-+-prometheus: drop addr/alias redis_exporter labels

0f8cb39bae-+-Remove unused cluster_dns_ip kubelet parameter

2d75e41927-+-Add kubeconfig parameter to k8s::proxy

371036813e-+-Add parameter for kubelet's kubeconfig

bbcbba1ebc-+-Add k8s::kubeconfig define

7b53655a6f-+-kubernetes::master: add interface::add_ip6_mapped

a8d42fa928-+-icinga: reorder includes, use profile::base::firewall

3ccfbc9a26-+-toollabs/icinga: no paging if on labtest

84850e3df4-+-openstack2: no Icinga paging (SMS) if on labtest

5dd734b147-+-profile: fix prometheus::redis_exporter invocation

24c7adad85-+-prometheus: add redis jobs

6b6fbd6a4a-+-wikireplicas: Point all labsdb replica hosts to labsdb1011

d2ede679ba-+-piwik: move firewall to role, include vs instantiate

aa48c9884c-+-etherpad,ganglia,tor_relay: use profile::base::firewall

7e48d136e6-+-lists,otrs: use profile::base::firewall

250ee437c9-+-wdqs: ensure blazegraph data file has correct ownership

483b52ca1f-+-mariadb: Convert db1101 to multi-instance

663b7c6222-+-pmacct: move firewall to role, use profile

4f8da03fea-+-mirrors,peopleweb,spare: use profile::base::firewall

ba9b6e294d-+-rm role::security::tools

3f59848881-+-gerrit,phabricator: use profile::base::firewall

1097be1ca7-+-bastionhost: use profile::base::firewall

2941641fe5-+-installserver: use profile::base::firewall

9d72a1c4a6-+-RT,releases: use profile::base::firewall

e8dbe3bff7-+-misc static sites: use profile::base::firewall

bbd054a1ca-+-Update kafka-jumbo to kafka 0.11.0.1

355a76dc4d-+-Try async kafka producer to fix http timeouts

914aeea3c0-+-wmcs tenant: add libraryupgrader puppet configuration

6f59147643-+-Configure fixed lock manager ports for labstore NFS servers

efcd5333e4-+-Tools: Undo obsolete /var/mail customization

53cee12c18-+-horizon: restrict to $CACHE_MISC

e640dfda68-+-openstack: move main hiera deployment config to common

9b1314f5ce-+-misc PHP apps: use profile::base::firewall

3b7e5d0a89-+-planet: use profile::base::firewall in role

6d49346bf6-+-Tools: Fix test for enabled PHP module mcrypt

cb1a9c6485-+-role: add ferm rule for mtail on mx

1115993dd5-+-labsdb: point analytics replica to labsdb1010 for labsdb1009 maintenance

f95c97a70b-+-eventlogging: Point m4-master to db1107 with db1108 as backup

5c778dc5f7-+-haproxy: Followup to Update configuration template to haproxy 1.7 syntax

9ceffc36b3-+-haproxy: Update configuration template to haproxy 1.7 syntax

73890c8710-+-profile::mariadb::misc::eventlogging::database: fix hearthbeat settings

eb0f75f771-+-site.pp: add role to db1107 (new eventlogging master db)

f919bd5de4-+-Add new Apertium pairs: crh-tur and cat-srd

c2bfa3ebad-+-contint: Fix support for stretch in ruby.pp

563c6db7f5-+-contint: migrate publisher to a profile

367cf80892-+-planet: add Wikimedia Community Logo to rawdog style

af68b332bd-+-add dumps rsync user and path variables to hiera

dab96bc73f-+-Removing site.pp and dhcp entries for decom host mw1161-69 T177387

c01d9cd656-+-cache: set fe->be and be->be max_connections to 50k

1188713759-+-clean up the dumps rsyncer profiles

c8282f5cc5-+-move hardcoded paths out of dump rsync server manifests

a09fff9b7b-+-Remove further package leftovers after jessie->stretch upgrades

6aebc23301-+-move base::firewall out of dumps/snapshots modules and into roles

93f8554d37-+-scap: upgrade to 3.7.3-1

54959d88b3-+-varnish-slowreqs: reduce programname length

4837c63b12-+-Refactor evenlogging database hosts definition

a3f280ea14-+-varnish: log slow requests

6bac31bfde-+-cassandra: reprovision restbase2002 with cassandra 3

95cb542fde-+-role::prometheus::analytics: remove redundant target configs

31b8f667e3-+-Update scap to 3.7.2-1

42bc0bdc8e-+-role::prometheus::analytics: add druid jmx exporter settings

11bd99674d-+-puppet: puppetmaster remove puppetmaster-common package ensure

2fd0c1551a-+-Add ::statistics::wmde::wdcm

dfde3c1235-+-puppet: fix puppetmaster-passenger package in puppetmaster::passenger

6a7753a14a-+-Revert "Deploy MjoLniR with new deploy repository"

1bd909d491-+-puppet: fix puppet package names in puppetmaster::passenger

bc8f26a35d-+-Deploy MjoLniR with new deploy repository

31e528e7ea-+-puppet: fix puppetmaster and puppetmaster-common package names

9519c3d1fd-+-Install spark2 on Hadoop workers for use with Oozie

9dbdb993ac-+-puppet: conditionally pin packages to appropriate repo for puppet 4

a59ae4da2e-+-mtail: allow changing running group

1aed85ef7b-+-role::prometheus: add banner messages to MOTD

052e3a87c1-+-mx: export metrics from exim4 mainlog

85a5bda8fc-+-profile::druid::monitoring::coordinator: fix source for jmx exporter

498e1d28e3-+-elasticsearch: dedicated components in our APT repository

d9593c8f77-+-profile::druid::*: add prometheus jvm monitoring via jmx exporter

15ee1136b8-+-profile::etcd: Move hiera lookups to parameters

856f82315b-+-profile::druid::broker: add prometheus jmx exporter config (jvm only)

011ef01f0b-+-wdqs: allow port 9876 inside the wdqs clsuter for netcat file transfer

ed7c7c9b42-+-Fix wrong hostname for dns4001/4002

a20ce1be42-+-profile: allow Prometheus to access k8s kubelet

7f6d9c7aa2-+-Add system::role to role::etcd::kubernetes

549c39bbbb-+-profile::etcd::auth: Rename hiera key

2a478a0616-+-Prometheus: add kubernetes node cadvisor job

5fdd37216b-+-prometheus: Force using read-only kubelet API

5ae1f47a3b-+-druid: remove com.metamx.metrics.JvmMonitor from default monitors

980ccab49e-+-puppetdb: Fix support for postgresql 9.6

8c6ac72182-+-puppet: add puppet 4 auth.conf template

fc75aa78e3-+-prometheus: fix port vs instance

ef6e67bf8e-+-prometheus: pass -redis.addr to redis-exporter

a24504484c-+-prometheus: switch to systemd::service

a544164176-+-prometheus: have multi-instance redis-exporter running, stop default one

e4335b9234-+-prometheus: fix notify prometheus-redis-exporter

388e84930f-+-prometheus: add redis_exporter class and profile

5cf45d2f9f-+-contint: migrate castor to a profile

e883c1f289-+-fix up dumpsdata rsync argument

fcd4b3b1af-+-clean up dumps web server rsync to its fallback

9e6f44d2d7-+-role: Prometheus https access to k8s apiserver / node

3d46a41a33-+-Remove chromium module

fa7fd26887-+-lawrencium: role spare -> role test

bc27cef220-+-apt: purge unmanaged sources.list

af9a120e88-+-noc: restrict http access to cache_misc

fc2ed6ac60-+-smokeping: restrict http access to cache_misc

2d29f27d2a-+-ci: restrict http access to cache_misc

96300f8174-+-rm modules/role/manifests/requesttracker/upgradetest.pp

46676f982a-+-phabricator: limit http access to cache_misc

9482c2ba7f-+-phabricator: drop ferm rule to open port 443

d9f1455506-+-dns400[12] install params

4b8762ee37-+-move last hardcoded user names out of snapshot modules to profiles

3a6572f08d-+-allow labstore1006 to rsync from dumps servers

31deb45a47-+-lawrencium install params

97115aeaa0-+-lvs4005-7: initial puppet setup

361fd6cb1d-+-Removing site.pp and dhcpd entries for decom db's db1028,33,[35-38,41

492a9db207-+-don't keep and serve old slowparse logs forever

f62ae30af7-+-get rid of the remnants of the cirrussearch dumps logrot

0743cbb404-+-move hardcoded references to dump server mount points out to profile

203736bbb3-+-decom of osmium

aef020120f-+-[EventBus] Increase number of worker processes to 16

3604ea2651-+-move references to datasets use from dumps module out to profile

21e40a3d89-+-ulsfo definition fixups

0f2175c1a8-+-wikibase: include apache class vs declaring it

087ba81177-+-wikibase: include base::firewall vs declaring it

8a650e7a38-+-wikibase: move hiera parameters to correct location

4512993ff3-+-webserver_misc_static: add profile for wikiba.se

c265dd66e8-+-prometheus: reference k8s scrape_configs_extra

490792e18b-+-prometheus: add jobs to scrape metrics from k8s

31b999bad4-+-dumpsgen user should own the dumps repo for scap3 deployment

9b5f8bfe50-+-puppet: fix apache puppet-master.conf conflict at pkg install time

7090624281-+-move explicit references to users and groups out of snapshot module

e43e7712f2-+-cassandra: use LVS endpoint for logstash

26b90c5b29-+-Notify kube-apiserver on user db file changes

ad23e03fb9-+-Parameterize kubernetes node username

8d79d8246e-+-kubelet: Reload on /etc/default/kubelet changes

01474332fb-+-kube-proxy: Reload on /etc/default-kube-proxy changes

ed991c3b57-+-mariadb: db1105 to become multiinstance for s1,s2

1e36f515ba-+-switch dumps monitor to read status from and write results to dumpsdata host

85f7b43dbb-+-planet: rawdog, use one global config for all langs

858c655a3a-+-contint: Install php5.5-xml and php5.5-zip

11c0bad5ea-+-PostgresSQL, add support for stretch and PG9.6

81d48a76fa-+-mariadb: Get ready to decommission db1038

2841f8e93a-+-smart: add ensure metaparameter

101e11f3d4-+-cache: send varnish logs to logstash

e29625a220-+-puppet: add conditional for puppetmaster rack path

35fbc130f8-+-fixups for the dumps generator rsync service

6b37feb99c-+-kubernetes: Allow disabling proxy masquerade_all

9d2911a06c-+-uwsgi: fix dependency for stretch

6da170eae5-+-Revert "cache: send varnish logs to logstash"

dfaddfb293-+-cache: send varnish logs to logstash

e5341d82a8-+-cache_text: reduce inter-cache backend timeouts as well

e0cc146b6e-+-puppet: add puppet_major_version variable

6e9ccd3e27-+-rsync xml/sql dumps on an ongoing basis from primary dump nf host

c4f03f8021-+-logstash: split logstash_syslog hiera setting

92ea449b12-+-piwik: restrict access to cache_misc

48965685cf-+-wikibase: restrict http access to cache_misc

54d1da9b3d-+-iegreview: restrict access to cache_misc

d63fdfb646-+-Fix code commenting out installer apt lines with new repository layout

cb5f751a83-+-etherpad: Restrict access

a4f2ab63bf-+-otrs: Restrict access

ce65d0ba32-+-role::servermon::wmf: Restrict access

c5221665e2-+-role::wikimania_scholarships: Restrict access

88501e64fd-+-profile::planet::venus: Restrict access

18c0dcf95c-+-role::microsites::peopleweb: Restrict access

cf712d393b-+-Restrict HTTP access for racktables

4a716ab063-+-enable rsyncs to dataset1001 from dumpsdata hosts

6e73951864-+-script for cleaning up old dumps on the web servers

da0e91e4b5-+-fix up paths for wiki lists on dumps web server

e8f55a7396-+-cleanup old dumps on dumps web servers, part one

e46a0a65d9-+-contint: use profile::labs::lvm::srv instead of role

9ff073ca79-+-Migrate contint::firewall to a profile

77dad3123e-+-graphite: use profile::labs::lvm::srv instead of role

59b99ea317-+-Drop unused role::ci::jenkins_access

9ea03500a5-+-unified certs: shift year to hieradata for easier renewals

83966ddcbb-+-certs: add globalsign-2017 to deployed set

0b3c4d63b8-+-Gerrit: Replace certificates with tokens for its-phabricator

a2be681f48-+-Gerrit: Fix Icinga gerrit process check

67a1047d70-+-gerrit: fix HTTPS monitoring, use service IP

c6ce0404c0-+-gerrit: let Apache proxy only listen on service IP

f50d3ff985-+-mariadb: Convert db1103 into multinstance: s2 s4

e98e3ba572-+-LibreNMS: update AS#, add eqsin

3610df6134-+-Fix two Jenkins tests errors in site.pp

7631c0d05c-+-run xml/sql dumps on dumpsdata host

a73381e9fc-+-profile::discovery_dashboards: Remove forecasts dashboard

bcb55f3108-+-docker::builder: explicitly install make

466ec050f1-+-profile::ci::shipyard: add docker-pkg

87b0529c53-+-Don't refine mediawiki_recentchange events

2245a54438-+-Import mediawiki.job queue topics into HDFS via Camus

84f062495b-+-labstore: use require_package

ff6eaa2a46-+-releases::mediawiki: limit ferm srange to $CACHE_MISC

2afa3a833e-+-Cumin: fix wmf-style violations

42ef4c5754-+-profile::microsites::transparency: Switch to $CACHE_MISC

d6543a1c8e-+-profile::microsites::annualreport: Switch to $CACHE_MISC

8d34437d4a-+-generate separate config for dumps jobs on dumpsdata hosts

4c5cf3287f-+-profile::microsites::static_bugzilla: Switch to $CACHE_MISC

82f29c79b5-+-requesttracker: Switch ferm rule to $CACHE_MISC

0cca8bb944-+-prometheus: add k8s instance

21e70375d2-+-Use new repository layout for stretch onwards

c2f00b47a7-+-contint: include python3 on CI masters

5f4210b78c-+-releases: Clone MediaWiki + extensions + skins + vendor to /srv/mediawiki

5c713b35a6-+-Git::clone tidy up default gerrit URLs

534debc706-+-mariadb: Add db2085 to s3 and s5

e0b6795909-+-mount nfs share from dumpsdata host on snapshots

3342b9beec-+-interface::noflow - runtime disable on fresh install

80c69d4229-+-LVS+Caches: disable Ethernet flowcontrol

86ad59631c-+-add dumpsgen user to the snapshots hosts

76ebf2652f-+-Camus imports eventbus data into /wmf/data/raw/event

f50f26f16f-+-fix role name in snapshot motds

316f516173-+-Run JsonRefine job in yarn deploy mode cluster and provide hive-site.xml

4ede98c3a7-+-lvs1001-6: increase bnx2 rx ring buffer

d6c6fbf732-+-make dumps snapshot host roles more role-like

2c040dbbfc-+-Include job_name when checking if json refine job is running

e4f1c1ed21-+-opt name is --database, not --output-database

0e73f43f01-+-Fix (again) refinery_job_jar var and run refines at 20 and 30 mins

5ca3e91a7a-+-Fix refinery_job_jar var

63d0ad55dd-+-Refine Eventlogging analytics and eventbus data into Hive tables

1b14112dbb-+-Revert "Global: Turn off ethernet flow for all interfaces at boot time"

0264d5e043-+-Revert "Global: runtime disable ethernet flow on fresh install"

db053ed360-+-add new dumpsgen user to dataset1001 and ms1001

7b73517c59-+-use separate path for public/other datasets

88815a6112-+-Ship a dummy config since IncludeOptional isn't really optional

b134984ea8-+-k8s::controller: support service account token signing

37207a1d2d-+-Remove $cluster_cidr from k8s::controller

05b4e9ba14-+-k8s::controller: Notify service on config changes

8adf767024-+-puppet: fix trailing slash on file resource /usr/share/varnish/tests

b39bbb6c76-+-varnish child started: avoid illegal characters

81c5837be0-+-Install Spark 2 for Hadoop clients

c513fcda26-+-puppet: change ganglia site_instances to call instance by full name

e43eff4032-+-puppet: change mediawiki updatequerypages::cronjob call to full name

85135c489f-+-deplay Nov xml/sql dump run by two days

1454d6c97a-+-generate one config file for xml/sql dumps for wikis

ab1d71c866-+-puppet: fix yubiauth yhsm_yubikey_ksm file require

aba51fa1fb-+-Set main-eqiad -> jumbo->eqiad mirror maker heap to 512M

ac171487b7-+-puppet: fix yubiauth yhsm_daemon file require

c32a7ae58e-+-LVS: Disable LRO

4d267d477e-+-prometheus: fix port for prometheus/analytics

2890c1d07d-+-prometheus: add analytics instance

9d5d1a3232-+-contint: move blubber from docker to pipeline profile

e9e8a4304e-+-mariadb: Add db2089 to s6 and s5(s8)

3377cca5a4-+-openstack: labtestpuppetmaster params adjustments

622c1af55d-+-puppetmaster standalone: pull puppetmaster from hiera

1421009cd7-+-openstack: refactor deployment specific puppetmaster code

2d4c1f9851-+-varnish: fix 'child restarted' icinga check

b12236c485-+-puppet: change dbstore_multiinstance mariadb groups call to full name

dcdf61ddba-+-puppet: change mediawiki refreshlinks cronjob call to use full name

e7ec371ce7-+-puppet: change ganglia aggregator site_instances call to full name

e32e07d097-+-docker::builder: also install python3-wheel

13058be3c4-+-varnish: monitor child process restarts

ce4d02e8a0-+-docker::builder: add class to install tools to build images

3f4d689050-+-Deprecate copper

52f390a813-+-allow dumpsdata hosts to sync to/from ms1001 and dataset1001

29be9a27e6-+-Switch use of jenkins for >= stretch to thirdparty/ci

f0449af6db-+-extdist: use profile::labs::lvm::srv instead of role

f1651e5465-+-rm requesttracker::labs class

ed71a462cc-+-ci::slave::labs: Drop host_aliases for gerrit.wm.org ssh

1ff02c26e6-+-mariadb: Add db2087 to s6 and s7

236237238d-+-mariadb: Move db1103 from s3 to s4

df7ba89922-+-wikitech: Install php5-readline for cli scripts

5fa63116e2-+-Varnish: puppetize per-backend between_bytes_timeout

d20e36c512-+-puppet: update hiera function call in role::puppetmaster::puppetdb

b56f3d34da-+-git-sync-upstream: rewrite in python

d13805d839-+-cyberbot::db: ensure mariadb service running, add service

93af628bcd-+-gerrit: sshd listen on specific IP, v4 and v6

1b6ab0cbde-+-VCL: Exp cache admission policy for varnish-fe

7e39ba05a9-+-mediawiki::maintenance::wikidata: fix variable substitution

c2d7be5dc7-+-mediawiki::maintenace::wikidata: log Wikidata dispatchers

7da170d576-+-Disable HDFS httpfs daemon, we don't use it

bbb6251b51-+-mariadb: Convert db2086 to multi-instance

4aca565053-+-releases/upload: set correct upload server as active_server

cb16f8f0ec-+-Caches: Disable LRO

7ce3f266d8-+-Reenable raw data drop job

88d4d9828f-+-Global: runtime disable ethernet flow on fresh install

3dad39e620-+-Add comment about flerovium and furud in site.pp

ae1aa96de8-+-splitting bast4002 to its own entry

44f9a9c6f9-+-role::discovery::learner: Remove deep learning profile

1f31404abc-+-R, Shiny Server, and Discovery Computing fixes

20f44310c8-+-setting bast4001 params

d992d16319-+-Run MirrorMaker on analytics Kafka hosts to mirror main -> jumbo

e6235ec1a9-+-Disable kafka MirrorMaker on kafka-jumbo

98db8d6884-+-Set up Kafka MirrorMaker from main -> jumbo in eqiad

4a87c1641d-+-Use thirdparty/k8s repository for profile::docker::engine

605a66ba09-+-graphite: Use systemd::tmpfile

411f770a32-+-graphite: cleanup cassandra metrics

ecdcd2f293-+-Add upstream bug references

c4b713da83-+-Fix setup of libapache2-mod-security2 on stretch

f1789f7c88-+-cache: move frontend memory cache sizing to varnish::common

c94afbfe46-+-Create /run/nutcracker on stretch onwards

860525427c-+-mediawiki: Disable rebuildTermSqlIndex

a1fe957645-+-profile::mariadb::misc::eventlogging::database: set correct mysql params

f584554701-+-Global: Turn off ethernet flow for all interfaces at boot time

8201b1952a-+-rsyslog: bump maximum fds for rsyslog-receiver

f95e8cb452-+-puppetmaster: make hiera lookups class params

3f496cbf91-+-centralserver: add icinga monitoring for syslog-tls

36c2abdf33-+-profile::mariadb::misc::eventlogging::database: support mariadb 10.1

fb5ee00e00-+-profile::mariadb::misc::eventlogging:repl: fix typo in rsyslog config

9f936fbe2a-+-profile::mariadb::misc::eventlogging:repl: fix systemd template

496b02c7ec-+-site.pp: set db1108 as analyics db replica

8b77c00be1-+-profile::mariadb::misc::eventlogging: add support for systemd

065c9b1008-+-mariadb: Add db2091 to s2 and s4

7c086fd454-+-role::discovery: Fix stats/ML classes

70ebe51f00-+-videoscaler: decom part of the older servers

8423c55fa9-+-gerrit: skip gerrit-ssh monitoring if on slave

15712b0fd3-+-install params for labvirt10[19-20]

41d7aee6ab-+-gerrit/icinga: fix check_ssh on a custom (service) IP

3be962501c-+-gerrit-ssh: don't listen on all interfaces, disable on slaves

bec1b31267-+-requesttracker: apache resources vs include

62bdd4f1f2-+-Add profiles/roles for stats/ML on Wikimedia Cloud

31d5e47d92-+-jobrunner: decommission old servers

91873cf946-+-prometheus: use profile::labs::lvm::srv instead of role

6f58d2ce91-+-profile::mediawiki::jobrunner: use 70% of capacity

adbab6b69b-+-role::mariadb: Introduce mariadb eventlogging profiles for master/replica

adfd614255-+-ci: Use docker class, pass configuration

74050c6233-+-builder: Disable docker's iptables handling

1bf2f62291-+-Create profile::package_builder

629500f66a-+-mariadb: Add db2088 to s1 and s2

548086283c-+-contint: profile, role, and packages for R language

6716abb270-+-beta: migrate autoupdater to a profile

3b65ea72d0-+-aqs: add http-subrequest to hyperswitch's config

11f3d656dc-+-Add systemd::tmpfile to configure /etc/tmpfiles.d configuration files

88df633b43-+-cache: set varnish runtime parameters via hiera

775cde4100-+-nfs: increase timeouts when checking mount availability

5f87f21ed7-+-Remove cp4009,10,17,18 from ulsfo text cluster

8eaf8a9fa4-+-wdqs: garbage collection tuning

d9f2aa3853-+-maps: use puppet generated configs for sources.

4bfbd45da8-+-maps: move kartotherian and tilerator sources to puppet

e1a496fce5-+-eventlogging_sync: fix logrotate rule and change error log filename

826251e68c-+-Add thirdparty/confluent on stretch-based kafka brokers

6368624293-+-Revert "apache: remove ganglia monitoring"

3ee659a1db-+-Revert "hhvm: remove ganglia monitoring"

7b77f509f1-+-quarry: use profile::labs::lvm::srv instead of role

c6ee8299db-+-Add profile::labs::lvm::srv

7536417dda-+-contint::website to a profile

c2e265021c-+-jenkins: disable auto-discovery

89509ba47e-+-Support --bare in git::clone()

58a85104f6-+-htcppurger: vhtcpd-0.1.x specifics

da28c273f0-+-htcppurger: move puppetization to base profile + hieradata

e7d6c9b2e8-+-ganglia::decom: also purge package libganglia1

cae83e114c-+-hhvm: remove ganglia monitoring

6d16aa43a2-+-apache: remove ganglia monitoring

e441ee9d7f-+-osmium: tmp restore access for perf-roots admins

3767da034e-+-package_builder: Add buster as an environment

2493fdf159-+-package_builder: Switch default distribution to stretch

5add07ed1f-+-Drop i386 environments from package_builder

bf4cadeb9a-+-Provide deb-src entries for older distros on package builders

d7ca839e89-+-profile::docker::registry: allow using an external certificate

0b2c7f9ea3-+-profile::aqs: specify the cassandra_local_dc parameter via hiera

651951e8aa-+-varnish: remove temporary workaround

133ad4f4cf-+-ganglia: also remove systemd unit files on decom

032e94c08b-+-varnish: bugfix previous bugfix

61e0b1442a-+-varnish: integrate sec into main unit file

40dac8ade5-+-puppetdb: temporarily allow puppetcompiler1001 to reach puppetdb nginx

01df12ffe2-+-Gerrit: Set lfs configuation

a06514c5f1-+-udp2log: remove ganglia monitoring

0ca8a9c26a-+-cp4029-32: add to cache::text (but not ipsec yet)

e7e93c71ef-+-Revert "puppetdb: temporarily allow puppetcompiler1001 to reach puppetdb nginx"

46138aa82b-+-puppetdb: temporarily allow puppetcompiler1001 to reach puppetdb nginx

528d1536e3-+-smart: install hourly cron

1d6a5fee12-+-prometheus::jmx_exporter_instance: use hostname rather than title

601c482ced-+-smart: require smartmontools for syslog logger

22a8883365-+-profile: add check_smart to selectively enable ::smart class

49ebacb109-+-Revert "prometheus::jmx_exporter_instance: use hostname rather than title"

c7405bd376-+-prometheus::jmx_exporter_instance: use hostname rather than title

105ce5f09c-+-prometheus: add conntrack/entropy/edac collectors

500c312507-+-mariadb: Add db2092 to s1 and s3 as rc

451fc6a942-+-cyberbot::db: don't use broken mysql::server class

516fa1f47c-+-cyberbot::db: set datadir, bind_addr, use mysql::server

4c5016e386-+-cp4032 install params

ff4b9fb64e-+-Gerrit: Add missing group to /var/lib/gerrit2

25eda2cd5b-+-Gerrit: stop installing deb package, replace with scap requires

e584c6862a-+-Also use scap-deployed version of gerrit.war for actual running of gerrit

1eed1f642f-+-new ulsfo lvs systems install params

66a7a7a6df-+-Own jmx exporter config files as root and 0444

27739ac149-+-Move require_package('prometheus-jmx-exporter')

b6d4c53cca-+-cyberbot: start simplistic role classes for db/exec

720b7c60c6-+-Add profile::prometheus::jmx_exporter define to DRY up using jmx exporter

a676c74fc7-+-install params for new cp40(29|3[012]).ulsfo.wmnet

b9531d9f40-+-cacheproxy: IPv4 PMTUD when blackhole detected

49435d9023-+-errorpage: Set explicit height on logo image

a67051582f-+-errorpage: Migrate from back-compat wmf.png to wmf-logo.png

6430a1565c-+-confluent::kafka: refactor existing code with a commons class

8f9897dd53-+-screen-monitor: raise WARN to 4 days, lower CRIT to 20 days

3cf39d5893-+-Add filtertags to ci/slave/labs/docker

44d87e20e3-+-mirrors: use correct path for the config file

eb82548359-+-mirrors: stop shipping ftpsync, use package instead

1afe7606ce-+-Gerrit: Use systemd::service for systemd

ec7f416917-+-mediawiki: Remove the cronjob for rebuilding entity_per_page table

38fd25244d-+-Do not rebuild wb_entity_per_page

6c87eadb6b-+-ci: add mediawiki core and vendor to gitcache for docker slaves

c1b3beb843-+-ci: provide bare copy of puppet.git on Docker slaves

34139e63fb-+-openstack: remove unused role/labs/dns

336a89edd3-+-openstack: remove ganglia disk stats

6965653b31-+-varnish: execution environment configuration

3db1cc043c-+-mariadb: remove cruft class for old wikitech setup

9197b9c91e-+-labstore: use profile param for observer_pass

0f1630d0d8-+-openstack: dns-floating-ip-updater to module/profile/role

00e45dfb81-+-Cumin WMCS: explicitely install OpenStack dependencies

cc4cc9b769-+-[WIP]: Support multiinstance in core servers

6cea803116-+-mariadb: Add db2086 to s5 and later s8

1ee769046c-+-Gerrit: Raise git_open_file to 20000

bb108c7301-+-Gerrit: Make packedGitOpenFiles configurable with puppet variable

4aae100816-+-openstack: cleanup for paths and novaconfig usage

ad5628c54a-+-openstack: reuse canonical pdns values for nova network

0585499ade-+-openstack: ensure system::role on all role/wmcs

400bafb621-+-openstack: nodepool to module/profile/role

fbb2f3d0c6-+-openstack: nova manager/osm/wikitech to module/profile/role

a41fce3f14-+-base/standard_packages: add dnsutils

056ca95f35-+-Removing db1018 from site.pp and dhcpd file (decom)

b6a8c42918-+-Add support for stretch to hhvm::debug

b6e16a4acd-+-wdqs: increase heap size to 16GB

9a59861063-+-Removing db1022 from site.pp

98ca983e7f-+-Add the LVS config for the druid-public-broker service

b94cafbce2-+-Deployment pipeline profile

08ae140190-+-Fix cron job for refinery data drop of MediaWiki snapshots

8aed8baadc-+-maps: introduce the base requirements for vector tiles and cleartables

6662ceef53-+-openstack: horizon correct wmflabsdotorg_admin lookup path

84eda08b42-+-mjolnir: cleanup service declaration

83f1fa06ad-+-openstack: horizon to module/profile/role

dc88452b9f-+-varnish: remove varnishlog.py

1d1ca5dece-+-mariadb: Remove db1050 from config

9bb455d15a-+-mariadb: Add db2084 to s5 and later s8

b04b9200ef-+-add mapped IPv6 address for puppetcompiler1001

da171123ad-+-dnsrecursor: drop ganglia metrics support

a469903da4-+-Add temporary cron job for eventlogging refine test

68021b8cdd-+-role::aqs: add druid options to AQS config and move aqs to profile

bdea770213-+-Purge /usr/lib/ganglia/ and /etc/ganglia

8512c3f8a8-+-openstack: cleanup ceilometer files and roles

c4e48cba62-+-openstack: net_standby vs net_secondary for cold spare labnet

7ae9642fc5-+-scap: upgrade to 3.7.1-1

8428b41d12-+-openstack: pdns recursor module/profile/role

e8c3c2bd18-+-mariadb: Add db2083 to s5 and later s8

0e082a47a1-+-mariadb: Add db2082 to s5 and later s8

a89952c5a7-+-pybal: use Monitoring::Plugin in check_pybal

beed152347-+-mariadb: Add db2081 to s5 and later s8

76de0e8088-+-authdns: remove ganglia support

c2a30d79a6-+-ganglia: decom class should use "ensure => purged"

6a307eacd4-+-openstack: labs-ip-alias-dump as a cron rather than exec

b216a25b19-+-puppet: Add puppetcompiler1001 to site.pp

422a24dcae-+-role::analytics_cluster::hadoop::ferm::namenode: disable httpfs access

6f7122e8b2-+-role::an_cluster::database::meta: allow the druid pulic cluster to use mysql

a0e7a686a9-+-Provide a reboot wrapper for Cumin clients

bb9ab0f8ae-+-Set up separate druid public-eqiad cluster.

73ff4faabb-+-Add reference to Phab task

e9067fa6ac-+-openstack: remove pdns auth things for labtestservices200[23]

94796189a1-+-decom of cp4005-8,13-16

f333f0201e-+-openstack: pdns auth module/role/profile

5f9dff0e7d-+-Migrate puppet compiler instance from /mnt to /srv

c1c221b6b7-+-Revert "Add ftp-internal to puppet"

91f4d1ac8c-+-removing db1023/24 from site.pp for decomm

fff16a4dfd-+-maps: isolate maps-test2004 to test vector tiles

97247ca6a3-+-ocg: remove all references from puppet

06f8aa44b0-+-ocg100*: convert to role::spare::system

01a344189b-+-profile::kafka::broker::monitoring: refactor prometheus metric names

68db5e2761-+-Add letsencrypt certs to mx servers

0df5a9b400-+-Add cron job for analytics banner activity cleaner

2959f5ad16-+-phabricator: move apache includes to profile

9c98715c31-+-contint: apt-get update before installing packages

78c944c1d9-+-annualreport: rm module, merge into profile, fix style

b3c6968b3c-+-contint: move from /mnt to /srv

3d5572c0c8-+-zookeeper: update comment about ganglia stats

ebfad362d8-+-elasticsearch/logstash: drop ganglia monitoring

d70eb56fc4-+-varnish: add support for version 5

55521f1735-+-Remove libapt leftovers after jessie->stretch upgrades

e45224b7f1-+-profile::cache::base: explicitly declare varnish classes

48c8680d44-+-role::cache::instances: move to cacheproxy module

70ecb41a69-+-role::cache::misc: move to role/profile

bde7d3946e-+-smart: new module

fd920ce3c0-+-role::cache::upload: move to role/profile

b8e6d53de6-+-role::cache::text: move to role/profile

860f97aa62-+-mariadb: Provision db2080 on s5

45979e8549-+-profile::cache::ssl::unified: move from role, refactor

7749208c08-+-prometheus: add nginx_cache_upload cluster definition

7bdc2e328d-+-mariadb: Move db1072 to s3

c0cfb63651-+-puppetmaster: don't include ruby-ldap packages

2c424ad9b1-+-Remove druid100[456] from druid analytics cluster.

f284a48666-+-cacheproxy: move some content to new module

aa887fa1a3-+-prometheus::varnish::exporter: convert to role/profile

cbb6b3737f-+-role::cache::base: convert to profile [2/2]

e78407e223-+-role::cache::base: convert to profile [1/2]

4195ab7ad0-+-cache::upload: enable nginx-lua-prometheus

98a5580a6e-+-profile::docker::registry: conform to current style guide

a61a573653-+-cache: convert kafka::webrequest to profile

3272b94353-+-pybal: BGP MED configuration

5b9e637d33-+-bacula: remove ganglia backup sets

efe80cce1c-+-role::cache::base: abstract varnish logging to class

e597745360-+-Install python-dateutils via puppet

e0e8ebcb05-+-mariadb: Provision db2079 into s5

a6e2d5087e-+-wikiba.se: Remove colon from VirtualHost

85d8e7a3f7-+-wikiba.se: Add missing variables to wikibase.pp profile

7adc155838-+-wikibase: fix git clone destination

02a0ad3103-+-wikibase: fix document root path

7abecf6a24-+-start profile for wikiba.se web hosting

7998e83114-+-labstore: set commented base::firewall

64fca3f946-+-purging: put BE before FE in varnishes list

cddc5f1d58-+-Bring back hadoop::client role, move cdh module hiera to common

ec61cc070a-+-analytics_cluster::client role instead of analytics_cluster::hadoop::client

c001376486-+-Install analytics_cluster hadoop client on flerovium and furud

9ba962b50a-+-dbstore: Move socket location to the right dir /run/mysqld

964c51e09e-+-Remove dbstore2 role, make dbstore default to the new socket location

dcd8752f9e-+-druid: fix cronspam from cronjobs trying to remove directories

0506427952-+-cache_text: disable varnish_be<->varnish_be max_connections

4416e87bc6-+-racktables: role/profile, remove style violations

1179cdba1a-+-Add ftp-internal to puppet

6fa097d9a9-+-jenkins: switch to Java8

a8bd97b47e-+-Move labs shinken to #wikimedia-cloud-feed

4c9b035f76-+-contint: Make php.pp compatible with stretch

68c39bc68d-+-Regenerate FancyCaptchas weekly rather than monthly

ff4367e16f-+-Change Wikistats 2 deployment branch to 'release'

8e14ec8d4f-+-mariadb: Add db1106 to s5

48d0d56480-+-mariadb: Add db1105 to s5

59b7e7d8cd-+-wikistats (labs): profile/role, remove violations

a8d8878937-+-labweb: I don't think we need a local db anymore

dac135deb0-+-releases-jenkins: fix prefix for proxy setup, pt.2

e77fe5e5a8-+-releases-jenkins: fix proxy setup, prefix setting

1f71efbd97-+-releases: rm proxy_jenkins class, mv Apache includes

d49d6f06cf-+-labweb: add appserver and ldap classes

f42bb4999c-+-Revert "Revert "releases-jenkins: remove now unused jenkins_proxy file""

3fb530bc1c-+-Revert "Revert "releases: drop /ci/ suffix for jenkins-proxy, unify templates""

5fc6957690-+-Enable basic ACL handling on the Kafka Jumbo cluster

baed462df3-+-Remove reportupdater job that triggers abandoned discovery-stats

5726c565c4-+-wmf-reimage: remove dangling reference

3037276ceb-+-site.pp: Remove db2010

372be78ced-+-decom wtp1001-wtp1024

9800eccca2-+-contint: move backup from role to a profile

c51bb09f18-+-prometheus::node_gdnsd: ensure python-requests is installed

b1ee595513-+-contint: properly support jenkins monitoring

8e22f42943-+-Remove beta::saltmaster::tools and /usr/local/bin/beta-apaches

78aa43aafa-+-contint: move jenkins from role to a profile

2e607acaee-+-contint: move an include from site.pp to role

8e2f88c4ff-+-profile::ci::slave: install blubber

b3af2ca017-+-Revert "releases: drop /ci/ suffix for jenkins-proxy, unify templates"

24059f44ff-+-Revert "releases-jenkins: remove now unused jenkins_proxy file"

1bb98db151-+-mariadb: Add db1104 to s5 cloned from db1087

ba756023ed-+-releases-jenkins: remove now unused jenkins_proxy file

9aa4220dc2-+-releases: drop /ci/ suffix for jenkins-proxy, unify templates

a395d1ddbe-+-downloadserver: fix path to nginx config

208d89c4f1-+-Add a profile for a trivial file download server

81492c4e33-+-labweb1001, 1002: initial site def

aec0685af8-+-add releases-jenkins apache/varnish, move jenkins proxy config

f13e199f91-+-base: fix expose_puppet_certs owner vs user

f02d4ac42a-+-base: cater for rsyslog on trusty running as 'syslog'

58cd4334e8-+-wikistats2: migrate git repo from differencial to gerrit

80bc2c49da-+-check_puppetrun: Execute less often

66b25b66f5-+-raid: Increase retry interval to 10 mins

b714d76b4b-+-monitoring::check_prometheus: fix ordering of arguments

a5a7dc2f67-+-base: check remote_syslog and remote_syslog_tls for emptyness

23d351e811-+-Convert zuul::server to a profile

43152ea167-+-profile::kafka::broker::monitoring: attempt to fix prometheus alarm

a76d22f5a1-+-Convert zuul::merger to a profile

9d2b4a5599-+-profile::ci::docker: fix exec in production

5e3266e3aa-+-contint: move slave and website roles to profiles

a28ab85659-+-role::mariadb::analytics: add logrotate fo eventlogging_sync's log

8ae72387e2-+-Remove ELF binaries from across the tree

b111c12c6b-+-remove endowment.wikimedia.org

0b0a73c5e2-+-Aptrepo: Add --delete flag to rsync-aptrepo cron job

aeee73b521-+-move hardcoded path to public dumps dir out of most dumps rsync manifests

b44ed705d9-+-move hardcoded mwlog hostnames from dump rsync manifests to profile

a0604301cf-+-Quote Prometheus query label values in kafka broker monitoring

dd5b91cf37-+-move hardcoded refs to labstore hosts from dump manifests to profile

308dc9c82a-+-Prometheus based Kafka broker alerts, take 1

bb474afff6-+-move hardcoded phab hostname out of rsync config for dataset hosts

f7e104c779-+-Change check_ipmi_temp to check_ipmi_sensor and monitor Power_Supply

11a234808b-+-base: create /etc/rsyslog as required

0400fa5d6f-+-hieradata: use syslog-tls (6514) port not 6154

195c5bad22-+-base: ability to send syslog over TLS

53fe5dcdb8-+-camus - switch to logrotate::rule

d90bd89a78-+-mediawiki: Maintenance script to clean up duplicates in wb_terms

d0074c5ba6-+-site.pp: Remove blank space

ea2276f18c-+-mariadb: Remove db1036 for decommissioning

6e1f4f789c-+-move most dataset1001 and ms1001 references from dumps modules to profile

8f8dc6cf2b-+-move hardcoded refs to francium, dumps.wm.o out of dumps manifests to profiles

9826e91cb3-+-move hardcoded references to stats hosts from dumps module to profiles

5443e479f9-+-Template-ise rsync/public.pp hosts allow

74e2df471e-+-rabbitmq: redirect cron errors to logfile to avoid cronspam

44ffa426c0-+-screen-monitor: raise WARN threshold to 24 hours

bf1cce4971-+-mariadb: backup user must be dump to match already in use mysql account

229e1c6f12-+-releases: add missing Jenkins proxy setup

8f6d621baf-+-flerovium.eqiad.wmnet install params

9a77a08ee3-+-mariadb-backups: Fix require on cronjob

2d77f40ad7-+-mariadb: Implement regular logical backups using mydumper

c42c8c8ff5-+-rabbitmq: fix a broken filepath from a previous patch

8aea72558d-+-check_interval, retry_interval for screen/tmux check

df62a4e4ba-+-rabbitmq: drain and log notifications.error hourly

7cd4defc89-+-move rabbitmq drain_queue script to the rabbitmq module

f110231ba2-+-mediawiki: stop rebuilding wb_terms table

2ad4811903-+-prometheus: add pybal configuration for prometheus::ops

0241659511-+-profile::kafka::broker: allow prometheus masters for port 7800

8b49a8a64d-+-nutcracker: create the service only after the package install

8a1b7c5667-+-releases: fix jenkins_prefix, /ci not /jenkins

190e6e1679-+-Software decom for cp4005-8,13-16

3f3ff0dde4-+-profile::druid::*: include profile::druid::common

5c4a6435ee-+-grub::bootparam: fixup interface issues

d82a385cd6-+-Add cron to purge old mediawiki data snapshots

e00904c893-+-contint: docker-ce on labs docker slaves

8e0ddd40e5-+-role::druid::analytics::worker: split properties into public/private

ea74ad5457-+-wmcs: update rabbitmq drain_queue script

9aad359f47-+-Decouple profile::ci::docker and worker_localhost

66d16a12c3-+-Decouple profile::ci::docker and zuul-cloner install

ead4fe655a-+-Decouple profile::ci::docker and arcanist install

4d5f0df144-+-site.php: Add db1035 to spare

a7ac75ddd5-+-mariadb: Remove db1035 from config files

0b4b62abd4-+-Remove profile::openstack::base::salt

4c742a4173-+-Remove obsolete labtest salt classes

5dcbc6f169-+-numa: remove isolcpus explicitly in non-isolate mode

4e0eab88d7-+-pybal: bind BGP TCP port to private addresses

9e6c2471b8-+-Improvements to druid profiles, move druid role out of analytics_cluster

d83a1e52f1-+-package_builder: Add dh-systemd

f4e7164be9-+-Remove role::salt::minions

db1ceb002f-+-Stop including role::salt::minions

9c281426df-+-Remove salt::minion class

1bfe3f673e-+-Purge salt-minion and salt-common in labs

fc235b03e1-+-role::kafka::jumbo::broker: allow ganglia configuration

64649c0aa7-+-Remove obsolete salt classes

8bd91b83e4-+-base: switch to logrotate::rule

033b2c056c-+-Remove role::salt::masters::labs::project_master

a9a84fcc9c-+-Remove role::salt::masters::labs

6cbb0dec8b-+-role::prometheus::ops: add kafka metrics

b888d1ee55-+-icinga/base: re-enable screen/tmux monitoring

ba08c75cc6-+-base: screen-monitor, raise CRIT limit to 1 year

4a79ea214e-+-device_backup: Update cron MAILTo to new mailing list address

4cb4174fbf-+-toolforge: Remove /usr/bin/sql

842b33057b-+-Add OpenGear support to Rancid

e460b569cc-+-furud install params

e237241838-+-Revert "base - switch to logrotate::rule"

0bbbb2b229-+-base - switch to logrotate::rule

03ba515eba-+-Remove support for setting custom Salt grains

341198c490-+-Stop defining salt grain per labs project

ee0d9cc5dd-+-Remove role::salt::masters::labs from labcontrol* hosts

d4ab43889a-+-cumin (WMCS): allow to setup cumin in a project

ce6df9f444-+-pybaltest: add IPv6 to HTTP/BGP ferm rules

860ed860ec-+-dumps servers: override nginx log rotation file provided by package

9024c09393-+-mariadb: Add db1103 to s3

bd4e2336a2-+-Adapt mediawiki::packages::math for stretch

c49c671468-+-paws_internal: Add the analytics client role back to notebook1001

6587ce6219-+-profile::discovery_dashboards: Add daily forecasts dashboard

85dcb52c2a-+-Phabricator: Remove ubuntu / upstart support

6767785b51-+-Remove last of dataset module and use dumps module manifests instead

165c6bf520-+-Move dataset nfs server manifests to dump module

13a90aab46-+-Add 3d2png deploy repo to image scalers

4c5e0df55e-+-Update eqiad frack monitoring

2de0a9cc98-+-wmcs: Add wikireplica_dns management script

b952b763ed-+-Introduce profile::druid::worker

f42db457d5-+-apt:pin pref file must not have space

08ae675be9-+-profile::docker::storage::loopback: change logic for mountpoint

1d544bb894-+-puppetmaster: convert tests to spec

732feb8c23-+-wdqs: reduce heap size to 12GB

2c5c7216b8-+-logstash: remove cleanup code

a61e1c11df-+-LVS: turn off ip_early_demux

83254ccd26-+-elasticsearch: cleanup curator config dir

31b269e6fc-+-Remove some salt references

1359ec70a4-+-swift: don't track connections to swift backend services on frontend machines

7eb4a9d2d1-+-logstash: cleanup old api feature usage indices for all clusters

5593709386-+-Cloud VPS configuration for hi.wikivoyage

620134a1f3-+-interface::offload: remove hardcoded default eth0

024ef42d9e-+-Gerrit: Remove gc logging

d488563ff0-+-logstash: fix index name for apifeatureusage

94452a66e6-+-cassandra: Follow links (copy the link destination)

fdadf735aa-+-Add boron as a package builder host

62b709094a-+-logstash: api feature logs should be sent to both eqiad and codfw clusters

8ac89c0355-+-Configure agent to export Cassandra histogram metrics

2a9aedaaab-+-rsyslog: add support to receive syslog over TLS

887da60bd1-+-Revert "profile::kafka::broker: add the cluster label to the prometheus metrics"

5534ed3b53-+-Revert "interface: remove unused definition ::offload"

90fe969cba-+-sshd: allow to tune MaxSessions and MaxStartups

2327860d04-+-Remove obsolete role::salt::masters::production class

b6f9077cae-+-Stop providing a salt master for role::cluster::management

4ec121e7df-+-Remove salt-key from puppet certmanager sudo config

d0ebb361c2-+-Stop using salt minion in production

b64373d6ad-+-Revert "Stop including a salt master in the cluster management role"

2c918a2512-+-Adds myspell-lv, myspell-uk to aspell-uk to ores::base

8e56e522fd-+-base: invoke fail() instead of error()

f4335ecc7d-+-Stop including a salt master in the cluster management role

932d1c17d3-+-contint: php5.5 on permanent slaves

ea23664d63-+-move manifest for copying of dumps to labs, peers, to dumps module

1c8d72b1e3-+-move fetches of various datasets to dump module from datasets module

5f1b1b49cc-+-labtest: include salt profile on labtestcontrol

9797b2e321-+-public_dumps: Set up initial module and profile, add to role

5b8eb03e8f-+-labs puppetmaster: install observerenv

e4d64b1114-+-public_dumps: Create initial role for public dumps servers

6228a7d53b-+-profile::kafka::broker: remove graphite metrics config

0161ca7813-+-profile::kafka::broker: add the cluster label to the prometheus metrics

d56faa1843-+-Phabricator: Fix aphlict systemd script

20ced1a6bb-+-Move dataset rsync config manifests to dumps module

1f63d06cab-+-network::constants: add aqs hosts

20bb936009-+-Remove salt minion Icinga check

a5fa8460fa-+-Update comment

4851cefd41-+-Remove obsolete trebuchet class

2a0d3eee73-+-Stop including trebuchet class from base profile

98d0844bca-+-Remove obsolete sudo group

1e1ac6c29f-+-Install docker-ce on role::ci::slave hosts

dd13c702ff-+-Remove obsolete deprecation code

ee707754b8-+-move datasets directory structure and static html file setup to dumps module

768e9b3293-+-Enable thirdparty/ci on role::ci::slave

23f1d9a300-+-Salt: completely remove the orchestration class

2dec581cd1-+-wmf-auto-reimage refactoring

2b450e5b99-+-profile::docker::builder: add build script for production-images

75dacc01f9-+-Remove deployment::salt_master/role::deployment::salt_masters and related files

0609b0d076-+-Move datasets nginx logs rsync to dumps web manifest where it belongs

811f5ba374-+-Remove a few obsolete references to trebuchet

7b0e42f59b-+-Drop trebuchet::packages

55aaec2022-+-phab/aphlict: ensure aphlict group always exists

008aec18fd-+-phab/aphlict: remove require for group by user

fc202335c4-+-Phabricator: configure notification server

787b3b7059-+-cassandra: Link-in upgraded cassandra-metrics-collector jar

94041a655f-+-decom of wdqs100[12]

785acc2112-+-Remove role::deployment::config and the related Hiera data

590d109877-+-Remove deployment::redis ferm service

401afb3d5f-+-labtest: add stub node definitions for some currently unused hosts

d6f459fda7-+-pybaltest: Fix BGP port number in ferm rule

bf584eec90-+-Set elasticsearch servers to use 128kB readahead

7f783f829e-+-Cassandra: Allow extra hosts to access the cluster via CQL

ead2060c0a-+-WMCS: fine tuning Cumin configuration for proxies

f27686bd74-+-Rename role::test::system to role::test

126db45f25-+-WMCS: fix Cumin configuration

0f4dcaa054-+-contint: deploy slave_scripts via git::clone

033a8af664-+-Add git-fat to standard packages

27a13f7be9-+-Remove hack configuring eventlogging/eventlogging to use trebuchet

8d7cb3b818-+-Remove deployment::redis

2b8da8ced1-+-WMCS: install Cumin for WMCS admins

77ddf64c2e-+-Tag WDQS labs tole with labs project tag

8c3c9f934b-+-gerrit: fix host for TLS cert/monitoring if on slave

e3e00c7118-+-cassandra: Upgrade restbase-ng env to Cassandra 3.11.0-wmf5

00fa6b9be8-+-mariadb: Remove all references to db2010 on production

a92cac11a6-+-cassandra: bump dev cluster version to 3.11.0-wmf5

f5ad66e16b-+-mariadb: ferm for m5 use () for multiple source hosts

201989bdce-+-mariadb: add firewall exceptions for m5 and cloud services

a308334eaf-+-Revert "mariadb: add firewall exceptions for m5 and cloud services"

59b1763abb-+-mariadb: add firewall exceptions for m5 and cloud services

fed03f003b-+-mariadb: Decommission db1018 and removing references to it

1ba8aed417-+-Add new m1 host db2078, enable firewall on all misc services

0431503ba6-+-Remove trebuchet-trigger from deployment servers

3e99f66d88-+-VCL: stabilize backend storage patterns

3fb5a024be-+-Remove rcstream puppetization

9f07e3ca03-+-Remove salt grains used for trebuchet

23d5f3ef81-+-base: fix remote_syslog hiera name

199f845cfc-+-profile::kafka::broker: no-op refactoring to test ordering

c18187969f-+-profile::kafka::broker: add the monitoring_enabled option

2a46ef56ad-+-docker::baseimages: another dependency fix

c98688881f-+-docker::baseimages: drop exec for apt-key add

db9b9fce52-+-docker::baseimages: brown paper bag fix

61a58faef1-+-docker::baseimages: fully qualify exec command

9ff518ca0f-+-docker::baseimages: add stretch base image

b14a1e086f-+-mariadb: Setup db1101 on s2 to replace db1018 and db1036

824e99a865-+-site.pp: assign roles to mw1307-28

a79e7638c2-+-Move nfs and directory setup for dumpsdata hosts into dumps module

9f1e26d463-+-scap::conftool: fix home directory

100450f231-+-Gerrit: Link gerrit.war to scap

941c8a168d-+-notebook: Add packages to enable PDF exports

59faf8ba8c-+-Revert "VCL: fixed keep values: 7d def, 1d for text"

e13c9f0295-+-Gerrit: Start using plugins from scap-deployed version

e570dbf4db-+-scap: manually manage the deploy_user home directory

ffd45d3295-+-role::kafka::jumbo::broker: enable Prometheus JMX monitoring

2b8df928ee-+-prometheus: add nginx_cache_text cluster definition

0f4ddd40cb-+-cache::text: enable nginx-lua-prometheus

01fe49ac6b-+-Remove Puppet code which is obsolete with Salt grain removal

739391db86-+-restructure dumps webserver, zim manifests to module/role/profile

4f0df3e8b9-+-Zuul: Add systemd script for zuul

1f4abc90ef-+-Add ResourceLoader Grafana performance alerts

f8ab944c25-+-Remove any trace of stat1003 for decom

3112c8b002-+-Gerrit: Add non-masters to have public DNS entries

650dd17dd2-+-contint: install jsduck via gems

2f1ae12424-+-Change $deploy_user home directory to /var/lib/${deploy_user}

8e3d2fe07e-+-Move phabricator conf files outside of source tree

80b6e993ef-+-PHAB: deployment scripts to be called by scap

4dfb3b2a25-+-Revert "site/dns: tmp remove acamar from resolv.conf overrides"

82773baaff-+-site/dns: tmp remove acamar from resolv.conf overrides

87f54b594c-+-designate: open api to labmon

efc03754b9-+-Deploy discovery-analytics with scap3

f687d2a033-+-Revert "Add 3d2png deploy repo to image scalers"

1b49f63319-+-imagescaler: call 3d2png::deploy as thumbor::mediawiki does

6e26c38949-+-imagescaler: use class-style for 3d2png

930e0ec0d1-+-Add 3d2png deploy repo to image scalers

28111a9db7-+-openstack2: de-duplicate parameter $nova_controller

d05a455fa4-+-prometheus: allow setting a specific listening address and port

f3ff8a3865-+-Cassandra: Include only instance DNS' in the list of seeds

2c066c940b-+-mariadb: Decommission db1049

4a46f41919-+-cassandra - actually use the authentication parameters

9e177a2943-+-cassandra - move super authentication on the main cassandra class

1d67b2c283-+-Assign to wtp1025-wtp1048 the parsoid role

50b454f97c-+-cassandra: future parser and Puppet 4 compatibility

0cd8a11016-+-Introduce a new `target_version` for dev-only builds

9363a09da8-+-labmon: prometheus classes to monitor the keystone api endpoint

6280c5ee7f-+-wdqs - decommissioning wdqs100[12]

300d13a4a6-+-prometheus: avoid duplicate definitions of nginx class

aae87a6b51-+-prometheus::web to apache

be053e732b-+-tools: add an exim sender blocklist

d9dc76db9e-+-Blacklist bluetooth kernel module

12092c7d26-+-logstash - ensure plugin directory is present

20f9571398-+-logstash - configure new logstash100[7-9] nodes

ec81a8ecf7-+-Allow silencing notifications for hosts

53d3c3b210-+-contint: remove references to Ubuntu/Trusty

30f684e167-+-thumbor: fix weird integer interpolation

c6587c887b-+-decommission: Set db1048 with a spare role

5d87f8893c-+-phabricator-mariadb: Add missing include

32b27b1383-+-mariadb - phabricator: Remove public hashes from configuration files

d12d8f650b-+-aptly: support https

6041827beb-+-aptly: support components for clients

17215e5031-+-mariadb: Repoint m3 secondary host (replica) to db1059

651095b944-+-role::snapshot::common: properly scope included classes

965e250571-+-salt: change roots/runner_dir from Array to String

e23c441acd-+-racktables: pass $racktables_host to module

d2b9d974d7-+-openstack2: use !~ instead of ! $title =~ /.../

e509fe9cf4-+-Allow read access to /srv/backup in analytics cluster

d06e5330d8-+-Fetch Hadoop NameNode fsimage backups daily and also save them in bacula

2246608934-+-openstack: designate as module/profile/role

5c26388fd0-+-Remove salt grains from app server canaries

c08baf8476-+-toollabs: fix k8s classes that just include k8s::proxy

28aa295297-+-Deploy iegreview with scap3

75a574aa38-+-Scap: Allow phabricator as a source

fa2ac4d8b2-+-role::kafka::jumbo::broker - Don't include standard if already included

69b5452d8d-+-Deploy scholarships with scap3

b5db7315dc-+-mariadb: Move db1059 from mediawiki to misc (m3)

edf1f8cdab-+-k8s: fix template scoping

2271aa0301-+-elasticsearch - deploy plugins with debian package instead of trebuchet

8fc1fed58d-+-nagios_common: use the template if empty($content)

8bed3f701b-+-grafana: quote 'type' as the class' parameter

58a575553a-+-openstack: move $ssl_settings near the template

891ec683bb-+-ganglia: fix class dependencies

8ade5e4290-+-Use String as redis::instance's $name (noop)

01e58a8ec7-+-statsd_proxy: use validate_numeric()

9cf880296b-+-uwsgi: use validate_numeric()

6cff8f3ddc-+-nutcracker: use validate_numeric()

e643ade45d-+-swift: use !~ instead of ! $title =~ /.../

91901e600a-+-varnish::instance: fix template attributes scope

6427711d1c-+-Add apache2-dev to package list

c2c1e10072-+-Remove salt grains for LVS

5edc7616e8-+-Remove package declarations for debdeploy-minion/debdeploy-common

909116feb0-+-network::constants: update IP addresses of the new Kafka hosts

0a7062a6f3-+-prometheus: increase jmx_exporter timeout

9103a2dc6f-+-[labs] Rename wmflabs-* files to wmcs-*

4caef480ad-+-Revert "labmon: prometheus classes to monitor the keystone api endpoint"

054c8fe0c1-+-labmon: prometheus classes to monitor the keystone api endpoint

668ee8f872-+-Revert "Revert "sshd_config: Increase MaxAuthTries""

bc77229ac0-+-rabbitmq: Add drain_queue utility script

63355d6b82-+-openstack: re-enable notify and subscribe for nova

d18d7957c0-+-Remove old debdeploy/salt packages via puppet

827f78b122-+-role::scb: only include profiles, not roles

6b88935073-+-citoid: move to role/profile

434ca9e0c6-+-wt-static: reword alert messages

ac2a30c70f-+-Convert debdeploy to a profile and make it part of role::cluster::management

0fcb449740-+-Switch role::debdeploy::master role to Cumin-based variant

a8b72d1871-+-Introduce role::analytics_cluster::coordinator

e35bee9f64-+-Revert "sshd_config: Increase MaxAuthTries"

ef1a47313e-+-CP-JobQueue: Add the service to SCB

b41843d2f3-+-varnish: convert role::cache::instances into a class

b709f7e3e9-+-ChangeProp: Separate packages into profile::changeprop::packages

103d2d4a0d-+-graphoid: convert to role/profile

c5a8779703-+-changeprop: convert to role/profile

c52ca5170f-+-pdfrender: switch to role/profile

cb5c8b8471-+-eventstreams: convert to role/profile

91c20111a8-+-trendingedits: move to role/profile

3f01be5ff1-+-apertium: move to role/profile

13c8691e5c-+-Stop creating salt grains for debdeploy

98174d31cf-+-cxserver: convert to role/profile

8a7172bffa-+-mathoid: move to role/profile

d7a1634ac2-+-mobileapps: move to role/profile

aecb3e567b-+-Update comment

b5e3c93ff0-+-site: remove unused virtual host 'zosma'

13e68d2ccc-+-contint: upgrade git on zuul mergers

271ba77764-+-dnsrecursor: Enable PowerdnsRecursor diamond collector

f4b76d7190-+-role::dnsrecursor: Partially transform into a profile

3663205a39-+-ChangeProp-JobQueue: Fix the repo location and name

2e2775ecc0-+-etcd: limit RAID resync speed if on linux software raid

73db34ac69-+-Add the cp-jobqueue profile

f732d7c33f-+-base/icinga: increase warn/crit thresholds for screen monitoring

8b84c5ff80-+-openstack: cleanup keystone references in old module

f8725c2427-+-Revert "icinga/base: screen monitoring by default. whitelist copper, terbium"

4aa48ccbda-+-set deploy1001 isntall params

dce429bfe4-+-icinga/base: screen monitoring by default. whitelist copper, terbium

3034afb0a3-+-convert "other" dump crons to use script to grab config settings

d7072cd4bb-+-Revert eventlogging_sync batch size back to 1000

d99074f201-+-statistics::wmde: use the same name for group and user in wmde stats

df4e4cf77f-+-contint: include mediawiki::packages::php5

7decb5c3e8-+-jsbench: Prep osmium for decom and remove 've' and 'jsbench' roles

d893b1d062-+-webperf: Decom webperf::ve service

e564fe1c9d-+-Enable topic deletion for kafka-jumbo

800b20d705-+-openstack: pass in network_public_ip for nova network

ad54c2ea45-+-Allow new kafka-jumbo hosts to talk to zookeeper on conf*

2963d5822a-+-/etc/kafka/mirror should require confluent-kafka package

9acca73efb-+-Use fq +profile::kafka::broker::kafka_cluster_name when configuring a broker

2f4ce767ab-+-Debugging

9c3202c107-+-Add debug notifies to figure out error message in prod

a7a484749b-+-Don't use ganglia on new kafka-jumbo hosts

20c7f893d6-+-Revert "Revert "Revert "Un-apply kafka role -- these should be stretch, not jessie! :/"""

3334ed6888-+-Revert "Revert "Un-apply kafka role -- these should be stretch, not jessie! :/""

be09a629da-+-Revert "Un-apply kafka role -- these should be stretch, not jessie! :/"

9e4fe494c1-+-Un-apply kafka role -- these should be stretch, not jessie! :/

8b8c9e4902-+-Apply kafka::jumbo::broker on new kafka-jumbo100* hosts

6434c7ffb2-+-openstack: clean up common and nova common packages

fe2c5aa8ba-+-openstack: @resolve for saltcleaningcert rule

36920960c8-+-openstack: cease managing nova files via openstack/common.pp

ce14f15509-+-VCL: fixed keep values: 7d def, 1d for text

e0d200f223-+-openstack: set spice_hostname

872e81df03-+-openstack: rabbit_user keypath nova specific

893f2c789f-+-openstack: refactor corrections for labtestcontrol

63ade1eb9d-+-openstack: nova components for module/profile/role

1c09834df1-+-Cluster management: add some roles from neodymium

bcf19c4224-+-openstack: allow primary glance server to rsync to secondary

c85c28b6a9-+-kubernetes: Allow switching storage backend versions

ad2f02ed63-+-varnish::logging::statsd: instance_name future parser check

32454aba16-+-cassandra: enable jmx_exporter for cassandra 3 cluster

2208191ae8-+-site: use cassandra 3 for restbase1008 / restbase1010

4c12ff70c2-+-Remove stat1003 traces for decom

49e037c343-+-varnish: use varnish::wikimedia_vcl for all files

34f7c1a8a1-+-wdqs - activate wdqs100[45] as wdqs nodes

332b91a142-+-cassandra: reprovision restbase1008 with cassandra 3

a06b69a7dc-+-profile::mediawiki::jobrunner_tls: add monitoring

9d52f582af-+-cassandra: reprovision restbase1010 with cassandra 3

935349a56c-+-profile::mediawiki::jobrunner_tls: relay requests to the local-only port

29648996cb-+-jobrunner: add missing newline in template

7cf7baafe7-+-profile::mediawiki::jobrunner: Add local-only port

058acf0cf7-+-role::mariadb::analytics::custom_repl_slave: raise el_sync batch to 10k

8108d31764-+-mariadb: Do not try to resolve IP addresses for ferm

f8301bfc7f-+-mariadb: Do not try to resolve IP addresses for ferm

b0893f9291-+-profile::mediawiki::jobrunner: refactor things to the profile

a14c465a5d-+-mariadb: Add cluster manager hosts to allowed admin port users

fdd3ea03cc-+-cassandra: reprovision restbase1009 with cassandra 3

0d02fc7e06-+-mariadb: Add db1100 to s5

7f859f5b47-+-setting logstash100[7-9].eqiad.wmnet install params

244f8ab49a-+-webperf: Convert ve.py from ZMQ to KafkaConsumer

d35b2a0572-+-stat1003: remove puppet configuration as part of decom

1c3a9c8670-+-Generate FancyCaptchas in 4 threads

44104807bd-+-varnish: stringify instance ports

a6115b9fb8-+-varnish::common::vcl: fix template scoping

5c779c1085-+-cassandra: reprovision restbase2005 with cassandra 3

8f23f506f8-+-Fix broken regexp in site.pp

1ebb73f9df-+-Bump calico debian revision

b199c5d902-+-mediawiki: make the wikidata wb_terms rebuild a little bit faster

8ea6ec9676-+-Add Croatian language assets

169ef389d1-+-Send Thumbor error log to logstash

84d89e2469-+-Add STL support to Thumbor, behind flag

8f72d855d1-+-Install debdeploy-client

1cd589933e-+-role::analytics_cluster::hadoop::master: raise HDFS alarms thresholds

f27b275f37-+-wdqs - logging pattern to conform to the logback MDCInsertingServletFilter

2fdcf93055-+-prometheus: fix extra restbase/cassandra metrics rule

698060ce98-+-profile::mediawiki::jobrunner_tls: add ferm rule

6fd5705873-+-jobrunner: add LVS service configuration

7f155677a2-+-Cassandra: Do not include the main DNS in the list of seeds

faab5ff32d-+-cassandra: reprovision restbase2003 with cassandra 3

04f33d3ae8-+-Extend Ganglia Apache config for LDAP authentication

6b1ad4bfca-+-jobrunner: add nginx service

38cffc22b8-+-logstash - stop deploying custom elasticsearch plugins

aef0d51967-+-Include ::passwords::ldap::production

792db9d2e1-+-Put ganglia behind LDAP authentication

6af76e5b5c-+-cassandra: add execute permission to jbod mountpoint

906bbb447f-+-mariadb: Remove db1037 for decomm

443e685a9b-+-Add RDF dumps for categories

0425f9369e-+-move dumps other than the xml/sql dumps to new path on dumpsdata hosts

ec9630531d-+-Allow more per-instance overrides

785b7c3e96-+-mariadb: Remove db1045 - will be decommissioned

c0c3b66319-+-scap: upgrade to 3.7.0-1

f63b17cfd4-+-Pin current Cassandra build (3.11.0-wmf3)

ecb39a9bcf-+-role: drop restbase table/cf 'meta' metrics in Prometheus

c462462773-+-mariadb: Decommission db1026

f0d50cd90f-+-prometheus: fix jmx_exporter_config query

b9c3bc05da-+-varnish: remove varnishtest-runner

a65cbe591c-+-Instance-configurable `heapdump_directory`

0aafd8ce4f-+-Use absolute paths for `data_file_directories`

b694f67528-+-cassandra: fix jbod_device invocation

ffb4fe9cd0-+-profile::docker::storage: fix guard around vg_to_remove

a1be03cf42-+-labstore100[67] install params

4807adb401-+-Add comment about reportupdater's usage of a my.cnf file

5a3228c200-+-role::common::configcluster: allow zookeeper daemons to communicate

5e9afe879e-+-cassandra: jbod devices configuration

4a83d790e2-+-[WIP] Add reportupdater job to trigger page-creation metrics

b1e8843bfd-+-openstack: refine firewall rules for controller

fa119e9c81-+-kubernetes: Refactor/add admission controllers

2d77f07a0f-+-mediawiki: Another attempt to fix cronspam

9f28a57b12-+-zuul: rspec tests

03ee07552a-+-prometheus: avoid validate_re for an integer

e0b15db0f5-+-sysfs::conffile: use validate_numeric for number validation

14f04fa554-+-service::node: use validate_numeric for validating parameters

bc21083f4c-+-Give ores-admin users lsof, rather than the deployment user

a8b08224ec-+-mediawiki: Fix cronspam

bf8557d445-+-nfsmount: Add temporary exception to the block-for-export check

90f8b214c7-+-mask file should be in /etc directory

a4da74b6b5-+-Mask jobchron and jobrunner in non-active DC

02590d9d42-+-Let scoring platform team run "lsof" for diagnostics

6fdba09f6f-+-wdqs - tuning of logback configuration to send logs to logstash

7c6ef9e2c0-+-logging: Remove exceptionmonitor

4775e86ee3-+-kubelet: Remove configure-cbr0 parameter

c75bf93b91-+-apertium - switch to logrotate::rule

b61e613956-+-labspuppetmaster: fix array interpolation in strings

621b131c3e-+-Revert "openstack: remove legacy firewall rules for controller"

e8b54067df-+-Icinga: Add basic monitoring for routers' active RE

d7fa5dae07-+-openstack: remove redis replication rule

91cc4d5ef8-+-openstack: remove legacy firewall rules for controller

3a9c4e938f-+-Set fetch.message.max.bytes for mirror maker consumers

4abb5ee680-+-Synchronize message.max.bytes between all kafka clusters and producers

615fa03875-+-Varnish: reload VCL on error page changes

30a24a05b4-+-elasticsearch - switch to using logrotate::rule

bcc84d1739-+-zuul: remove configfile define

06e9b65a7c-+-webperf: Convert navtiming.py to use KafkaConsumer

a19323104e-+-role::analytics::hadoop::master: fix descriptions of HDFS alarms

4ad98306d3-+-mariadb: Decommission db1033 and db1028

f67e2b78d7-+-manually create wikidatawiki dumps dir on dumpsdata hosts

e5289340fb-+-add user and directory setup to dumpsdata hosts

cafbb3992f-+-role::graphite::production: lower down eventstreams rdkafka retention

42eea2ac41-+-git::clone: enhance compatibility with the future parser

37fb0956a1-+-Add electcomwiki to private_wikis

b70fb8eb07-+-Increase max kafka message size for changeprop and kafka main

8db4289030-+-wmcs: generate /etc/dbusers.yaml with ordered_yaml()

133b440a64-+-wdqs - fix broken dependency

a0b0f48ca0-+-wdqs - send logs to logstash

b09e90c64e-+-mediawiki: fix logrotating in wikidata cronjob (2)

468d8b352e-+-Add SPF and DKIM perl package requires to spamassassin class

8907591892-+-mediawiki: fix logrotating in wikidata cronjob

da26ef63d2-+-profile::base: stringify hiera defaults

acb2741053-+-wdqs - remove upstart configuration files

ef752d479d-+-base::service_unit: remove unused parameter

bfa18d1ad9-+-wdqs - moving to role / profiles

0c55f1da94-+-start of setup of dumpsdata hosts

5ae6f3d0db-+-minimal manifest for dumpsdata hosts

666ae88ff2-+-mariadb: Add db1099 to s5

4809761403-+-releases: load Apache mod_proxy/mod_proxy_http

bf6685163a-+-icinga/base: add sudo privileges for screen process check

cd695c17bc-+-icinga/base: add screen-monitoring, whitelist hosts

46478364ff-+-discovery analytics - disable report updater cronjob

2ad1b48627-+-Cumin: update configuration file for v1.0.0

af3f1dd8fd-+-wikidata-maintenance: Emergency stop of rebuildTermSqlIndex

11816fd1b2-+-openstack: fix labtest wmflabsorg-domainadminenv.sh.erb

b948454c3b-+-openstack: misc components to module/role/profile

844a174521-+-Set discovery-stats user primary group to analytics-privatedata-users

957bf28777-+-openstack: openstack2/keystone/monitor move to profile base

99fc10614e-+-mariadb: reimage db1069 as a core host, remove sanitarium old role

c15ade53fd-+-openstack: remove inactive uwsgi cruft for keystone

8b5e5f8192-+-add interface::add_ip6_mapped to californium

b2cbd3eaf1-+-Revert "swift: don't track connections to swift backend services on frontend machines"

5014bc5520-+-swift: don't track connections to swift backend services on frontend machines

39ea70069d-+-openstack: for glance use ipaddress fact

bf81b0b0a1-+-Add -f to rm flag when deleting old druid request logs

73c9c1a284-+-mariadb: Add db1096 as s5 slave

b26e961e53-+-mail::mx: Ship bounce/warn message files

91afb49e79-+-mediawiki: Add puppetized cronjob for rebuildTermSqlIndex

5d20d9e698-+-statsite: don't track statsd client traffic

f6af9910d4-+-labs puppetmasters: allow horizon access via ipv6

c9c6103507-+-labs puppetmaster: add auth.conf rule allowing horizon access to API

7c1491e903-+-puppetmaster: support extra_auth_rules to frontend and backend profiles

da2407bda4-+-kafka-jumbo100[1-6].eqiad install params

b428b49265-+-openstack: phase out deployment-stream

e3cf1685e5-+-Fix firstboot salt minion id on labs

319c83cf73-+-logrotate - use the new logrotate::rule

898393455d-+-logrotate - use the new logrotate::rule

0d955db34c-+-mariadb: Remove db1041

f823fa18df-+-role: fix prometheus global collection regexp

3922d4f4d0-+-role: collect blackbox_exporter metrics in Prometheus global

cb2e9c47c1-+-role: use port 22 for ssh probing

13f9ab7fcb-+-role: add ssh blackbox probes for bastions

04e617e992-+-ferm: introduce ferm::client

0801fd2a81-+-prometheus: add blackbox configuration for prometheus::ops

9d7493d0c9-+-role: collect jmx_exporter metrics from restbase test_cluster

d8fb9034f9-+-openstack: glance set db params as variables

7e3eb4860d-+-openstack: glance as module/profile/role for deployments

4b24dcd393-+-setting labmon1002 to role spare

5c24996ec6-+-remove role::labs::puppetmaster

c31fcffdbc-+-eventlogging - use the new logrotate::rule

ec1c62b09d-+-logrotate - introduce a generic logrotate template

c9389f1ba8-+-Varnish: move errorpage/browsersec to common code

7774135c58-+-openstack: remove old keystone from nova::controller role

73964dd352-+-openstack: keystone as module/profile/role for deployments

a360997172-+-apertium: Added apertium bel-rus packages and sorted list

b5fbbf1da7-+-central auth global blocks tabke dump fixes

a481923d83-+-statsite: don't track statsd udp traffic

f1d4e8f358-+-ores: More configs for stress testing

fc6f130444-+-mariadb: Remove custom salt grains due to salt deprecation

5630b0bc25-+-nova fullstack: increase timeouts yet again

eb3a551ffd-+-Make cdh::hadoop class depend on apt-get update

7402e5919a-+-Check for druid-hdfs-storage-cdh dir existance before looking for jar link

d16e80978c-+-Move use_cdh setting into  profile hiera param

063f99f630-+-Make sure profile::cdh::apt happens before apt-get update

910fe23248-+-Set up druid on druid100[456]

6cb6abb962-+-Conditionally include zookeeper server in druid worker role

ce68c301e2-+-Apply base::firewall and standard to druid100[456]

fa83d124f7-+-prometheus: new instance 'services'

24ca5e06fc-+-mariadb: Remove db1015

e0bd61817b-+-role: explicit cluster label for thumbor

910ded4968-+-prometheus: poll nginx metrics from thumbor hosts

e35d065a4c-+-ores: Add hieradata for number of celery workers

a7cd2afdb6-+-sanitarium3: Prepare db1102 to run s4 instance

1c485a6a30-+-dump global block table from central auth

799efa192b-+-Revert "Gerrit: Also set minimum heap size"

baab9058ac-+-Gerrit: Also set minimum heap size

826ec419b7-+-Configure cp4021-28 into upload+text clusters

a72ba729dc-+-numa: bugfix frontend isolation prefix

e16303ee9e-+-NUMA binding for cache frontends under 'isolate'

beb5293848-+-numa_networking: new mode "isolate"

9a1bc09768-+-statistics::rsync::mediawiki: rsync wmde specific logs

de16febc73-+-Define management networks and allow them to send syslog to logstash

a504c49d27-+-base::service_unit: move template rendering to the caller

5e22f7f9d1-+-udev: fix dependency cycle

e32cbc1e07-+-udev: new module

c388e59120-+-mariadb: Remove package hacks for MariaDB 10.1 on jessie

da05acca25-+-prometheus: use blackbox-exporter package from Debian

3a12ba1ac5-+-mariadb: Disable semisync slave replication on masters

c90436991c-+-phabricator: Only send logmail on prod not labs, pt.2

5b7fdb16d0-+-Phabricator: Only send logmail on prod not labs

ef4b50606a-+-openstack: clean up openstack::repo

185db053b0-+-librenms: no https/cert monitoring on inactive server

dbc35ec3b8-+-dbstore_multiinstance: reduce key_buffer, set read only

8e066b42fb-+-phabricator: silence stdout of public_task_dump cron

675f0022c2-+-mariadb: Allow individual instances to configure its innodb BPS

2700cbb350-+-Reshape RESTBase Cassandra production cluster; Provision new 3.x cluster

12a32b6bdc-+-Run Lilypond from Firejail

80e69b260a-+-role::cache::kafka::webrequest: fix alert varnishkafka metrics

3564387169-+-Allow mwdeploy user to restart jobchron

807fe8294f-+-Add wrapper for firejailed lilypond

56a648ee71-+-role::cache::kafka:webrequest: fix graphite metric to alarm on

c044eb7815-+-role::cache::kafka::webrequest: tune graphite alarms

f65cec868f-+-geowiki::job::monitoring: point cron output to analytics

a4a5949819-+-PDF Render: Lower the concurrency to 4

3a5d7e7eef-+-graphite: cleanup carbon-cache log files

e6cb250801-+-role::analytics_cluster::monitoring::disk: remove unused role

b04cbbda6c-+-mediawiki: fix ttf-ubuntu-font-family handling

107cf6cbf2-+-profile::druid::common: fix merge druid::properties

bb16e48dd0-+-thumbor: do not hardcode jessie-backports

9c89ca6aa6-+-mediawiki: clean up deprecated fonts packages

1b97feb40d-+-role::analytics_cluster::hadoop::client: move to profiles (p2)

a8de20575a-+-mariadb: Add db2077 as s7 slave

36fbdb6c3e-+-Revert "Switch elastic1017-1031 to niofs"

1ca2c7f565-+-role::pmacct: explicitly set librkafka version

c922087a37-+-pmacct: add the possibility to configure librdkafka

4f37765fd5-+-r_lang : fix path to update-library.R

dcd4a09e4e-+-rename "r" module to "r_lang"

b4b6af3b5d-+-eventlogging: further fix

681b32d417-+-eventlogging::service: fix dependency

85f362b95e-+-base::service_unit: convert services to systemd::service

7ffb33f07b-+-thumbor: fix dependency

8f578d347d-+-geowiki: delay cronjobs to reduce cronspam

885f75e4c1-+-thumbor,swift: convert to systemd::service and systemd::unit

1957466e9b-+-mariadb: Install mydumper on dbstore_multiinstance hosts, drop tls

2fa000e5c0-+-varnish: convert to systemd::service

41884fda1d-+-prometheus::varnish_exporter: fix typo

fead214cb3-+-prometheus: convert to systemd::service where needed

382ffd1911-+-systemd::service: convert a bunch of modules to it

1c6b6d77a5-+-tools: remote logcleanup active cron for now

a79e4094f9-+-tools: job to copytruncate logs in place

665852fbfc-+-confluent: fixup for I161e43a2

b7304317b8-+-confluent: convert to systemd::service

0935c59df8-+-Remove stat1002 from puppet as part of decom process

1b95ae2582-+-celery: convert to systemd::service

4ee939e3fd-+-statistics: re-add working_path variable

ac2dbbace9-+-cassandra: convert to systemd::service

84159138cf-+-Remove stat1002 configuration as part of decom

05eb147a0e-+-calico: convert calico-node to systemd::service

c8a8215119-+-role:eventbus: add conftool pool/depool cred to scap

a570ab44c9-+-role:eventubus: set deploy-service as scap deploy_user

c5f7e7d84c-+-dbstore_multiinstance: All hosts other than dbstore2002 will have 8 instances

718c8e4795-+-Cassandra metrics: Allow Scap3 to restart the service

4381c46198-+-Cassandra: Switch metrics-collector to use Scap3

5f25c39573-+-Cassandra: Switch logback-encoder to Scap3

ccc2a481b1-+-CI/integration: Create role for docker CI agent

773587d9ab-+-openstack: add wikitech-grep as utility for adminscripts

81cf89f524-+-package_builder: add hooks for stretch

2ab3be7df4-+-Add hiwikiversity to labsrecursor

288336361d-+-Switch elastic1017-1031 to niofs

e470ec0087-+-puppet-compiler: bump version, run puppetdb-populate

224c8850ed-+-statistics::package: add missing package depencency

755036a946-+-mariadb: Add db2076 as s6 slave

d721681fb5-+-Define network infra ranges and allow them to send syslog to logstash

9f9d7d5fbe-+-discovery-stats user should be a member of wikidev group

de3b508578-+-labservices: remove ferm rule that opens mysql to all internal hosts

b1dd52735c-+-role::an_cluster::hadoop::client: moving to profiles (first part)

6d88d2a232-+-dbstore: Migrate dbstore2001 to dbstore_multiinstance role

a8a0f1916e-+-Remove pfw-codfw from Smokeping, Rancid, Torrus, Icinga

c149be542b-+-nova-fullstack: adjust timeouts

45b3789381-+-role::cache::kafka::webrequest: force Kafka protocol to 0.9.0.1

bfe6595d0e-+-mediawiki: Another increase of batch size in dispatchChanges cronjob

b4cb909bdd-+-role::cache::kafka::[el|statsv]: force kafka protocol to 0.9.0.1

3f946a9010-+-puppet-compiler: generate files in the vardir, not libdir

238a7d6661-+-puppet-compiler: fix the generates clause in the exec

1013540d89-+-puppet-compiler use the correct CA for puppetdb

bb770dde81-+-Phabricator: Install package heirloom-mailx for mail command

90221cc8f4-+-phabricator: ensure /srv/dumps exists

241ba980ff-+-phabricator: open firewall holes only on active_server

70632ef8d6-+-Bumping HP RAID Icinga check timeout from 60 to 90s

5bbc09a960-+-realm.pp: Add two oauth tables to the private list

f158291c53-+-increase retries for check_nova_compute_process

88953903e8-+-wikitech-static monitoring: check much less frequently

f7804fc114-+-puppet-compiler: add environment to exec

c617de21fa-+-puppet-compiler: further work for puppetdb support

38c193f7c9-+-mariadb: Pool db1098 as new s6 recentchanges/watchlist host

d84b9c58a3-+-puppet-compiler: fix typo

fb839300a0-+-role::puppet_compiler: bind ssl to 0.0.0.0

ae13ed0596-+-mariadb: dbstore2002 has now 5 shards replicating

a4dc1313e3-+-mariadb: Add s3 to dbstore2002

00ba8556fb-+-puppetmaster::puppetdb::client: fix dependencies.

d4d942ad79-+-toolforge: Add qstat-full to bastions

04a00d1444-+-phabricator: Auto rsync phab1001 to phab2001 (codfw)

752ceaaf4b-+-site/phabricator: remove phab role from iridium, make it a spare

a6eb2bfb7c-+-clean up a few more labs-puppetmaster-eqiad refs

c64f9eab05-+-icinga/certs: add monitoring for status.wm.org cert expiry

fbb81ddfd5-+-get $::labsproject from the certname

3710e9fbd0-+-puppet-compiler: add puppetdb installation

3e3681bc30-+-puppetdb: move more things to the module

91626adaad-+-puppetdb: spin off module, support hsqldb

fc2c78252a-+-modules::geowiki::private_data: fix rsync for data-private-bare

b56f04d361-+-mariadb: Add instance s4 to dbstore2002

5812d0bb1e-+-PHAB: move the ssh hook somewhere sshd won't complain about

53e91951c6-+-Revert "PHAB: hard-code IP address for smtp"

d7d4ce4bea-+-phabricator: remove iridium remnants, replace with phab1001

ce5267d82b-+-PHAB: hard-code IP address for smtp

282db7c711-+-phabricator: Turn rsync off for iridium -> phab1001

9f63e9409f-+-shinkengen: Update package declaration to require_package

7b17fea882-+-openstack: revert shenkengen to py2 libs

7fffda2411-+-wdqs100[45] install params

3b59f6588b-+-simplelamp/simplelap: add support for stretch

669e4668d9-+-openstack: toolschecker requires openstack clientlibs

0a23a7bc75-+-labs puppetmaster: add certmanager creds

a919a472d1-+-Revert "labs puppetmaster:  allow designate to ssh in on ipv6"

4aa68be773-+-labs puppetmaster:  allow designate to ssh in on ipv6

40eb0f1ea6-+-openstack: Jessie has cannot fulfill py3 clients without backports

8f2ab7bd87-+-openstack: Jessie has Liberty py3 client libraries

11e02aeff6-+-labs puppetmaster: allow ssh through firewall from designate

06725ed4bf-+-druid100[456] install params

b7e1d8bf3c-+-Keyholder: allow users to access files they can read

0d2b75739b-+-keyholder: public keys publicly readable

23d8884cf1-+-RESTBase: Add the Recommendation API URI

531517e9b4-+-labsdb/mariadb: Change package resource for require_package function

6c34099274-+-mariadb: Add new python3 script to check the health of a server

b50e35e6d2-+-statistics::wmde::graphite fix logrotate name

5fb749ae57-+-statistics::wmde move graphite files into own directory

009a778ef1-+-statistics::wmde cleanup directory usage

d9c388ee32-+-mariadb: Promote db2051 as the new s4 codfw master

e644229142-+-openstack: clientlib refactor

5aad37c1e6-+-statistics::wmde: refactoring and decoupling

39bae942f6-+-pybal::monitoring: check_pybal_ipvs_diff interval/timeouts

ef7b09925c-+-maps - tune postgresql for maps-test cluster

ddd2dbd881-+-mariadb: Add db2075 as a new slave in s5

b10535bf44-+-varnish: Switch browsersec to use errorpage template

f3a28935bb-+-Add scons to package list

ef40e5071c-+-webperf: Move statsv monitoring from 'webperf' to 'webperf::statsv'

4f50fb11fb-+-Revert "Icinga: add check_bfd check (part 1)"

39794dfe83-+-Circumvent kafkcat circular dependnecy on librdkafka1

728f43d9c4-+-Make sure librdkafka1 is installed before kafkacat

78a66ec1a5-+-Icinga: add check_bfd check (part 1)

fb25a5bda9-+-Specify librkafka version in Stretch (so kafkacat installs properly)

8f5594571c-+-Manage /srv/kafka to be nice in profile, don't render zk settings if undef

14128e3504-+-Update kafka server.properties to work with defaults

23a8340bcf-+-Use 0.11 version in kafka broker profile

f02441d6f5-+-Add (unused) ssl params in confluent::kafka::broker

49a9ffb439-+-Add kafka broker profiles for new jumbo and simple clusters

e2a161a0c3-+-Gerrit: Enable manage_home in scap

0a95129611-+-Modify confluent module to support listeners, ssl, and rack

9311616d66-+-Revert "Add syslog-udp for logstash testing on 11515"

99ea73efc5-+-Trigger a rerun of druid-hdfs-storage-cdh-link during a Druid upgrade

8eb60067eb-+-profile: fix swift udevadm reload name

cc8815af16-+-contint: upgrade tox to 2.5.0 using pip

e7e2be1a35-+-contint: revert tox installation from Debian package

0606708e01-+-cache: nginx-lua-prometheus testing on a text node

e7e8cf53bf-+-contint: Package[tox] -> Package[python-tox]

2da9db81d4-+-puppet-compiler: bump version, remove catalog diff module install

cd2056a0c5-+-contint: upgrade tox

ae76d2781f-+-Add syslog-udp for logstash testing on 11515

9b0d378494-+-Gerrit: Add support for scap

2db1017f74-+-Icinga: remove juniper alerts service check if set to false

a1b9a2cb32-+-statistics::discovery: Fix scheduled command

81903cd757-+-phabricator: make phab1001 use role::phabricator_server

05eacd7890-+-phabricator: Allow listen_address to be empty for migration from iridium

1705096a5d-+-Icinga: remove Juniper Alarms check as not exposed via SNMP

fa04deac0d-+-Change default druid extension load for 0.9.2 upgrade

850ba89f91-+-Add codfw frack to Smokeping, Icinga and Rancid

5d6fdaf962-+-mediawiki: increase the batch size of dispatchChanges cronjob

1bac8e2852-+-adding cp402[5-8] install params

dcf37477ad-+-contint: upgrade npm from 2.15.2 to 3.8.3 in CI

50204ff639-+-role::analytics_cluster::hive: add jvm monitoring

6f6b4a851b-+-OCSP: Warn less, retry more

028f759125-+-mariadb: Add db2074 as a new slave for s3

96ae56fa90-+-graphite: adjust max creates alert

dc2180d283-+-pybal: bind instrumentation TCP port to private addresses

e5bc42ea41-+-mariadb: db2073 is going to s4, not s1

522a40a1a8-+-mariadb: Add db2073 to s4

cfc6eb14e7-+-phabricator: Remove old rsync file

17a78e70d8-+-phab1001: add interface::add_ip6_mapped

456338158b-+-phabricator: rsync /srv/repos on iridium to phab1001

41b6076ace-+-openstack: move novaobserver to a profile

b01cfa7d52-+-Remove re-declaration of 'wikidev' group in discovery class

d75733da83-+-Include statistics::discovery just in private profile

1dcdeb505d-+-statistics::discovery: Reconfigure for Golden data retrieval

4e83604c20-+-openstack: pull rabbitmq monitoring from own module

1c81a5ce6a-+-Quarry: Add package 'python-xlsxwriter'

8df2d4bf4a-+-labs puppetmaster: validate cert name before autosigning

82db38b334-+-Decrease elasticsearch search thread pool to 32 for cirrus servers

d1d2848f95-+-Sync published datasets more often, allow users to rsync

32ab62dfa1-+-openstack: replace cloudrepo placeholders for rabbitmq

cc2e9b9493-+-openstack: move rabbitmq to module/profile/role

2e08f4d8e1-+-Install libcgi-pm-perl for wikistats 1.0 ezachte

82ebd50da6-+-puppet: make all priorities explicitly integers

2427e2dfa0-+-prometheus: enable vmstat node-exporter collector

16b62a2645-+-pybal::monitoring: bump check_pybal_ipvs_diff timeout

3ac04bbe14-+-role::mediawiki::canary_appserver: move to the future parser

8946aa1f87-+-apache::conf: convert to use validate_numeric

0ef4a49fae-+-statistics::packages: package 'virtualenv' not available on trusty

7af92ebeed-+-releases: add a MOTD warning based on active/passive server

3abe7cee74-+-releases: rsync reprepro data, set active server in Hiera

0b0bf13709-+-releases: add releases2001 to site, change rsync direction

3e947d1734-+-openstack: move openstack::repo to new model

43f18caeb0-+-Install virtualenv bin on stat boxes

3ba8eb6308-+-sanitarium3: Convert db1102 into a proper multi-instance host

c4eb6e2206-+-install params for cp402[34].ulsfo.wmnet

4a53613dbf-+-Disable generation of root passwords for now

ba7c2d56b0-+-Only store instance root passwords on the frontend puppetmaster.

c0219482db-+-labs puppetmaster: allow access to the enc api via ipv6

2465926273-+-labs puppetmaster: allow all puppetmasters access to the enc api

784e0903ff-+-labsdb: Rename sanitarium2 to sanitarium multisource

2d549c5f85-+-labsdb-replicas: Update new labsdb hosts to stretch/systemd

2f75ef884a-+-pybal::monitoring: add check_pybal_ipvs_diff

02c7166711-+-do rsyncs of pageviews and other items from stat1005 now instead of stat1002

c1c8eb801d-+-profile: fix bogus show_diff for ssh::userkey

ec98a15f6a-+-Don't show diffs for files with secret content

5fded3c9cf-+-labs puppetmaster: simplify allow_from rules

2b2131e244-+-labs puppetmasters: Let the puppetmasters talk to each other on 8141

6062dca82e-+-labs puppetmaster backend: open firewall on 8141

921fafa927-+-puppetmaster profiles: add prevent_cherrypicks param

231e69ac58-+-labs puppetmaster: rebase from gerrit once per minute

dbe0c3fc93-+-Revert "openstack: move openstack::repo to new model"

9411cf80dc-+-openstack: move openstack::repo to new model

9e75ce81ca-+-wmcs: remove toollabs::admin_web_updater

71d948560a-+-labs puppetmaster: allow new puppetmasters to talk to the enc

4f4742ccdd-+-releases: delete old microsites::releases class

2346aa47eb-+-labs puppetmasters: Add firewall and allow_from rules

9d6ddd1d8a-+-puppetmaster profiles: make allow_from configurable

c60f261426-+-r: Remove libicu dependency

b8e8d8322d-+-r: Fix libxml2 dependency

38d825c361-+-r & shiny_server: Fix duplicate xml2 declaration

e86633d567-+-diamond: ship systemd override file

76db3caae4-+-recdns: do not use self in local resolv.conf

cf725e7268-+-puppetdb: Bump Java Heap max size to 6GB

7dfe90c0d4-+-Move R-related code from shiny_server to separate module

28804b2160-+-Promote db2048 as the new codfw s1 master, replacing db2016

0031074934-+-scap: upgrade to 3.6.0-2

36ad8f7aa5-+-role::statistics::web: fix geowiki rsync

c534e45e09-+-Scap: bump version to 3.6.0-1

f5782d5996-+-lists/icinga: remove I/O monitoring on lists server

6013da8f6e-+-icinga/role:mail::mx: add monitoring of exim queue size

6a65976322-+-add puppetmaster roles to labpuppetmaster1001 and 2

aa524b2a3d-+-diamond: set diskspace filesystems explicitly

6db243e11f-+-visualdiff: Remove manually built `uprightdiff`

16e76e76ba-+-contint: webperformance Jenkins slave

2f8b9de3e5-+-Revert "Kill module puppet_statsd"

995500b495-+-Kill module puppet_statsd

2063891a5d-+-librenms: explicit graphite port

5590ea9edf-+-librenms: enable graphite extension

93006ab7da-+-varnish: Avoid std.fileread() and use new errorpage template

e2e61b9312-+-Clean up stray binary packages after Debian updates

120ec7ba22-+-prometheus::node_exporter: fix compatibility with the future parser

d09cc5c4af-+-puppetmaster frontend profile:  Allow hiera to configure the hostname

c0f3a3ecc2-+-mariadb: Add grants for rddmarc to m1

780f7a2a18-+-Remove specific version annotation for nginx

9d74dd1806-+-nova-compute:  try to fix an incorrect check_procs alert

58438b44b5-+-apt::repository: fix for future parser

2eeb9c6173-+-Add script.max_compilations_per_minute to elasticsearch

aba320ecc0-+-parserCachePurge: Run it every day, not only on Sunday

306b2af4f1-+-Parsercache: Purge rows every day, and reduce TTL to 22 days

23ac091ade-+-systemd::syslog: depend on the service, not base::service_unit

e9c373dd43-+-etcdmirror: convert to using systemd::service

f44794cae3-+-role::prometheus::memcached_exporter: move to profile

7dfe6611c6-+-etcd: convert to using systemd::service

b4bd6d9c0a-+-sysctl::conffile: validate priority as numeric

46369ea4a8-+-rsyslog::conf: validate priority with validate_numeric

d976c0ae51-+-puppetmaster profiles:  Fix some really extreme typos

29c829d306-+-Remove rsyncd frag from stat1002 for analytics cluster hdfs rsync

63ac1bae7f-+-Remove statistics::private role from stat1002

6e2b0bff1e-+-prometheus-mysqld-exporter: Fix parameter problems

d6a979ef33-+-Revert "PDF Render: Check hourly if the service is running via cron"

9fbaf1cdf3-+-prometheus-mysqld-exporter: Fix dependencies and not auto-start

997c4cd612-+-PDF Render: Check hourly if the service is running via cron

a8b120c892-+-profile: check and alert on free filesystem inodes

981d36d489-+-prometheus: Convert mysqld-exporter into multi-instance

6934bd86d1-+-Use different consumer group for the mysql eventbus eventlogging consumer

9a809a2aa4-+-statistics::packages: Add libssl-dev and comments

2f611aafa0-+-base: check and alert on free filesystem inodes

0c45ca3eb2-+-role::prometheus::hhmv_exporter: move to profile

d5d76155f6-+-role::prometheus::apache_exporter: move to profiles

64e3ad2c85-+-mariadb-multiinstance: Fix missing header on override

c175e088e0-+-mariadb: Disable mariadb main instance starting for multisource

8c8c2e01ef-+-labstore backups: Switch secondary cluster backup source

b0139d585b-+-mariadb: Deprecate multi-source instance on dbstore2002

2838705341-+-gerrit: make name of config template flexible

42e27ad6f4-+-Temporarily disable webrequest deletion while lawyers do some research

fe59400c11-+-Add s1 instance to dbstore2002 (imported from db2072)

bce0e0ccec-+-phabricator: make phab1001 use role::spare for now

d14e157bb9-+-decom netmon1001

ccd2daa956-+-librenms: rsync direction netmon1002->netmon2001

389387e35c-+-base::kernel: blacklist intel_cstate and intel_rapl_perf

0a055a2c93-+-Add cache::misc hosts to network constants

f482a6b2f4-+-Invert upstart conditional check in eventlogging consumer

79edfdab63-+-Reload eventlogging-consumer mysql-eventbus if event-schemas change

756b5f9df0-+-Revert "netmon1001: temp put librenms role back on it"

b04cd4114f-+-Configure Cassandra for restbase-dev[4-6]

2fee215ad0-+-puppetmaster: Don't use storeconfig_thin

d7183f0173-+-setting restbase-dev to role:spare

a5d962059f-+-restbase-dev100[456] replacing restbase-dev100[123]

811fbec79c-+-releases: switch to using secret()

2c5347cb7d-+-base: cleanup absented CAs

b65bc09957-+-motd::script: use validate_numeric for priority

5b254b218f-+-systemd: add defines to manage systemd units

75f65c18cd-+-base: remove WMF CA 2014-2017

f9ae7cf641-+-nova libvirtd:  use the new ca, wmf_ca_2017_2020

3611cd47e9-+-netmon1001: temp put librenms role back on it

f72d1f2dd7-+-librenms: rsync rrd data from netmon1001 to netmon1002

f3df8492a7-+-base: add new WMF 2017-2020 Certificate Authority

f22050df5f-+-librenms: active_server param, don't pull data from multi servers

70daf9ecd4-+-Revert "kafkatee: send 4xx to logstash as well"

7c10680b60-+-kafkatee: send 4xx to logstash as well

f80dc600e6-+-prometheus: check for vhtcp.stats file

b533798da1-+-prometheus: add job definition for nginx_exporter

c4254bc142-+-nodepool: pin python-jenkins to 0.4.12+

69dea67188-+-[2/2] use kmod puppet module instead of File resources

883efd9ca8-+-Add profile::zookeeper::firewall

1aa917316b-+-Deploy statsv with scap3

6483ba006d-+-[1/2] use kmod puppet module instead of File resources

3b49e6a0a5-+-rancid: change the rsync direction

38833650c9-+-prometheus: netmon1001 -> netmon1002 for snmp exporter

27d9a25e55-+-netmon1001/site: fix name of 'spare' role class

2c0fa84bf9-+-netmon: remove librenms from netmon1001

5f92fd4e86-+-decom rcs100[12]

97deadd66b-+-labtest: rabbitmq for openstack control node

da14d95767-+-icinga/ores: Change scoring team's name for alerts; point to group member

170c925258-+-decom of cp400[1-4]

61dd1d6654-+-Remove ensure param from base::firewall

eafe8df07d-+-Deploy mjolnir kafka daemon to relforge

359f165fc1-+-prometheus: move external_url to class parameter

5feca70657-+-Diffscan: Don't send emails if no new open/closed ports are found

2fc649dc8c-+-puppet_compiler: install ruby-rgen

0f33d9daee-+-Linux kernel module handling

8f958d09dd-+-rsync::quickdatacopy: avoid duplicate declaration errors

6144b00dfc-+-smokeping: sync data to netmon2001, use quickdatacopy, in role

ee221e5db3-+-puppetdb: remove postgres::ganglia from puppetdb role

dc66966358-+-labtestservices2002/2003: add mapped IPv6 address

8f722156df-+-Move reportupdater jobs from stat1003 -> stat1006

851f87344d-+-Remove dependency on geowiki public data job

7d58c4a965-+-Remove public data geowiki push

3f3f32e5c3-+-Set up rsync module for /home on stat boxes

6965c806c0-+-Use https gerrit url to clone geowiki data-public on stat1006

289e0a1dac-+-Revert "Remove time command from statistics::wmde crons"

3dda154041-+-Move geowiki from stat1003 to stat1006

824f606b82-+-aptrepo: drop files/log, use templates/log.erb

d9ffad4a9f-+-logrotate reportupdater logs as proper user/group

f83cf7e65e-+-profile::piwik::database: puppetize Piwik's database config

78df59e743-+-add mapped IPv6 address for labtestervices200x

86ec4e56dd-+-Decom RCStream

e475d38c1a-+-statistics: fix indentation (and a lint failure)

bf6a273791-+-Install /usr/bin/time on stat boxes

c8b8927da0-+-profile::piwik::backup: remove duplicate old backup clean cron

4c469a06b4-+-profile::piwik::backup: use quotes for the backup's password field

d659231826-+-Adds aspell-el to ORES base.pp

6ddd83abf7-+-Puppetmaster profile:  Support switching off active records

d6f569424c-+-Restrict ores::web to domain networks

389f6a926d-+-smokeping: restrict http access to prod networks

124e1b5f45-+-servermon: restrict http access to prod networks

465241ac9c-+-servermon: remove role from netmon1001

2513287df7-+-site: add netmon1003 with servermon role

274235339b-+-setting labnet100[34] install params

9aa81c9ab4-+-Remove time command from statistics::wmde crons

d737c17908-+-Include labsrootpass on labs puppetmasters

bf15f71116-+-Add labpuppetmaster* to site.pp to enable base::firewall

262cc3a60b-+-Add labweb* to site.pp to enable base::firewall

35280a021a-+-labspuppetbackend:  Include some more python dependencies for jessie.

4d14aef89c-+-ensure => absent for base::firewall in statistics::private profile

d3deaf91bf-+-Remove base::firewall from stat private boxes

423c9e127b-+-Labtest:  Allow the new labtestpuppetmaster to reach mysql on labtestcontrol

d57ea83ffe-+-puppetmaster: profilize puppetdb hiera lookups

e569f01dc5-+-statistics::sites::stat: fix the symlink for v2

fec9074297-+-role::mariadb::misc::eventlogging: remove the readonly constraint for slaves

b904cfe904-+-Clone wikistats v2 repository and link it to v2

cdd12bcd53-+-cache::misc: enable nginx-lua-prometheus

77abced40c-+-icinga: Bump icinga-tmpfs size to 1024m

1d796c63b1-+-puppet-compiler: allow more than one runner

6b58ae3d10-+-Use proper topics variable for new eventlogging mysql eventbus consumer

72d458ca5b-+-Set up separate EventLogging Analytics MySQL Consumer process for eventbus events

f7e7eab01c-+-Move statistics::wmde jobs to stat1005 from stat1002

3c1c51012b-+-Rsync MW API logs to stat1005

918aa1e055-+-Move refinery::job::data_check to stat1005 from stat1002

49985bbcbc-+-Run reportupdater::jobs::hadoop from stat1005 instead of stat1002

6f0f969c33-+-Use conditionals instead of new role files to deal with stat box migration

44215eb109-+-Apply role statistics::private_new to stat1005

d82de315d9-+-Move more stuff into profile::statistics::private

98e36dfffd-+-icinga: move RIPE Atlas measurements under netops

9bd14a74db-+-Own mediawiki/core checkout as stats

c00335ac42-+-icinga: move RIPE Atlas host monitoring under netops

d9b8767651-+-MySQL client for stastistics::packages in stretch, /srv/mediawiki dir

0cb7185203-+-Require libgdal-dev in stretch in statistics::packages

03c983a1f0-+-Invert os_version check conditional in statistics::packages

36e8e772e8-+-Fix typo in statistics::packages

22c64ab1d2-+-Package fixes for stat boxes to stretch

827fa0cea0-+-geowiki already uses /srv on stat1003, so we can change the backup director path now

b62d9f50ab-+-Remove references to geowiki::params

54d14c29c2-+-Apply cruncher_new role to stat1006

e5db7886ab-+-role::scb: add recommendation-api service

0baa9b5598-+-Add statistics private, cruncher and web profiles, with a little refactoring

ac5f7d5769-+-mariadb-multiinstance: Make the main multisource 3306 instance available

c1d998a874-+-icinga: merge routers/switches monitoring groups

918ad2ecff-+-Monitoring: Simplify BMC hostnames

301568981f-+-Add ipv6 to labtestpuppetmaster2001

299ffa17cd-+-recommendation api: refactor profile, remove module

f248f2f7f3-+-Refactor geowiki a bit and make a geowiki profile

1b3d0feab1-+-include 'standard' on labtestpuppetmaster2001

e430825291-+-Create reportupdater::jobs profiles for stat boxes

020e659f9c-+-monitoring: Simplify check_fqdn

2b6df9467b-+-Nova: Remove redundant logrotate script that's causing cronspam

f9f9793ea7-+-role::mariadb::analytics::custom_repl_slave: correct owner of el cleaner

0823ddf3a6-+-role::mariadb::analytics::custom_repl_slave: fix typo in whitelist path

7a6ac4b753-+-role::mariadb::analytics::custom_repl_slave: deploy the EL whitelist

c267a07819-+-role::mariadb::analytics::custom_repl_slave: add eventlogging_cleaner.py

a7c2f7e09d-+-mariadb: Transform dbstore2002 into multi-instance, drop db1096

5dc299642a-+-Monitoring: confine IPMI checks better to unbreak installs

9e17180cd4-+-role::mariadb::analytics::custom_repl_slave: add EventLogging cleaner user

7f39f1af9d-+-Revert "Temporarily remove achernar from lvs2* resolv.conf"

3ec4c1ec6d-+-Revert "Temporarily remove achernar from lvs4* resolv.conf"

5e83e1b7c2-+-mariadb: Delete override- changed default on package

4ad0398f47-+-Temporarily remove achernar from lvs4* resolv.conf

17a24eeb0f-+-Temporarily remove achernar from lvs2* resolv.conf

3a2557b2e9-+-rsync::quickdatacopy: add ferm rule also for IPv6

ae146453c6-+-rsync::quickdatacopy: add 'sync-' prefix to /usr/local/sbin/ file

f02290ed44-+-rancid/netmon: add active_server parameter to DC-switch

f454e0965c-+-rancid: use cron{} resource instead of file in /etc/cron.d/

397c3fe88e-+-rancid: disable fully automatic rsyncing of app data

460b9ae9e5-+-rsync::quickdatacopy: make auto-sync via cron optional

2d77335ee2-+-rancid: add rsync::quickdatacopy to sync /var/lib/rancid

d70f022017-+-add netmon2001 to site, equal to netmon1002

d65df724e3-+-Rough in new labs puppetmaster roles

de183ad5be-+-dbstore-multiinstance: Open firewall for multiple mysql services

303d23aa16-+-Install hunspell-en-us instead of myspell-en-us in Stretch

6596270a6f-+-Adding not about aspell-id

e361dfb673-+-Install jupyter-notebook for stretch

961dbf0eca-+-Use openjdk-8 for analytics and statistics servers if it is available

762cf61744-+-Don't try to set up rsync server for hdfs archive on stat1005 yet

c7ee623af5-+-Add stat1005 in site.pp

2e3cd22691-+-Prep for stat100[56]

068bd356e0-+-Use pulls rather than updates to pull cloudera jessie packages into stretch-wikimedia

a7602e3bde-+-dbstore_multiiinstance: Set default basedir depending on the os

2d94a154c0-+-mariadb: Fix default package installation for stretch

a5aab4ebec-+-package_builder: Conditionalize dh-php inclusion

e444dd1ea7-+-Remove filtertags from kubernetes roles

dd4dd0dac4-+-mariadb-multiinstance: avoid double declaration of monitoring class

0cbbb22e0d-+-mariadb: monitor automatically any multi-instance

b07af1d4ec-+-Revert "Install libav-tools to provide avconv compatibility wrapper"

748f68390f-+-monitoring: Check mgmt SSH availability as well

049b4684bc-+-Install libav-tools to provide avconv compatibility wrapper

917d34342b-+-Remove apt pinning for backports for ffmpeg

e77a5023e5-+-monitoring::host: Rename the mgmt hash key

523f8350df-+-monitoring::host: Monitor IPMI as well if applicable

ebdacad975-+-role::piwik::server: add regular bacula backups

cfb2faa4a5-+-Make the creation of an Icinga check for service::uwsgi configurable

74b6612b70-+-striker: Set utf-8 for python runtime

4afd4b8c11-+-striker: Override http-socket config

6334b2c53a-+-Remove ferm service for striker / 8081

5f32a6d734-+-icinga: remove monitoring of benefactorevents.wm.org

0e85a73f32-+-Move labs puppet enc into a profile

7a36e1658e-+-Stop writing mediawiki.revision-create events to EventLogging analytics MySQL

5fbd3131e7-+-Nova:  Add labvirt1014 and 1015 to the scheduling pool.

167561856d-+-redis::monitoring::nrpe_instance: set retry_interval to 2 mins

c659ccfd84-+-Node defs for new labvirts:  1015-1018

ed5e3169f4-+-Toolforge: Update motd banners for rebranding

687ac9fa9f-+-Refactor puppetmaster roles into role/profiles

fcfcf645b9-+-mariadb: Create /etc/mysql/mysqld.conf.d directory

0728f453d9-+-mariadb:Change instance template identifiers for them to be dynamic

035c8c431f-+-role::analytics_cluster::hadoop::master: add icinga check for HDFS topology

488f55cd0b-+-Use parallelism to sqoop large tables

ee557f9bff-+-mariadb: Test new multiinstance dbstore role on an empty host

401bbbd3b5-+-mariadb: Create sanitarium3 role

498ff646e1-+-Move ferm service out of service::uwsgi

dd399eda06-+-use 'require_package' for stats packages including python-yaml

c6fba78a03-+-backup: Remove the day from the hourly schedule

2103d99c7a-+-Adds ORES grafana alert to icinga config

81c4f5d27e-+-Diffscan tuning

024581df4b-+-icinga::monitor::certs: remove eventdonations

0a39771998-+-Add diffscan module.

e59f9e985e-+-toolforge: Remove SCAN redis command

507349ef70-+-mariadb: Define variables before they are used on service.pp

18845e8830-+-labtest: new public servers add base + firewall

1d49b2a9b5-+-mariadb: Fix service for hosts with a default package

908acb3c8e-+-mariadb: Support multiple instances directly on the module

f328d96e68-+-profile::base: allow setting a puppet environment

cb2bd34156-+-puppetmaster: add environment for the future parser

e90023c192-+-Add temporary role::ores::stresstest

0b25cec684-+-puppetmaster::gitclone: link environments to /etc/puppet

a45af277c8-+-role::puppetmaster::common: add environments support

e047e0601e-+-Labs: Update cdnjs clone commands

7a1b360414-+-decom of subra/suhail

d7264cec57-+-Remove exim4-heavy and exim4::ganglia from role requesttracker_server

48a40fc3aa-+-Move mwdeploy home to /var/lib where it belongs, it's a system user

2c4e27de5b-+-thumbor: parametrize poolcounter

5f333008fd-+-Conditionally switch ores::web config file user depending on context

b5254e7586-+-gerrit: Change the order profiles are applied

d0190b76b6-+-Add logrotate template to retain 60 days of exim mx logs

ef07106501-+-Use $real_jobdefaults instead of $jobdefaults #2

836bafb397-+-Use $real_jobdefaults instead of $jobdefaults

bb693c5296-+-mariadb: Correct systemd unit path

021bffc697-+-backup: Use profile instead of role

af4c6623d1-+-backup::set: Add a jobdefaults parameter

84b94d8b9e-+-otrs: Enable apache exporter

5886a33d1b-+-Create hourly backup schedule, modeled on weekly and use for Gerrit

6319bc17e1-+-Enable base::firewall for diadem/sysprosium

310d360c26-+-increase min_free_kbytes on dataset hosts permanently

b6bc42532b-+-mariadb: Retire db1096, db1099 and db1101 from the parsercache role

cb2f8a4978-+-get rid of mirrors user, run all dataset rsyncs as datasets user

19bbc6f8be-+-planet: Update css and templates to be modern look

c858c35660-+-decom subra and suhail

5d61f5fa2e-+-phabricator: add support for stretch and PHP7

a4bbad2bab-+-tendril: Make tendril active on a single datacenter for now

cff65beb87-+-request-tracker:Restrict http access to ununpentium

6771c8cae6-+-request-tracker: Remove smtp port from ferm config

04d64f6bc5-+-prometheus: add alertmanager_url to prometheus server

b3b3560728-+-role: set external url for prometheus beta/tools

9710af75ee-+-Block WP Zero users from accessing Phabricator uploads

7a1e95eec1-+-ores: Add twemproxy support

5458fabcfe-+-postgresql - reset user password also when NULL

d537148c75-+-base: export puppet agent stats to prometheus

048dde6abd-+-Introduce diadem, dysprosium

4cd2880dde-+-nutcracker: validate new config file

f30d52139a-+-Revert "base: cleanup unneeded ipmi packages/checks"

a5cf7945e4-+-salt: drop the saltversion fact, use os_version()

777845eddc-+-role::analytics_cluster::refinery::job::data_drop: drop old druid data

40684788dd-+-role::analytics_cluster::hadoop::master: add more monitors to HDFS metrics

48267cf479-+-Set up grafana dashboard monitoring for services

df758a4925-+-scap3 - deployment of package requires configuration to already exist

fc5e457014-+-Revert "scap3 - deployment of package requires configuration to already exist"

99d4fb9f6b-+-scap3 - deployment of package requires configuration to already exist

9df8bbc2c1-+-site.pp: Add db1102 sanitarium role

66b85a8a55-+-wikimania_scholarships: add support for stretch and PHP7

0b7eed7cff-+-rsync::quickdatacopy: fix commandline for cron, don't need file_path

142eae5fc9-+-rsync/releases: add dest_host parameter, only include what's needed

a41e8156b9-+-releases: use rsync::quickdatacopy in profile on bromine

b8c7ba6ea4-+-releases: Use rsync::quickdatacopy to copy data between servers

47b24e0f53-+-Create rsync::quickdatacopy

87bbe08057-+-openstack/diamond: remove the libvirtkvm collector

445fa22bb4-+-Revert "monitoring::host: Monitor IPMI as well if applicable"

322d8f24ae-+-labcontrol: add base::firewall to new servers

5857f6842d-+-Fix typo with forgotten $ in monitoring::host

6e1b459e33-+-monitoring::host: Monitor IPMI as well if applicable

79bb262418-+-Decom swift cluster in esams

b74a695d08-+-swift: delete swift-object-reconstructor unit

481955778f-+-profile::docker::builder: add dependency on virtualenv

9bdfaa33bb-+-swift: fix duplicate dispersion cron name

cb19c792a0-+-librenms: add php-net-ipv4 package also on stretch

5eaa1779fc-+-servermon: add missing package python-mysqldb

aeca95755b-+-netmon1002: add librenms role

46a6db555c-+-librenms: add missing Apache headers module

0f7483827a-+-librenms: ensure install_dir exists

7b596114c6-+-improve names of dump command lists

a11c8ee02f-+-remove some unused dump command lists

b3df59ede6-+-librenms: move php5-ldap package to others, fix for stretch

7734e5fdf6-+-treat wikidata just like enwiki for dumps

e7796b2cbe-+-librenms: use libapache2-mod-php7.0 if on stretch

c8cf9f905c-+-apache: add class for mod_php with PHP 7.0 for stretch

82fe99a24d-+-base: cleanup unneeded ipmi packages/checks

4586e12a4b-+-libvirt: turn off instance stats collection

989825c739-+-base: switch ipmi::monitor inclusion to has_ipmi

6c0baad0c9-+-Move IPMI monitoring check etc. to ipmi::monitor

b50e2a5169-+-Labsdb-replica: Fix bug on gerrit:362404

ac91fecc68-+-Fix configurable socket options for new labsdb hosts

ac5ed5fa99-+-profile::docker::storage::loopback: bind mount source dir

c1f007c404-+-Introduce alcyone, actinium

91c3495f49-+-Introduce poolcounter200{1,2}

0ccdb3bb9c-+-mariadb: Followup to Set default limits for systemd core databases

62aa19d7c4-+-mariadb: Set default limits for systemd core databases

22ff19958e-+-swift: introduce storage policies

7db0e5e22a-+-Add firewall rules for pinkunicorn

ac7c7fb04d-+-mariadb: handle service for systemd -autostart and overrides

e0b17c87a0-+-labstore: secondary cluster set 1004 as primary

0b1458cb27-+-netmon: use existing role::network::monitor, clean up site.pp

e12bb4a51d-+-mariadb: Change default socket location for analytics slave

6dfacc0111-+-xenon: Increase hourly retention from 1 to 14 days

1ddef7c300-+-librenms: add support for stretch, adjust (PHP) packages

95232730ab-+-icinga: final remove of check_ram.sh remnant

87512b4243-+-Nova fullstack:  Increase timeouts even more

a4231e9815-+-tlsproxy: restrict whole daemon to relevant NUMA node(s)

48a1974165-+-add numactl to base packages

c2543d7f80-+-role: cleanup CI data in graphite

0400f38af4-+-swift: ship udev rules for swift disks

2dbed41857-+-profile::docker::builder: check out production-images

58ded88485-+-Typo fix for LoadAverage diamond collector

c73e0faedf-+-diamond: Re-enable some collectors

f7dadbee3d-+-Include fonts role in Thumbor role

62a68428de-+-maps - align configuration for all maps clusters

8cb7d652b7-+-mariadb: patch mariadb.service to include the basedir

b1e6f23035-+-labsdb-replica: Change default basedir to the 10.1 package

bbbbb29b17-+-mariadb: Service followup to gerrit:361836

f2fe90e15b-+-mariadb: Change init.d template variable to avoid defaults changes

f02f31bb23-+-Add basedir option to all templates; restore option on init.d

9b714c8dd5-+-cassandra::instance: allow defining multiple data directories

daab929bce-+-mariadb: Followup to gerrit:361456

6ffdf4815c-+-mariadb: refactor option support and move it to hiera

0eb5fdaa7c-+-graphite: lower down eventstreams whisper files retention

327a3a1ba6-+-package_builder: Make init.pp compatible with stretch

7e47b5d8b2-+-Swap reprepro upload role to profile

eb6a72e62b-+-releases1001: Introduce reprepo profile based on microsite

972b922fc9-+-releases: Duplicate most of the microsite setup on new host releases1001

23de220d27-+-icinga: remove unused check_ram.sh

cfe1a1b17e-+-base::monitoring: raise crit threshold for salt-minions to 5

73c39b5874-+-cache_misc: remove ulsfo nodes and IPs

49d0785979-+-decom of cp4011, cp4012, cp4019, cp4020

618dfd7586-+-site: remove smokeping role from netmon1001

391b6e163d-+-Remove libtidy-dev from nodepool instances

502be979d3-+-varnish/bacula: remove torrus directors

7e9404db05-+-profile: fix labs swift storage

9dbc2e2426-+-contint: PHP ext build dependencies on Nodepool

7b19fa2cf3-+-Update WMF logo url

183e982446-+-Serve thumbnails for all public wikis with Thumbor

fbc1601fe7-+-site: update TODO roles for netmon1002, no more torrus

f184da3127-+-jenkins: lack of access_log produce invalid system unit

6804fa7e71-+-smokeping: allow rsync of data from netmon1001 to netmon1002

2bda07ba82-+-smokeping: ensure dnsutils is installed, use require_package

ab89e7260d-+-netmon1002: add smokeping role

3c9cb46096-+-decom mw117[0-9]

47897d8c34-+-Labtestpuppetmaster2001:  Initial node definition

0436cc294b-+-netmon: remove rancid role from netmon1001

93be0b58d1-+-Enable/deploy cassandra-metrics-collector 4.0.1

e0d9946805-+-git::clone - ensure => latest should also work with non default branch

95015741c0-+-swift: introduce container-reconciler

486fd8839a-+-varnish: limit varnishd transient storage size

ad34fdb523-+-planet: fix one more content/template syntax issue

fe2dfd10c2-+-planet: fix syntax error, source vs. content with templates

5a725d9fb7-+-planet: add HTML page/item/feed templates for rawdog

8e8e8b002f-+-base: add psmisc to standard_packages

b0ebca84dc-+-planet: give higher priority to English Apache site

b49e6e66b3-+-dbmonitor: Remove tendril role from einstenium and tegmen

b2faca6fd1-+-Insert the (new) page-create events into MySQL too

5e069c2b2d-+-Revert "MariaDB: temporarily increase limit for space alarm"

6f09055f2f-+-planet: add stylesheet for rawdog planets

d2a5bcb9df-+-planet: fix "splitstate" option, config file name, icon

f54ec3e079-+-planet: make config templates and crons for rawdog

03aca8e255-+-Remove datasets.wm.org class

7dddfefaa9-+-planet: Fix path to planet-wm2.png in puppet

f821bfac2e-+-statistics::packages: Add pandoc

b35469e9cd-+-Remove datasets.wikimedia.org site, redirect to analytics.wikimedia.org/datasets/archive

b438dcbf53-+-mariadb-core: Test systemd and stretch support

33c634b3c4-+-Scap3: deploy logstash/plugins with scap3

f30bdb9295-+-Graphite labs archiver:  Only save metrics for a year.

e55f156f4c-+-mariadb: Remove installation of percona-xtrabackup on stretch

a4fbb642af-+-mariadb: Initial stretch support for wmf package with systemd

5793ce276d-+-Repurpose four mw machines in codfw for thumbor

560a458b18-+-hiera-ize a log retention parameters for analytisc kafka brokers

f72eeda3cd-+-Fix CLI opt in sqoop_mediawiki.pp cron

b551172e67-+-thumbor: use jessie-backports as target release for python-thumbor-wikimedia

ae183c273a-+-extdist: Make compatible with stretch

7a5f538f63-+-decommission of ms-be1001 thorugh ms-be1012

a974c1807e-+-cmcd: link-in 4.0.0 jar on Cassandra 3.x nodes

537925d215-+-Update recommendation-api module and role

d0aa68ad4e-+-Move ms-be10[01-12] to spare systems for decom

40a37d494e-+-Remove ganglia aggregator from netmon1001

083e510d87-+-maps - move to role / profile

cb6a64db81-+-planet: fix another duplicate declaration

6ecae6552b-+-planet: fix invalid relationship in cronjob, dirs on stretch

127e334c80-+-planet: fix logo path and duplicate declare of config dir

546c68c273-+-planet: add support/compat for stretch and rawdog

d35d3cb222-+-planet: install python-tidylib for rawdog

3f9ee81574-+-planet: do not install libapache2-mod-php5

3a680f38ae-+-planet: planet-venus not in stretch, try using "rawdog" instead

811fd2120d-+-Run l10nupdate monday to thursday

19d0813e73-+-Gerrit: Makes sure review_site/lib exists

a1a494f5e9-+-Insert select eventbus generated event topics into eventlogging MySQL database

4825a3acfd-+-Give ircecho a .py extension in the puppet repo

4565b19232-+-Repurpose mw123[67] as thumbor100[34]

48dc16cfd6-+-mariadb: move db2072 to s1 shard (enwiki)

d76816d516-+-profile::lvs::tagged_interface: remove debug warnings

0ee71f2e1a-+-role::lvs::balancer: also manage interface tagging

0dd76cdc88-+-role::lvs::balancer: refactor to role/profile (step 2)

b6cac352e2-+-Labs puppetmaster:  Allow api calls from the designate host

54e7f87b10-+-kubernetes: Allow IPv6 access as well to master

5697c3024a-+-toollabs: install `lame` on exec hosts

890321d955-+-role::lvs::balancer: convert to role/profile (step 1)

2d4fa5867f-+-otrs: Refactor in the profile/role pattern

2aa2904ea4-+-role::redis::jobqueue: fixup crontabs

50b7d17d0a-+-mariadb: wikitech servers to use core grants

f5331947c4-+-role:jobqueue_redis: daily restart of slaves

861f59e9e8-+-role::mediawiki::appservers: move mw1170-1179 to role::spare::system

8ff9333acc-+-neon: Add IPv6 mapped address

2334bfe545-+-Openstack: Actually install the 'proxyleaks' script.

7b97df9690-+-wikistats: disable cron for wikia - dump file too large (for now)

a1bb689735-+-wikistats: add XML dumps for all tables, fix db access

7ac5f9a959-+-replace the last RT references with Phab links

c9d126be7b-+-contint: Only install libmysqlclient-dev if on trusty or jessie

7221ef3424-+-contint: Remove package libtemplate-perl from analytics.pp

3f905a204c-+-otrs: Use require_package instead of package resource

bdc731a7a8-+-Add vim-scripts as a standard package

374c491eff-+-ssl: cleanup a bunch of expired/obsolete certs

0c0fdac8ff-+-openstack:  add 'puppetleaks' script

21476f363e-+-jenkins: add stretch support pt2, invalid relationship

171d5e9c0a-+-jenkins: add stretch support, no more jdk7, use jdk8

22f546040f-+-releases: add new role/profile, add backups, install jenkins

2f0480f266-+-Revert "Move all ssl certs to the module and out of files/"

7607d42779-+-mariadb: Pool db1099 and db1101 as temporary substitutes of pc2/3

7e94166619-+-Move all ssl certs to the module and out of files/

1118cbb7a0-+-Add Shiny Server module and Discovery Dashboards role/profile

0114ba35c7-+-Assign kubernetes::staging::worker role

a2e93a6663-+-Allow search clusters to reindex from eachother

cd4faa3fd8-+-elasticsearch - cleanup profile::elasticsearch

8f68e6062d-+-elasticsearch: use $facts['ipaddress'] as the published host

9850e46cec-+-add releases1001.eqiad.wmnet to site.pp

8f8d93a27b-+-labs dnsrecursor: add atjwiki

1408167e19-+-labspuppetbackend:  Set port 8100 to read-only and 8101 read/write

2553ba349e-+-labspuppetbackend:  Add an alternative read-only port for queries

4718675d52-+-Update python3-numpy backports version to install on Hadoop workers

d15a035c43-+-k8s staging cluster: interface::add_ip6_mapped

db4c8cc277-+-Setup analytics1069 as a Hadoop worker

726c6f8609-+-base::expose_puppet_certs: typo fix

c4efa408dc-+-base::expose_puppet_certs: Specify ordering for keypair

a49fea2443-+-Require installation of bacula-fd before cert exposure

f236a913a7-+-site.pp: Fix typo for kubernetes stating etcd host

f0d9e92fdb-+-ircecho: add support for the ensure parameter

4412d294bc-+-Update mentions of irclib => irc in tcpircbot

ab9e955b35-+-apertium: Update package list

e870e624a5-+-irc echo: Convert package from python-irclib to python-irc

52f63228e5-+-Add temporary parsercache machines to both eqiad and codfw

f3a639ca83-+-graphite: introduce graphite::whisper_cleanup

2061c4f7dd-+-replace references to RT tickets with Phab ticket numbers

bf158c15ba-+-wikistats: fix group, cron for xml dump, no spam

b3b6edfe6f-+-webrequest: remove X-Forwarded-For

3ae4bf05ba-+-numa_networking: support NUMA in interface::rps

707f28b9be-+-Use ffmpeg from jessie-backports on jessie-based video scalers

5f70557d08-+-Introduce kubestagetcd100{1,2,3} and neon.eqiad.wmnet

7b3d5c2caa-+-role::zookeeper: refactor to multiple profiles

0ff8a04140-+-wikistats: move dump dir out of define, duplicate declaration

81f690d3b8-+-wikistats: add cron jobs for XML dumps

063812249c-+-rancid: drop "server" suffix, apply on netmon1002

73e96820bd-+-system::role: remove leading 'role::' to avoid role-role

d0bbc872a7-+-dnsrecursor: remove duplicate and absented system::role

fa7b47d311-+-fix all the "role-role" in system::roles

1fd05f19dc-+-hhvm: force rsyslog config to create log files with www-data perms

50c19835e4-+-Remove references to keystone admin_token

262ff503ab-+-contint: install HHVM from main

35dbd78ef1-+-MariaDB: temporarily increase limit for space alarm

fbc6d4c6da-+-Openstack:  Added 'dnsleaks.py' script.

2827f4bb7e-+-cache: add monitoring of services at the SSL termination level

ed5077f6df-+-raid: remove unused aac, twe, zfs

3d9ab2dd06-+-LibreNMS add rancid integration

ff81f4d231-+-Rancid: set configs world readable

b636dc8987-+-labstore: Fix data interface require clause

e5bb2ac389-+-labstore: avoid the hardcoding of eth0/eth1

02f679e21f-+-labstore: use the interface_primary fact, not eth0

7edc4f3ea1-+-phabricator: move hiera lookups to parameters

a1a97c5155-+-Use Cassandra version that corresponds to what is being tested

6db58e2c27-+-designate.conf:  Replace identity_uri setting

1d673ee979-+-Set cron script to dump MediaWiki DB lag times into statsd

eb78780015-+-Rancid improvements

12f3ff4d83-+-Revert swapsize_mb/memorysize_mb unstringification

d3dc610970-+-puppetmaster: Set stringify_facts = false

37b83e8b2c-+-Remove to_i/Integer from now unstringified facts

14eda874d1-+-Bump Debian Jessie zookeeper version to 3.4.5+dfsg-2+deb8u2

47f6382a14-+-check_ipmi_temp: do not require /etc/modules-load.d/

0c3fb24613-+-check_ipmi_temp: load ipmi_devintf

10c84a5f2f-+-site.pp: commentary for ex-cache_maps hosts

bd2b0c10e1-+-cache_maps: remove other misc refs

6404e320de-+-cache_maps: remove ipsec defs on kafka nodes

a17b8dbddb-+-maps->upload: delete maps-specific things

fc89526ed1-+-Keystone paste:  typo fix

bb3004b78d-+-Keystone:  add keystone-paste.ini upstream files.

0eba682e53-+-Designate:  further cleanup of keystone_authtoken config

4f08ccee21-+-Glance:  Update our keystone_authtoken section

c471d88635-+-base::kernel: create /etc/modules-load.d on Trusty systems

d0adc4cfe6-+-LibreNMS: enable 2FA

1920cb00b0-+-swift: mask object reconstructor on >= jessie

b3560acf96-+-contint: skip hhvm experimental pin on Trusty

cbf058bb52-+-contint: remove HHVM from Trusty permanent instances

d16f94d341-+-contint: Only install java 7 on trusty and jessie

47bed2fa1c-+-role::graphite::alerts: add transformNull to some alerts

94388efa05-+-Add exception for events tagged as coming from MW

0a606b0ebd-+-swift: create swift user home

f928aa585d-+-novastats:  Add 'diskspace.py' script

c2d16414fc-+-Scap: Bump version to 3.5.8-1

6dfa495adc-+-Disable role::analytics_cluster::refinery::job::guard

75a7bf8f01-+-servermon: Deploy with scap3

c2ab0140a1-+-role::mediawiki::scaler: use more sensible intervals for checks

603a5b63e7-+-check_ipmi_temp: turn off sel checking

0c95f53235-+-Scap3: deploy jobrunner with scap3

d0ea43b2ff-+-Do not confine LLDP fact to physical/non-VMs

f8c7814308-+-dynamicproxy: Centralise error page template and use it

4ad1c8d6ea-+-Revert "dynamicproxy: Centralise error page template and use it"

6640d21122-+-Revert "dynamic proxy errorpage:  s/title/pagetitle/"

581fbf6981-+-dynamic proxy errorpage:  s/title/pagetitle/

f3a1e04bb5-+-dynamicproxy: Centralise error page template and use it

50cdac924f-+-planet: remove "ja" and "ca" (empty), add link to new "el"

3c593da9c6-+-jenkins: Install java 8 on stretch and greater

369f35d7bf-+-tlsproxy: selectively disable request buffering

d3996d3141-+-etcd: big old roles/auth cleanup

9528f42676-+-check_ipmi_temp: set check timeout to 60 seconds

cbd09cdac1-+-ircecho: notify service on config change

b3b647ea47-+-Gerrit: Set gc.auto and gc.autopacklimit to 0 in ~/.gitconfig

880715cefc-+-[Planet Wikimedia] Add some hackathon-related blogs, add Greek planet

d474b992b3-+-raid: switch from stringified fact to array

fb95ed12c7-+-Remove str2bool from is_virtual facts

1927a94626-+-LVS refactor: service IPs and sparing out lvs101[12]

34cb8c9e77-+-LVS: new redundancy layout for new eqiad+ulsfo hosts

610d1cd4e3-+-Re-enable temperature monitoring via NRPE

f750ffe992-+-logstash - curator connects only to localhost

dcf02b4858-+-logstash - cleanup dead code

4be76bfbd6-+-Add Save Timing alerts to Icinga

4045358938-+-Add Navigation Timing alerts to Icinga

69dc16c9bc-+-calico: Supploy a calicoctl.cfg file

69e5336382-+-shinken, icinga: direct bots to #wikimedia-cloud

ccdc21ba3c-+-Labtestvirt2003:  Add to site.pp

1a31e3c16c-+-varnish: don't use $name as a parameter name

0ea2d64326-+-phabricator: don't assign a new hash key

cf1e8316f6-+-restbase: don't define parameter $hosts twice

43f5233867-+-Revert "setting labtestvirt2003 into site.pp"

f68c4a380b-+-setting labtestvirt2003 into site.pp

79068d44f5-+-profile: introduce swift::storage::labs

68e0106466-+-Labs:  Include 'bikeshed' package on Trusty VMs.

b714cf22c0-+-site: add prometheus global instance in eqiad

14495919e2-+-Rewrite the LLDP fact(s)

17972e4b3e-+-Add Druid hosts to network constants

b1600696ed-+-contint: Fix stretch support in package_builder

fba8e0cdf3-+-raid: bump hpssacli timeout

e49b155a90-+-Add Hadoop masters to network constants

f08d95a949-+-Add Kafka analytics brokers to network constants

a985078038-+-Add Kafka main brokers to network constants

0039fcaa98-+-prometheus: allow user 'prometheus' to export metrics too

42b54d966f-+-maps->upload: move LVS IPs

a10db58e9f-+-cache_upload: rebalance storage bins

acfae6635d-+-Use reprepro from jessie-backports

f707810565-+-Disable temperature monitoring via NRPE

6839699389-+-check_ipmi_temp: bump check/retry intervals and timeout

4c10a68447-+-logstash - fix typo in template name

53802fe3da-+-logstash - start using elasticsearch-curator for indices cleanup

638f84368c-+-monitoring/base: add nagios sudo privs for IPMI sensors

7eb0c2996c-+-monitoring/base: add temperature monitoring via NRPE

bd7efd66e8-+-Horizon:  Add sudo policy panel

9b07973c60-+-ChangeProp: Add Redis/Nutcracker connection info

6b68236591-+-prometheus: add hwmon collector to default set

5607a3d9fb-+-tlsproxy: add support to change max_body_size

c1abc0e4c1-+-elasticsearch - correct naming of curator config files

ce19f12281-+-Don't symlink systemd service instances

c5b262a4dd-+-raid/hpssacli: allow NRPE to execute all commands

7bdea41e3d-+-pmacct: update config, push output to Kafka

bb43a2a6ae-+-pmacct: fix firewall rules

124142a154-+-profile::nutcracker: correctly handle monitoring, refactoring

161cb67115-+-Remove obsolete mediawiki::migrate class

7988dea1d9-+-role::scb: add nutcracker for changeprop

09265a7f8e-+-elasticsearch - introduce curator configs to enable / disable replication

07e4a05b5b-+-Kubernetes: Add IPv6 mapped addresses

c9bdc2417b-+-prometheus: report puppet agent stats

ab663234b2-+-mysql-client: Install colordiff (neodymium & sarin)

bc525a928f-+-decom ms-be2001 - ms-be2012

62169d8aca-+-mariadb: Decommission db1023

8affb59995-+-phabricator: reactivate exim ganglia stats

13b9791293-+-wikistats: install php7.0-xml if on stretch

e755fcacbd-+-wikistats: ensure Apache PHP module is installed before site

88b1e1d337-+-Add kafka_version parameter, s/java_packaage/java_home/ in confluent::kafka::client

42d7e37eed-+-phabricator: set alt_host in redirector to "phab" instead of "fab"

e9958ac4fb-+-r::c::perf - +rxring and +txqueuelen

6da30838ab-+-role::aqs: use profile::cassandra

6a5a14eb03-+-calico: add new version 2.2.0

24b5e2dd59-+-phab: comment out include of exim4::ganglia

2760d4c475-+-authdns::server: move 'include standard' to role

a6a2ca2be7-+-dnsrecursor: move 'include standard' to role

82af21107e-+-confd: use logrotate::conf for logrotate

837db31e74-+-Use is_not_bot filter function for eventlogging mysql consumer

269f8ddd32-+-Revert "Changes needed for upgrading to Druid 0.10"

1fefeeb60b-+-r::c::perf - FQ outbound flow rate cap @ 1Gbps

9403053774-+-novastats:  Update some reports to use more up-to-date code.

6fbadbad26-+-Changes needed for upgrading to Druid 0.10

aa116a756e-+-Specify the correct host for wikidata icinga config

2c7089d72e-+-Decouple wikidata monitoring from the IP address

01bff759a5-+-Revert "Use gdb from jessie-backports on jessie"

026c81a830-+-Use gdb from jessie-backports on jessie

776b1d511f-+-raid: Implement the option to check write cache policies

b182709131-+-Enable memcache-based Thumbor broken thumbnail throttling

92b5ba2df9-+-r::c::perf - raise fq flow_limit to 300

80d305c6f4-+-caches: enable BBR + tuned mq+fq qdiscs

8f0cd7d728-+-interface-rps: add mq subqueue qdisc setup

31bf233a68-+-RPS cleanup 5/5: use new config file in puppet

fad92c36f6-+-RPS cleanup 3/5: pattern not necc for LVS

e3fba2758b-+-RPS cleanup 2/5: remove irqbalance module

47e41d08f9-+-elasticsearch - deploy elasticsearch-curator along with elasticsearch

ef790006ae-+-Remove use of is_not_bot filter in eventlogging mysql until code is fixed and change is cleared (announced)

ee80c0ee0e-+-logstash - apifeature indices need to be cleaned up

8092cabecb-+-Add bot filter to mysql consumer

2a75f51668-+-role: don't install kafkacat for statistics::private

f5f09b1dfe-+-profile::calico::builder: fix branch to check out

d3d1006c83-+-graphite: move 'standard' and 'base::firewall' to role

f32b99a602-+-nrpe: Ship a systemd unit file

53acfc61a4-+-profile::etcd::replication: write to localhost via http

5b71cc8929-+-profile::etcd::tlsproxy: better read-only error reporting

79cfdefd50-+-profile::etcd::tlsproxy: allow read-only mode

a9d901c170-+-Don't replicate techconductwiki to labs

f63a6fc5cd-+-wikistats: Require /usr/lib/wikistats/schema.sql before executing mysql command

287fd3c65d-+-wikistats: ensure systemuser exists before backup dir

1c53919efe-+-wikistats: 'user' -> 'owner' parameter for /srv/wikistats

d327edd610-+-wikistats: use systemuser for git cloning

473543270f-+-wikistats: fix typo in db.pp "requires" -> "require"

859ee799de-+-wikistats: make db_pass a parameter, use fqdn_rand_string

791fd62b90-+-Planet: Delete sr.planet

ad26de914a-+-gerrit: rename "server" IP to "service" IP

0e3240f28f-+-wikistats: grant db permissions on first run (labs)

bcaf2b4a79-+-Assign roles to kubernetes200X hosts

6198af93ab-+-cassandra: remove unused role

a2ca0c983b-+-restbase: remove legacy classes, roles

2358a3ec1d-+-profile::cassandra: remove useless pick()

87bdff7236-+-Fix MediaWiki centralauth errors graphite alarm

a00eb50796-+-restbase: convert deployment-prep to role/profile

0a1ad6124b-+-debug_proxy: move 'standard' and 'base::firewall' to role

ee6062e5d4-+-phabricator: convert to profile/role-structure

4dd4e50b6f-+-graphite::alerts: add alerting on session loss

bdbe794788-+-Install Lua debug symbols

07fac0af89-+-Use str2bool() for the is_virtual fact

701b648825-+-gerrit: switch to interface::alias

28d597f2d2-+-cassandra: switch to interface::alias

6eefdf0587-+-phabricator: switch to interface::alias

8aa54b5ca5-+-lists: split mailman::lists_ip variable into v4/v6

a1957b9a04-+-lists: use ipaddress facts instead of server IP in Hiera

0f3217786a-+-lists: brown paper bag fix for 128c6df

128c6df67e-+-lists: switch to interface::alias

08b250ee88-+-yubiauth: convert to profile/role structure

e1fb1514a3-+-labs::dnsrecursor: switch to interface::alias

78e92c81d5-+-Add a new interface::alias definition

058f434d9b-+-ci::master: move 'include standard' to role

70fdce99d1-+-decommission mw2098

dc677a45a1-+-cache: use interface_primary instead of eth0

53fa65ed23-+-service::uwsgi: fix logrotate rules

26a85cb542-+-interface/lvs: add an $interface parameter, remove hardcoded eth0

c105f3ca7a-+-Introduce kubetcd200{1,2,3}.codfw.wmnet

39c2e3245b-+-interface: remove unused definition ::offload

3cb6fba048-+-restbase: convert production cluster to role/profile

bc4c5c8914-+-Allow setting of zookeeper_version in hiera

755e6cf9d1-+-Revert "Allow setting of zookeeper_version in hiera"

308624ddab-+-Allow setting of zookeeper_version in hiera

458e419b8d-+-Add apt pinning for git on deployment servers

f20c3075ea-+-Add private AS# to LibreNMS

e865a671ad-+-package_builder: Install patchutils

2cf0e9c98a-+-wikistats: only run db init command once

169b043466-+-wikistats: fix wrong file parameter, user -> owner

c805280cf9-+-wikistats: add db schema, auto-create db, adjust backup dir

f4b73152b2-+-wikistats: install libapache2-mod-php7.0 if on stretch

5136ddf034-+-Labs contint: Install php5-gmp and php7.0-gmp

0773867a19-+-wikistats: create random db password once to bootstrap system

59f00248c4-+-wikistats: don't use /root/ dir for backup, use /usr/lib/

dbb0f134c1-+-wikistats: puppetize deploy script

992949b2c6-+-wikistats: more stretch support, php-cli package

af5d0b1117-+-wikistats: add support for Debian stretch

b0086a457a-+-Jenkins: install jdk, not just jre

5ebbcd0d27-+-restbase: convert test cluster to role/profile

b4b5c21d46-+-cassandra::instance: allow use of default values

26b2e790ed-+-restbase: migration to role/profile for the dev cluster

1a4957546a-+-LibreNMS: Use default OSM tiles provider + simplify syslog filtering

53b8994deb-+-Add acrux, acrab to the infrastructure

442136a14c-+-profile::calico::builder: use calico release info

7623476f9e-+-webperf: move 'standard' and 'base::firewall' to role

10f40685a8-+-dumps::zim: move 'include standard' to role

db6b56b942-+-piwik: move 'include standard' to role

c34ca8c316-+-syslog::centralserver: move 'include standard' to role

6b0b6bb379-+-varnish: reduce keep setting on frontends

aba2550a64-+-docker::baseimages: separate build script for alpine linux

57e741fddd-+-contint: fix apt::pin resource name

f9c2780629-+-role::deployment_server: generate dsh lists for zotero

6819c23fe2-+-contint: pin HHVM packages to use experimental component

30d7f16d07-+-contint: move hhvm-dev to a different class

240f016358-+-contint: experimental component for nodepool instances

96654e33db-+-backup::offsite: move 'include standard' to role

38c203d371-+-backup: remove duplicate 'standard'-include

550922ee2b-+-Various LibreNMS improvements

6cb095eb41-+-Drop cache/LVS NFS override

d97024b846-+-udp2log: use logrotate::conf for logrotate

d89dfcf325-+-lvs: remove support for <= trusty

908cb6d068-+-Move all add_ip6_mapped calls to site.pp

41c3964e4f-+-Remove c/p interface argument to add_ip6_mapped

9bfc1668c9-+-Switch add_ip6_mapped to use interface_primary

f0cf0d8192-+-labs: remove the _eth0 suffix from ipaddress facts

5d62720c7a-+-LVS: move pybal config to a separate class

1140978bf7-+-role::mariadb::wikitech: Switch to ferm constants

a7d62a6008-+-Remove mira from role::mariadb::wikitech ferm rule

a3aba088fb-+-Remove mira from tcpircbot config

8799f5749a-+-Ferm to allow tcp/10514 on logstash nodes

70f76bd030-+-thumbor: move 'include standard' to role

582e4f1ac6-+-parsoid: move 'include standard' to role

24336bf31c-+-puppetmaster::backend: move 'include standard' to role

f460f0c158-+-poolcounter: move 'include standard' to role

6038792b11-+-apertium: use logrotate::conf for logrotate

3736d9ed2f-+-ganeti: move 'include standard' to role

d74a00d1f3-+-Add new logstash LVS service

9923d2ed4a-+-role::deployment::mediawiki: include ::profile::conftool::client

db01b7e3b3-+-kafkatee: use logrotate::conf for logrotate

d15bedacec-+-site.pp: consistent quoting for role names

ae91effbf0-+-hadoop: use logrotate::conf for logrotate

5ad7f49fe8-+-dynamicproxy: use logrotate::conf for logrotate

f982f9bcba-+-webperf: Remove remnants of webperf::asset_check

c285b48281-+-deployment_server: Fix misspelt variable

2ef980cb5a-+-openstack: use logrotate::conf for logrotate

d487b232c3-+-deployment::server: move add_ip6_mapped back to site.pp

1a90348160-+-decommission mira

c9ab3a41d1-+-Californium:  include ldap client tools

abb91e5e91-+-Revert "Fix user/group ownership for kubernetes certs"

52868d8044-+-dnsrecursor: use ipaddress6, not ipaddress6_eth0

6b79a54e8b-+-lvs: replace $::ipaddress_eth0 by $::ipaddress

1e46187f5d-+-service::node: report timing data from check-service to statsd

6ca0bf12e2-+-Migrate to using kubemaster.svc.$site.wmnet

e46f7c0a26-+-maps->upload functional cluster-level changes

673e4d4650-+-Add role::lvs::realserver to role::kubernetes::master

4772c31b85-+-Replace $::main_ipaddress by the new ipaddress fact

69d0fef04c-+-lvs: Add the kubernetes master service/cluster

2dca5e3015-+-Fix user/group ownership for kubernetes certs

554dbafdbc-+-Use a service cert for kubernetes masters

72901c1854-+-etcd: use logrotate::conf for logrotate

8707d9f9a3-+-Update comment

eef3ea79fd-+-Enble puppet on db2062- a one-time experiment for mariadb 10.1

4a9d3506c3-+-nodepool: do not install Package[libguestfs-tools]

b773e320d3-+-Revert "base::standard_packages: Remove ubuntu precise check"

5c4f02d6d9-+-deployment::server: convert to profile/role

fa97aaadc0-+-profile::base: use logrotate::conf for logrotate

0993a464f7-+-salt: use logrotate::conf for logrotate

fff6d4a79b-+-systemd: use logrotate::conf for logrotate config

a77add4151-+-base::puppet: use logrotate::conf for logrotate

e7133c1fbc-+-mediawiki::jobrunner: use logrotate::conf for logrotate

9486d0352b-+-elasticsearch: use logrotate::conf for logrotate

1d0413548c-+-graphite: use logrotate::conf for logrotate

3a8013a512-+-camus: use logrotate::conf for logrotate

04726719b9-+-rsyslog: use logrotate::conf for logrotate

0d2fa20480-+-site.pp: remove db1040, decom

b9e6512ac3-+-site.pp: remove analytics1027, decom

df82f3cc93-+-snapshot: use logrotate::conf for logrotate

8508e5c00a-+-ocg: use logrotate::conf for logrotate

0b3ac5d643-+-varnish: move nuke/lru and exp_thread stuff to all clusters

24824101a9-+-varnish: align on 1d TTL work

1a22ffe663-+-Revert "etcd: use logrotate::conf for logrotate"

c069081def-+-etcd: use logrotate::conf for logrotate

2b627c8997-+-services: use logrotate::conf for logrotate

099990dc77-+-sshd_config: Increase MaxAuthTries

eab08cc5bd-+-librenms: use logrotate::conf for logrotate

823438525a-+-squid3: use logrotate::conf for logrotate

c14fa229a6-+-puppetmaster: use logrotate::conf for logrotate

bb41535728-+-kibana - cleanup of /opt/kibana has been done

2ea9a2f22c-+-icinga: comment out contacts-new.cfg

4ccb543739-+-nagios_common: test contact template with private/hiera lookup

bba00d6ae8-+-Update elk stack to 5.x

dea271b95d-+-Remove the ipv6::relay/miredo manifests

32eb0c85bf-+-keyholder: fix provisioning on trusty

a8b64a73f3-+-base::standard_packages: Remove ubuntu precise check

35d45f78d7-+-webperf: Decom asset-check service

7037c9696f-+-Labs/salt: Use sha256 salt fingerprint with newer salt versions

5ee31091da-+-varnish: re-size (again) frontend memory

4ce49bdd64-+-Sqoop using the pre-generated orm jar

b01859de15-+-Send 5xx from kafkatee to logstash

d88dc90944-+-mariadb: Get ready to decomission db1024

401615b784-+-Revert "Switch labservices1002 to the primary designate/dns server."

0620b9b3c0-+-Align OCSP file freshness check with new cron timing

13da1ecd89-+-ocsp updater: 1/day instead of 1/hr

a918a09073-+-fqdn_rand cleanup: distinct seeds in same cron

21669e13fc-+-fqdn_rand cleanup: always use a seed

ed5b9aec57-+-fqdn_rand cleanup: fix bad hour=>23 and minute=>59

328f3c67a5-+-labstore: Explicitly declare package dependencies for nfs-common and rpcbind

535988c816-+-dumps: Explicitly declare package dependencies for nfs-common and rpcbind

58e267397e-+-Set correct minute to Piwik's archiver crontab

d8b6bd3d6f-+-Set Piwik cronjob archiver and tune Piwik's defaults

23b434dd70-+-Remove create of librenms directory

8a762a8483-+-librenms: Introduce scap3 deployment

ff47178f4a-+-icinga: move send_nsca.cfg to public repo

1abba80682-+-icinga: move nsca_frack.cfg to public repo

04146fc656-+-icinga: move nsca config to pub repo

1a9a671ee4-+-return tempdb2001 to spares

52e9f4ad16-+-bootstrap-vz:  fix c/p error

fa8682f512-+-bootstrap-vz:  Add a manifest for a Stretch labs image

bcda9d67c8-+-bootstrap-vz:  Include kpartx package

9680e5aedf-+-prometheus: add tcpstat collector to default set

87632d18c1-+-BBR Congestion Control

2520fc4a77-+-labsdb: add new wiki dbs to dnsrecursor.pp

7e59993837-+-Reading Web Page Previews alerts

a7180e8ec9-+-logstash - delete all indices older than 31 days

493ae0501e-+-varnish: better frontend mem sizing

e58df02050-+-mariadb: Get ready to decomission db1022

b68cf67b1a-+-Add a Prometheus Apache exporter to Bohrium

a878ed540d-+-mariadb: Get ready to decommission db1040

c60850e35f-+-mariadb: Get ready to decomission tempdb2001

7c2876879c-+-raise storage size for new cache SSDs

0771315bf8-+-cp4021: add ipsec and node list entry

332d1aab36-+-r::c::base - support 800G disks for new ulsfo systems

ee8ca4bcf7-+-add cp4021 dhcp and temporary site.pp entry

a72e4b94ca-+-Gerrit: Disable custom log4j for awhile

a9fe6098f1-+-gerrit: use ssh::userkey to install ssh key in proper location

1540694630-+-gerrit: move hiera lookup to profile parameter

6b390f54d2-+-jenkins: remove groovy init that disabled CLI

e79f4e663f-+-zotero: use logrotate::conf for logrotate

f7c9852206-+-dumps: use logrotate::conf for logrotate

2503682728-+-role::deployment::server: only run l10update on the active server

19b82d2d06-+-Deployment server: do not touch lock file on master

1f20f2b464-+-gerrit: also allow ssh via IPv6 between servers

019d8892cd-+-gerrit: ferm rules to allow ssh between servers for clustering

ec6ed13b5c-+-Gerrit: Go ahead and apply gerrit role to new slave in codfw

72cf14828f-+-Gerrit: Finish replication prep

b3c9d950b3-+-sge: Add gridengine-client package dependency to grid master and shadow-master

1b2be96482-+-swift: default to 127.0.0.1 for memcached

29e3a4768e-+-profile::etcd::replication: make replication errors page

b145183bb4-+-elasticsearch - cleanup hiera lookups with default "undef"

ab48440453-+-role::ocg: set nutcracker port to 11212

4a380b4a65-+-Revert "nodepool: bump python-jenkins"

3af7283c07-+-role::ocg: add local redises

2e2b23f0dd-+-nodepool: bump python-jenkins

48dddfc30f-+-Swap mc1001->mc1012 with mc1019->mc2030

217faf5ba1-+-conf1*: convert eqiad cluster to use role::configcluster

12de31f4fe-+-Disable suppress_san_warnings

3a3125caa1-+-Update cron job copying mediawiki db into hdfs (2)

202edc95c4-+-Keep 90 days of refined webrequest data

ec369bf2e1-+-More detailed names for keystone api monitoring checks.

454347d08e-+-Remove asw-d-eqiad from monitoring - T148506

618189073a-+-toollabs: ensure default hhvm service is stopped

d0f5eaba58-+-Monitor wikitech-static mediawiki version

d917ac7ae2-+-Update cron job copying mediawiki db into hdfs

4c564fea67-+-Tools: Require gridengine-master for gridengine_resource

4cd94fce04-+-tools: change python-boostrap-vz to use bootstrap-vz

714f87fd5d-+-releases: remove the precise suite

1090619ae5-+-scap::source: also define the corresponding dsh group

1e5fd6f25f-+-scap::dsh: drop 'recurse => true' on directory

9b15276d96-+-profile::scap::dsh: define, use everywhere instead of scap::dsh

084c642d21-+-Scap: update version to 3.5.7-1

9b47b4e42c-+-Link-in upgraded cassandra-metrics-collector jar

4dbe609909-+-Switch to stretch backport

3743d55cdd-+-scap::dsh::group: add datacenters to scap/conftool config

23e22927e5-+-scap::dsh::group: split does regex splitting

be19400826-+-scap::dsh: transition to using confd

257486af8a-+-redis: make redis_get_instances() fail when empty

2801eec16b-+-The build of bootstrap-vz failed in the source package generation stage of pdebuild (i.e. before the build dependencies are installed in the pbuilder chroot):

256751456a-+-labsdb: Add redact_sanitarium script to sanitarium (#1, db1069)

3eac68be1f-+-mariadb: Add db1097 as a new eqiad s4 slave

7908798a59-+-Revert "puppetmaster: Re-depool puppetmaster1002"

a5fb95935f-+-Designate api:  Fix typo in a ferm rule

ec63a58c52-+-Designate:  Allow labs clients to access the designate API.

15c196a821-+-Set trusted hosts for Piwik in its profile

889ef3647b-+-Refactor role::piwik in multiple profiles

6ea13b1b9d-+-profile::redis::multidc: use ipaddress, not ipaddress_primary

fc12c47840-+-changeprop: Remove the ores_uri parameter

553fde143b-+-cache: hiera flag to enable expiry thread RT experiment

5756ab442b-+-setting all puppet parameters for phab1001.eqiad.wmnet

76d5e9a92b-+-Revert "openldap::mgmt: turn cross-validate-accounts into template"

1610241f78-+-site.pp: move mc1013-18 to spares, mc1031-36 into rotation

b38dc37442-+-ores: Switch the redis database role to profile

42e89c949f-+-ores: Move the application (web+worker) to profiles

c1915487e2-+-mariadb: promote db1063 as s5 master

16fd91357a-+-role::mediawiki_maintenance: reorganize code

dee6bcef89-+-openldap::mgmt: only run account-validation script in $::mw_primary

d4c88c7454-+-openldap::mgmt: turn cross-validate-accounts into template

97510e3e7d-+-mediawiki::maintenance: convert to profile/role

4ffda16ef5-+-Switch labservices1002 to the primary designate/dns server.

df18648772-+-site/icinga: unify einsteinium/tegmen in single node section

4598cb34e7-+-Add symlinks for Debian-packaged Bouncycastle Jars

7c559a5c3d-+-Assign a hints directory (Cassandra >= 3.0)

e9dbd61918-+-Revert "Switch labservices1002 to the primary designate/dns server."

fe74bc04f0-+-Switch labservices1002 to the primary designate/dns server.

ed91c19a14-+-Scap: update version to 3.5.6-1

ac0d9b74ae-+-Create a Cassandra 3.7 configuration

e963e1c739-+-Add add_ip6_mapped to cobalt

d15566a555-+-mariadb: promote db1062 as the new master of s7 eqiad

c74da95671-+-Make wikidata logrotate config compatible with jessie

693dfb590c-+-profile::conftool::master: make the git root dir a parameter

4e59bd6e4a-+-Make translationnotifications logrotate config compatible with jessie

cf914046b6-+-Make generate-fancycaptcha logrotate config compatible with jessie

975ef057d6-+-Change db1061 to be the s6 master on eqiad

51bddd2e12-+-mariadb: promote db1054 as the new s2 eqiad master

f8e2bbc0f7-+-add netmon1002 to site

b7bc8585de-+-Phabricator: Install php5-apcu on debian jessie

693e0200c9-+-Write global scap lock file for non-active deployment master

369ec99568-+-Make cirrus logrotate config jessie-compatible

cbc00a308a-+-Fix storage path for terbium sync

228efb11dc-+-Change synchronisation host for terbium reimage

093fbb8e0d-+-Setup rsync server to sync home dirs from terbium to wasat

735aea9208-+-graphite: don't fire alarms on carbon-related spikes

bc46c896e6-+-wdqs - fixed stupid copy paste mistake

7756def358-+-wdqs - corrected naming of new WDQS alerts

a521c61d21-+-wdqs - monitor response times for both eqiad and codfw

85fcf4e81b-+-keyholder: create /run/keyholder at boot

14b1605951-+-Revert "Create a separate sysctl configuration for setting conntrack settings"

426ecc5586-+-Revert "cache_upload: lower keep from 3d to 1d on upload backends"

16cc901d13-+-icinga: Adjust the frequency of sync-icinga-state

9d4d761399-+-Ensure mcrypt enabled on integration slaves

1d15de4173-+-wmcs: better output from nfs-mount-manager

ab5c7d58c8-+-puppetmaster: Re-depool puppetmaster1002

495cf550bb-+-Avoid double hiera lookups in puppetmaster::frontend

700c623a53-+-Fix sync-icinga-state cron presence/absence

9b1329fa69-+-Load nf_conntrack via /etc/modules-load.d/

91bed8c0ce-+-role::tcpircbot: Pass ensure parameter to tcpircbot

2635a97a01-+-Revert Load nf_conntrack via /etc/modules-load.d/

52810d1550-+-site.pp: Move db1063 to s5

2beba6c4c2-+-Load nf_conntrack via /etc/modules-load.d/

e86305d157-+-novaproxy: Rename ferm rule

a13f0e46e9-+-novaproxy:  Open up port 5669 for quering the proxy API.

3d29a7ec1f-+-Dynamicproxy:  Set up a GET-only frontend

c82435034d-+-tools-proxy: Ensure kubelet is stopped on tools proxy nodes

64a94a86ac-+-ircecho: Add require => File['/etc/default/ircecho'], to base::service_unit

cde4688715-+-ircecho: add missing "ensure => present" on config file

b95283d3ac-+-nagios_common: add IRC notifications for #wikimedia-fundraising

675eb4d1a9-+-tcpircbot: Also remove requirement of ${title}.json

296bfd228c-+-mariadb: promote db1068 as the new s4 master on eqiad

5ba28bf753-+-tcpircbot: Subscribe to the correct File resource

7076797ff2-+-Make varnishkafka log producer descriptions unique

1b12d87c7d-+-icinga::event_handlers::raid: Remove dependency on nagios.cmd

32dac02617-+-icinga: Fix permissions for /var/lib/nagios/rw

7af8dff2e0-+-logstash - raise elasticsearch shard alert threshold to 34

57f4cf6d4e-+-network::constants: Fix einsteinium's IPv6 IP

2dc6429d97-+-role::icinga: Also allow IPv6 for icinga rsync

c38ba6a947-+-Refactor role::icinga slightly

9322c58967-+-puppet_compiler: Use dirname in the conftool namespace

379806ac3e-+-Setup db2071 as new s1 slave

46648fef16-+-dnsrec/icinga: add child/parent rel between monitor hosts

f5647fd46d-+-base/icinga: fix path to check_cpufreq plugin

347328f042-+-base: add icinga check for CPU frequency on Dell R320

20285dad50-+-tcpircbot: allow naos

88058bf0c1-+-lvs: bump net.ipv4.icmp_msgs_per_sec

019bafefac-+-icinga: wrap run-no-puppet around sync_icinga_state

dfd0ae3f13-+-Keystone:  Kill off novaobserver and novaadmin tokens after 2+ hours.

d2ffd19365-+-Revert "deployment: sync home dirs from mira to naos"

d1b54fab1a-+-l10nupdate: Ensure a default uid of 10002

d91272a196-+-deployment: sync home dirs from mira to naos

25880115fa-+-dumps: skip cert monitoring where Letsencrypt is disabled

d1508660c7-+-Keystone: Redirect keystone-manage cron output to /dev/null

4a1453379d-+-Move gerrit to using Bouncycastle as packaged by Debian

8d4d6b5914-+-Keystone:  Use keystone-manage token_flush rather than a mysql call

473c4d1d54-+-standardize "include ::profile:*", "include ::nrpe"

b6c4c9b2af-+-tools: bump and consolidate timeout values for client NFS

a27e703f02-+-monitoring:bad_directory_owner: set default timeout 10s

18f8f33929-+-monitoring: fix wrong parameter bug in file ownership check

ac5ec4b785-+-monitoring: add timeout parameter to bad_directory_owner check

393c391ffd-+-adds naos to everywhere mira is listed

a439ba31d9-+-Shinken: Add monitoring for the labs dhcp server.

c06b6b6c84-+-RESTBase: Add the CXServer service URI

6142dfefbe-+-Mark wireshark-common/install-setuid as seen to avoid debconf prompt

bd69202631-+-base::kernel: mod blacklist for Dell R320, blacklist acpi_pad

bd65b0693b-+-ircecho: Remove  file { '/etc/init.d/ircecho': code

f0917c0650-+-ircecho: Fix support for trusty

b9074ce4ce-+-use synthetic warning for 1% of 3DES pageviews

ade065263b-+-Phabricator: Add additial check just for checking phd

ebc2778837-+-Fix thresholds for Zookeeper Heap usage alarms

8af4ded178-+-Fix Zookeeper's alarm for heap usage

2f569091ee-+-ci/labs/tendril: add some comments/FIXMEs about moving Hiera lookups

a76e717e23-+-contint/icinga: skip zmq_publisher monitor if no jenkins

d28ad29345-+-Use new pageassessments dblist to avoid cronspam

4164c1492b-+-tendril: skip cert monitoring where Letsencrypt is disabled

8034573637-+-contint/icinga: make jenkins service monitoring configurable

42d145823f-+-jenkins: use configuration file for logging

e7d5d46bdd-+-site/prometheus: rm duplicate base::firewall, mv standard to role

ccd01ee53b-+-Create truthy nt Wikidata entity dump each Monday

a0b157b422-+-Wikidata entity dumps: Allow nt RDF dumps

483db4ee5c-+-setting naos install and site parameters

1a45db75af-+-Change dumpwikidatattl to allow producing other flavors

ccf3c207c7-+-role::ntp: replace one more faulty NTP upstream

5a3f8765c6-+-labtest: avoid broken Icinga checks on labtest

de09b68d8d-+-Make Thumbor connect to Swift via https

4e7bc540a7-+-role::ntp: update manual upstream timeservers

04c24ea5c3-+-Remove obsolete parameter for debconf::seen

7d2314e7ec-+-Allow silencing a debconf query

4af96db76c-+-Revert "LVS: remove direct use of achernar recdns"

11ab395f8d-+-LVS: remove direct use of achernar recdns

26ffa63178-+-Revert "LVS: remove direct use of acamar recdns"

1f0e598a9a-+-site: remove all the "$cluster = 'misc'"

6363d7693c-+-site/install: unify install nodes into a single regex

b12bcc366b-+-site/redis_slave: remove duplicate base::firewall include

ba2903f066-+-site/ganglia: move firewall/standard/IPv6 to role

1e6be51b32-+-site/thumbor: remove duplicate base::firewall include

29a3dbf37e-+-LVS: remove direct use of acamar recdns

22d26aad74-+-wmfkeystonehooks:  Create project page on wikitech on project creation

16dae2c751-+-planet/varnish-misc: switch planet to active-active

2cf544b882-+-openstack: Decrease by 2 the backups held

7c47872445-+-nova-compute monitoring:  Check for one and only one nova-compute process

8af8c35dc0-+-Remove unused ganglia views

16f1cb4893-+-Switchdc: rename redis stage from t05 to t06

d3b8067804-+-backup::set: Allow passing an $extras config hash

1334d10901-+-Move backup::openldapset into the respective roles

f6cf327e7f-+-ulsfo recdns: prefer codfw to eqiad

5a54a521c2-+-Change bacula retention policies and volume number

ae92e95bfc-+-profile::conftool::client: accept protocol as a parameter

830a0383a4-+-role::puppet_compiler: fix etcd protocol

de72c36ce0-+-puppetmaster: Remove the jessie-backports pinning

acf2c673cc-+-RESTBase: Clean-up unused variables

7aa41fed44-+-mw_rc_irc: convert to profile/role structure

baf055b5bf-+-lists: convert to role/profile structure

fd62091b88-+-changeprop: Add an ores_uris parameter

9187994405-+-Include ores::base on hadoop clients and workers

4d244a3afc-+-RESTBase: Use the provided logging name and statsd alternative prefixes

724ca67e12-+-ircecho: Convert to base::service class to maintain the script

d33240a711-+-Shortcircuit profile::backup::host to be usable always

b7d9be7860-+-RESTBase: Switch to Scap3 config deploys

4f1b3f0a80-+-Decommission prometheus[12]00[12]

7a5a6ca2e1-+-Scap: update version to 3.5.5-1

c67a10c176-+-role::puppet_compiler: fix conftool config

f83d1ae558-+-Make backup::set effectively a virtual resource

c93b322cfe-+-Revert "Move hadooop python package declaration into client"

f72ae307f4-+-Move hadooop python package declaration into client

c68c43e83d-+-Revert "dnsrecursor: update to backports for transition"

4b9475d66c-+-Revert "esams lvs: do not directly use maerlant, temporarily"

1bd02f4075-+-esams lvs: do not directly use maerlant, temporarily

4b955ba76e-+-Revert "eqiad lvs: do not directly use chromium, temporarily"

54438d40c2-+-eqiad lvs: do not directly use chromium, temporarily

bcfc9e88c1-+-Revert "esams lvs: do not directly use nescio, temporarily"

3c028b4a95-+-esams lvs: do not directly use nescio, temporarily

22e2235367-+-Revert "eqiad lvs: do not directly use hydrogen temporarily"

f80b9b7d97-+-eqiad lvs: do not directly use hydrogen temporarily

392aa4fc4f-+-ulsfo lvs: prefer codfw dns

c4881821c4-+-dnsrecursor: update to backports for transition

b2eb1b962b-+-dnsrecursor: 4.x backport and edns-client-subnet

522c0798a3-+-jenkins: also fix permissions for access.log

f554af27c1-+-Upgrade logstash to 5.x

a193ed8c88-+-jenkins: tweak log permissions

28ef2eba4d-+-standardize "include ::base:*"

992c1163c0-+-Add new hadoop worker nodes to site.pp

6fbf9cf1ef-+-Reorder more python sklearn deps to work around require_package issue

7a1f6d2608-+-Install python3-sklearn-lib and make sure python3-numpy is installed first

5613baec11-+-Use package resource instead of require_package for ensuring specific python-numpy versions

7d38533860-+-Fix missing comma in package list

14c12f6d71-+-Ensuring python and python3 versions of numpy are the same on hadoop workers

8aea9c4b66-+-Remove python3-numpy=version from list of installed packages to test fix require_package error

04b8a49232-+-Using array argument for require_package

2ad8bd151f-+-Separating out require_package calls in attempt to figure out weird error message

33b0aff11c-+-Revert "Revert "Add python3 packages to hadoop workers for ORES in hadoop""

c38ef051dd-+-Revert "Add python3 packages to hadoop workers for ORES in hadoop"

d7c5662895-+-Add python3 packages to hadoop workers for ORES in hadoop

2f7e990a05-+-postgresql - cleanup dead code after migration to check-postgres package

a7528a2ead-+-RESTBase: Migrate to Scap3 deployment

b3ecd174df-+-postgresql - use the check-postgres package for icinga checks

399f86942a-+-apache: remove precise (and Apache 2.2) support

373c3e8e5b-+-mediawiki: kill more precise references

1f64fedfb4-+-postgresql: remove precise support

3167e8dcb4-+-Rename apertium-es-ca -> apertium-spa-cat

27d888272d-+-postgresql - introduce the check-postgres package for postgres monitoring

ef9a593cf4-+-etherpad: convert to profile/role structure

568fe0c99b-+-Remove role::backup::config

0e2fa98202-+-delete netmon::migration class, not needed anymore

e233ceee7f-+-zookeeper: remove precise's package version

2bc1ab8666-+-Revert "jenkins: tweak log permissions"

350837fd75-+-jenkins: tweak log permissions

2876587fdc-+-Remove programdashboard module and related hieradata

452adffad6-+-interface: remove precise support

6757e19009-+-standardize on include ::profile::backup::host

692423bc40-+-Fix role::mediawiki::maintenance backup::host inclusion

a25081633a-+-Include profile::backup::host in respective roles

e535135ff1-+-Fix typo with role::backup::host

8bc51123eb-+-Make role::backup::storage a profile

34e82c6fdc-+-Make role::backup::director a profile

63dd320b9d-+-Move role::backup::host into a profile

ef7f8a46c1-+-osm - remove dead code

5ab79b8be7-+-lxc: remove precise support

d721bf1075-+-Standardize on lowercase os_version/require_os

475c8e3902-+-Revert "Temporarily disable the change dispatch cron for testwikidata"

5b2c79c70c-+-Temporarily disable the change dispatch cron for testwikidata

5d2fbe7e62-+-Move system::role {'tor::relay': }

e84e4051d9-+-Remove system::role {'requesttracker::server': }

9e6d1b2d43-+-Create a separate sysctl configuration for setting conntrack settings

a6f6a1b891-+-Remove system::role {"profile::redis::slave":}

1e1360699e-+-Remove system::role {"profile::redis::${category}":}

1e5897452a-+-Remove system::role { 'profile::redis::master':}

860c924efb-+-Move system::role { 'role::planet::venus': }

a4e8aec7ac-+-Remove webserver_misc_static system::roles

1a00255732-+-Move and rename system::role{ 'role::gerrit::server':}

bee912dd74-+-Move and rename system::role{ 'role::elasticsearch::server':}

fa1998fab5-+-Move and rename system::role{ 'role::docker::builder':}

36e97932b8-+-Remove system::role { 'conftool-master': }

3c7d1c98da-+-Remove system::role {'config-master': }

437d892d3f-+-maps - publish postgresql replication lag to prometheus

22f059668e-+-Prepare mw2090->mw2096 for decommission

6b89bd8df6-+-site.pp: Add tempdb2001 new host

f06e32473e-+-vagrant: remove precise support

ceb5713d0c-+-labs_vagrant: remove precise support

2353851133-+-Phabricator: Use base:service_unit for aphlict

4cf5c9141d-+-installserver: remove precise support

12ab5be238-+-Improvements to eventlogging_sync.sh script

2e79294b58-+-elasticsearch - maintenance_hosts is actually already resolved to IPs

45ae515859-+-elasticsearch - ferm hosts need to be space separated, not coma separated

b4918a9603-+-elasticsearch - move role::elasticsearch::common to a profile

c3fd610e30-+-Apply role memcached to the new mc1* hosts

6af7466a42-+-Puppet: do not deactivate hosts in PuppetDB automatically

fd0e2734c4-+-role::cluster::management: add profile::conftool::client

fdd1d45caa-+-cache_upload: lower keep from 3d to 1d on upload backends

46d809e573-+-base::puppet: actually install run-puppet-agent

2f0332e51f-+-base::puppet: add puppet helper scripts

a6fc62e414-+-Revert "base::puppet: add puppet helper scripts"

d320ea9795-+-base::puppet: add puppet helper scripts

bcb6a03224-+-Switchdc: add profile to install and configure it

1827a20b1f-+-mediawiki: use mw_primary for jobrunner, cronjobs state

43c7024bd4-+-Revert "Revert "Revert "Add the LVS blocks to url_downloader"""

cc4acabce7-+-Revert "Revert "Add the LVS blocks to url_downloader""

105953dafe-+-url_downloader: convert to profile/role

6d9be03edb-+-site.pp,linux-host-entries.ttyS1: Remove db1057

62af6c0766-+-hhvm: kill a precise reference

d05c7baed4-+-nfsclient: Enable lookupcache by default for all nfs client instances

dfdbaa2c13-+-keystone.conf:  Define labs_osm_host

824efe58bb-+-package_builder: remove precise support

10b6c009fc-+-Update analytics-cluster refinery cron

3c8aae250c-+-puppet: remove fail() guard for precise

f1cabc39c8-+-ssh: update comments to remove precise mentions

62ac0131b0-+-Revert "certspotter: Silence the cronspam"

bcc282edbe-+-certspotter: Silence the cronspam

3b0b35c99e-+-maps - collect OSM sync lag to prometheus

d073760a6a-+-instance-info-dumper:  Use mwopenstackclient rather than the nova client directly.

35597d9152-+-Revert "disable full dumps cron job for a bit"

20540ac537-+-add new config settings for en wikipedia dumps

246608cbb6-+-add new config options for dumps of big wikis

61b15a211b-+-tools: persistent iowait issues

064c36ba32-+-disable full dumps cron job for a bit

e068986a86-+-elasticsearch: remove precise support

20b60f3d5e-+-Revert "parsoid-testing: add logrotate"

f700788cbb-+-parsoid-testing: add logrotate

be00a58da5-+-tools: Automount useful credentials onto containers

40713adc2b-+-labs-ip-alias-dump.py: Use novaobserver creds rather than novaadmin

ca76ca67d4-+-labs-ip-alias-dump.py:  Use keystone api v3

cbd19b81d6-+-k8s: Use packages everywhere

ff6141c7b7-+-ci: remove precise support

85d918c846-+-mariadb: Deprecate precise repository usage

21d70d0cd6-+-Prepare analytics1027 for decommission

b75609acbc-+-toollabs: remove precise support

932026ff36-+-openstack/nova: remove precise support

a12e3fb759-+-aptly: remove special case to remove multiarch support on precise

5fa5a63ea6-+-realm.pp: Remove the pre 3.5 puppet handling code

db67fc91c6-+-Remove redis from pybal-test2003

246ff29737-+-profile::cumin::target: add parameters/tags to allow easy selection

e8b5daab61-+-swift: increase max_connections for object server rsync

bfee7810ce-+-role::memcached: rationalize naming, split redis for sessions

185ff4634e-+-Default /etc/elasticsearch to 0755

a18cbb014f-+-base: sysctl/check_puppetrun: remove precise remnants

776a6ed14c-+-role::memcached: refactor in multiple profiles

a158484096-+-noc: remove precise support

dd5b2ce3f8-+-ganglia: remove precise support

2563cd95e9-+-dns_floating_ip_updater:  Use novaobserver instead of novaadmin

0631a4df8c-+-dns-floating-ip-updater.py:  Use keystone api v3

68c1d8d8f1-+-Revert "Make Thumbor connect to Swift via https"

577d7e6d12-+-postgresql - fix tests

3cb1d6a34f-+-Include nova's policy.json along with all services.

419500d6af-+-Make Thumbor connect to Swift via https

7545d070e7-+-profile::mediawiki::jobrunner: move role to profile, unify videoscalers

d4e7946a6c-+-role::mediawiki::common: convert to profiles (step 2)

7ab548577e-+-motd: remove precise, add comments for stretch

7a3c856426-+-postgresql - package management has moved to postgresql::server class

12fbcad971-+-postgresql - simplify creation of databases

7f73e358b2-+-Remove unused statistics::rsync::webrequest class from statistics::private

46a097336f-+-Revert "postgresql - simplify creation of databases"

0e025b3235-+-postgresql - simplify creation of databases

ddb82a11ca-+-role::mediawiki::common: convert to profile (step 1)

106e922b38-+-Attempt to run apt-get update before proceeding with installing cdh packages

3ff73d3f82-+-role::mediawiki::common: extract scap::proxy to a profile

79d48d1d8f-+-Cirrus / Analytics - remove deprecated rsync job

8c64b9b81b-+-mediawiki: remove Precise class packages::legacy

d33fac654f-+-Nova:  Remove unused rsync server

98c467e52f-+-Mariadb: Move remaining non-module files to the module

07302865cb-+-Nova fullstack test:  Increase timeouts

f96013b6f3-+-varnish: refactor all clusters for active/active

7c3ae6d7eb-+-Stop copying cirrus UserTesting logs to analytics

fe32a74f9e-+-rancid: back up /var/lib/rancid

1f7dcffaba-+-url_downloader: remove precise squid config

802698b683-+-osm: remove "if os_version('ubuntu <= precise')"-stanza

2521bfbf01-+-Nova: Remove wikistatus callbacks and support code.

f577d9e80d-+-service::node::config::scap3: fix path of executable

98831e159a-+-service::node::config::scap3: exec reload as the deployment user

07a28de1a2-+-swift: add ms-be1028 -> ms-be1039

4b8ceaa423-+-netmon: post jessie reimage fixes

888fcf5080-+-parsoid: fix key lookup in etcd

297846a5eb-+-service::node::config::scap3: further tweaks

2c2fe7ecb2-+-service::node:config::scap3: fix dependencies

3d4e650849-+-service::node::scap3: fix confd declaration

229b600b2a-+-parsoid: add ability to use confd to configure active/passive

c30c1227dd-+-parsoid: make config management independent of service::node (take 2)

6ca69db3f7-+-parsoid: make config management independent of service::node

2656854852-+-service::node: refactor configuration, allow use of confd for scap3

b26331bee1-+-tlsproxy: simplify prometheus metrics gathering

17d7a8f76c-+-Uninstall eject on jessie onwards

f2ecde480e-+-toolschecker: Update nfs showmount check to test secondary cluster

af0d7dab5d-+-decom ms-fe100[1-4], remove from DHCP and puppet

111ad6031c-+-service::node: Do not use the proxy by default

8274209b72-+-mariadb: Decouple labsdb mariadb role (deprecated) to a separate file

97c38b35ad-+-Move hue.w.o's backend to thorium

69d243535f-+-role::mail::mx: switch do discovery host for MW API

34acf17716-+-logstash: Filter ORES logstash messages and set port

7123b110ea-+-parsoid::testing: use discovery host for MW API

0fbdd24f65-+-service::configuration: use discovery host for MW API

eda04b90ca-+-misc-varnish/parsoid-tests: remove parsoid-tests backend

3791ad589f-+-Prune old druid request logs

75e6ee699a-+-Need minute => 0 on daily cron job

ada355ff86-+-Add cron to prune old druid indexer logs

94d8522247-+-realm: remove rb_site

0f571dcc92-+-Add simple proxy for hue.w.o's backend on thorium

988075843f-+-prometheus: fix PDU detection and snmp_exporter config

a37e71d38a-+-add PDUs jobs to prometheus

18d4db1a08-+-Update mwgrep for elasticsearch 5.x

2fbb9cf745-+-redis::monitoring: convert ores to nrpe, cleanup

7b6db39ef1-+-Defaults value for profile::docker::builder hiera

5591e44b0e-+-Revert "realm: remove rb_site"

8abfa12923-+-realm: remove rb_site

95c105b91a-+-contint: install PhantomJS from backport

c14146dd79-+-realm: get rid of more entries

6ce831963c-+-mariadb-core: Decouple Mariadb semi-sync replication from $::mw_primary

2f8829e876-+-realm: remove parsoid_site, switch to discovery.

539b3bff39-+-varnish: remove varnish::monitoring::ganglia

1354671a97-+-redis: cleanup unused modules/files

1c8bde9340-+-Move Hadoop cron MAILTO from singe person to analytics-alerts

d0f4210313-+-bootstrap_vs:  Don't install cloud.cfg

74ea792aaf-+-Visualdiff: Install mediawiki::packages::fonts

e9839b4354-+-Fix references to the performance-team

a8da428e59-+-profile::redis::slave: use auth settings in the instances

b09dd8f663-+-profile::redis::slave: fix parameter extraction (again)

3630e64e1c-+-profile::redis::slave: fix parameter extraction

2b0c3585a5-+-profile::redis::multidc_instance: fully qualify puppet nonsense

36d838c1b8-+-role::jobqueue_redis: convert slaves to role::jobqueue_redis::slave

f5a6f351c8-+-profile::redis: add local master and slave profiles

923ce59cca-+-bacula::client: remove Exec['concat-bacula-keypair'] dependency

da92e5567e-+-Update bacula::director to use base::expose_puppet_certs

67ce2d9aa2-+-Update bacula::storage to use base::expose_puppet_certs

13c0ac0d02-+-Update bacula::client to use base::expose_puppet_certs

9d3d5d42d3-+-base::expose_puppet_certs: Also provide a keypair

3a441f1da2-+-Direct output of accountcheck to standard root mails

33ec87043c-+-profile::redis::multidc: re-introduce the ipsec guard on trusty

401973ab7f-+-Performance Grafana alerts

c055f4818e-+-role::memcached: add hack (temporarily) for deployment-prep

4aec8b0585-+-Nova compute:  Update kernel advice for new installs

1cc75c17b1-+-postgresql - drop support for postgis 1.5

04f0587d2a-+-Re-enable updateSuggesterIndex cron

36293c8b72-+-role::puppet_compiler: fix broken inclusion of a removed class

a616f5c652-+-role::memcached: convert to use profile::multidc::redis

a064ff0d28-+-bacula: add /srv/librenms to librenms backup file set

e3f49a0ad4-+-librenms/smokeping/torrus: add Bacula backup sets

594b067e3f-+-labtest: convert labtestmetal to labtestvirt2001

69f6a193c1-+-Make sure analytics_cluster::apt is required before other packages are installed

72f3435750-+-Install and run hue on throrium

b4a3472324-+-Move camus jobs from analytics1027 to analytlics1003

1c63a21e26-+-Move hdfs balancer from an27 to an03

829ee98e16-+-profile::redis::multidc: generic profile for redis cross-dc replica

88ca101a98-+-Move data_drop and hive::site_hdfs roles from analytics1027 to analytics1003

1eaa6dbb9f-+-Direct LDF requests to single host to solve paging issues

74c7486514-+-profile::jobqueue_redis::master: refactoring

2b826a5578-+-Use 3 parallel sqoop processors instead of 5

4405d8cb86-+-role::jobqueue_redis: deprecate in the current form

7ea35af26d-+-site: move all jobqueue redis masters to the new model

866d420f63-+-Followup increasing client_output_buffer_limit

4ab19a13cc-+-Enable cqlsh client encryption

6de9d33154-+-Failoid: reject all TCP traffic

b25fc62c13-+-Increase client_output_buffer_limit soft limit

ad53b1e3e3-+-site: convert rdb1007 to the new role

77e3c359e1-+-site: switch the other codfw masters to the new code

52cdfd0dc6-+-Failoid: add service to reject connections

1131a7f660-+-Revert "service::uwsgi: Remove the log-route directives"

df28e24664-+-service::uwsgi: name the local logger

d6eb91731d-+-profile::jobqueue_redis::instances: add explicit dependency

6e8b68f892-+-Enable systemd-timesyncd for all Debian systems

90813ebf3c-+-redis::monitoring::nrpe_instance: fix resource name

e17f96946e-+-redis::monitoring::nrpe: add package libredis-perl

04afea4a37-+-profile::jobqueue_redis::instances: fix uid/gid for confd::file

27929f8dfa-+-profile::jobqueue_redis::master: include redis::passwords

61514492c9-+-role::jobqueue_redis::master: depend on etcd, not mw_primary

e87cd34d17-+-Pass Junos as the os for all networking devices

724be731a7-+-Add an os parameter to netops::check

142689fe04-+-Add an $os parameter to monitoring::host

cafecc8c53-+-osm: Specify the prometheus_path variable correctly

294c0ec8fc-+-prometheus: keep more chunks in memory

1d4f089b1f-+-bacula: add file sets for librenms,torrus,smokeping

777189ce11-+-netmon1001: add host to Bacula backups

2117253a0e-+-netmon1001 migration: additional paths to backup

d77266926a-+-netmon1001 migration: separate rsync modules for each app

c5ec2e53a2-+-Gerrit: Move master/slave detection to profile

797205f062-+-Revert "Revert "labstore: keep archival copy of dynamic export.d contents""

e38c88f2f9-+-Revert "Revert "labstore: apply exportd monitoring to secondary role""

484eae9175-+-Revert "labstore: apply exportd monitoring to secondary role"

e68931d845-+-Revert "labstore: keep archival copy of dynamic export.d contents"

df1545a31b-+-Fix typo in refinery data-drop for cirrussearchrequestset

f463847a7d-+-labstore: apply exportd monitoring to secondary role

d5a2d50d7c-+-Drop mediawiki logs in HDFS after 90 days

628069ab99-+-labstore: keep archival copy of dynamic export.d contents

5b127a4299-+-temp copy netmon1001 app data to gerrit2001 for migration

17dcc820a3-+-graphite: cleanup eventstreams rdkafka stale data

c41a3b18d9-+-Revert "Set cron script to dump MediaWiki DB lag times into statsd"

6de718225a-+-Add -k $num_processors arg to sqoop-mediawiki-job

94a5db45ee-+-Set cron script to dump MediaWiki DB lag times into statsd

b177657f4e-+-Add analytics labsdb pw in hdfs, add logrotate for refinery logs

121a1130b8-+-authdns: remove redundant relationships

f9188e86dd-+-authdns: never restart gdnsd, keep initial install working right

c09e99ee81-+-librenms: use base::service_unit

a8e48d3115-+-s/day/monthday/ in sqoop_mediawiki job

f6667aaebb-+-Load wiki project namespace map into HDFS weekly, sqoop mediawiki monthly

6777db66c0-+-maps - remove the pinning of nodejs version

cd9c679b1f-+-postgresql: Only set user password if different

dad3878732-+-realm: remove graphoid_site

e1a1007ff8-+-site.pp: add gerrit2001 with just standard and IPv6

5ac9e0ddb0-+-Contint: Allow new host gerrit2001 connections as well

4d3853c12c-+-Gerrit: Make $host required, rather than optional then failing

8b12803c14-+-gerrit: convert to profile/role structure

40a8699d18-+-testreduce: Migrate away from parsoid-tests.wikimedia.org

a7bab28c95-+-Revert "Scap3: Prep MediaWiki to be available from /srv/deployment"

7a2845cc56-+-Scap3: Prep MediaWiki to be available from /srv/deployment

c137201b70-+-netops::check: Add a parents attribute

888a403ba2-+-Add Blazegraph options for proxy config

d14038b1ce-+-fix spare::system

f29a5df661-+-swift: decom ms-fe100[1-4]

1b2c48c1ce-+-postgresql - require postgresql / postgis packages for spatialdb

7e43ba43c1-+-nfs-exportd:  Refresh service if script or .yaml changes.

78457c8127-+-k8s: Fix another typo while eating hat

a57c4fb10f-+-k8s: Fix typo

e966211ef1-+-Switch phabricator search to codfw

16657b1a77-+-tools: Use k8s master profile in role

4cbe2be909-+-labs: Add openstack::observerenv to all hosts

7ddbd96105-+-k8s: Make kubernetes master profile flexible enough for tools use

f7d0d26e9a-+-tools: Use profile::kubernetes::node for worker role

4c1ed5054a-+-Enable diffserver on ruthenium to view visualdiff images

f0008fb571-+-Enable mcrypt extension on CI slaves

8963bc36f2-+-openstack::clientlib: require ::openstack::repo

b5c0890e20-+-Change osm master to be labsdb1007 on configuration

70e2c272dc-+-site: add prometheus200[34]

ee92be78ac-+-Change the redis slave client_output_buffer_limit

e3ee99ceca-+-statistics/cruncher: Add reportupdater job for edit-beta-features

b667a9fd48-+-fix typo on en wiki dump config

706796dcef-+-contint: remove Precise related switches

fd2b78fec1-+-monitoring::host: Add the parents attribute

5f38337f2e-+-osm: convert labsdb1006 into an osm slave of labsdb1007

376967ec57-+-wdqs - wdqs package has been replaced by scap configuration

2d2cc4c10e-+-wdqs - remove trebuchet based deployment

3f73e0ceb6-+-Amend "Revert "nagios: Specify a parents host relationship""

1abb60d971-+-netops: Remove domain names from iciga definitions

335fa996f3-+-keep fewer xml/sql dumps

4f74f3ddc5-+-decom ms-fe2001 through ms-fe2004

b26323694f-+-service::uwsgi: Remove the log-route directives

b5870f2429-+-service: Send uwsgi logs to logstash

b960a79d04-+-wdqs - make nginx ports configureable

5b8ad80dd2-+-contint: drop a hack for python PIL

ff423bdb3f-+-toolschecker: remove precise checks

b9550d4661-+-osm: Change osm master rsync check with different parameter order

c713d8e5bd-+-wdqs - remove unneeded puppet dependency

6980fe6ae4-+-RT: convert to profile/role-model

5377682b95-+-microsites: convert to profile/role-structure

92544e7d81-+-tor: convert to profile/role-structure

0d4c9bbfd5-+-Revert "nagios: Specify a parents host relationship"

178d9a3061-+-nagios: Specify a parents host relationship

4749609fa9-+-cache: different parity for start/end ip_local_port_range values

f3709e6e7e-+-Install python-phabricator module

0f8a730eeb-+-Set up sync for icinga state between hosts

fd406983f0-+-rm manifests/microsites/peopleweb/migration.pp

486ee04406-+-gerrit: rm role class gerrit::migration

d16833233a-+-Move db1067 from s2 to s1 as a db1057 replacement

8fae54aa6e-+-Cassandra TLS configuration for RESTBase

735418b24e-+-Remove role::lists:migration

c67df6c7a5-+-varnish/misc: add parsoid-rt-tests (was: rename parsoid-tests)

8e8e72f833-+-varnish/misc: add parsoid-vd-tests -> ruthenium

5e8e86566a-+-prometheus: fix file permissions and servertech template

ddd6cd3618-+-tools: Set k8s service IP range to new range

4da60de042-+-elasticsearch - statsd plugin isn't used anymore

725cea72fe-+-wdqs - set heap size for blazegraph from puppet

66dbfcea0e-+-Add network::monitor role

6e7dc38466-+-prometheus: add snmp_exporter module and profile

93b23a2a4b-+-Ensure that all the Cassandra dirs are created after related user/group

5133288534-+-prometheus: adjust storage retention

07ec3dc428-+-Remove salt grain "php" from mediawiki hosts

d4b61f05b3-+-statsite: ignore spammy messages

d11961daf3-+-planet: convert to profile/role-structure

d6225a628f-+-Rename ferm service in role::labs::db::replica

2550329d15-+-Move keystone icinga checks to nrpe on labnet1001

547ba6ec61-+-Phabricator: add config for elasticsearch 5 in codfw

ee96489a16-+-webperf: Update navtiming.py to use eventlogging instead of zmq

6487a79489-+-webperf: Use trebuchet install of eventlogging for ve.py

dd6d7e6fd2-+-tools: Turn precise reminder cron off

bd715ac940-+-Fix prometheus OSM sync lag exporter cronspam

7cf748cca8-+-Disable updateSuggesterIndex cron take 2

ac66cab49a-+-osm - append to log file, dont replace it

5960b2a6db-+-Revert "Revert "facilities: add codfw PDUs""

1af5b1b78c-+-osm - correct waterline import logrotate configuration

3b4e17c0fa-+-Revert "facilities: add codfw PDUs"

22c58af852-+-Ruthenium VisualDiff: Test w/ local Parsoid instead of prod Parsoid

a8ae74c26a-+-facilities: add codfw PDUs

c9b6b2271a-+-Disable completion suggester update jobs

700070ea93-+-Remove mariadb submodule

263084a5f0-+-zuul: monitoring should discard forked git-daemon

5075d3bab1-+-cache_misc: set timeout_idle to 120s

add053e056-+-Provision new ms-be machines in codfw

b018ec0afb-+-mariadb: Decouple db proxy role classes to separate files

28bc35904b-+-Revert "cache_misc: set timeout_idle to 120s"

c8e94438f2-+-cache_misc: set timeout_idle to 120s

1066283855-+-Setup "bot" credentials file for Phabricator support in offboarding script

0be31f6da0-+-facilities: add row and site parameters for pdus

dfa230a856-+-Send thumbor process age to statsd via cron

77ed3b2f38-+-contint: Zuul no more interact with Jenkins

420e97e7a1-+-mediawiki::maintenance: ensure /etc/wgetrc is file, not dir

66a9e68c7e-+-mediawiki::maintenance: provision /etc/wgetrc

8a7bfaef21-+-Nova:  Remove our custom-hacked libvirt driver

25cd1dd922-+-Create new refinery/job directory and move refinery cron job classes there

17d0264299-+-mariadb: Decouple ferm mariadb common class into a separate file

04b55efbed-+-zuul: fix git-daemon monitoring probe

0a9868f944-+-contint: migrate git-daemon to systemd

a683a0052a-+-Add new MW appservers and api-appservers in codfw

39f9636afc-+-mariadb: Decouple maintenance mariadb role to a separate file

dbdbb06f43-+-mariadb: Decouple mariadb wikitech role to a separate file

04e4822c52-+-mariadb: Decouple core (mediawiki) role on a separate file

35981c78f8-+-Apt:  Remove an ensure->absent stanza

45a78f1b09-+-authdns: fix lint warning

f1a0cff86e-+-site.pp: remove fluorine (decom)

8afe74a89e-+-racktables: get rid of $realm-case, use Hiera for host name

9eba2d6b3f-+-planet: get rid of $realm-case, use Hiera for domain name

542a84f7b4-+-Gerrit: Remove reviewer counts cron, nobody is using it

b93d3120e9-+-udp2log: remove "lint-ignore" that has been fixed

a6bd603bce-+-mediawiki::logging: remove fluorine from firewall rules

0bcf0d050b-+-mariadb: Decouple tendril mariadb role to a separate file

fe3cad6692-+-elasticsearch - make size of bulk executor configureable

1a8cc25a05-+-Remove non-existing group from jupyterhub LDAP config

0d5b45eba9-+-Remove Piwik backend probe from Varnish Misc backends

631f6bad36-+-lvs: load ip_vs before systemd-sysctl.service starts

93fce80990-+-elasticsearch - use default plugins directory in the elasticsearch class

9653a36122-+-mariadb: Decouple misc role classes into separate files

3aa195b859-+-osm::planet_import: conditionalize load of 900913.sql

20fbe93f53-+-role::osm::common: Conditionalize tuning.conf inclusion

1cb1ceeaeb-+-site: use spare::system on fluorine

8116899d68-+-Promote labsdb1007 to osm::master.

5897b00c40-+-mariadb: Decouple beta role to a separate file

2ca149d3e9-+-mariadb: Decouple mariadb::misc role to a separate file

b9e4997d13-+-Phabricator: Migrate to base::service_unit for phd

5eda81123d-+-Add config for elasticsearch cluster

ba7dc81c44-+-Remove mentions of fluorine in old comments and descriptions

d63309b243-+-phabricator: monitor PHD service only on active server

3be604e145-+-Save logs of generate CAPTCHA cron to /var/log/mediawiki

d4fbb9f6bb-+-mediawiki::maintenance: Actually run generatecaptcha cronjob on 1st day of every month

db37a21c1d-+-mariadb: Decouple parsercache role to a separate file

d7afc59ca8-+-hieradata: make mwlog1001 primary log host

32cef38d27-+-maps - fix logrotate template

d9f992b86d-+-osm - waterline import script fix and adding logging

a5d5fafda7-+-site.pp: Enable ROW binlog for db1070

26d7c42e3f-+-Enable base::firewall in role::test::system by default

9957ea3bae-+-Revert "authdns lint support for full puppetized config"

4003082570-+-Revert "authdns: move hiera() down into module"

80103e9144-+-authdns: move hiera() down into module

d79dc31235-+-authdns lint support for full puppetized config

2d9fa45d82-+-Gerrit: lower heap to 20g

6bcff9d668-+-zuul: the deb packages creates /etc/zuul

abee3f43de-+-nova: up fullstack allowed pool to 7

488c4530df-+-Phabricator: Migrate to base::service_unit for ssh-phab

0a27d942ed-+-phabricator: fix file names of systemd/upstart templates

c32bd41ec6-+-Phabricator: Move sshd-phab.conf.erb and sshd-phab.service.erb into initscripts

65a3f0f98c-+-Enable local logging for RESTBase

9c8077bf77-+-mariadb: separate sanitarium2 role to a separate file

7f1052d620-+-mariadb: Separate sanitarium role && monitor it on prometheus

4ab302da64-+-Enable base::firewall on ruthenium

a562cba601-+-performance: create '/srv/org' directory

9373a04abd-+-Start refactoring of mariadb config template system

8ec4bf7331-+-Move tmpdir to /srv/labsdb/tmp to avoid filling up / partition

a4f7fe958f-+-wdqs: cleanup old GC logs

a689f1b7db-+-Add more metrics to Blazegraph monitoring

6af99b8c10-+-Assign scb2005, scb2006 their scb role

754d908698-+-hieradata: add oresrdb in codfw

ea380fe01a-+-delete unused bastionhost::migration class

139be53368-+-site.pp: remove bast3001 (decom)

4b6f03153c-+-toollabs: Preparing to move `/usr/local/bin/crontab` to labs/toollabs

1071a6f6cc-+-zuul: typo in Icinga monitoring probe

62dd0f2271-+-Change Zuul Gearman alarm to a simple threshold

832e283616-+-bast3001: remove from network/constants.pp

2609315fae-+-Add ferm rules for ruthenium

a45627c63b-+-Only pipe /v2/stream requests to EventStreams service, everything else can be cached by varnish

57a55806d2-+-labstore: Cleanup old/unused labstore1001 nfs related puppet files

1a938c47a9-+-nfs: Snapshot backup device on secondary DC before replicating latest from remote

e32016ee03-+-elasticsearch - plugin directory is managed outside of the elasticsearch class

c86cda25c6-+-elasticsearch - cosmetic: remove final / from symlink target

ae896222cd-+-elasticsearch - move management of plugin directory symlink to role classes

934e039f44-+-Revert "elasticsearch requires $plugins_dir to exist"

6d5da9f8f0-+-elasticsearch init $data_dir creation requires installed package

1afba3a851-+-elasticsearch requires $plugins_dir to exist

dcf18e59f6-+-paws-internal: Add apache ldap auth puppet dependencies

d1ddcf524e-+-paws-internal: Add support for serving static files authenticated via ldap

58df6cf8b8-+-Revert "icinga: set IP for benefactorevents/eventdonations to 127.0.0.1"

30d5dce884-+-jenkins: pass access args to jenkins, not java

07c8bb1ab3-+-jenkins: migrate to systemd

51247c6ba3-+-contint: slave role for Saucelabs jobs

0be7e244ff-+-icinga: set IP for benefactorevents/eventdonations to 127.0.0.1

d88944da5c-+-nova: fullstack test increase allowed time to SSH

6b58c6e378-+-site: remove alerts from graphite2001

1616379429-+-profile::discovery::client: change key prefix

c030f9192a-+-profile::discovery::client: expose services as well

464d796fb9-+-role::mediawiki::webserver: add access log to tlsproxy

5a5177ac33-+-pybal::configuration: explicitly set the conftool prefix

5edf8b4535-+-Linting fixes (multiple modules)

1f6466809c-+-bast3002: remove bastionhost::migration role

b3d3dd6c3d-+-bastion: rsync home dir data bast3001->bast3002

091ccb63a8-+-bast3001: fix spare class role name

c2f5153da3-+-bast3001: remove puppet roles, add role::spare for decom

d7033cace2-+-pybal::web: fix dc directories

e85a25c9a6-+-profile::configmaster: remove redundant prefix definition

3d0411d74d-+-pybal::web::service: fixup

42bd5762d1-+-role::puppetmaster::frontend: include profile::configmaster

563d2aedb3-+-dns discovery: separate map

724047ec2a-+-archiva.w.o ssl check changing to LE interval

f3a63d49b7-+-dns discovery: watch_keys is an array

73a353f2a8-+-dns discovery: add the data to authdns::testns too

2544943dd5-+-DNS: service discovery

07acfad636-+-Script for offboarding a user from LDAP

00602c547e-+-Fix the Zookeeper JVM Heap usage alarm

5f0bdd1bfb-+-pybal: remove pool, unused anywhere

0ea30a90d3-+-profile::conftool::client: use conftool_prefix

2e4502daf8-+-Add experimental JVM Heap usage alarm to Zookeeper prod instances

2128a742ff-+-Provision ms-fe100[5-8]

82b03bb194-+-profile::discovery::client: create confd-generate files for discovery

2d44a7e747-+-tlsproxy: add prometheus support

648440b4a1-+-tlsproxy::localssl: add ability to have an access.log

5c216f72e7-+-Decomission ms-fe200[1-4]

708230c11e-+-confd::file: fix circular dependency

5c48180996-+-confd: add ability to define a global and per-template prefix

33641e198c-+-contint: remove ganglia diskstat plugin

96ef6c6fea-+-lvm/lvs: Linting changes

6cbb15149b-+-Linting changes for docker/etcd/kubernetes profiles

c8530ae999-+-openstack: Linting changes

b6b72229db-+-webperf: Remove unused deprecate.py

98f48e214b-+-Scap: update version to 3.5.3-1

cdd6444c5c-+-mediawiki: Add cache-warmup to maintenance

522e7e07d8-+-Zuul: Add quotes around running for git-daemon service

016d3ac6d8-+-lists.w.o : updating a new LE interval check for smtp certificates

7509569459-+-maps - fix nodejs 6 version

7d25d1aeef-+-nova: fullstack test give 480s before failing on creation

5d530e33e9-+-Remove last settings for mc2001->mc2016 from puppet

204c51e736-+-contint: drop npm settings for precise

7dfda6a6b7-+-mariadb/prometheus: remove workaround for precise

5dec01acf1-+-maps: make version of nodejs configurable

02bcf7e6de-+-Configure analytics cluster nodes to use thirdparty/cloudera apt component

f7dd94a5cb-+-prometheus: fix ferm rules for rsync and add IPv6

b54ff70082-+-prometheus: temporary rsync server for metrics migration

2f4cbdaa06-+-install/prometheus: add prometheus::ops to bast3002

a7710ec214-+-install/bast: move tftp server from bast3001 to bast3002

65a5de7f16-+-ganglia: move esams aggregator from bast3001 to bast3002

8e3add4bdc-+-add bast3002 to network constants

2ccf643e65-+-nova: monitor for fullstack test daemon

051eefbff5-+-labstore: Use explicit groups for file resources

b483ca8364-+-Reorder check for timesyncd or ntpd

e9da17d739-+-Kill ubuntu.wikimedia.org legacy hostname

aea690383d-+-profile::conftool::client: add default schema

a2cc78096c-+-role::mediawiki::webserver: adapt to new conftool-data structure

4ee863e4cb-+-Set maximum JVM heap size for Zookeeper

7c91c3e7f2-+-dhcp/site: add bast3002

d07e915274-+-role::pybaltest: fix compilation

b6df73984a-+-profile::etcd::replication: also remove the hiera lookup

fad9b21cf4-+-profile::etcd::replication: use passwords::etcd

682dd3ff8c-+-role::pybaltest: include profile::conftool::master

d470291397-+-Tune JVM Heap size alarms for Hadoop daemons

699d62f574-+-profile::etcd::tlsproxy: use passwords::etcd

e1edf8b98a-+-conftool: remove base class, useless in the refactor

1742eb7156-+-cache: allow specifying applayer backend probes and probe piwik

11924c9a87-+-role::conftool::master: remove as it is unused

99bcdab9c9-+-Cumin: authorize also cumin masters IPv6 addresses

dcd77a3e21-+-labstore: Install package nethogs from jessie-backports

10bc9bc416-+-Tools: Fully qualify hostnames

12fd6e4400-+-Keystone:  Don't remove the upstart script for liberty.

bd53de5050-+-varnish: move applayer be_opts defaulting into template

78d7b20e4e-+-Keystone:  define uwsgi services even if not running

987bff1469-+-Keystone:  Go back to using eventlet for Liberty

89c95ae5f2-+-lists: use LE cert for exim (let's try again!)

f87e6999b8-+-Revert "lists: use LE cert for exim"

a58dca49a3-+-Revert "Bugfix: group name does not have 4 at the end"

4daa11a623-+-Bugfix: group name does not have 4 at the end

677316aea2-+-lists: use LE cert for exim

36e3dce7bc-+-LE: allow non-root key ownership/perms

6be87e7434-+-role::puppetmaster: use profile::conftool

464a84d68a-+-tlsproxy: Lua support

744790aa0a-+-Fix output path for stat1002 reports

39c9bb8473-+-nova: remove fullstack circular dependency for upstart

409aa8f395-+-nova: fullstack test dupe resource removal

496fc60eec-+-profile::conftool::client: first commit

99ef86ae0e-+-nova: run fullstack test suite on current labnet

ea624ea028-+-labstore: 1001 and 1002 are currently idle

9abfeeeeb4-+-elasticsearch: force the creation of the plugins directory symlink

e0cbd0a784-+-conftool: add namespace support

a2f7afb3c0-+-Disable unpriviled access to perf subsystem on Ubuntu hosts

83c6145fac-+-coal: disable uwsgi autoload

6d724426dd-+-uwsgi: parametrize service settings

1d22801317-+-k8s: Install socat on worker nodes

9787ffe723-+-Phabricator: Add systemd template

5d963f5da9-+-systemd: update class name in a fail() error

2325ca6455-+-Mirantis repo:  Make the apt proxy version-sensitive

91f551c6b9-+-Cumin: enable ferm service only in production realm

09fb0168c8-+-Cumin: include cumin::target only in production realm

968720e59a-+-swift: terminate https with nginx

1d8a92fb65-+-tlsproxy: add nginx_bootstrap define

aac57a0b99-+-realm.pp: Add __wmf_checksums table to be ignored

ddc94132a3-+-Readd base::firewall to multatuli

0a4626ad8e-+-prometheus::class_config: properly escape and build the puppetdb query

0258e31971-+-Move three codfw MW appservers to jobrunner/videoscalers

38b2108c57-+-prometheus::class_config: fix error in query building

c2f2647bbd-+-jenkins: allow changing the web service TCP port

ec374af8b4-+-jenkins: allow access log to be flipped

1bf2ec9abb-+-Revert "jenkins: allow access log to be flipped"

6c9cdc54a8-+-jenkins: allow access log to be flipped

016b062a7d-+-prometheus: add etcd metrics

3e548232c5-+-Add the Apache Prometheus exporter to bohrium

b882bcc801-+-graphite: split checks for carbon-relay frontend/local drops

15358e1457-+-Tools: Enable PHP module mcrypt on Trusty execution nodes

21b4d98f0b-+-sshd-phab service config needs to be a template

50e08d1031-+-openstack: nova_fullstack_test changes to daemonize

6828f5a32a-+-install: remove carbon from puppet

d455e83b53-+-install: allow rsync of /home from carbon to install1002

a61e89d69b-+-labstore: Fix sudo permissions for directory size diamond collector

c47bb22074-+-labstore: Read directory size diamond collector config from external file

ee250fba28-+-diamond: Allow providing puppet file reference to collector config file

c0cdc62054-+-Symlink reportupdater output to published-datasets

1d66c9a90a-+-Cumin: fix ferm service srange

bf7430edc9-+-Cumin: allow connection to the targets

d94cdb3218-+-role: install apache mod_proxy_http

ec6774c131-+-mariadb: rebase module to the latest version and separate labs pass

30a6cd6333-+-cache: move graphite/performance to graphite1001

37b6c4f369-+-elasticsearch: do not manage plugin dir yet

503babe177-+-elasticsearch: do not manage plugin directory yet

ba961ae4b5-+-Update elasticsearch module for es5 compatability

9a2a396f04-+-ldap::client::utils: Move to require_package

f25a67e0d8-+-mirrors: update archvsync to 20170204

64ffe51c93-+-Move the Diamond NTP collector to ntp::daemon

9d0822e668-+-Revert "diamond: switch to graphite2001"

a578e0dea9-+-Fix typo in realm.pp

406ec83a9e-+-dumps: Centralize CSS in one file, make it wider and apply to more files

0bc9640bb3-+-k8s: Attempt to fix puppet circular dependency cycle

d20d79b768-+-k8s: Fix puppet resource conflict that is absolutely stupid

c51e1b9d6e-+-Revert "tools: store verbose logrotate logs"

afe23ea49b-+-tools: Allow setting up k8s master without tools star cert

45a77beaf8-+-toollabs: Update tools.wmflabs.org links to use HTTPS

222c1f7234-+-udp2log: add python3, fix udpmirror perms

36098c322f-+-udp2log: mirror traffic via udpmirror.py

3d88ff1eab-+-package_builder: install debian-keyring

eccacafc19-+-jenkins: support umask via service default

5e4a58173a-+-jenkins: support variable prefix setting

fe68d1187a-+-scap: upgrade to 3.5.2-1

37480fc51f-+-Swap from protocol-relative urls to https everywhere

0212950844-+-Drop require_package for python-ldap

cd2557fbc5-+-Add account validation script / cron job

b0fa0acec5-+-contint: remove /srv/ssd

75131bbd5a-+-Revert "contint: git-daemon service is 'sysvinit'"

40bbe4363a-+-contint: git-daemon service is 'sysvinit'

72c48d8dd8-+-phabricator database: Move templates to the role

f9a2423817-+-zuul: use a proper require for the merger class

f63a417452-+-varnish: tune check_varnish_expiry_mailbox_lag alerting thresholds

2adedca931-+-Only add the Diamond collector if ISC ntpd is used

81af0204fc-+-Revert "zuul: point queue alarm to proper Graph panel"

3fe066355c-+-Update mwdeploy group sudo rights for jessie

abd67a403f-+-zuul: pass ensure to the queue graphite_anomaly

ca9dca5dbd-+-zuul: point queue alarm to proper Graph panel

16f845f019-+-zuul: tweak Gearman queue alarm

4177fc8acf-+-jenkins: logrotate all log files

c390690b7d-+-zuul: monitor Gearman queue growing out of control

53673bb4b7-+-HAProxy: move templates under the role

42a304061c-+-contint: /var/lib/jenkins/builds is no more

89620082c6-+-jenkins: merge user/group sub classes

2d77f71492-+-Fix heapsize alert conditionals so that they work in labs

74d771ac1c-+-Upgrade toolsdb master to mariadb10

b3c4f00502-+-tools: Read list of tools for precise email reminder from precise-tools dashboard

40edf8c271-+-mariadb: Fix typo on parsercache && labs after template move

e0fa5121ab-+-varnish: fix path to icinga check for expiry mailbox lag

a57a8fba34-+-mariadb-sanitarium: move custom init.d under the mariadb role

cd6c3a236e-+-varnish: icinga check for expiry mailbox lag

bb021078cb-+-Revert "Revert "mariadb: Move grants and mysqld config files to the role""

c8e65ddd72-+-Revert "mariadb: Move grants and mysqld config files to the role"

03515f0abf-+-mariadb: Move grants and mysqld config files to the role

bba2dd7e88-+-Make the experimental archive section generally available

ad088ca006-+-udp2log: fix mirroring of received packets

ad2194f669-+-elasticsearch: adding new servers elastic1048-1052

d78b68c887-+-tools: Upgrade docker on tools k8s workers

acf1ec6587-+-lint: 'include standard' -> 'include ::standard'

8357b7bd08-+-aptrepo: rsync the entire /srv/ automatically, not just /srv/wikimedia/

49a7ad2a40-+-quarry: Linting changes

3754de00ee-+-lint: 'include base::firewall' -> 'include ::base::firewall'

06cfc91c04-+-labstore: Fix sudo priveleges for user diamond

08066cd348-+-labstore: Diamond collector to track directory sizes

8a386e4d99-+-Use --partition-type hive for refinery-drop-wdqs-extract-partitions job

ba847602a3-+-Drop wdqs_extract partitions older than 90 days

aaca189947-+-Horizon:  add explicit "!" policies for unsupport services.

06552167a4-+-udp2log: mirror traffic from mwlog1001 to fluorine

3ce61fd5af-+-Reporting tests with the private data script

dc32ba50d2-+-Move mw224[45] from appservers to imagescalers

6df5a5900e-+-Fix and tune the new Analytics Hadoop alarms

5601b62e5b-+-Change role to mw222[123] (appservers -> api_appservers)

90986c5413-+-Only run the timesynd_ntp_status Icinga check every 30 minutes

b6c18a1388-+-Revert "Testreduce: allow to decide the state of the services"

7a1b26ecd4-+-Revert "Revert "Add JVM Heap usage alarms for basic Hadoop daemons""

6f9c214be6-+-diamond: require $handler to be defined

5c04d25eee-+-stdlib: upgrade to 4.15.0

e38eb5a3ee-+-install: correct spare role name for carbon

797dd0d66d-+-install: remove roles from carbon, demote to spare

1321bdf11c-+-Remove openstack::clientlib from icinga hosts

96c88998af-+-CI: decom scandium

fccf34ea9a-+-WDQS - move metric collection to diamond

f389a3242f-+-WDQS - move metric collection to diamond

b1bfa597ac-+-coal: run on jessie

29d2cac1d4-+-add prometheus1003/1004 to site.pp

e94b69cf32-+-varnish: remove ganglia vhtcpd python module

cde1a1508c-+-salt: use SHA256 master key fingeprint on newer systems

13272de00f-+-Toollabs:  Remove zsh from package list

29dceeefa4-+-Replace 'zsh-beta' with 'zsh'

d568472497-+-remove install1001/install2001 from site.pp

85f7dd2831-+-Include geoip on refinery hosts

ba5b3232b8-+-Remove zuul-merger from scandium.eqiad.wmnet

141cb402a9-+-prometheus::class_config: allow new selections for prometheus

5a3a7f786b-+-graphite: move alerts to graphite2001

a9bfafd0b1-+-profile::etcd::replication: attempt not to confuse icinga

b9074d8b27-+-profile::etcd::replication: lag can be negative, quotes

7e1eee45c5-+-profile::etcd::replication: fix monitoring port for icinga

abb53c35b3-+-varnish: remove ganglia python module

28acc931eb-+-wdqs - icinga process check more relaxed on arguments

09dc659f1b-+-profile::etcd::replication: refactor to make failover easier

099bdca297-+-ganglia: switch codfw aggregator to install2002

377a9bb456-+-ganglia: switch eqiad aggregator to install1002

5a6b5c5d87-+-zuul: ensure /var/lib/zuul/.ssh exists

e4557c39a8-+-Add zuul-merger on contint1001 and contint2001

f7563039a4-+-icinga: remove pre-jessie conditional from monitoring::group

08a528bdb6-+-apt: config a proxy for mirantis only where needed

04b74d4165-+-Need to change git-fat version in trebuchet::packages too

c074ba1c0d-+-Need trusty/jessie in version number

94594c23ce-+-Fix git-fat version: 0.1.2-1

9db5f10c72-+-Ensuring explicit version of git-fat to upgrade to 0.1.2

ead65b72f7-+-icinga/base: add hiera override to skip base monitoring

7f533e968e-+-Split TMH transcode queue into two for prioritization

5d8ce88098-+-Assign role spare to mc2001->2016

e3e2152a66-+-diamond: switch to graphite2001

50a1ef3402-+-zuul: move zuul-merger to service_unit and systemd

15dd383743-+-Allow mwlog[12]001 on datasets/dumps/eventlog/logstash

b262a06626-+-Fix SSL checks for tendril/lists that are now LE

50bc8210c8-+-certspotter: add system => true to user/group

b2b749102a-+-Setup & configure certspotter

b4af5874fa-+-prometheus: run -vhtcpd-stats iff vhtcpd is running

0a3beb759d-+-mariadb: ignore lint warnings about autoloader layout

c9e4ce6747-+-mirrors: lint-ignore 'passwords::mirrors not in autoload module layout'

24de87b99c-+-fixing librenms.w.o check to LE interval

20650dd813-+-fix ganglia.w.o ssl expiry check

e79166651c-+-openstack: switch installserver to install1002

2ff8f52c86-+-multiple roles: lint-fix standard/base::firewall includes

2ead92d801-+-multiple roles: lint-fix base::firewall includes

278dc7a2e7-+-multiple roles: lint-fix role::backup::host includes

a0a71f1ce2-+-bastionhost,bugzilla: lint fixes

2af99c1a9f-+-contint/zuul: skip Icinga monitoring if server not master

2d2f199864-+-interface: rps::modparams, aggregate_member not in autoload layout

d93c49c1c7-+-Tools: Do not install adminbot

a6c9329b4e-+-nodepool: active check for node pool instance states

f848237502-+-contint: disable DNS lookup for castor rsyncd

486fd00dae-+-rsync: allow extra settings in rsyncd.conf

e86b5712f7-+-etcdmirror::instance: fix binary path, do not declare the service

1b3870d8b5-+-systemd::syslog: fix owner and group of logfile

365fa39142-+-role::configcluster: enable replication from eqiad to codfw

cef2cb7ea5-+-base::service_unit: chmod -x systemd overrides

0b142eb454-+-tools: Fix docker builder host

144f4bf25e-+-trebuchet: Fully qualify hostname

310868796b-+-eventlogging/eventstreams: Linting fixes

3376ad2464-+-Phabricator: Allow us to disable opcache validate in php.ini

91e35f80bb-+-etcd: Linting fixes

7857dec11c-+-icinga: fr-tech-ops contact group for benefactorevents

7f21f34a0f-+-icinga: add SSL cert monitoring for benefactorevents

65ebfd4f8c-+-Add a bunch of filtertags to puppet class comments

63ddecd00e-+-tools: add bzip2 to list of throttled tools

b521b78b53-+-Remove views.pp from labsdb role, duplicate of labs::db::views

874f33b7c8-+-logstash: Add a json_lines TCP input

e0e50d44c1-+-Linting fixes (Multiple modules)

541ba70845-+-wikistats: cron for automatic miraheze table update

747d2777d3-+-puppet/puppet_compiler: Linting changes

d035c6d898-+-Reset refined webrequest retention back to 62 days

03d4251d65-+-Fix retry_interval for check_leaked_hhvm_threads

1ce27a15ff-+-Run GenerateFancyCaptchas.php against enwiki rather than aawiki

29be46b270-+-labs modules linting changes

35106e32ee-+-toollabs: Install mktorrent

98041aadf1-+-elasticsaerch - change the default data directory to /srv/elasticsearch

f567660194-+-nodepool: track and alert on age of instance states script

329a33771c-+-Disable auto-restart for nutcracker when config.yaml changes

3615a9ab37-+-Silence apt rsync repo activities

c205a9fa99-+-fix icinga.wikimedia.org ssl check

6e0c41cc70-+-extdist: Linting fixes

7bd196464a-+-tools: Remove unused docker related files

38b440741d-+-tools: Turn on docker live-migrate for docker builder

e673a0f4ab-+-tools: Fix puppet on docker builder hosts

0e6776e16e-+-tools: Use docker profile for k8s worker nodes

9fd3a611f7-+-tools: Use docker engine profile in tools builder

10f258f520-+-toolschecker: Increase check interval for grid job submit tests

d9357abd29-+-site.pp, DHCP: remove cp3011-cp3022

658a961c0b-+-Raise the retry interval of the Apache/HHVM leak monitor

36a77d928a-+-Add aqs1009-a to the AQS Cassandra cluster

f21d9bf9ef-+-ores: Increase capacity

359fcb7cc6-+-mysql: Linting changes

6340f57e7a-+-graphoid/gridengine/grub/haproxy/hhvm lint fixes

94bc69c034-+-Puppet style: Use one line per include/require

fa97c633fd-+-labstore: Don't use wikitech API to find labs instances in nfs-exportd

7352755b16-+-cache: move graphite/performance backends to graphite2001

82637e2251-+-graphite: move performance::site to graphite2001

733080c1bd-+-site.pp: Change db1064 to ROW

9d51d576ec-+-phabricator: Set the elasticsearch version in a string

cdf08d0966-+-librenms/locales/logstash/lshell linting changes

f057fcb71c-+-redis: Linting changes

a607508ecc-+-xdummy: Linting changes

1b014b57da-+-zuul: Linting changes

9d38f2e2b2-+-phabricator: allow to change elasticsearch configs

911df43cc5-+-ldap: Linting fixes

9d2dc25842-+-ores/otrs/package_builder: Linting changes

984aed791c-+-vmbuilder:  Hack around a bug with sudoers

71607cfff7-+-Revert "Add JVM Heap usage alarms for basic Hadoop daemons"

4735b0f002-+-Add JVM Heap usage alarms for basic Hadoop daemons

3d489f6b75-+-Remove ntfs-3g on precise/trusty

046a7b8d70-+-Enable Prometheus JMX exporter on Cassandra nodes

28b166e371-+-docker: Gently wade into new coding guidelines

51f1d151fa-+-installserver: add firewall hole for rsync also for IPv6

5b1f27b4ad-+-aptrepo/rsync: flip the "if"-logic around instead of a negation

c8bdc1957a-+-aptrepo: add cron to rsync APT data automatically

57ce1781e7-+-toollabs: Add temp role and cron to send weekly tools precise deprecation reminders

c88cff5b49-+-Install python-ua-parser as an eventlogging dependency

924aafb9f7-+-Require cassandra-wmf-tools and jvm-utils for Cassandra

904f2fc9df-+-Extend role memcached to the new codfw mc hosts

4e9f2124ca-+-Add aqs1008-a to the AQS Cassandra cluster

f1dc558115-+-installserver::nginx: use "do_acme" in Hiera instead of custom var

cac0c1fd56-+-ganglia: display deprecation banner

d6ededbbb7-+-deployment: Linting fixes

0b76412a9e-+-dnsrecursor: Linting fixes

3ac67197d2-+-jupyterhub/keyholder: Linting fixes

93d2c9bb26-+-wikimania_scholarships, planet: one line per include, full class names

65521bd059-+-planet: use one line per include, full class names

93a6f2e1e7-+-add install1002/2002 to replace 1001/2001

62b4b26fce-+-Require proper file for rsync-published-datasets cron

fe9a43d409-+-Create /srv/published-datasets on stat* boxes, and hardsync them to analytics.wikimedia.org/datasets

a92c5f1fdf-+-Add hardsync shell script

c5b959a9f5-+-Revert some of the changes last week to datasets.wm.org - we will cleanup at analytics.wm.org instead

881623d005-+-planet/pmacct/programdashboard/pybal lint changes

22d846532c-+-mariadb: Add TLS support for tendril

64265ce4fe-+-Revert "adding icinga cert monitoring for *.corp.wikimedia.org"

5ae578eee6-+-adding icinga cert monitoring for *.corp.wikimedia.org

3476b4a5e4-+-elasticsearch - deploy the same administration scripts on Jessie and Trusty

116e95cc95-+-Temporarily increase refined webrequest retention to 90 days

b651d5e5df-+-sanitarium2: Enable TLS, disable Toku-specific config

793aa26ab0-+-elasticsearch - ensure data directory with puppet

a2b25b3cde-+-prometheus: Linting changes

3f82d4f573-+-wdqs - categorize wdqs1003 as a wdqs node in site.pp

5b54541fd2-+-wdqs - configure new wdqs1003 node

ddff9b8146-+-Scap: Bump version to 3.5.1-1

f21ce599fe-+-Tools: Disable automatic backups of aptly repositories

71f3adf004-+-ores::redis: Enable diamond collector

c7fd39dbd6-+-Turn off centralauth table dumps.

4ba86fd5f7-+-cache: remove varnish_version4 from hiera and salt

c39665bed8-+-Keystone:  Define some stopped services on the spare host

016335d7e9-+-aptrepo: add second rsync module for entire /srv/

31882dc55e-+-ores:Adds aspell-ro to ores base.

a62f64c0c4-+-Keystone:  use uwsgi::app instead of service::uwsgi

3dfa92b583-+-labs: remove keystone alerts

084d02b84e-+-Provision MediaWiki-Vagrant on Jessie hosts

d92279c51d-+-k8s: Linting fixes

87d580919a-+-geowiki module: Lint changes + modes/umask quoting

f959d02815-+-elasticsearch: Lint fixes

ad1a5e7b0e-+-varnish: stop ensuring libvmod-header is absent

4cc93bfd11-+-toolchecker: Add script to manage toolchecker* services

1c6db8a368-+-toolchecker: Update path for k8s etcd check

5358b1c14e-+-toolschecker: Fix upstart conf files path

4b31d00950-+-toolchecker: Fix directory dependencies

1d94bf7fc7-+-toolschecker: Fix service dependencies

a5a0d376c7-+-toolschecker: Split each check into a separate uwsgi application

34141b66e3-+-Testreduce: allow to decide the state of the services

9f91dd08e4-+-docker: Linting fixes

72eac9506e-+-monitoring: linting changes

baa8a2e94b-+-jenkins: Linting fixes

12c39967f4-+-gerrit/git/graphite: Linting fixes

a36ec8827c-+-icinga: Linting fixes

7db2a608f4-+-update archiva.w.o to use LE cert 2 of 2 (planned)

f3a67e3b26-+-phabricator: Linting changes

0a02f04985-+-setting archiva.w.o to use le 1 or 2

1ee435d685-+-site.pp, DHCP: remove db1019, db1042

a01aff7d78-+-Icinga: fix typo

785b83c02c-+-Configure recentchange stream endpoint in EventStreams

ffea91811f-+-profile::etcd::tlsproxy: add etcd-like 401 response

8be9c949d2-+-Add aqs1007 to site.pp and bootstrap aqs1007-a

6bb2fca4ff-+-profile::etcd::tlsproxy: minor fixes

725fad6653-+-profile::etcd: listen on localhost for clients if a TLS proxy is present

1ce2d6529c-+-icinga/wikitech-static: add contact_group for https monitor

45ad436ded-+-labtesthorizon: bugfix cache_misc routing

379fd293ef-+-profile::etcd::tlsproxy: depend on nginx-full, not nginx

9eae1d765c-+-conf2xx: install etcd cluster

3655785e11-+-Horizon:  typo fix

7e0a836cd9-+-cache_misc: stream.wm.o subpathing for eventstreams

744cc056b0-+-cache_misc req_handling: subpaths, cache policy, defaulting

fcc299dfc5-+-cache_misc req_handling: sort entries

f6b7e6900e-+-post-merge fixup for 8888fea7

8888fea7e6-+-cache_misc app_directors/req_handling split

6f1e346187-+-graphite: keep labs instance data for 30d

6475dcc15f-+-Horizon:  In mitaka, remove some instance-creation workflow steps

39ae6dcd67-+-osm: Add a prometheus textfile exporter

0a217ddd11-+-Linting changes (multiple)

0c3f0757d2-+-prometheus: add memcached aggregation and additional rules

2f5d552650-+-mariadb: Move db1057 to be a regular slave on config after switch

681fe58844-+-profile::etcd::tlsproxy: nginx auth proxy for etcd

a7b2ae1f5e-+-site.pp: Change active master for enwiki

b008770e7c-+-aptrepo: fix rsyncd 'hosts allow' syntax

5811eea0f0-+-Revert "Keystone: Assign more threads to the admin API uwsgi handler"

2c73ff74b6-+-Keystone: Assign more threads to the admin API uwsgi handler

44cee68918-+-icinga: raid_handler improvements

f4dd66997c-+-nfs: Make labstore1004 source for backups to secondary DC

a1098f966f-+-fixing my last patch, wikitech-static ssl monitoring

3406088ed9-+-adding ssl monitoring for wikitech-static

faef13c7c3-+-Serve analytics.wikimedia.org/datasets from /srv/datasets

59cf3ef5ad-+-multatuli: spare::system -> test::system

8a7abacde0-+-/srv/datasets.wikimedia.org -> /srv/datasets

97e201492a-+-site.pp, DHCP: remove mw1017,mw1099

15df295c43-+-Cleanup existing symlinks for datasets.wikimedia.org

eb33f38e9a-+-role::etcd::common: move to profile, refactor

053b590df1-+-etcd: add ability to use a TLS/auth proxy

c6ddbf1570-+-wdqs - configure wdqs2003 (new node)

edbf506098-+-Increase retry wait time for Hadoop Yarn Nodemanager checks

1385c0353c-+-mediawiki module: Linting changes

90442e83fd-+-site.pp, DHCP: remove analytics1015, analytics1026

bf82903b6d-+-dumps: Add a favicon (using the wmf one)

44a8d4b2b0-+-labstore: change drbd link over to /30 192.168

d03da42967-+-openstack: designate/glance/keystone not in autoload module

56a4f2aea2-+-openstack: instancersync not in autoload module layout

9e9f80ba3f-+-tools: specify ipaddress_eth0 for HBA

6a5f200c25-+-mariadb: Set binlog_format to STATEMENT for db1052

695258aae1-+-MariaDB: Setting db1065 as the new master of sanitarium2

77ebefd4f8-+-mariadb: Move db1072 back to a normal slave

15033aee48-+-Stick with node 4.6 on maps due to karthotherian not being ready for node 6

893c1929f3-+-tools: Get rid of kubebuilder

fe6e70c3e9-+-tools: Get rid of hacky k8s deployment bash scripts

e444b3c339-+-ssh: Don't add IPv6 address as an alias in exported resource if it's undefined

c67a0efb51-+-scholarships: move udp2log to mwlog1001

dc1e332e22-+-site.pp: Enable RBR on db1072

4ab0b7972e-+-redis: Allow specifying credential file for monitoring

7c18ded2a3-+-tools: Use packages in k8s bastions

4b1d5488c7-+-tools: Use packages for kube-proxy on webproxies

efd468f0fb-+-tools: Switch workers to using debs

608121f45a-+-tools: Switch to using packages for k8s master

53a3d63343-+-elasticsearch - increase size of GC logs

56481581bd-+-mariadb: Split dbstore role classes

e2c710dc42-+-aptrepo:rsync: fix 'Invalid relationship' and ferm syntax

1a50f85ecd-+-aptrepo: setup rsync between 2 APT servers

7cf7a6282a-+-gerrit/lists/microsite/rolematcher: fix "rysnc", "wikimeda" typos

2791f51fda-+-nfsclient: remove temporary absents from migration

c60fba139c-+-nfs_mount: protect absent the same as present

a07f31eb9c-+-labspuppetbackend: optional parameter before required

32e857a328-+-proxysql: optional parameter before required parameter

52d9190c83-+-kartotherian: optional parameter listed before required

27d3eabf6f-+-labs: Dump instance info somewhere that exists

8102ccc46e-+-Revert "redis: Allow specifying password for monitoring"

c0566dbd42-+-redis: Allow specifying password for monitoring

20fdc3e56d-+-squid3: switch to puppetlabs_spec_helper/rake_tasks

99ac7419b8-+-redis monitoring: Add a more descriptive description

c431d1aaea-+-redis monitoring: Use the correct variable

74e3e5b856-+-profile::base::labs: do not require profile::base

319a5016d2-+-mirrors: fix spec

d2ffc615b6-+-Remove redundant calls to standard from install_server

06e3b643de-+-role analytics_cluster: Linting changes

4b1f0d7e80-+-Fix invalid byte sequence in US-ASCII

6acbc6bdcf-+-puppetdb: Allow tuning.conf to have a different shared_buffers value

28eec31cb7-+-Move postgres tuning.conf into module

bbbcb67eaf-+-toollabs role modules: Linting changes

50589c7037-+-toollabs module: Linting changes

c511ef5982-+-postgresql module: Linting changes

938ff24a31-+-base: move to profile

34171e62b7-+-Puppetmaster: remove temporary logging for debugging

4746f63c24-+-dumps: remove nginx for download.wikimedia.org

b24b2f9cbd-+-graphite: Don't use wikitech API to find labs projects/instances

ccb47bf3ca-+-Apt:  Add a proxy to grab openstack mitaka packages from Mirantis

6df257c8a4-+-Revert "graphite: Don't use wikitech API to find labs projects/instances"

e529701e96-+-graphite: Don't use wikitech API to find labs projects/instances

bee1b2741a-+-docker: cleanup the custom apt repository stanzas

d2f96d8c12-+-nagios: fix check_ssl_http_on_port misnomer

b1f0bdeec8-+-nfs: Make labstore1005 primary post failover

ae84a22e45-+-dumps: LE, remove download.wm.org from subject list

291deab783-+-Designate:  Rename the nova_ldap sink handler to wmf_sink

7b29f81d50-+-dumps: LE, remove breaking whitespace in subjects list

e08d9f3b80-+-dumps: switch to Letsencrypt for TLS cert

06ee233b8f-+-toollabs: Don't use wikitech API to find labs instances in tools-clush-generator

ddc661fb53-+-puppetmaster module: Linting changes

715e4ac7ba-+-Graphoid: Install all fonts available to mediawiki.

2966ff594b-+-deployment-prep: Fully qualify hostnames

458f30dd26-+-kafka: fix Unrecognized escape sequence '\.'

03f627b887-+-openstack: fix lint warnings in service.pp

3ba3fd27ab-+-Fix 'invalid byte sequence in US-ASCII' on non Jessie passenger puppetmasters

8891eb5a58-+-site: provision roles for mwlog1001

4ee47b470f-+-hhvm: Restrict to domain networks

1f754bd209-+-udp2log: move to service_unit and systemd

6df7bb3c60-+-nfsclient: Create symlinks only if mount_nfs_volume is true

bccfa9f848-+-udp2log: add ability to selectively forward received messages

48afb26ff7-+-ganglia module: Use full names for class names

1f3073d2fb-+-nfsclient: Setup symlinks for /data/project and /home on labs projects from secondary nfs cluster

f05eed605a-+-xenon: move to base::service_unit

c39d6d1182-+-labs: setup instancedumper on californium instead of silver

7265b008a8-+-site: add fluorine's roles to mwlog2001

13648d99db-+-graphite: fix upload vs uploads alert for reqstats

c616473ef5-+-contint: add python-conftool

05982526a3-+-fix incorrect port in ferm rule

544b4a7423-+-nfs: Dual mount misc projects from labstore-secondary cluster

ab60db962f-+-site.pp - Use full class names, not relative ones

8c18620561-+-Labs salt:  Remove salt::reactors

55eeaefb8c-+-Move shinkengen from using LDAP to the OpenStack APIs

84ebd96c6c-+-nfs: Cleanup maps on labstore-svc dependency in nfsclient

8134e24b3b-+-wikitech: remove pre-LE sslcert class

d0dec0dfb1-+-nfs: Remove tools mount from labstore-svc dependency in nfsclient

949f0e94ed-+-nfs: Clean up post tools nfs migration

5b023b3722-+-Gerrit: Add support for logstash in gerrit

0a243fd17a-+-remove stat1001 from site.pp

9fc52404b5-+-sslcert::certificate: Clarify ensure=>absent behavior

1f48bc6b2f-+-Use LE for wikitech

5d5644a8a9-+-statistics module: Linting changes

80e3615aa1-+-druid module: Linting changes

605a2df056-+-varnish module: Linting changes

aebd2fe54a-+-swift: add systemd unit file for proxy-server

a618a00c21-+-contint module: Linting changes

e31b82da29-+-install_server: remove stat1001

d2ba09f57a-+-beta::autoupdater: Stop wmf-beta-mwconfig-update being a template just to get the staging dir

98f4e62e2a-+-diamond module: Add trailing commas

37725ab549-+-torrus module: Linting changes

31a84704d6-+-install_server module: Linting changes

04616280be-+-Add 'webp' package to ImageMagick role

94f5f755b9-+-swift: add ms-fe200[5-8] to site and conftool

f435b81908-+-cassandra: add jmx_exporter to Cassandra in deployment-prep

7bc74e35ea-+-change snapshots manifests to use the shell scripts instead of templates

bb4f6105d5-+-make (most) snapshot shell scripts files instead of templates

2bf085a6a3-+-Revert "redis::monitoring::instance: partially disable replication checks"

1d031902ca-+-conftool module: Linting changes

551a1ea058-+-authdns: Add trailing comma

f5a56f1087-+-bacula module: Trailing commas, full class names

d69a7a6beb-+-ores: Monitor the state of the redis databases

0fd66ba3f6-+-turn on ezachte rsync to other/media on dataset1001

e50b97e6d1-+-dataset module: Linting changes

211d3d3721-+-snapshot module: Use full names for class names

a153e20377-+-dataset: fix Unrecognized escape sequence '\?'

8b302a50b7-+-base module linting changes

4e745ec544-+-osm: Fix osm rsync server check

0e875b5c69-+-backup: fix spec

620815896d-+-bacula: fix spec

2f9fdafa7c-+-nrpe: fix spec

376f4a03a1-+-puppetdb: Do not set up Ganglia in Labs

4b80eef0a4-+-osm: Use LABS_NETWORKS in ferm rsync rule

7cea3dd065-+-icinga: missing trailing commas

15c70b7763-+-base: missing quotes around is_virtual 'false' for ipmi

49a94587cf-+-prometheus: add cassandra jobs in beta

3cd7ca43bc-+-apache module: lint fixes

1b2f462fdf-+-vagrant: add sudo rules for Vagrant 1.9.1

c7b252d323-+-vagrant: remove setup.sh call

77b71cb741-+-vagrant: Update LXC packages and apparmor conf for systemd

b6958a16d3-+-apertium/archiva module linting

373f278d50-+-Add .sh extension to check_mailman_queue.sh

3bf5ee61ea-+-authdns module: Use full class names not relative

d0af58acc1-+-admin module: include sudo class's full name

3470ce0319-+-labs dnsrecursor: add wikimania2018

0c116e8154-+-icinga/CI: give all shell scripts a file extension

34654b6a4d-+-ganglia/gerrit/planet: missing trailing commas

e5b206c7ea-+-Stop using package=>latest for standard packages

65ad7cd58f-+-mailman: fix Unrecognized escape sequence '\;'

c04fee1b43-+-puppetmaster: Specify $group for all repositories

1d6cb3c91f-+-Openstack clientlib:  Include python3 packages if version is post-liberty

1887ebf25f-+-Puppetmaster:  Remove remnants of ldap node definitions.

f5fa7327e3-+-Remove non-existing parameter from documentation

019315e543-+-tendril: use Letsencrypt for SSL cert

03c72ea8b6-+-ganglia: use Letsencrypt for SSL cert

6313d7809f-+-lists.w.o new le not to require apche mod ssl

2ba40183e9-+-remove group from LE addition for lists.w.o

5176a4b21c-+-convert lists.wikimedia.org from GS to LE certificate

90daa8cc96-+-openstack: capitalize service resource in keystone

fbd5dd3266-+-Convert librenms.wikimedia.org to LE cert use

092ba3f068-+-reclaim nobelium to spares

23cd030ac2-+-Partial revert of I89bd171e (LE part)

e6ed89b597-+-Fix parameter alignment

f9b8b77d7a-+-mediawiki: activate page assessments cron in eqiad

2b74baa014-+-Add cron job for PageAssessments maintenance script to puppet

3490e2d8ad-+-Revert "Revert "base: add lshw to standard packages""

db01910cce-+-Revert "base: add lshw to standard packages"

9414165c08-+-base: add lshw to standard packages

3fa447f9c2-+-toollabs/CI: give banner scripts an .sh extension

5a3ac441ba-+-Set SYS_UID_MAX and SYS_GID_MAX to 499

32c20c31bd-+-Add NRPE check to monitor timesyncd

a218715480-+-icinga: unbreak dependency cycle with Apache site and cert

d414bfe01a-+-icinga: use Letsencrypt for SSL cert, spend less donor money on prime numbers

92493b39ee-+-Keystone:  Add more uwsgi api processes

513c2fc7bf-+-Revert "Gerrit: Enable logstash in gerrit"

8e75f19eb2-+-Gerrit: Enable logstash in gerrit

ac7fbecb51-+-site: add restbase-dev100[1-3]

add5e78601-+-ganglia: switch eqiad aggregator from carbon to install1001

4958a5955b-+-remove reclaimed systems from site.pp

dfeb49b46f-+-Also exclude time servers when using timesyncd

71b0c02156-+-decommission mw2075-2089

1bd2ebe80a-+-beta: Move beta-specific VHosts into their own apache config file

f4d936d003-+-icinga: Move SSL settings from role to module

17c0dc1234-+-Don't apply NTP Icinga check to standard::ntp::timesyncd

5d0868e2fa-+-Labs: Remove obsolete code

272fc2980c-+-Nova:  Add the admin_uri nova config setting

044f131251-+-openstack: switch tftp server from carbon to install1001

a7f3fece0c-+-unified cert: infra for per-dc switching

a65f983a4f-+-Keystone:  Make /var/log/keystone group writeable

2b7ed05a5b-+-Keystone:  rotate uwsgi logs

10d17b87bd-+-Keystone:  Add service notifications for a couple of files

31afbebd0a-+-Keystone:  puppetize logging.conf

88ad52e7ce-+-Keystone:  Move api service to uwsgi/nginx

f62ce78b68-+-labs: 2>/dev/null dns-floating-ip-updater's output

5d6bf3d2bd-+-varnishreqstats: port to cachestats.CacheStatsSender

5071732c27-+-Purge ntp package when using systemd-timesyncd

6eb58de644-+-Make systemd-timesyncd available as an alternative time synchronisation provider

e637cd6e8d-+-role::mediawiki::jobrunner: Restrict to domain networks

341275588c-+-Revert "Keystone:  Move api service to uwsgi/nginx"

2e2dd27d6e-+-Keystone:  Move api service to uwsgi/nginx

80d718dd99-+-Revert "Keystone:  Move api service to uwsgi/nginx"

7122564873-+-Keystone:  Move api service to uwsgi/nginx

dfccd1def4-+-Add mirantis backports repo for Openstack classes on Jessie

13f4b8dfde-+-toollabs: install opencv-data (trusty, jessie)

7ac299bf6a-+-nova-network:  Refresh service if config files change.

8644bb55ed-+-Add the HHVM and Apache videoscaler clusters to Prometheus polling

ebd3658197-+-phabricator: delete labs role

9d81ef228f-+-puppetmaster: Cleanup unused vars / crons in labs puppetmaster

9700cd708c-+-Add configuration for query endpoint URL

4172b8520d-+-Alert on EventBus service HTTP error rate

ce3b8e81ad-+-Revert "mediawiki: disable 'generate captcha' maintenance job"

a993525d44-+-wikilabels: install nodejs package

c380154c42-+-profile::docker::builder: add alpine linux

e842b9cb94-+-docker::baseimages: add support for alpine linux

a7aae5a55b-+-Revert NTP disabling for leap second

60618bd36e-+-eventbus: Restrict to domain networks

74ec817bb1-+-Disable NTP checks during the leap second

9d6588ff98-+-calico: Expose puppet keys as well

2734129d58-+-Enable CNI plugin on kubernetes::node profile

5413089d78-+-Allow BGP between kubernetes workers

ac8ca09fbb-+-Update calico/node version

3adf456e63-+-Bump calico CNI plugin version

854669d71a-+-Fix dependency to calico/node for systemd unit

096d2fe850-+-Enable the calico profile on kubernetes::worker

6e7d4c9de5-+-calico: add module/profile to use as kubernetes networking

e862c2c928-+-Move external_networks to network module data.yaml

3211529808-+-Specify kubernetes admission controllers via hiera

0ff34dbe2b-+-kubernetes::worker: Allow access to kubelet from master

946c629283-+-puppetdb: Do not hardcode puppetmasters

60c8c369a1-+-kubernetes apiserver: Allow specifying > 1 apiserver

aa749fb043-+-Production kubernetes: Specify the service IP range

1c9ccfd79b-+-openstack::horizon::service: use require_package for keystoneclient

48b409cbd2-+-Force docker bridge IP address per host

13677d2320-+-Revert "Remove stat1001 from site.pp"

f46a83b187-+-Remove stat1001 from site.pp

a71b251c69-+-stat1001 is now a spare and can be reclaimed

67d5e9f6c6-+-Add rdkafka_config deployment var to eventstreams service module and role

1ecc3df3d4-+-Add libgomp1 to hadoop worker nodes

3a162b6bd5-+-Use the correct require function in in k8s::proxy

d003a55a95-+-Use packages for kube-proxy in production

b9a7316c84-+-profile::kubernetes::node: Set certs owned by root

b32439ff05-+-Include ::profile::kubernetes::node in role::kubernetes::worker

684ebc8b03-+-Add profile::kubernetes::node profile class

5884532e59-+-profile::kubernetes::master: Specify no authz_mode

46c4b8b3b4-+-k8s::apiserver: Allow overriding the authorization

5a1a01a1f4-+-hive/metastore: Restrict to analytics networks

ffd7405477-+-profile::kubernetes: Specify use_package parameter

74791d759f-+-yarn web ui: Restrict to analytics networks

48ea2bb4cb-+-Add dbmonitor1001, dbmonitor2001 to network::constants

23bb35a0fe-+-tendril: Add all the required apache modules

658e40adb1-+-Create and assign the kubernetes::master role

f5bdfe4ff3-+-kubernetes::master: Introduce the kubernetes profile

df1198ecd4-+-k8s::apiserver: Allow specifying the SSL file paths

103275a304-+-Introduce dbmonitor1001, dbmonitor2001

3aedeb44bd-+-remove absented file long gone

dccbf4342d-+-labsdb: Followup to I3156a406f37dd5344273faf5c770c32eddee0e25

d034024278-+-labsdb: Run maintain-dbusers only on active NFS host

b0dcf920a8-+-labsdb: Add delete user functionality to maintain-dbusers

dc0c64212d-+-Pin python-pbr to an old version for Zuul

bb3aeb4f01-+-mediawiki::scaler: check orphaned HHVM threads

626b08c6e5-+-Increase Redis Replica Sync retry interval to 2 minutes

9f5ef91d7a-+-Wikitech:  include openstack::clientlib on silver

e31e005096-+-Remove MongoDB dependency from statistics cruncher

c5f0338767-+-labs: maintain-dbusers.py for maintaining labsdb users

fe8151d5e2-+-prometheus: add aggregation rules for MySQL

e71d027e49-+-install: add http & proxy roles on install2001

59a22845ec-+-install: add hiera override to skip Letsencrypt cert creation

40ec63be3a-+-install: add http & proxy roles on install1001

fdd06bc2cf-+-otrs: use wikimedia_domains from role exim

61e5015f8d-+-puppetmaster: Do not install default file before common package

76a3aab7b5-+-prometheus: introduce prometheus::rule define

39e9c80801-+-Revert "puppetmaster: Install self signed CA into system store too"

164b7906bf-+-grafana: Provision Varnish Client Status Code dashboard as JSON

8b0057ce46-+-updating sinistra to mwlog2001

6721fa19b5-+-ChangeProp: Use RESTBase in the other DC to process async requests

8669e1ea17-+-Parsoid: provide the full URI in mwapi_server for codfw

1e7493a782-+-Parsoid: Define the mwapi_server and mwapi_proxy config variables

79fb1de45a-+-varnish: remove varnishprocessor

b9521ea96e-+-k8s::apiserver: Amend to support more than labs

5544608f54-+-k8s::controller: Amend to support more than labs

a7dc91ac55-+-kube-scheduler: Amend to support more than labs

d57ed8299d-+-Gerrit: Remove java 7 package

088d1f76ae-+-Add apache/hhvm exporter to imagescalers

0998931bde-+-lists/exim: move files from /files to role module

5e386326b9-+-Keystone:  Give custom auth plugins entry points

1d0214ec99-+-Fix script path to camus

cd3ecef6ce-+-Ensure PYTHONPATH has refinery utils available for analytics cluster camus jobs

4d7a2ccd27-+-contint: fix/move 'backup'-includes, move from node to role

395902c9c0-+-Add the apache/hhvm prometheus exporter to all the mw hosts

587aa75ca8-+-contint: combine contint1001/2001 in a single node regex

8788d72470-+-Add new digicert unified cert files

1125884b5b-+-Remove expired unified certs (GS 2015)

86f0b35a94-+-videoscaler: fix and harmonize timeouts

26ae1b98ec-+-labsdb: Enable view creation on labsdb1009/10/11

fffc3c15ad-+-labsdb: Block access to replicas' mysql from almost everywhere

df08a3b501-+-varnishrls: port to cachestats.CacheStatsSender

8a0901b8a9-+-Repurpose two jobrunners to videoscalers in eqiad

ec0f5594a5-+-Rework network::subnets

dd1710fd10-+-dumps: fix typo in setup of tables yaml file path

e8738a8732-+-move configuration of tables to be dumped out to a yaml file

111acd9e64-+-Apply the hhvm/apache prometheus exporter roles to the MW appservers

bfd8a3c3be-+-MobileApps: Switch to Scap3 config deploys

03f7320827-+-varnishmedia: port to cachestats.CacheStatsSender

962e168436-+-package_builder: run shell inside the chroot on build failures

49c1b365db-+-Tools proxy: Restrict to labs networks

2f7499bd75-+-role::jsbench: Restrict to production networks

8d4a9be4cc-+-phabricator: fix passing config on labs

1ba7b37630-+-prometheus: fix apache_exporter's port

8fc8a96df1-+-prometheus: test hhvm/apache exporter on mwdebug

f335b8dbd2-+-contint: add a disabled zuul server on contint2001

87814177f0-+-zuul: manage service status from hiera

08798272b2-+-contint: provision the secondary CI master

7291a4f82f-+-Bump parser cache purging batch wait time

d4a8c83586-+-Tools: Install php5-readline

93836f32bf-+-prometheus: add more metrics to be collected globally

e3deae01aa-+-prometheus: add job definition for apache_exporter

f6344d1d6b-+-Keystone: refactor observerenv.sh

2fa48eaf12-+-hhvm::admin: Restrict to domain networks

da03296549-+-Add hhvm_exporter role and class

e3bbad8e4e-+-Add the prometheus-apache-exporter module and role

ed6a0f6604-+-mariadb: Move role::mariadb::client to a separate file

2c4700b69e-+-Revert "Revert "mariadb: Tune mariadb clients only install""

1a7e59a68b-+-Revert "mariadb: Tune mariadb clients only install"

c96ecf2d63-+-mariadb: Tune mariadb clients only install

37f96cb4be-+-docker: cleanup dockerproject's apt repository

26a3ce3e58-+-varnishxcps: subscribe to cachestats.py

e94c4b3c98-+-labs: Set noexec and nodev for scratch

0a51e3d46b-+-CXServer: Use Scap3 to deploy the config

98d7dd9dbf-+-labs: Set nosuid on scratch

3ce644b3d1-+-k8s::apiserver: Remove unused master_host parameter

6e15f0eb3e-+-tlsproxy::localssl: add dependency between sslcerts and nginx

d440e66919-+-Add a daily discovery stats cron

2927384c3c-+-varnishxcps: use varnishncsa to read log entries from the VSM

d066370f6f-+-Bump scap version to 3.4.2-1

6852616549-+-mariadb: Fix mistaken template puppet url

ddfab7fbb6-+-puppetmaster: brown paper bag fix

3cd860106f-+-mariadb: Move backup templates to subdir on the right position

4fa420946d-+-puppet-ecdsacert: various tweaks

a586e573f6-+-if guard the slave in role::postgres::master

aee482c3a6-+-labsdb1005: Remove comments and postgres role

00c7bece7e-+-role::postgres::master: Hieraize node scope variable

3c6c102f47-+-ssh_pybal: Restrict to production networks

fbcd09d8ad-+-role::mediawiki::webserver: add hack to allow installing nginx

7f172787cb-+-toollabs: install korean locales

f99f672869-+-move install_console from global /files to modules/role/files/

d1eaa55874-+-Move wikimedia-logo.svg to role module

cc58241809-+-mediawiki: disable 'generate captcha' maintenance job

e4675910e1-+-mediawiki: ensure /etc/fancycaptcha/ on maintenance hosts

6e1867f843-+-mediawiki: Add cronjob for regenerating captchas

0ff5aa4033-+-role::mediawiki::webserver: fix TLS cert name

7a95949630-+-Fix thorium typo

33aa616df6-+-Install arcanist in toollabs::dev_environ

120ba1e1db-+-Symlink limn-public-data so it is accessible at datasets.wikimedia.org

1111d49ab9-+-Remove a few more references to stat1001

8dbc3cf512-+-s/stat1001/throrium

efcac33f8a-+-labsdb: cleanup maintain-meta_p enough to make it viable

b47a5b4827-+-role::mediawiki::webserver: add TLS local proxy

a94ac9efe2-+-Introduce argon, chlorine as kubernetes masters

acd7f77f3a-+-RESTBase: Add trending edits service config portion

6f4296fa50-+-EventBus Proxy: Ensure the syslog output file is readable

311b417745-+-tilerator: additional configuration for scap3 based configuration

818a6e4c22-+-tilerator: deploy config with scap3

4f58a09f2b-+-Trending Edits: LVS configuration

4a78d4905c-+-Remove no longer needed statistics::migration role

380a48fa3d-+-Trending Edits: Add to SCB

824aed05c0-+-puppetmaster: add puppet-wildcardsign, small fixes to puppet-ecdsacert

3c3b0985f8-+-Set systemd dependency correctly for vk statsv/el instances

15206f7c34-+-Keystone:  Fix misnamed icinga check

4e0fe44416-+-Keystone:  add existence checks for critical projects

2fcb0b56e2-+-prometheus: export gdnsd stats via node_exporter

1e0c9d2c3d-+-Keystone:  fix c/p error in role monitoring

c0ace7c24f-+-Added check_keystone_roles command cfg for icinga

9364ba4581-+-Include icinga dependencies for keystone checks.

a590cd9b97-+-Keystone: Monitor project membership

bbd7afeb9c-+-Move observerenv.sh to /usr/local/bin

6aa2a8fdf6-+-contint: Add dependencies needed for PoolCounter tests

4cacf19d67-+-visualdiff: Install uprightdiff package

b71f7c1ed1-+-Add clientlib.pp and mwopenstackclients.py

1510989a19-+-mariadb: puppetize misc-dumps cron, which was missing

2543c6ff72-+-Install kafkacat on Kafka brokers

edebe49733-+-VCL refactor: split cache/app backend support

3358bbcbdc-+-Revert "Revert "Add python-confluent-kafka to eventlogging::dependencies""

b44f465274-+-puppetmaster: add script to generate and sign ECDSA certificates

876aae5052-+-Remove webrequest_bits config from kafkatee input

a98f47902d-+-tlsproxy: remove unused keepalives complexity

9f71707cf9-+-node service - allow empty entry point

374022cda6-+-Remove http monitoring for spice-proxy

1fd4efca6a-+-openstack: Add basic monitoring for HTTP services

a3931cd6d9-+-Revert "Add python-confluent-kafka to eventlogging::dependencies"

97e82be5b9-+-varnish: add varnish hitrate dstat plugin

2b7976aa1a-+-labsdbs: add new labsdbs to config

26b40d00bb-+-labsdb: Differentiate between legacy grants and newer labsdbs

9911f10e04-+-Remove the role eventlogging from site.pp

6f29bee938-+-role: include memcached_exporter in role::memcached

df2bece8ba-+-package_builder: add stretch

102bacd69f-+-Remove now unused eventlogging.pp role

afbcf05c68-+-Apply role::eventlogging::analytics::{zeromq,mysql,processor}

7b02cc90e4-+-elasticsearch: Java 8 is now the default everywhere Bug: T151325

39f1b67e2b-+-role eventlogging::consumer::files -> eventlogging::analytics::files

56a67c1aad-+-Refactor eventlogging analytics role classes into many files

e46f56e88d-+-contint: Add a few more php7.0 package dependencies

15bc9b80a7-+-Gerrit: Remove exec/require/subscribe for  auto-provisioning

9a1e0fb6b8-+-install: add 'preseed'-role to install1001

55ead6433b-+-Move ve files to role module

7681952687-+-Add python-confluent-kafka to eventlogging::dependencies

911ff6e5ca-+-Set kafka_producer_scheme to kafka-confluent for analytics eventlogging processor

cb58cc9df6-+-Add hiera lookup for kafka_producer_scheme so we can try out kafka-confluent producer for analytics eventlogging processor

1049322a16-+-Gerrit: Swap to using openjdk8

120d28be82-+-Increase sync_timeout=10.0 for eventbus service kafka producer

eccc6d604a-+-backups: Fix & uniform predump and bpipe mysql method of backups

4d95de6359-+-Make labspuppetbackend_mysql_password a hiera global

7e8ea0a527-+-Revert "mariadb:  Get labspuppet password from hiera"

bd501078eb-+-mariadb:  Get labspuppet password from hiera

e2b43e3bf7-+-mariadb-labspuppet: remove references to a password that is not used

b0565d93d1-+-labs: Provision password for labsdbaccounts in labstores

a252fd7a2e-+-Horizon: refresh apache anytime django is refreshed

0207c4832a-+-Citoid: Change the default for wskey

b86d9e6340-+-Citoid: Add the wskey parameter

23f6d6e85f-+-ChromeDriver should be in PATH for jobs that run Selenium tests

30cb2c6d53-+-misc: get rid of hash support and maintenance

9af34819a9-+-rcstream: single-backend with manual failover

0c4043d9c1-+-Kube-proxy: Amend to support more than labs

4c0a41101a-+-kubelet: Amend to support more than labs

e6a767c1b2-+-dynamicproxy: Bind on 0.0.0.0

2bc0eb4f24-+-Renew expired TLS certificate for eventlogging hosts

46b7df2f71-+-contint: Install php7.0-ast for phan

071a298c46-+-install: (re)move remaining "role::installserver"

52a4febe06-+-install: rename tftp_server role to just tftp and further cleanup

af6386aa7c-+-installserver: move firewall include to http/proxy classes

bc48f00ce2-+-installserver: split squid proxy to own class

fa575d644e-+-installserver: move http to own class (kill carbon WIP)

2feb5a46c4-+-jsbench: move files to modules/role/files/jsbench/

7d454a4856-+-base/ipmi: install freeipmi globally, move to ipmi module

a4e6eed697-+-otrs: Provision mpm_prefork.conf

b652098218-+-apache: Allow configuring mpm parameters

aedd31eb19-+-ganeti: move id_dsa.pub from /files to modules/role/file/ganeti/

8d7191c995-+-Add note regarding source of wdqs lag metrics

85ef457b06-+-xhgui: move role class in proper location

918328573c-+-logstash: Break logstash.pp up into individual classes

6c0e5853d6-+-Designate:  page if services go down.

ffd1886318-+-prometheus: fetch storage_retention for ops from hiera

54dedb5e32-+-Labs ldap: Further attempt to get the keystone IP in an acl

b3e13d6cdf-+-logstash: Move files from root to role module

c0e35edbb4-+-Labs ldap:  Hide the novaobserver account from everyone but keystone

39bf2d80e1-+-Send secondary DNS recursor IP from labs DHCP

6d5c5a3e7a-+-wdqs - upgrade to Java 8

19ea68731d-+-Add Nagios process alarms for statsv and EL varnishkafka instance

9a797c8cc3-+-Quote "owner" and "group" attributes for file and git::clone resources

c496b0e12f-+-Install zip for statistics::web role (on thorium)

cbf38abdab-+-Add openjdk-8-jdk to the list of statistics packages

d6d4d52bb3-+-Switch Varnishkafka monitoring from Ganglia to statsd

a1e089c0f7-+-Add user and passwords for labspuppet and labsdbaccounts

bcef95cdd9-+-ssh: Disable challenge response auth for labs

59c78350da-+-phab2001: allow rsync from iridium over IPv6 too

d3185afb0a-+-phab2001: fix hosts_allowed in rsync config

3c7d37edb9-+-phab2001: fix ferm rule, remove /32

f4fd6d6276-+-phabricator: use FQDN instead of short hostname in ferm rules

387bef0cf4-+-Phabricator: allow rsyncing /srv/repos from active to passive server

8762189dbc-+-Gerrit: No need for gerrit's private key to be writable

2ba52df4cb-+-Revert "labstore: centralize snapshot-manager into bsync module"

365805c536-+-labstore: centralize snapshot-manager into bsync module

a291fdd042-+-pdfrender: 0500 for ~/.config

3d08ab28f9-+-pdfrender: more restrictive permissions on .config

e9df0d8173-+-Add fontconfig file for the pdf render service

52c70e6d8a-+-Labs: Add observerenv.sh, helper script for read-only creds

9152fcedf0-+-Keystone:  fix formatting of ferm rules

4198ec43fd-+-RESTBase: Add the Citoid host/port combo to the config

693fea0ace-+-Keystone: open up firewall to allow labs access to keystone API

be767c2d80-+-mariadb: Update dbstores to use the latest TLS certificate

52e2fc05a8-+-Enable new TLS certs on labsdb hosts

42322c3763-+-Deploy HAProxy to the new labsdb proxies

2265482039-+-mediawiki::hhvm: bump up the number of malloc arenas

d51f6ac2e6-+-Phabricator: Remove option metamta.maniphest.public-create-email

e8dd4b3eab-+-graphite: switch labs instances cleanup to cron

90cd20964b-+-graphite: cleanup labs instances metrics

dcb7e8df89-+-scap: upgrade to 3.4.1-1

b378ac32b5-+-Revert min.insync.replicas to 1, set api_version for eventbus Kafka producer

78c7ab109b-+-Add discovery reports

b6af8a57af-+-Set api_version for eventlogging kafka consumers as well as producers

1704d4e3cd-+-phab: add cron to clean up old tmp files

b6a448daa2-+-Manually specify Kafka api_version in kafka_clusters config

ff951c8547-+-udp2log: Replace undefined variable with $ensure_monitor_processes

158fa57e33-+-Remove Ganglia monitoring for Varnishkafka

e77317c49c-+-Phabricator: Allow overriding phab server name in hiera

11fdf5a8e0-+-Phabricator: Allow us to change the default web domain

eb4c579940-+-logstash - upgrade to Java 8

1588f8c9bf-+-Master switchover on es3 shard (eqiad) es1019 -> es1014

35a6161ba7-+-PDF Render: Increase the concurrency to 8

3271fc0c02-+-kartotherian: fix package as array

4e44f9d2e6-+-maps / kartotherian: libmapnik3.0 is required for the upgrade to nodejs 6

243e77a3a4-+-mariadb: Master switchover on es2 shard (eqiad) es1015 -> es1011

95187078ff-+-mariadb: Split backup and otrsbackups classes into a different file

add2abe7be-+-start adds/changes dumps cron job earlier

5fb8ee4d85-+-base: Allow auto puppetmaster switching tuning

9573ca976a-+-Revert "base: Allow auto puppetmaster switching tuning"

eaa576bdc3-+-base: Allow auto puppetmaster switching tuning

57c25e2ce8-+-Labs configuration for fi.wikivoyage.org

354bb8b450-+-prometheus: add vhtcpd stats via node-exporter

1e0ec9870e-+-Add a reportupdater job for ee-migration

e5b2d41105-+-mariadb: Upgrade parsercache servers to use the puppet TLS cert

2bb039372f-+-eventlogging: keepLastValue for eventlogging_NavigationTiming

12b7c15844-+-bigbrother: Rewrite as python script

ec6604793c-+-elasticsearch - upgrade to Java 8

c5f18fe13f-+-mediawiki: make jemalloc arenas equal to the processorcount

c7a8e71e8d-+-mariadb: Drop ssl (tls) options from external storage servers

dd5a586406-+-update cron command and config file for adds/changes dumps

875aadfcbf-+-mediawiki::hhvm: allow to override the default jemalloc arenas

034b6a9e07-+-statistics: use R from jessie-backports on jessie boxes

a9b5513504-+-Phabricator: Don't use vcs group, use phd

42b869ed5a-+-Abolish labtest realm.

b58a966323-+-labtest: smtp servers should be the same as in codfw

78d091a06c-+-Ensure geowiki base path exists

d28b44b485-+-Puppetize thorium as stat1001 replacement

42810d7d2d-+-Remove an unneeded $labtest switch

9021fcbcaa-+-Remove labtest realm checks from wikitech configs

857fd762fc-+-Migrate redact_sanitarium.sh script from software to puppet

d715034a15-+-discovery-stats: create mysql credentials file specific to discovery-stat

a700184788-+-Revert "Remove private_wikis from realm.pp"

4e1d3714fc-+-Set min.insync.replicas to 2 for main kafka cluster in production

b13bc09690-+-mariadb: Rename filtered_columns.txt -> filtered_tables.txt

82d8a94de4-+-Remove private_wikis from realm.pp

5a173615f6-+-mariadb: Rename filtered_columns.txt to filtered_tables.txt

30c2ffda13-+-labsdb: Move repo from views to common; add private data check

aaedaadd0b-+-contint: install php5-xsl package

213567d13c-+-Kartotherian - deploy config with scap3

afb6e49cd9-+-Kartotherian: deploy application configuration with scap3

360d9f2af5-+-Remove HHVM X-Powered-By header from static Apache responses

0ff1d14811-+-RESTBase: Add the PDF Render service config

7e281410aa-+-pdfrender: lvs configuration

396bf06ad7-+-pdfrender: active by default

acb1f78c45-+-scap: bump version to 3.4.0-1

ed801cffbc-+-/fully/qualify an exec path

f0a3d985b8-+-Override dpkg to specify mode 1777 for /var/run/lighttpd

283ee6a37f-+-Phabricator: Allow setting mysql.user and mysql.pass (part2)

ba9e8cb51e-+-Fix typo for Kafka mirror maker jmxtrans attr

114058829f-+-Update version of python-tornado used from jessie-backports

38d9a94db7-+-gridengine: refactor and establish norms

f968a1410b-+-labsdb: cleanup labs/db/views presentation

5fee6d4683-+-Add kafka2003 to main-codfw Kafka cluster and configure eventbus there

0781753c5d-+-elasticsearch - Relforge cluster should be accessible from labs networks

512b840d71-+-Add arbcom_cswiki to $private_wikis in realm.pp

a7f2531874-+-varnish: rename varnishlog4.py into varnishlog.py

b361b75b3f-+-Add mc1019 to site.pp

7be5adc85c-+-Avoid Redis IPsec replication if the host doesn't need it.

afa0874161-+-site.pp: Change db1044 binlog to ROW

cc4c587aef-+-varnish: rename scripts depending on varnishlog.py

02e4f5a0ec-+-Template out reference to deployment.eqiad.wmnet in inactive.motd

9f6eaf7d80-+-Revert "Add 'discovery-stats' technical user to the 'stats' group."

7b20f00d84-+-Add 'discovery-stats' technical user to the 'stats' group.

9884313f0b-+-Trending Edits: Role and module

3e0cd4eac8-+-Tools: Remove temporary class role::toollabs::merlbot_proxy

4545b6d39c-+-Phabricator: Allow setting the mysql.user and mysql.pass in labs

2446ec1a7b-+-Remove beta::deployaccess

f9cbb3ee43-+-site.pp: m3 has the wrong db master entry

c25d820503-+-jobrunner: fix logrotate rules under systemd

b59783c3cc-+-Remove Varnishkafka APT pinning

21c538d460-+-Require ::openstack before the common role

e29a10b046-+-Remove beta::config

de050b9656-+-One more explicit lookup for openstack_version

3a0410031a-+-Explicit hiera lookup for openstack_version

43322b3e11-+-Remove some redundant includes of openstack::nova::hooks

fe8638c009-+-Openstack:  move wikistatus settings into hiera

55d5b84f71-+-phabricator: Move mysql hostnames to hiera

0eec66392a-+-openstack: split nova.pp into one class per file (autoload layout)

65ef589221-+-Phab: Remove pointless variable assignment

fe6a331896-+-Phabricator: conf_env resources need phabricator package installed

0983592c8a-+-Phabricator: define vcs interfaces only when configured in hiera

9a293cd428-+-Remove role::beta::trebuchet_testing

b225b7a578-+-Remove role::beta::bastion

4a35772b85-+-Configure eventstreams in codfw backed by analytics-eqiad Kafka

e18e56ccd4-+-Move the role::labs::openstack::nova::wikiupdates to openstack::nova::hooks

54d01f40e5-+-Labs dns:  Ensure the mysql server starts at boot

b26ff18842-+-Fix for evenstreams icinga http lvs alert

27a42609a7-+-Revert "Labs dns:  Ensure the mysql server starts at boot"

c73e854aae-+-Labs dns:  Ensure the mysql server starts at boot

9cffd32ec5-+-varnish: un-template v[34] syntax-helper variables

83dbd721b2-+-site.pp: db1052's binlog changed to ROW

bca0fc7306-+-add planet and wmfusercontent to unified SAN checks

1423001a4f-+-remove unused r::c::ssl::misc

78646472c4-+-cache_misc - switch to unified cert only

bb2d1bb4b5-+-caches: switch to new active unified TLS certs

8090a3f658-+-udp2log: prevent Ganglia install when it is not used

b2d9130d8d-+-Remove varnish::apt_preferences

a18f39e107-+-Revert mw1170, mw1171 to their former roles

491e0e03cb-+-debug_proxy: Use mwdebug instead of mwtest hosts

1b94c527d0-+-pdfrender: disable by default in eqiad

4795fefac9-+-jobrunners: Also ensure units disabled if stopped

ef7bc6d66b-+-PDF Render: Add libasound and libgtk2

be7bf590e4-+-PDF Render: Add missing libgconf2 library package

8f719d29be-+-Introduce mwdebug1001, mwdebug1002

02a0eef2dd-+-PDF Render Service: Add to SCB

11bacf7f03-+-PDF Render Service: Role and module

746ab68422-+-site.pp: convert mw1017,mw1099 to role::spare::system

8c223218d6-+-debug_proxy: add mwtest1001,1002, aliases of mw1170,mw1171

9f63ab3dd5-+-Phabricator: Unbreak incoming email and harden config file permissions.

aa153c1a71-+-role: fix Prometheus global instance configuration

6efeda7ec9-+-role: fix typo in prometheus global instance

e1053342c1-+-role: add prometheus 'global' instance

e700c32022-+-role::prometheus::tools is used in the tools project.

f935c69485-+-Remove role::beta::uploadservice

7c1d70e10c-+-Add tools project filter tags to many toollabs roles

6146fe0a4f-+-Deploy EventStreams on scb and configure LVS service in eqiad

3e61515ac6-+-Changes to coal-web.py should refresh the coal webapp

a55aa039ea-+-cache: remove persistent storage support

3d974cadbc-+-profile::calico::builder: add calico-cni and k8s-policy-controller

5e9dad714e-+-deploy new globalsign certs as inactive

b0e4a1be1f-+-tlsproxy: $certs_active as a subset of $certs

57f4e32507-+-Puppetization for statsv args added in https://gerrit.wikimedia.org/r/#/c/321911/

9477e7d586-+-Revert "Puppetization for statsv args added in https://gerrit.wikimedia.org/r/#/c/321911/"

6a05d7a2eb-+-Puppetization for statsv args added in https://gerrit.wikimedia.org/r/#/c/321911/

0edbbabdfd-+-cache: get rid of varnish 3 compatibility code

e8f5568d10-+-ganeti: Disable KSM

dc7ccc0387-+-ganeti: Disable the drbd service

d8083e9822-+-Move the check_systemd_state check to base

57b88450e9-+-Stagger parser cache purges to avoid lag

c25f6935fd-+-icinga: Fix the typo in check_systemd_state

bd2ce41b4c-+-Revert "visualdiff: do not install g++ package, debugging"

9540b77574-+-contint: add postgresql to contint::packages::postgresql

1192c2b016-+-site.pp/bastions: make includes/roles more readable

8cf6dc06f9-+-labstore: dependency issues with account_services

ec123e0715-+-monitoring: Rename a few variables

18b61e0f90-+-labstore: Add account_services to secondary cluster

d312640c42-+-Switch discovery-stats cronjob to a dedicated script

6522f5636c-+-toollabs: refactor and establish norms

c9f5c9654f-+-prometheus: switch 'ops' prometheus to varbit encoding

04a120182e-+-Gerrit: Also install openjdk8 alongside 7, make it configurable

220c27335d-+-scap: Remove deploy2graphite

2a0122da06-+-docker: Fix monitoring description

d3dd83d390-+-Introduce a system wide systemd check

bf91d2a5d6-+-elasticsearch::https: Restrict to domain networks

ec4bf08230-+-analytics-meta: Manage mariadb service through mariadb::service class

883acfdf5d-+-beta: Fix typo on Beta mysql service configuration

43099bcd52-+-Beta: auto-start mysql on beta so it comes back after reboot

002bc50d6e-+-Drop poolcounter role from helium

8d5ac33376-+-Move config for git-ssh(phabricator) to hiera

bf5c79ac9a-+-phabricator: make vcs user a member of phd group

6b6a5849e1-+-phabricator: PHABRICATOR_ENV for vcs service

c642aeba94-+-prometheus: discard varnish backend UUID during collection

a7c50b2d93-+-Enable multiple config files in phabricator

a8353e24b1-+-site/restbase: include restbase2010 in node regex

724ed043b6-+-Provision restbase201[012], add restbase2010-a

814c1629e6-+-gridengine: /var/spool/gridengine as a symlink

a6c18b5036-+-nodepool: bump nova client and openstack CLI

7c471e1a81-+-Revert "base: Move package list to hiera"

2a08ac311b-+-dns-floating-ip-updater: use python's ipaddress class to determine PTR FQDNs for IPs

6d6cc64cc4-+-Remove wikitech references from ldapconfig

e6ef5fddbd-+-base: Remove more duplicates

5c954506a4-+-base: Move package list to hiera

52a942e775-+-role: add external_labels to ops prometheus

13fa0b50b0-+-graphite: avoid spikes in mw error rate alert

ddf200f389-+-gridengine: refactor of init.pp for toollabs module

7bdea4e5ae-+-Horizon: Fix accidental double definition

caaf8add2e-+-Fork keystone policy so that horizon has its own keystone_policy.json

e28f0ae9c2-+-nfs-exportd: ensure running and start on boot

d7d82aab13-+-Split check_ssl between traditional year-long certs and LE's 3 month certs

b53dd495ec-+-icinga: Increase NTP check intervals

a1dfd4e564-+-tools: when establishing links to NFS force creation

dacdd935e8-+-package_builder: Add subversion to list of installed packages

5b4ed7bbad-+-package_builder: Add pkg-kde-tools to list of installed packages

3aef33e6ff-+-Parsoid: Use Scap3 for config-file deploys

8e3b3f1b43-+-Revert "add mapped IPv6 address for krypton"

6285b4a8ab-+-add mapped IPv6 address for krypton

bd1eda88c4-+-Keystone:  Limit password auth to certain hosts and users.

4e695d34d4-+-role: add Prometheus job for memcached_exporter

564c744d15-+-role: account for labs in memcached_exporter

88203edc4f-+-mariadb-labs: Prepare db1095 to be the new sanitarium host

daa9834ed8-+-prometheus: rename varnish_config to cluster_config

a747452558-+-prometheus: add memcached_exporter

d959b3df1c-+-labstore: secondary add some monitoring manifests

c89a41b4d6-+-labstore1001: clean up unused jobs and legacy

c9bd3e3479-+-profile::calico::builder: fix build-calico, add fakeroot

f7b8d41ab8-+-Revert "icinga: Specify mode for nagios_host, nagios_service"

43fff43a80-+-profile::calico::builder: clone to /srv/calico-containers

8bacb9f76e-+-icinga: Specify mode for nagios_host, nagios_service

68859b2794-+-profile::calico::builder: fix file url, template

ea48eadb6d-+-profile::calico::builder: fix dependencies

21d5045256-+-profile::calico::builder: s/hieradata/hiera/

46c59665e0-+-role::calico::builder: fix typo

10bd12ffa8-+-calico: add module to build calico/node and calicoctl

b26eb93dcc-+-tcpircbot: improve firewall rule setup

e82ea456d5-+-Toollabs: Fix mount dependency order

1dbb618de1-+-toollabs: Actually not mount bind mount on boot

23384a3e97-+-toollabs: Fix typo

f68c80263d-+-labs: Require base classes than include them

7d1befaaf0-+-tools: Have bind mount depend on the project mount

5eb2ec6544-+-Revert "nfs_mount: do mount{} absent prior to nfs-mount-manager"

d6075c110c-+-nfsclient: force link creation even dir exists in this case

fe8e2f1915-+-nfs_mount: do mount{} absent prior to nfs-mount-manager

917c41f288-+-labstore: Symlink /data/project and /home on tools to mounts from labstore-secondary

e7cf942dfe-+-Don't install git explicitly

d883526dbc-+-base: Do not have classes clash with base::standard_packages

d65dcf2888-+-package_builder: add javahelper to standard build dependencies

f2481f82be-+-Check whether ferm has been correctly started

183feaa762-+-jenkins: disable cli

a7602c0ddc-+-labstore: Fix service urls for secondary nfs cluster

550aca09ab-+-labstore: Dual mount tools from labstore1001 and labstore-secondary

f09bbfa2e5-+-grafana: Provision the Server Board dashboard as JSON

2b9fae068f-+-nfsclient: fix dependency issue with scratch

5fd1d417f6-+-tools nfsclient: cleanup

6f4908dd31-+-Disable connection tracking for kafka broker

6b6cd168dc-+-labstore: Set mailto address for secondary backups cron

ec862eab57-+-labstore: Rename secondary cluster monitoring descriptions

7f5861f823-+-labstore: Check that NFS is being served over Cluster IP for secondary cluster

043dc5e4ae-+-labstore: Add drbd service monitoring

e75782a65a-+-labstore: Grant nrpe permissions to read output of cluster ip monitor script

9219e18872-+-labstore: Add cluster ip assignment monitoring to drbd cluster

1248b9b5b4-+-standard: install prometheus node_exporter on every site

5c21edc206-+-site: install prometheus server in esams and ulsfo

7e3b511fe4-+-Add wmfkeystonehooks

3b26ce0e3b-+-tlsproxy: separate ECDSA/RSA stapling for all

523eb83a52-+-Restrict access to Hive server

fda1ab7c2b-+-tlsproxy: ensure OCSP done before nginx reload

0934f726bd-+-tlsproxy: support multiple independent staples

aa5ca7b1c6-+-role: use single ferm rule for prometheus node/varnish exporter

e29d583de9-+-Revert "tlsproxy: experimental support for internal ocsp"

fa9b631729-+-remove neon from puppet/netboot/dhcp/network

876afee180-+-prometheus: use systemd override for node-exporter

3e438aaabf-+-eventstreams puppetization

a12ba9646a-+-icinga: Increase the check intervals

c6b74c24c2-+-role::mariadb::sanitarium: Restrict to production networks

c989c93382-+-Raise nagios retry_interval to avoid false alarms for HHVM restarts

875bdbcaac-+-Update jmxtrans for confluent kafka mirror maker

473edeff50-+-Only install python-pygeoip on Ubuntu

9bcf9962a4-+-maps - fix resource dependencies for tiles database creation

e8778affa9-+-Maps - tilerator on all maps servers needs access to postgresql master

f7a4e541b8-+-remove gallium from site.pp, installserver

1880485ead-+-labstore: Add minute to crontab for backups to secondary DC

96a7e88c23-+-confluent::kafka::mirror::jmxtrans: key attr is declared more than once

f8b2552cff-+-statistics::packages: Remove zpubsub

3fbcdbc82c-+-docker::registry: add monitoring

8f854c9950-+-cache_misc: use integers for port numbers

089ddd6d58-+-docker::registry: allow fetching images from the internet

b08989f614-+-ores (labs): Define log directory in worker nodes

4d98d8ea61-+-elasticsearch - /etc/elasticsearch/scripts required for elasticsearch start up

8a3a81ce55-+-Add role::systemtap::devserver to role::builder

2bc6668574-+-site: apply role::systemtap::devserver to copper

5094cb7198-+-carbon_pickled: Restrict to production networks

0a3140ca26-+-Add an Icinga check for Graphite metric freshness

24079ebd24-+-varnish: backend restarts on v4 only

e24fed35f6-+-statistics: Don't install spelling libraries on debian

11e4c01a11-+-contint: email template for Jenkins notification

63c713860b-+-package_builder: Add dh-golang in the list of packages

b67fa94f28-+-statistics::packages: Use emacs instead of emacs23

acf38715bc-+-Enable ssl (TLS) on misc database servers

6f64f4b5e2-+-docker::registry: fix indentation

8576d90abc-+-profile::docker::registry: allow incoming connections

1c97445798-+-docker: Allow setting an apt proxy inside the docker image

ada0718096-+-labs: Kill instance_info_dumper cron

9d3dfe427e-+-labs: Typo fixed to instance dumper code

5a021b041a-+-RESTBase: Use the LVS Realserver role

b46bf4277d-+-labs: Add a script that dumps instance info onto a public url

3ebb9dc568-+-labstore: Apply role secondary::backup::tools-project to labstore2003

180c9ea99e-+-tools: Properly give the clush user sudo rights

82a806d2fc-+-statistics/wmde: capitalize resource reference

5863b52a14-+-contint: drop contint::packages

d66cb74132-+-zuul-gearman-status.py requires python-gear

169a006962-+-Do not backup /srv/jenkins/builds on contint1001

2c0563d339-+-maps - create postgresql database for tiles storage

eea4d1624b-+-contint: remove gallium conditional from contint::master_dir

f9fc3e8164-+-statistics: Move packages to own class

e773d06b84-+-contint: remove gallium from firewall::labs

50fdd2eac8-+-cache_text: switch to file storage backend on Varnish 4

c229519f5d-+-cache jemalloc: rough tuning

55b99ef92f-+-Install MariaDB 10.1 on New labsdb replicas

60f8cfe29d-+-contint: rm gallium from ferm rules in zuul::merger

bc2ab589ac-+-cache::misc: switch gallium to contint1001

b0e7b561e5-+-contint: enable zuul::server on contint1001

5cdbad216a-+-labstore: Remove nfs backup role from labstore1001-2

6d55fd0ad3-+-role::builder: add docker support

d8667a3eb9-+-Revert "Revert "tendril: Supply a robots.txt disallow all robots""

4974505a06-+-docker::baseimages: do not perform hiera lookups within the module

3d0802ad67-+-docker::baseimages: depend on service, not docker::engine

79d7f1e5df-+-Fix ferm typo introduced in 6ffcac5717 (parentheses)

6ffcac5717-+-puppetmaster: Update ferm rules for IPv6 as well

6e3fc9cd9f-+-Decommission/make spare db1042

5e319e64af-+-labstore: Remove device mounts from secondary backup servers

bee79ae0e6-+-labstore: Setup secondary backups of tools and misc on labstore2003/4

14b44eac2c-+-SystemTap Puppet module and role::systemtap::devserver

3b4af697ac-+-jupyterhub: Setup HTTP Proxy for each spawned node

df27c960a4-+-prometheus: add varnish_exporter to all varnishes

610c63186a-+-roles: Kill the 'notebook' roles

dd9c7943b8-+-paws_internal: Add mysql reseach creds to notebook1001

0863061fa5-+-network::constants: remove /64 from icinga hosts

84dd1b4a2f-+-statistics: Separate research mysql cluster credentials into define

c75a491456-+-mirrors: serve ubuntu over rsync as well

7112ffb397-+-labstore: apply labs::db::views

fd9f3b2d92-+-mgmt: script to extract mgmt IPs from DNS

5f975e9cb9-+-labsdb: update to match private for maintainviews

f01b6b93a7-+-mirrors: workaround a ferm @resolve bug with v4/v6

18eaf6c709-+-mirrrors: set up push mirroring for Debian

b7ebdcca9a-+-mirrors: config ftpsync for mirroring from debian.org

4075ceccf9-+-mirrors: allow public rsync access to Debian

d9681e7dc5-+-mirrors: add rsync for Debian's push mirroring

202bb10838-+-tendril+dbtree: Explicitly disable automatic pulls from HEAD

127281dcfe-+-prometheus: extend Varnish targets generation to text/upload

2ac1eac514-+-labstore: 2003/2004 hiera additons to allow labstore backup key

4c60a9bf62-+-site: add varnish_exporter to esams/eqiad maps/misc

96627c2a38-+-labstore: 2003/2004 add backup key

cff4f319f9-+-elasticsearch: /etc/elasticsearch/scripts is not used anymore

df5237802c-+-realm: add 'projectcom' to private wiki list

3fb655ae06-+-osm: move files/osm/tuning.conf to role module

6b9c3d02aa-+-cache_: enable varnish-be weekly cron restart for all clusters

a06f9c0863-+-zookeeper: Retrict to domain networks

1b14423ce4-+-Revert "tendril: Supply a robots.txt disallow all robots"

1c0a10309e-+-profile::docker::registry: allow overriding the swift password

d9a6206fc8-+-icinga: move files/icinga/ into module

20c3c258a4-+-zuul: migrate server only settings out of merger

9789b54765-+-netops (etc.): add asw2-d-eqiad

558735e276-+-add mapped IPv6 address for contint1001

dcf7882ea1-+-deployment-prep: Fix deployment access.conf rules to allow all deployment servers

8ad69439fe-+-Remove extra non-ASCII character in role::cache::text that was causing issues

7dea7c5ef5-+-quarry: Explicitly add python2 plugin

9b99c87a07-+-mtail: introduce systemd unit

9e6fa48caf-+-add mapped IPv6 address for eventlog1001

8e7a1240bd-+-centralserver: add mtail for kernel messages

8ec2656b13-+-Introduce mtail module

07e9883551-+-prometheus: swap varnish_exporter ports fe/be

a01acba1ef-+-Remove nfs backup role from labstore200[3-4] in site.pp

d0aad2085d-+-nfs backup: Fix requires paths on mount definitions

d11731ec6e-+-nfs backup: Add mount definitions for backup volumes

cf73efaff9-+-Also provide imagemagick wrapper in openstack::nova::manager

d73f82e7e2-+-graphite: s/avg/average/ for aggregationMethod

8f550630cd-+-graphite: change Cassandra '.count' metrics aggregation

bbb8fbc4a7-+-Use icinga.wikimedia.org instead of einsteinium.wikimedia.org

633763b14f-+-labstore: keep nfs-kernel-server management in nfs-manage

977ee55f15-+-labstore: 'other' is really misc-project

991dea7f70-+-Replace check_sslxNN with check_ssl_unified

b5d57a7865-+-labstore: nfs-manage patches

8a1072d2c7-+-sort nagios command lists

4aefbe1e43-+-elasticsearch - enable GC logs by default

8aa956258c-+-Revert "cirrus - disable the rebuild of completion indices"

eb7b48c3e3-+-tendril: Supply a robots.txt disallow all robots

5d5d0a70f4-+-icinga: Add comments about paging infrastructure update

30979cd4ef-+-nfs: Fix drbd resource definition

49f711dba0-+-nfs: Move labstore secondary cluster hiera config to eqiad.yaml

644391e973-+-nfs: Fix hiera variable access for drbd config

7b785a8c2b-+-nfs: Move drbd resource config to hiera

41e6e1b069-+-nfs: Add script to manage NFS server on labstore secondary cluster

7aef3ee013-+-tools: Grant clush user complete sudo rights for everything

097302db0b-+-fix permissions on changepw script, let all users run it

13dd711c17-+-labstore: secondary cluster setup eth1 using interface::manual

1b3cda0c8d-+-labs: tc-setup param thresholds applied

0da8b45722-+-profile::docker::registry: fixup for I4383ea6e

1f7bfd92ec-+-profile::docker::registry: define correctly the swift password

8700ff6890-+-profile::docker::registry: remove duplicate declaration

91da4d59f3-+-docker::registry: fix parameter passing for swift

7509b20d10-+-docker::registry: fix typos

6ffabd3636-+-docker::registry: puppetization for production

f62c41ac45-+-Add kafka1003 to main-eqiad Kafka cluster

0b962e3a25-+-stream.wm.o: remove old monitoring class

73404cca87-+-icinga: Purge unmanaged local resources

55643846a3-+-Kill monitoring::decommission_monitor_host

c50284ee4b-+-base::service_unit: enable/disable the service if managed here

f83d40fb1a-+-jupyterhub: Safer defaults for authenticator

375e3a5d64-+-jupyterhub: Add module to set up Jupyterhub for paws-internal

0643004d1d-+-Fix typo in mariadb::service include

9d3d29503b-+-labs dns: Add mariadb::service and changes for new package

f113cefa34-+-cirrus - disable the rebuild of completion indices

cf186b8cdd-+-script to change mgmt password

140f07bbb1-+-k8s: install bridge-utils with docker::engine

f2cece013e-+-contint: move php5 install on jessie to nearest user

d32f3c8af0-+-contint: move doxygen/graphviz to labs instances

57f87aabb4-+-maps / postgresql: monitoring uses template1 database

d624529754-+-VCL: allow to load test versions of netmapper JSON files

20021b4ace-+-oozie: Restrict to analytics networks

5bea4cebd0-+-labsdb-toolsdb: Cleaning up tls certificates

83de15022a-+-maps / postgresql: use replication user for monitoring

b803f15e94-+-hue_server: Restrict to production networks

4b52d5a247-+-prometheus: change file_sd_config syntax after upgrade

478f0780ef-+-prometheus: fix ganglia varnish cluster name

ba991e63e7-+-prometheus: move get_clusters to varnish_config.erb

8ad7431a29-+-prometheus: use lists as arguments for selectors for get_clusters

51079caf5d-+-contint: add module xdummy for Jenkins' Android emulation tests

4190d380d2-+-Introduce role/class to manage mgmt interfaces

84b7297575-+-prometheus: generate Varnish targets

47695fa2e1-+-prometheus: generate varnish targets from get_clusters()

5fa9410e92-+-Openstack:  typo fix

31b0147b3e-+-Enable simple-json-datasource on prod Grafana

951372984f-+-site: add varnish_exporter to ulsfo/codfw maps/misc

26dcadf51f-+-prometheus::tools: fix tls_config(s)

51ed796c71-+-prometheus::tools: fix k8s discovery after upgrade

a19d1157b3-+-contint: kvm groupadd is only for android testing

b47a786865-+-docker::registry: drop http host setting

9e6ca266ea-+-role::logstash::elasticsearch: include base::firewall

a2fd3b8dba-+-site: remove explicit role prometheus::node_exporter

f9eb668024-+-docker::registry: allow passing configurations

6de1e1c902-+-docker::registry::web: allow using puppet certs

02919d7590-+-Add 'remember me' checkbox to Horizon auth.

09824fe0f3-+-maps / postgresql: corrected hiera key for replication password

b19bd5a27b-+-maps / postgresql: corrected hiera key for replication password

ca8a94eab4-+-Maps - cleanup postgres user creation

9755e9724a-+-docker::web: allow defining multiple build servers

a3e858f6bf-+-icinga: let icinga own /var/log/icinga

447acd6f0b-+-elasticsearch - enable garbage collection logs on relforge servers

1f43c75aff-+-docker::registry: separate nginx config from the main one

ae8a96a63c-+-install_server: add darmstadtium

90f752aa9e-+-Remove references to psw1-eqiad, decom'ed

f846305d83-+-contint: drop useless require_package

74524c7c66-+-contint: add phpdbg for code coverage

31b17945bf-+-tools proxy: Add health check and icinga monitoring

7d925a644b-+-contint: remove python-requests

7a16b01052-+-prometheus: upgrade to new config syntax

840200dea2-+-decom lead (ex-gerrit)

ddcd0f9636-+-CI firewall: remove lead from the ferm rule, it doesn't exist

e5494d9c67-+-swift: don't track connection to backend services

065d1c7a07-+-docker::registry: move htpasswd file to /etc/nginx

aa09782146-+-Move some hacked horizon files

fb5142464b-+-mariadb: fix class dependency on beta

8132dbb4c8-+-Gerrit: Adding option -XX:+PrintGCApplicationStoppedTime to gc logging

bd9b82f0af-+-clean up instructions for adding new snapshot host

a65ae49b49-+-LVS: document subnets in balancer assignment

8aae2a796d-+-create dumps testbed role for snapshot1001

5d43ff1b69-+-LVS: move git-ssh to high-traffic2 set

d9adc26cdf-+-mediawiki: decommission mw1152

e4edf1a3f3-+-LVS: move ocg to low-traffic set

0d9dcb5039-+-cache::misc: switch noc.w.o to terbium

ca1cd66ac0-+-terbium/wasat: add noc.wikimedia.org

06cd4783c8-+-docker::registry: drop setcap

3356cc4d2c-+-docker::registry: move hiera lookups to the role

da4f8244a8-+-docker::registry: add support for swift storage backend

5b8cd2e809-+-decom palladium from puppet, install_server, network constants

4eab1ba68d-+-standard: deploy prometheus-node-exporter to eqiad

3915d91522-+-Gerrit: Move jvm logs outside of gerrit logging folder

7c0c74fc77-+-Rename potassium as poolcounter1002

99d48538ec-+-puppet: kill manifests/roles, move under $modulepath

efc1d23e6d-+-neon: Warn against neon deprecation

104d373f7c-+-Gerrit: Enable logging for jvm gc

b70546a968-+-Gerrit: Let log4j.properties be read by anyone

e525597097-+-Revert "Gerrit: Have log4j re-read its configuration every 60 seconds"

e961ca3f30-+-icinga: Update the icons

4f7da6ef67-+-Replace neon with einsteinium where applicable

3110624b31-+-icinga: Add einstenium/tegmen in some openstack places

6a7805436f-+-Revert "Install parallel gzip (pigz) and parallel xz (pxz) on all servers"

207ae68102-+-Install parallel gzip (pigz) and parallel xz (pxz) on all servers

59f9cc4140-+-einsteinium: Assign the icinga box roles

d3c8b4dacf-+-proxysql: fix line separator

943a98f016-+-proxysql: Add notrack to firewall

539bfeea86-+-role::tcpircbot: Add an ensure parameter

58ac4168cb-+-Remove absented /etc/icinga/puppet_hostextinfo.cfg entry

aeca4ea642-+-proxysql: Add firewall to labs role

282a226214-+-role: add prometheus ipv6 ferm rules to varnish_exporter

1be74f76d1-+-Gerrit: Clean up cron job definitions

b8e50da4cd-+-prometheus-node-exporter: allow access from ipv6 too

5729397d83-+-proxysql: Fix process check and user permissions; Fix .my.cnf

f524e558b7-+-tcpircbot: Use base::service_unit

ecc3c2dda0-+-proxysql: Fix typos on role

3d4587d8b0-+-postgis - postgis scripts package does not exist for precise

3f83e7b3f9-+-icinga::ircbot: Add an ensure parameter

78dec90013-+-tendril: Install php5-mysql package

788ab2527c-+-reduce cache local ports slightly

8e7ef4659b-+-tlsproxy: raise worker connection limits, too

e23f699fe2-+-tlsproxy: use 8x FE ports to balance

ce282f8091-+-Enable role::tcpircbot on tegmen

9344d7cc48-+-postgis - upgrade to postgis 2.3

f87516e762-+-cache frontends: 8x local ports 3120-3127

19fe85505f-+-monitoring::host: default to $main_ipaddress

622051365e-+-docker::engine: add dependency of the service on the storage

1267bd354e-+-proxysql: Setup dbproxy1011 as a test host for labs::db::proxy

b6e761a88b-+-docker: refactor the storage setup, allow thick pools

ca8b789a70-+-maps::server: move base::firewall to role

4d22469a4c-+-Remove mc1019 from role memcached (new host)

29515250fc-+-profile::docker::engine: enable memory cgroup

9b11ce27ee-+-Add tendril role to tegmen

c89f0920cf-+-monitoring: Add the missed *interval calls

db7c626e66-+-icinga: retry_check_interval => retry_interval

fd00070bce-+-icinga: normal_check_interval => check_interval

b400cf7b25-+-profile::docker::engine: fix docker config

daa38cfd84-+-icinga: Kill /etc/icinga/puppet_hostextinfo.cfg

c96a0b5ae7-+-Create labs::db::proxy role to load balance and failover replicas

f5fe005dbd-+-proxysql: install mysql-client alongside the proxy for admin

be1199b01a-+-profile::docker::engine: add directory creation

9fe46ec38d-+-Add mariadb::services to labs::db

9831f00dde-+-Use mariadb::service; prevent puppet from managing mysql symlinks

f224dc32f4-+-profile::docker::engine: fixups to lvm configuration

5ededd9392-+-apt: Add proxy for security-cdn.debian.org

ef32ed355e-+-kubernetes: install the worker class on the kubernetes1001-4

b5055dd0b5-+-Follow-up I966f6422: Add missing package dependency, fix format call, de-duplicate roles

81419f984a-+-kibana - configure varnish to use new LVS service as backend

e61911cb68-+-kibana - move to an LVS service

485274f8c8-+-maps nfs: Match nfs mount options for maps

24125ed8c0-+-maps nfs: Symlink project and home to mount from labstore1003

4dbf585f36-+-site: add ipv6 for prometheus hosts

63a83a354e-+-eqiad recdns IP fix: switch in puppet

ea68054e01-+-kubernetes: install kubernetes1001-4 as worker nodes

4f9fff5e40-+-kubernetes: introduce 1st-stage worker role

6101f3e250-+-pmacct: move firewall, standard include to role

69f9f96d0a-+-installserver: move standard include to role

84c3341ec1-+-restbase: move standard include to role

f96f0d3c1d-+-role::mirrors: Move base::firewall include in the role

cc2cca0b58-+-Convert ferm::rule deployment-ssh in nova to ferm service

4ed94ef7c8-+-Revert "Phab: Use correct location for phd's homedir"

bb5e13df3a-+-Phab: Use correct location for phd's homedir

9e71b83692-+-maps nfs: Change resource naming for absenting mounts to hack around duplicate resource decl error

8ec556459e-+-icinga: Remove the access_compat removal

f47b19d1da-+-icinga: Fix permissions of a few directories

0038f6b486-+-icinga: Bring the web part up to 2.4 standards

7ffba9fdcf-+-maps nfs: Remove mount at /project sourced from labstore1001

4660f0fc00-+-Icinga: disable event_handler on passive hosts

eb3bb3dae9-+-elasticsearch: Use domain networks

31e0ff02da-+-icinga: Update labtest network::constants as well

a7001c1f69-+-varnish: stop varnishlog on v4 hosts, too

d4d73bb560-+-misc: fix relative inclusion of lvs::realserver

a5bc84831c-+-eventbus: use role::lvs::realserver

11f097dd71-+-Update R and C++-related stats puppet configs

b9eebb76ef-+-role::aqs: convert to role::lvs::realserver

1a5297e228-+-Icinga: raid_handler improvements

2b9cb8d22a-+-elasticsearch: Fully qualify the lvs::realserver inclusion

cb992e8554-+-icinga: fix variable re-assignement

219a14e069-+-icinga: cleaning Puppet dependency that was removed

ce5c55fff1-+-Monitoring: add event handler for RAID checks

16f2eb0392-+-ntp: Update neon specific ACLs to be more generic

28b18cf915-+-url_downloader: move standard/firewall to role

2d7a82ff38-+-base::standard_packages: install quickstack again on jessie

2cba76e9e4-+-role::mediawiki::webserver: silence output of hhvm-needs-restart

713a7176ca-+-notebook: Apply analytics client role to test spark on jupyterhub

2b3f9d2a7f-+-cache_misc: pybal_config: use puppetmaster1001.eqiad only

5ac4bb96e2-+-Revert "labs: Attempt to debug maps nfs client issue"

371d0caa7d-+-labs: Attempt to debug maps nfs client issue

a1552be0ef-+-Add kernel-wedge to package list

cdd0cc5bc3-+-Correct and simplify EventLogging monitoring

59d807a240-+-base::resolving: allow defining additional search domains in labs

298d064e89-+-labstore misc: Add maps project ips as role param

73e76376ea-+-labstore: Mount maps share simultaneously from labstore1003 and 1001

70506065e9-+-role::mediawiki::webserver: fix path for run-no-puppet

74dfb80be8-+-Update doc comment on mediawiki::packages::php5

e150d011ba-+-role::mediawiki::webserver: restart hhvm routinely

82430625f0-+-Add mariadb::service selectively, only on single-instance dbs

7d611078e3-+-labsdb: add include for passwords to views manifest

04d785bcf7-+-labstore: bdsync backup 'test' drbd volume from secondary

d9a24ba6ab-+-bdsync backup setup for labstore

a178a93141-+-icinga: Enable apache::mod::cgi

f59e246e03-+-Point to a folder firejailed thumbor can actually write to

6690ba02a6-+-Revert "mariadb: add mariadb::service for all 10.0 mariadb::packages_wmf"

3f0e9c8be9-+-Port varnishrls to Varnish 4 VSL API

c2799d8209-+-mariadb: add mariadb::service for all 10.0 mariadb::packages_wmf

84d57ad655-+-Add new module proxysql

4805abcee4-+-sca: Fully qualify the lvs::realserver inclusion

bb3da5620e-+-Monitoring: avoid NRPE limit for RAID get status

bb154784c4-+-Tune varnishkafka-webrequest parameters

2bfb88bbc1-+-standard: add prometheus node_exporter in codfw

a4eb75479d-+-postgresql - ensure that correct locale is used to initialise postgres cluster

1e7c74c0ae-+-role::mediawiki::webserver: convert to role::lvs::realserver

2d088f62ef-+-role::scb: use role::lvs::realserver

5ce8b57fd2-+-toollabs: Don't mount /srv in docker builders

b1bcf416b2-+-docker: Don't subscribe service to package

ee06300f24-+-Remove labs puppetmaster certcleaner

d48afa3e0b-+-puppetmaster: Install self signed CA into system store too

1af2bf2c22-+-icinga: Remove the hack around facilities, lvs::monitor

cfe0338bf5-+-tcpircbot: update IPv6 addresses for terbium and wasat

78a79a7266-+-Provide PHP packages for mwscript

984dc7095f-+-role::dnsrecursor: absolute path for the dependency as well

583f6ae9d5-+-role::dnsrecursor: absolute path for lvs::realserver

003426b4bc-+-lvs::realserver: fully-qualify invokations

00f5328aeb-+-role::parsoid: switch to role::lvs::realserver

146c0009ec-+-tlsproxy: experimental support for internal ocsp

91a434c01c-+-lvs: add role::lvs::realserver

9611639c9d-+-Provision poolcounter1001

25eacd18bf-+-icinga: Add headers apache module

8ee714925c-+-Revert "Revert "monitoring: Export based on class icinga inclusion""

f2a9242a0c-+-Revert "monitoring: Export based on class icinga inclusion"

3fa63cfb78-+-monitoring: Export based on class icinga inclusion

04cf1305bc-+-Reimage sca[12]00[12] as scb[12]00[34]

548313399f-+-Test mariadb::service on phabricator hosts

453df0028e-+-site.pp: move bast3001 to the other bastions

d482bdf9d8-+-Parsoid: Install the conftool service scripts

ebe0e0b0bd-+-rsyslog: set retention days to 90 per policy

0d234416a3-+-Add interface::add_ip6_mapped to SC clusters

d69e7158f6-+-Revert "ores: Increase capacity"

507661548f-+-ores: Increase capacity

18d7a2093f-+-Gerrit: Automate slave mode detection

f538a69bd6-+-site.pp: remove "include admin"s

b9639d9d50-+-labsdb: maintain-views laundry list of changes

540c7195ab-+-lists::server: simplify includes on node level

f88bd71965-+-ganglia/netmon1001: rm ganglia::deprecated::collector

c1f6a0de53-+-logstash: move base::firewall from node to role

7850543495-+-contint: remove zuul from role::ci::slave::browsertests

a116558548-+-contint: drop role::ci::slave::localbrowser

424e42b412-+-mariadb: Move db1053 from s1 to s4

84038aa832-+-zuul: refactor to use hiera

51b207054f-+-conftool::scripts::service: port 80 is the default

35267640f8-+-role::mediawiki::webserver: add conftool scripts

2257621e64-+-apertium: Remove trusty support

ba4d669111-+-puppetmaster: replace palladium with puppetmaster1001 as default

531dcb39eb-+-role::cache::instances add pinkunicorn to production conditional

00d5ae91e0-+-lvm: add module from puppetlabs.

9eb5393b7f-+-Conftool: Create script that checks the state after (de)pooling

960dcb0a9c-+-Remove decomissioned mw1217 from site.pp

725416892d-+-peopleweb: move base::firewall from node to role

10dbdbf29e-+-RT: rm duplicate firewall, mv standard incl to role

812873aea0-+-phabricator: Configuration for Aphlict

4be5a75f66-+-Gerrit: Use -delete in log rotation find

9a5bb0f3df-+-Gerrit: Use -name "*.gz" in log rotation cron

939eb2cb39-+-Gerrit: Have log4j re-read its configuration every 60 seconds

42192292dc-+-nfs: Fix params passed to drbd monitoring script

7644f71c70-+-Gerrit: puppetize log4j.properties

2783f2671f-+-Gerrit: Go back to pruning logs every 7 days

3657115cdd-+-nfs: Add sudo permissions for nagios user to run drbd commands

0adfa9c722-+-nfs: Fix drbd monitoring param name typo

b3d36d7a16-+-labstore: Add monitoring for secondary HA cluster health

74cd1a8900-+-dbproxy: Failover phabricator dbs from db1048 to db1043

2ba8be0546-+-contint: stop jenkins on contint1001

1f24be6cdf-+-maps - make sure tilerator notification does not run concurrently

e56f2cf987-+-puppet: Add a message announcing deprecation to role::puppet::self

5b133b4ae6-+-wdqs - activate monitoring of LVS service

8a34e34f5a-+-Remove apertium from sca

461c59b8fe-+-wdqs - move monitoring of response time to service, not individual hosts

a1dad77d68-+-rsyslog: fully port receiver to jessie

14dd276a00-+-role::etcd::common: fix call to backup class to consider cluster_name

17c0ea653a-+-Module and role for Recommendation API

687eb1675d-+-gerrit: puppetize reviewer-counts.json

3906dbe726-+-contint: puppet cleanup for CI master

18354be5fa-+-horizon: Show role::puppetmaster::standalone instead of role::puppet::self

c961b9f85e-+-logstash: let maintenance hosts connect to elasticsearch

6635b7a2ba-+-network/constants: add maintenance hosts (v4)

5b3e943cc2-+-Introduce sca1003, sca1004, sca2003, sca2004 to the cluster

ab8df5efb1-+-cache_misc: removed wdqs probe ref T132457

8541a400e2-+-contint: install jenkins+CI site on contint1001

bc9b043602-+-wdqs - configure varnish to use LVS service as backend

9c539bcf93-+-monitoring: Add an exported parameter to host, service

0979d7e507-+-varnish: add varnishstat dstat plugin

939f6e2de5-+-Refactor memcached role to allow a more flexible hieradata config

0c78bc4e57-+-Add reference to the hw reclaim task for aqs100[123]

598bf8ee4c-+-thumbor: require only instance_service_path

20734763d6-+-Make thumbor use a temp folder controlled by systemd-tmpfiles instead of /tmp

cdfca7aee4-+-ganglia: Remove neon as a gmetad allowed host

4a4fb9fa1a-+-Fix remaining issues with the Pivot UI

a3cae836d2-+-Fix template render bug for the Pivot UI

392be13749-+-Add config file for the Pivot UI

d316a25c40-+-raid: tweak check_interval for forking checks

343370a6d0-+-role::mariadb: Remove neon ferm rules

12b7c48771-+-raid: increase check_hpssacli timeout

779b7092bb-+-cxserver: Fix typo in comment

f57564a2d3-+-cxserver: Deploy Youdao MT service

ed640cdfde-+-udp2log: Restrict to domain networks

e7e2cb6d6c-+-xhgui: Restrict to domain networks

2bfec38ac1-+-tcpircbot: adjust IPv6 addresses of maintenance servers

9924684743-+-add mapped v6 IPs for terbium and wasat

0e62e9299c-+-gerrit: remove lead from site.pp, adjust comment

5e855ce9b0-+-labsdb: maintain-views mediawiki-config checkout

f80a5a1078-+-Qualify more classes to distinguish them from roles

ccd0caaee3-+-maintain-views: externalize dependencies

a07e8e329d-+-gerrit: mv standard incl to role, rm duplicate firewall

4a2059f48f-+-Qualify a bunch of references to ::toollabs classes

78a34d41db-+-Set acks=1 for analytics kafka mirror instances

739ebbc171-+-Move restbase role into role module

8ec2c99391-+-gerrit: remove backup::host, rsyncd include from cobalt

d4708d523d-+-Rename role::labs::tools::* to role::toollabs::*

8922cc3ec0-+-Move wikilabels roles into role module

3ab2fa6d96-+-Move wdq_mm roles to role module

8eb1c06df5-+-Move dumps roles to role module

2cae9864ee-+-Move logging.pp roles into role module

db378a7292-+-Move toollabs node classes to roles.

dc1fc8290c-+-Move statistics role into separate files on modules

ad721ab3fc-+-Move role::puppet::self into role module

81f367a3a9-+-authdns: Move roles to module

52b8042e96-+-labsdb: split off labsdb1008 node def

77cb3608bb-+-labsdb: move init to labsdb::views

394322cdb1-+-labsdb: apply candidate puppet logic for maintain-views to labsdb1008

73effa6c79-+-Gerrit: Fix reviewer-counts.json cronspam by removing \ and "

ed75cfbdc8-+-role::etcd::common: fix auth if inactive

1044e6b687-+-labsdb: puppetize maintenance scripts

30f1012146-+-etcd::auth::common: always install etcd-manage

ad8f43cbe6-+-gerrit: disable reviewer-counts cron job

cfaf83b483-+-Generate stats for monthly package upgrade activity

ceb746c7f7-+-Remove old wikistats cron script causing cron-spam

47a0be200d-+-monitoring_hosts: Add tegmen/einsteinium

20949af95b-+-site.pp: Minor comment fixes

9a8e1041c4-+-Bring back Zend PHP on deployment server

0007b880cd-+-Revert "Revert "icinga: Kill hostextinfo""

5274a1e5f6-+-remove role::cache::2layer

e4c94f5db0-+-Decommission the old AQS cluster

1f2ed39904-+-Add documentation to systemd::syslog and an optional filepath variable

dbc6ec3520-+-Revert "Remove kafka1012 from EventLogging brokers array"

7c4a2de322-+-Revert "icinga: Kill hostextinfo"

07c6048d02-+-icinga: Kill hostextinfo

ba6ef43c69-+-gallium: Open up the rsync port from contint1001

85887e74bb-+-videoscalers: Restrict to domain networks

fa33757f38-+-Add base::firewall to role::eventbus::eventbus

b3425fb209-+-Set default openldap log level to "sync"

ee6164b978-+-icinga: Vary on puppet agent version

2b7f59e9c3-+-vk::webrequest - adjust peak rate estimates

dfbb944fd2-+-Specify mode for nagios_hostgroup and nagios::servicegroup

a3d993c2df-+-Postgresql / postgis: use full package name

281af8854c-+-Recurse => true as well on /etc/nagios-plugins/config

79f0f81933-+-icinga: Purge /etc/nagios-plugins/config

437c30f3e1-+-Change phabricator misc dbs to use puppet TLS certificates

705e42544b-+-Fix wrong Pivot dependency in its puppet class

88aaac7f41-+-phabricator: Create & configure a phabricator_stopwords table for innodb

6286dd0308-+-Introduce the Imply Pivot UI's module and role

2ed4c41a60-+-mariadb: Promote es2016 as the new es2 master of codfw

8535bce525-+-Revert "upload storage: avoid cron restarts while rebooting"

4a1386da6b-+-gerrit/cobalt: fix duplicate role usage

df7261142e-+-labstore: align tools drbd with current prod

6f549b1e74-+-labstore: drbd resource setup sanity

83a83cebbd-+-gerrit: activate gerrit::server role on cobalt

746553a2b5-+-Gerrit: provide a way to specify slave mode

66a50941b7-+-maps: Mount maps share on labstore1003

ff1ad0b7fd-+-gerrit: add rsyncd on cobalt for migrating data

05cc7527da-+-Remove mobile and exdist reportupdater jobs

f2494e9e70-+-contint: allow ssh from cobalt, in addition to lead

b6e8acc091-+-Add $use_ssl switch to role::labs::novaproxy

d2121a241c-+-etcd::auth: fix typo

4b785fef6f-+-kubernetes: add etcd clusters for k8s, networking

c9b70d3842-+-Use the distribution's check_nrpe binary and stop shipping our own

3c75ce2b79-+-monitoring: Kill check_ganglia

83af851fb8-+-udp2log: Remove the $monitor_packet_loss and $packet_loss_log parameters

ffb4a903b9-+-prometheus: add varnish_exporter

712dbe1a6a-+-Re-enable HHVM Icinga checks for jessie

aa9175dd99-+-make cobalt a backup::host

90b20a345f-+-add cobalt site.pp, comment gerrit role, access for gerrit-roots

f172fa1900-+-Enable cassandra/twcs deploy repository

5c71e8f4cb-+-Extend classpath via Puppet

8756f821fe-+-Debian moved back to firefox, stop using iceweasel

942e3d5794-+-noc: Also use HHVM on jessie

b5d971fbd0-+-Add ecwikimedia to the list of private wikis

b9c03e8539-+-upload storage: avoid cron restarts while rebooting

47aa7185da-+-role::icinga: hack to fix icinga config

fc5db08172-+-role::icinga: define facilities on just one host

7c25c84d9e-+-role::deployment::server: create $base_path variable

5baa9cedd4-+-Make nginx optional in aptly class

dd45c34c6e-+-toollabs: Fix variable contains an uppercase letter

e28c403e28-+-quarry: migrate classes to autoloader layout

fb94d48603-+-remove various pointless "bits" references

d99e26d8bc-+-remove old varnish geoip test

78515c6bb5-+-Add base::firewall to role::beta::mediawiki

7f729c97dc-+-ldap: migrate role classes to autoloader layout

3ec8bc53d2-+-Include memcached in role::simplelamp

342a4aea37-+-Added role::labs::sentry

58ec338a23-+-tegmen: Assign icinga classes

db661fed9e-+-Added role::wikidata::builder

f82a578dbb-+-icinga: Parameterize icinga class to not notify

99b98c86f6-+-Add role::labs::bootstrapvz

7409030df6-+-include ::memcached instead of memcached

114fc09e8a-+-Include memcached in role::deprecated::mediawiki::install

a248cd6dee-+-wdqs - LVS configuration

4118c9e805-+-Added role::toollabs:legacy

4a7c8867f3-+-osm - fixing dependency cycles

9ad3e296e8-+-osm - use osm2pgsql from jessie-backport

ff1f1cdf01-+-puppetdb: Only allow connection from puppetmasters

ec77f091ba-+-Fix quoting for br_netfilter kmod configuration

97ae0dcad3-+-apertium: Enable it on SCB

ef35fc9bf7-+-labs dnsrecursor: add olo.wiki(pedia)

8e1f9ebc2d-+-contint: remove Jenkins gmond legacy files

18ee0a2bf4-+-contint: remove the ganglia jenkins plugin

f4d826ba43-+-cache_upload: jemalloc chunk size: s/1MB/128KB/

70c98d8598-+-Remove role::deployment::server from deploymentserver.pp

4527a3ef37-+-Add role::beta::deploymentserver

6ecb3155f2-+-gridengine: use present instead of latest in package

71e9017f22-+-cache_misc: add multicast HTCP purging via vhtcpd

310e096f2f-+-Set l10nupdate group in its related logrotate config file

7a02f49be8-+-Pass nameserver to ipresolve (missed a spot)

d4e3aff18f-+-Pass nameserver to ipresolve

a5c8a3d7aa-+-beta: update deployment-tin IP and make it master

f2de955b47-+-Move mediawiki-converters.profile mediawiki-firejail-ghostscript to all mediawiki servers

34d8e683a3-+-Decommission analytics1015 and analytics 1026

b5d33d5d4e-+-db1019 is going to be decommisioned

6ca2a1f3f6-+-Upgrade memcached on mc2009 to 1.4.28

01ec569e2a-+-role::deployment::server: fix scap3/trebuchet declarations

4c1106cb31-+-role::deployment::server: remove useless scap::server class

02b02c1b87-+-scap::source: simple wrapper around scap_source

01fd90e98a-+-Apertium: Support jessie

92be4c499e-+-Beta: Move beta::deployaccess to role::beta::deployaccess

6db4429ac3-+-mariadb: change phabricator's stopwords and init's owner to root

dea0e47bce-+-Revert "Remove beta::deployaccess as it's no longer needed."

279d10aedf-+-Remove beta::deployaccess as it's no longer needed.

9ee97710b7-+-role::deployment::server: make explicit hiera calls

d819fee76b-+-prometheus: use array_concat, not concat

07cee430d6-+-prometheus: add beta-specific instance

f75285902c-+-text VCL: remove bits.wm.o stuff

33ffceed56-+-l10nupdate:  Add 'su' to logrotate script

0dd7942181-+-upload storage: weekly restarts

c50c956a96-+-remove redundant require

e067038255-+-Move scap package version to class parameter

5543dae4a2-+-poolcounter: move to modules/role

ac1bae8807-+-puppet_compiler: Restrict to labs networks

b4b666afd9-+-Puppetize the upstart logrotate script on Trusty.

9cd275c91f-+-k8s: Make the kubernetes user be a member of ssl-certs group

adc9f49676-+-grafana: Fix paths for grafana datasource plugin

12955ad1a8-+-grafana: Attempt to fix the grafana labs plugin

fadabc4ecf-+-Add simple-json-datasource plugin to labs grafana

21b46a74ca-+-Install python snakebite (hdfs client) on analytics cluster clients

4b08a6f13a-+-puppet_compiler: Fix breakage caused by I76610eb72

d8c85a410a-+-tcpircbot: Follow-up Ide89c59f: Fix missing CIDR prefix on puppetmaster2001

3a699ebde8-+-tcpircbot: remove localhost from ferm rule

af7a304675-+-tcpircbot: Follow-up Ide89c59f: Update ferm rules too

6b7a85bef2-+-tcpircbot: update comment detailing each IP in the ferm rule

76c241c54e-+-puppetmaster: Include base::firewall on frontends

d454ff9ec1-+-puppetmaster: Make ferm rules better

9864e7fcab-+-cache_upload: storage experiment is the new normal

5c846b3c18-+-cache_upload: re-enable daily backend restarts

2ce2697e3f-+-Fix passing extra_schemas

6386a7a953-+-Create a new LDAP schema extension for custom user attributes

12a0a5d866-+-scap: update to 3.3.0-1

254ce9a578-+-mariadb: Add custom mysqld_safe to es200[1234]

097581593b-+-mariadb: merge beta's 305668, 310360 after refactoring; fix dbstore

6f80d4de94-+-scap: introduce scap_source type

943afe2d21-+-icinga: add legal contactgroup to legal footer checks

b70710bcf3-+-labs: Temporary hack to make git-sync-upstream to work

8e378015e5-+-labs: Make labs puppetmaster use the standalone role

8ab99c44a0-+-ganglia: ship native systemd service unit

ff2c487356-+-puppetmaster: Fix typo

ed5784934e-+-puppetmaster: Fix enabling cherrypicks in standalone master

12ceb8ea24-+-puppetmaster: Allow customizing which user owns git repos

6603a06946-+-puppetmaster: Enable cherrypicks by default in standalone role

e7a010b7db-+-puppetmaster: Allow enabling cherrypicks

6b8378c8ad-+-openstack: Import nova_fixed_multi designate plugin

c798ad3e68-+-contint: labs instance all have /dev/vdb

439b1b9e17-+-aqs and restbase: Fix variable contains an uppercase letter

dd56af412a-+-Copy hive-site.xml into HDFS

01dd84e894-+-Delete coredb_mysql module and dependent roles and modules

1d59dca584-+-analytics-backups: unblock 301076 by stop using mysql_wmf class

dc320ce57b-+-puppetdb: Stop storing reports for now

c62af223f5-+-beta: switch deploy server to deployment-mira

2cfe346dc3-+-labs_dns: Fix optional parameter listed before required parameter

7cfa2e485d-+-osm - move logs to /var/log

c841b10837-+-Update the Analytics mariadb config

4461f4f927-+-ganeti: Enable KSM diamond collector

444fb84b1a-+-maps - increase osm replication frequency to hourly

d6fd6024cd-+-ganglia: fix parameter name change

0bd7157949-+-ganglia_clusters: s/name/description/

5722b031cb-+-varnish/htcppurger: don't use ensure => latest

c8d735bb88-+-openstack: Import nova_ldap designate plugin

524f88dfea-+-puppet: Enable ENC on trusty nodes too

a9bc7c0e1a-+-palladium: remove role::pybal::config

5b641cdb8b-+-palladium: remove role::puppetmaster::frontend

0fba3e7ac7-+-puppetmaster: servermon report handler

e5eb6fb4b9-+-postgres::user: Move dependency to pass_set exec

efd634d3be-+-postgres: Allow to not set password for users if not on master

be3e7c180e-+-puppetdb: Have postgres users deployed on slave as well

742dad91b2-+-base: add run-no-puppet

38dc7e9565-+-mailman::listserve: reproduce the debconf order from fermium

251aa26bdc-+-varnish: add varnish-fe restart script

1472fbae07-+-Drop mira.deployment-prep.eqiad.wmflabs

3a451b197b-+-jobrunner: log rotate jobchron.log

1fa8e7043c-+-Reimage: minor improvements

d7094c6b35-+-Beta: change deployment-mira02 to deployment-mira

6ecb96d44a-+-base::puppet: add ca_server setting when needed

8c4650bb9b-+-openstack nova network: update private_ips of instances

ab42ffe108-+-labsdns: Remove mysql grants from non-dedicated services

22340d4560-+-puppet: Use newer ENC

530a74c1bf-+-Revert "puppet: Add option to use newer ENC"

dc4f1eb4ae-+-labsdb: stop using role::mariadb::grants, only used for production

6d52bc8d5f-+-labstore: use secondary interface for DRBD replication

01f6ac0db3-+-openstack: remove unused volume class, update default version

5cdefd4b3d-+-Refactor mariadb role to add role mariadb::grants::production

6aa23e9608-+-puppet: Add option to use newer ENC

665fad54ea-+-nfsclient: Create /data/scratch symlink only if mount is present

440a47e246-+-labs: Setup the standalone puppetmaster to use ENC

0cf94858e5-+-conftool: get conf from class parameters

46f0d51a4e-+-etcd::ssl: fix puppet ssldir path

7ec4f3dffa-+-mariadb: Disable /root/.my.cnf and grants distribution to all dbs

9b6aaf3539-+-mira02 "reimaged" as deployment-mira02

1df25254c5-+-Finish adding --until param to check_graphite script

7d20938316-+-elasticsearch: Remove id_hash_mod.groovy

816acb5356-+-mariadb: implement custom mysqld_safe script to all servers

199f62d432-+-labs: Add config for the puppet enc

2f077c3a67-+-upload storage: no restart cron w/ experiment

4ab94f9cf8-+-upload storage size class experiment

d649e7ba41-+-labs: Add a standalone puppetmaster role

dfe4fb56f4-+-mariadb: Add additional node (db1061) for mysqld_safe testing

f1c4fbdeff-+-Puppet Horizon Panel:  Deploy on Labs

eb273baa83-+-deployment_server: Daemonise redis when running on systemd

bf9bac748d-+-remove nfs mount of labstore host from datasets

661d19e678-+-set up static nfs lock manager ports for dataset hosts

d6c822a100-+-htcppurger: quoting bugfix for host_regex

e9e9308042-+-cache_upload: vhtcpd host regex filter

36d82b8ab5-+-cron_splay() with first use in cache_upload

0148fc4d51-+-Attempt to fix salt key monitoring sudo rule

3571509325-+-Revert "upload: splay restart cron ever betterer"

2eb4b4c4fe-+-upload: splay restart cron ever betterer

cdb1ea82a1-+-upload: splay restart cron a lot better

1b77869abb-+-upload: splay restart cron a little better

da097c1da0-+-varnish: restart upload backends once a day

188daca814-+-salt/icinga: fix permissions to run plugin script

860a843241-+-salt: add Icinga plugin to check for unaccepted keys

2073363db2-+-Update list of mailman site languages

3610285bd0-+-contint: drop now unused sudo rule

5d472cd8b2-+-mediawiki_singlenode: Use require_package instead of package latest

6b3bd11247-+-ldap::client::utils: don't ensure => latest packages

d7605cf49e-+-ldap: Use require_package instead of package latest

96d90f49a1-+-puppetmaster: Send reports to puppetdb

eb888356b7-+-puppet_compiler: clean older output dirs

4436a25cef-+-varnish: add varnish-be restart script

ca8aad2c29-+-templates: move apache templates to the role module

cf1e7ea86a-+-monitoring: validate check_prometheus args

0541c547db-+-exim: move templates to the role module

454672d867-+-apache: fix 42 x 'class not documented', add doc links

4d7478ee48-+-delete ircyall module and role

c09fca5c34-+-Remove cxserver restbase_url

f33ade5db9-+-contint: role for Android testing

478ffed782-+-contint: drop browser test from Precise

9f57494e11-+-Fix puppet warnings in confluent module

e02c08c38f-+-osm: Also allow postgres connection from postgres slave

690a1528be-+-puppetmaster: Delete the post-merge hooks

63dd412c3f-+-puppetmaster: Make puppet-merge a template

e959321aa6-+-mariadb: control db1082's mysqld_safe file with puppet

bd1ab1cef7-+-url_downloader: move templates to role module

db14525c9f-+-Add mira02 to dsh groups for labs

cb0aa22a8e-+-templates: move squid3 to role module

6b449392b6-+-Add mediawiki05 to deployment-prep

639f98bfc1-+-wdqs - send notifications of WDQS lag also to wdqs-admins group

35ea086ed4-+-Postgres: Remove unneeded dependency

327cb74bce-+-postgres: Introduce postgresql::dirs

25d6da6ccc-+-postgres: Fix recovery.conf dependency

311acaace8-+-templates: clean up templates/misc

b3bfd4054c-+-role::mha: move templates to module

a6b86cacee-+-Remove mediawiki02 from deployment prep

c149d35f35-+-standard::mail::sender: move template to module

7e988a12ec-+-toollabs: move templates to role

b3163cc242-+-check_postgres_replication_lag.py: Rewrite parts of it

ce9a599d1c-+-kibana: move templates to role

910434b650-+-role::logging: move templates to role

51ac950c8e-+-graphite: move templates to role

f26c7bd29e-+-postgres: Fix puppet-lint error

6391df0610-+-backups: move templates to module

c4017b4cd3-+-postgres: Allow replication user to connect to all databases

7c84eceae3-+-postgres: Provide new packages class for others to rely on

f4de16fba3-+-role::memcached: move template to module

0d8368320a-+-postgres: Have postgres::db require the server class

d249f48b7d-+-monitoring: add check_prometheus define

8aebee8a98-+-prometheus: add aggregation rules for ops

e186597e7a-+-puppetdb: absent the debian-shipped config file

58a4155d43-+-toollabs: Remove unneeded puppet-lint ignore rules

cc31cd5a8c-+-role: move mediawiki::install to autoloader layout

2b3ec4e647-+-Puppet Panel:  rename panel files

ab1e5e2b34-+-ircyall: move role to module/role

cf26a24ba5-+-snapshot: Fix variable contains an uppercase letter

cb4d8c16ab-+-puppetmaster: Fix whitespace error

5317120997-+-tendril: fix 'optional before required parameter'

a21c145333-+-Puppet panel:  Add per-prefix config tabs

b7670d2019-+-burrow: fix optional parameter listed before required parameter

5f187df72e-+-wmf-reimage: fix puppet clean certificate and facts

a34cdfc5ef-+-archiva/site: remove titanium, fix role syntax

884360c986-+-Revert "archiva: migration class to rsync data to new host"

68a5ce0e4a-+-monitoring: add check_ipmi_sensor plugin

87b38479f3-+-varnish: apply nuke_limit and lru_interval bumps to upload only

0ca4c5bc4f-+-base: install 'freeipmi', 'libipc-run-perl' on jessie

ddbf86e904-+-palladium: Add lint:ignore rules for it

b6db7a2f39-+-Remove defaults from puppetmaster::passenger

a4101749f5-+-puppetmaster::generators: honor the ensure attribute

435c634e48-+-Move puppetmaster::generators to puppetmaster

6ea312f410-+-r::c::instances: split runtime_params in frontend and backend

d1a0c03d28-+-palladium: Set up a motd warning

7ec0318451-+-Simplification of Cassandra Logstash filtering

80f197a3a7-+-Also enable systemd for keyholder-proxy

e8fa5e19f0-+-thumbor: increase icinga retries for service units

94629671ce-+-puppetmaster::web_frontend: fix ssldir

864416a23c-+-Revert "role::puppetmaster::frontend: remove 'puppet' vhost"

32b3e85ea9-+-puppetmaster::web_frontend: fix ownership of files

fdeec79724-+-puppetmaster::web_frontend: use secret() for non-fqdn sites

4c9a7156e0-+-role::puppetmaster::frontend: remove 'puppet' vhost

29dc3508cd-+-chromium: Ubuntu and Debian compatibility

0c17c28875-+-Set differential.allow-self-accept to true in phabricator

c1365fd7ab-+-dynamicproxy: Override nginx worker_connections default

1d424d0481-+-rsync: Fix variable contains an uppercase letter

5faa5f4852-+-facilities: Fix variable contains an uppercase letter

a3ea3c787e-+-Revert "contint:firewall: let phabricator talk to gearman"

be54854221-+-puppetpanel:  Add a 'Project Puppet' panel

c1ebad17d7-+-external_proxy: Respect XFF headers

d0c1b3a0f8-+-base::puppet::params: lookup use_srv_record on hiera.

a96a840d88-+-puppetmaster: Allow new puppetmasters to work with wmf-reimage

9df59c9d15-+-toollabs::proxy: Restrict to labs networks

7de806344f-+-varnish: point pybal_config to all puppetmaster frontends

44a55c7614-+-wdqs - make RWStore configuration file configureable

61cd2f8d91-+-tcpircbot: add the new puppetmaster frontends, remove palladium

6424043ea2-+-base::puppet: allow using srv records

c244fa480f-+-Salt: include password module

c547f2ca52-+-thumbor: add prometheus::node_exporter

243fa6d859-+-Salt: fix source path typo

f4c52b39ce-+-Automation: automatically reimage host

dae9ee3e2c-+-Citoid: Use Scap3 for config deploys

7f58d59955-+-JobRunners: Remove the RESTBase runners

d10937ed60-+-Replace mediawiki01 with mediawiki04 (Debian Jessie) in deployment-prep

000102d1dc-+-Add deployment-mediawiki04 to the deployment-prep Varnish config

473673a9a6-+-puppetmaster: rsync volatile and ca dirs between puppetmasters

b3119289bc-+-Provide systemd units for keyholder-agent and keyholder-proxy

2bdb755bb2-+-Revert "Revert "cache_upload: switch to file storage backend on Varnish 4""

8042aabd07-+-cache_upload: swift conns limit -> 10K

713d22060b-+-tools: Get ssl key for docker registry from puppetmaster

d327a88b88-+-Revert "cache_upload: switch to file storage backend on Varnish 4"

4ec916303b-+-tools: Pick up cert for k8s master from puppetmaster

241ea5d509-+-tools: Provision proxy's cert from puppetmaster

432b9aeb56-+-tools: Provision ssl private key from puppetmaster

57683b9e52-+-Update camus jar version

9e90a526e1-+-Git: fix commit hook

12098f62b5-+-Git: Add username into commit message in private repo

094a71fce6-+-Revert "upload VCL: no probes for be->be"

348f611d89-+-upload VCL: no probes for be->be

5461edd188-+-puppetmaster: Fix typo for .git/config in private repo

5058d14762-+-puppetmaster: Define a gitpuppet group

95565c3521-+-puppetmaster: recurse on /srv/private permissions

c7afe9d4c2-+-puppetmaster: Ship a gitconfig file

f872eb0237-+-Change-Prop: Use Scap3 for config deploys

ad7b734577-+-Remove references to the old virt* servers

02e8387b89-+-naggen2: add --puppetdb switch

474eb03e5b-+-Decom mw2061-mw2074

a4527249dd-+-upload: raise be->be max conns to 10K

58d31add5c-+-Revert "mathoid: add test variable"

cfd55cfc21-+-mathoid: add test variable

6cd6c4592e-+-Mark mw2017 and mw2099 as codfw test app servers

99ae1c02bc-+-Mathoid: Use Scap3 to deploy the config

f7a5820bf8-+-Bump scap version to 3.2.5-1

5abe60966d-+-prometheus::ops: allow using puppetdb

772bdff686-+-labspuppetbackend: Listen on all IPs

c175e90586-+-labstore: nfs-manage-binds a sync-exports replacments

414b1c2173-+-Remove some redundant settings from labs/puppetmaster role

174ad480e7-+-Move labs/puppetmaster ferm rules into the labs/puppetmaster role

8b86a5c8f3-+-Don't use hiera setting labs_global_puppet_master

9d6a83df72-+-base: remove useless fact ::puppetmastername

d720dbcb19-+-service::node: Compile the file holding puppet-controlled vars

7eb8051d3f-+-LVS configuration for maps cluster in eqiad

0cd44f25ed-+-contint: vary ssh from= for prod slave

3b5ac9cf6c-+-ci::master: drop mwext-sync leftover

4b51da5372-+-ci::master: drop legacy definitions

cfec18a3d6-+-Sort by alphabetical order mediawiki::packages::multimedia

238210d45d-+-admin: fix documentation of hashuser

97222309d6-+-Remove labspuppet user creation from production-grants-m5.sql.erb

ad9921faec-+-Grants for labspuppet (user for the labspuppetbackend tool)

7088041c18-+-Include labspuppetbackend on all Labs puppetmasters.

e73a16177a-+-labspuppetbackend: only allow POST from Horizon's IP

0878079fcc-+-labs: Use ENC for labs puppetmaster

c0284178fc-+-labstore: misc apply /srv/dumps via puppet and mounted ensures

e2f315116c-+-Revert "LVS configuration for maps cluster in eqiad"

be967f03d5-+-Add the pivot.w.o domain to the stat1001 misc Varnish director

54f58724b2-+-LVS configuration for maps cluster in eqiad

584a3b8bca-+-role::postgres: Restrict to labs networks

ffb7666b26-+-Replace mod_substitute logic with proxy_html due to perf issues

58247c939f-+-Fix mod_proxy_html Apache module availability

67289e2351-+-Add mod_proxy_http and mod_xml2enc to the apache available modules.

c129fdc423-+-Introduce puppetmaster100[12] to the fleet

a897d7d898-+-Remove role::mirror from carbon

b4f4db7102-+-labstore: misc don't shadow remounts default

6adfb684d1-+-admin: stop passing around a huge data structure

5b5e320e57-+-labstore: statistics and scratch mount definitions

bdf343ec5f-+-Add the pivot.wikimedia.org VHost to stat1001

63785b2c1b-+-Add role::mirrors to sodium

477bbeb904-+-zuul::merger: allow contint1001

84fb44ee80-+-contint: allow ssh from contint1001 to labs instance

aab9d82bf7-+-contint: port labs fw rule to ferm::service

5ef423eb93-+-thumbor: use native systemd memory limiting

ec65e8b4bf-+-thumbor: enable memory cgroup

c2ec791cec-+-zuul::merger: Convert to ferm service and restrict to labs + gallium

2282413efb-+-Add a Substitute Apache directive to fix broken links in the Yarn UI

e7e9b342d8-+-Add the apache::mod::substitute class

7aded7b843-+-ldap: Factor out role that provides ldap.yaml file

f1c43d944a-+-labs: Introduce an ENC for labs

f8cb4d1423-+-sites.pp: rename contint1001 and drop role

6e4d2c7230-+-wdqs - initial configuration of wdqs servers in codfw

74d6d6292f-+-contint: Add some more PHP 7 packages

c2928eae4a-+-labstore: fix manifest declaraton path for labstore::monitoring::exports

856d8f4026-+-labstore: nfs-exportd monitoring into a manifest

6da44320d4-+-puppetmaster::puppetdb::client: add configs, directories

0f7fdc899f-+-Kill references to $::instancename

d41562508f-+-labstore: nfs-exports/nfs-exports-daemons settle on nfs-exportd

385cddbe7a-+-Add the logrotate delaycompress setting everywhere

873d7597f2-+-Really split the mirrors role class

93b71c63bf-+-role::installserver::mirrors fixups

71d5739046-+-installserver: minor simplification of a ferm rule

6f4426cde8-+-puppetmaster: Redirect cron job stdout/stderr to /dev/null

e56e21857c-+-Add modules-load.d/kmod configuration for br_netfilter for Linux >= 3.18

03a4905d44-+-contint: prefer our bin/php alternative

dfa5eb93a4-+-graphite - fix storage_schemas order

8ec74841f4-+-contint: Add PHP 7 packages from packages.sury.org

f027389eb3-+-Move yarn.w.o traffic to stat1001.eqiad.wmnet

4a12b9e3b8-+-role::statistics: Limit to production networks

004e5382c4-+-pybal: Fix optional parameter listed before required parameter

97ceddaf62-+-lvs: Fix optional parameter listed before required parameter

e14d2be1a9-+-statsd_proxy: Fix optional parameter listed before required parameter

27bcc113d4-+-lvs: Fix indentation of =>

dbfcb3a3a9-+-ldap::role::client::labs:  Allow restricted_from and _to from hiera

ae5d53cf2c-+-tools: Provision /srv volume for prometheus

aac718ac50-+-toollabs:  Allow $::node_dedicated_tool to be set from hiera

9f31ea7710-+-role::labs::lvm::mnt:  Allow mount_point to be set from hiera

808f00f9be-+-mediawiki_singlenode:  Move $::labs_mediawiki_hostname to a param

a969a6f502-+-docker: Fix optional parameter listed before required parameter

4828ec4aa7-+-puppetmaster: Fix indentation of =>

6385e99738-+-Add egg-info files for wikistatus plugin.

c532e676a9-+-google_api_proxy: Add role for Google-api-proxy Labs project

4237761ee1-+-nagios_common: Fix optional parameter listed before required parameter

d7a38f99c9-+-deployment: Fix optional parameter listed before required parameter

ad698510b7-+-ganglia: Fix optional parameter listed before required parameter

8ac98ea930-+-manifests/role/dns: Fix indentation of =>

f66cb525cf-+-RT: Drop old code only relevant for precise/magnesium

a54f2c278d-+-Reduce cronspam to root@ from zookeeper zkCleanup script

ce6fcaf138-+-thumbor: fix swift account name

82841a5428-+-puppetdb: fix variable scoping

a446279a42-+-postgres: Ensure postgresl-contrib installed

d59e38cce7-+-Fix Yarn apache configuration with the missing ldap password

db64c79567-+-openstack: Import openstack-wikistatus nova plugin

a8a88a9cea-+-swift: add thumbor configuration

adb2651e63-+-Add a proxy to the Yarn UI on stat1001

39188f3b3b-+-labstore: ignore autoloader layout lint error

dec54ade1e-+-puppetdb: Cast settings::storeconfigs_backend

2311e2e79c-+-puppetmaster: Fix /etc/puppetdb.conf

ab769d5cf9-+-ssh::client: allow using puppetdb

293996423e-+-puppetmaster::puppetdb::client: fix typo

a0b94f4c3d-+-postgres/osm: Restrict to labs networks

f8b7c0e269-+-puppetmaster: Add apache::mod::lbmethod_byrequests

6f79bc01d4-+-puppetmaster: absent the post-merge hook on backends

8737885809-+-On git masters, make /srv/private gitpuppet owned

9cf53d1123-+-Rename ferm service for postgres/puppetdb

cc3bd050a2-+-Revert "google_api_proxy: Add role for Google-api-proxy Labs project"

14c72b33d0-+-google_api_proxy: Add role for Google-api-proxy Labs project

d3bf0a5f77-+-wdqs - move data to /srv

d7851946e1-+-openstack: lint, fix optional parameter listed before required parameter

63d8cff5ae-+-pybal: Puppet 4 compatible require_package invocation

e2f4929b2f-+-openstack: Fix indentation of =>

b4a5d58ac7-+-puppet::self: Merge the standalone statements in the hash

756bb36550-+-Use parentheses in all custom functions

6527e12e57-+-mysql_multi_instance: Remove duplicate keys

69cf7b7e30-+-openstack: Fix optional parameter listed before required parameter

589e82e7f9-+-postgresql::server: fix service name on jessie.

0a00ca5c66-+-Salt: reducing permissions on the master's Job cache

06347cda2d-+-role::puppetmaster: removed useless quoted booleans

2507072d2a-+-puppetmaster: allow using puppetdb as a backend for storeconfigs

b1f0e16a88-+-allow test module commands such as test.ping to be run from palladium

7cad71f511-+-thumbor: add firejail profile

f11947f40e-+-2fa: Fix file name

1aa649ba17-+-role::xenon: don't bind to localhost for redis

918f3c15de-+-role::xenon: fixup fluorine for redis config

de84fa17e0-+-role: 2fa => twofa

01aa175cf8-+-elasticsearch cirrus - align configuration for deployment-prep

9fda495cd4-+-puppetmaster2001: add conftool::master role

89f9ddee36-+-kibana: Restrict to domain networks

5b19fd684b-+-redis: manage our redis common config with puppet

783d3dc14e-+-role::rcstream: move redis settings from legacy config file

ebf03d9d96-+-cgred: Fix indentation of =>

cedc0fc10a-+-puppetmaster: Fix trailing whitespace found

4672cc3e72-+-puppetmasters: Allow ssh puppet-merge from all frontends

a4d4c169aa-+-Revert "puppetmaster: Vary ssldir in frontend on masterness"

de65b6349b-+-puppetmaster: Vary ssldir in frontend on masterness

ddc298700c-+-puppetmaster: Pedantic whitespace fixes

eacb48695e-+-Fix wrong dependency in puppetmaster::gitclone

334d890aae-+-puppetmasters: support multiple git masters

464c31bc0a-+-site.pp: Use role keyword as a function

15c985fb61-+-sslcert: ignore WARNING: puppet:// URL without modules/ found

1ddfb1bd17-+-openstack: lint, fix alignment

df6689d57f-+-swift: ignore WARNING: puppet:// URL without modules/ found

9f5cea30a5-+-puppetmaster200{1,2}.codfw.wmnet: Set up as puppetmasters

02a2c58259-+-Remove strontium remnant from site.pp

8a4237084b-+-rcstream_redis: Limit to domain networks

af0c9cf2f7-+-discovery-stats: only collect maps usage hourly, not each minute

38d4720d96-+-labstore:  run nfs-exports-daemon on all servers in a cluster

fadb1912e0-+-maps - use new tileshell.js script to notify tilerator of expired tiles

8284ebac32-+-delete misc::monitoring::view::analytics::data

334dfed167-+-contint: tidy Nodepool slaves config history

249ba7a6e4-+-Install mc and unzip on stat1001 as per request from ezachte

ba930a2e8e-+-discovery-stats: fix script name

0ff5ece9f3-+-discovery-analytics: fixing logrotate rule name

7ef8062d9b-+-discovery-stats - git::clone needs to be in an empty directory

c288272fea-+-ganglia: Remove the Corp OIT LDAP mirror cluster

bf5bc151f3-+-ganglia: Remove nickel remnant

53632ed1d9-+-ganglia: Define install2001 by FQDN, not IP

43bfb73251-+-ganglia: Make the ferm statements conditional

739098992b-+-aptly: move role to modules

47411d2a18-+-Discovery stats module

08d8c33962-+-Remove decommissioned host rubidium from site.pp

288482e22e-+-Create /srv/math-images on wikitech hosts

9bb242f6ba-+-Revert "package::builder: EXPERIMENTAL=yes support"

0a5f4f5ef3-+-Reportupdater should rsync to ::srv module instead of :www

ccb356b98c-+-Revert "Pare down the cloud-init commands on precise"

4a5378a5e7-+-Rename the labs instance setting labs_puppet_master.

e7414f908b-+-Set up a root password for Labs instances

1970ae3438-+-elasticsearch - move relforge to its own role

b594391237-+-Change-Prop: Removed unused config properties

11c7b20efe-+-package::builder: EXPERIMENTAL=yes support

9b5ff5a6cb-+-Remove g+w flag to /srv/log/eventlogging to allow proper logrotation

6c1c8415ff-+-keyholder-proxy/agent: Convert to base::service_unit

e6dd334084-+-elasticsearch - disable cron to clear elasticsearch caches

3d8d41be1f-+-url_downloader: add IPv6 support

fc8ed74521-+-extdist: Fix typo in comments

90b2d031d3-+-wikistats: remove $realm check, simplify role

8fdf860d8a-+-contint: fix resource conflict with service::deploy::common

f159763654-+-Phab: Remove config abstraction. Useless & confusing

beeaded480-+-Pare down the cloud-init commands on precise

4b9ebfdb8e-+-nfs: Modify /data/scratch on nfs clients to point to mount from labstore1003

d5c192900a-+-iegreview: Switch from Parsoid to RESTBase

761401e131-+-thumbor: use 'mw' as thumbor account

4b73d22942-+-Install labs::openstack::nova::network on labnet1001

e533234829-+-beta: Use Let's Encrypt cert

e852c4f6fa-+-Parsoid: Switch to Scap3 deployments

4f55175d4e-+-prometheus: add node_exporter to syslog servers

b1f1685251-+-swift: allow disabling account stats

22c5ad2fb8-+-base: support for multiple syslog hosts

552ecc8268-+-Clean up unused AQS to Hadoop firewall rules

c1f4bce728-+-Specify minute param for git pull cdnjs cron

5acfa55f96-+-releases: Add wikidiff2 directory

a330be8a35-+-releases: Set mediawiki directory to 2775

663155d32f-+-releases: puppetize ownership of /srv/org/wikimedia/releases/mediawiki

85396247d5-+-toollabs: Convert cdnjs pull cron command to one line

de93e39b97-+-Remove the hard-coded /a/mw-log references scattered around everywhere

582caa3e4a-+-archiva: migration class to rsync data to new host

21f4290697-+-Don't page if druid-eqiad zookeeper cluster has a server down

dbf8fed454-+-contint: stop including arcanist on Precise

2eabe6241f-+-contint: bump pip 7.0.1 -> 8.1.2

1a92f11334-+-logging: remove reference to deployment-fluoride

d2897fc246-+-Set up Zookeeper cluster for Druid

c4b0398479-+-prometheus: add to LVS

52d8ce8b34-+-labsdb: Add firewall to new labsdb databases

c38c86e144-+-Raise the Varnishkafka maximum timeout for incomplete records to 1500

541c9f5550-+-ganglia: Use ferm::service instead of ferm::rule

ffc7303f0b-+-site.pp: Remove $ganglia_aggregator node scope variables

0ec7ad834b-+-Provide a systemd override unit for hhvm

9070ae1432-+-elasticsearch - check shards via the service, not via each individual node

2bc52ab6eb-+-toollabs: install pdf2djvu

188a69d4bf-+-cassandra: add ssl monitoring only for ssl-enabled hosts

7f39a3156c-+-installserver: put aptrepo role also on install2001

31fc089cdf-+-rabbitmq: add rabbitmqadmin for control via mgmt plugin

3053cc8b30-+-openstack: remove old OpenDJ log file parser

9fcb5be5b4-+-Install openstack::horizon::puppetpanel on labtestweb2001

ee1a81cc23-+-Horizon tab for modifying instance puppet config

aa9f85111f-+-labnet: Merge site_address and network_public_ip in novaconfig

120b943135-+-es2001-4: add node exporter to this standalones hosts

f8bb73b4c6-+-toollabs: Set timeout 0 on cdnjs git clone exec

cabfcf3bbe-+-toollabs: Remove puppet dependencies on git clone cdnjs

c0365e7a95-+-toollabs: Convert puppet clone of cdnjs to cron

324294a7ac-+-nrpe: remove redundant ferm::rule

d83678b0ee-+-logging::mediawiki: Remove redundant NRPE ferm::rule

1f85abd791-+-Bump scap version to 3.2.4-1

6f2862f390-+-prometheus exporter: avoid still existing precise hosts

43b91a1cfe-+-cache: vary statsd_server with hiera

b8a8f51fe2-+-Revert "Provide a systemd override unit for hhvm"

4353f28713-+-Provide a systemd override unit for hhvm

a0b3aafff1-+-mysql: Clean up puppet code related to code databases

da28852013-+-Raise the Varnishkafka maximum incomplete transactions to 5000

897ef7e8b4-+-Labsdb: include labs salt groups and prometheus monitoring for dbs

566d6e7768-+-ores: Define extra config for ores

3d639672de-+-Disable unprivileged user namespaces on labvirt nodes running 4.4 HWE kernels

247db019a9-+-Ship a script to rewrite group memberships after enabling the memberof overlay

cc4a6f14a7-+-Specify a path for the django compression exec

7f7782495a-+-Compress static content for Horizon

41ba78a0bb-+-clush: Put clush config in correct location

766218b40f-+-tools: Add a wrapper script to enforce clush access

0b5232b33e-+-Added filtertags to labs role descriptions.

7959306a2c-+-clush: Fixup missing dependency + secret

c4e4ddc3cc-+-Introduce 'clush' module and toollabs role

6c5a64d3cc-+-puppetmaster::frontend: get workers from hiera

25a1c97040-+-puppetmaster::frontend: raise priority of the 'puppet' vhost

a9cede3026-+-mariadb: install node/mysql exporters in eqiad too

15fe99674e-+-puppetmaster::web_frontend: remove unnecessary require

13be7c6d20-+-prometheus: restrict node_exporter to $prometheus_nodes

83e8d56598-+-puppetmaster::frontend: add vhost for FQDN

d75d878aef-+-puppetmaster::frontend: move vhost to role

7677051cb6-+-Fix puppet issues generating empty files for mysql configuration

a1c44a8a28-+-puppetmaster: move vhost from passenger class

8ba7d81257-+-Puppetize static configuration for prometheus-mysqld-exporter

b418fbaf01-+-puppetmaster: split backend and frontend vhosts

2379fb9da9-+-openldap_labs: Limit to production networks and labs networks

7203684bd2-+-puppetmaster: add ca and ca_server settings to frontend

e58aa78b5b-+-puppetmaster: extract the passenger config from the virtualhost

f0b8c57f8a-+-puppetmaster: add puppetmaster::web_frontend

a004a13ea2-+-role::logging::mediawiki: Restrict to domain networks

16fb45f190-+-striker: require passwords::striker

a8f53d6a0c-+-Add toolsadmin.wikimedia.org to misc varnish

a791e75fba-+-striker: Replace nginx with apache

e00cc1d0f1-+-installserver: remove duplicated TFTP part

431d0072e6-+-The labs puppet backend now requires python3-yaml.

8391d535e5-+-tftp_server: add bacula backups to role

8a3de284a7-+-aptrepo: add bacula backups to role

8f85d54bb4-+-labstore: Change nfs mount removal logic to not declaring it as file resource

9a5bc5f1ff-+-striker: Set nginx variant via hiera

52460e5668-+-Git::clone: rename $default_source to $source and add github

912399adc8-+-Monthly update of the "slowest" querypages on the English Wikipedia

c668caada6-+-varnish: fix jemalloc chunk size config option name

050b10c5b1-+-ipsec_allow: Restrict to domain networks

3c786647fd-+-nagios_common: use require_package

a2659a8dfd-+-nagios_common: add check_prometheus_metric

085a0b1d2a-+-Kafka brokers: Limit access to production and fundraising networks

8ae820dd0c-+-Quote ARGS parameters for trusty compatibility

bf86143048-+-Provide override file for base::service_unit

7936d4f612-+-graphite: parametrize cors_origins for labs

4d7e68c921-+-Revert "Revert "Specify home directory for phd user""

6a2f96bf67-+-Revert "Specify home directory for phd user"

1ff170cbcf-+-Specify home directory for phd user

8a4cc8790f-+-Fix race in puppet::self (puppet.conf compilation)

1bcb795651-+-udp2log::instance: require psmisc package for use of killall command

6e2ec36e92-+-tools: Don't have static inherit toollabs baggage

a43aadb87e-+-recdns: re-add chromium to LVS nameservers_override

ac91711324-+-striker: Require trusty, not jessie

73b4460022-+-Provision Tool Labs admin console (Striker) on Californium

07eeab4bdf-+-recdns: remove chromium from LVS nameservers_override

9e1a3f7024-+-ores: Use need-plugins to load stats_pusher_statsd

badcd0e4df-+-Provision Striker via scap3

f2dd5dc5e7-+-recdns: remove chromium from LVS nameservers_override

c65f77c5cc-+-logstash: Tag Striker messages for indexing

208913dddc-+-Revert "logstash: new input for msgpack over UDP"

39bffc9c2c-+-Fix mysqld exporter prometheus config not working in trusty

b36263d6ca-+-Configuration changes regarding mysql exporter for prometheus

06e50cfeee-+-contint: Java 8 on Jessie slaves

b0fe1c6c28-+-rsyslog: switch log owner based on distro

05dcfd9262-+-Disable unprivileged user namespaces on trusty systems

7acecee72a-+-site: add codfw syslog server, wezen

dc91f0b74a-+-contint::firewall: Limit to production networks

9d629331d9-+-Revert "Gerrit: make auth_type configurable for labs"

372642acfe-+-Gerrit: make auth_type configurable for labs

3cc7df8aca-+-diamond: sge stats run from the services hosts

bfbc373420-+-Revert "recdns: remove hydrogen from LVS nameservers_override"

5ed7a62cb7-+-Revert "Scap3: Go ahead and `scap deploy --init` a freshly provisioned repo"

49fe3abc58-+-Scap3: Go ahead and `scap deploy --init` a freshly provisioned repo

83e31842a2-+-recdns: remove hydrogen from LVS nameservers_override

d7e5b7a925-+-mediawiki: include fonts in role::mediawiki::webserver

49a3479a3c-+-scap: bump version to 3.2.3-1

2a1ee1d15f-+-cache_upload: switch to file storage backend on Varnish 4

0923716487-+-contint: use require_package for php5

f2a2a872be-+-nfs: cleanup nfs-mount-manager.sh references

ae65e6dc28-+-tools: Add script that helps manage sge exec nodes

1562a14dad-+-standard_packages: add moreutils

905b3b3e7d-+-wdqs: Limit to domain networks

6403f20041-+-logstash: new input for msgpack over UDP

cb1250d46a-+-ChangeProp: Update config for the new driver

7ee640c9df-+-puppet_compiler: noop for prometheus-ganglia generator

8fd01c3f8a-+-prometheus: add logging and rotation

331eb24b94-+-scap: use conftool data to populate dsh groups

b402dd1cd0-+-tools: mount scratch on labstore1003 as well

04e7765cf0-+-labstore - Clarify drbd resource initialization docs

400f3dab7a-+-nova-computer: add virt-top package

8fa9507b6b-+-Make Updater proper service

543d9d05ff-+-cache_misc: Allow PATCH requests

3409394fc2-+-Revert "scap: use conftool data to populate dsh groups"

524c191e77-+-scap: use conftool data to populate dsh groups

184a777e76-+-mariadb: collect prometheus stats in codfw

5c07786f25-+-mariadb: add mysql/node prometheus metrics for db2034

baab42ef7d-+-puppet_compiler: allow compiling manifests using the conftool function

8498654ac8-+-statsd proxy: Limit to production networks

adf1bb2076-+-puppetmaster: install conftool

d903e250be-+-package_builder: Add php5-dev to list of installed packages

3d89647f00-+-package_builder: Add dh-php5 to list of installed packages

cd4d2ac253-+-package_builder: Add pkg-php-tools to list of installed packages

79314d0386-+-enable runs of missing prereq steps for dumps at later step

6b8757ddc4-+-put installserver::dhcp on install1001, install2001

f1d28ce637-+-installserver: split DHCP part out into own role

97a7bb0cd7-+-nfs: Fix disk path for drbd resource test

39e295f40e-+-labstore100[4|5]: define initial labstore::drbd::resource

854a268070-+-labstore: drbd framework for software based HA

995b8a6421-+-cassandra: limit SSL cert monitoring to restbase hosts

d842ab78fe-+-cassandra: add instance ssl monitoring

e198a6b90d-+-udplog: stop requiring udp-filter

e714dd27c2-+-service::node: add scap::conftool when relevant

8f5d76d49f-+-scap: add conftool class

7d3e52a348-+-Prep varnishd for libmaxminddb-based VCL

f090f2fed4-+-Port varnishmedia to new VSL API

9446653938-+-Port varnishprocessor to new VSL API

69e7f89be5-+-ores: Add memory report to uwsgi

9486cc23c1-+-Add public logic for grants to m5 db for striker application

03d72a95dd-+-reduce cronspam, eliminate dataset rsync whines about vanished files

cf304f485b-+-phabricator: only run dumps on active server

f528c2779e-+-phabricator: don't run phd on inactive server yet

d8fd5ec1dd-+-phabricator: allow ssh between servers for cluster support

ae11304007-+-phabricator: don't run logmail crons on inactive server

20be9d973c-+-dynamicproxy: Add nginx config to redirect www.wmflabs.org/wmflabs.org to wikitech

f21de957e9-+-beta apaches: Delete Apache::Site['wmflabs'] too

9a73e73b18-+-mediawiki::php: /etc/php5/apache2 provided by php5-dbg

f1da3f1bcc-+-Remove bits.beta.wmflabs.org

526274e351-+-Mirror all topics in main-eqiad topics into analytics-eqiad

5bd5047fb8-+-nodepool: use integrated statsd reporting

3e6a12497b-+-apache conf: Allow source and content to be undefined if ensure is absent

ca334c5cca-+-Mirror codfw* topics from Kafka main-codfw to main-eqiad

b6b6c960f8-+-Set varnish::common::varnish4_python_suffix

343e011e77-+-Maps - increase Posgresql max_wal_sender

d50f32af1c-+-Enable MirrorMaker from main-eqiad to main-codfw

54e90294d2-+-Refactor zookeeper cluster config so it is available in all hiera scopes

e3407ba5f2-+-Graphite hourly / daily schema

878c0cc57a-+-Logstash: Enable log4j provider

abd2952e76-+-thumbor: get realservers_ip from hiera

71fe88c6ff-+-Remove statsdlb, unreferenced now

0cdc1f7214-+-Postgresql - duplicate declaration of psycopg package, without appropriate guard.

749d90056f-+-Postgresql - check_postgres_replication_lag.py requires psycopg

b8b07d602c-+-puppetmaster: Only create puppetdb user on the master

f7c36079af-+-redis::instance: use specific aof/rdb file names by default

bccaedb5f0-+-dynamicproxy: puppetize appendfilename setting

57551715a8-+-site.pp: fix/add some node comments

2bfe0f9768-+-phabricator: only send SMS for issues on active server

7a43098f84-+-Removing kafka mirror from main codfw hosts.

1400de1017-+-Fix dependency cycle in confluent::kafka::mirror::alerts

30c8100c1b-+-confluent::kafka::mirror::alerts should require instance define properly

846add2431-+-Mirror main-eqiad into main-codfw

39d94cf689-+-puppetdb: Set up postgres replication lag check on slave

138a631037-+-postgresql: Fix silly typo introduced in a19cbb7

45d874d8fc-+-maps: Set up postgres replication lag monitoring

a19cbb741c-+-postgres: Provision a replication lag check script

b1a9b39c38-+-Introduce a hourly storage schema in graphite

a84d7489e0-+-Elasticsearch - use unicast for discovery by default

0ddb9e2d62-+-ores: increase ores workers to 40 per node

4b63cc2d82-+-WDQS - fix icinga graphite check, metric has been renamed

769419d837-+-Extract /etc/profile.d/umask-wikidev.sh to a shared class

cb27386a3e-+-phabricator: add systemd unit file for phd service

29fe03f9aa-+-package_builder: Add gradle to list of installed packages

146ac1f064-+-package_builder: Add gradle to list of installed packages

5e7923bb17-+-labs: nfs client

808c32fb61-+-labstore nfs: nfs client mount manager

34ed385236-+-caches: reduce FE mem size: 50% -> 40%

2274a09e2c-+-Introduce aluminium.wikimedia.org

aa5d572747-+-package_builder: Add maven-repo-helper to list of installed packages

bdeb41b856-+-url-downloader: Remove the role from chromium/hydrogen

b1492be5a9-+-puppetmaster: add puppetdbquery module

5050b99fba-+-remove nobelium from puppet and install-server

4983e09109-+-ores: Enable uwsgi-specific statsd setup

e6f42d4b60-+-reduce cronspam: filter out dataset rsync error messages about vanishing files

694e0af398-+-Use hiera for udp2log-mw logrotate count

67c7c5cd1c-+-Gerrit: Use debian-provided mysql-connector library

7273e4651f-+-Gerrit: Default $db_host to localhost

01e607ddec-+-labs: Enable libvirtkvm collector

3e1998e238-+-labs: Enable only disk stats collection for labs instances

017b620cb6-+-Confluent MirrorMaker puppetization

ea2329c6c0-+-Remove now unused kafka module

236f30a765-+-Prepare for upgrading Kafka main-eqiad to Confluent Kafka 0.9

b225d50771-+-Remove newline from rendered password

49cc7fdfb4-+-Lower down the maximum kafka topic partition size to 350GiB

519042904e-+-labs: Don't open everything to prometheus hosts

ead2637936-+-tools: Allow multiple k8s master to access etcd

0bb8ad2b3a-+-Use require_package and make sure python3-docopt is on analytics cluster clients

58cc249023-+-Fix path to jenkins homedir for nodepool slaves

b2d85ed05b-+-Qualify path to echo in hdfs_put_mysql-analytics-research-client-pw.txt exec

212302bce0-+-Render analytics-research-user mysql password in hdfs so that we can automate sqoop via Oozie

3e91d62591-+-tools: Stop checking labs puppetmaster via toolschecker

a8c204f886-+-Include sqoop on all hadoop workers

6128fb5269-+-Add python-docopt to the Hadoop worker nodes

7296e320ca-+-Update camus job to use new check_jar

9353db739b-+-cache_maps: switch to file storage backend

887085a0b0-+-Maps - categorize maps1002 in site.pp

de8f979cff-+-puppetdb: gc-interval is in implicitly in minutes

5c7abfa1ae-+-puppetmaster::puppetdb: further fixes to users definitions

f769825ade-+-puppetmaster::puppetdb: add dhparam, fix typo in postgresql ssl.conf

417dcb5b18-+-postgres: Add the LSB pgversion selector

7934040264-+-puppetmaster::puppetdb: minor fixes

d5203c79f0-+-puppetmaster: add role for puppetdb

b32dd25950-+-Bump heap limits for Parsoid from 600 mb -> 800 mb

01f0b51d9e-+-postgresql: support SSL connections/replication

e86784be6a-+-labs: Disable libvirtkvm collector for now

9f4e2c4d74-+-lab: Sort libvirtkvm metrics by uuid

f9ac396d8a-+-labs: Add labvirtkvm collector

13e3007b07-+-Revert "Don't install root password if has_admin = false"

8857802fed-+-toollabs: require redis::client::python instead of redis::instance

b1bffd8036-+-toollabs: re-enable redis collector

184943bb4b-+-ores: increase number of workers to 32 / node

ec66acff7b-+-nutcracker: do not validate nutcracker config before creation

6295bdfe82-+-Install package varnish-modules on v4 hosts

a3c18a11f3-+-Retire db2008 and db2009 as x1 nodes

8731551d1b-+-role::dataset::common: Limit to production networks

06a57449c4-+-Maps - categorizing new eqiad slaves

1e01ec80b1-+-Maps: Added list of cassandra servers

66dd240e3c-+-puppetmaster: Kill is_labs_master

0a655aae7a-+-vagrant-lxc requires ruby build dependencies

2fb9285fc2-+-rcstream: remove internal TLS listener

9b40b03a49-+-puppetmaster: Split extra_auth_rules from is_labs_master

17ff446e70-+-etcd: Use DOMAIN_NETWORKS

6c0c0353e7-+-Remove labsdb::manager

c75bc399a4-+-labs: Allow ssh access from per-project prometheus hosts

a4668edade-+-Stop icinga git remote update

76901c63a0-+-prometheus: Don't require jessie for node exporter

9cf2a10855-+-prometheus: Restore node exporter prefix requirements

2bec0332be-+-tools: Add ssh checks to prometheus

e908c76067-+-prometheus: Use 4sp indent rather than 2sp

bae928074a-+-tools: Increase centralized logging retention to 14d

ff6c370f6f-+-prometheus: Add blackbox exporter role/class

e728f3317b-+-ganglia: Limit to production networks and fundraising networks

f243c14e7c-+-CVE-2016-5696 mitigation

7f5396ec0c-+-Add error_output to eventlogging service and make eventbus write EventErrors to log file

61ace06740-+-restbase: allow pooling/depooling programmatically

c49a792b45-+-puppetmaster: Split secure_private from is_labs_master

7c831dbee3-+-openldap::labtest: Restrict to production/labs networks

fde1006de2-+-prometheus: Don't require scrape config files to start with node_

20409a2cab-+-tools: Scrape etcd metrics too

8773ea5611-+-tools: Expose etcd /metrics end point to everywhere

c9f4fd4fac-+-ores: puppetize number of celery workers

95eedadf07-+-Revert "Replace code to generate labs root passwords."

4727825342-+-Turn on spiceproxy and consoleauth on the labs controller.

21242d2e87-+-Set up 'labspice' in misc-web

a0c330fdad-+-graphite: Set xFilesFactor to 0 for sum/count.

183fbad702-+-Replace code to generate labs root passwords.

e9ce269c1f-+-Revert "Revert "Temporarily remove the code to generate labs root passwords.""

b03b7d50f5-+-Revert "Temporarily remove the code to generate labs root passwords."

d02163088d-+-Fixups for labs password generation:

6eb5f2449f-+-Don't install root password if has_admin = false

1d613cbef2-+-Temporarily remove the code to generate labs root passwords.

8316f4a5d3-+-Labs: Generate/store root passwords for instances

bb87632009-+-turn on checkpointing for dumps of jawiki, commonswiki

0742346e69-+-vk webrequest: use X-Cache-Status for cache_status

d53597b6a4-+-ores: uwsgi workers restart after 200 requests

a31ef8b18d-+-service::node: Allow users to specify the logging name

0b82a6e257-+-Move the include of cassandra/aqs passwords up to solve a priority issue

03a4928294-+-Include the password::aqs namespace in the AQS role

3d6e870e2f-+-pybal_config: Use PRODUCTION_NETWORKS

881871d3c1-+-Monitoring: Add NRPE commands to get RAID status

9b835e767e-+-druid: Limit to analytics networks

fd71021c56-+-puppetmaster: Merge labs and production auth.conf templates

0f10e13d2d-+-Revert "prometheus: Add devstat collector to default set"

2757c5051d-+-puppetmaster: Cleanup some labs intrusions

73688d96ab-+-prometheus: Add devstat collector to default set

1d7f81a74b-+-labstore: Pin dependencies of python3-ldap3 as well

e553371a62-+-tools: Send logs to multiple servers

61a7b29c26-+-Increase retries for eventlogging analytics processor kafka producers

58f9692bf6-+-tools: Use LDAP servers in HA manner for maintain-kubeusers

b8393591cf-+-labstore: Break dependency cycle

ce745524d6-+-labstore: Configure LDAP failover + timeout for create-dbuser

4df4d3765d-+-tools: Don't include etcd in k8s master

4c33dd02c1-+-Package builder: ensure libdistro-info-perl is installed

ee7f796610-+-Do not force merge (optimize) indices on logstash

dfeb0c8cf2-+-Do not force merge (optimize) indices on logstash

053e88aac1-+-Do not force merge (optimize) indices on logstash

179a735f07-+-Remove accidental non ascii character

e4732cfc45-+-Remove extraneous eventlogging configuration

1fc36bd4d5-+-install_server: add dhcp entries for the puppetdb VMs

3460bd80da-+-ores: puppet changes for the refactor

042ee7bef9-+-Enable base::firewall for palladium

45c1002006-+-puppetmaster: Fully depool palladium as a puppetmaster

ff02c8556f-+-Revert "Henceforth, recommend linux-image-generic-lts-xenial for compute nodes."

bd1ba8c812-+-zosma: add mapped IPv6 address

78532c3198-+-planet: add mapped IPv6 address on VMs

a02bd80b12-+-gerrit: let gerrit2 user write to config dir

5e71ae12e0-+-Gerrit: Allow gerrit2 user/group to write to its config files

8709a45998-+-Fix HDFS logrotate filepath

7fd6ae83e2-+-Add a logrotate policy to the hdfs-balancer script

6ea381c225-+-elasticsearch: Remove cruft notice

03167403da-+-Phab: Properly remove public_task_dump.py if $dump = false

8b6e85f9f7-+-strontium: Remove from puppetmaster workers entirely

91dbc82efc-+-Remove pagecounts-[raw|all-sites] related code

bb7998720a-+-strontium: reimage as a puppetmaster::frontend

94a63e328d-+-strontium: depool, palladium: lower the load to 1

ed136931b9-+-tools: Don't keep port 8080 open

24a79289ac-+-tools: Move log sender to generic role

c6580063de-+-toollabs: Don't have icinga check for webservice

6ec7c14b1d-+-I can't stop making typos

c9e4b20be8-+-typo fix re: spice package name

11303da478-+-Changes to spice proxy to work behind misc-web:

ed18bdacb3-+-rhodium: Ramp up to the same load as strontium

070d671da9-+-Rearrange proxy setup for spice consoles.

ac5d443bd4-+-cassandra: don't run validate_bool on trickle_fsync

41ba672222-+-Bump Scap to v.3.2.2-1

7c6967365b-+-Configurable `vm.dirty_background_bytes` parameter

eb82193c4a-+-nova: Move away from the deprecated hash mutations

16ea95a800-+-Move the Analytics Refinery role to scap3

6a06be2b44-+-realm: Also check if $facts exists

1137876f10-+-rhodium: pool rhodium with a loadfactor of 1

5735f74ef4-+-realm: vary $main_address generation on puppetmaster version

be18b45184-+-apt::repository: Rename the trusted parameter

811feab500-+-prometheus: remove redundant rules checking

618f967a30-+-prometheus: add mysql job configuration

1c6441ca9c-+-prometheus: fix mysqld-exporter service dependencies

f9772ded5a-+-Add prometheus's mysql-exporter to all jessie's production codfw dbs

04fc220a5d-+-Remove /a mount point exception for old parsercache servers

7161318da1-+-Use mariadb::analytics for the special host db1047

fa1fa639d4-+-realm: Move the $::site setting code first

8eff851078-+-tcpircbot: add rhodium to allowed hosts

8560c4a0cc-+-Gerrit: Attempt retaining logs for 10 days

9cbcec9603-+-Gerrit: Make heapLimit configurable per host as well

cb32191eca-+-scap::l10nupdate: Fix ~l10nupdate provisioning in Labs

6e3f3c832d-+-Maps - initial data import

aedbb59f28-+-Set up spice-based remote consoles for Labs instances

d74a66d6a7-+-Set up labtestspice -> labtestcontrol2001 on misc-web

1ae8210f84-+-cronspam: Send floating-ip-ptr-record-updater stdout to /dev/null

d8d312ead9-+-Gerrit: Do a reindex on a fresh install, less surprises

1180269787-+-labs: restart slapd if it uses > 50% of memory

2aa418c28b-+-Puppetise script to manage labs floating IP PTR records

39b99c13d1-+-ores: Allow specifying deployment method

884406308d-+-ores: switch to ores-redis-02

002cf610b6-+-site: add prometheus::node_exporter to more machines

bd3722e9e0-+-Maps - Variable used to give password to osm2pgsql has changed

fe413c3a91-+-add mapped IPv6 on rhodium and strontium

f4a85bc291-+-realm: Qualify fact lookups used in assignments

1cd972cef2-+-realm: Don't qualify the lookups to ::site in realm.pp

cc927f00b1-+-realm: Do not qualify realm lookups in realm.pp

bb15a2825b-+-puppet_compiler: add packages for labs realm

7a59fdc5f3-+-Maps - remove expire files

ed1468e61d-+-prometheus: also scan for *.yaml files

062b967d88-+-prometheus: monitor hosts in the current site

aabfd2b4fe-+-varnish: Remove outdated comment in setup_filesystem about bits

f33671ba2b-+-Add datacenter to lag checks

511a331b64-+-tcpircbot: add v6 addresses of terbium/wasat to ferm rule

761bb2f7e7-+-tcpircbot: allow IPv6 addresses for terbium, wasat

ec1a86bba9-+-icinga: fix nsca/firewall.pp, missing labs-hosts variable

1ade2fd391-+-tcpircbot: allow connections from terbium and wasat

de9dfa0fdc-+-tcpircbot: allow connections from terbium, wasat

0019fd6305-+-beta: Get rid of old unused upload.beta.wmflabs.org apache config

8af0fb131d-+-gerrit: ensure symlink /etc/default/gerritcodereview

a696cf558d-+-move management of pagetitles and mediatitles dirs to datasets manifest

a8d88a4fa2-+-add some missing directories to the datasets dir manifest

d08e8b60be-+-scap: Allow configuration of the master rsync server in wmflabs

c4f73c2e7d-+-run the content translation dump job once a week

3d683754df-+-add cron job for Content Translation dumps

93cff2b8ea-+-thumbor: include lvs::configuration

5df76d6101-+-lvs: add thumbor to lvs

b62a4ecbf7-+-Introduce $upstream_mirror parameter

8590e12b3c-+-Add BACKPORTS=yes hook to include $DIST-backports apt source

ccbb7d9da6-+-Revert "network: move external_networks to hiera as well"

b9dd20844a-+-site: add thumbor100[12]

4a24239010-+-Hieraize kafka handler for eventlogging analytics, select appropriate auto_offset_reset

c2c657af78-+-thumbor: reference swift::params::account_keys

c2e8893a3a-+-cache_upload: persistent storage backend naming on v4

e959e6a1a9-+-puppetization for thumbor

1f831b25c3-+-network: move external_networks to hiera as well

a55d94a2f7-+-parsoid: Remove disk space alert

4a0cab4326-+-librenms: remove nets setting

65946952e5-+-pmacct: Limit to production networks

d0c9f3544d-+-Hieraize eventlogging_kafka_handler to allow selection of different kafka clients

8b3d86cc10-+-cache_upload: use default_ttl instead of ttl_fixed

8af41f2f84-+-role::labsdb::manager: contain variables in class

d35564052f-+-role::labsdb::manager: Move under the role module

eee0aa3e80-+-Move cp3022 to standard puppet role after reinstall

017da39f15-+-Include passwords::misc::scripts when used

7672316b3f-+-deployment/icinga: fix bad directory owner check

460f26d57d-+-deployment-server: fix icinga plugin owner/group

88c0698e78-+-Deploy masters: Improve icinga check for bad ownership

a0d7e2c1f0-+-Gerrit: Simplify dependencies

4a2af53fa6-+-Gerrit: Make IPv6 optional

8309aa3c1f-+-Gerrit: Default to no replication

ad0285a762-+-Revert "ores: changes for configs for the refactor"

00ff49bc90-+-ores: changes for configs for the refactor

0006b82844-+-Parameterize eventlogging-service access log level so labs can make this more verbose

664ba98ed9-+-move ferm rules for dataset roles into common manifest

d472ebb24a-+-include standard and base::firewall in manifest common to snapshots

8cfbc62e5d-+-include standard in a number of places

f9b7e847d5-+-remove all traces of snapshot1002 1003 1004

0562944083-+-prometheus: Fix typo

405d8f04a4-+-prometheus: Allow applying on trusty/precise hosts as a noop

89091336fd-+-prometheus: Don't include base::firewall automatically

1c23bda840-+-k8s: Deploy worker automatically on first run

f42b300247-+-k8s: Bump docker version to latest of 1.11

5301c68948-+-Gerrit: require openjdk-7-jdk instead of just the JRE

d69cf9fa23-+-k8s: Use direct-lvm for docker storage backend

4e4bbe7521-+-Gerrit: Remove temp rsync bridge from lead

ecc1393f94-+-statsite: Set owner/group/mode on init directory

6a0a268eae-+-varnish: Set mode on vtc tests directory

3e4f4579e3-+-Add /var/lib/prometheus to prometheus clients

2ec461b1ce-+-prometheus: fix arguments for mysqld_exporter

c77fd31f19-+-Add prometheus mysql exporter to db2069

78103867da-+-prometheus: add mysqld exporter

a3f5ec4576-+-Deployment master: Make sure that none of MediaWiki got taken by a root

8a6576e8af-+-Undo temporary rsync setup on RESTBase codfw staging nodes

75cecc1c82-+-Gerrit: Remove old library linking

7581716074-+-gerrit: fix another dependency issue apache::site/LE

1460435803-+-gerrit: fix dependency cycle Letsencrypt/Apache

ff24fde23a-+-Gerrit: Remove all the junk to support 2.8

61aa54f869-+-cache_misc: no need for (?i) on planet regex

5b9d9d65c7-+-Remove analytics-wmde from analytics cluster, improve docs around analytics cluster users

5470243053-+-Fix statistics::wmde::user usage in statistics::wmde

aee236d5ac-+-Move statistics::wmde::user to correct dir

ec208464e5-+-Add analytics-wmde user to role::analytics_cluster::users

97e416c39c-+-relaxed directory permissions

547ebacf5d-+-logstash: Use DOMAIN_NETWORKS

a77cdc7213-+-statsd_proxy: remove dependency on /etc/default/statsd-proxy

52527c28ea-+-Add a new statsd_proxy module and replace statsdlb

a4223989e8-+-Remove references of decom api servers mw1114->mw1148

35a2cb1414-+-puppetmaster: add alt names support to puppetmaster.test

24964d3222-+-puppetmaster: fix master.conf on 3.7+ servers

26c80645ef-+-puppetmaster: pin all the needed packages

cb280a2aeb-+-jsbench: add systemd compat for jsbench-browser

33dbc8424c-+-tools: Centrally collect all logs from k8s related nodes

762d1449ef-+-html5depurate: notify on config changes and update security.policy

bbeca20b7f-+-tools: Reduce number of days central logs are kept to 3

e152549d04-+-ipmi: move role to module structure

8d15d4c9d6-+-Add html5depurate::monitoring

eadb74b7c3-+-tools: Depend on /srv

191e885a9b-+-tools: fix typo

9a0c7540cc-+-tools: Add simple loggingreceiver role

89e88c49b2-+-TEMPORARY HACK:  Add access_new_install to iron

209d012395-+-cache_misc: ECDSA and OCSP Stapling for planet

a2f92f6854-+-firejail: imagemagick rules must depend on package

5b8f07b6fb-+-Make sure that nova-network services are only running on the active host.

66dac24411-+-configurable trickle_fsync

32a02d4dee-+-Remove old trusty image scalers from site.pp

a0da62a2e3-+-Remove references of mw1018->1025 decom appservers

033b353098-+-etherpad: move role to module, rename to ::server

c60967996d-+-Followup fix for 450a2e6

29b9a241e8-+-Add the permissions_validity_in_ms among the configurable parameters

76dcd9e34b-+-service::node: Output std out/err to a file

4c29396b05-+-Fix missing include; fix wrong positioning or prometheus account

86b95a47a8-+-Puppetize servermon m1 database user

37e1c56174-+-Parsoid: clean up the manifests and files

37779c8ef6-+-Add Html5Depurate module and role

45e226f344-+-Gerrit: Remove bugzilla password, unused since 4eva

fb80e03085-+-contint: remove firewall rule for ytterbium

7db57e0149-+-Revert "Gerrit: Run list_reviewer_counts cron as root"

68c7a46b8b-+-restbase-test: setup rsync for data from cassandra-test

a0e6d8113a-+-ldap: fix typo for reset-password script name

8267257753-+-add notes about manual additions needed for new snapshot nodes

456303a451-+-use fixed repodir setting for dumps jobs

651ce3b037-+-provide and use variable names for all dump related directories

268cb0ebfa-+-role::puppet::self: Break dependency cycle

1d96de1714-+-include the dumps packages in the dumps manifest in snapshot module

84d9a6478b-+-ldap: Vastly simplify modify-ldap-group

f7759caf2d-+-ldap: Remove unused homedirectorymanager

6f47ff295b-+-ldap: Drastically simplify modify-ldap-user

5132b8db6e-+-ldap: Replace change-ldap-password with reset-ldap-password

1d8e07eb12-+-Fix dependency ordering for self-hosted puppetmaster

4a900ba0da-+-get rid of the useless snapshot cron role wrapper

05fa092fff-+-move cronjobs class from role to snapshot module and add user param

97746c0bac-+-clean up dumps dirs manifest for snapshots

b8a14db48c-+-remove 'enable' and 'ensure' class params from snapshot manifests

450a2e6466-+-servermon: move role to module, add system::role

69140d75a3-+-Beta: Fix non-puppetmaster errors

ec1a4a2f51-+-Bacula: Remove old gerrit backup path, unused now

0a7fea71d9-+-add system::role to the dump related roles for snapshots

52cedf3481-+-move dump related commonly included classes out to common role

5516bdf049-+-remove obsolete manifests from snapshot module/role

220c233ebe-+-remove dump related classes from snapshot1001 through 1004

65e9673d70-+-claim mw129[12] for thumbor

37153c4952-+-move addschanges dumps to snapshot1007

2742291fd5-+-puppetmaster: use LANG from /etc/default/locale, not C

845d40f1c7-+-Set labsdb replicas to have its datadir on /srv/sqldata

4be4772e3a-+-add full paths to config files for pagetitles dump from cron

76a0ada324-+-Move replica templates to the top level

1ccc86ea68-+-Fix template references for replica db config

8a3e9dea33-+-Add provisional my.cnf for new labsdb replicas

881c13a3f4-+-rsyslog: temporarily lower centralserver retention

0b2b801754-+-Setup the new labsdb hosts with a new role

90c218ed28-+-ldap: Remove conflicting ldapvi package

458dbaef3f-+-ldap: Setup ldapvi + make a new role!

c3457c9d6b-+-ldap: Kill a bunch of unused scripts

697a5e3ddf-+-Get rid of the LDAP+YAML ENC

dd80ab9dce-+-Rsyncd: Allow ensure => absent on config files

1a23768a9c-+-tools: Add a role to help build tools images

e4f4d870ff-+-tools: s/kube2dynproxy.py/kube2proxy.py/

b1d90b8ca1-+-Gerrit: Clean up rsync migration stuff

07e0c589b0-+-Contint: Revoke old gerrit ferm rules

db60d2d2df-+-Contint/Gerrit: Fix up ferm rules

dc4b2b6971-+-Finalize main-codfw Kafka upgrade

e329aecc77-+-Upgrade Kafka main-codfw to 0.9

9d098c961d-+-remove obsolete wikiqueries references from snapshot hosts

91f74af9da-+-remove ytterbium from puppet, update gerrit comment

5a8303ea93-+-move wikidata json, ttl dumps cron job to snapshot1007

e1312a2921-+-move generation of lists of good dumps to snapshot1007

784f93e4f3-+-Ciphersuite upgrades for one-off sites

a767782141-+-role::statistics: fix lookup of statistics classes

a982a86855-+-move cron job for central auth dump to snapshot1007

57dab410bb-+-puppetmaster: brown paper bag fix

4ce6f1e7f6-+-puppetmaster: use puppet 3.8 on jessie

761234b8cd-+-move dump of cirrus search data to snapshot1007

4036b72ba3-+-move cron job for pagetitle list generation to snapshot1007

91a549386e-+-enable generation of media lists per project on snapshot1007

c44eea68cc-+-cleanup media list generation cron job, remove from snapshot1003

88ddd014f1-+-zuul: use Gerrit service hostname instead of server

5323564ef4-+-Gerrit: Swap lead to point at production data

b4ae8235c4-+-Gerrit: Run list_reviewer_counts cron as root

31f1ef8233-+-tools: Track per tool request stats in graphite

b7e438cf2e-+-k8s: Upgrade to 1.3.3

f9c41a5ec1-+-contint: jenkins-debian-glue 0.17.0

9ee71ab53d-+-Phab: make sure the mail crons have mariadb-client installed

efac112da8-+-Gerrit: Further tweaks to down/maintenance mode

d2f6abb020-+-Gerrit: Store the ssh_host_key in private puppet secrets

b90a61cb06-+-toollabs: collect stats on grid usage by job

d8e41e957b-+-labs dnsrecursor: add tcy.wiki(pedia)

b9142c8a65-+-Reenable jobs running on the phabricator db slave

f3af241e5c-+-mirror1001 -> sodium

117cad4c79-+-zuul: explicitly define the Gerrit event delay

518c181e16-+-restbase: have systemd restart failed nodes

9c6a632016-+-puppetmaster: pass the group to git::clone

c3a8df50c4-+-cache_upload VTC tests

d341b3e9e9-+-Add dbproxy1006-10 to production as redundant instances of 1-5

7a979ae433-+-Reconfigure m3 servers to use modern mysql configuration

54cb378ef9-+-Set db1048 as the new phabricator master on config

54c783e3fd-+-gerrit: add missing source for remote recursion

a2710e1e3b-+-Gerrit: Greatly simplify directory management on host

cd3a4561a1-+-Maps - initial import script

d3546e47b5-+-Actually create initial import script for OSM data

9cb394540a-+-Script to do the initial data load from OSM for Maps project

b094d6301f-+-Add alerting for MediaWiki exceptions and fatals

076185a50f-+-jsbench: chromium-browser on trusty, chromium on jessie

cf80d591b6-+-contint: APPEND unattended upgrade allowed-origins

e2619d79ca-+-Changed partition scheme for relforge (elasticsearch) servers

306f875166-+-Prerequisites for logstash_checker use

23ba26dab9-+-Disable `streaming_socket_timeout_in_ms` setting

2a06266285-+-Use special monitor-account creds for the rabbitmq collector

c98b4ccb95-+-puppetmaster: Apache 2.4/jessie compatibility

95cdd15b14-+-graphite: Move labs graphite to graphite-labs.wikimedia.org

93fe15ae3d-+-Configure new relevance forge servers

f6b2b7cec7-+-fix up xmlstubs batch jobs setting for en wiki xml dumps

863b0ee73f-+-Revert "contint: tidy Nodepool slaves config history"

1ccf68e824-+-Setup CirrusSearch continuous saneitization process to run via cron

d8b0f44972-+-grafana: Expand edit access in labs grafana

d7a0d0f03e-+-service::node: add git as deployment method

173cafcb69-+-cache: Add labs grafana behind misc varnish

d1afdf03a0-+-set up proper dump monitor role and add to snapshot1007

b2d68690bd-+-grafana: Add and provision labs grafana role

17357ee197-+-grafana: Refactor production role into base role

a1e4f74363-+-grafana: Mark role explicitly as production

d74b49bc37-+-grafana: Make role explicitly reference production secrets

4425b42836-+-prometheus: use DOMAIN_NETWORKS not INTERNAL

8cf2ea27a2-+-remove dump monitor from snapshot1004

d80e11ceb9-+-tools: Add a kubernetes diamond collector

f237e9084a-+-parsoid: move to role::parsoid for all production nodes

f8937a4731-+-New user for prometheus monitoring

dae57fab55-+-prometheus: fix ferm::service and include node_exporter

719706263e-+-nutcracker: default verbosity to 4

366b06ddd0-+-Add more to stats:wmde config

dca8f91aa9-+-make sure directory creation uses the dump cron job startdate, part 2

d37bf5a753-+-mediawiki::conftool: add mw-pool

28f0354f39-+-make sure directory creation uses the dump cron job startdate

d99f8a8876-+-extend dumps cron job to run partial dumps as well

fe6dbfa389-+-role::mediawiki::webserver: add conftool scripts

4dbcff8ca2-+-osmium: delete temp. migration class

16b2ed79d6-+-osmium: copy data back from hafnium after upgrade

3d8779c5e5-+-osmium: also copy /srv for migration

49486ed9ca-+-osmium: rsync home dirs to hafnium for migration

cd3fb01bcb-+-insecure post: 100% failure, loophole closed

f468e12c2c-+-Correct ip for db1043: 10.64.16.32, not 10.64.16.33

f878f4c463-+-Change the case of the rabbitmq collector class

c6134d30d5-+-Gerrit: Don't install defaults file, package provides it

be2da294e4-+-Set db1048 as the primary master on the m3 proxy (not yet in use)

e2269bee1d-+-typos file: add 'mariabd' and 'eqad'

c92c44d5d1-+-Gerrit: Enable proper backups from new hosts

3fd35d2ced-+-parsoid::testing: move to use the parsoid class

5b535497af-+-tools: Fix spacing

d29cda137e-+-Move updater logs config to /etc/wdqs

50c3aa88a0-+-tools: Add limited sudo capabilities to toolschecker account

893542fc0f-+-Parsoid: Lower the heartbeat timeout to 3 mins

86e0e968fe-+-Parsoid: Increase heap limit to 600 MB

e5fe9f8c3a-+-Remove a typo space

beab2841c2-+-Add diamond collector for rabbitmq stats

27c477e976-+-parsoid: add role based on service::node, apply to two hosts

9ec4f2da63-+-tools: set cgred application to trusty only

8cf9fc356f-+-tools: Add check for all nodes in Ready condition

b2bec3877f-+-labs dnsrecursor metaldns: use hiera's labs_tld instead of assuming its value

a4c24c86df-+-labs dnsrecursor: tidy up paths

f1dd0ca1de-+-site: use 'include' for role::prometheus::node_exporter

990ef09d05-+-Repool db1001 as m1 secondary (passive) host

4fbcf2ee41-+-Update haproxy default file, as it cannot be dynamic in jessie

5da036701d-+-site: add node_exporter for prometheus machines

d775eb6995-+-service::node: add 'entrypoint' and 'heartbeat_to'

66fb386f81-+-parsoid: add transition cleanup role

c547247c04-+-Remove analytics-deploy user/group since they will be created by scap:target.

45e752ea80-+-puppetmaster::web_test: add NameVirtualHost directive

3e4c3019ff-+-puppetmaster: add test site to palladium

7a40fdd85d-+-Gerrit: Introduce comment of $maint_mode for the web UI

a04cc295e2-+-gerrit: fix ssh port monitoring

62aee3ab86-+-Gerrit: monitoring conflicts with system ssh

6cb4aabc09-+-Gerrit: Follow-up I8455189c, use monitoring::service not nrpe::monitor_service

b0c36be3a6-+-Gerrit: Follow-up I8455189c,  isn't needed now

c36f94255a-+-Gerrit: Remove SSH public key and last user of it

b8d510d44e-+-Gerrit: Add icinga check for Gerrit SSH access

d358784014-+-Gerrit: Add myself to contact groups for when https goes boom

0a6a07e21a-+-Reduce kibana logging levels

e027426371-+-Update kibana module for kibana 4

b5a18966d4-+-Revert "labs: Don't have shinken do basic instance checks"

2b76c50f7e-+-phabricator: re-enable project-changes email

3ea3da1edd-+-Apply es2.x config for logstash1001-3 as well

d0612c409e-+-maps: move postgres user creation from grants.sql

139d22c420-+-Line up some arrows to make puppet-lint happy

7e8890177d-+-mediawiki: use puppet-provided fontconfig everywhere

1bbd7806ff-+-mediawiki::packages::fonts: reject bitmap fonts on jessie

30b603be76-+-phabricator: re-enable community metrics mail

18cf083f84-+-Provide fontconfig configuration which forces antialiasing

15c7843afc-+-cache_upload VCL forward port to Varnish 4

9a8de68af1-+-direct output from cron job for full dumps to log files

8ee9215036-+-add batching config setting for xml stubs dumps

a421af226d-+-postgresql: fix user existence check

5c8cb99f6d-+-tools: Set homedir permissions properly in kube-maintainusers

60acdddc7a-+-Include icinga alerts for zookeeper

032962037b-+-Update zookeeper submodule and configure sending zookeeper jmx stats to statsd

fb2802045a-+-Stop kafka mirror maker on kafka100[12], it is not doing anything anyway

85f60562f6-+-cache_upload: raise FE mem size to 50%

b7c54fb2f8-+-cache_text: raise FE mem size to 50%

e0640cfe63-+-Prepare hosts for labsdb1009, -10 and -11

18fd068f84-+-puppetmaster: puppetize private post-commit hook

8e9904504a-+-ores: add File['/srv/log'] for web nodes in labs

26ca1b0a06-+-mediawiki: un-hieraize cgroup_enable boot-settings

b96b80c423-+-cache: un-hieraize tcpmhash_entries boot setting

4271ebcc1a-+-labstore: un-hieraize elevator/ioscheduler boot-setting

e57f363c07-+-Create a new grub module

a733137467-+-puppetmaster::gitclone: fix ownership of post-receive hook

9cd8209820-+-puppetmaster::gitclone: fix dependencies for git master

219a37b6dd-+-puppetmaster::gitclone: tighten directory permissions

c846bdb630-+-puppetmaster::gitclone: brown paper bag fix

aaa3d42a58-+-puppetmaster::gitprivate: remove unneeded dependency

378248d1ac-+-puppetmaster::gitclone: actually clone the git repo if an origin is given

60960b4a47-+-Add the deploy-analytics user/group to the refinery role

8d82dd984e-+-add ms-be102[2-7]

cd923541a5-+-caches: double the min_free_kbytes cap

e1e727d50a-+-cache_misc: raise default_ttl to 1h

ca309acd30-+-cache_misc: 1d FE TTL cap like the other clusters

f8d67164cc-+-cache_upload: 1d FE TTL cap

1461dd0641-+-puppetmaster: /srv/private is owned by gitpuppet on replicas

b6ce7500fb-+-puppetmaster::gitprivate: correctly support bare repositories

a1b748f1f8-+-puppetmaster: correct puppetization of the private repo

3b6118429d-+-Increase the Varnishkafka VSL API timeout to 700 seconds

0b9a13e7c7-+-phab: notes on DB dependencies for rt & bz update jobs

a8bafb0e85-+-xhgui: move role to module structure

8acdf3eaf9-+-Gerrit: Vary extension listing cron on git_dir

9730ec657d-+-Use a ferm service for contint

2ed804c27a-+-Gerrit: Vary index type. We don't want LUCENE on 2.8

e08da708ad-+-Fix changeid link in gerrit 2.12

bca2b6759b-+-logstash: Remove normalize_fields fitler

cbced6f5df-+-Decommission old elasticsearch servers

eb644af188-+-tools: Add flannel/k8s etcd checks to icinga

3c60daf972-+-tools: Add checks for k8s and flannel etcds

0d35252185-+-Fix the output directory for multimedia reports

1028badb60-+-stats:wmde pass ${scripts_dir} into cron scripts

ead9ca7175-+-ores: reduce uwsgi workers to 2/3

c77574691b-+-Move stats::wmde cron files to analytics/wmde/scripts repo

1a0a640eaf-+-remove rcstream lvs::realserver config

4b82872414-+-Remove old rcstream public LVS config

1bf789c141-+-MobileApps: Increase memory limit to 450MB

499c5ba619-+-base: reenable augeas codepath on trustys

edaf5f777f-+-base: do not include grub in Labs Ubuntus

319eeaf51c-+-base: remove ioscheduler setting from non-augeas codepath

15c6798653-+-prometheus: add node_exporter support

b264718a0f-+-Gerrit: Turn off rsync cron for now

ce6f3f9fa8-+-Gerrit: letsencrypt cert names are called gerrit not based on host

991f9ab2bb-+-rancid: move role to module structure

fcf7f11e68-+-spare: move role to module structure

1b44ddcdab-+-Gerrit: Create gerrit2 user/group

1664583d1e-+-Gerrit: install Gerrit on lead (pointing at slave instance for testing)

942f9aeba2-+-lvs_class grain bugfix

38b05cf3ee-+-add lvs_class salt grain

560ae5c5b1-+-ipv6relay: move role to module structure

dfc5a703db-+-wikistats: move role to module structure

dd07383fe7-+-iegreview: move role to module structure

b10253da45-+-deployment-prep: Point upload cache at swift, fix rewrite.py to use beta.wmflabs.org domains

02f9103098-+-contint: Put mysql db on tmpfs for role::ci::slave::labs

ed1ea0a7ed-+-cache perf: remove vm compaction cron

226dc05234-+-package_builder: install WMF lintian profile file

4ed19aff23-+-lvs: rate-limit more ICMP codes, lower to 1/200ms

fc66de1220-+-Fix final few paths in statistics::wmde

f57d4ba42d-+-VCL: raise 4xx TTL cap from 1m to 10m

2ebc6b4a08-+-statistics::wmde ensure 'production' branch latest

7c534cf422-+-Update analytics/wmde/scripts repo

278e87afee-+-service_checker: use external package

4bbfd3b9ec-+-contint: tidy Nodepool slaves config history

93c5aa0f45-+-Gerrit: Simplify SSL and hostname management

c2a7b376bf-+-role::horizon: Limit to production networks

828bdab03a-+-Run slapd backup on both labs LDAP servers

cea938d0d9-+-debug_proxy: Limit to production networks

2c8afd88b6-+-contint/gerrit: allow ssh for git on new gerrit server

5d8ed65a46-+-Revert "TEMPORARY HACK:  Add access_new_install to iron"

39727833f5-+-Henceforth, recommend linux-image-generic-lts-xenial for compute nodes.

2b66d0d268-+-Maps - enable tileratorui notification of new expier files

12d91bcb40-+-backup: Use PRODUCTION_NETWORKS

eee3d2f44d-+-Fix mode of wmde scripts

c1c9a0a74f-+-Use $statistics::working_path variable in statistics::wmde

fbcff8cf8a-+-Fix path and bad User requirement in stats_wmde

4454d7f6e9-+-Statistics::wmde puppetization

1d13c16981-+-Make labvirt1012-1014 nova compute nodes.

4c973caa3b-+-TEMPORARY HACK:  Add access_new_install to iron

252f997bb2-+-puppet: remove all references to the decommissioned appservers

259f473911-+-puppetmaster: fixup for I1842586a7

41955557b4-+-puppetmaster: perform git init in the private repo dir

d076ae22a1-+-puppetmaster: add rhodium as an inactive backend

3c2c611ccb-+-ocg: Restrict to DOMAIN_NETWORKS

b98826dcbf-+-Gerrit: Require specifing IPv4 and IPv6 addresses to role

ae6f877c6a-+-Gerrit: Don't use SSH to connect to gsql, we can do it from shell itself

a3ceb8914d-+-labs: break out puppet alert logic to generic notify handler

d157135a22-+-labs: Allow explicitly specifying lookupcache via hiera

6c501ad4e0-+-Also install conntrack on labvirt* hosts

fc6f443007-+-Remove Websocket upgrade request from Varnishkafka webrequest config

5270f9d073-+-Increase conntrack limits for nova compute nodes.

bfc761e560-+-puppetmaster::passenger: use sslcert::dhparam on jessie

eed836ecd9-+-dynamicproxy: do not override nginx.conf

2534f26045-+-Install fonts-sil-lateef on scalers

572a7faa54-+-contint: Android SDK deps on all slaves

ff7a040983-+-toollabs: install inkscape on exec nodes

39d5aea908-+-Enable base::firewall for labtestmetal2001

be4c7b597e-+-Gerrit: move nasty ssh key to crons class, only user

1b2749df50-+-Gerrit: Puppetize the known_hosts file for replication

daeacfeff5-+-Phabricator: Minor nit, move things that aren't templates out of templates

8ab166141b-+-xenon: Use DOMAIN_NETWORKS

c3a2635fed-+-Phab: properly disable crons for maintenance

f87da4d855-+-Include hive::client role in hadoop::worker role to get hive-site.xml and other deps

65a8b69762-+-package_builder: add WMF lintian vendor profile

c4756607f9-+-Include analytics_cluster::hive::client role on analytics1030 to see if this fixes HiveSpark in cluster mode

e955bc97df-+-Add analytics to the AQS monitoring contact group.

37d2a93972-+-tools: Upgrade kubernetes to v1.3.0

f21ff1ff28-+-tools: Add icinga check for kubernetes webservice

a402d66702-+-Introduce network::constants::frack_networks

d2c9a5ccde-+-Add fonts-taml-tscu font to scalers

07afb4efe3-+-Correct scoping issues in role::osm::master

2735f67305-+-dumps: Restrict to PRODUCTION_NETWORKS

db835a4ad8-+-Gerrit: A few minor tweaks to rsync replication

c076608ed6-+-Gerrit: Setup rsync between old and new machines

ab5158dd3a-+-Postgresql - allow multiple entries for the same user in pg_hba.conf

972de0a468-+-Frack uses analytics-eqiad kafka cluster!  Switching back to ALL_NETWORKS

f86af83058-+-Change path to proxy node requests

1b66a275fa-+-tools: Don't include k8s::ssl when not necessary

afd3fa804a-+-tools: Don't set CA explicitly for kube2proxy

24aefaabec-+-tools: Use provisioned cert instead of puppet cert

40b2106a68-+-tools: Provision star.tools.wmflabs.org cert for k8s master

dbf1605d69-+-tools: Provision accounts for all tools

c23304bc82-+-spec fix for aptrepo and installserver

cf2cbd82f5-+-Include librdkafka-dev in contint::packages::python

2c7fc9435a-+-Remove /a directory from db1048

21b215d8d4-+-Ensure base cassandra directory is created.

0e74dbc66e-+-Preparing db1048 for jessie install

b420cc9b2b-+-Change dump-otrs.sh script permissions to 755

5a8e60dda2-+-role::labs::graphite: Further use of LABS_NETWORKS

b7570b2c8a-+-role::kafka::main::broker: Use DOMAIN_NETWORKS

bb9d3b283c-+-swift: adjust group ownership for Ubuntu/Debian

3734d85b0e-+-swift: adjust group ownership/perms for /var/log/swift

c8995108de-+-Maps - notify tilerator of new expire files

86e42e654f-+-swift: redirect syslog from all daemons to separate file

bd5386ada7-+-Disable crons using the phabricator db slave due to maintenance

e4df1c6671-+-Include a cassandra::instance::monitoring class

9129b8755d-+-site.pp: split hydrogen/chromium, move restbase-test

86ed0ceea9-+-Gerrit: Don't install python-paramiko anymore

3d008f2046-+-Ensure mariadb running on labservices hosts.

ad40b0cecc-+-toollabs: set nano as default editor

3b1677176c-+-Ensure mariadb service is running on wikitech host.

c61d1fc8f3-+-url_downloader: Use DOMAIN_NETWORKS in ferm rules

27d4ef0416-+-netops/monitoring: fix cr1-eqdfw's IPv6 address

7cf17e2b8d-+-Promote db1040 to be the new s4 master

0044f514e6-+-kafka brokers: Use DOMAIN_NETWORKS

f822d3694c-+-kafka/analytics: Use PRODUCTION_NETWORKS

74a45de946-+-jobrunners: decommission mw1009-16

2060fedb8c-+-redis: create /var/run/redis at boot

9eedb96a65-+-otrs: Do not hardcode mx hosts

9aa3c4a824-+-Revert "cache::misc: Set up a temporary etherpad host"

d8235309ea-+-role::labs::graphite: Use $LABS_NETWORKS

5c76d320e6-+-aptly: Move to DOMAIN_NETWORKS

7a32a332cf-+-Disabling tileratorui notification

b165c8a40a-+-Adding missing expire parameter to tileratorui notification

c0a2af3602-+-Fix permissions for tileratorui

19b2151ad5-+-Notify TileratorUI on new expiry files

67d7a08dc8-+-servermon: simplify tests with puppetlabs_spec_helper

73faed43d2-+-mysql: fix spec

2288c70587-+-poolcounter: Use DOMAIN_NETWORKS

a9c322eb03-+-jobrunners: decommission mw1001-mw1008

6e4073b52d-+-ores: reduce the web workers to 3/4

e149abbddd-+-ores: fix-up web node monitoring

197734ea60-+-explicitly specify identity for EL legacy zmq forwarder

9816b226f3-+-labsdns: Allow returning arbitrary A records, not CNAMEs

f55f94242b-+-prometheus: add tools role

395a8cc3dc-+-icinga: check all ores web nodes

fef28f4729-+-Revert "Revert "labs: Add support for custom cnames in labs recursor""

315ff4e552-+-Gerrit: Rename role from ::production to ::server

66fdb0f9d1-+-re-enable full dumps cron job for first of the month

fec9c9f829-+-Introduce $::networks::constants::labs_networks

b3b1a285d2-+-Introduce $::networks::constants::domain_networks

3067d61aec-+-Install fonts-noto-cjk on jessie image scalers

e064fc6ab0-+-add xml dump config options for order by rev_id for stub dumps

d53f29ccf3-+-osm: simplify tests with puppetlabs_spec_helper

ba2273ff71-+-syslog: limit source range to $PRODUCTION_NETWORKS

0ee26e1726-+-postgresql: simplify tests with puppetlabs_spec_helper

3f03c7dd7d-+-Enable base::firewall for pybal-test

4bbab6d38e-+-Add ferm rules (and role) for pybal-test

8488adfdce-+-remove misc/monitoring.pp, remove import 'misc/*.pp'

76feaf0ce7-+-delay full dumps this month by one day

b6580a3ffe-+-disable dump cron jobs on snapshots 1001,2,4

2ffe1f8113-+-Gerrit: move replication config to hiera

4b7ddc3089-+-install_server::tftp_server: Use PRODUCTION_NETWORKS

f03a3c6fbf-+-network: fix spec not loading libs properly

35a45743c3-+-Gerrit: remove replicationdest, unused

3ea3c47194-+-Gerrit: don't bother ensuring hooks directory, we don't use it anymore

17528aae55-+-Gerrit: Stop customizing ssh port. It's not like we're changing it

0e709b5c1c-+-Gerrit: don't pass SMTP server info around either, realm.pp provides it

4c8f355298-+-apache: logrotate augeas rule needs apache2 package

a74773a363-+-Revert "Disable cron script on the phab slave due to maintenance"

2e0fd8b251-+-Disable cron script on the phab slave due to maintenance

a8f05f02af-+-Avoid log spam as 99% of these would be non-errors

cf140a26a2-+-Correct invalid cron definition; add gtid to backups

ddaa05bd0c-+-ores: Add Czech language dictionaries

3ae9c67091-+-Remove otrs backups from dbstore1001, create them on es2001 instead

8ecc013601-+-Remove AQS Thrift ferm rules for port 9160 since not used anymore.

4847cd9199-+-Add extra parentheses to an AQS ferm rule to solve a syntax error.

d66c7e2cee-+-Allow communications between AQS and Analytics Hadoop on port 7000.

55793d65b3-+-Move more of the gerrit config out of role class and into hiera

2fe4956408-+-Gerrit replication: ensure group exists before user and before ssh key

faeebd63ed-+-graphite/production: Limit to PRODUCTION_NETWORKS

c770d45147-+-Gerrit: minor (no-op) manifest cleanup

f3f529e2c2-+-Remove antimony

344fe056d9-+-Gerrit: stop replicating to antimony for gitblit

96114b4bc2-+-varnish: git.wm.org to iridium, remove related config/tests/monitoring

5f4e0ee315-+-Rewrite rules for git.wikimedia.org

07c1208c74-+-prometheus: use ordered_yaml for server config

9126ee5fb4-+-diamond TCP collector: publish TFO-related metrics as gauges

c792d4e76d-+-include 'standard' for prometheus machines

2d76bdf3a1-+-Fix wdqs deployment - now wdqs is a symlink

3da221cce4-+-Prepare scap3 deployment for WDQS

01d26c2c16-+-Keep daily graphite data for 5 years

a28b126b67-+-Elasticsearch response time threshold now uses more_like query

16db699b3c-+-role::etcd: fix bacula backups

0bd9ae3f6b-+-otrs: Replace EXTERNAL_NETWORKS

8e5d8cac27-+-prometheus: add init.pp class and expand documentation

7aefe78648-+-etcd: perform backups to /srv/backups/etcd, bacula

eb2d006959-+-tools: allow users to create unpriv chroot

124c6c008d-+-Elasticsearch - Increase alerting threshold for alerts on codfw response time

99dd186c41-+-logstash: Update logstash for sending to es 2.x

d5aa541795-+-site: add prometheus[12]00[12]

d0d8512052-+-networks::constants: use slice_network_constants

83fb9a6c18-+-saltmaster/production: Use PRODUCTION_NETWORKS

d5c7be0a80-+-introduce zosma.codfw.wmnet

c13f7eae81-+-prometheus: add nginx reverse proxy

fc4c43645b-+-Install arcanist from apt rather than git.

5209c241eb-+-Move graphite ferm rules out of role:graphite::base

c47f1de56a-+-Revert "Rewrite rules for git.wikimedia.org"

3656375ccd-+-openstack: move instancersync define to own file

9a31dba8d3-+-diamond: move _lib classes to own files

49a44e9604-+-Rewrite rules for git.wikimedia.org

836b8bfb38-+-Phabricator: support systemd as well as upstart.

5aaf79452d-+-Remove obsolete code that manages phabricator src/extensions

5526a82be6-+-puppetmaster: lint-ignore layout in test/puppetmaster

ba9f762ec2-+-let phab2001 use same role classes as iridium

0057d259a3-+-ores: add monitoring for production workers

c307632240-+-install_server: Use PRODUCTION_NETWORKS

4a65c57929-+-diamond TCP collector: add TFO-related metrics

3ca1018f19-+-raid: bump hpssacli nrpe timeout

c75ba14ce3-+-Add Amiri font to the scalers

a1b38ee5da-+-Add Thrift port (9160) to Ferm's whitelist to allow Cassandra bulk loading.

b3ef0ad7c4-+-ganglia: Restrict ganglia aggregation to just production

bff100fa86-+-Postgresql: init database with Puppet

fc09e04bdb-+-Revert "labs: remove shinken monitoring for tools / deployment-prep"

4924baf647-+-Include a cassandra::instance::monitoring class

a786a56e22-+-Revert "graphite: Use mod_proxy for proxying"

33c41cb494-+-tlsproxy: enable TCP Fast Open

c98279e0a9-+-Restore mc1007 memcached growth factor to 1.05 as the rest of the cluster.

4b10c17490-+-etherpad-restore: Use etherpad1001b

351bfb0079-+-cache::misc: Set up a temporary etherpad host

b26d8d0375-+-cache roles: add tcpmhash_entries=64K to kernel cmdline

78c84e6af0-+-r::c::perf: enable tcp metrics saving

f02dadea00-+-r::c::perf: move all commentary inline

cf2b45af65-+-network: add $production_networks

70d5260b4a-+-Add firejail wrapper for rsvg-convert

c36b8c67f4-+-swift: align partition to 1M boundary

3c7875d61b-+-Change-Prop: Added rules for ORES cache updates

95d1632105-+-r::c::perf: disable autocorking

759b1fe512-+-LVS: sysctl netdev tuning

6451f068b2-+-r::c::perf: raise netdev_budget a bit

09aae13ae1-+-move r::c::base classparams down as appropriate

fa48c95af1-+-r::c::perf: disable prequeue timestamps

b883c61803-+-r::c::perf: un-mysterious the rest

28f7313149-+-r::c::perf: un-mysterious somaxconn + syn_backlog

ebe3f06584-+-r::c::perf: un-mysterious netdev_max_backlog

3a10469e8d-+-r::c::perf: consolidate net tuning and mysterious values

e031db9e1b-+-role::cache::text: handle url shortener requests

d0e80f3202-+-Promote db1016 as the m1 shard master, set db1001 as a m1 slave

3e7423d9f4-+-Set temporarily m1 haproxy to failover to itself (db1016)

21c71f3ed9-+-Configuring new elastic1043-1047 servers

1d3aaff0dc-+-Enable backup for gallium

b09acb1126-+-contint: do not backup Jenkins build history

375a7d6e27-+-Configuring new elastic1038-1042 servers

6ad18f2fa7-+-contint: create /var/lib/jenkins/builds

d637d416f9-+-ores: fix workers and config

0ed293ae3f-+-Configuring new elastic1033-1037 servers

7dd2792808-+-Adding missing dependency in exposing puppet SSL certs on elasticsearch

d73b8bdec0-+-swift: add ms-be202[2-7]

2b8b99d280-+-tlsproxy: enable client/server TFO support in the kernel

1dd68c1296-+-caches: tcp_notsent_lowat => 128K

3270d175d1-+-Revert "Postgresql: init database with Puppet"

230c9fd41d-+-Postgresql: init database with Puppet

aa62c5b0fa-+-Configuration for new elasticsearch servers in eqiad.

1cd9bb79f4-+-Deploy Graphoid with Scap3

f4145889d6-+-Manage Postgresql data dir with Puppet

8b50d2d951-+-package_builder: Add gobject-introspection to package list

f935c82014-+-otrs: add check_procs for clamd/freshclam

aca1216052-+-Move dataset ferm rules into the role

e3618a5501-+-drac,icinga,ipmi: do not ensure => latest

b06dc6967d-+-tlsproxy: redirect-only service on 8080

33ba251d24-+-systemd: add systemd::sidekick

b53c1971e4-+-Configuration for new maps cluster in eqiad

84f1f4ee23-+-prometheus: use group root

6a60f7c461-+-Provision a "staging" microsite for the transparency report

c9aee4fb85-+-cache_upload: experiment with 4h fe ttl cap

4af9fcec38-+-cassandra: default to 2.2.6-wmf1

4a746c2486-+-ripeatlas: lower intervals to 5/1 from 10/5

fb37922474-+-ripeatlas: add IPv6 measurements as well

0b825e5029-+-salt: add wmfpuppet module

8445dff70b-+-prometheus: add server support

94f4d523b5-+-Team-interactive receives maps alerts

11c16bd543-+-RESTBase: Make sendind resource_change events optional

18a5513223-+-Change Prop: increase concurrency to 50

9b0d70c8cd-+-vhtcpd: use port 3127 for fe

42651850ed-+-r::c::ssl: use 3127 for upstream_port

7788a25388-+-r::c::ssl::unified: set explicit server name www.wikimedia.org

65a8dcc4f4-+-Add the ability to configure contact group for check of services.

af1abdfdc7-+-Fix team name for icinga alert

69e9480ccd-+-Interactive team would like to be notified of issues with Maps.

760787c5c7-+-Adding a "interactive-team" icinga group for alerting.

50e16c9309-+-r::c::instances: frontends also listen on :3127

8776bc0b22-+-Have labspuppetbackend listen on an external IP rather than 127.0.0.1

5273763451-+-Move labspuppetbackend to port 8100; open firewall

0c6432da7b-+-r::c::instances: remove dead option app_be_opts

2faaabf580-+-Force Varnishkafka to filter out Varnish Pipe logs

c3c23d06db-+-Kartotherian: Set up LVS checks

ff0cdaa656-+-mediawiki::jobrunner: brown paper bag fix

c461d9cf93-+-mediawiki::jobrunner: fix systemd unit files, logging

563fd06417-+-mediawiki::jobrunner: systemd compatibility

d8933a9ca3-+-Remove kartotherian from monitor_services

ac229e69ad-+-kartotherian.svc.codfw monitoring

fd8b282564-+-MySQL backend for storing roles / hiera data for labs

84569f1dca-+-labs: Don't have shinken do basic instance checks

b7ce40b216-+-labs: remove shinken monitoring for tools / deployment-prep

52a344437d-+-Enable kartotherian service check for all maps servers

64aeb9c564-+-Define ferm service dynamicproxy-api-http in role::labs::novaproxy

5fb163d76f-+-Only run processEchoEmailBatch.php on Echo-enabled wikis

9f616b769b-+-stream: use hash(X-Client-IP) for backend selection

3e2a1dbb87-+-hhvm: add su directive to logrotate recipe

b26389d4b9-+-Kartotherian: Use the root URL for the checker script

b579c76c9c-+-service::configuration: Set the default log_dir to /srv/log

b7d628e787-+-tlsproxy::instance: add missing hiera varnish_version4

6ff2290d1f-+-cache_misc: add stream.wm.o

2463071ed3-+-Support optional keepalives and websockets for v4 only

28ca123505-+-Enable 'has_spec' on Kartotherian service.

289d9517ea-+-diamond: Allow setting handlers via hiera

79213e15a8-+-Revert "diamond: Allow disabling via hiera"

46cffe57fb-+-diamond: Allow disabling via hiera

0c874d2c34-+-Deploy Tilerator with Scap3

0b6d482cc2-+-tlsproxy: use ssl dynamic record sizing

44198a800d-+-graphite: bump up buffer-size

984cb6e560-+-graphite: Enable mod_proxy / mod_proxy_http

77a419bf7e-+-graphite: Use mod_proxy for proxying

b80ac3bb09-+-zerofetch: write output to logfile

29a7aa6f88-+-zerofetch icinga check

39e10f37d9-+-Enable two-factor authentication in sshd

6bd8ab50ac-+-mediawiki: fix codfw appservers declarations

ad5bde0929-+-mediawiki: correctly assign the new codfw appservers in puppet

220ae31fe6-+-Only install PHP configuration files on trusty

394ce67bfa-+-service::uwsgi: Ensure config directory exists

35f6983b1a-+-Stop installing PHP on jessie app servers

cc38fc580b-+-Enable base::firewall for osmium

1656edd5a9-+-graphite: Do not hardcode hostname into checks

dc65f746da-+-rm cp1043,cp1044 from site, installserver & torrus

592a11ba0b-+-Upgrade osm2pgsql to 0.90.0

3f7ef86b66-+-explicitely set input reader format in osm2pgsql

225cb8150e-+-varnish{xcache,xcps,...}: subscribe to varnishlog.py

670d57a726-+-Move everything Postgres-related out of role::maps::server

74f226dd47-+-Install firejail profile for convert

7c957455b2-+-ores: move config file to /etc/ores

5679234aa2-+-Define backup for contint

bcdbd38f34-+-add lint:ignore's for remaining files outside modules

7786d4e90f-+-Add the analytics contact group to hadoop/kafka related nrpe monitors.

5288692a32-+-ores: Move CORS to uwsgi from nginx

a3256e9a8f-+-Limit the maximum Kafka topic partition size to 500GB.

07e30d09e9-+-Change Prop: Use the URIs for MW and RB from service::configuration

57c5bc568c-+-Add ssh:userkey for eventlogging scap::targets

30ffadcb6d-+-contint: remove zuul-merger from gallium

0eb0b68bbf-+-Remove old and redundant AQS specific alarms.

f078ced8a8-+-ores: Add graphite settings

a28bf490cd-+-Skip installing the imagemagick profile for now

3fb3c17264-+-Provide the firejail containment for imagemagick's convert(1) on all app servers

1e5a887fd4-+-Change expired file zoom level from 16 to 15.

98a28cab5f-+-Force Varnishkafka to output the Resp timestamp.

78119152c4-+-ores: Add redis settings to worker nodes in labs

859e1a6e77-+-contint: add firewall rule for nodepool to Jenkins API

d50e9cddbd-+-xhgui: provision xhprof UI

41d52e53a6-+-Revert "Scap3 config for tilerator"

0f96cec492-+-Fixing lint issues

e0a432e434-+-Scap3 config for tilerator

594b7d67f1-+-Scap3 config for Kartotherian

8cae073d88-+-Change Prop: Fix the number of workers to 8 temporarily

a57c469917-+-Set max conns to 1024 for all zookeepers

39cd9bfbd4-+-contint1001: add zuul

cadbdffe06-+-jenkins: declare the home directory explicitly

fce440ec2c-+-role::contint::*: try to resolve circular dependencies correctly

565181a90e-+-role::ci::slave: require /srv/ssd as a file, not mountpoint

f87540baf9-+-role::ci::website: require role::ci::slave

e30a890dbc-+-Change Prop: Lower the concurrency limit to 30

799343ba1a-+-role::ci::master: hotfix for /srv/ssd

23cbd8cde7-+-role::ci::master: require role::ci::website

f09fae50ea-+-contint1001: add role::ci::master

e50bae3f53-+-contint: remove packages from prod slave

025143a517-+-Add 'varnish_version' salt grain

e368bd2456-+-contint: add contint1001 as gallium replacement

9f67697af9-+-Disable ferm on palladium again

622651366f-+-Enable base::firewall for palladium

56f42af478-+-tools: Add role::toollabs::merlbot_proxy

94ce952e21-+-ores: Add support for Norwegian

af0cb43e31-+-varnish: move errorpage.html from misc to module

909424a99b-+-contint: move libav-tools to contint::browsertests

6e64d7a767-+-remove furud from site.pp,dhcp,installserver

7def544ddc-+-ircyall: Stop using package=>latest

0c28cdd30e-+-smokeping: properly include module class

66ce6e420c-+-smokeping: various cleanups

0e4996d5be-+-Grant grafana-admin.wm.o access to LDAP group grafana-admin

32b43819dd-+-Don't install apt-show-versions

004a63bc3b-+-ssl_ciphersuite: standardize STS preload

6a6410048d-+-fix grafana(-admin) icinga checks

07bcaf90ed-+-ores: Add varnish backend in the misc cluster

bc6cc98a70-+-ores: deprecate flower

90809b6570-+-zerofetcher: use secret() directly

507e0f5132-+-fix piwiki and grafana-admin HTTP checks for 401

bc83369e6a-+-Add tex/latex fonts to tools exec nodes

bdd27ef834-+-Gerrit: kill replication to furud

60e8e7334e-+-Revert "Add 'libertine' fonts to tools exec nodes."

456adf4054-+-Add 'libertine' fonts to tools exec nodes.

a24fa84285-+-Activate more logs on postgresql for maps.

18d939100c-+-fix arrow alignment ....

7d9914f01f-+-fix ferm port 80 for californium/gallium

d43c205fd4-+-Remove TLS bits from internal sites behind cache_misc

7160b641e7-+-update-ocsp-all: write output to logfile

0361db30dc-+-facter: remove references to $::memorytotal

b00a71b8e8-+-mediawiki::cgroup: don't restart upon changes to the unit

aa948ca4fd-+-mediawiki::cgroup: systemd compatibility

2f1710e88e-+-aptrepo: make owners of incoming dir configurable

2a71133050-+-aptrepo: set separate incoming conf for releases

d4f162aedd-+-aptrepo: make conf/incoming configurable parameter

980319cc42-+-releases: delete unused role::releases::upload

1a562b2384-+-varnish: mv wikimedia_vcl, netmapper_upd to separate files

4ed8c267ca-+-Revert "endowment: comment out git:clone until repo exists"

45bfe53ff5-+-add "lint:ignore"s for several "puppet URL without modules"

f4a1054928-+-Revert "Increase the number of workers for osm2pgsql."

1dd1bf8197-+-MariaDB: Add new coredb servers

253e195021-+-Add firejail wrapper for ffmpeg in video scalers

3d92f3e819-+-Add new s6 core database servers

6c4db8c797-+-Add new s5 database core servers

a859bac597-+-labstore secondary role cleanup and remove 00[12] specifics

837beefa29-+-Match class assignment to file for labstore::fileserver::secondary

55e58a226e-+-assign labs::nfs::secondary to labstore100[45]

cf43222896-+-Add 3 new s4 shard core db servers

cfc82d0e27-+-Add extra new core database server to s2 shard

a776ae1b92-+-ores: fix staging

dabcaffb25-+-toollabs: Open up port 80 for kubebuilder

067d62cbb8-+-endowment: comment out git:clone until repo exists

b725ff7d73-+-endowment: remove duplicate Apache site definition

e55d6fc8c1-+-aptrepo: mv wikimedia-specific distributions file to role

76149eb9d5-+-releases: don't define incomingdir, duplicate def

c9961ca9a5-+-remove magnesium from site.pp, DHCP/netboot

11d97a2b5b-+-lvs: add ores

ea21b52141-+-ores: Specify healthcheck_url

e0b8dbd5cf-+-Revert "icinga: Make the tools checks not page temporarily"

e38162aa40-+-remove db2007 from site.pp, done with testing

5cdf8ea48b-+-Puppetize new shard s1 db servers

077c592d58-+-Enable updated cassandra-metrics-collector version

ab8446727e-+-Revert "requesttracker: use test db if on jessie"

6cbffa22e6-+-ores: Allow specifying specific sudo rules

89c5da7106-+-Install python-pymysql on statistics compute nodes

e28654afdf-+-Support additional reportupdater directories

ee19b53211-+-Ferm rules for puppetmaster frontend

114c13f0d9-+-Also add backup::host for oit/corp LDAP mirror

c8b1766617-+-Add pollux/openldap to the backup

31c3ad7f98-+-ores: Remove debug notify

eb4212ec53-+-service: Allow not requiring scap3 for service::uwsgi

3b52ab11e1-+-ores: Allow specifying redis_password

8f48d511ca-+-Revert "tools: Do not use nginx proxy for toolschecker"

3c67f75a34-+-tools: Do not use nginx proxy for toolschecker

9007a3220d-+-add puppet code for endowment.wm.org site

a2cff5756b-+-icinga: Increase timeout for tools-checker checks

ae16c7e7c6-+-icinga: Make the tools checks not page temporarily

4c0fb250d5-+-install1001, add new aptrepo role like carbon

51b7b0592c-+-install/aptrepo: move distributions file

e398da267e-+-install_server: split out reprepro to module aptrepo

62e0107519-+-introduce fileserver::secondary role

0c6652aab1-+-cache::misc add endowment.wm.org -> bromine

e9837e232f-+-labstore::fileserver::replicate ensure as a param

99cf1cdfc9-+-wikistats: stop using package=>latest for php-cli

2b8c074e58-+-Assign roles::ores::web, roles::ores::worker to SCB

b1f227b61d-+-Puppet auth.conf:  Use hostname rather than IP

ca7c0288b8-+-Allow horizon to query the labs puppetmaster for a list of classes

2b5037bced-+-hhvm::debug: brown-paper-bag followup to I383bd23196

05efa8aaef-+-hhvm::debug: jessie compatibility

2f4859fbc3-+-apache::mod_conf: jessie compatibility

811faad18c-+-Add firejail profile and wrapper for ghostscript

c3511fff3d-+-networks::constants: Hieraize all_network_subnets

020f1b11db-+-network::constants Split off labs into it's own realm

9fd1ec58dd-+-MobileApps: use the provided request templates for API calls

ae8f3573f5-+-Add role::ores::web and roles::ores::worker

4b0cba9a3e-+-ores: Set the ores::web port to default on 8081

1cc6c30e95-+-phabricator: send maintenance mail to list not individuals

ea95bd9e6d-+-Stop using package->latest in ganglia monitor

48ea6ade10-+-ifttt: Specify the right uwsgi plugin for python2

c56b9eab85-+-Allow horizon hosts to contact the labs puppetmaster.

eebae8bacf-+-Change filter to the actual real name: bot_passwords, plural

79b41a856e-+-Add bot_password as a private table

cbbcac261b-+-Deploy memcached 1.4.25 to mc1010 as part of a performance experiment.

c8699bab70-+-Set Kafka default cleanup policy to 'delete' to avoid any compaction with 0.9

4e8ad10f6d-+-ores: Scap3 deployment configurations

58ed85142b-+-network: Move into module

f45ecf59aa-+-raise fe mem size to 37% on text and upload

31d86272b5-+-varnish: jemalloc tuning for frontend caches

107f0e66bb-+-Add a new backup set to backup openldap databases and enable on serpens

da05773edd-+-service::node: Provide MW API and RESTBase request templates

e983191e51-+-Stop using package->latest in gerrit module

52b182e4ed-+-base::grub: allow enabling the memory cgroup controller

1c911921bc-+-base::grub: actually use augeas on jessie

4446ed42e7-+-base::grub: fix the ioscheduler setting

2856beeb84-+-dynamicproxy: Followup to I7c13506b1a38f03815481651fd13411f7cf7c0c9

e9542ff5f8-+-Attempt to fix dynamicproxy-api service

c482707ddc-+-dynamicproxy: Migrate to python3

c630257f94-+-tools: Allow bastions to talk to flannel etcd

83d925aa20-+-k8s: Ensure /etc/kubernetes is present wherever required

71628dd4cd-+-Increase the number of workers for osm2pgsql.

3eb65432d0-+-raid: double NRPE timeout for check_hpssacli

7f5cc2caa6-+-raid: fix sudo rules for hpssacli (mostly for ms-be)

fa322ee3c1-+-Keep osmosis osm_expire files for a month

8d42a30c36-+-raid: add monitoring for HP controllers

67a845b6a1-+-raid: fix circular dependency

830bc8724a-+-raid: setup multiple checks, one per each RAID found

6d5c3ec1d3-+-raid: vary package installation on the RAID installed

c3f5a1c69b-+-raid: move check-raid.py into /usr/local/lib/nagios/plugins

1a475b2f12-+-fix a couple of puppetmaster failing tests

d6fe5ec7cc-+-wikilabels: make file settings recursive

72cba15d17-+-Create raid module to hold RAID monitoring checks

75441d720b-+-Elastic: add publish_host support

301f56ca8e-+-MariaDB: use 0/1 instead of off/on for read_only

1343f15f4e-+-nutcracker: add an additional guard on the master version

6c61134b4d-+-mediawiki::hhvm: debian jessie compatibility

84cb607330-+-k8s: Expand types of resources accessible to normal users

6f687a9e35-+-tools: Fixup k8s bastion role

3a52248602-+-Revert "Revert "base: Provide better error messages for service_unit""

a3e9caf690-+-wikistats: remove orain and pardus updates

c590c533ec-+-foreachwikiindblist: Fix sudo guard and cleanup script

d9cc85222d-+-Revert "base: Provide better error messages for service_unit"

31385444ec-+-base: Provide better error messages for service_unit

6afc5344c2-+-icinga: make commons content check critical (paging)

d746b0dbac-+-move ubuntu-cloud.key to openstack module

1770ae6b55-+-swift: remove precise-specific section

24b15d9958-+-lvs: swap cr1-esams/cr2-esams sessions

2b8a33c022-+-tools.checker continually watch for webservices

34bfb1de85-+-Stop varnishncsa

fe07c1a6b9-+-lvs: move BGP sessions from cr2-knams to cr2-esams

bbe7e95d63-+-k8s: Decouple kubelet from kube-proxy

eb2b2fb3d9-+-Remove unused varnishncsa-related code

1e0cc7ae15-+-cache_text: cap frontend TTL at 1d

5cb946bef6-+-Bump connection table size on Kafka brokers

82a22e32ea-+-Cleanup my.cnf by grouping options

01a8a274c7-+-Provide a wrapper to invoke convert using firejail

9d9ba835d2-+-ferm: Restrict ganglia aggregator a bit more

378f6463ef-+-Provide a firejail profile for the image scalers

c94fa9a4c3-+-rsyslog::receiver: Increase log retention to 90 days

79f8a59e3b-+-rcstream: let wikitech connect to redis via IPv6

3a8a6fc816-+-Druid puppet improvements for prod

c2d0eca8a8-+-Use ruby json lib to render Arrays as strings in druid runtime.properties.erb

b013ff9a44-+-Make debug notify unique

67460f1405-+-More temporary debug info

2462cfb22e-+-Add temporary debug message to puppet for union

e1d43a90a1-+-Install the druid service package for each service

9b27af1435-+-Add analytics_cluster::hadoop::client to druid workers so CDH is installed

c2aca3160d-+-Apply druid roles in production with initial (guesswork) configuration

dbb039e695-+-nagios: move check_command/config to own file

472adcdef5-+-udp2log: mv rolematcher.py PacketLossLogtailer.py to module

b565a72519-+-Druid module and analytics_cluster role class

fd34f56c0d-+-VCL: lower TTL caps from 14 to 7 days

a8b33da806-+-udp2log: move icinga checks from ./files/ to module

294c602a29-+-Fix key name in scap::target

3ad1951348-+-keyholder key cleanup

5304fb10b0-+-contint: let us vary localhost vhost unix user

b72d109956-+-Add druid100[123] with just standard and base::firewall

30bae2b255-+-service::node: Prepare for scap3 config deploys

8a76776fc9-+-graphite: split uwsgi logs to separate files

d907b84e45-+-RESTBase: Remove purging config

74120961fa-+-wikistats: Fix pplint error in wikistats::db

ecfa8c0e13-+-Elastic: add support for network.host

b1e087edc3-+-Drop deployment-ssh rules from role::snapshot::dumper

813a40d2b3-+-Change Prop: Purge RESTBase re-renders

80d148fade-+-Enable base::firewall for new snapshot hosts

4f5f281f29-+-Add ferm rules for role::snapshot::dumper

ca28742292-+-Only require firejail on trusty/jessie

8b281fb956-+-grafana: add wmf branding

9069f9118e-+-grafana: disable automatic update checking and external snapshots

1935694c2e-+-Convert mwgrep to use regexp by default

089a5ea67c-+-syslog: move role class to autoloader layout

b55fa267ff-+-snapshot: follow-up to move role classes

717de5db5a-+-snapshot: one file per role class, move to modules/role

7fc3d28a2e-+-logging: move files/misc/demux.py to modules/udp2log

4899ebb78b-+-install_server: move mirrors stuff to own role

0215863211-+-ores: Specify uwsgi plugins to override the default

ed5cd3b65b-+-Remove non ASCII character from scap.pp

66a15487c7-+-ores: Use the new service::uwsgi define

68f5692178-+-ircecho: set user/group/mode for unit file

37e880b1c1-+-mediawiki: assign new eqiad appservers, install with jessie

41ffce7d23-+-cache_text: raise FE mem from 1/8 to 1/4 total

2d6c5d6b88-+-Install firejail on image/video scalers

4981b1ba52-+-Reintroduce es200[1234] in puppet, without specific roles

29c06c9c9f-+-Revert "Apply firewall to db1016"- apply it on a different entry

d4366aef0e-+-Apply firewall to db1016

4c5beb0a0f-+-Change prop: Add the rule for MobileApps re-renders

3678112d4f-+-Enable base::firewall in the pool counter role

197744154e-+-add icinga monitoring for content on commons

779e36b741-+-elasticsearch: use generic names not hostnames in ferm

affc80b03d-+-labtestweb2001: add IPv6 like on silver

74f83ac28a-+-labstore clean up hiera application

913ae52888-+-rcstream: fix stream for wikitech, let silver connect to redis

f4f87efce1-+-labstore cleanup and role vs module arrange

00599da95f-+-Ensure we pull latest on analytics.wikimedia.org

855f48d28d-+-labstore move standard below role assign

c8709eca67-+-ircecho: add icinga process monitoring

58916a2fb9-+-mediawiki: decommission old codfw appservers

fa3e270099-+-Specific configuration for new maps cluster.

c0de83485b-+-Document needed database steps when setting up a new labservices box

00724f56bb-+-RESTBase: Set up rate limiting

e1f0cf1fb8-+-Restore alphabetic order in site.pp after holmium rename

74c47d7241-+-Enable base::firewall on potassium

8ac59893ae-+-Rename Holmium to labservices1002

cb93ecca62-+-Point CirrusSearch alerting at more useful metrics

44ffb7b5e6-+-ircd: make check_ircd a critical (paging) icinga check

fee35b26fa-+-memcached: move logrotate,snapshot files into module

4c60593a99-+-Provision Diamond collector for Memcached

4e7da7d32e-+-Rename Hiera variable for aqs hosts

fd4cf1a09a-+-lvs::monitor_services: s/eqiad/codfw/ in descriptions where needed

7651769c0b-+-varnish: don't run varnishlog on 3.x hosts

70264a04d6-+-Updated cassandra-metrics-collector version(s)

e0bdef59e1-+-Prepare db1016 and db2010 for jessie reimage; db misc puppet review

ade3c7c9d0-+-Maps - Ensure that Redis listen on all interfaces.

b07289436a-+-service::node: Remove firejail and deployment_manage_user

9a1fe15d1e-+-Allow CQL access for multi-instance AQS Cassandra setup

115dd4d792-+-Increase time window on which graphite checks are done for WDQS

8b9d84dd5f-+-toollabs: Replace trusty PHP5 session cleanup script

6d1c800010-+-labs nfs scratch and dumps to soft mode

23f6329a6b-+-labstore::fileserver remove use_ldap option

cda2f093a5-+-labstore200[1-4] add standard in site.pp

c29acc9a44-+-labstore nfs introduce nfs_mount defined type

50987c26f9-+-Cloning analytics.wikimedia.org repo

d71681f62a-+-labstore1003 define scratch share

8c9659d2d3-+-Fix suoders permissions for l10nupdate

716a31fb81-+-cassandra: pin cassandra version

70bc47c26c-+-Maps - make redis server configureable

ed62875877-+-Revert "mariadb: set is_critical to false for checks"

f1c05170a9-+-Revert "mariadb: set replication check's contact_group to admins"

2915ac8895-+-RT: loading mod_fastcgi wasnt puppetized

b0bd5fd546-+-RT: do not ensure=>latest,install perldoc

b17794bdb5-+-requesttracker: use test db if on jessie

be5e8bfdba-+-labs bastions cgroup for /shared/bin/node

7fcd953996-+-temp. setup to use db2007 for RT upgrade test

bc4d947f11-+-Install heirloom-mailx on analytics clients

c56a3962e6-+-Make dumps.wikimedia.org access logs readable on stat1002 dest, also only rsync *.gz files

8016f3a23a-+-remove cron job on snapshots that generates list of media upload dirs

10bd0059c2-+-openstack: allow unprivileged users to access nova logs

a62e1ef0ec-+-cp104[34] role spare for decom - T133614

05016eda17-+-Mark old esams caches as to-be-decommed

adfccc9c4b-+-MariaDB: Reimage db1029 to Jessie and MariaDB 10

a9f0a9ca0f-+-Upgrade db1033 to jessie and mariadb10

af47a41384-+-Add fonts-smc (Malayalam) to image/video scalers

3b902cd1e8-+-base::service_unit: Remove old cruft

e217d07b97-+-cassandra::metrics: Refresh the collector on a unit file change

979e1c27a8-+-labs nfs client instance refactor

585f2955da-+-Cassandra 2.2.6 config

f56e71fa81-+-tools: Enable HostPathEnforcer admission controller

91498b86d9-+-toolserver: add wiki. and stable. LE certs

a43a3e0eb5-+-tools: Enable host automounts

6dadc51704-+-mw_rc_irc: remove upstart, pre-jessie support

2a0407b5bc-+-MariaDB: remove special SSL option multiple-ca

134cca35cb-+-Revert "varnisxcache: initial temporary limit to cp1065"

02c6ab6b50-+-varnisxcache: initial temporary limit to cp1065

2465c7702c-+-Use scap subcommands

cb4c0bf428-+-varnishxcache - new monitoring script for hit/miss stuff

1e6e859625-+-Remove unneeded $heartbeat_enabled variables

4e1b2e25cc-+-varnishxcps: misc nits

93a628770d-+-Blacklist asn1_decoder kernel module

a4ede403a8-+-service::uwsgi: log dir owned by www-data

203579b1a1-+-Enable heartbeat on all masters, even on the pasive datacenter

5b99302198-+-service::uwsgi: Use Uwsgi::App

36091f5821-+-Install parallel package on mariadb::client(s)

e7feebbaf2-+-Introduce service::uwsgi

616383a37c-+-descriptors should be world readable

a7f2010133-+-service::update: Fix: Correct the she-bang for check-${title}

390284f183-+-sysfs: puppet always restarted the sysfsutils service

f783e1941f-+-keyholder: ops into trusted groups unconditionally

b6db1ddaf3-+-service::node: Add a wrapper script for service_checker

d1605b20a9-+-Remove scap::clean now that scap is clean

bc2db847a3-+-planet: only run updates when in active datacenter

dbfc414185-+-add CQL interface and port to descriptors

551ab75742-+-planet: node regex to cover 2001 in codfw as well

41b2eabc5f-+-Use force to clean scap directory

94f3e8e98d-+-Clean old scap code

d7abf7fbaf-+-mirrors: mirror Tails as well

d67ec34866-+-caches: refactor around cache::cluster

a8508ca810-+-Add a new AQS testing environment to play with Cassandra settings before production.

33db686190-+-Glance backup:  Omit directory timestamps

fb997a0397-+-ores: install aspell-sv

c4c5a4d376-+-Add new suggested memcached settings to mc1009 as part of perf experiment.

9d7f0eb3be-+-Remove (almost) all references to db1027 on production puppet

f6c51e280c-+-lvs::monitor_services: fix restbase path

f958476f5f-+-lvs::monitor: monitor all services via service_checker

a706440705-+-toolserver.org: break puppet dependency cycle

17a0bce057-+-toolserver.org: adjust puppet dependencies for cert change

c54ec2f51f-+-/srv/glance should be owned by glance.

04e02af844-+-add Letsencrypt cert/config for (www.)toolserver.org

f8a0a0239c-+-Remove a couple of unused settings from ldap config

7aeab22b66-+-Set the proper .tld in labtest resolv.conf

3e56a81142-+-varnish::instance: remove unused arg xff_sources

92834e72a8-+-cache_upload: remove redundant backend ttl_cap

aed07b2fe9-+-notebook: add base::firewall to stub role

4c67e487fa-+-admin: add all-users group

339a620a2d-+-Remove confluent conditional in role::kafka::analytics::broker

6c051e2599-+-ores: Send icinga report to IRC

5122cdda83-+-tools: Bump k8s version

18106334a0-+-Refactor the $hiera_config variable to come from hiera.

e8f6911daf-+-cache_upload: raise FE mem from 1/12 to 1/4 total

3d5093718f-+-notebook: Teach yuvi to use regexes properly

9cc42b0a68-+-Change prop: Activate back the service

56544af220-+-notebook: Introduce stub role

e17e3a6b55-+-Reinstate db2058, deleted instead of db1058

c738e63854-+-Glance: Fix the glance image backup cron

bc07f9b1ca-+-Set oathauth_users as a private table

67884dd4cc-+-Graphoid: Do not use the proxy for the allowed domains

79aee97061-+-Include 10.196.* in site 'codfw'

2e189f9d7b-+-Re-enable refresh on unit file change for memcached.

da96c40bc1-+-Add a space after each memcached extra command line option to ensure proper settings.

d71001e515-+-icinga tools.checker Tools paging update

c13daa49ce-+-tools: Bump k8s version again

b6571a9de7-+-tools: Bump k8s version

3ff73cb1f8-+-Fix labtest pdns config for different TLD and private IP range

e31b0a7bc6-+-gitblit: remove exec permission from unit file

4449af10df-+-RT: SSL setup only on precise

fa85bcc9be-+-RT: install different Apache config on new server

da92d9324c-+-Revert "ununpentium: temp remove the RT role"

f9a43e5367-+-cache::misc: add director for rt.wikimedia.org

66db47296f-+-Revert "Depooling wdqs1001 for reinstall and new disks"

4f05209c77-+-tool labs bastions tcl cgroup

069fa40c01-+-phab::vcs: Add a proxy parameter

6babdcc018-+-tools: Add python-requests-oauthlib package

7a41a8134e-+-Fix default replication factor in clusters with less than 3 brokers (labs)

2e94592492-+-update checker.tools.wmflabs.org toolscron endpoint

f6e8b2ea6b-+-lvs::monitor: actual, not virtual resources.

dacdca015e-+-lvs::monitor: fix duplicate declaration

9587be0dde-+-mobileapps: add experimental cluster check

ec0dfd1c88-+-Enable base::firewall on db1011

d0cb33a74a-+-Add ferm rules for role::mariadb::tendril

dcbebfbc3c-+-Disable unprivileged bpf on Linux >= 4.4

12003d3e76-+-graphite: deprecate 'carbonctl check'

db7b785439-+-Move jobrunner ferm service into the roles

976368d8ce-+-Change Prop: Increase heap limit to 750 MB

ae3d9f7d17-+-tools: Enable the Registry Enforcer

efeaddb5da-+-grafana: move files from ./files/ to module

e89b86ae3f-+-Create the labsldapconfig hiera struct

f39048ac3a-+-cache_misc: puppetize switch to file storage

48dc33ffbc-+-Labs puppetmaster:  Get labs instance IP range from hiera

bf7497156a-+-tools: Bump k8s version

68cc88ca5d-+-Add temporary hiera config to contitionally set broker protocol version

65b34f5b0a-+-cache_maps: use more FE mem on prod hardware

eb92c73ad1-+-ircd: remove exec permission bit on unit file

4e97b2cce3-+-Depooling wdqs1001 for reinstall and new disks

f05b7eb0bf-+-Change-Prop: Limit the number of concurrent tasks

5878eb04e8-+-Open up the firewall for mysql on labtestcontrol2001

308d8704f4-+-Raise the memcached chunk growth factor on mc1007 as part of a perf experiment.

590524fadb-+-graphite: add 'big_users' route and cluster

13336026ae-+-MariaDB: tune thread-pool to avoid Aborted_connects

b39db4b235-+-MariaDB: Change mariadb::core parameters

3f1f93d6a4-+-Add ferm rules for pybal_conf / http

65bf866dd9-+-Add a role description to snapshot::cron::wikidatadumps::json

2cb9f7a25f-+-tlsproxy: use http/1.1 only in conjunction with varnish4

f5b6e203fc-+-cxserver: scap3 migration

bf56961c91-+-Deploy mobileapps using scap3, 2nd try

a1e18f8245-+-nagios_common: Add command for using service_checker

65811d37f2-+-MariaDB: set $master true for codfw masters

e732a3517e-+-contint: drop libcurl4-gnutls-dev

afc969326b-+-contint: regroup PHP definitions in contint::packages::php

43026d792a-+-contint: move package_builder setup to its own class

5cfbc822cf-+-contint: move File[/srv/localhost-worker] out of role

e7bb0377a5-+-base: add gdisk to standard packages

123c687b55-+-scap: update to 3.2.0-1

59bf2bc7a7-+-graphite: run graphite-index every five minutes

a7388feffd-+-Add the possibility to specify memcached's chunk growth factor.

5a381c6fc9-+-ocg: set correct ImageMagick conf dir on jessie

71d835f8d6-+-ocg: use 'adm' group for log dir when on systemd

9a65ddeb95-+-ocg: don't try to use syslog group on jessie

c67983505b-+-ocg: install the right font packages on jessie

ca2a34c204-+-ocg: follow-up fix for systemd change

dd3e0b1c83-+-ocg: make it work on systemd

65b078fc75-+-Set graphoid result headers

85743b9efe-+-Remove obsolete graphoid settings

3170833321-+-Preparing configuration for new maps servers

96721b3ed7-+-hhvm: skip ganglia when it is unwanted

7a8114aff1-+-apache: skip ganglia when it is unwanted

d38d549a81-+-ocg: skip ganglia when it is unwanted

729530bf6c-+-Fix for kafka broker process alert for confluent brokers

bfbfed2887-+-Move several Labs IPs and IP ranges into Hiera.

e765946c2d-+-s/kakfa/kafka

c3eb24ec88-+-Hardcode ferm::service kafka broker port

1191d1ce65-+-Fix ferm rule for confluent kafka broker

152dad03ff-+-Require proper class in confluent::kafka::broker::alerts

64b30dfe9f-+-Fix kafka typo

dc7ec527be-+-Fix include and thresholds for icinga alerts for confluent kafka brokers

00fce607a3-+-collapse icinga monitoring for tools

e77e5809b2-+-Enable base::firewall on labtestcontrol2001

eac8c9b49d-+-change icinga host for toollabs from ip to hostname based

92e8ffac41-+-change up alerting for services within tools in icinga

542696e6c2-+-service::node: Add a convenience script to pretty-tail logs

016b77712e-+-contint: create /mnt/redis

0e03422504-+-Revert "Revert "phabricator: Send weekly mail every week instead of on certain monthdays""

1edac8800b-+-Move puppet repository cherrypick counter to diamond collector

9adaf3a36d-+-deployment-prep: keyholder shinken monitoring

5d59ef23fc-+-graphite: add cluster_servers graphite-web setting

3dd62bb118-+-ununpentium: temp remove the RT role

61942b1439-+-mdadm boot-time race condition: sleep in init-premount

cefcbfab6d-+-mariadb: set replication check's contact_group to admins

3bfbd04f22-+-mariadb: set is_critical to false for checks

c3db27f01b-+-graphite: fix hostnames / brown paperbag

4974b38294-+-graphite: export /var/lib/carbon via rsync

e7f57c91db-+-tools: 'backup' packages

791c952412-+-ldap: Remove some more ensure => absents no longer needed

1baa9191fa-+-ldap: Fix another arrow alignment

517de9b3ff-+-ldap: Get rid of cleanup-pam-config script

f8e6b66b2b-+-aptly: Add ferm rule to role

a914834546-+-noc site: move role class to autoloader layout

b3eaf08d61-+-role performance::site, adjust name in comment

f450e08a12-+-performance site: move role class to autoloader layout

b2ce550edd-+-piwik: move role class to autoloader layout

dc5176c518-+-remove duplicate base::firewall from kraz

b5f8866d0f-+-Revert "Revert "remove argon from site.pp and install_server""

e924301ac6-+-udpmxircecho: Move from template to file

906edc7b30-+-udpmxircecho: use a config file

6979b80e59-+-Publishes non aggregated metrics for WDQS updater

8866dfed30-+-Use --delete when rsyncing images from the nova controller to the spare.

19dadf489c-+-Purge labs dns/ldap code

c2d475e38c-+-Revert "remove argon from site.pp and install_server"

054bdcf70a-+-remove argon from site.pp and install_server

769821a99f-+-labs pdns updates

79d66f692b-+-Remove ldap/dns services from labcontrol1001 and labcontrol1002

fca87fde07-+-ircserver: move ircd.conf to public repo

000814305a-+-contint: drop role::ci::slave::labs::light

43f4b766b8-+-imagemagick: fix policy.xml path for newer versions

10946ec17d-+-Remove es2001-es2010 from production puppet

54cd40e3f5-+-mediawiki: remove all php5-fss references

3e0d791bbe-+-Change-prop: no automatic restarts

be90cb172b-+-Remove testing parameters/settings from mc1009's memcached.

0656dab554-+-servermon: Inform puppet gunicorn has no status command

0bad09a726-+-graphite: add graphite2002.codfw.wmnet

110bc58738-+-Remove (almost) all references to db1058 on puppet

9d94634cf8-+-Remove duplicate of 'lru_crawler' in the mc[12]009 memcached configs.

c947112b63-+-statsite: port to jessie/systemd

68813becb2-+-graphite: port to jessie/systemd

3fb0ae3ea4-+-k8s: Bump up docker version

a9d12f4df3-+-k8s: Allow pod infra image to be overriden with hiera

8d0f52d9b5-+-k8s: Fixup to previous commit

7b750fbbea-+-k8s: Verify pause container is correct on each build

b400830651-+-debug_proxy: allow all WMF networks

2a3e269c68-+-Diamond collector for nagios plugin return codes

aa68689c76-+-Fixes to the 'makedomain' script.

5c100fcbd2-+-Increase the cache size for the Labs dns recursor

3e226d9dde-+-New role: role::labs::redirector

f4b4f2ea09-+-MariaDB: set mysql_role to standalone for es1

61ab203a91-+-Decommission ocg1003.

1f836f0de4-+-Update cassandra-metrics-collector version

041e521006-+-Blacklist some meta-table Cassandra metrics

534426275e-+-VCL: cap all TTLs at 14d (or less in existing cases)

49e0a22f59-+-Revert "Deploy mobileapps using scap3"

111963071b-+-Open the firewall so that designate can talk to mysql on dns hosts

a9f061b957-+-Deploy mobileapps using scap3

3b0acf0c60-+-Designate:  Specify IP for pool target master rather than fqdn

f7dab2b2db-+-Prepare db1023 for reimage

734d16b578-+-Alter role::kafka::analytics::broker to be able to use confluent module during upgrade

80259e06f4-+-Add new confluent module and puppetization for using confluent Kafka

c743393771-+-Allow axfr on udp, take two

b9b564def4-+-Designate: Open up firewall to udp on 5354 for axfr syncing

a3120ca137-+-Update memcached version on mc1009 as part of a performance test.

2d37efc979-+-planet: Use the per site url-downloader instance

f09d67e2b1-+-uwsgi: Add python3 support

f3a7799818-+-MariaDB: Set additional salt grains for core DBs

60ad8c7110-+-Revert "chromium: Remove url_downloader hiera and role"

6b14de1d26-+-chromium: Remove url_downloader hiera and role

e33079506a-+-chromium: Remove url_downloader role

e604bf6e85-+-memcached: install a specific version on mc2009

d6cffab431-+-Tools: Install xml2 on execution nodes

e9f5bef577-+-contint: disable HHVM background service

b6ce636348-+-hhvm: allow passing service parameters

024f70d32a-+-service::node: remove monitoring on $enable=false

93c576feb4-+-service::node: ensure => stopped on $enable=false

887685c74d-+-Disable changeprop service

905155e838-+-Add a parameter to service::node for enabling or disabling the service unit

5a67c84273-+-More phabricator config changes refs T128797

04fdbb188f-+-librarize phab extensions repo

890245b22f-+-scap access.conf entries for labs deployments

26dfa873c1-+-Remove base::firewall from stat1002 and stat1004 analytics cluster clients

66a5d072d4-+-Add response time checks to WDQS

e406dba9ad-+-Use FQDN for OCG hostnames.

a9d4e17f59-+-Add analytics.wikimedia.org to list of domains served by misc varnish backend stat1001

4bac06433f-+-Use template() in statistics::sites::analytics

9b6fc6168c-+-Use content instead of source param in statistics::sites::analytics

20767ec867-+-Set up analytics.wikimedia.org site on stat1001

a2669ab5e0-+-Enable base::firewall on kraz

125f28e452-+-remove do_spdy conditional, all h2, 1/2

8e5fcdaed9-+-use full paths and explicitly invoke bash for kiwix rsync cron script

ea217facf7-+-Require at least one Event Logging process running for EventBus.

f0f577a8e0-+-Increase eventbus num processors to 8

942fec7ea3-+-Change-Prop: Enable summary and definition updates.

c41fcb19ba-+-Add LVS configuration for EventBus in codfw (DNS reverse/wmnet config already in place).

a15192988e-+-Prepare db1058 for jessie reimage

e806c1204a-+-Increase the filehandle limit for rabbitmq in labs.

078eb285b2-+-Add beta-specific access.conf exceptions in scap::target

fe093a952e-+-Clean out pdns config cruft.

98da13a7ad-+-Add Apache mod-cgi to stat1001 configuration to allow Perl CGI scripts.

31dc88ad03-+-Fix grants for labs pdns

bea2c202cc-+-imagemagick: install policy everywhere

855335695d-+-mediawiki: install imagemagick policy

b048e9ebb2-+-ocg: add imagemagick policy

d9bef6003f-+-imagemagick: create class imagemagick::install, use on librenms

56358b4f57-+-contint: move npmtravis out of prod slave

59d3e7ad00-+-contint: clean up role::ci::slave

290574feef-+-contint: pypy package for pywikibot

89a0f70324-+-Add jam.wikipedia to RESTBase and Labs dnsrecursor

678291ae30-+-cassandra: add restbase200[789]

b431980afc-+-Fix kafkatee's webrequest_{text,upload} since we have now 24 partitions per topic.

30dfd1867c-+-hhvm: fix logging dir permissions

b3c6720654-+-Changeprop: Set hyperswitch as the start-up module

dbd3de3036-+-hhvm: make /var/log/hhvm owned by root

058b9de1fb-+-add sinistra.codfw to site.pp

2251968aa6-+-Revert "Return a custom HTTP 503 response for all the stat1001 websites due to maintenance."

4b600763bb-+-Prepare db1040 for reimaging to jessie

4ec3c9a306-+-Return a custom HTTP 503 response for all the stat1001 websites due to maintenance.

b17b432c46-+-mediawiki::web: drop HHVM define, explicitly block php

b414982eba-+-mediawiki::web: switch globally to use the worker mpm instead of prefork

66b251f937-+-Revert "releases: use secret() for gpg keyring"

2ac1435b56-+-releases: use secret() for gpg keyring

e6ad68dd84-+-Prepare db2033 for jessie reimage

767ac6f8e2-+-jsbench: Add ferm rules for xvfb

ef6813c186-+-Enable base::firewall on stat1002

652f286f87-+-Enable kafka200[12] to host Kafka and EventBus.

548106a561-+-RT: include Apache mod_headers

12ec4b4a49-+-LE: require sslcert::dhparam

4a0e8b992f-+-phragile: move role class to autoloader layout

c719c4adad-+-RT: include Apache mod rewrite

a91facf177-+-RT: don't include PHP, this is Perl

2150878277-+-Include python-keystoneclient along with the labsaliaser.

34ca0aa5d6-+-labs dnsrecursor IP aliasing: work on all projects, not just some arbitrary ones

a9d551d7c7-+-Set up Let's Encrypt certificate for labtestwikitech

8986b216b8-+-Do not map new elasticsearch servers in site.pp

95ad05ee60-+-Example of possible configuration to run mc2009 with the latest memcached version.

3bfa4e16fe-+-Config changes for db1038 (old s3 master) reimaging

ad8ab34d7f-+-MariaDB: Load and enable semi-sync replication

a36e3bca6f-+-Add conf200[123] Zookeeper Service nodes in codfw.

0d7a41afae-+-kubernetes upgrade to v1.2.3wmf1

499b742551-+-fix up rsync of kiwix openzim files to dataset host

9cbac69210-+-tools: Remove all webservice related code

a753b90577-+-Add grants to pdns mysql for localhost

92693667cc-+-tcpircbot: allow sending messages from palladium

782db121ef-+-palladium: add v6 address

b1abda62bd-+-udp2log: Move ferm rules into the role

2195a40628-+-public_task_dump.py should run once per day, not once per minute

3fe0f317ba-+-RT: include standard in ununpentium

dd6af60406-+-RT: fix role class name that has changed lately

5adbd1c7cb-+-RT: add role on ununpentium, disable acme, add IPv6

c87bcbfac9-+-Reformat a file permission from 01775 to 1775

3b0a5eb1b6-+-Allow wikidev to upload to carbon:/srv/wikimedia/incoming

ad587097c0-+-icinga labs auth dns check update description

848a9f89de-+-icinga for labs Auth DNS convert to check_dig

acc25d72a6-+-toollabs: Use a template for limits.conf

88b53f1ec7-+-Revert "Depooled wdqs1001 during reinstall"

a0a33aa8cd-+-add ununpentium to site.pp as test::system, DHCP/netboot

6954bfc443-+-Only install font-gujr-extra on jessie

45df0fe445-+-tools: Switch to newer webservice comand

94689a8369-+-LE: add do_acme hieradata control for provisioning

eeba1a99ce-+-ores: Adds myspell-hu to base

080ed80dbf-+-testsystem: move role class to test::system

ce3495b905-+-contint: Use slave-scripts/bin/php wrapper script

d16e0b6ece-+-mariadb: allow up to two eventlogging_sync processes

13a2dedb80-+-dnsmasq: drop beta cluster mobile public IP

34057dd6a1-+-Add reference to Phab task

0707504ac1-+-Avoid cron spam in aead sync

608f5fe4e2-+-mediawiki: re-add mw1120, now as a canary

6a30bffae7-+-mediawiki: remove decommissioned appservers

1dc313fa5d-+-Read config from cxserver

a2f08a55a1-+-Add mysql to labs dns servers

70e67b4f21-+-Add ferm service for rsyncd on stat1002

8ff0e28f4f-+-Add a maintenance flag to cache::misc directors.

89972457a3-+-servermon: Amend the make_updates.py path

766f529d93-+-servermon: Specify the directory where the code actually lives in

b701f0ca62-+-servermon: Add managed_puppet_modules parameter

df8580abbe-+-RT: remove role from krypton, was for jessie test

76e8640212-+-rt.wm.o: remove old cert definition

ee6dc86f73-+-mirrors: combine ubuntu+mirrors into single SAN instance

245ce89e60-+-LE: actually deploy the challenge-apache.conf file

72df35c39c-+-rt.wm.o: use LE cert

9f043fc0ac-+-ircserver: add irssi on irc server for testing

2f4bc6c3db-+-ircserver: puppetize install of ircd-ratbox

9c9a022ae3-+-ircecho: fix init file dependency for service on systemd

2225e10bb0-+-ircecho: make it start on systemd, add unit file

d42b26a0fd-+-racktables: move role class to autoloader layout

6749756ead-+-RT: move role classes to autoloader layout, split labs

339a2a8efd-+-icinga: add virtual host and ssl check for stream.wm.org

582eceefc6-+-rcstream: Update source range

8675fdbb28-+-LE: add apache config/example

297bea46ba-+-cache_maps: add all sites in LVS

c6e3758eff-+-Add cron job to synchronise AEAD files from primary auth server

9241a005e3-+-ganglia: don't run ganglia-monitor in labs

3567f85396-+-planet: move role class to autoloader layout

16aa977c3b-+-contint: decouple slave_scripts and composer

5a409a9b70-+-contint: drop integration/phpcs

c0a70b455f-+-contint: rsync server to hold jobs caches

1c96243cf4-+-labs dnsrecurser update settings

ab3016d162-+-LE: fix "creates" path on first exec

01c88d95a0-+-LE: include rather than require sslcert

c1bd99068a-+-apt|mirrors|ubuntu: puppetized LE certs

a0f8c9976d-+-letsencrypt module guts + acme-setup script

ba6e04401b-+-dnsrecursor update module and template

f0464cbed7-+-ssl_ciphersuite refactoring, jessie+apache DHE support

261315b828-+-Remove duplicate definition of service

2b3e240431-+-Enable base::firewall for hassaleh/hassium

55129a1b0f-+-Add ferm service for debug proxy

ae50f9b7e4-+-Depooled wdqs1001 during reinstall

a4a2cfb16a-+-labs: Add diamond collector for pdns_recursor stats

65b0cc10e0-+-labs: Allow diamond to be root for pdns_control list

a64c3e7e52-+-labs: Add diamond collector for PDNS authoritative server

58dc94bc2e-+-network: kill bast4001 SLAAC from ::constants

b7fcb1ef96-+-bastion: install mtr-tiny, cleanup

5a1b347710-+-remove cp104[34] storage cfg T133614

edceb0e222-+-cache_maps: remove cp104[34] test caches

be38798128-+-create letsencrypt module, install acme-tiny

0a779adb40-+-ganglia: fix aggregator config/service dependency

ee6be3fb4c-+-ganglia: on systemd only start service if site is monitored site

5ae91f658e-+-fixup maps cache routing: T109162

6cc42515bb-+-cache_maps: re-role old mobile servers

f717b99a7f-+-Mark analytics1015 as a spare

d43666c809-+-network: kill iron's SLAAC from ::constants

8a42b1911a-+-labstore throughput thresholds adjustments

89629ef986-+-Upgrade db1052 to new puppet core class + MariaDB10 + jessie

0c5073ec01-+-Use unicast instead of multicast for Elasticsearch node communication

c80eefa5a9-+-ores: fix staging configs

5d399a124f-+-quarry: Enforce https only at nginx level

b575e5e107-+-quarry: Make Quarry HTTPS only

5ec9c2dbae-+-uwsgi: Always die on term!

2ec2159af1-+-uwsgi: Allow specifying multiple values for keys

0a9b64fac9-+-install_server: move tftp role to autoloader layout

6a2f85b9d7-+-cgred changes for toollabs bastions use case

1e275c87fd-+-toollabs: bastion setup for cgred::group throttle

a882e00a08-+-toollabs: bastion setup for cgred::group shell

ba26ad6e56-+-toollabs: bastion setup for cgred::group user daemons

a3ae6ae3b2-+-toollabs: bastion setup for cgred::group utilities

9aefbfb3af-+-toollabs: bastion fixup perms for cgred

6963dbbd41-+-remove duplicate package def for cgroup-bin

f2fb4762b2-+-toollabs: bastion setup for cgred::group scripts

97844aea10-+-labs: setting up to use cgrules engine

49232b2d92-+-servermon: require_package python-ldap instead

ec8843fb24-+-Add additional Gujarati fonts (Rekha) (fonts-gujr-extra)

5f5ec4bada-+-Update font package dependency in toollabs::exec_environ

b9142377e5-+-memcached: on mc2010, set 'maxconns_fast', 'hash_algorithm=murmur3', 'lru_crawler'

11c98d0471-+-Move from python-irclib to python-irc

2ac17fe96e-+-add install_server::tftp role on install1001

a5d506c540-+-switchover: switch (s1-s7, x1) master role to eqiad

da4cd1e0c9-+-Configure an rsync server which is used to synchronise the AEAD key files between the auth servers

5bc526899a-+-MariaDB: separate external storage my.cnf

bcc355bbe2-+-Add puppet-cert TLS certs to x1 database hosts

fba6d772dd-+-Add mod_headers to the httpd config to allow the Header directive.

3886290f89-+-Fix appserver font package name for Indian fonts

fbcb37734a-+-add install1001 to site.pp and DHCP

1117d52531-+-lshell scaffolding for restricting Labs users

9beaffc336-+-Set db1031 as the local eqiad master and set it to ROW binlog

7f59842456-+-Add HSTS=1y to several one-off public services

b73d6e9a12-+-apt|ubuntu|mirrors: template standard HSTS=1y settings

a397360532-+-Include process and disk alerts for hive, oozie and mysql on analytics1003

dbbbe15dcd-+-redis::monitoring::instance: partially disable replication checks

dfa6e1ce52-+-bastionhost::general: include dsh configuration

7f7a7459ee-+-analytics1015 -> analytics1003 migration

6644bc3696-+-Add reference to Phab tickets as used for other fonts

955a5586df-+-MariaDB: complete TLS and master configuration

b94d71a2f4-+-Enable base::firewall for db1065

389064b4a7-+-Enable base::firewall for mariadb s7 shard in eqiad

8d93d2d812-+-Enable base::firewall for mariadb s6 shard in eqiad

c0c4344bf7-+-Enable base::firewall for mariadb s5 shard in eqiad

a05d7efc2b-+-ores: Add logformat

f3936e99ad-+-Enable base::firewall for mariadb s4 shard in eqiad

0fb8ba0dad-+-Enable base::firewall for mariadb s1 shard in eqiad

04cea29a67-+-Enable base::firewall for mariadb es1 shard in eqiad

6057d93f45-+-apache: ignore lint issues in mod.pp

b1a85262d3-+-Disable RESTBase highest max SSTables per read threshold

c19babaeb5-+-ircserver: fix dependencies for running on jessie

edbf4358f2-+-ircserver: add systemd unit file and conditionals

b8602f852b-+-add tegmen and einsteinium to site.pp

7151327990-+-ircserver/irc_echo: use systemd provider if on jessie

69b9cb2942-+-Include analytics_cluster::client and analytics_cluster::database::meta roles on analytics1003

a256791e9e-+-Add analytics1003 in netboot.cfg and site.pp

23b02e80d4-+-Fix eventlogging_NavigationTiming_throughput again - need sumSeries()

064e52c4ae-+-Raise highest SSTables thresholds (again)

2bc5ef16a6-+-kraz.codfw.wmnet -> kraz.wm.org, needs public IP

077948c5ee-+-MariaDB: Fix pt-heartbeat for x1 codfw master

cffdf215ab-+-kubernetes to v1.2.2wmf1

fce869710f-+-statistics: rsync on stat1004 for stat1001 migration

23d6bbd961-+-MariaDB: set codfw local masters as masters (s1-s7)

1deeca2f96-+-Configure ganglia-web to cache data in a location it can actually write to

3118495b74-+-Setup meitnerium as the jessie-based archiva host

ee0c999a44-+-graphite: add graphite1003

d7448369e8-+-Install pt-heartbeat-wikimedia on all relevant servers

f5ad15785a-+-debdeploy: rename init.pp to master.pp to match class name

ba634af90b-+-Revert "ganglia-web: don't send Content-Disposition header with JSON / CSV data"

9414123035-+-ganglia-web: don't send Content-Disposition header with JSON / CSV data

2027f6cffe-+-Increase php memory-limit for ganglia-web from 256 to 768

18c38a3cdc-+-Adding furud as antimony replacement to git replication

73c7dc873f-+-gitblit: install openjdk-7-jre

9abebf7960-+-gitblit: add systemd unit, if jessie use it

f0d2c97405-+-torrus: ignore lint issue with include for tests

9b2ab78c19-+-gitblit: ensure ./data/ subdir also exists

5322d395c6-+-gitblit: ensure /var/lib/gitblit exists

247dd41f88-+-Revert "Allow horizon to query the labs puppetmaster for a list of classes"

340ad672d4-+-Reuse update-initramfs in lvs::balancer and interface::rps

3cffbde3df-+-Allow horizon to query the labs puppetmaster for a list of classes

53cea609e0-+-tools: Install toollabs-webservice on services hosts

040cecccb9-+-tools: Ensure the latest version of the webservice package

d2ecc5e692-+-OCSP Stapling: make icinga alerts more aggressive

0e91313858-+-Followup fix for require_package fix for archiva

958796cdbb-+-Use require_package in archiva role

4e95e12641-+-elasticsearch: enable ganglia in codfw

47d208a0b6-+-Enable base::firewall for rhenium

d38bab8bc6-+-ores: Add support for running precached as a systemd unit

d85bb0f717-+-Set db2018 binlog_format to MIXED; testing it as the reason for lag

9a83bbfa62-+-Revert "Revert "Cut off lead replication for a bit. SSH is busted""

d0e9dd6e72-+-Revert "Cut off lead replication for a bit. SSH is busted"

8b72bb4a35-+-Removed the unused is_puppet_master var

429dbd8aac-+-Eliminate the old, unlintable us_labs_puppet_master global

8a27caaefd-+-Change stats user git email address

a7d23c89c4-+-Adjust eventlogging icinga alert thresholds

ebe965885e-+-Workaround for mdadm boot-time race condition

df2027703e-+-Add Yubico AEADs to backup

adfa46ddf1-+-Bump Cassandra SSTables per-read alert thresholds

0ae0b1d60c-+-zotero: change the path of the zotero defaults.js config

a7f2b447ec-+-Kill eventlogging_NavigationTiming_throughput alert

c484a6818a-+-add dhparam to install web_server

3e8010c01a-+-MariaDB: use Puppet cert for s3 cross-dc replica

333ffaa431-+-add https to ferm rules on installserver

aeabb5385f-+-Zotero: Use Scap3 for deployment

20c0a0c37f-+-mirrors::serve: split mirrors/ubuntu site configs

73f57729c9-+-refactor install_server web stuff towards SSL config

d1eac909e9-+-Also enable base::firewall on rcs1001

d873a09cbc-+-Mathoid: Use Scap3 as the deployment method

56ebb54d15-+-Revert "remove wdqs1002 from varnish during reinstall / fix"

e9ef36b11b-+-Add gnome-pkg-tools to package_builder base file list

dd25b4abbb-+-MariaDB: use Puppet cert for s4 cross-dc replica

176eca7871-+-role::jobqueue_redis: add monitoring of the redis instances

be69b63e80-+-Enable base::firewall on tungsten

b1f4d7e95e-+-Cut off lead replication for a bit. SSH is busted

ee29b883d9-+-etherpad: fix path to moved file

852ddc6e6e-+-Move etherpad diamond collector script to module

7c87a1ada2-+-add base::firewall to lead

a945e8c0de-+-Gerrit: replicate git repositories to new home

0ad0dba751-+-graphite: space-out the graphite-index generation

b6c56b11c9-+-Set $kafka_brokers in role::cache::kafka, analytics == eqiad in all sites

6f84626a22-+-Kafka config: Add config functions

d5419315d0-+-ganeti: bump check_procs for noded to 1:2

914e0e1263-+-logstash: transform nulls as zero for graphite alert

5190bb8e5e-+-Include php5-readline package on deployment servers.

af7a4d7bfb-+-Remove decommed esams caches from disk list

8a10d92af5-+-Enable base::firewall on remaining rdb1* systems

b8452470ab-+-Enable base::firewall on remaining rdb1* systems

3c76c701b0-+-Use yubiauth::server role for auth2001

080ae03d94-+-Enable base::firewall on rdb1001

3e91f9ed90-+-Kill 5xx thresh for non-existent cache_parsoid

c766ee2400-+-redis::monitoring::instance: vary description based on instance name

72c18ef770-+-Disable connection tracking for redis/jobqueue

4d2b8115cc-+-Don't use package-> latest for apt-transport-https

7f6daba429-+-ifttt: Pass callable option to uwsgi

54f317c13d-+-ifttt: Set up Wikimedia IFTTT channel service using puppet on labs

854a96998a-+-bast1001: reorder includes, rm ganglia_aggregator

bd04115864-+-network: remove bast1001 SLAAC addresses

f6018f3167-+-Revert "Revert "bast1001: remove temp rsync for migration""

942b409435-+-analytics_cluster: Add wrapper script for beeline

dc42f2963c-+-Revert "bast1001: remove temp rsync for migration"

a5e6cded0d-+-Revert "Revert "bast1001: rsync home dirs back from tungsten""

e02dea6dad-+-Revert "bast1001: rsync home dirs back from tungsten"

9d9297c93f-+-Give librenms access to members of ldap group librenms-readers

c34a86daad-+-HTTPS redirect for all: 2/3 remove vcl_config settings

0f9c197bf6-+-bast1001: remove temp rsync for migration

b89ee9f6c5-+-bast1001: rsync home dirs back from tungsten

646adf13b5-+-App servers: make Server response header equal to fqdn

5a0c525dc5-+-App servers: make Server response header equal to fqdn (mw1017 only)

5b8e1f6488-+-Add apache::mod::security

a9211a5c40-+-HTTPS for graphite monitor URLs T132461

ed4778d30c-+-MariaDB: use Puppet cert for s1 cross-dc replica

16493970c9-+-Use ldap auth for librenms

51263781df-+-Install test version of ${vcl}.inc.vcl.erb

3e88b9718d-+-Add stat1004 configuration to site.pp

061cb6c8ad-+-MariaDB: Use Puppet certs for s2

6e0c87f597-+-Disable base::firewall on rdb1* again, needs more tweaks

9c00e0a7c8-+-Enable base::firewall for rdb* servers in eqiad

c977c66955-+-Enable base::firewall for all rdb* servers in codfw

ed99f4123e-+-cassandra: create /etc/cassandra-instances.d

fe4674ca33-+-MariaDB: use Puppet certs for TLS

6fcf38b965-+-cassandra: don't require cassandra Package for cassandra-instances.d

d55bf8a32e-+-Add nfconntrack and TCP States diamond collectors to Jobrunners.

a78a752aa7-+-write cassandra instance yaml descriptors

81c3c7dbeb-+-tools: Remove non-precise fonts from precise hosts

fc968abc2b-+-tools: Don't track mediawiki's font list for precise

f6a7147f25-+-use tungsten, not osmium to copy bast home dirs

4b8c65724f-+-rsync bast1001 home dirs to osmium, temp for upgrade

404893dd53-+-site/install_server: add kraz.codfw.wmnet

03b899a6d7-+-stat1001: setup to rsync /srv/ and /var/www

ad9534270c-+-Port varnishxcps to new VSL API

e72931012f-+-don't use fluorine for rsyncd, conflicts

ecc7405201-+-rsync home directories for stat1001 upgrade

24646f052c-+-remove wdqs1002 from varnish during reinstall / fix

a6025a4187-+-cache_misc: remove gerrit.wm.o (not misc in DNS)

bf659bea53-+-cache_misc: remove rt.wm.o (not misc in DNS)

e1089ce7b2-+-cache_misc: remove download.wm.o (not misc in DNS)

df696479d8-+-Enable base::firewall on rdb2001

8eacaab54d-+-role::memcached: fix reference to replication

a29a1b2302-+-role::jobqueue_redis: fix ferm rules

c69745902f-+-Enable base::firewall

09628fe4af-+-Add icinga monitoring for varnish statistics daemons

e476bfdfb8-+-Manage /etc/pam.d/sshd in role::bastionhost::2fa via puppet

faba7dde83-+-site/install/dhcp: add furud.codfw.wmnet

e1de5f3ec4-+-gitblit/icinga: move git.wm.org monitoring to virtual host

0b92c83756-+-pam_limits tools bastion parameters

8b1848fc41-+-gitblit: don't monitor if apache is running anymore

09d993c273-+-MariaDB: use Puppet certs for s5 cross-dc replica

09d8a1892b-+-Gitblit: remove apache crud

ebf4b60ee3-+-Remove special case handling for labs realm

e2b0695e04-+-toollabs: install goaccess on webproxy hosts

bb17167a5c-+-Adds russian myspell package to ores base.

68632a56b5-+-contint: set pbuilder basepath to actual directory

dc5dff4f7e-+-Introduce meitnerium.wikimedia.org

0ebe702126-+-graphite: permit line protocol traffic from ALL_NETWORKS

a60e1593c2-+-redis::monitoring::instance: s/instance_name/port/

6a858c751e-+-nagios_common::check::redis: create file, not a directory

accf22de5c-+-redis::monitoring: removed double declaration of $port

6ff4255f92-+-redis::monitoring: fixup and some more parameter checks

52e8a1fd7e-+-redis::monitoring::instance: fix inclusion of class

308f638c5c-+-redis: add monitoring define

a6c57cc19b-+-Enable base::firewall on labmon1001

0cf06b50c4-+-Add ferm rules for statsite

dd3bb7b92a-+-diamond: send production traffic via graphite line protocol

b1922aa171-+-Enable base::firewall on terbium

9d9ce71a39-+-tools: s/tools-checker.wmflabs.org/checker.tools.wmflabs.org/

cba82b6edf-+-ganeti: add a system::role

cf092d388b-+-Rename "statsdlb" role to "statsd"

861336b02f-+-apt: ignore errors updating apt-show-versions package cache

a1158fdcc4-+-hhvm: make the perf maps cron work under systemd

946f196c9a-+-contint::packages::labs: typo fix

fd359168bb-+-mw::packages::legacy: php-apc, not php5-apc

1e2c480c37-+-mediawiki::packages: don't break precise CI installs

74ef805cfb-+-mediawiki::jobrunner: drop precise compatibility

8b9a28395f-+-mediawiki::web: drop compatibility with precise, mod_php

4c3c091f38-+-mediawiki::web: drop precise support

90e56fa1ad-+-mediawiki::packages: drop precise compatibility

af88891882-+-mediawiki::php: drop precise compatibility

d9c77520fe-+-Enable base::firewall on netmon1001

c9106cb80e-+-mediawiki: do remove the php grain

2acc15930a-+-mediawiki: salt::grain needs a value even when absented

43bce3dbf0-+-mediawiki: make base class trusty and forward only

a0ae520d90-+-Moves wikilabels wsgi to labels_web.py

87aa11532b-+-misc: Use random backend director for logstash

c81c337fd7-+-Run eventlogging analytics daemons out of the scap deployment

ae93d85cf0-+-varnish+statsd: refactor classes, move rls to text-only

6a927074f7-+-Remove notify from eventlogging::service:* classes to eventlogging/init Service.

966ccb318c-+-eventlogging::service::* classes now depend but don't include eventlogging::server

5a526bcf2d-+-Fix cut/paste, didn't mean to remove standard and firewall

b14b64f400-+-Unpuppetize eventlogging on eventlog2001

007045c4dd-+-On second thought, remove new eventlogging::analytics role

37e3a20b8d-+-Emit resource_change events from RESTBase.

275552c938-+-ores: do git clone in staging

f113047377-+-Use die-on-term on ores uwsgi

b10ced9695-+-remove query parms from urls

647b60044d-+-Scap3: chown the target root dir if owned by root

3335099a21-+-cache_misc: declarative req.http.host=>backend map

2d1ca135aa-+-Create new eventlogging::analytics role in modules/role, use scap for deployment

e1dd8ecaed-+-toollabs bastions install cgroup-bin

45b0f85326-+-nscld changes need to restart nscd as well

284fd82364-+-Fix ownership of VTC tests directory

b434df1ba3-+-nslcd specifying shell override

c622c2fae7-+-cache_misc: whitespace/comment/format cleanup

50862b1e73-+-cache_misc: removed unused backends

f370ea0284-+-misc VCL: disable yarn.wm.o more-completely

03892b1108-+-remove now outdated scap dir setup and keyholder from snapshot manifests

d6fd5eae8c-+-Use bastionhost::2fa role on iron

59b727f5da-+-Activate SSL + connection pooling for CirrusSearch on PROD

6a5a62a771-+-Add a comment about the lvs_grain's information purposes

28baf2e8ef-+-docker: Add nginx frontend for registry

556c0bfc50-+-dumps: fix up all references to directory with config files

0c2c691441-+-docker: Don't setup credentials on all hosts

a07b0d512c-+-Add new scap::source define to ease bootstrapping of repositories on deploy servers

b2c4a4fbe6-+-Hieraize keyholder::agent configuration

e14bfc8b2f-+-wikilabels: healthier uwsgi

658af889a6-+-LVS: add salt grain for lvs:(primary|secondary)

5e2bfd799a-+-Misc cluster VCL: avoid name conflict between directors and probes

b6c9bb10dc-+-set dump cron job date range back to normal, adjust start times

ca7234b01b-+-hhvm: add systemd/jessie support

b0201ec393-+-puppet-lint runs through now, changed scope of variable from $hostname to $::hostname

713518f9b6-+-installserver: port squid3 changes for trusty/jessie

11b8813670-+-otrs: Remove HTTPS ferm rule

16fa926a7e-+-hhvm: s/fcgi.ini/server.ini/

6d36c5e01d-+-hhvm: fixup for I5e9403c2

22186f98fb-+-hhvm: parametrize directories

afdc32f1d6-+-Moving elasticsearch::https instatiation to elasticsearch role

95b23d5c2c-+-hhvm: watch extension packages from the service

164caa8644-+-ci: Add gerrit as a known host for Jenkins slaves

529a532954-+-k8s: Bump tag again

ceea31916e-+-k8s: Stop using packages for k8s workers

61ca8fd445-+-add back nutcracker to the dump setup for new snapshots

41114e5202-+-k8s: Update tag

e36036f113-+-add dir for test files to be served from datasets host

f44670e168-+-k8s: Stop using packages for master components

89d8f5e96a-+-k8s: s/file/puppet/ again

6f42e89752-+-k8s: s/file/puppet/

e53add2df4-+-k8s: Simple script to deploy worker & proxy

74b3b6f218-+-k8s: Add simple script for deploying master

f8d7257963-+-fix repodir reference for monitor script for dumps

837213d52e-+-VCL: remove all non-default between_bytes_timeout

dfa2e55ba4-+-fix wrong owner for cron dumps script, should be root

7324455455-+-use new cron job class for dumps on snapshot 1001 and 1004 also

d2e12dcedf-+-swap classes on snapshot1002 for cron dump run job

542b17e030-+-toollabs: install virtualenvwrapper

39e2d79806-+-Clarify role description

8dc30639a9-+-Revert "add hhvm include to snapshots experimentally on jessie"

b9c88c73c0-+-add hhvm include to snapshots experimentally on jessie

d85206ec8e-+-delay the monthly dump cron run one more lousy day

382374e3a4-+-remove nutcracker for now, broken manifest on jessie

86a0b84519-+-otrs: remove monitoring::service['https']

1f4b5d8615-+-add mediawiki packages and other dependencies for snapshots

0c8461faaf-+-explicitly define repodir on snpashots for cron run

a0cb067568-+-dumps: include the decl of repodir in the class using it

522a552018-+-basic snapshot role for dumps

d89031f019-+-netops: monitor all asw/msw/psw as well

8c13057363-+-set up scap3 deploy for snapshot1006 snapshot1007

a0ec1762aa-+-add rest of new snapshots to scap3 target list

d66794ef0c-+-Add check_jnx_alarms to check Juniper chassis alarms

a98486ce23-+-netops: disable SNMP checks for OOB interfaces

8169a4f849-+-Revert "toollabs elastic don't use nginx light"

26b592e7c9-+-netops::check: make IPv4 mandatory again

c3899fd896-+-netops: also monitor pfw-eqiad/pfw-codfw

ee81e1ce11-+-netops: add IPv6 host checks

fbf5ee625c-+-netops: abstract monitoring checks into a define

c557516eb1-+-Move network::checks to netops::monitoring

f92d674be8-+-toollabs elastic don't use nginx light

215d78742d-+-add dumps deployment key

05b4657105-+-Tools: Add mytop

df24555f3c-+-Tools: Add dev packages needed to compile python-ldap

fd126f09eb-+-scap3 for dumps needs the scap dir group writeable by wikidev it seems

9b1d26bdb6-+-enable new snapshot role on snapshot1005

1b5597905c-+-start new snapshot role with the basics at first: scap3 deployment

105eaf4ca8-+-fix typo in name of private key file for dumps dpeloyment

8b0703b11e-+-enable keyholder and scap cfg setup on deployment servers for dumps

e34c1a1080-+-tlsproxy: add parent directory for sysd unit frags

84ec93d387-+-setup for dumps deployment public key on snapshot hosts for scap3

d0045c4dbd-+-set up for keyholder for dumps deployment from deployment servers

e171182e53-+-tlsproxy: nginx security restrictions via systemd unit frag

73acd3221c-+-set up for addition of scap config file on deployment servers for dumps

e6ef857b34-+-DB: Expose Puppet SSL certs and generate CA cert

52102ff881-+-delay dumps full run start by one more day this month

09d7409cec-+-Install python-numpy and python-pandas

2ec43ca30b-+-mattermost: Kill it!

306d55a9b7-+-base: add script to generate fingerprints

37ef80eb93-+-ganglia: switch esams aggregator to bast3001

830cad13ab-+-site.pp: remove hooft from puppet

865231bd09-+-contint: stop installing grunt-cli

6cfb636720-+-contint: Upgrade npm to v2.15.2

98ccca7f73-+-network.pp: new IP bast3001 & drop former hooft SLAAC addr

bd183fe467-+-dumps: move dump-related templates to templates/dumps

9d670c6f56-+-Add ferm rules for torrus

84a52c9be8-+-Add ferm rules for ganglia::deprecated::collector

30076437e1-+-dumsp: move cron related templates into templates/cron subdir

81d7ad9ea7-+-Add ferm service for rsyslog instance on netmon1001

f9c32015d7-+-dumps: move cron related files to files/cron

81909c0f43-+-dumps: move cron jobs out of dumps dir into cron dir

dd67c22f48-+-dumps: fix up a couple of requires for new location of cron manifests

9202ca57f2-+-dumps: move (most) cron job manifests into cron directory

62237dad08-+-dumps: clean up some dir refs in templates to be more readable

68557b5f25-+-Install libpam-yubico

907eeef9f2-+-dumps: make dir var references easier on the eyes in the manifests

93a52b3efd-+-Allow access to yubikey validation server from bastion hosts

e74202a578-+-scap::target: Allow scap's user to restart all services on a node

afd8cce75a-+-Update the varnishkafka module with latest changes.

8d4bd549c8-+-Enable base::firewall on wasat

f4420ead5e-+-ganglia: leave aggregator on hooft until bast3001 works

31060f7f7a-+-site.pp: temp add hooft back as install-server

d6c6470408-+-contint:firewall: let phabricator talk to gearman

59175c41b8-+-snapshots: fix up all variable refs to dump dirs in templates

c1aad6b869-+-labs: Do Public DNS translation for telnet project too

268044d1b1-+-hold off full dumps cron starting til the 4th of this month

dd20752d0c-+-snapshots: update location of dumps cron script in jobs calling it

8c8b6b27eb-+-snapshots: move dumps cron job script to same location as the rest

177dfef428-+-snapshots: restructure directory handling a bit

a5ab75015f-+-Run eventlogging services out of deployed eventlogging source path

eda83af7d1-+-ores: Remove use of git clone

060a783a72-+-Revert "Enable base::firewall on rcs1002"

01c92f9b67-+-Enable base::firewall on rcs1002

bd3a79572e-+-Beta: Add mira to deployment_hosts

1dc40afa93-+-Move dynamicproxy ferm rules into role::labs::novaproxy and role::labs::tools::proxy

c61a7003d0-+-No-op refactor of eventlogging module

cc56499b73-+-Hostgroups: add missing DBs into the mysql cluster

38f7a25845-+-Also enable base::firewall on sarin

0347257113-+-Add systemd unit for logstash

566286a7e1-+-Add correct varnishkafka configuration files for Varnish 4 servers.

9a68c2966a-+-Restore nf_conntrack_max setting for the analytics kafka brokers.

a51e0de2e6-+-Fix ferm rules for salt master

4fa5a84285-+-Enable base::firewall on neodymium

12fc29d303-+-tools: Add class that helps build kubernetes

b9c9bc429b-+-irc.wikimedia.org - remove Apache

504a37aedb-+-site.pp/hiera: rename hooft to bast3001

80f2d8160e-+-Remove non existent dependency in eventbus.pp

4ec444425d-+-Use eventbus topic config from mediawiki/event-schemas repo

21146fd34a-+-Replace horizon dns and proxy guis.

3581788408-+-hooft->bast3001 in smokeping,dhcp/network comments

2b46ecbcca-+-docker: Fix format of auth config file

9e01b73723-+-Scap: Bump version to 3.1.0-1

eacc55ae47-+-maps: osm-replicate memorylimit stability fix

58f49cdd42-+-maps: ship postgres tuning file into role module

0d5993e5da-+-Fix ferm rules for postgres and redis access on maps master

8a26644a6c-+-maps: Fix mess introduced in I2a44ee9

1772c431a5-+-Move master ferm services into server.pp

30cfa40d23-+-Reenable base::firewall on maps2001

15aba98a9a-+-Add netfliter nf_conntrack diamond collector to kafka brokers.

48c61a3458-+-Disable ferm on maps master, needs an additional rule first

b371061667-+-Enable base::firewall on maps master

21d044da2e-+-create-dbusers notify service on script change

fdeda2fb6c-+-Reclaiming cp1056/57 and cp1069/70 -Removed site.pp standard entry and removed from dhcpd file.

102bc60c6d-+-move scripts for generating upload dir lists from dumps repo into puppet

98047fa082-+-Add TcpConnStates diamond collector to the kafka broker role.

2b0a394ad3-+-Enable base::firewall on additional maps slaves

fc90259e20-+-Move Varnishkafka APT pinning to role definition

dd2b598f46-+-Varnishkafka: use VSL query on Varnish 4

62490e0fb2-+-Add ferm rules for saltmaster

16a0e6e8eb-+-nagios: rewrite check_bgp from scratch

772fe7e94d-+-Install VMODs on Varnish 4 instances

81a32bb9dc-+-tlsproxy: use do_spdy to control http2-vs-spdy

02d96a53c0-+-mediawiki: make mw2090 normal appserver again

a952d9d38e-+-mw:maintenance: also move mariadb maintenance class

8f0681dd9b-+-remove mw-maintenance, LDAP client from mw2090

0eb144f018-+-mw:maintenance: add role to wasat

a73012e0ff-+-Prefix eventbus Kafka topics with datacenter name

458a74ac30-+-docker: Install debootstrap in base image builder

7027c9f86f-+-authdns+ferm: ipv6 rules for authdns-update too

1f1af48a97-+-authdns: allow authdns-update through ferm

fe18a3730c-+-mediawiki: remove python-mysqldb from maintenance servers

eade0920ea-+-Temporarily remove horizon GUI for proxies and DNS

8a7092b98b-+-docker: Ensure that apt repository is present before installing

120b1140ca-+-network: enable check_bgp for cr1-esams/cr2-knams

c12d094028-+-shinken: Only regenerate configuration when there are changes

631726daed-+-ores: fix puppet breakage in staging

3fa270068b-+-authdns: page on global alerts

529aa2a7ff-+-Increase log verbosity on reportupdater cron jobs

249754cda2-+-ores: Move redisproxy into the labs role module

65545e084b-+-Bump nf_conntrack_max temporarily to allow proper investigation.

eef14ae500-+-ores: Use str2bool the check presence of cache

addf4f0ae3-+-ores: Move the lb functionality into the role

a93d750f4f-+-ores::base: Remove handling of /srv

6589d07553-+-contint: increase tmpfs size to 384M (+128M)

3dccf69b53-+-openstack: Add proxy panel files

cd37450e9e-+-mediawiki: maintenance servers should all have home backup

8e8ddddd56-+-varnish: Fix puppet in deployment-prep

b600d9db29-+-mw:maintenance: move eventlogging from node to role

c27e772124-+-mw:maintenance: move python-mysqldb from nodes to role

6f95a0d900-+-scap::target: Add the $deploy_user group ID

4cd3e2c7c5-+-site.pp - introduce wasat, backup home dirs

8e01c2cf19-+-service::node: Let Scap3 manage the user by default

5ec906f0fb-+-ores::base: Remove data_path

10b42f23ea-+-Add base::firewall to role::authdns

eec83fe0d5-+-Add ferm rules for DNS auth servers

e43d830e42-+-Varnish 4 APT pinning: include varnish-doc

4d658e1952-+-Assign changeprop service to scb cluster

9746166e41-+-Introducing changeprop role and puppet module

4bac655370-+-otrs: Pass the proxy parameter to spamassassin

f4436fb16b-+-spamassassin: Honor proxy for sa-update

8b91c7b074-+-Enable base::firewall on maps-test2002

928e651b0b-+-Tools: Remove obsolete classes

41c5b6eebe-+-Tools: Remove obsolete comment

29a2892357-+-Tools: Fix puppet-lint warnings

320007de10-+-Tools: Fix Puppet error

7c384c493e-+-docker: Fully qualify path to setcap in exec

e8235a128c-+-k8s: Allow docker registry to bind to lower ports

0aacec1cb4-+-docker: Add a class that facilitates building base images

4c5005dd3d-+-cache_misc: raise fe cache to half of memory

fad0e4b676-+-apt_preferences for v3/v4 varnish packages

de91dd328b-+-fix commentary on eqiad to-be-decommed caches

003054493e-+-Update mediawiki camus Avro import job to use new schema for ApiAction

4f20e8e57a-+-Add alerts and ferm rule for hadoop-hdfs-zkfc process

8b8a59adfa-+-esams re-arrangement steps 4-6

6131d4fc02-+-diamond: Remove unnecessary/incorrect include of stdlib

6d3a0bc96c-+-require_package('hive-hcatalog') on hadoop workers instead of fully configuring hive client

2642a7f076-+-gridengine: Fix puppet-lint warning

8b67ea3333-+-logstash: Remove obsolete role::logstash::stashbot class

c685ab9af3-+-Also keep /srv/patches in sync between masters

91f63a5dfd-+-cp3019-22: decom from cache_misc

5e7f001f99-+-cp3007-10 esams text->misc re-role

87a3e31859-+-Maps VCL forward-port to Varnish 4

182e18fee5-+-Corrected port number to check for SSL cert on elasticsearch

00a47ea86d-+-elasticsarch: add Icinga check for SSL certificate

cfd481fcdb-+-diamond: Fix comments

cef273534e-+-cp30[34][23] - esams upload->text re-role

fa9882c176-+-add FIXME's/ignores for all variable scope issues

d4cef5bc8a-+-mha: add FIXME/lint-ignore for inherit across namespaces

0069ff1b79-+-Increasing between_bytes_timeout for wikidata query service

b69cc8be25-+-Moving /analytics to /other/analytics

5323111177-+-ores: Firewall off the redis boxes

ffd0af9a2b-+-mysql: make lint ignore classes inhering from params

33414919e0-+-Revert "ores: Hardcode Host in the HTTPS redirect"

a55cc03333-+-Apply the role::ores::redis class to oresdb100{1,2}

6e681cd8a2-+-Add the role::ores::redis class

cb887be30f-+-Fix mistake in dumps reorg

20bf8c3680-+-ores: Hardcode Host in the HTTPS redirect

22a097c98a-+-Re-organize analytics dumps to their own page

8c4c221b98-+-Adds https only redirect to ores-web

ec045264b3-+-ores: Collapse the redis configs into one stanza

8d73231c8f-+-Clone mediawiki/event-schemas in refinery role

15aefbde46-+-Do not use dynamic directors in test VCL code

64a98dd3e2-+-Add ferm rules for postgres/maps

aedb153ab5-+-Fix puppetlint warning

697779f002-+-Revert temporary bump of connection table, underlying bug has been fixed

e65394a5a5-+-Add ferm rules for carbon-c-relay for labs graphite

3321bda2e5-+-jobqueue_redis: set up encryption and cross-dc replication

595836c4df-+-docker: Start the docker service by default

611178cf4e-+-docker: Restart docker service, rather than service_unit

1c9cfc418c-+-maps: Add cassandra helper classes

f9bad26294-+-tools: Add a docker builder role

1d131dbba0-+-Add wmflabsdotorg credentials to horizon config

ffe0b4fb98-+-k8s: Extract basic docker engine setup

95b4d72eb6-+-Add a deployment source & target class for phabricator

fe667af6ec-+-Revert "labs: Add support for custom cnames in labs recursor"

ca04fe0f2b-+-Use non bash specifc output redirect, and redirect full flock command output in mylvmbackup job

eedfc4fdde-+-Port varnishreqstats and varnishstatsd to new VSL API

97495c610b-+-Add ferm rules for redis access on maps cluster

eec9a04848-+-docker: Have registry listen on 443 port

91062fba44-+-Redirect both stderr and stdout to mylvmbackup logfile

7cee2c45dc-+-Notify Jobchron when jobrunner.conf changes.

21583d88da-+-labs: Add support for custom cnames in labs recursor

29630664aa-+-Create eventschemas module, use this in eventbus role

4026fbfd8a-+-Filter StatusLogger messages from UDP appender

1283bcff4a-+-Adds compute node role to ores

29c7d189e3-+-diamond: send labs instance metrics via graphite/carbon

29bd3aba12-+-Adding metric collection to nginx in the context of elasticsearch

547bce71dc-+-Citoid: Switch to the Scap3 deployment method

811b26ce42-+-Adds arabic and polish languages files to ores role.

b50d218583-+-mha: let lint ignore nested classes/defines

6b49d55e9d-+-mediawiki/updatequerypages: move defines out of class

93a5cab7e8-+-mediawiki/refreshlinks: move cronjob define out of class

1f20e575e2-+-add dataset nfs clients to hiera, make nfs service subscribe to exports

a24749b53a-+-Enable opcache for Piwik

6f47045e1c-+-ganglia: fix "defined type defined inside a class"

1beb7501a4-+-Enable reuse of sockets in TIME_WAIT state on all app servers

01955b5df3-+-Adjust port range of ferm rule for redis on app servers

7823e409c4-+-Create a portal-master dir in beta to serve master branch of portals

8739c767d1-+-base/syslogs: fix "defined typed defined inside a class"

4b7ea88334-+-gerrit: move role classes to module, split in 2 files

0281d1ad4a-+-gerrit: avoid defining class inside class

5c33e9269b-+-python-etcd no longer needed for eventlogging

6453cd37a5-+-Fix misleading/not supported variable references

439be49f3e-+-eventlogging: Remove server-side udp to kafka forwarder

760008c2eb-+-Bump connection tracking table size on job runners

7e5c0bc0b4-+-Pass deploy user from service::node

f9df4b2d9f-+-Configure labsdb1008 for the first time

3218df65dc-+-Configure for the first time db1074-db1078

437c0fe814-+-ores: Move role classes to module role

5c6a5698bb-+-puppet-lint: last 3 files with alignment issue, globally

589e061aa6-+-puppet-lint: fix or disable remaining alignment warns

0a82117546-+-releases/upload: fix typo in class name

696e8c6a71-+-releases: fix role name for upload from deploy servers

458d692a18-+-move microsite roles into a common place

a1e1b50e59-+-Add makedomain tool, for creation of domains in designate.

78f2ea1e7d-+-puppet-lint: fix some more indentation warnings

a6ff6f6d95-+-Update mariadb submodule with formatting change, set password to false

f7acd0cd56-+-Update mariadb module with .my.cnf root password change, set analytics-meta instance root password to undef

345db875e8-+-Set PATH in flock mylvmbackup subshell

9d54dfff7a-+-Build cirrus completion indices daily

26d280f905-+-Add $socket parameter to mylvmbackup

cf9a0a799a-+-Correct destination dir in browser reports rsync

8c4d9f4592-+-Define curl connection pools in hhvm for cirrus

6a56e16e87-+-Use flock to make sure this only ever runs one mylvmbackup at a time

546382f462-+-mylvmbackup prebackup hook needs to be executable

39854dc2e4-+-Use direct hiera lookup instead of parameter in role::analytics_cluster::database::meta::backup

ccf0c0ebab-+-Add ferm rule for rsync daemon on analytics1002 in role::analytics_cluster::database::meta::backup_dest

b284adfa9f-+-Include rsync::server in role::analytics_cluster::database::meta::backup_dest

7ced71e1e4-+-Add mysql_wmf::mylvmbackup define, use this for backups of analytics-meta mysql instance

b7c4bc4356-+-Rsync browser reports to datasets.wikimedia.org

2ab2a3713a-+-DB: Add db2008 to the x1 shard group

52155e4aff-+-ganglia: remove aggregator from alsafi

0326387da2-+-role::apertium: check the local url, not the eqiad one

f1456a74df-+-parsoid::testing: use master_dc variables

fa9d7b82ec-+-iegreview: use $::parsoid_site

3369821d38-+-mobileapps: point to $rb_route, not to the local restbase cluster

9f0cfd36d0-+-add labstore200[3-4] to site.pp, like existing [1-2]

e51f5ee01f-+-Revert "phab: add sender domains for maint-announce tickets"

8525d34502-+-lvs: SC[AB] services lvs configuration

a7d8f35587-+-ganglia: fix up for aggregator service on systemd

f4ea877b8c-+-Add apertium LVS IP on LVS servers

eb604e6a78-+-Mathoid: enable PNG generation

0376a7603b-+-Port varnishlog to new VSL API

b7804ecde2-+-Gerrit: Make git directory location configurable so we can move it

a70abe16d9-+-restbase: make restbase configuration use application routes

9b051537cc-+-cxserver: use dc-aware urls

08456ecac9-+-realm: add $::app_routes hash

f7b6327db0-+-Varnish support for shutting users out of a DC/cluster

fa33400f3b-+-Fixes issues with nginx package on logstash.

d49df48f67-+-ganglia: do not start meta-service on jessie/systemd

781ea4b0a0-+-ganglia: no dependency for old upstart service on systemd

2d519f68ab-+-ganglia: don't install old init scripts if systemd is used

3e68509e0f-+-ganglia: fix systemd instance service name

a12aab0bbd-+-ganglia: on jessie, spawn aggregators with systemd

a146d5b8f9-+-Puppet SSL dir is not the same on Production or Labs

d56e5f71d7-+-Expose elasticsearch through HTTP

f26723a85f-+-Use proper novaconfig[] settings in environment scripts.

ac14ba72d6-+-Add wmflabsorg-domainadminenv.sh script and refactor novaenv.sh classes

2dc8230795-+-mediawiki::maintenance: add codfw host, multidc support

b8a9f55439-+-limit find to type file for stats log cleanup

32ed45c1f0-+-jobrunner: monitor the HHVM server health

893d8e4293-+-title list dump cleanup: find doesn't like maxdepth after type

f37be1c339-+-fix up arg for find command for cleaning up old title list dumps

640ae587b8-+-dumps: clean up old page and media title dumps

142e8cb820-+-k8s: Mount separate LVM volume for /var/lib/docker

2b969b243f-+-phab: add sender domains for maint-announce tickets

01c4e9ed04-+-dumps: start moving media title dumps to onallwikis

be17d1d144-+-pagetitles dumps: use the config file with all wikis

8fa1346f45-+-dumps: move pagetitles production from wikiquery script to onallwikis

99a55cdf8f-+-mediawiki: revert adding fonts-gujr-extra

6fe7e4f3da-+-mediawiki: ttf-gujarati-fonts replaced by fonts-gujr-extra

7dd32e750e-+-mediawiki: do not install fonts-gujr-extra on precise

5cf6311386-+-dumps: move all dumps-related dir decls to the dirs class

8a118810ba-+-Add Gujarati fonts to mediawiki::packages::fonts

4a3e8dd7c5-+-Remove ganglia from jmxtrans kafka broker configs

897cc3c038-+-Factorized code exposing Puppet SSL certs

07564a71fd-+-VCL: remove vcl_config.do_gzip conditional

75ec13a2c3-+-Disk space icinga check: pass --exclude-type=tracefs

4632b0f2fd-+-Set rdb200[56] as part of codfw's Job Queues (rdb2005 master, rdb2006 slave).

e7e12d839f-+-remove VMs cygnus and technetium

731602dbc4-+-k8s: Pin a version of docker

b9752d5f06-+-Run reportupdater on stat1002 as the hdfs user

a8ced39470-+-Gerrit manifest cleanup

71105749f0-+-maps: Also move hiera config files to match maps::server

37e19d1b7e-+-statsdlb: set notrack and allow from $ALL_NETWORKS

050620eb15-+-Introduce the SC[AB] clusters in codfw

bd339fbb06-+-Enable base::firewall on graphite1001

9211c388be-+-Fix maps-test200{1,2,3,4} role classes

a1526120fe-+-grafana: import swift

3ef34af604-+-grafana: import varnish-http-errors

630ae3866a-+-Remove cxserver role from SCA

7bcca5b42d-+-Fix copy&paste error in carbon ferm rule

2875f65b64-+-Add ferm rules for local carbon relay

37aabcd57f-+-Enable base::firewall on graphite1002

f4166db0a8-+-filter out summary lines from wget for wikitech dumps copy

ead1339497-+-Enable ferm on graphite2001

b1a68e67c2-+-Revert "cache_app_route(): parser func for cache->app routing"

4239c7a6b5-+-paws: enable http monitoring

a69036828e-+-paws: move monitoring to icinga module

95a4df090a-+-cache_app_route(): parser func for cache->app routing

ddf2e98392-+-Revert "Revert "tools: Add paws as a separate host""

dc2d21c209-+-Add camus job for importing eventbus events

90b96ca6e8-+-Set file.encoding=UTF-8 for all java processes in analytics cluster

c931d33425-+-Remove etcd usage from eventlogging processor

569028eb95-+-Remove clientIp from EventLogging varnishkafka format

aea050cdd4-+-Correct typo in unique_devices rsync cron

d479184017-+-Add rsync job for unique_devices dataset.

9d3ec6f376-+-Use generic job class to rsync cron datasets

16ae23f1c4-+-Also enable ferm on eventlog2001

268dd25594-+-common VCL: fix OPTIONS logic now that upload is fixed

c00c4136f0-+-upload VCL: use allowed_methods instead of local check

37ea012ff1-+-make timeout in rsync header a parameter, increase value for stats rsyncd

156fd36adf-+-Also allow access for eventlogging-zmq-legacy-stream to graphite

f0950a5784-+-Fix protocol for ferm rule

058b431718-+-Remove refinery-hive.jar from auxpath in hive-site

2f968b4909-+-Add basic support for varnishtest

3225817fef-+-Enable base::firewall on eventlog1001

26cccf6f7c-+-xvfb: start service at boot time

ef7025147f-+-Services: introduce service::packages

3992381c33-+-Remove Django from statistic::compute package list

117bf2dbf0-+-Upgrade camus and camus-checker jar versions

7b70430282-+-Fix duplicate declaration of Package[python-designateclient]

600c5cb441-+-Fix role analytics_cluster::client in Hiera

5f2e359d9c-+-Add ferm rules for carbon (python)

9f5a37c8be-+-Add ferm rules for carbon-c-relay

e0d3cfd609-+-Add ferm rules for statsdlb

6cbe61dc60-+-filter out known output for wikitech dumps copy cron job

3822aa0968-+-make wget skip urls with query params when retrieving wikitech dumps

56fb594243-+-Revert "tools: Add paws as a separate host"

617f626de4-+-tools: Add paws as a separate host

f6174ca0b3-+-tools: Add specific paging monitoring for PAWS too

204fe77c95-+-ganglia: add unit file template for systemd

4b4ea79b99-+-Include python-designateclient in the normal list of openstack client packages.

52b10cd155-+-eventlogging: Change client side processor format string to ignore ClientIP

aa4a8e3fb5-+-fix scap/init.pp source -> content

6f192652b9-+-Parameterize the git_server variable in global scap.cfg

783fcd8297-+-Horizon:  the package is python-designateclient, not python-designate-client

9471765c54-+-Install designate-dashboard, attach and configure panels.

3a6b5a1552-+-Revoke iron access; add salt-masters access for mysql management

ce463a5067-+-Gerrit: install standard base on new server lead

9caf500471-+-Install php5-readline on mediawiki maintenance hosts

7e0883f7ec-+-lvs: bind parsoid.svc to lvs2003/2006

6e3e816a78-+-Define the horizon and wikitech hostnames in hiera.

6953e9a794-+-Include a designate policy file for Horizon.

78bba0a797-+-uwsgi: Don't attempt to stop service on non-jessie systems

1ffb09f663-+-debug_proxy: add mw[12]099 to backend_regexp

f428efaefb-+-debug_proxy: add resolver param and set it to $::nameservers

999ea2bc55-+-Add debug_proxy module, for X-Wikimedia-Debug request routing

d0d2c92abf-+-Introduce hassaleh, hassium

9fb8d3cbae-+-cache_upload: separate applayer backend for thumbs

957cf324b6-+-uwsgi: Stop the distro provided service properly

3e1ee4870f-+-varnishes: control applayer DC routing from hieradata

8d9a4ebd63-+-r::c::config: move to hieradata

dd8557e804-+-r::c::config: add restbase @ codfw

23edf222d0-+-r::c::config: remove parsoid (unused)

e13866f2a6-+-r::c::config: remove lvs::configuration include

67dfdf411e-+-r::c::config: remove has_ganglia

85396bc8cf-+-varnish: get rid of backend_options

84dd8881dc-+-caches: remove backend_scaled_weights

83f37d67ad-+-Add ferm rules for kartotherian, tilerator and tileratorui

e408e15726-+-mediawiki: convert mw2153-62 to be jobrunners

0f414eec55-+-graphite: switch carbon-c-relay to carbon_ch hash

d531fc0478-+-appservers: decommission permanently mw1026-69

b059eeabf9-+-Monkeypatch Horizon to simplify the instance-creation panel.

3eabb8c171-+-datasets: make wget quieter in cron job, clean up old wikitech dumps

2cebbc2960-+-datasets: toss index.html files copied from wikitech anywhere in tree

37b313295e-+-ganglia: don't try to use upstart on jessie

d68b3bbd45-+-ganglia: temp. put aggregator on alsafi

b6b8540d4a-+-Git: create the log file for T128895

f6c222149d-+-Hard-code the dynamic extension path for HHVM

7cbd37ea17-+-Add logrotate for reportupdater jobs

ef7a5aa43b-+-puppetize the install_console script

88971f6a38-+-pull down wikitech dumps and serve them in 'other' datasets

108f5e2696-+-Revert "Move phabricator/extensions to libext fixes T128797"

88dd3ff98e-+-Move phabricator/extensions to libext fixes T128797

8128405247-+-User proper user and require repo before cron in reportupdater::job

bf5fd0a1fd-+-Replace limn::data::generate by reportupdater

5ae4a4a1f3-+-Revert "turn off dumps cron job in prep for second try dataset1001 upgrade"

6ab8d8d590-+-re-arrange cache ipsec for codfw as a backend

d0ccaa342d-+-remove cache ipsec-specific nodelists

acb9a5c884-+-remove $site_tier, no longer used

f065b57ce4-+-Add ferm rules for maps/cassandra

d882abf827-+-send web server logs from dataset hosts to stat1002

6cb7c9ce9b-+-RT: do not load shredder plugin

0b4a6e0ec3-+-RT: add role to krypton

b53c4a4768-+-turn off dumps cron job in prep for second try dataset1001 upgrade

140a6d1a9b-+-vagrant_lxc: Move role class to module role

39bfe49e26-+-Add public-wiki-rewrites to wikitech

29cac7ed5d-+-Merge labtestwikitech apache config with wikitech apache config

8547ed30db-+-Revert "phabricator: Send weekly mail every week instead of on certain monthdays"

b8b71abe5b-+-phabricator: Send weekly mail every week instead of on certain monthdays

3e81eb6811-+-Initial role for 2fa bastion host

c3ec50ace7-+-role::cache::instances: move cache route table to hiera

8e7b9046c1-+-VCL: cache_route_table replaces site_tier

5e00b5f963-+-r::c::instances - hack around cache_maps eqiad-only

57e7e36ceb-+-Enable the new pt-heartbeat on core production hosts

0eb081a4a7-+-v::c::directors: fix select compat for ruby 1.8 here as well...

6087cdecd8-+-turn on checkpointing for eswiki, itwiki, ruwiki, wikidatawiki

f25b6546eb-+-role::cache::instances: all backends get all backends

aa670e4c5a-+-v::c::directors: filter keyspaces on dynamic==yes

2615b06c8e-+-Revert "redis::multidc::instances: disable replication"

35b87d40ea-+-cache_maps: remove probe

68d165990a-+-ferm: add global class for allowing ipsec traffic

38c6af2816-+-Add a cluster_be_recv_pre_purge handler & normalize paths

bb69425f1f-+-Define eventbus ferm service in the role

30273da3ab-+-redis::multidc::instances: disable replication

e6d3fb79c0-+-Kill misc::limn and the limn module

da2630f5a0-+-Include rsyncd ferm service in the statistics role

035da38134-+-role::memcached: create cross-dc replication for sessions

47e14ff952-+-Enable pt-heartbeat on all misc masters (except m1)

d91bcdb1f7-+-Include yhsm-yubikey-ksm in yubiauth role

db8d5c8875-+-role::cache::instances: use for upload cluster

d691754568-+-role::cache::instances: use for text cluster

f646420f01-+-role::cache::instances: use for misc cluster

7be701a20e-+-role::cache::instances: create and use for maps

4989d2ed9d-+-rename cache_remote to cache_eqiad

1302ad4977-+-VCL: move layer from vcl_config to instance param

1a1887cb11-+-bugfix: missing } in d37a3550

cf0844f7ab-+-role::cache: undo fe_t[12]_opts complexity

d37a3550b5-+-v::c::directors: remove defaulting of service/dc

7a1441f190-+-VCL: rename remaining "backend" cache backends

54aa8e3e0c-+-VCL: explicit applayer backend selection

6f091bcb67-+-v::c::directors: remove dead code/comments

147d243c24-+-geoip.inc.vcl.erb: move to text extra_vcl

fb2c9c9adf-+-2layer: move $mma out of storage block

830b1a9a25-+-2layer: remove outdated pybal weight junk

923501094b-+-Remove git::install for phabricator/tools

3d3cd0b17b-+-Update scap to v.3.0.3-1

bb249ffd42-+-Clean up phabricator roles in puppet to remove tag pinning.

11e58f03d4-+-Move /srv/phab/repos to /srv/repos refs T125853

845f037c9a-+-re-enable dump cron job on snapshot hosts

919933b1d3-+-Provide Horizon with a keystone policy

77aa458324-+-openstack: do not have duplicate wikitech Apache config

920ad30d9a-+-Puppetise yubikey key storage module

00bf5772fc-+-Define keystone_host before referring to it.

65cca0bd01-+-Replace single-quotes around a variable ref

4989733045-+-statsdlb: add three statsite instances

3ebfb18fa0-+-Support totp auth for horizon

b482431e18-+-Support totp auth in keystone

b134b89728-+-Test the new heartbeat functionality on m5-master

b96a931c71-+-site.pp: add restbase1010

e5228a862e-+-Use std.fileread to generate WMF error page

2fba5a1676-+-MobileApps: Fix the MW API URI, revert c848ca4fd and resurect restbase_uri

c4efeafd6c-+-MobileApps: Put in place proper request templates for RB and MW

f70cf107fa-+-role::memcached: add cross-dc IPsec for the various shards

dba73db3f2-+-logstash: fix top-scope var w/o namespace

89e01e3b70-+-maps: move roles to modules/role/

e2db353249-+-ci: split and move role classes to modules/role/

5da29e8299-+-mediawiki: split role classes, move to modules

f6f2b5a3f3-+-labs: Revert all work around CNAMEs for toollabs

77ae10cc68-+-Revert "labs: Set tools zonefile to be loaded"

d4dcab07a4-+-labs: Set tools zonefile to be loaded

3b048a20fc-+-fix up wrong var name in datasets nfs role

b8a6e138ee-+-labs: Add CNAMES for tools specific things

ba0d726eb9-+-k8s: Add auth for docker client to authenticate to registry

ef6ccdbd81-+-dumps: disable dump cron on snapshots, prep for dataset1001 upgrade

e42f5bb126-+-normalize_path: move to own include file

0ee0a17088-+-re-enable rsyncs between dataset1001 and ms1001

9599f838f9-+-role::mail::sender: move to standard

4ac070fee1-+-Decom berkelium/curium

1444c46739-+-role::diamond: move to standard::diamond

cc71f16cca-+-Decommision db100[123] 1/2

7fbc9eb2f4-+-ntp: further reorg, split of client and server code

d435879587-+-role::ntp: rename standard::ntp, move to the standard module

8ec0570e22-+-standard: move to own module

ca26a4952a-+-ganglia: replace reserved characters in cluster name

d1a37534cc-+-Define labtestweb2001 as a misc backend

27cd7ac8e2-+-Remove xhgui role from hafnium

316cb4438e-+-Add horizon to labtestweb.

6cb7eca007-+-Move horizon apache config into a vhost

1196b58601-+-Apply xhgui role on tungsten

a67da64af4-+-Make 'field' / 'fields' shell functions available to everyone

90c96d0f0d-+-planet: fix 'invalid byte sequence' issue in sq config

22235ba33e-+-[Planet Wikimedia] Add Albanian and Bulgarian planets

ce7d491643-+-Move access_new_install role to neodymium

99e4c14f9d-+-tools: Add authentication for docker registry

c37e55d3b2-+-cassandra: add restbase1010-restbase1015 to site/install_server

35ff22b866-+-restbase: override logging name

f0dbd87d25-+-re-enable rsyncs to ms1001 for finsl dataset1001 sync of all data

21ef20ab73-+-disable rsync between ms1001 and dataset1001, prep for jessie upgrade

bd4f26037b-+-dumps rsync jobs: leave files for cron in place when job is disabled

5e1aa08415-+-dumps: remove last reference to outdated rsync bash script

9cdc56a104-+-Ship Elasticsearch logs to logstash

8a2c1c1f93-+-Set up dbproxy1005 for m5 load balancing/failover

62a9aca0f5-+-ipmi: remove from iron, add on neodymium

23b6290bf6-+-vcl_config: pass_random setting, disable for upload-fe

fcf3ffa003-+-upload VCL: refactor a bit

b7f5a84105-+-wikimedia-common VCL: split output files

bc7163a6da-+-vcl_layers: split wikimedia.vcl in puppet terms

5903f8f6ce-+-Use different my.cnf in labs for analytics-meta instance

8e128bc045-+-Updates to designate/mdns/pdns setup for Labs internal dns

0ee3b68180-+-restbase: make statsd metric prefix configurable

5c86c9091c-+-Update scap to 3.0.2-1

5809a4ede8-+-Beta: Move deployment server

c11c6bd291-+-Install spark on hadoop worker nodes

58375b6909-+-Remove symlinks made for $cdh::hadoop::gelf_logging_enabled when it is disabled

f6f25ce1c9-+-Consolidate labs pdns settings into a hiera dict.

47c7c2cdfa-+-nutcracker: do not declare redis_codfw in labs

308ed80e46-+-wikistats: no interactive password for mysqldump

ce55ec41eb-+-wikistats: fix date in mysqldump file name again

769d8dedf4-+-wikistats: fix date in filename for db dumps

374cb3203a-+-wikistats: crons for db backup

7e7e8fb6b1-+-wikistats: let puppet git clone vs. deb

7222579f56-+-nfs: deprecation warnings on /etc/modprobe.d

a45df75708-+-labstore: tcp-setup path fix

d60539d7a9-+-labstore: real time application of tc setup

bfbc4cdb83-+-Revert "cache_misc: disable do_gzip"

78babbf7cc-+-lint: fix some of the few remaining warnings

df1afb3156-+-Revert "disable do_gzip on cache_text (experiment)"

4c4007c690-+-Fix role::programdashboard include and hieradata

6c320dfab6-+-disable do_gzip on cache_text (experiment)

ff5ac07150-+-labsdb1003 is a bit overloaded right now, move commonswiki to 1

f25b659739-+-swift: adjust mount options for debian and ubuntu

aa43436aea-+-labstore: stage tc script and enable on boot

6818e46c48-+-programdashboard: move role to modules/role

8630dc445e-+-Program Dashboard configuration for initial labs rollout

400d77b858-+-role/mail: split file, move to module/role/

6f9875d632-+-backup: move roles to modules/role/

22f1c53fbe-+-ferm: fix "not documented" warnings

c05cadcc8f-+-phabricator: move roles to module/role/

ed6e6924a3-+-fix whitespace-related lint issues

74e5625959-+-Remove $::realm conditionals around varnishkafka for labs webrequests

8e563daa1a-+-Analytics MySQL Meta instance:  4G innodb_buffer_pool_size 4 instances

3b5f1dbb06-+-2layer: remove dead nodes storage_size

c310a00be2-+-cache_misc: remove cp1057, cp1070

6f50f4e789-+-cp10[56]1: upload->misc

7e86158497-+-Revert "Updates to designate/mdns/pdns setup for Labs internal dns"

163f5ac3f4-+-Include analytics_cluster* database classes on analytics1015

a9600be4c8-+-Updates to designate/mdns/pdns setup for Labs internal dns

102a2855f7-+-Move Hive and Oozie to analytics1015

a6090283bb-+-Make MySQL instance on analytics1015 the master

d5e80ba546-+-Move role declaration to the top of the site.pp entry to fix Hiera lookup

88b82a0885-+-disable package-installed initscript

27dd8c9cc9-+-cache_misc: remove cp1056, cp1069

8eef94b13a-+-upload/misc VCL: remove t2-be bypass trick

fe06683de9-+-Upgrade elastic search to 1.7.5

a8d553a348-+-torrus: remove cache_parsoid refs

eb5f9e689a-+-Fix typo s/admin/admins/ on MariaDB's icinga config

6d215ed157-+-decom cache_parsoid

6fe1fb94ad-+-uwsgi: don't declare uwsgi-startup service

0724de46b3-+-alert only on external (parity w/ dashboards)

afc9691469-+-Non critical DBA pages should not send an sms to the DBA group

879efb0130-+-Remove outdated comment

6687658888-+-Add a comment about manually-created MongoDB indexes

8db4d80064-+-gdash: decom

2c156d9de9-+-parsoidcache: remove from LVS

ae43f53d2f-+-quarry: Move role classes to module role

290280ff75-+-designate:   Open firewall to axfr traffic from pdns hosts.

a3ecb54024-+-Tools: Move role classes to module role

a9c808cf0d-+-wikimetrics: rename prod role, move to module/role

919c26c311-+-xhgui: enable PHP opcache

605f76c3f3-+-xhgui: increase memory limit to 512M

2ef752bdde-+-Pass $service_name to service::deploy::scap in service::node

96801f67f9-+-Use aqs-admins group for AQS deployment via deploy-service user

a6bb24b5d1-+-toollabs/mailrelay: fix top-scope vars without namespace

82eeae3d35-+-codfw: move cache_parsoid nodes to cache_upload

2d82f241a2-+-AQS: Separate AQS off of RESTBase

70309ce125-+-Tools: Fix undefined variable in toollabs::kube2proxy

848c9fde4c-+-xhgui: require ops / nda / wmf ldap group

187a77d50b-+-role::xhgui: require php5-mongo; provision cache dir

7858b61bfe-+-Fix-up for Idc3065856: correct xhgui repo name

b67b5f158d-+-Complete xhgui role

d0c90916be-+-role/lists: rename prod role, move to module/role

3f81363d65-+-role: Align arrows in manifests

1065c1f9b7-+-Add role::xhgui; apply on hafnium

1f67dacb76-+-restbase: adjust alarms with new metric names

9e498d088a-+-sge: ensure grid master is running

3f268a4a9d-+-otrs: fix role name, move to module/role

c2d691ebaf-+-postgres: move roles to modules/role/

0ac4fe527a-+-swift: move roles to modules/role/

2b38df4e03-+-Use $repo for trebuchet deploy, use proper dependcy for base::service_unit for both scap3 and trebuchet cases

2b5cf7231a-+-Add scap3 deployment option for services

c779b63cdf-+-Fix variable in eventbus role

7917a9d731-+-Fix eventbus role after scap::target change, deploy_path no longer needed

474c04acb4-+-navtiming: Improve parse_ua and add unit tests

328adf951b-+-Move the labs pdns db server into hiera.

8804480dd3-+-mariadb: Add new es2011-2019 servers

3a24cabfd9-+-cache_misc: disable do_gzip

60dd428226-+-lvs: remove rt_cache_rebuild_count sysctl

e5d56cfde8-+-RESTBase: Enable purging and minor config style changes

2d8bf78517-+-vagrant: Add upstart script to start container on boot

f4eaecb4af-+-nutcracker: re-organize redis servers list

985a2589cf-+-role::memcached: add a second redis instance on mc20{01,16}

d3a9e93c64-+-Fix etherpad monitoring

e958bc91ad-+-logrotate: Convert geoipupdate to logrotate::conf

8af44e0d48-+-Forward maniphest security extension to release/2016-02-18/2

ee133144d0-+-phabricator: allow port 25 for ipv6 too

1c0ae39e2c-+-Install the scap package from deb instead of trebuchet

b261064fd0-+-make scap::target use the scap3 package provider

a1040777f0-+-update phabricator to release/2016-02-18/1

609dd34909-+-labs: Allow setting NFS mounts to be soft via hiera

a9261478ef-+-enable tcp_tw_reuse on caches

66acb56df7-+-beta: move roles to modules/role/

59f52a9d89-+-tlsproxy: upstreams need distinct names

c80b7423f5-+-etherpad: Simplify module and role

14ebfb5a58-+-no_nfs_client: fix service dep order

3cf1908b71-+-base::no_nfs_client - define and use on cp*/lvs*

d0cb915363-+-beta: Followup Id0e9aa4525f773d086d5f4565f8384c94e595017

c7663265b5-+-beta: Move parsoid logs off NFS

78c3e52272-+-Tools: Remove obsolete roles

e631e55aba-+-pybal: fix lint, indentation

ff8a0e45c9-+-ssh: fix lint, indentation

1811c3163e-+-kibana,wdqs,wikimetrics: lint fix indentation

c8be15df58-+-ruthenium: Clone the parsoid repo with 0775 mode

50cff53427-+-yubiauth: adjust class name after move to role module

5e5c782417-+-phabricator: fix 16 lint warnings

69735ab9ad-+-scap: fix lint warnings, alignment

d7f464c518-+-haproxy: fix 12 lint warnings

5696a008e0-+-keyholder: fix lint, indentation

11d2e3faa3-+-Revert "Revert "Revert "ttl_fixed: limit to tier-1 backends"""

47508b423e-+-yubiauth: fix inclusion from modules/role/

def2b6813b-+-labstore: Do not try to create accounts on labsdb1002

9b23a64d90-+-dynamicproxy: Fix pointless typo

650e1752b1-+-Add ferm rule for eventlogging mediawiki exception/fatal relay

55c1b16e16-+-Add ferm rule for eventlogging zmq forwarder service

8a9da75699-+-Use project-$labsproject in labs for /var/log/refinery

60d811ea36-+-yubiauth: fix class name to use underscore

46746bd503-+-yubiauth: move role to modules/role/

245fc11d58-+-Revert "Revert "ttl_fixed: limit to tier-1 backends""

27e96e189b-+-yubiauth: fix include of yhsm daemon class

d4568135e8-+-mediawiki: add texlive-generic-extra

cee0af8c1a-+-Puppetise yhsm-daemon

744d35e0f0-+-Revert "ttl_fixed: limit to tier-1 backends"

3e6dabeaf9-+-Mathoid: Add the render_no_check config option

b84b8a2189-+-logrotate: Convert eventlogging to logrotate::conf

f25b852718-+-logrotate: Convert eventlogging-files to logrotate::conf

d77f5bfac2-+-logrotate: convert l10nupdate to logrotate::conf

898176d3ea-+-Remove {templates,files}/hadoop files

f5259ceb74-+-ttl_fixed: limit to tier-1 backends

ff58f3559e-+-VCL: drop default ttl_cap to 21 days

fc39209fa2-+-logrotate: convert icinga to logrotate::conf

b8175c7065-+-logrotate: convert phd to logrotate::conf

ff9504fb13-+-cxserver: deploy on SCB

ba724aa190-+-logrotate: convert swift-proxy to logrotate::conf

0eaef96297-+-logrotate: convert nginx to logrotate::conf

85d6a069d2-+-logrotate: add centralized define, apply to pybal

e0ebbf63bd-+-Wikitech:  Turn down nutracker logging

d5fc16f36a-+-Move burrow role to kafka/analytics

e687d975e2-+-Remove unused anayltics role from analytics kafka brokers

c60cd9c98c-+-Apply analytics_cluster::database::meta role on analytics1015

f193d734d7-+-Remove unused analytics role classes

dda1b296d7-+-Remove some unsed role::analytics::* classes, more to come

c951f9641b-+-phabricator: forward the old tag system to current release/2015-11-18/1

517065c476-+-Apply new analytics_cluster role to analytics1027

3a1ad7342e-+-Revert "comment out phab role on iridium so puppet can run safely"

b8d0867be5-+-Create refinery classes in analytics_cluster role, apply them to stat1002

6328654807-+-Add a customized glance policy file.

c3b8195173-+-Fix path to camus jars

e5950d88c5-+-Add $check_jar and $camus_jar parameterize to camus::job

87bd3f851f-+-Move the wikitech apache config, again

b4e4ec00ef-+-Move the wikitech apache config template into the openstack module

22cd779e62-+-comment out phab role on iridium so puppet can run safely

93a9944624-+-deployment::redis: add bind to all servers.

1f275b1af9-+-deployment::redis: explicit binding to all interfaces

e28f5c7c22-+-Add ferm rule for graphite/labs web service

266761623b-+-Depool labsdb1002

3eabdda084-+-parsoid: move rt/vd roles into role module

7190131102-+-parsoid-testing: fix nginx site config

b561e0a2d9-+-parsoid::testing: use /srv instead /usr/lib

638c7cf80a-+-grub: allow setting ioscheduler

24fc44e572-+-apache: rotate logs daily, default to 30d

db339b0445-+-parsoid: one file per role, move to module/role

03be974b14-+-parsoid: create module, move files and templates there

29fd1cdad3-+-otrs: Update loginlogo

0606e8a653-+-otrs: Remove the otrs cron file

f117d2d63f-+-Fix multiple definition of /var/lib/puppet

c58a46122a-+-Display a message in motd if puppet agent is disabled

11eebad065-+-Don't automatically update openssh-client

3822f387b7-+-Add ferm rules for eventlogging udp receiver

8fb684cc85-+-Add ferm rules for rsyncd used in eventlogging

47b18ffdb7-+-s2: bye bye coredb; hello mariadb 10 with jessie

468a6a640b-+-contint: lower tmpfs from 512MB to 256MB

254d7288db-+-Use new analytics_cluster::hadoop::worker role on all Hadoop workers

a781d30edb-+-Can't use analytics_cluster::client on stat1002 yet, refinery dependency

dd081f186c-+-Include new analytics_cluster::client role on stat1002

32a5e82fda-+-Use new analytics_cluster::hadoop::master role on analytics1001

ec4bd9deb1-+-Move hadoop_user_posix_groups setting to eqiad/cdh/hadoop/users.yaml

9c1a551dd4-+-Apply new analytics_cluster::hadoop::standby role on analytics1002

0f27c8c57f-+-Include new analytics_cluster::hadoop::worker for testing on analytics1057

4e6039ad0b-+-Use proper path for grep in analytics_cluster/hadoop/logstash.pp

d22111271f-+-Include analytics_cluster::client role on analytics1026 for testing

7f3199fa07-+-Fix hadoop_namenode_opts param, move hadoop logstash logging configs into separate class

608af694da-+-OTRS: remove ssl cert and config

2cb4e841c5-+-Cassandra: fix top-scope vars without namespaces

afd5d02e62-+-Add allowedDomains param to graphoid config

dbbf9d96c6-+-Move production hadoop memory configuration into hiera cdh/hadoop.yaml

6315e19c4a-+-Move hadoop memory settings for production above class declaration

f5a50b275e-+-Fix use of variable in analytics_cluster/hadoop/client.pp

55418def73-+-VCL: ttl fixed/cap params vcl_fetch

a8ca51bf8a-+-Add role::analytics_cluster::java class

1029645f4e-+-I will include the proper fix as an amendment to this revert-revert before merging.

54618ca682-+-tlsproxy: nginx keepalives param for testing

7f43aebcd6-+-Graphoid: pass the config options directly to service::node

bae86d722b-+-lvs: add schedule_icmp ipvs sysctl

56fa72c663-+-Add texvc to role::labs::openstack::nova::manager

e9a4eab743-+-Revert "Install the scap package from deb instead of trebuchet"

9ebd75cd75-+-Install the scap package from deb instead of trebuchet

714f88cb51-+-Separate math and TeX packages classes

d2fc3bc526-+-Revert "cassandra: fix top-scope vars without namespaces"

c5dedb6438-+-cassandra: fix top-scope vars without namespaces

acde916688-+-Enable base::firewall for mw1152

d5093d5e38-+-Revert "Include hiera configuration for labs and prod analytics_cluster role"

1f3a4a6a7b-+-Include hiera configuration for labs and prod analytics_cluster role

b9431662a5-+-Add hue and client classes (these got lost?)

487a576d82-+-Rename analytics_new to analytics_cluster

a2ab0369a3-+-Add ferm rules for noc role

37a0850979-+-OTRS: update site.pp, mendelevium, remove iodine

ad37ac3169-+-allow dataset servers to have rsync access to /srv/dumps on labstore

a7fbf28eb5-+-otrs: Fix a typo. s/default/wmf/

6cf0d94a83-+-otrs: Login wikimedia AgentLogo file

4c9ac0e3fe-+-otrs: Background wikimedia AgentLogo file

5440ddf3ae-+-otrs: Remove OTRS templates symlink

1435ca029b-+-Enable ferm on remaining jobrunners

cb93b98bc3-+-Enable role yubiauth for auth1001

dc621fc046-+-Initial stub role for yubi 2fa auth server

8382ec3600-+-role::memcached: explicitly bind redis to 0.0.0.0

ee8b8fd659-+-Another new cdh change fix for old role

8a32f2779a-+-Fix-up(?) for I33966cc28

18dc416651-+-Better mediawiki REPL

e3917f1224-+-ruthenium: puppetize script to update parsoid + restart services

aaf693b930-+-Another fix for old analytics role with new cdh module

bd191580ce-+-Fix for old role::analytics::hive::server with new cdh module changes

04cccd6e9f-+-mediawiki: Clean up beta sites Apache configs

408ce24d1b-+-Hardcoding path to refinery-camus versioned jar in mediawiki camus job

ae15e7d156-+-cache: Change static_host from www.wikimedia.org to en.wikipedia.org

80aef69088-+-wikitech: add wikitech.m.wikimedia.org as server alias

a50e6f792a-+-Refactor manifests/role/analytics/* into modules/role, use hiera to configure

ca0ce66830-+-Revert "Reload keyholder-agent on keyholder-auth change"

661475213b-+-package_builder: Set PATH for cron updates

e5183d7cc4-+-Add exception to /srv partition for db1043 and db1048

cf5d81ec7b-+-Upgrading phabricator mysql setting for db2012

43d2d460fa-+-Adding a new email template for Burrow lag alerts.

e707d71cdb-+-SPDY support toggle, off for cp1008 canary

75ac6ca45a-+-permit puppet master (palladium) to run salt key commands on master

528bddb9e0-+-new salt runner to accept/delete/check status of salt key

18ec924831-+-base: apt-listchanges ensure => absent

bd2ca3f71b-+-cache_maps: define tier-2 backending

a859cdba68-+-sarin as codfw redundant salt master

ca730219b8-+-fix up last line for salt master pub key for production

9951be221f-+-get rid of leading blanks in pem end line of salt master key

0c19607c8e-+-salt master public key file needs newline

2d6e0c67a4-+-puppetize salt master pub/priv keys for labs and prod masters

65b0e674f2-+-Increase length of lag window to 100

237b2b5027-+-scap: delete updateinterwikicache script

499afb7981-+-Zotero: Move logs to /srv/log

7b54e4320b-+-Fixing small bug in template instancing for ruthenium

3137cecc28-+-Add access to m5-master:testreduce* dbs for ssastry on ruthenium

80ba38179d-+-dumps: fix typo in class name

8b6380641b-+-dumps: move wikiquery dblist setup into separate class

b19bfd9e24-+-dumps: skip labswiki, labtestwiki for generating media dir lists

803a1903c9-+-Enable ferm for dbstore databases on eqiad

d6f3930756-+-Apertium: Move logs to /srv/log

79a213cd61-+-cache_mobile decom: 2/2 Remove most cache config

15792542e0-+-cache_mobile decom: 1/2 remove realserver IPs

1cf29662a5-+-Add base::firewall to jobrunners mw1161-mw1169 (reprovisioned app servers)

feb0debe0b-+-cache_mobile LVS decom: 1/2 remove LVS service

a6ac225aeb-+-git: add missing & (typo?) to exec

24cc170e99-+-ruthenium services: Few more tweaks

6a2e3d9acb-+-Tools: Fix "invalid byte sequence in UTF-8" in crontab backups

ab87987e4d-+-toollabs: sync jessie packages with precise/trusty

f5bf60c648-+-toollabs: libbytes-random-secure-perl does not exist on precise

5039951413-+-Specify wgOpenStackManagerProjectId in WikitechPrivateSettings.php

b90642d233-+-Remove absented uuid-generator script

25d9fc4de6-+-scap: remove unnecessary unicode em-dash

b77ceaefe3-+-cygnus/technetium: install nmap, include standard

a945f06193-+-Reload keyholder-agent on keyholder-auth change

426256c0fe-+-WDQS_Lag monitoring increase timespan

6ef010d1fb-+-Add WDQS_Lag monitoring

65dfde18f0-+-temporarily de-sensitize ipsec icinga checks

4ee6d81093-+-scap: correct clone directives

eb4fefc077-+-scap: clone repositories for l10update

23ac866623-+-grafana::dashboard, $ensure first, present by default

744967be0b-+-add traffic-pool systemd service unit

7fbc293fc8-+-Write redis's pid file to /var/lib/redis by default.

51fc169e66-+-grafana: fix top-scope var without namespace

68f407264b-+-ruthenium: Some more tweaks to parsoid + visualdiffing services

7e3e96fe77-+-parsoid-rt-client: Have testreduce clients use global parsoid service

c62c102e86-+-RESTBase and Labs DNS configuration for ady.wikipedia

1341508cec-+-Update WikidataBuildResources git source (github -> gerrit)

1ca23867a3-+-uwsgi: create /run/uwsgi, including at boot

64c72515c6-+-Add echo tables to the list of private tables

90edd7fc79-+-dumps: skip labtestwiki for addschanged and pagetitles dumps

5e3f7ed439-+-tools: Replace php5-mysql with php5-mysqlnd

dccc1a1cb3-+-ldap: fix top-scope var without namespace

6fa9c9465c-+-mediawiki/jobrunner: fix top-scope var without namespace

1f5cb06263-+-varnish: fix top-scope var without namespace

44ba34e56e-+-dataset: fix top-scope var without namespace

47b50c7cb0-+-osm: fix top-scope var without namespace, rm cruft

3b5742918f-+-ipsec: fix top-scope var without namespace

71e6d3c21d-+-Fixes to the glance image backup cron

9d7f939150-+-openstack: fix typo, "spandby-server" for glance

4d36c75c1b-+-otrs: OTRS search slow, increase between_bytes_timeout

033c6b5e33-+-MobileApps: Change RESTBase URI

73fb868b86-+-Remove old oozie logs in /var/log/oozie after they are rotated

ef4b6a36ae-+-Reconfigure db1060 (depooled)

1512d9e7d6-+-Reconfigure db1054 (depooled)

f0ec128781-+-Reconfigure db1067 (depooled)

b0f9526c96-+-salt: fix top-scope var without namespace

5729627cdf-+-dumps: add labtestwiki to list of wikis we don't dump

fbcdf47f9a-+-scap::master: fix commit hook reference

5964d8348e-+-deploy master: recurse submodules on clone

a68f04dc90-+-scap::master: add commit-msg hook

da99c7ce59-+-Tools: Deploy root web automatically again

8651d48d7e-+-shinken: Indent and align generated configuration

0d94c4f3c2-+-tools: Make flannel use proper etcd hosts on proxy too

77c308fc3e-+-tools: Fix typo

303a062179-+-labs_bootstrapvs: fix top-scope var without namespace

aebb438666-+-labs: fix top-scope vars without namespace

5d7bc312fa-+-openstack: fix top-scope vars without namespace

a75491bb09-+-deployment: backup /srv to bacula

efce83a787-+-T110474: Point restbase to internal parsoid url

c960432da1-+-Point iegreview to internal parsoid url

c0a92644e7-+-db1063 config upgrade (depooled)

6c7c472b05-+-Upgrade comfiguration of db1036 (depooled)

e87dd35a56-+-statsite: default to localhost, override as needed

5933a81d87-+-role::deployment::server: actually include mediawiki

44fd70d042-+-Reconfigure db1021 (depooled)

dafe707988-+-Tools: Create separate partitions only in the Tools project

c7e55ef663-+-base: Allow adding SANs to puppet CSRs

91e33b22f1-+-tools: Minor cleanup

f59a184e4e-+-tools: Point k8s master to new k8s etcd hosts

5862f81e44-+-Add monitoring for statsv process

1b33b65c9e-+-tools: Allow k8s etcd peers to access client port too

006a4dee1f-+-tools: Add separate role for k8s etcd

43ba901cf9-+-tools: Disallow k8s master etcd from being accessible to workers

58d677c7e6-+-ganglia: fix top-scope var without namespace

73cdf5b075-+-tools: Point flannel to use new flannel specific etcd

3344e14158-+-toollabs: Add proxy nodes to flanel etcd access list

a66357dd2d-+-aptly: fix top-scope vars without namespace

7dd6cd27b3-+-dynamicproxy: fix top-scope var without namespace, lint

bab8322a63-+-ircyall: fix top-scope var without namespace

7f5d240d80-+-apache: fix top-scope var without namespace

f17c47cb7c-+-tools: Allow peer nodes to acces etcd port too

6a6bdcc3c9-+-Tools: Fix double file resource for jlocal

fbc195833a-+-tools: Include base::firewall on the flannel etcd hosts

84e9cc5fdc-+-tools: Setup appropriate ferm rules for etcd clients / peers

66382de01c-+-force salt minion to ping master every 15 minutes

866ca23b24-+-dumps: rebalance page ranges for dump jobs that run in parallel

b0ed391c4c-+-toolslabs: install hunspell and libhunspell-dev to exec nodes

4c48f32543-+-dumps: configure for parallelized runs for zhwiki, metawiki

8d0f935c00-+-Add initial entries for auth* servers to site.pp

05bc5f3a91-+-snapshots: enable the dumps from cron as opposed to just deploying the script

d9d224b524-+-enable dumps from cron on snapshot hosts

1d4e67dc1b-+-dumps: set up but don't enable script for dumps to run from cron

f0b468a926-+-toollabs: Add new role for flannel etcd

e86a9f707e-+-bacula: minor linting

64118d50d4-+-testreduce: Remove ensure => latest from the repo declaration

463d49df4f-+-visualdiff: do not install g++ package, debugging

f2f1de0719-+-visualdiff: move comments up above require_package

eb2dc12bd5-+-ruthenium: slight syntax change for require_package

0b0e7c0d3d-+-visualdiff: add dependencies on required deb packages

911ff7848a-+-releases: switch reprepro upload server to bromine

b07455aba7-+-varnish/misc-web: remove caesium backend, decom'ed

5e2ef6a1ca-+-Add ferm::service{ 'analytics-mysql-meta' to analytics1027

7b4d1c7c9d-+-Allow access to Analytlics mysql metadata instance on analytics1027 from analytics networks

758cde016a-+-delete rsync_caesium class, not needed anymore

81229fda66-+-Decom: Remove rsync_caesium role from site.pp Bug:T125165

a4dca93615-+-Enable base::firewall on alsafi

d9d182e55d-+-releases: add header for mediawiki release dir

fb4bb37c8c-+-Unpuppetize impala in Analytics cluster

d68cc3e5c7-+-Remove kafka1012 from EventLogging brokers array

38ba4a235c-+-Add mysql grants for racktables

1f728ea3bb-+-cache_parsoid: remove restbase pass-through

773dac46ed-+-cache_parsoid: remove citoid+cxserver pass-through

c577dd32ca-+-diamond: enable nfsiostat on labs instances with nfs mounts

6ced5acf01-+-decom: remove caesium from site.pp

0915e4414d-+-releases: fix path to custom html header

d84c478fb6-+-releases: beautify directory index page

9e1e6d21d4-+-contint: php5-ldap on all slaves

956c3e1a83-+-Revert "monitoring: fix top-scope vars without namespace"

843232e8c4-+-monitoring: fix top-scope vars without namespace

e641c199e3-+-lists: fix top-scope var, arrow alignment

da3b0c0d7e-+-racktables: fix top-scope variable without explicit namespace

c3f26b9602-+-role::cache: install conftool scripts

3120a24919-+-Remove nas1001-a.eqiad.wmnet, nas1001-b.eqiad.wmnet

adb080e39d-+-Add alert for elasticsearch 50th percentile prefix search time

ea2d12449e-+-Removing code that generates pageviews using legacy definition

83775bccf1-+-Cleanup SCA from *oid services

d6e81cbce7-+-remove salt master role from palladium

ff34b54b2f-+-remove palladium from list of salt masters on all minions

a530416809-+-contint: stop cloning mediawiki/tools/codesniffer.git

67a939162d-+-phabricator: don't use communitymetrics@, use wikitech

1c90ec5755-+-ruthenium: Rename parsoid systemd file + start up a single worker

5af87febc4-+-Add cxserver/citoid to cache_mobile

20d61138de-+-Text VCL: Add support for citoid+cxserver passes

c9710e4d26-+-graphoid(.eqiad).wm.o VCL removal

4b6988f447-+-ruthenium services: Use puppetized db credentials for testreduce dbs

c3dd3e7d13-+-Add testreduce account and grants from ruthenium on m5-master

185a40c060-+-Undo special-casing of testwiki in Varnish

d0d32640b1-+-Fix for analytics-search-user changes

51d8e41e8c-+-Include role::elasticsearch::analytics on Hadoop namenodes and stat1002

3d27d1203a-+-Create new puppet group analytics-search-users

823499e7f5-+-Fix random ntp startup failures

6cd0d9d97a-+-releases: also rsync /home dirs with user tools

e554561a75-+-releases: add ferm rule to allow rsync to bromine

67e8a6a29e-+-releases: setup rsyncd to copy release files

70189331df-+-Fix alert for eventlogging raw - valid rate

f341b9d479-+-Remove puppet classes and files associated with /srv/mediawiki/private/WikitechPrivateLdapSettings.php

65e4572032-+-releases: use ensure_resource, avoid duplicate defs

81b610d0fe-+-Pass group_prefix to analytics-eqiad kafka jmxtrans

90dc6bbdad-+-bugzilla-static: ensure_resource to fix duplicates

eec4899eef-+-End kafka group_prefix propertly with .

2c450435ca-+-Remove extra group_prefix assignment

092cfa763d-+-Make all kafka broker metrics prefixed with kafka.cluster.$cluster_name

f110c834c4-+-Revert "beta: Move login and bits apache configs into wikimedia.conf, like prod"

f416ea1f67-+-Revert "Add alert for elasticsearch 50th percentile prefix search time"

5d4a2649f7-+-Add alert for elasticsearch 50th percentile prefix search time

9cc048f01a-+-Update kafka submodule and remove incorrect use of nagios_servicegroup

7e3ead84d3-+-Lint fixes for role::kafka::analytics::mirror

5c625f5342-+-beta: Move login and bits apache configs into wikimedia.conf, like prod

bf806f48e4-+-[cirrus maint] redirect stderr to log and use full mwscript path

2accc55dec-+-releases: add role on bromine

59ba48b89c-+-Set group_prefix on kafka-mirror jmxtrans metrics

d7e25d0b20-+-Run kafka mirror on both kafka1001 and kafka1002

d353d6b4bf-+-Move analytics-eqiad kafka mirror test to kafka1001

fdfea863a3-+-Use brokers_string instead of brokers_array so each hostname is suffixed with broker port

3bff50ea28-+-Remove invalid parameter jmx_port from kafka::mirror::monitoring use

850e53cd55-+-Puppetize Kafka MirrorMaker on analytics1021 mirroring from main-eqiad to analytics-eqiad

a4f299c787-+-Enable RPS on eth0 on labstores

bd1b6d4c41-+-Remove debdeploy::master from palladium

6a2bb369b7-+-Add the moving average function to the event logging's insert rate alarming metric. Bug: T124204

9a7c0f6756-+-Create /etc/mediawiki/WikitechPrivateSettings.php

0985ebb419-+-Move some ldap host/cert name stuff into hiera.

ce17b1e506-+-apt: Remove extra space in sources.list

cae0b4563b-+-Install libbytes-random-secure-perl on tool labs

c6575e9335-+-toollabs: Symlink jlocal in /usr/bin

c55f160cd0-+-Decommission:Remove nitrogen from puppet

4d6e2b04a7-+-toollabs: Include exec_environ for cron runner host

d19632e830-+-ruthenium: remove rsyncd, was for upgrade only

092982ff12-+-ruthenium services: /usr/lib/parsoid/deploy/src => /usr/lib/parsoid/src

80a129ae61-+-Add recurse_submodules => true while cloning parsoid in parsoid::testing role

3a5c615f49-+-Fix bad path in role::parsoid_rt_client definition

715298ed06-+-parsoid-testing: rename classes with dashes

960b22ef81-+-nginx conf that routes requests to different services on ruthenium

7a2d1114e9-+-Clone the 'ruthenium' branch of testreduce and visualdiff

8c3deb85b9-+-Migrate parsoid::role::testing service from upstart to systemd

54b76ebc76-+-Add the visualdiff module + instantiate visualdiffing services

c7b19ac4ae-+-Revert "Temporarily disable eventlogging mysql consumers and burrow monitoring for them"

4e09a8a58f-+-move git-deploy to neodymium (primary salt master)

9bdf288e5e-+-Make neodymium the debdeploy master

9a582b4244-+-role::deployment: add a warning on the inactive server

e3d3e86bcc-+-dynamicproxy: Use lua-json package instead of liblua5.1-json

1e915564c3-+-make neodymium primary salt master

c885a21b9d-+-ceilometer: move roles to modules/role/

85b76720f9-+-toollabs: Remove role inheritance from gridengine shadow

4651fadf8f-+-toollabs: Remove inheritance from gridengine master role

b8121d574a-+-toollabs: Move toolwatcher to services

aef8df1cd6-+-toollabs: Remove inheritance from mailrelay

27d00cc4ea-+-toollabs: Remove inheritance in role from compute

91468d569b-+-toollabs: Remove inheritance from bastion role

758d07bbf3-+-toollabs: Remove role inheritance from static hosts

25d7c58325-+-mattermost: move role to modules/role/

3a4e2aa43d-+-toollabs: Remove inheritance from services role

d219e9dd48-+-toollabs: Remove unneeded inheritance in checker role

aa027b6210-+-toollabs: Add package needed for updatetools

d2ffcb6e49-+-toollabs: Fix missing parameter for updatetools

be939a6f4c-+-toollabs: Move updatetools to run on services host

9b4fe1a3f2-+-toollabs: Install package that bigbrother needs

b4973a4c7f-+-mha: move roles to module/role/

80572ce3c5-+-graphite: move roles to modules/role/

4c3c62abf5-+-toollabs: Move bigbrother to services nodes

85dcec6eb8-+-debdeploy: move role to modules/role/

bc2a4e03cf-+-bastionhost: move roles to modules/role/

77ee34ead6-+-lvs: rename interface-tweaks to interface_tweaks

c88e28b1f6-+-installserver: rename classes with dash characters

d44825d793-+-ruthenium: switch rsyncd setup over from osmium

46dee6abb5-+-Stop syncing CirrusSearchRequests from fluorine to stat1002

ec57cfda15-+-Move apache includes into generic sites.pp

4ea0c1cd11-+-Delete config.beta.wmflabs.org

e4f202b988-+-quarry: Make redis listen on 0.0.0.0

860bf3ce1b-+-Fix ipv6 ferm rule for iridium-vcs.eqiad.wmnet

89672bcc86-+-Add iridium-vcs.eqiad.wmnet ipv6 to phab puppetization

e757eedae4-+-RESTBase: Enable firejail

d2e4593037-+-citoid: Apply the role on scb

f1e964c3d3-+-Move portals into generic sites.pp

f52045783e-+-graphoid: apply the role on scb

2d950c97ce-+-Temporarily disable eventlogging mysql consumers and burrow monitoring for them

2ba96ce00d-+-Enabling ssl and ferm on parsercaches, disabling performance_schema

df93e75ab3-+-Fixing db path for newer machines by adding a condition on the role

0c5915d16a-+-simplify annualreport module

6fba384886-+-annualreport: Ensure latest checkout of git repo

1285cebd9a-+-Adding new parsercache machines (pc[12]00[4-6])

91f6da3575-+-url_downloader: Add port as a hierable parameter

0fbb78c104-+-Job runners: Add a dedicated htmlCacheUpdate runner

e9f1f8e1ec-+-elasticsearch: Add ferm rule for labtestweb2001

89d61d9055-+-Add subscribe config file for Kafka's Burrow service Bug: T123942

3725cb3476-+-deployment::rsync: the inactive server should sync with the master

1292d6ae63-+-deployment::rsync: fix cron

75918313f4-+-role::deployment::server: syncronize /srv/deployment

8a5fe24786-+-deployment::redis: re-fix syntax

a7f02e4016-+-deployment::redis: use ipv4 address when replicating

d297fbf961-+-deployment: activate redis replica between the masters

2b60e1049c-+-role::deployment::server: fixup for I4e632e66f

ed0ccad3ff-+-redis: do not 'expect fork' if daemonize = false in the settings.

2cec78a6be-+-add url-downloader in codfw on alsafi

9baf16deb7-+-role::deployment: make it possible to switch between different servers

2e19a529f2-+-Added some comments for the node stat1001 (analytics)

50c6b83712-+-jobrunner: lower the kill threshold for gwt-enabled jobrunners

81873ceee5-+-toollabs: Backup crontabs from cronrunner

506fab6c54-+-toollabs: Use hiera to figure out where cron runner host is

047cabdb09-+-toollabs: Puppetize jlocal

0f90c74cf4-+-toollabs: Include toollabs init in cronrunner

2d998367ca-+-toollabs: Add cronrunner role

ea6b262935-+-toollabs: Don't setup exec_environ in submit hosts

4c6f4b1080-+-toollabs: Do not use inheritance for submit role

6244418bfa-+-toollabs: Stop specifying $gridmaster in role

2852740966-+-apache: Add http to https redirection for simplestatic role

9d4125c275-+-Enable limn-multimedia-data cron

98739d7054-+-gerrit: remove require for unused plugin repo

08bb4a704d-+-gerrit: remove plugin repository

419c20e6ec-+-Sentry: really create group

9e3ccbb2a6-+-Phragile: Ensure clone before creating storage dir

a3df0489ea-+-osmium: temp. add rsyncd to copy ruthenium data

523eeec45d-+-cache_text: add mobile IPs to loopback

21945aee98-+-Begin to merge production and beta apache config, starting with nonexistent.conf

802d0070d9-+-Only check puppet freshness once per day, not 60 times in a row.

46dfa7af21-+-Revert "Include role::mariadb on labtestweb2001"

956333d1c2-+-mariadb: Actually include class in role

316361d9e6-+-Added icinga check for 'showmount' on tools instances.

cd56933982-+-Include role::mariadb on labtestweb2001

4b7fa02d27-+-Tidy up wiki crons for labtestwiki:

3c797161cf-+-Use hiera to configure hive and oozie server hostnames

3543038644-+-Typo fix

1ff201baa0-+-Specify webserver_hostname for the openstack_manager class.

b46d078b16-+-Added self-signed cert for labtestwikitech

ddb83e00dc-+-Openstack Master:  Don't error out on non-production realms.

6cc365e64a-+-Add a wiki + osm to labtestweb2001

e45840b1c1-+-Rename labcontrol2001 to labtestweb2001

ddc05c6a80-+-Remove reference to labs_nova_controller_other

51327368b8-+-uwsgi: Restart daemon when config changes properly

c70df1921d-+-It probably doesn't work to include ldap client and server on the same host.

63f493f2ca-+-Add dns to labtestservices2001

2f9bbed060-+-wikimetrics: Re-enable SSL redirection

3c8b210649-+-wikimetrics: Fix allow CORS rule to apply to requests starting with /static/public

d6d3806ff5-+-wikimetrics: Quote route-if param for uwsgi correctly for parameter expansion

947b64223d-+-wikimetrics: Allow CORS for /static/public

8049c0fc23-+-wikimetrics: Make uwsgi serve static files on /static

91d7b01e69-+-remove gadolinium, erbium from site/installserver

ffe3153263-+-gridengine: Do not have puppet autostart the master

7d16773430-+-remove protactinium from site and DHCP

35c6183d73-+-Add parsoid::testing role and use it on ruthenium

2b91fc109f-+-Revert "Specify openstack::nova::partition on labtestvirt2001"

b661ee372d-+-Specify openstack::nova::partition on labtestvirt2001

4832391fbe-+-Install nova-compute on labtestvirt2001

357cb77498-+-Make role::url_downloader unparameterized

a80550df28-+-Install nova-network and nova-api on labtestnet2001

f274b149ba-+-Remove use of passwords::openstack::nova::nova_ldap_user_pass

8589b4248f-+-Define special_hosts for labtest realm.

a1c1c16537-+-wikimetrics: Add mysql-client package dependency to production role

cb3f03fd9d-+-Wikimetrics: Puppet module for wikimetrics

3ce062a5b2-+-Revert "wikimetrics: Puppet module for wikimetrics"

f1a7fefa88-+-wikimetrics: Puppet module for wikimetrics

926fd4b800-+-Add dependency to eventlogging_sync.sh to ensure it is in place before service is started

3baf9a472e-+-Add server_id arg for labtest openldap

c8a09e6e5e-+-Add a placeholder mw_appserver_networks for labtest

2f6527a893-+-Add firewall to labtestservices2001.wikimedia.org

824aabbe62-+-Add openldap to labtestservices2001

088fe6a3f7-+-Add system::role to piwik role

343dacd54e-+-jobrunners: actually absent the hhvm restarting cron where not needed

0103ab2463-+-jobrunner: contain gwt jobs to run on two specific hosts

c842b7a140-+-parsoid-rt-client: Save the localsettings file in the parsoid repo

bffdf4fd52-+-tools: Add simple command to log tool invocations

da2199c8d9-+-Make testreduce generic and instantiate parsoid-rt services

5c661f683a-+-site.pp: add alsafi.wikimedia.org

287a981b8f-+-osm: split and move roles to modules/role/

b082d117b3-+-swift: add python-webob, remove python-swauth deps

1b1d21c773-+-standard_packages: add dstat and ncdu

bb11a558ae-+-annualreport: add Apache site for 15.wp.org

abfe6c8946-+-ganglia: move roles to modules/role/

9482706503-+-dumps: add nocreate versions of stages files for huge wikis

e24ba465b2-+-dumps: actually produce the new dircreation dump stages files

85242b303f-+-EventBus: add spec-based monitoring

9b3b2fe8cb-+-Add stubby node definitions for labtest*

689639a3c5-+-scap: Put configuration for scap in /etc/scap3.cfg

85981fe0c4-+-ci: remove elasticsearch from browsertest slaves

3f8eb5a872-+-keep fewer dataset web server logs, add date to filename

590576fd37-+-Use X-Client-IP instead of %h for eventlogging varnishkafka instance

a1a8b6658b-+-etcd: add allow_reconnect true to the client config

d2c224ad5a-+-conftool: add support for ACLs, helper scripts

c9b50959ea-+-etcd: turn on authentication in production

d446e51195-+-etcd: auth puppetization

07f918fd53-+-Enable memory cgroups for labs debian instances

6e0120712d-+-tor: move role to module/role

169c667289-+-dumps: declare monitor class with full name, duh

eb105e2bf9-+-dumps: apply dumps monitor role to snapshot1004

d6cbdadee7-+-dumps: add role class for dumps monitor

26fa038087-+-puppetize dumps monitor as a service

b7900afa3c-+-Tools: Remove obsolete variable $repo

17b5b78c76-+-Send email to project admins if puppet runs are failing.

02ff194d9c-+-dumps: checkpointing for de and fr wikipedia

0e8041dc17-+-Revert "toollabs: install hunspell, python*-hunspell, hunspell-dictionary to exec nodes"

1d74d8d3f9-+-diamond: nfsd statistics

efbb57b072-+-toollabs: install hunspell, python*-hunspell, hunspell-dictionary to exec nodes

486b4400c6-+-diamond: Introduce an etherpad plugin

df5ab56d83-+-network: add sandbox "realm"

52ea119316-+-network: split frack into its proper subnets

5a14c70266-+-extdist: Unbreak

ffb09b8273-+-Apply the mathoid role on scb

2dc3ef6459-+-network: move frack networks into a separate realm

00a0dfbc0c-+-mediawiki: really silence HHVM restart cron

0a64caef0d-+-tools: Add misctools package to all exec hosts

e84e07892d-+-testreduce: declare log directory

219fa4284a-+-Add testreduce module and role

d010dde121-+-Remove now obsolete OpenDJ server module and related templates/files

0c59723cf7-+-icinga/ores: put homemade plugins into /usr/local/

71c3d12a14-+-network: move esams/ulsfo subnets below codfw

536f9aa988-+-icinga/ores: add check command definition, use nagios_common

3181319997-+-ores: monitor workers without service reloads

f50febc17d-+-contint: drop publish-console

b3f041e1a0-+-dataset: move roles to modules/role/

acb9947396-+-Revert "toollabs: disable paging for tools-home/NFS"

8a1f23144b-+-contint: remove maven webproxy

441f66bc7e-+-mediawiki: silence HHVM jobrunner restart cron

e069e59c54-+-redis: small lint fix

7bb6db69ed-+-redis: Set vm_overcommit = 1 for all redises

6982cafde1-+-toollabs: disable paging for tools-home/NFS

230e1b3359-+-gridengine: Add berkley db commandline utilities to master

0fc42a17c9-+-toollabs: increase timeout for tools-home to 20

adfe942e1d-+-fix typo in contents of salt minion systemd conf file

ed1f2bc3ce-+-restart of salt minion should not kill all subprocesses

8547f137d1-+-redis: enable latency monitor only on jessies

bebef06b7c-+-Fixup for Icfa1a930df: anchor the 'match' so there is only one match

1c16154c6e-+-redis: use file_line on redis.conf to enable latency monitor

378ebf4cb6-+-redis: disable transparent hugepages

434fea5724-+-remove redis::legacy

f3734e5fe3-+-tools: Typofix for typofix

68f69f6cce-+-tools: Fix typo

0acf4c9fc5-+-tools: Switch what tools-redis hostname refers to

2b02762637-+-toollabs: Stop using aof for redis

e8aebebab2-+-tools: Redises should bind to all addresses

29de1fd530-+-tools: Fix redis slaveof to mention port number

18feddc1cc-+-Fix-up for Ica80cdbb4e

b48cb0160d-+-tools: Truly liberate Redis from NFS

9f830f0d03-+-toollabs: migrate to redis::instance

2bee87f601-+-tools: Do not need NFS for redis

dedd0ae40d-+-Add RESTBase and labs DNS config for wikimania2017wiki

ac85facb7a-+-puppetmaster: add facts export script

5da1017a79-+-Reconfiguring db1050 after cloning

9e0b86d84d-+-on salt master increase network settings for packet backlog and memory

7f48dcc366-+-elasticsearch: move dependencies at the correct level

46c22581f6-+-Restart HHVM on the jobrunners daily, as temp. workaround for T122069

6423d98397-+-bugzilla-static: move role to modules/role/

5c96a6108a-+-apt: move the absents outside the $use_proxy guard

375da2a655-+-apt: Followup to I801f0e007aac39421

e9396d7ecd-+-apt: Do not use a proxy in labs

243586d36f-+-Add some explanatory comments to Piwik role

e9a16b06a1-+-Fix-up for I136ab0a38

d2143e0c00-+-Add piwik role

0683dd7012-+-Use $group_prefix for main kafka cluster checks

40c8e6eeee-+-dynamicproxy: make banning users easier

f8faa74505-+-openstack: rename queue-server to queue_server

a932e03d41-+-openstack: rename openstack-manager class

7599532226-+-Add LVS/PyBal config for eventbus

55343fade4-+-bohrium: Set up DHCP/PXE and site.pp parameters

d373c7ca80-+-ldap: Set home for the LDAP lookup user

ea3dd1e9dd-+-package::builder: move role to modules/role/

9a5e3d402e-+-dynamicproxy: Add error graphite counts too

4bd545b2e1-+-ores: do not check for a string on /

e492201715-+-ores: adjust string to check on home page

65c2c836b4-+-ores: enhance ORES monitoring pt.2

2e36d5c323-+-ores: enhance monitoring of ores workers

6cad6144c3-+-Re-add the dcat configuration

1f48ea5a09-+-snapshot: Deploy DCAT from operations/dumps/dcat

c716992643-+-Ensure osm_sync present

688720b300-+-snapshot: mv wikidatadumps classes to autoloader layout

3087e9800a-+-Fix icinga proc warning for eventlogging-service on kafka100[12]

0dd63646a5-+-Restart nslcd after ldap.conf or nsswitch get changed.

b42169e935-+-contint: monitor Jenkins has a ZMQ publisher

da87c3d2b9-+-The field I want is 'project' not 'project-name'

02b6ff0338-+-Remove duplicate definition of labs-project for metal instance

b5b778e8a2-+-Hardcode labs tftp server for now.

b77bbc875e-+-nova-network:  have dnsmasq advertise pxe-boot options

fb8388b239-+-Disable critical errors for codfw slaves due to lag

97cea7270d-+-k8s: Have docker service start after the flannel one

aa6bb11236-+-reclaim nembus/neptunium to spares

8116eb5ac6-+-base: Add support for https apt repos

f3405f9f3e-+-ores: Have the redises listen on 0.0.0.0

b446d4ce04-+-mw_rc_irc: rename irc-echo to irc_echo

c7fdf6f6df-+-tools: fix stupid typo

ab9ab2a596-+-toollabs: Remove NFS dependency from proxies

b2e749b152-+-Remove role::analytics::kafka::*

deb135ede6-+-Use new kafka role in eventlogging alerts

cfbdecbf34-+-contint: rename git-daemon to git_daemon

c873c9b993-+-Use new kafka role in role::cache::kafka

f3dc60e72d-+-Use new kafka role in role::logstash::eventlogging

fb896cc6b7-+-eventlogging role now uses new kafka analytics role

c2c36f9e25-+-Remove unused ganglia kafka views

dc763b5453-+-Replace burrow kafka config with new role

dc5c547c01-+-Add udp2log module, make role::logging::mediawiki use it

0a3dfb457a-+-Remove misc/logging.pp and ::relay related classes that are no longer used

51014a787e-+-osm::planet_sync: Add ensure parameter as well in sync cron

843d92e1f1-+-OSM replication for maps

bb610b5bd1-+-Revert "Revert "bacula: rename mysql-bipe to mysql_bpipe""

ce04f15d77-+-base: rename standard-packages to standard_packages

9d5338cf9f-+-Revert "bacula: rename mysql-bipe to mysql_bpipe"

fa91ec2e47-+-Reconfiguring eventlogging mysql servers

91ab0db3f8-+-bacula: rename mysql-bipe to mysql_bpipe

77ff4fcb7b-+-Correctly order MediaWiki servers in site.pp

7e19e7f8da-+-tor: fixup address for the second instance

1d0ded8575-+-Insert dns entries for labs bare-metal systems.

7429701e7d-+-Set up special dhcp behavior for bare-metal boxes

cb64c95958-+-Revert "Set up special dhcp behavior for bare-metal boxes"

0d9bb3f300-+-Set up special dhcp behavior for bare-metal boxes

23041440b3-+-Revert "Revert "Revert "cache_text/mobile: send randomized pass traffic directly to t1 backends"""

6ba697c4fa-+-varnish: appropriate t2-fe -> t1-be backend_options

1098a6e256-+-Include IPSec ferm rules for analytics kafka broker role

015ce281cc-+-Use new kafka role class for refinery camus jobs

43d6d16c79-+-Remove unused role::logging::kafkatee::webrequest::fundraising class

7fe2bb3e9d-+-Make kafkatee on oxygen use new kafka role class

eb2ba92f48-+-Fix variable assignment in role::kafka::analytics::broker

1d88e833db-+-Use role::kafka::analytics::broker on analytics kafka brokers

20e1226f52-+-tor: add a second relay running on the same server

eb5a9f2521-+-tor: add support for multiple instances

75fbe9b62d-+-Reconfiguring db1047 and cleaning up db servers

30227054ef-+-Reconfiguring db1047 mysql

7c55a2cdcd-+-Fix for kafka broker port ferm rule

7df704e723-+-tor: drop default parameter values

64953b66f9-+-tor: drop tor_ prefix from all class variables

6d3d2eb2a8-+-tor: pass hashed_control_password as a class variable

14b74a4aa3-+-tor: drop motd::script from the module

c35ef9ae6e-+-CXServer: Set up automatic monitoring

ae11a5d2f4-+-VCL: standardize retry503, move oddball to parsoid-backend

f9c29fa280-+-VCL: move retry5xx to parsoid (only user left)

85b0c364e8-+-Allow pybal::testing to vary the pybal config

9fe5357473-+-pybal: allow configuration of the protocol, host

884bbe357c-+-trebuchet: change ferm rule to deployable networks

e24d52eb76-+-Revert "Mathoid: Increase the number of workers temporarily"

8382d05ae2-+-pybal: introduce role for testing machines

f51b52f9de-+-ores: Fix another stupid typo

7253018501-+-ores: Fix stupid typo

56e971332b-+-ores: Setup separate staging config

52cf94b774-+-ores: Account for more magic

a16314a716-+-ores: Create the redis data folders manually

1885c66fb7-+-ores: Split cache and queue redis

1997489ed0-+-puppetmaster/labs: fix indentation warnings

d4094f6e53-+-zuul/merge: fix lint warning

dfb1475e5f-+-rsyslog: fix indentation warnings

d22c7cb46d-+-vagrant,statistics: fix indentation warnings

bf9778c7b5-+-security: fix alignment lint warnings

2d7aa2dda6-+-phabricator: scaffolding to deal with unruly clients

a104a0ee68-+-jenkins: fix alignment lint warnings

1d0338d870-+-tendril: fix alignment lint warnings

36fc6570e8-+-Include eventbus role on kafka1001 and kafka1002

145c251c13-+-contint/hhvm: ignore alignment lint warnings

f95fdda70b-+-Configure keyholder keys for eventlogging scap deployment on tin

56ddadaf2e-+-salt-master: ignore arrow alignment warnings

f387ac8a85-+-l10nupdate, geowiki: minimal lint fixes

edfa0dba3b-+-backup: ignore arrow alignment warnings

ee9e66f5f8-+-Revert "Revert "cache_text/mobile: send randomized pass traffic directly to t1 backends""

c3a8631837-+-Ensure target path exists, but don't ensure directory

37cd235f0b-+-Use new kafka role for eventlogging service eventbus configuration

2e16178237-+-Make eventlogging files consumer role manage output directory

a90eb55302-+-Don't include eventlogging::deployment::source in production yet

8f787f6ecd-+-mediawiki: fix puppet-lint warnings

f5685c6ce0-+-Puppetize eventlogging-service with systemd in role::eventbus

c31ba3b670-+-Move role::scap::target to scap::ferm, add scap::target define

73b1452867-+-Elastic: move merge_threads to hiera

557878365e-+-Gerrit: move static assets to *.cache.* filenames

00533a92b5-+-reclaiming calcium to spares

2d7a4165d2-+-Mathoid: Increase the number of workers temporarily

5819824531-+-More fixmes for scap/manifests/scripts.pp

1707ebfb2b-+-Cron job to rebuild completion indices

c127ad9f28-+-extdist: Split skindist log into a separate file

4dc3f16ec9-+-cxserver: Populate no_proxy_list correctly

378c1ac77c-+-Revert "CXServer: Do not use the proxy for RESTBase and Apertium"

5afb017cb8-+-Stop opendj on the former labs LDAP servers

a0bd3f2d51-+-Fix typo on I8f72fda4983

9557fe9686-+-Upgrading and reconfiguring mysql on db1031 and x1 codfw

3586aa78c7-+-phabricator: start using x-client-ip

f841dba6b2-+-labs: widen access.conf exception to everything LOCAL

8a1289d4bd-+-CXServer: Do not use the proxy for RESTBase and Apertium

18df1b24f6-+-service-runner migration for cxserver

8a19bf7046-+-Add ferm to role::puppet::self

ebcf848a84-+-ores: Stop using aof for redis persistance

738994306c-+-Revert "tin,mira: move base::firewall to deployment role"

3e7a8c590c-+-Use Mwextension instead of the old name Mw-extension

9838d74606-+-wikidatabuilder:  Use require_package to avoid duplicate package conflicts.

6377970a95-+-icinga: add logic to avoid paging for test machines

ee23321be3-+-diamond: Add openldap collector

f9d0dcdc56-+-Reconfigure mysql at db1041 and all s7 codfw slaves

fea45e166f-+-Revert "cache_text/mobile: send randomized pass traffic directly to t1 backends"

fe5ea83749-+-Fix group prefix for jmx metrics

39eba27eb2-+-Don't puppetize codfw main kafka cluster yet, we need a zookeeper cluster

bf6b3efa3d-+-Set group_prefix with Kafka cluster_name for jmx metrics, make some variables local

4cf9f1da81-+-Set up proper kafka log dirs for main clusters

4c9dd8de0e-+-Uninstall ecryptfs-utils

c113b6f678-+-Fix undefined variable access

64aada6588-+-Using more generic roles for kafka classes, configuring new main brokers kafka[12]00[12]

80e8afabc2-+-service::node: Configure automatic service restarts with init_restart

d3e1f70761-+-RESTBase: disable firejail

02c20068c3-+-RESTBase: Switch to service::node

f769d87577-+-Reconfiguring mysqls db1022 and s6 codfw servers

fc083e4e96-+-allow salt master to handle more than 1024 conns

ad2874ee9c-+-labs: add an access.conf stanza to always allow cron

bf61260747-+-tools: No more puppet client classs

81fa6076fe-+-Disable etcd in labs eventlogging for now

9f8a208396-+-torrus: fix http(s) monitoring

f3ccdd986d-+-Increase size of programname field in remote syslog template

ba0a47b56d-+-Convert mw1162-1169 to job runners

2386bad841-+-conftool: fixup for e029eda

393a8305fb-+-puppet: extract the common parts of operations/puppet git clone

89f2c848c5-+-Convert mw1161 to a job runner

0603eabea4-+-kafka::server - fix ESP ferm rule

722d647419-+-Reconfiguring mysql for db1049 and all s5 codfw databases

9b6b396406-+-kafka::server: allow ipsec traffic

d57d3278dc-+-Revert "ipsec-for-kafka: limit to kafka1012 + cp4011 for testing"

2a227654c0-+-Reconfigure db1042 and all s4 codfw mysqls

0998b9969b-+-post-merge fixup for 8b9dfe360

8b9dfe360c-+-ipsec-for-kafka: limit to kafka1012 + cp4011 for testing

20d8094e8b-+-Update configuration for s3 slaves on codfw (+style changes)

583e4d92e6-+-ganglia: add ganglia::cluster exported resource

9579320e1d-+-apply ipsec associations to kafka brokers

93dd46971b-+-base::labs: rename class with dash character

c860a90535-+-nagios_common: kill all the love

d7c88ff142-+-Enabling ssl on dbstores, disabling performance_schema for now

354fe56a29-+-monitoring: Use nagios_common for contactgroups

5f543cc21b-+-Enable ferm on db1046

73790c0d56-+-Rolling in new mysql configuration for m4 servers

fe670d9289-+-openldap/labs: make serpens/seaborgium backup hosts

f4b9377c93-+-Clean up some unused udp2log stuff

6c10378af5-+-Reconfigure databases in s2 shard (p_s, ssl, ROW)

232696697d-+-Reconfiguring db1018 (performance_schema, ferm, SSL, upgrade)

6b976dd5d2-+-contint: rename slave-scripts class

739da4510a-+-varnish: move varnish-test-geoip into module

1d9e0fdfe7-+-ores: Adds myspell-et and myspell-uk to ORES base.

6a39dad1df-+-role::cache::logging: set absent in the correct place

97046b8435-+-cache_text/mobile: send randomized pass traffic directly to t1 backends

6ce3f053b7-+-Remove gadolinium related udp2log and varnishncsa stuff

492c25342e-+-Disable analytics1026 misc (sqstat) udp2log instance, remove sqstat and udp2log

e181b07bb7-+-graphite: run archive-instance once a day

f596689bf3-+-cache_upload: send randomized pass traffic directly to t1 backends

433bc5dd1e-+-varnish dynamic directors: override dc per-service, use on misc

874af14748-+-cache_misc: send randomized pass traffic directly to t1 backends

976d5f6fca-+-diamond: stop referencing to python-diamond

475d6cc3c3-+-Reconfigure and upgrade labsdb1004

93f1923825-+-apache: Add role to serve static sites on multiple hosts using apache

f5cdd22343-+-k8s: Use official docker packages instead of jessie's

ec317848ca-+-Revert "base: Allow https debian repositories!"

8aa1b6e949-+-k8s: Add and trust docker official repository

044f4e690a-+-base: Allow https debian repositories!

97e62dad88-+-Elasticsearch with proxy for tool labs

592ab4d94a-+-diamond: Fix puppet failures on first run

2136946496-+-Fix-up for Ibc46006e17: daemonize

c8cce53e2c-+-redis: explicitly declare 'daemonize no' for each instance

3d1053d8e9-+-Ensure /srv/redis is created before starting redis

b6c5a80eaa-+-Remove empty manifests/role/openldap.pp

c1e0551d73-+-openldap: add diamond collector for grabbing stats

d379496df0-+-nova::controller: remove firewall hole for http(s)

005d7a6742-+-Labs: monitor getent timing only on active fileserver

ce45c9a84e-+-Reconfigure db1057 (ferm, performance_schema, ssl)

d894319015-+-hhvm: declare /tmp/heaps in init.pp

ea15de879b-+-hhvm::debug: change owner of /tmp/heaps

143bad4806-+-site: introduce cygnus.codfw.wmnet

0340955323-+-Applying configuration changes to S1 codfw servers

14527efe4f-+-Fix installation of sudo-ldap on labs instances.

1212523aa6-+-Change list of analytics engineers emails to new alias

803c1c0225-+-site: add technetium.eqiad.wmnet

6c81f3caaf-+-Update kafka submodule, use kafka::server::monitoring class from it in role::analytics::kafka::*

460289f9a9-+-zuul: move roles into role module

c9aa102d83-+-Replace use of $::is_virtual with $::virtual == kvm

6aa7864214-+-Disable everything NFS-related on baremental labs boxes.

19e8500788-+-Change labs public dns recheck interval to 1 minute.

7cef3253c8-+-Labs: Add a timeout check to getent (via ldap) on labstore

7cea9dd5e4-+-Change the icinga settings for labs public dns monitoring

08c6942a3b-+-Reconfiguring es1014 (ferm, binlog_format, p_s, ssl)

24b7b76256-+-Applying configuration changes on es1011

6e5dad94ab-+-Fix typo s/off/ROW/g for binlog_format on ES codfw

4836a1fe15-+-Reconfiguration of External Storage servers in codfw

6840237343-+-Allow hiera to override $::labsproject

22e4fc7d2f-+-statistics: package hunspell-vi conflicts with myspell-da

61cb6574b0-+-statistics: remove package myspell-de-de-oldspell

8206601329-+-statistics: add aspell-id, hunspell-vi

81afcc381b-+-statistics: don't install myspell-fr-gut package

36d29bf430-+-openstack: fix quoting in nova role

4b78fffdfb-+-contint: install npm/grunt-cli with npm

10235ed1af-+-contint: Change redis memory from 128Gb back to 128Mb

669cb4cad7-+-text VCL: remove hiera mobile/text conditionals

87e21ed97f-+-wdq_mm: Kill 'labs' part in lb role

dea6587477-+-Have misc-web talk directly to etherpad-lite

13da4fbebd-+-quarry: Don't install python-pymqsl

fbe40a07f4-+-varnish: use same VCL files for text+mobile

dae4ce3391-+-Contint: add python-etcd to the latest version (for conftool)

4e4095061b-+-etherpad: ferm rules for the etherpad service port

7fb98d0617-+-openldap: Notify slapd on acls.conf and indices.conf changes

6182f66586-+-openldap: Allow to specify cleartext hashing scheme

c12c1f383a-+-apt: add a trailing slash to backports' uri

cdd58afb71-+-apt: swap backport repository's components

647a0fe516-+-add backend_random to maps and upload clusters config

78ba10626c-+-cache_upload: remove unused "rendering" backend

c3664cf87a-+-Allow access to the labs puppetmaster from labs metal hosts.

bfbeba73b4-+-Add labs_baremetal_servers hiera item.

2ff3b0a380-+-openldap: Prepend extra ACLs to base ACLs

ee2252d030-+-openldap: rename loglevel parameter

b85e600556-+-openldap: Parameterize loglevel

08f186851f-+-openldap: enable ldaps:/// for openldap::labs

d71839b939-+-Move labs instances to the new ldap servers.

b0c41c9a09-+-Switch everything to the new openldap ldap servers.

eb0e38223a-+-Update eventlogging topic parameter to use new format

b24c99da16-+-Temporarily disable https etcd in labs eventlogging

c5893be005-+-librenms: add new cronjobs, remove stale settings

347750f34a-+-gitblit: use mw/vendor as the icinga check instead of mw/core

32e0002f3d-+-Fixup for I6fe4b05b922

587e38a222-+-wikimetrics: migrate to redis::instance

508a3a467f-+-ircyall: migrate to redis::instance

7b8937cc80-+-role::labs::openstack::keystone::server: decom redis instance

912c01cdb0-+-zookeeper: move roles to module/role

6deefe28ba-+-elasticsearch: move role to module/role

0d80255751-+-Fix-up for I0f55f28364: omit settings for AOF; not enabled

c7c3384cb0-+-Fix-up for I0f55f28364: include {append,db}filename settings

6dfa317358-+-migrate mc* to redis::instance

623d8760cc-+-Add a new security module with ::pam and ::access

8069b5d3a6-+-Prevent Apache from setting TCP_DEFER_ACCEPT by default

8fe50a42f2-+-lab_debrepo: Fix the sources file's contents

5ad37ab97f-+-Rolling configuration and restart of es1019

d5716d4412-+-monitoring: Move all groups into hiera

342f15f8a5-+-pybal: persist journal logs to disk

c310ea58e2-+-Appling rolling changes to es1015

8493a5f79c-+-lower max reconnect time for salt minion

1baf8f7985-+-Rolling restart and upgrade for es1017

a83a2f693f-+-torrus: move icinga check to https

cf6af910e4-+-pybal::monitoring: install libnagios-plugin-perl

d1c0e8b920-+-pybal: install monitoring

8379454872-+-New variable binlog_format and reconfiguring es1013

dfeff130ba-+-etcd: add client configuration facility

3625686093-+-Migrate the OpenDJ ACL for the "Directory Managers" group

79f7927fd4-+-etcd: remove package etcdctl

94984fd46a-+-vagrant: Set umask 0002 for wikidev users

c2dd0b3d8d-+-pybal: whitespace-only: align =>

ecd537fe68-+-k8s: Use regular puppet cert path

f1cd7c740b-+-k8s: Roll etcd into master role

d4f95cb260-+-k8s: Stop including puppet::self related classes

13f7c28f27-+-Disable accept filters for HTTP on canary app servers

293d8141b7-+-role::ci::slave::browsertests: migrate to redis::instance

6c23f3b284-+-Remove redis::ganglia; incompatible with multi-instance

3dd545aa09-+-maps: migrate to redis::instance

debf1e3cee-+-Migrate sentry and deployment roles to redis::instance

fd16627f1d-+-Remove ocg::role::test; unused

fce986ea6c-+-beta: parsoid now uses modules defined in source

de031fb596-+-zuul: tweak git-daemon monitoring

79c105ccf8-+-smokeping: add protocol redirect

bf531431b8-+-Keep jobqueue aggregator and queue data on separate instances

111e58a482-+-torrus: add protocol redirect

a635b89259-+-icinga/labsnfs: move monitoring groups to labsnfs

c61f3d6033-+-xvfb: systemd support for Debian

e0c0d83ca4-+-librenms: update URL to logo

7c24e02a78-+-Open openldap servers to all wikimedia hosts.

ea8c9ed95e-+-Move arcanist install to contint::packages::labs

358767a030-+-librenms: update settings for newer version

9634d072aa-+-Install arc on the jenkins slaves.

be9948203d-+-Specific size_limit specifically for repluser

a97b6cefdc-+-package_builder: add option to use built packages during build

5bf32958d9-+-Add comment on server_id parameter in openldap module

cb04a5ea02-+-openstack,quarry: fix last "ensure" warnings

c5355fb715-+-labs: Setup saltmaster separately from puppetmaster

7da8460b8b-+-cassandra: quoting/alignment fixes

3abf4639ce-+-add IPv6 for argon (irc,mw-rc streams)

f12a1c015a-+-varnish: fix last lint warnings

ef7aeb8156-+-graphite: fix "ensure not the first" warnings

554897e334-+-dataset,ores: fix "ensure not the first" warnings

2ee4b40158-+-interface::tagged - do not use hotplug

302d9514da-+-aptly: install graphviz for aptly graph

7982f38b56-+-toollabs: install ruby dev tools on dev hosts

e862e811b6-+-Puppetize 4 eventlogging mysql consumer processes to speed up db insertion

4841563b6c-+-to_emails should be a list in burrow role

c2dde65f4f-+-toolschecker: use system's CA certs

1f665457c5-+-etherpad: Have nodejs listen on 0.0.0.0

e07514a036-+-redis: fix config file world-readability

4f24cb79cf-+-xvfb: switch to base::service_unit

ebb8cf3d96-+-interface: use allow-hotplug for ::manual and ::tagged

afbf7d053c-+-role: fix "ensure found on line but not the first"

e58d881c5d-+-wikilabels: fix lint warning

225d7c9b8a-+-ferm: fix last lint warnings

95cc1170ab-+-icinga cleanup: move gsb monitoring to ./monitor/

b25bcd1638-+-Make burrow to monitor the proper eventlogging mysql kafka consumer group

942660da30-+-icinga: remove user from dialout group

638a118cb8-+-cache_misc: move pass-blocks to layer-common code

701d755209-+-eventlogging: use the system-wide puppet CA

bcdfe3676a-+-Turn off services on labcontrol2001

c9e1dd3acb-+-openldap: Document setup of cn=repluser and cn=admin

f59d7b292a-+-Enable TLS by default on all core mysql hosts

ecdefeec8f-+-dumps: add stages lists that don't contain directory creation

4c66c7face-+-graphite::alerts::reqstats: improve alerts

45e93e551f-+-puppet: Kill puppet::self::geoip

704b4067c9-+-labs: Use the https origin instead of ssh

c3271ce40e-+-labtestcontrol2001:  set is_labs_puppet_master and is_puppet_master

8f5441b50c-+-labtest: labtestservices2001 as designate

125a7ab986-+-Wikitech: Explicitly rebuild smw data four times/day

455929df84-+-openstack: refactor designate role/class for labtest

dd62a119a8-+-eventlogging, varnish: fix last 2 quoting warnings

2ba44e640f-+-Eventloggging alarm that triggers when sql insertion decreases

933e8273f3-+-Fix I772920: mediawiki::users::web is a variable, not a class

68eb728146-+-Clean up l10nupdate settings (2/2)

06b621cccb-+-openstack: fix glance /srv permissions

1a37e71d7f-+-labtestcontrol install changes

c3fca05028-+-diamond: batch statsd metrics in production

724ccad7c6-+-Labs: switch PAM handling to use pam-auth-update

d0898e40cc-+-Set size_limit for openldap::labs to 32768

1a5e9d223e-+-conftool: switch to using system-wide certs

589a703674-+-openldap: Allow passing a higher size limit for LDAP queries

ef2c4621fa-+-etcd: switch to using the system-wide puppet ca

32c5610c91-+-openldap: Make slapd.conf 0440

8205f6ef4c-+-base::certificates: add puppet's CA to the trusted store

fdffdef409-+-ores: move monitoring to icinga

50c5fe94f1-+-phabricator: make iridium a backup host

35c39ce8c5-+-Phab: back up code repositories in backula

5f6512ac98-+-Revert "tlsproxy: settable upstream IP, defaulting to 127.0.0.1"

2f3d2e92d2-+-tlsproxy: settable upstream IP, defaulting to 127.0.0.1

4c83a9609b-+-add labtest realm for ldap/manifests/role/config.pp

994d2e6b60-+-initial labtestcontrol2001.wikimedia.org node definition

932b7850f1-+-update varnish directors for full instance names

0ca6012252-+-varnish: ability to remove a named instance

446f7ed653-+-Configure Redis diamond collector to observe all jobqueue instances

8e4fc50aff-+-Set WDQS 5min expiry for internal access Port:8888 (try2)

c9b0228081-+-varnish::reqstats: make ensure=>absent actually work

f22cd9da93-+-Revert "Set WDQS 5min expiry for internal access Port:8888"

0bec20e02b-+-Set WDQS 5min expiry for internal access Port:8888

34d2170c33-+-Revert "base::certificates: add puppet's CA to the trusted store"

d890fbd61a-+-base::certificates: add puppet's CA to the trusted store

17c8ebb369-+-salt minion will wait up to 10 seconds to reauth to master

c4ac6dbb15-+-Add LDAP index for sudoUser

65270509c9-+-Allow configurable LDAP indices in openldap module

c6c0f15b09-+-ores: disable new monitoring check

886fcfce1b-+-ores monitoring: fix typo for contact group param

f1eee9fc42-+-ores/tools: fix duplicate icinga service name

2cdb4a9c50-+-ores: Add paging icinga check for home page

1c47c3e91b-+-statsv: switch "ip" field to X-Client-IP like webrequest

1768425e9e-+-Clean up l10nupdate settings (1/2)

cd6de62200-+-toollabs: remove motd-tips

feb77a557e-+-Toollabs bastion: install GNU automake

9807f39a15-+-webrequest: move client_ip data to legacy "ip" field

84e5e909b3-+-webrequest: Add X-Client-IP -> client_ip

89ba0a7ef6-+-reprepro: add an experimental component

2f285307ce-+-diamond: send statsd metrics in batches

5c1d431433-+-Provision ~/.gitconfig file for l10nupdate user

41521f5ffe-+-l10nupdate: replace ssh key with new scap script

cb6f705652-+-Revert "upload purging: do not listen on text/mobile addr"

aab7598ab5-+-Revert "purging: do not VCL-filter on domain regex"

298094107b-+-Don't pass in keystoneconfig to the designate service.

78c1b125e0-+-Labcontrol1002:  consolidate role lines

16b6473d26-+-Put an ldap-based dns server on labcontrol1002.

8dfb40095a-+-Switch misc cluster to text-like retry5(03|xx) behaviors

b7b8e6bdfd-+-Add extra_schemas to openldap labs role

4fb79cbf87-+-jobqueue_redis: actually disable rdb saves

0b5ae57e03-+-Grow EventLogging graphite check lag 10 minutes

83e12db623-+-Uninstall apport

bc6d54c90e-+-Use --until for eventlogging raw vs validated check

45a09325e5-+-Fix typo in module argument

3ed0f6cafb-+-Assign openldap::labs role to seaborgium/serpens

78737756b0-+-Set ferm and performance_schema for db1053

5a8a8c7e32-+-Goodbye to role::redisdb

31549a304c-+-Migrate codfw jobqueue redises to jobqueue_redis role

674454ec1e-+-migrate rdb1001 and rdb1002 to jobqueue_redis role

375df1d031-+-Migrate rdb1003 to jobqueue_redis role

e95a985126-+-Migrate rdb1004 to jobqueue_redis role

4418796478-+-Migrate rdb1007 to jobqueue_redis

84d6da7708-+-Simplify multi-instance redis jobqueue server configuration

f86781eccf-+-openstack: refactor glance role/module

92ac0ef6ac-+-openstack: more refactor and cleanup for multisite

4145ae510a-+-Support easy cloning of git repositories from Phabricator

c0e40c581a-+-Test --until graphite_check parameter on all varnishkafka drerr reports

6848f7f383-+-Test addition of --until parameter to check_graphite check

da19522f4d-+-alerts: move icinga alerts away from reqstats.*

135b81c523-+-openstack: catch nodepool up with manifest reorg

cd265a254a-+-cache_misc - switch to conftool dynamic directors

f110d3ac8c-+-cache_misc: add LVS service IPs to balancers themselves

69e5e8999e-+-Remove unused r::c::1layer

48d897814f-+-Changing configuration of all s3 slaves after upgrade

df8a08cc1c-+-mattermost: Set default team and server for matterircd

2e0101f924-+-labs openldap role

107f4ced75-+-graphite::alerts: remove 5xx anomaly measurement

897486120d-+-redisdb: bind 0.0.0.0, since the default is loopback only

901179afb4-+-redisdb: use correct ferm::service multi-port instance

34c8dc9ca7-+-redisdb: open ports 6380 and 6381 for add'l instances added in Ieb8e2fbc

dd2682117c-+-Add two additional redis instances on rdb1007 and 1008

37158d75df-+-Fix filenames from  I7a111e420

4631e5426b-+-redisrdb: reintroduce slave-write-only => false, dropped from I7a111e4

76a419af30-+-Migrate rdb1007 to redis::instance

1f048e0926-+-labsvagrant: Do not require secondary disk

b9a48a7609-+-labsvagrant: Move role to deprecated

f40717edf7-+-k8s: Remove standalone role

a5710280cd-+-Move all monitoring groups to one file

0401de8055-+-archiva: Move nginx proxy template into module

1c8d91c2ca-+-add cache_misc monitor groups for other DCs

81735a344c-+-Fix-up for I86cbeff385

c753aecb95-+-Drop mediawiki from nobelium

ab3e3385f7-+-Migrate rdb1008 to redis::instance

0d50e071db-+-elasticsearch: Fixup I9c2e50ec2fd

5381184f89-+-elasticsearch: Add read-only reverse proxy for labs ES

bf51de02ff-+-misc-cluster 2layer refactor, step 3/3

866e57d647-+-post-merge fixups for 377a829d2

377a829d29-+-misc-cluster 2layer refactor, step 2/3

3f47ad9201-+-re-fix misc storage sizes

16649a4fae-+-fix storage sizes for varnish misc

9ccf3f9433-+-misc-cluster 2layer refactor, step 1/3

3a29a719fa-+-Tool labs: start gridengine-master by default

384930065f-+-varnish: refactor instance parameters (no-op)

58845fa10e-+-Optimize elasticsearch on nobelium for spinning disks

5a7dc253cd-+-WDQS Also use queryStartCount counter

7041da5c8a-+-zuul: support for zuul-merger gerrit ssh key

e420278398-+-diamond: use upstream StatsdHandler

3996eb14f7-+-Add nsswitch_conf_source as parameter to ldap::client::nss

06707b9f3c-+-Exclude apport from toollabs genpp python list

fbd7d102e7-+-deployment: fix pyredis timeout argument and timeout to 5s

41712509eb-+-Revert "monitoring/graphite: Add until time limit argument"

10758edab6-+-deployment: set socket_connect_timeout to 2s

79b323fe12-+-monitoring/graphite: Add until time limit argument

936d10f0b3-+-wdq: Rename role to fit with autolayout

4d42f7db87-+-Fixup and move 'mediawiki_singlenode' role to role/deprecated

a23aad3b45-+-labs: Move db_aliases template into role module

37567bbeab-+-labs: Move labmon role to labs::graphite role

6d69b9a492-+-Rename phragile role and mark it as labs-only

8718fb1625-+-Make redisdb role conform to autolayout

8d4ad3e90b-+-extdist: Make role name autolayout compatible

0be22a0413-+-Move debdeploy role into autolayout compatible names

78e89853e4-+-Designate: No longer require paramiko

976101f5bd-+-magnesium: include standard

27e6d10990-+-Fix nsswitch_use_default to a string

ac0ebdcba8-+-Labs: Have fileservers no longer nsswitch to LDAP

3d069823b2-+-Labs: switch labstore NFS server to explicit LDAP

74982beeb3-+-Remove more erbium related udp2log stuff

b08498d1b3-+-Remove role::logging::udp2log::erbium and friends

647db6c774-+-varnish: get rid of some pre-systemd cruft

0890116161-+-role::labs::nova::master -- replace $certificate definition.

50e1627d4d-+-Switch primary designate host to labservices1001

d8be50f386-+-Rename the labsdns role to role::labs::dns

fe12341fd9-+-labs: Move dns / dnsrecursor roles to role module

48253ac3b6-+-racktables: remove role from magnesium

0162e4d93e-+-labs: Move vmbuilder role into module

ed500616b2-+-graphite: Clarify description of graphite_threshold for reqstats.5xx

0423b5d4b0-+-Replace ::all_networks that was dropped in a previous patch

48196734ee-+-labsdns::recursor use top level scope for ::network

def8ed6256-+-Further hiera-ize role/labs/openstack/

4b8f1391fe-+-Stop importing manifests/role/labs/*

ee10442f4a-+-labs: Cleanup and move role classes (part #1)

a177de03f9-+-ores: Move to using redis::instance

541a4ceb72-+-quarry: Move to redis::instance

41bcaf5f24-+-Labs: fix ordering of creation for lvm_volumes

a21ae0a0da-+-Tools: can't actually use ../init.pp in a subdirectory

cc8a3707e9-+-toollabs: make sure /tmp and swap are large for all exec hosts

303843eb48-+-monitoring: fail on graphite metrics using single quotes

4a19ca6613-+-grafana: disable gravatar integration

b403bf9d74-+-icinga: fix IRC output of paging/critical services

befc2c0bdc-+-Remove manifests/stages.pp

8f78bcd9f7-+-Add jq and tmux to standard packages; remove all other references

5866f4b918-+-nodepool add password include

85153440c0-+-remove labs::openstack::nova::common from nodepool

3321ccfb88-+-openstackclient  package declaration dupe

5eb14b5547-+-labs salt-master: Just pull designate_hostname right from a hiera global.

98667857a0-+-restbase: raise threshold for pending compactions

fad4184172-+-restbase: higher sstable per read threshold

7e6b7a937b-+-updates for nova hiera

2792fdccaf-+-hiera-ize labs openstack nova configuration

2b8d2493e6-+-Add ferm rules for role::mariadb::misc::eventlogging

073b21250f-+-labs: Removed unused 'swiftpartition' role

3b30e913ec-+-restbase: move to systemd unit file

ecd0cd3976-+-diamond: Restart service when the .py files change

66c971e90d-+-diamond: Add an sshsessions collector

e33246d771-+-Revert "Move puppetmaster roles to manifests/role"

924ba41cc9-+-Move puppetmaster roles to manifests/role

96873b58f3-+-labs: Use mysql directly in mediawiki singlenode

0082181f55-+-Remove old and terrible labs-mysql-server role

e3bb160144-+-labs: Kill the old labslamp role

1d6a0d97f5-+-racktables: puppetize /srv/org/.. directory tree

5b60a2378e-+-Removing all entries regarding analytics1003/4/10 bug: task tT118572

5aa40d8ba5-+-racktables: add role to krypton

c1d200776d-+-Use mtime instead of ctime when considering file retention, fix retention for mw-logs on stat1002

75240ede3a-+-Introduce seaborgium and serpens

3f3d761334-+-Remove old "openstack on labs" configuration

ba15e9b0a4-+-releases: load mod_headers for proto redirect

ffa9d9b8d9-+-Remove reference to eventlogging/EventLogging for deployment

64ef29c5ae-+-trebuchet: make the role a module

3bd5bf5e33-+-Use new topic interpolation format for eventlogging in labs

0c81df7e5f-+-contint: move iptables rule for zuul-merger git daemon

0d4a45053a-+-mattermost: Ensure that local imagedir is present

5d74cf04a4-+-scap: Create wrapper script for master-master rsync

d0c52cd91d-+-mattermost: Pull in matterircd from a deploy branch

a7becb7755-+-mattermost: Setup matterircd, an IRC <-> mattermost relay

39c258e496-+-mattermost: Make /srv/mattermost writeable by www-data

c9a68242c0-+-mattermost: Fix mariadb version number in role

1ca2c717a3-+-mattermost: Rejigger dependencies

e4afc19047-+-mattermost: Introduce module

4217b4c54a-+-labtestneutron2001 initial site typo correction

74f89e6b36-+-labtestneutron initial site definition

ec19b7054d-+-trebuchet set default master for realm handling

20819db88c-+-labs remove old neutron configs

eb33446e55-+-Revert "Display 'realm' during each puppet run."

e1d35cde73-+-Display 'realm' during each puppet run.

733010ffd5-+-toollabs: Fix genpp to use require_package

cd61279d50-+-labtest realm lookups for mail

38b8937ffd-+-Include role::labs::instance in labs via puppet

d95e130217-+-labtest realm introduction

1f8c9d19e9-+-mysql: fix the last double quoted strings

a13bd77872-+-labs: Set realm in hiera

57a4e97660-+-puppetmaster: puppet-lint fixes

7b8378d69e-+-Deploy eventlogging from new server code only repo

24a0aff132-+-phabricator: disallow crawling of phab.wmfusercontent.org

6d06b6288d-+-Can now require python-pykafka on all eventlogging hosts

847f5610fe-+-salt: Move the role manifests into role module

020b55050c-+-zuul: monitor git-daemon on zuul mergers

27bcf5506a-+-lvs: stop spamming bgp announcements from lvs1007-12

dd55453892-+-zuul: create git_dir parent directory

344ab99cef-+-contint: mount ssd on scandium on /srv/ssd

b614d2505f-+-contint: setup zuul-merger on scandium.eqiad.wmnet

1f3fd77521-+-Puppet compiler: bump version to 0.0.4

4e784595b2-+-Tools: Puppetize gridengine complex configuration

08f33a4aa2-+-Enabling ferm and performance schema on db1027 after maintenance

6f6a5761b7-+-phabricator: add ServerAlias for phab.wmfusercontent.org

d0840441ec-+-swift: set hourly commons upload threshold to 80%

8d77a2f39d-+-Explicit all mariadb versions for 5.5 vs 10

26dee0cd6e-+-Fix snapshot::cron::primary role include

44924ececc-+-Uninstall wpasupplicant

c3dbfba57c-+-puppetmaster tests: remove broken includes

f44442454c-+-k8s: Make the c in replicationControllers small

8ac4c0293c-+-k8s: Stop explicitly depending on the jessie-backports repo

28b4cfe0bc-+-k8s: Whitelist the resources namespaced users can create

3e6a590511-+-Delete ipython role

3490a001a7-+-simplelamp: Allow overriding mysql datadir path

c8da17c57f-+-mesos: Delete module

09270cd8e2-+-labs: Remove role::labs::lvm::volume (unused)

fc2698ee8a-+-labs: Remove the biglogs class

d955a6bd1d-+-base: Move mysterious_sysctl from webserver

f4140325e6-+-webserver: Remove randomly placed puppet files

f87f3c3c69-+-webserver: Remove webserver::apache:*

23883e9f35-+-webserver: Kill webserver::php5 class

69f58e3102-+-Put simplelamp/simplelap roles in autolayout

3af6d744a3-+-labs: Introduce role::simplelap

b891893970-+-netmon: Remowe webserver::apache

9ff377b2c5-+-labs: Remove webserver::php5 from old labslamp

f751501969-+-horizon: Stop using webserver::php5

6f8910c60c-+-openstack: Stop using webserver::php5

117b50a196-+-wikistats: Doc fix to not refer to webserver::php5

c393173fc1-+-racktables: do not use webserver::php5

b26d827b74-+-puppetcompiler/puppet-tests: mini lint fixes (meta)

2ca6c961d4-+-icinga: Stop using webserver::php5

32ca598680-+-rt: Stop using webserver::php5

991f16d149-+-contint: Stop using webserver::php5

1cbf08ae46-+-planet: Stop using webserver::php5

1210e5fdc0-+-wikimania_scolarships: Stop using webserver::php5

c4ec0b12a5-+-Revert "Revert "smokeping: Use apache::site""

26f4afdf14-+-Revert "smokeping: Use apache::site"

66748accf2-+-librenms: Move to apache::site

b2acbfb546-+-librenms: Kill old redirect

5673c4177d-+-torrus: Move to apache::site

991a685d25-+-smokeping: Use apache::site

dccaa4410d-+-migrate rcstream from redis::legacy to redis::instance

6f5a0eeecb-+-Add eventlog2001 to Puppet

b8a35a4d1d-+-xenon: migrate to redis::instance

9ad27dec59-+-statistics: Followup to I5c5ef877003

3b48fa4882-+-statistics: Remove redundant webserver::apache include

74ccce4b91-+-releases: Move from webserver module to apache module

a420285857-+-releases: Remove double include of base::firewall

e9ded6cfdd-+-mysql: Drop lucid support!

988da7a93b-+-mysql: Followup to I14cf84a4e7452

14ab274069-+-mysql: Disable apparmor in labs instances

a859c0dbd7-+-puppet-tests: remove broken inclusion of nagios.pp

96db302f73-+-mysql: Add jessie support by fixing conditional

f89f2702c4-+-labs: Add a simple LAMP role

2100a79fb9-+-lvs: double quoted string and other lint

2fe94a7412-+-interface: some lint fixes

6a9766d4e7-+-dynamicproxy: Don't set slaveof if it is not a slave

4ca8881998-+-dynamicproxy: Specify port number for replication

f020e1cffc-+-salt: add motd comment about keys on 2 servers

5b2ba3f33f-+-dynamicproxy: Don't try to restart redis when config changes

358b778283-+-dynamicproxy: Move to redis::instance

ec826e8a1f-+-etherpad: Add an autorestarter

264a384848-+-purging: do not VCL-filter on domain regex

290639a96e-+-upload purging: do not listen on text/mobile addr

349fabbb9b-+-Revert "Add resp.http.X-Client-IP -> webrequest:client_ip"

9943435cfe-+-Add resp.http.X-Client-IP -> webrequest:client_ip

321be03197-+-graphite: add metric tapping

c9fa443e37-+-Retain daily.* graphite metrics for longer (25y)

8a980b5ca0-+-Move scap-specific items out of mediawiki class

a0bc80e696-+-Adding ferm (and performance schema) to db1015 before repool

85bd2a533d-+-Remove plutonium from infrastructure

8d874ccf3b-+-redis: Add upstart support to redis::instance

1e15e72b0a-+-redis: Make redis::instance use base::service_unit

a471c022fa-+-redis::instance: qualify resource reference

f73cb4f612-+-Add redis::instance

10cf686906-+-base: minimal lint fixes

dc205a7089-+-role/lvs/balancer: double quoted strings

5dd6b1b70e-+-irqbalance: double quoted strings

b9886eb3da-+-role/lvs: double quoted strings

ab42f9d6f6-+-zookeeper,dynamicproxy: double quoted strings

caa4ef6aa6-+-redis: on systemd hosts, provision a systemd unit template

afc059f093-+-role::openldap::corp: fix typo

e3a3b55c95-+-ldap-mirror: Remove the vary on DC name to complete the migration

84f48e42c0-+-swift: use double quote in graphite query

f07c82acfd-+-role::openldap::corp: Add dubnium.wikimedia.org in ferm rules

fa54ae0d3d-+-Revert "deployment::server: move IPv6 int to role"

34440461fb-+-Introduce dubnium.wikimedia.org

ca907c83bd-+-tendril::maintenance: write crons on one line.

a662a9fdbe-+-tendril::maintenance: fix class parameter

1cee0ac4a4-+-tendril::maintenance: add missing file

dcb74888dc-+-tendril::maintenance: fix dependency

d983aadc35-+-Adding tendril::maintenance class

63505141b4-+-Enable ferm on db2010/db2030

0cb76d7db8-+-toollabs: Don't explicitly declare redis collector

e28de74e7d-+-Restrict LDAP access on the corp LDAP mirror

bc1d7ef6d8-+-openstack::common bit of refactor

1bb44cc97c-+-Catch up yet more manifests with labs role renaming

9e6253146c-+-Obvious typo fix

e723475193-+-Labs: Clean up and qualify some paths after the role renames.

ffa82186b0-+-Move some labs openstack classes into role/labs/openstack

5fef3e1565-+-contint: stop gerrit replication to gallium

83efbdb92b-+-Adding ferm to db1035, activating performance_schema

60cc2ea341-+-Drop role::zuul::production

10da9ea0a4-+-Move Package['redis-server'] and File[$dir] from redis::legacy to redis

3e089fec71-+-Mathoid: Enable texvcinfo generation

9726b7a302-+-make neodymium secondary salt master for all minions

1e67d2be99-+-docker: Restart registry when config changes

8abd09600c-+-docker: Use ssl for the registry

2e30f53b1d-+-pybal: add support for instrumentation

587c95f45d-+-docker: Make sure data directory exists

30ae52762b-+-docker: Fix registry package name

33dca58c4d-+-docker: Conform to puppet's stupid conventions

ab62f803b9-+-docker: Add role + class for setting up registry

51557110fa-+-Rename ::redis to ::redis::legacy

24faab2d67-+-delete abacist module/role; decommed and unused

db039d8ea5-+-decom abacist role

e065d27262-+-dynamicproxy: Do not include redis collector manually

6f7a2c556d-+-sentry: use $::mail_smarthost for SMTP_HOST

f04be87155-+-dataset: inline the non-role role classes

f4733db334-+-snapshot: create a proper role::snapshot

36fbf93836-+-Remove classes snapshot::common, snapshot::packages

3fc0ff2027-+-dataset: remove system::role from the dataset module

f947374e12-+-Enable SSL configuration on db1067

2daac0a3de-+-openldap: Allow configurable ACLs

beeb3e2f04-+-nrpe: fix description for monitor_systemd_unit_state

d9af4dc0a4-+-pybal: remove most confd-related references

d3df554c85-+-confd: don't exclude inclusion of confd in confd::file

94c950faa7-+-pybal: don't write pool files using confd

b38b9b237b-+-Enable ferm on the remaining kafka brokers

fb25ebf835-+-disbale git deploy/debdeploy activity on neodymium for now

9d07900b34-+-fix stdout/stderr shell redirection syntax - take #2

292600193e-+-swift: monitor mediawiki originals upload rate

7fc1bf6b71-+-Enable Redis Diamond collector

50af786538-+-contint: drop reference to pip.conf

5baa9b2f45-+-Replaces duplicate myspell-de-ch with myspell-de-de in ores/base.pp

2cd267e44a-+-labcontrol1002: make the nova controller role keyword work

6ae8db6446-+-Adds de, he, it, nl and vi *spell packages to ores/base.pp

6defe3b308-+-Move holmium and labservices1001 to the labsdns role

7bef8ad67d-+-Enable ferm on two additional kafka brokers

0a1c804835-+-tungsten: re-add to puppet,install as testsystem

2ece014c71-+-set up neodymium to be secondary salt master for testing

7015815c4d-+-fix stdout/stderr shell redirection syntax

6cfe28a4f8-+-Removing all lead polonium entries: site.pp entry role is spare but removing all together, updated smtp hosts to mx1001.wikimedia.org for hierdata and analytics.  bug: task T113962 Change-Id: I5f75d11723ecdf00734a1f876f82eb12ae7d8b34

c3888dcbe6-+-apt: enable backports on Debian systems

d99481cfbb-+-mediawiki: rename jobqueue alert 'job-pop' in 'pops'

63423d87b4-+-maintenance: run at most three wikidata dispatchChanges instance at a time

82a452b13c-+-peopleweb: remove migration role from rutherfordium

26171885cd-+-peopleweb: remove role from terbium

915e7e5e8a-+-misc: add rutherfordium and point people.wm.o to it

7457c0e96b-+-peopleweb: backup home directories

7f333ceb70-+-peopleweb: add motd message about public_html

9b26f2cf74-+-smokeping: add ferm rules for http to role

e6e25d9b3c-+-smokeping: create a role class, use role keyword

79585784ac-+-servermon: add ferm rules for http/https

eb4d9f1b80-+-Update servermon configuration for 0.7

4a3ca5da67-+-Use role spare for calcium

7e7fbfd96d-+-librenms: add ferm rules for http/https

b851da71b3-+-network: monitor mr1 OOB links too

f1ea8800dc-+-Add cr2-esams to monitoring tools

87bd8f6bcc-+-mediawiki: rename jobqueue.job-pop graphite alarm

693ac71025-+-zookeeper: Don't expose the JMX port in ferm rules

d06855ee1f-+-Enable ferm on kafka1014 again

655d72cc0b-+-Revert "Enable ferm on kafka1014"

a0ebb0f501-+-terbium: do not include noc

d5a6a3353d-+-Enable ferm on kafka1014

9738a0dc38-+-dbtree: move to its own directory

0f72c98f58-+-Kill CirrusSearch-slow-queries alert

45b5803c59-+-exim: Add and use $::other_site to provide LDAP fallback

4c26ea36bc-+-base: further clarify service_unit ensure

b0925edbda-+-Create a define to register extra LDAP schemas

e358a3a894-+-dynamicproxy: Fix typo

1ce8c226a1-+-dynamicproxy: Send log line metrics to graphite

4b2e59bf80-+-remove erroneous comments

ae8abcde7a-+-Add cli-shutdown.groovy from Jenkins advisory

a51ce2c89c-+-ldap: split client.pp into one file per class

b28959cd05-+-Deploy the new db20XX databases with the actual shards provisioned

ffa0aee753-+-Update mediawiki_CirrusSearchREquestSet camus cron

bb535f7b15-+-contint: get libgnutls28-dev on Jessie

c0c126b295-+-contint: explicitly set ssl/tls libcurl dev package

955faa2d8f-+-redis: install two additional redis servers

5db8a47f8e-+-uwsgi: Fix notify behavior

7fdc93fcf4-+-dynamicproxy: Tweak uwsgi parameters some more

94d0e7309e-+-dynamicproxy: Mount dynamicproxy API on a prefix

80e0985785-+-dynamicproxy: Explicitly specify callable for uwsgi

e147659bc6-+-dynamicproxy: Install proper flask package

f42775a240-+-dynamicproxy: Move invisible-unicorn into puppet

ab5e658c61-+-Add libcurl-dev to Python Jenkins

1bf954bd42-+-Install libjpeg-dev for diagrams in documentation

2015be754e-+-scap: Add co-master configuration

c008403467-+-Make host check_disk alerts optionally critical

64b31fd37d-+-osm: minimal lint fixes

ad06538a23-+-mw1152: allow connecting to labswiki database

ca805eaf00-+-noc: point misc-varnish to mw1152 for both noc and dbtree

62e960f08a-+-swift: don't wait for data disks on boot

025497a6d5-+-noc: puppetize dbtree directories

0ad788e0b5-+-noc: add role to mw1152

c529a5df64-+-mediawiki: extract php config from web::modules, use in noc

f6d8eafc74-+-noc: remove mod_userdir inclusion

74586582f5-+-noc: remove mod_cgi

d3d8a0b850-+-noc: remove unused ssl settings

76b3dcc47a-+-fully deprovision tungsten

2ffc62161b-+-openldap: Allow specifying an additional set of LDAP schemas

c8fe0508c6-+-terbium: move mediawiki monitoring

29787ea3f2-+-Revert "Remove /etc/wikimedia-image-scaler"

07db3216c0-+-dnsrecursor: Fix permissions for config YAML file

18881de4d7-+-labs: Open up nova API access to other DNS host too

b7a12b25df-+-mariadb: 32 lint fixes

4601bd7ffd-+-postgresl,sslcert: minimal lint fixes

fe8faa9897-+-labsdns: Fix typo in variable name

eb468703e6-+-labsdns: Include nova password class before using it

75adf0c190-+-LabsDNS: Stop hardcoding instance IPs in Puppet

28f79f8d29-+-openstack: Make designate use require_package

e3626e469f-+-logstash: no "if $hostname" in node blocks, use role

6311fb7b39-+-scap: lint fixes

aa4380a579-+-peopleweb: add migration class to rsync homes

f3b698d83f-+-peopleweb: add ferm rules, firewalling

706f677936-+-mediawiki: allow temp files to linger up to 2 hours after creation

7ac38c68d4-+-ores: Allow tuning workers per core for uwsgi

287ed9ce61-+-rutherfordium: include peopleweb role

d4e86c6a25-+-peopleweb: move standard include to role

43834ccf52-+-iridium system-wide gitconfig needs http.proxy

379250855f-+-Enable ferm for remaining logstash hosts

5f1ddc48c6-+-Enable ferm on logstash1004

9ddf3e0dd4-+-introduce rutherfordium.eqiad.wmnet

1f8dd93955-+-ganglia: remove jobqueue stats

084674a7f8-+-include eventlogging::package in webperf role

fe18b66a03-+-declare python-pykafka dependency for statsv

25165555bd-+-re-apply eventlogging role on hafnium

dc6adf4e98-+-openstack: some more lint fixes

d135b19bf9-+-re-apply webperf role on hafnium

f1c190ba7e-+-webperf: port services from upstart to systemd

16cb872232-+-deployment,aptly: minimal lint fixes

5290c19565-+-toollabs: lint fixes

93f008ea45-+-bastion: move 'standard' include to role

e7f33e9ab6-+-icinga: move "standard" inclusion to icinga::web

4b6797fb3a-+-apache: indentation of =>, minimal lint fix

b5195fa669-+-k8s: Move the ferm fules into the role

f39aea8daa-+-deployment::server: move IPv6 int to role

d3ca1623e6-+-eventlogging: fix indentation for lint checks

ca56abb760-+-miredo: minimal lint fix, add comment

708e6c899f-+-swift: no "if $hostname" in node blocks, use role

d0ae940a17-+-dumps,ganglia,nodepool: indentation of =>

c2926dc0ae-+-hafnium: switch from public to private IP

8f0e954af1-+-tools: Make home page check critical

11b28fcfd2-+-Do not apply eventlogging and webperf roles on hafnium

45b9912b26-+-Make mediawiki-config clone be owned by mwdeploy

b898497fce-+-swift: add new ms-be machines to eqiad/codfw

56cb14699b-+-Fixing eventlogging_sync process monitoring

5fa32edb38-+-Elastic: added an option to load bitsets lazily

c33240b171-+-graphite: enable labs instances archiver

e7a9093be0-+-Fixing bug with init.d script content

9242298096-+-authdns: minimal lint fix

f0df1ec45b-+-Migrate eventlogging_sync process from terbium to the slaves

42e8fadf19-+-cassandra: multi-instance aware CQL checks

78f790ec96-+-wdqs: indentation of => is not properly..

ee9c0bd278-+-gridengine: lint fixes

73ae47977e-+-analytics: impala,refinery: small lint fixes

5be2cfc530-+-adding cyrusone to allowed procurement domains

0ffb80f03e-+-analytics/mysql: fix arrow alignments

ffad7c4c74-+-snapshot: no $hostname checks in node groups, use role

f1e4db14a4-+-Enable the limn-ee-data report runner

f5e2a1c958-+-Revert "Revert "Apertium: Add missing apertium-br-fr""

15642a22ff-+-ldap-corp: Instruct openldap certificate usage based on DC

c6e8654f55-+-ldap-corp: Populate the per DC certificates

5bf965c858-+-role::openldap::corp: move into role module

c0ba48ce40-+-Monitor x1 replication on dbstore hosts

6326d5a221-+-maps: long description about tileratorui's statefulness

8a9257f41d-+-Remove /etc/wikimedia-image-scaler; obsolete as of If792de0112

79bede7c92-+-Remove /etc/wikimedia-site and /etc/wikimedia-realm

9b7cc9aca7-+-phabricator: Subscribe myself (=Krenair) to the project changes cron

2f5eca1225-+-phabricator::logmail: support an array of recipient addresses

f817055a3b-+-add /etc/wikimedia-cluster

9eb662c649-+-udp2log,gerritl,labsdb,camus: minimal lint fixes

fcb4b37f02-+-eventlogging,labsdns,redisdb: minimal lint fixes

66f202f945-+-labsdb1004 - use role keyword

9bd0b8802a-+-tin,mira: move standard to role class

95ecceb2c4-+-swift: minimal lint fixes

6012ee00dc-+-tin,mira: move base::firewall to deployment role

35e8ebe55d-+-tin,mira: labsdb::manager to role keyword

26dd1a0f7f-+-labnet1002: Use the role keyword

e9b80ca92b-+-labcontrol2001: Use the role keyword

73df9bfe09-+-remove old refreshWikiversionsCDB alias

852ba9e13b-+-dnsrecursor: minimal quoting fixes

562f4a3369-+-statsite,burrow,clamav: minimal quoting fixes

d7ee06893a-+-snapshot: minimal lint fixes

e58978df85-+-Include base::firewall in the phabricator role

160281ea17-+-labnet1001: Use the role keyword

4bbb16b09d-+-labnodepool1001: Use the role keyword

da3701a061-+-Update error page locations for Ibd8f69a54ac

e6c04f44bd-+-Increase hive-server2 heap size and update cdh submodule to allow this

b55a696a59-+-mediawiki::maintenance: create symlink to /srv/mediawiki

3cff2bb315-+-Enable varnishreqstats for all caches

90e97ed4f7-+-Use pbzip2 -p3 to compress Wikidata JSON dumps on snapshot1003

f38f90c176-+-etherpad: move base::firewall include into the role

c8c0360056-+-wdqs: Remove superflous include

acfb2e8f22-+-zim: Move base::firewall include into the role

a0c17d78b6-+-Move base:firewall include into the memcached role

dc6c9f8d4e-+-openldap: fix arrow alignment

28344fcae9-+-openldap: Use require_package

f8cb92f87a-+-openldap: Abide $datadir

70bc7d8a71-+-etc,redis,dynamicproxy: fix some lint warnings

d9a2b97925-+-palladium: Use the role keyword

21be829173-+-contint: restore unattended upgrade on slaves

91cb4bdc24-+-standard packages: add tshark (non-gui wireshark)

e6224f9fdb-+-maintenance: make purge_abusefilter run daily, not minutely for 1 hour

31279c8436-+-labstore: lint fixes

642ef8596c-+-Deploy varnishreqstats on all text caches

ac347b1b70-+-dataset::cron::job now runs rsync command via bash instead of sh

a53913c17a-+-Revert "Apertium: Add missing apertium-br-fr"

f3585c160b-+-base: reflow and expand parameters documentation

a1357ff077-+-Apertium: Add missing apertium-br-fr

9f6f8d41c8-+-maintenance: run purge_securepoll once, not every minute for one hour

0ff69082bb-+-maintenance: actually use the ensure parameter in refreshlinks crons

a04edbf43b-+-Include base::firewall in the mariadb::labsdb role

25039c6c1e-+-Enable performance_schema on db1065 (and user_stats = 0)

cfcf411b03-+-maintenance: actually ensure updatequerypages crons

a470e52420-+-fix typo in snapshots role class

83a5114e02-+-Generate weekly cirrussearch dumps

1f15bbd559-+-maintenance: include scap scripts in the role, they are needed.

fade9dfc59-+-contint: minimal lint fixes

6d665b4ce6-+-diamond,zotero,reprepro: small lint fixes

7d1502c6af-+-servermon,ganglia,gerrit: minimal lint fixes

32c481e189-+-lint: double quoted strings pt.1

4accec54b2-+-openstack: add links to docs for components, lint

1af974dae7-+-labstore: Include LDAP only in eqiad

06a375b6cf-+-Enable varnishreqstats on all misc and mobile hosts

cfa2ef23a4-+-Alert about the status of pageview and projectview

04d1f5f100-+-Aggregate from projectviews-*, not projectcounts-*

cc92506e61-+-Abstract rsync classes into a define, correct pageview to dumps synchro, add projectview

81551462a9-+-beta: point parsoid back to source code

d8c36098a4-+-Labs: reenable ldap on labstore*

2b39e9ee4b-+-contint: install nodejs-legacy on Debian

e0649b3e07-+-contint: scandium configuration

51b59c797e-+-gallium: migrate cluster/contact to hiera

9349faf83b-+-Use one node definition for both tin and mira

482a176511-+-reqstats: test on cp1065 (eqiad text) as well

0c08cb4ef2-+-Open up port 8000 for burrow (on krypton)

6ee05fbf3a-+-contint: set Zuul URL based on server fqdn

b3b02fd318-+-Enable ferm on tin

1c2692fc11-+-burrow: Add new module for burrow

b20d822947-+-role::statistics: fix file path

b634798a0a-+-Revert "cassandra: stop declaring service resource"

2585d9cff1-+-cassandra: stop declaring service resource

bbfdd02bbe-+-Enabling performance schema experimentally on db1022

58298d9949-+-mw1152: convert to be the HAT maintenance host

f1056521c4-+-mediawiki: group general monitoring scripts in a single role

643ef007d5-+-r::mw::maintenance: include role::mediawiki::common

197ade3290-+-role::deployment::server: drop mod_dav

cff59326bb-+-role::deployment: remove test role

71086a77c0-+-deployment::mediawiki: rename wikitech::wiki::password class

79c893708e-+-role::deployment: move things to deployment::mediawiki

efa625b074-+-role::deployment::server: reorganize code

b28677bfbf-+-role::deployment: move to role module

0acb62e4bc-+-labs kvm ssl cert monitoring: fix nrpe command

35fcddf702-+-labs kvm ssl cert monitoring: fix it

a7a350eb09-+-logstash: fix double quoted strings & alignments

151fa248d6-+-tools: Make main page check in icinga

cefb1f9e3d-+-Revert "Revert "dynamicproxy: Make blocked user agents configurable""

1f6a1e7b31-+-contint: install rake on Nodepool instances

99508b9603-+-Add monitoring for the kvm ssl cert, labvirt-star

b58dcbddce-+-Reenable DSH checks for codfw, uncomment hosts that are up

4ced3878db-+-Publish the new pageviews dataset to dumps

90e21b8264-+-install/deploy scandium as zuul merger (ci) server

d8f2073998-+-Move dsh code into scap where it belongs

f525ee2024-+-Update camus runs

19026577f3-+-Improved the 'buggy kernel' error message for labvirt nodes.

aab1db07a0-+-Make labvirt1011 a compute node.

90fb6c4381-+-Use force => true for /usr/share/diamond/collectors/$name diamond collector

e668a436ca-+-varnishreqstats: fix instance_name corner case stuff

f4814be21c-+-monitoring: append sms to contact groups, don't override with admins,sms

5e2d93c643-+-openstack: cleanup up old repo setups

f64ff16ed6-+-Revert "dynamicproxy: Make blocked user agents configurable"

99d4ba1ddf-+-cassandra: switch to monitor_systemd_unit_state

46f2b0dee7-+-Set instance name specifically for varnish misc

af41c5323a-+-Fix varnishreqstats dependency on varnish service

35be29ea22-+-phabricator: Set security ext tag for labs

dd9078782b-+-wikitech: make private settings file writable by owner

fd03063af6-+-Rename mediawiki::web::sites to mediawiki::web::prod_sites to make room for a new generic sites.pp

edb5baa8d9-+-dynamicproxy: Make blocked user agents configurable

408d481d41-+-Fix param name for reqstats

0c2c477685-+-The varnish reqstats diamond collector does not work, emit to statsd directly instead

845f25d7b9-+-otrs: Ship systemd unit file for OTRS Daemon

9a5471e6f3-+-HTCP: split multicast for cache clusters

f789c42cfb-+-vhtcpd: refac args template, allow multiple mc addrs

eaad9c45ee-+-Revert "Revert "Replicate pt-heartbeat table to labs. Stop replicating msg_resource""

2320791be2-+-Revert "Replicate pt-heartbeat table to labs. Stop replicating msg_resource"

97cd5c5a53-+-Replicate pt-heartbeat table to labs. Stop replicating msg_resource

534deabcef-+-maps: some puppet-lint fixes

a4d4508e11-+-mailman: remove check for out queue [+data cron]

42e0d2846b-+-ssh: Allow customizing authorized_keys_command

9b052abdd7-+-Enable the wdqs service per default

5997a2c324-+-interface: do not 'ensure latest', use require_package

bf42025811-+-puppet: do not 'ensure latest'

2668e86622-+-Mark rubidium as spare

3525a2fdac-+-Use testsystem role for ruthenium

7a80749834-+-adding in globalsign to procurement approved vendors

bea4ef3fc0-+-Restrict access to deployment redis to internal plus silver

ed59e65890-+-Move the ferm rules for elasticsearch internode traffic into role::logstash::elasticsearch

4c3be700ec-+-releases: move base::firewall into the role

987c66c3ba-+-Disable all diamond varnishreqstats collectors

5ea06e379c-+-dataset: move system user creation to module

15150d41d3-+-Remove class role::dataset::publicdirs, noop

86f3c4f1ec-+-toollabs: install libsort-fields-perl

7bcf7c677f-+-puppetmaster: Move the role into the role module

918b92bd5b-+-Move base::firewall into the archiva role

89fada3394-+-Move the base::firewall include into the impala role

88a5f8620d-+-gdash: add notice pointing users to grafana.wikimedia.org

dbd280301f-+-Replace dynamic gdash.wikimedia.org with static mirror

39c086b6bd-+-Fix w-beta.wmflabs.org redirect

4702e0919c-+-Configure nova's nutcracker not to eject hosts

9be9570f03-+-updating procurement project direct domain emails

09ab6dcb87-+-Don't create an explicit nova partition on labvirt1010.

f9fd81e0ff-+-es: Remove maint scripts and add scap::scripts

d0bd9a3250-+-Make labvirt1010 a compute node.

36c85a4ba5-+-scap: Allow nobelium to run scap

f9702bbf29-+-mw: Make initial scap run as mwdeploy user

3934d28254-+-elasticsearch: Setup partial MW install on nobelium

b6eb0024a6-+-Adding new installed servers to the mariadb::core role

0a76ef93e5-+-Fix getJobQueue cronspam

6f23ae3c0c-+-diamond: enable ntpd collector across the fleet

c7ef5a45be-+-RESTBase: Set up the AQS public API

b50c14e60e-+-Initial puppet config for labvirt1010 and 1011

1455d24ed9-+-Add a cron job for reporting the job queue size to Graphite

25f03ef754-+-mailman: run qdata cron later into 8am bounces

cfc47a8b1c-+-Revert "dumps: move ssl cert and config to role"

2c9bd314ee-+-dumps: move ssl cert and config to role

85eda43f70-+-Restrict access to redis on abacist

779e2dd2ad-+-Remove auth.login-message - not supported by upstream anymore

fb14a67bc5-+-icinga: Provide a check_gsb command and replace old commands

ccbc917674-+-Don't enable ferm on logstash1004 yet

8c860f096b-+-Enable ferm on logstash1004

99e5d2a5b9-+-subra/suhail: Use the role keyword

ecd73cf246-+-site.pp: remove virt100[1-9]

c8cfd9d74d-+-Remove manually set salt grains during initial testing

3c40bb5159-+-aqs: Add LVS configuration

f37c54a69b-+-RESTBase: make the port fully configurable and change for AQS to 7232

88ea067000-+-cxserver: Add JWT token support

e675b56d23-+-maps: Add tileratorui service

81c1ad3a9d-+-Add Diamond collector for HHVM APC stats

02e7be38d9-+-Revert "openldap: add SSL cert expiry check"

76c97c5584-+-Reclaim einsteinium.eqiad.wmnet for spares

9ade91b81a-+-wmfusercontent.org - add ssl cert expiry check

033dcdaefe-+-openldap: add SSL cert expiry check

2df6b60c7c-+-ldap: top-scope variable, mini lint fix

0736c0059f-+-Remove trebuchet user from wikidev group

7be7062c27-+-ldap: add ssl cert expiry check

abbeac8aec-+-grafana: automate the creation of the Anonymous user

bb537ff55c-+-wmflabs.org - add ssl cert expiry check

3d0678a0cb-+-planet: add ssl cert expiry check

b944380978-+-toolserver.org - add SSL cert expiry check

a505e533c7-+-eventdonations: add SSL cert expiry check

10b27e554e-+-icinga: ssl cert checks for external services,pt.2

b04790bf3d-+-icinga: ssl cert monitoring for external services

d0abb25937-+-gsb: Another try at fixing it

9ec53e022c-+-rcstream: add ssl cert expiry check

970280acdb-+-archiva: add ssl cert expiry check

e43003917a-+-service::node support overriding the repository

0ca50e0a7c-+-gsb: Amend check command

38a1e93246-+-fluorine: Use the role keyword

96417cfac0-+-archiva: use the role keyword

1433a0f05b-+-gadolinium: Use the role keyword

9e80cb9ae8-+-erbium: Move to using the role keyword

52eaa89c7e-+-eventlog1001: Use the role keyword

e5cf37b651-+-Move the authdns servers to the role keyword

d86f707b32-+-Use the role keyword for puppetmaster backends

56675d89b9-+-statistics::cruncher: Move standard and base::firewall includes into the role

7bf081751a-+-Use role keyword for dbstore hosts

8b914af36a-+-Move base::firewall include into the otrs role

825f0ef519-+-db1047: Use the role keyword

b2462aa1b4-+-db1069: Use the role keyword

669f8551a8-+-Move dnsrecursor to the role keyword

5dd42c70d9-+-stat1001: Fully use the role keyword

8649cb5a09-+-labsdb100[1-3]: Use the role keyword

82171db342-+-terbium: Use the role keyword

b4db7ceba7-+-pc100*: Use the role keyword

b29495be5b-+-Revert "Enabling performance schema experimentally on db1018"

9fe414bf3d-+-hafnium: Use the role keyword

b1bc8b5289-+-Enabling performance schema experimentally on db1018

1387aca8c9-+-conf*: Convert to fully use the role keyword

c8449d423f-+-etherpad: align X-Real-IP logging configuration

c860c81e45-+-graphite2001: Use the role keyword

27652786b1-+-graphite1001: Use the role keyword

1417623250-+-potassium: Use the role keyword

6a742fd855-+-protactinium: mark as role spare

17adc13367-+-ganglia: add ssl cert expiry check

a0815a18a6-+-Fix Wikiquote check to check the real domain

9d709f6da5-+-Switch safe browsing checks to HTTPS

dd05340376-+-Revert "planet: add ssl cert expiry check"

221656ebec-+-Update safe browsing checks

c2c0da3cec-+-tendril: rename monitoring check

cb2c95ca29-+-librenms: add ssl cert expiry check

cb1ce71486-+-tendril: add cert expiry check

e002117d4a-+-RT: replace HTTPS monitoring with new method

464606d6d9-+-planet: add ssl cert expiry check

3d601c109a-+-dumps: add cert expiry check

42ac7e545f-+-Allow access to the Yarn manager UI from the entire internal network

9791cfdd8e-+-mw_rc_irc: rename module to standard naming

a7ab6fe7d2-+-install2001: Use the role keyword

6c9177c132-+-hooft: Use the role keyword

dd480e9d26-+-icinga: add cert expiry check for icinga itself

e78680f1bd-+-Logstash: track apache2 syslog error rate in statsd

4116d3dfd6-+-icinga: move ssl cert install to role

610db38d5c-+-californium: Move to the role keyword

500699442c-+-carbon: Move to the role keyword

f4406c50cd-+-iron: Use the role keyword

10976b070e-+-netmon1001: Use the role keyword

7fd433be96-+-neon/icinga: use the role keyword

0375af0614-+-nitrogen: Use the role keyword

6ad3bb4e41-+-tendril: Use the role keyword

8046ac3d7e-+-krypton: Use the role keyword

e23af8af1b-+-silver: Use the role keyword

92ff5a9190-+-Revert previous changes to make sure file_mover has uid and gid 30001

e2484515fb-+-mailman: increase out queue to 300 check

4f50e5e24e-+-Log OOM rate and HHVM-non-OOM error rate in statds for graphing

81989aad53-+-planet: Use the role keyword

dc9ecd2ed9-+-Remove uid setting from file_mover user.  enforce-users-groups-cleanup was removing this

5daa4c1819-+-Set file_mover primary gid by name rather than number

0a742af6ba-+-monitor should use the new dblists location just like rest of dumps

0920bf5d2e-+-lithium: Use the role keyword

d333e7ed42-+-phab: bad package name for dep

02a795c38d-+-Add --percent-lost flag to refinery data check

9b5d4922fa-+-Phabricator: Fetch all references in Git

a238d4b679-+-bromine: Move to using the role keyword

ac0cc1f184-+-tor: Use the role keyword

dc3a1779be-+-Remove unused role::cache::logging::eventlistener, add comments describing different varnish loggers

443e8ae5c5-+-Deploy VarnishReqstats diamond collector on remaining cache hosts

c6bc23050f-+-mark graphite1002 as testsystem

96e906edd3-+-argon: Move base::firewall include into the role

45c1204449-+-Enable ferm on analytics1001

692113d7e3-+-wikitech: add SSL cert expiry monitoring

17c918b794-+-Apertium: Add apertium-isl and apertium-isl-eng packages

b43dea9936-+-gallium: Use the role keyword

8bc2fa1c9a-+-Mark multatuli as spare

0ae88c4a97-+-gerrit: add cert expiry check

83fd52e637-+-ntp: do not 'ensure latest'

cdb462294b-+-argon: Use the role keyword

350b02278a-+-bast4001: Use the role keyword

67fe3b98b0-+-zuul: Add zuul-test-repo helper script

ea1709c464-+-mailman: add cron to gather queue data

5ae9766488-+-bromine: Move the base::firewall includes into the roles

2533493d50-+-mailman: script to dump queue data to HTML

2e1a45c0f8-+-graphite: set a low xFilesFactor (0.01)

b064bec200-+-Remove dsh from bast1001

db6ed08631-+-analytics1017 is now also a spare

9ce40c96d2-+-Mark analytics1021 as a spare

74f04e4ec7-+-Add Varnish reqstats diamond collector for upload caches

c3bc5370dc-+-Remove explicit includes of role::diamond and role::ntp

ae9f4aede3-+-Use the role keyword for the major roles on analytics1027

6b344e8640-+-Use the role keyword for analytics::mysql::meta

c0712e43b8-+-openldap: Use the role keyword

6e186cc066-+-osm: Use the role keyword

a608fdfd94-+-Move base::firewall into the syslog role

ff5d95864a-+-backup::storage: Move base::firewall include inside the role

cde215210c-+-cassandra: allow default instance overrides

bb9c537b2a-+-dnsrecursor: Move base::firewall include into the role

fd3d3a1e9d-+-Move base::firewall include into the openldap::corp role

cdf311740a-+-wdqs: Move the ferm rules into the role

a257c4e4de-+-Move base::firewall includes for roles on krypton

bcbc563342-+-imagescalers: move base::firewall include into the role

d75982d50c-+-videoscalers: move base::firewall include into the role

1ede4768d6-+-package_builder: Mute cron update commands

7e77d9d37c-+-etherpad1001: Use the role keyword

2af0da357f-+-package_builder: Keep environments updated

6df1d1658a-+-aqs: Include base::firewall in the role

c09ff0ae92-+-smokeping: Don't ensure latest

03f5fb806c-+-Make spare role include base::firewall

38f4678a6f-+-uranium: Use the role keyword

e517da0f28-+-Apertium: Add new language pairs for Apertium MT

ece5ed5e74-+-Use testsystem role for pybal-test*

df9ca96a73-+-Move base::debdeploy into the base class

94029328bc-+-heze: Use the role keyword

4cbacc67e8-+-helium: Use the role keyword

84438b04c8-+-Move base::firewall include into the racktables and rt roles

caf80020e0-+-labs-vagrant: Add a stub labs-vagrant command

417c1a8b4b-+-RESTBase: make the domain to monitor configurable

f9f56d0600-+-toollabs: install mailutils

1fbe1d130e-+-k8s: Make ssldir configurable for k8s master

a15672ddc7-+-add ferm rule opening port 80 for grafana

e1c7a76b8d-+-Move base::firewall include into the gerrit::production role

6320b9bd2c-+-deployment: use ferm::rule, not ::service

9d4c5c3026-+-deployment: use the same ferm rule as mediawiki

2ed57abfbc-+-Mark old MXes as spares

0c68745a5b-+-Move base::firewall include into the mx role

119acd7282-+-toollabs: add composer to dev hosts

468aa58325-+-Add roles for marking unpuppetised test systems and unused spares

93fe1c7333-+-tor: Move the ferm rules into the role

5adaa219aa-+-grafana: override the default home dashboard with something custom

bb3c4e87af-+-grafana: provide the ability to provision dashboards via Puppet

3417766664-+-Include base::firewall into the planet role

ba5e0589f4-+-Openstack:  Don't notify keystone when the keystone policy changes

c1a13849aa-+-Set up regular backups for the Grafana database

00077d12b5-+-Enable diamond reqstats collector for all mobile varnishes

340ede2db7-+-decom tessera

962c422207-+-Add dblist to many paths

dfb612ede8-+-Turn on varnish reqstats diamond collector on eqiad mobile caches

f3f0b1c6e9-+-Fix scap firewall rules to allow connecting to mira over IPv6

3a97af0931-+-grafana: enable gzip

e8668813ce-+-Drop Grafana 1.x; promote Grafana 2.x

c76cec2d4e-+-provide a public, read-only view of grafana

ce914f8683-+-Ensure mdns and pool-manager services stopped on backup designate server.

42f4eadd7b-+-Only use TcpConnStates diamond collector on parsoid and parsoid varnish hosts

afb2159983-+-grafana2: don't allow users to create orgs or accounts

d5b73ce371-+-grafana2: users.auto_assign_org_role = Editor

de5ddb0466-+-graphite: update CORS regex for grafana-test.wikimedia.org

bb78b4fc07-+-grafana2: rewrite REMOTE_USER envvar into X-WEBAUTH-USER header

b52c423d4d-+-vagarnt::mediawiki: Ensure clone before adding config

2ee516bbd9-+-Designate: Explicitly turn off designate-pool-manager and designate-mdns on the inactive spare

ab27e09024-+-grafana 2: disable auth.basic

4c04b2e4b1-+-Add ini() to stdlib

fd2ddd4c46-+-Fix-up for service stanza in Idd37460a

2cb1c817fa-+-Provision Grafana 2 on grafana-test.wikimedia.org

f96c0fbc04-+-Inline class nfs::data to snapshot::common

538ab5c7c1-+-Remove nfs::common, replaced by require_package()

916560442a-+-Remove nfs::netapp::home(::othersite), unused

eb95690d77-+-Move apt-transport-https to install_server

c8a35e45cd-+-reprepro: import from grafana apt

d482f7d2a5-+-Make mx1001/mx2001 to HTTP POST to meta.wikimedia.org

6c98174d50-+-Remove integration-puppetmaster from the labs monitoring hosts

82f482c1ea-+-aptly: Mark aptly repo as trusted

b04ee3683a-+-aptly: Add ability to mark a repo as trusted

666c51faf4-+-tools: Use the proxy-infrastructure account for kube2proxy

69a68fb117-+-k8s: Fix path to ssl cert path for kube2proxy

7aada8168d-+-k8s: Remove extra k8s::ssl include

15de50c9de-+-k8s: Setup ssl certs to be owned by kubernetes user

6ca8191a95-+-k8s: Fix kube2proxy to be nicer

e316912e03-+-k8s: Pick up client password from secret hieradata

ab88a40f7f-+-k8s: Use secret hieradata for managing users and tokens

eaa2fd0c3c-+-labsdebrepo: Fix names to match file paths

38fbecb156-+-dynamicproxy: Do not depend on labsdebrepo!

e4770652e2-+-k8s: Move abac to puppet + hiera

e1eb7394a5-+-puppet: Have a 'secret' repository for self hosted puppetmasters

eaa9d7c367-+-vagrant::mediawiki: Make port forwards public

d19d7cc8b5-+-Update a couple of firewall rules to include mira alongside tin

1d7facb9e4-+-move misc/labsdebrepo out of misc to module

1812823efb-+-Add cron that schedules camus imports for mediawiki Avro Binary data

62a9d349da-+-toollabs: lint fixes

b3358fcdec-+-vagrant-lxc: Update sudoer rules for v1.2.0+

ecdea8512f-+-nrpe: convert contact_groups to hiera

7a8c79e804-+-base: don't set contact_groups unless they override icinga defaults

fdeb2e898f-+-icinga: ensure hiera lookups for all contact_group defs

b2f488ddc1-+-lists: move base::firewall include into the role

0de8fc7f30-+-releases: Move the base::firewall include into the role

799fec9b38-+-vagrant-lxc: Fix sudo rule for finding lcx command paths

56b93696bf-+-lists: use more sane values for queue checks

1c6ef25d5b-+-phab: manage phab-ssh service

ef1f147e4b-+-Logrotate camus log files

2e0aa96de9-+-Remove unused camus cron job

3c1adf6c6f-+-Use camus::job for webrequest data import

4590ef3828-+-Suffix each kafka broker with :9092 for camus::job

79d861de1e-+-Add camus module, use camus::job to import eventlogging data

27960cbe5e-+-Migrate initial manually configured debdeploy grains to values read from Hiera

5c5fd4af15-+-phab: set diffusion.ssh-host for diffusion

c6c052ba76-+-Only create salt grain for non-empty returns from Hiera

a5c20787fe-+-varnish: minor lint fixes

70f2f8d169-+-phab: vcs user manages ssh interaction

62dce6af7c-+-Fix phabricator basedir in vcs.pp / phabricator-ssh-hook

68295774cd-+-Remove debdeploy grain for now, needs additional handling for systems without a value set via Hiera

4306da13ec-+-Hiera-based assignment of grains for debdeploy

d49f262705-+-RESTBase: add global domain and Mathoid spec

d3d2ed7ef0-+-maps: reorg the role classes

9efed5c7ea-+-tilerator: comment about the port argument

847c76db89-+-Diamond: enable TCP collector

83f943a876-+-deployment: fix firewalling for sync-file/scap tin

defba44cc3-+-deployment: fix firewalling for mira pt.2

b82d0565c3-+-deployment: fix firewalling for mira

1f7e0dbd06-+-mailman: queue monitoring, enable multi thresholds

078e02d139-+-mailman: rm sodium remnants, hardcoded IP

5753d28538-+-SSH repo hosting support for phabricator.

08d21844fe-+-phab: manage iridium-vcs address and allow in fw

1785ebbab6-+-Remove no longer used  monitoring::ganglia 'hadoop-hdfs-namenode-primary-is-active'

9303e96438-+-Remove monitoring::ganglia hadoop-hdfs-namenode-primary-is-active

136be65d8a-+-Nagios should sudo when nrpe running check_hdfs_active_namenode

30604093ea-+-Allow nagios user to sudo to hdfs to run check_hdfs_active_namenode

b7f9c5d313-+-Update cdh module with check_hdfs_active_namenode script, set up nrpe monitoring

ae4cddcf70-+-varnish: get rid of old ensure=>absent on dead VCLs

3109cc8f8b-+-maps: Deduplicate the roles

1d86ca2847-+-Move all X-Analytics code to analytics.inc, include in common VCL

30d619c9d4-+-Add TcpConnStates Diamond collector

021492f4e0-+-Amend ferm rules for app servers to drop exemption for port 6380

4ed9cf9868-+-Don't open up the Kafka JMX port for debugging

844f74c996-+-Remove session-redis cluster definition; unused

f1c14c073a-+-Revert "mw_rc_irc: rename to standard naming scheme (underscores)"

06aa85191a-+-mw_rc_irc: rename to standard naming scheme (underscores)

439ce16067-+-argon: add base::firewall

c8cbfa91d7-+-mw-rc-irc: firewall rule for Apache

64e7893b28-+-mw-rc-irc: firewall hole for RC IRC bot

578bd80e16-+-Make the 'sessions' redis cache multi-DC ready

c21e981c23-+-logstash: access to port 9200 for krypton

b3bb5614ff-+-Configure hadoop master and worker to send jmx stats to statsd

d4fe669049-+-wdq_mm: rename module to standard naming (underscores)

bb28912b6e-+-nodepool: use nrpe:: class for monitoring

d85a43001a-+-labstore: Add a delete-dbuser script

a2c22e4ba5-+-Openstack: Added a custom keystone/policy.json

235c176cd5-+-archiva: move ferm rules into the role

901ed91de6-+-Revert "restbase: ensure service present"

3f70fd4a60-+-restbase: ensure service present

f86e785866-+-Consume EventLogging validation logs from Logstash

cc18d0293b-+-Don't open up the JMX port for debugging

b10cc0bbc8-+-nodepool: monitor nodepoold is present

03469d4ed8-+-Enable ferm on analytics1002

5be299e785-+-cassandra: bring in instance variables from top scope

39c7c2388a-+-cassandra: finish merging multi-instance

e92fbca318-+-cassandra: conditionally add rpc_address to rpc_interface

905963bb88-+-cassandra: fix config_directory ownership

c03e773162-+-cassandra: enable multi-instance

dcec9e219d-+-memcached: move ferm rules out of the module

0c17d6d509-+-cassandra: simplify $blacklist validation

d74d8eaf39-+-cassandra: new metrics-collector version

e91a17607a-+-contint: remove pylint/pyflakes packages

23e06a4e33-+-Update cxserver Parsoid configuration.

a8424754e3-+-openstack: Add log-rotation for designate-mdns and designate-pool-manager logs

2a35890c3a-+-memcached: move ferm rules out of the module

7fe3129fa6-+-ishmael: remove module, decom service

e326f33821-+-Openstack: notify mdns and pool-manager of designate.conf changes.

030a97ac0a-+-clamav: fix proxy support

a067bc1147-+-swift: aggregate and report container object/byte stats

c63c5f6bfb-+-freshclam: populate proxy settings

c3991bff1e-+-aqs: analytics_networks is IP subnets, no resolve

3ca051a279-+-aqs: join $analytics_networks on a whitespace

b52e6f1117-+-aqs: Fix typo introduced in 22ead0c

22ead0c75c-+-aqs: Allow CQL access from analytics

e37e79857a-+-Revert Varnish X-Analytics and netmapper changes

c642d16052-+-puppetception: Remove module

d200332d2a-+-Move all X-Analytics code to analytics.inc, include in common VCL

f69c342953-+-tools: Remove ensure => absents

e70acf7c4c-+-puppetmaster: Remove an ensure => absent

55fa73b185-+-toollabs: install hugin-tools

0d1ed65d2c-+-k8s: Adjust ssldir for self hosted puppetmasters

0aadb68cc8-+-labs: Update split horizon for new proxy IP

94ff86c363-+-tools: Do not shadow 'puppetmaster' from elsewhere

ab43ea54fb-+-labs: Don't explicitly include base::puppet

9115b0aa5e-+-tools: Fix typo

d0fb7449a5-+-puppetmaster: Quote variable inclusions

12d1f92134-+-tools: Add puppetmaster/client roles

db46e73961-+-labs: get zip via 'require_package'

d1c3b4c111-+-lint: fix the last "variable not enclosed"

9def247989-+-contint: fix bundler package name on Jessie

2d16bffefa-+-tools: Move toolswatcher into puppet

ac1344f783-+-lint: fix 'variable not enclosed' pt2

0f01f5743d-+-lists: extend check_smtp check to TLS as well

90dbb02336-+-Revert OCSP stapling to roles mail::mx and lists

9614ed8ae4-+-lists: add OCSP stapling to role::lists

2fae676c24-+-mail: add OCSP stapling to role::mail::mx

73312d6a48-+-tlsproxy: inline ocsp_stapler, rename ocsp_updater

ce6fcee84b-+-Move tlsproxy's OCSP stapler/updater to sslcert

ece1141810-+-elasticsearch: Use the default elasticsearch role for nobelium

3a35db97bb-+-tlsproxy: add support for update-ocsp-all hooks

1cdd5ac6f9-+-tlsproxy: switch update-ocsp(-all) to config files

6ea511fa15-+-tlsproxy: fix a couple of OCSP-related dependencies

75f59fd133-+-Fix a couple of recent lint regressions.

9cf2ce1ab8-+-icinga: define en.wb.o host

a470b5b5b0-+-check legal html for en.wikibooks as requests

819098aa72-+-Move Ruby related packages to a separate file

6846e20b53-+-contint: resurect contint::browsertests

946d96e242-+-otrs: disable the scheduler watchdog

5f803d5a27-+-Move ferm rules out of the module, part 2

e38c0b98bf-+-aqs: change contact group to analytics

d7086edc36-+-sslcert: add preamble for sslcert::dhparam

0397b6e4dd-+-Move ferm rules out of the module

29bd45f080-+-cassandra: add multi-instance support, disabled

ec92b31a00-+-dbstore: Set Replication alerts to not page

7abf93ef99-+-graphite-web: set REMOTE_USER_AUTHENTICATION = True

ae6ead323e-+-Changing tmpdir from /tmp to /srv/labsdb/tmp

74f0155444-+-Include nutcracker in snapshot::packages

1d0edcb2de-+-dumps monitor config: skip labswiki, not reachable from snapshots

39375f9bdc-+-create cache dir for staged dump runs

717e9d5d5b-+-Add Analytics Query Service role

0a7c18f322-+-addschanges dumps: skip labswiki, not reachable from snapshots

e2c0dc5d16-+-page title dumps: skip labswiki, it's not accessible to snapshots

5485e20f76-+-analytics:  modernize the ensure => link syntax in a couple of places.

abea997e57-+-labstore:  rearrange args to cleanup_snapshots

24399a9416-+-Disable NFS lookup cache on NFS client instances

f0f92b7942-+-Varnish: Add lint:ignore:quoted_booleans around a boolean that needs quoting.

1423255184-+-Cassandra:  dequote some booleans.

e40ab97f1b-+-Create ferm rules for Hadoop NameNode and ResourceManager for master and standby

a155fd70b4-+-Add the new OTRS scheduler watchdog cron entry

ce786eada5-+-otrs: Ship systemd unit file for OTRS scheduler

46b5dd43e0-+-Adding ferm::mariadb role to labsdb1004 (tools slave)

f346e120e1-+-Add ferm rules for Spark

14cfdf8591-+-labs: Failover tools-webproxy to tools-proxy-02

cfcb917452-+-move zerofetcher to r::c::base

d58adb6936-+-re-enable zerofetcher for cache_text T111045

b32cf7f601-+-fix minutes for zero cron

61643b838f-+-zero_update: randomize cron every 15 minutes

1dd6fb7555-+-lint: fix 'variable not enclosed' warnings

bf6f1657ce-+-Change a few rsync params from true/false to yes/no

815e1d736d-+-dataset: Remove needless quotes around a 'true'

bef5a0043c-+-Dequote one more nrpe critical setting

705e2cd5fb-+-Disable quoted_boolean lint check around is_virtual refs.

6669c74bec-+-Diamond:  Turn off lint check for quoted bools.

8409861dac-+-Webserver ca:  disable the quoted-bool lint check

585b5a1764-+-webserver::php5 unquote a boolean.

90a7c44c5c-+-Mark salt grain bool values with # lint:ignore:quoted_booleans

c93c975138-+-Gerrit role:  dequote booleans

c65f952b36-+-Grafana:  dequote booleans.

e7e3341b81-+-interface:  dequote booleans

c82beff82f-+-nodepool: rename ssh keys files to default

80f0a4dc5f-+-phab: turn dump cron back on as it hits slave only

8c9c04e0a4-+-Include python-mwclient (latest) on exec nodes.

a85026f7b5-+-Lower the conntrack tracking time for TIME_WAIT connections

163b07ad67-+-otrs: use hiera to get configuration values

5942960652-+-cassandra: ship systemd service file

1683abb9fe-+-kube2proxy: more fixes

ac3a1998cb-+-add globalusage table config info for dumps, T87571

78c081fbd6-+-otrs: add support for Apache's mod_remoteip

553068bc4f-+-tools: Fix ensure checking in kube2proxy

242439e352-+-toollabs: Cleanup kube2proxy

b5e28e608b-+-kube2proxy: various puppetization fixes

a98ffb0f79-+-phab: phabtools.conf add slave option

47d7c661cf-+-phab: apachetop for debugging

981aaab73b-+-Brown paper bag fix for interface::ip $options

1212ad0622-+-Blacklist Analytics schema from being produced to the eventlogging-valid-mixed topic

e8ce756619-+-Mark wiki-mail IPv6 addresses as deprecated

c6ee5e2bff-+-wikidata dumps job: use group www-data which exists, apache doesn't

28caf51b94-+-kube2proxy: remove explicit dependency on python-requests

9d3a894885-+-misc-web: Get otrs-test.wikimedia.org behind it

0087d41b87-+-kube2proxy: change service name

74d21f7650-+-kube2proxy: fix hiera variable name

571df92c8d-+-kube2proxy: fix typo

454553d1f3-+-kube2proxy: fix systemd declaration

f339972094-+-Add labs-recursor1 as a secondary nameserver for labs instances.

b4b3223e49-+-dynamicproxy: add support for kubernetes

311b6bfbdd-+-otrs: add missing perl modules for OTRS 4.0.13

5e2835cea7-+-Set analytics mariadb replication monitor to non critical

812f280d16-+-tools: Provision puppet CA for k8s webproxy

9502bd30dc-+-tools: Remove redundant k8s::proxy include

3732a6f7dd-+-tools: Move webproxy code into a role

343fb39250-+-tools: Add k8s::webproxy to tools::proxy

315a4d53db-+-labsdns: Update tools.wmflabs.org internal value

1983668e11-+-toollabs: Make proxylistener support systemd

40965d2af8-+-tools: Do not have tools webproxy inherit the common role

e26ab8fb06-+-tools: Move 'web_domain' param to proxy manifest too

6e384d824a-+-tools: Make webproxy role not inherit from toollabs

81325bfbad-+-dynamicproxy: Firewall redis more restrictively

a1c32a5959-+-dynamicproxy: Enable redis replication for novaproxy

9e672d9245-+-Add ferm rules for rsyncd/scap master

c90617f8c3-+-dynamicproxy: Use new servicename for API

649fa47b67-+-dynamicproxy: Build proper invisible-unicorn package

dfe150dae5-+-ganeti, swift: fix 'variable not enclosed'

2826ce189f-+-dynamicproxy: Remove ::eqiad suffix

a0a43446d2-+-phab: basic apache status metrics to graphite

4f7f47e4a2-+-Replace hardcoded 'labs-ns2.wikimedia.org' with a hiera call

d66b6a6a41-+-eventlogging now requires python-etcd

78cec488e0-+-Create toolserver_legacy module

1d385584db-+-Use ca_cert for etcd client in eventlogging processor

f01078f655-+-bastion: separate role for general and opsonly

8393639460-+-Fix eventlogging ssl paths for etcd

49d671f410-+-etcd: fixup path

71cc4f61cc-+-etcd: fixup for preceding changes

bef9d61416-+-phab: mod_status for monitoring

1ec916545a-+-Parameterize owner, group and modes for etcd::ssl::base files

771f5b7862-+-Openstack:  Remove service defs for services we do not want

897149f3ca-+-Apparently dirname isn't available, set $vardir and ensure it exists for etcd

af9f40aa3a-+-Ensure /var/lib/etcd exists even if etcd package is not installed

14bbd05b13-+-Remove etcd package requirement from etcd::ssl::base

3bd72c0b97-+-Openstack/Designate:  Add service monitoring on active designate host

ef49b6249e-+-Set default for $ssldir in etcd::ssl::base

69f3fd6688-+-Puppetize etcd use for eventlogging processor

335768295e-+-Add labservices1001 as a holmium spare.

91a6eaff88-+-shinken: Fix inclusion of labs proxyagent password in shinkengen

230fa7ba54-+-Revert "Rsync:  Unquote booleans"

49f949e85d-+-Rsync:  Unquote booleans

d0b317c89f-+-videoscaler: reimage and rename tmh1002 as mw1260, upgrade to HAT

1efbd3bb94-+-Bump IPv6 route max_size to 131072 for all

89c1b77a79-+-restbase: add LVS codfw configuration

e2dbd178b2-+-Installing MariaDB 10 on tool's slave instead of 5.5

47314fea59-+-Populate labsdb1004 with mariadb

7048d9857e-+-Revert "Revert "phab: disable tools crons""

e8d2178316-+-Revert "phab: re-enable dump script"

48b9c9c14a-+-Tools: Remove dependency of toollabs::checker on toollabs::submit

80a0aa967f-+-Tools: Install flex on bastions

c00f88596e-+-ldap: Be sligltly less inaccurate about 'username'

78dd9fd6a0-+-ldap: Make sure the correct ldap password is used

40996bfff2-+-ldap: Fix string interpolation issues

7706639b63-+-ldap: Provide ldap credentials and servernames in YAML format

3aa9542603-+-ldap: Make it clearer where ldap.conf comes from

72730fe185-+-ldap: Clean out some ensure => absented files

84561e73ad-+-ldap: mwclient no longer needed for ldap client

46d1a47ef4-+-hadoop: fix some lint issues

0cdcc79576-+-ldap: Remove add-labs-user & scriptconfig.py

a847015b0c-+-Deploy eventlogging to terbium

eec939e408-+-LVS: git-ssh service for phab backend

f2b9e4edac-+-Logstash:  Fixed a quoted boolean in a code comment.

e62fbba10a-+-Root out a long chain of quoted bools in nagios/icinga/nrpe

66994b04da-+-Don't install mcelog on machines with AMD processors

8d3bb64eb6-+-Remove role mail::mx from polonium/lead

82a6b341e2-+-Make Sentry config modular

b358b93f11-+-sentry-auth fixes

3469e6b9cb-+-Move Sentry packages into subclass

843dd110ab-+-Simplify sentry module

41bc596a92-+-Fixes to sentry role

82aeb87f29-+-toolserver-legacy: exim4 needs SMTP running

ddeb1b38ff-+-Openstack: Add monitoring for the keystone service

3873c3c4d7-+-Openstack: Mark failure of nova-network or nova-conductor as critical.

aebf548041-+-mailman: raise queue monitoring threshold

8e71f9ecb2-+-Add deploy-service user

28211d8268-+-otrs: Install libyaml-libyaml-perl

d0983c48c0-+-contint: libssl-dev for python

0cecd9e3f0-+-annualreport: puppetize git cloning

cd9d97b099-+-xenon: add xenon-grep script

e5e8cb1f28-+-Update mod_status configuration

aa97097a9f-+-contint: migrate ops dependencies to a new class

180dd6412d-+-Install php5-curl on statistics compute node (stat100[23])

4bb7fd5674-+-Revert "Fix definition of deployable networks"

1ba841ab96-+-Revert "Backup home_pmtpa on bast1001"

10667e3fb4-+-Removing references to es1001-es1010 due to decommision

768d926def-+-squid: logrotate for webproxy on carbon

0d45254e50-+-phab: Add passwd entries for vcs user

1f175d9668-+-Remove the subversion module

6bc8786223-+-Remove home_pmtpa and svn client from bast1001

8e9b29a2da-+-tcpircbot: Also take input from files

6341d85bf2-+-Tools: Replace reference to tools. in toolschecker.upstart

9847b320e9-+-Introduce apache::static_site

9fed0847de-+-Tools: Replace references to tools.wmflabs.org

f21c537206-+-labs_lvm: Require parted explicitly

64834910da-+-statsdlb: Fix strict puppet-lint check

4bfb54a224-+-Ignore warnings about URLs without modules for volatile directory

d3b21c9b15-+-phab: add realserver IP

9e64c8702f-+-packagebuilder: add openstack-pkg-tools package

8545a0beb1-+-Tools: Puppetize updatetools

8fe2025b0c-+-haproxy: Move check_haproxy to module itself

6c072c3bae-+-add IPv6 for ytterbium (gerrit)

8e2f026a87-+-contint: bring back libav-tools on slaves

d5aa52168d-+-Setup Gerrit role account for Phabricator actions

332aa66b6e-+-Use $eventlogging_retention_days for eventlogging drop partition job

eb42573e19-+-Kibana: Fix apache::site title

1295661260-+-typo s/Cassanda/Cassandra/

b7a82f1ab5-+-analytics: Add cron to drop Eventlogging data older than 90 days from hadoop

9e7e5965fb-+-mailman: sudo mailman_check_queue as list

2b9d0991b0-+-Remove the Graphite/Diamond based conntrack saturation check

5618cd3e03-+-Fix definition of deployable networks

99b48b74f6-+-mail: add inbound TLS support for main MXes

b0faf857a5-+-Assign wiki-mail-codfw to mx2001

7fe2c24d29-+-make datasets uid fixed, it must match across hosts

723df0d717-+-elasticsearch: Rename role to fit current convention

4c89839b07-+-elasticsearch: New role for labsearch cluster

3b3808dbe5-+-elasticsearch: Actually provision nobelium

2b806d3715-+-elasticsearch: Setup nobelium with standard roles

01bde943a5-+-mailman: script to rename list

92bd39b706-+-Remove some uses of scope.lookupvar by passing args more explicitly.

a06f23a195-+-mira: remove inclusion of releases::upload

848c849a5a-+-toolschecker:  Add tests for starting/stopping web services

bcc5076ecd-+-exim: fix exim4::dkim's content parameter

c3b25b4c4d-+-Install mail.wikimedia.org certificate

651e8e0384-+-Don't hardcode llama uid

ca32030b32-+-Create real URIs for wikidata RDF URIs

c2f52c7447-+-Switch the wiki-mail-eqiad service IP to mx1001

fb35e11d8c-+-Make link in dataset relative

d21184dc54-+-Basic role for Sentry

a81f27a481-+-Set system => true for llama user

a443e0be34-+-Backup home_pmtpa on bast1001

41719df3f1-+-cassandra: add codfw production hosts

519e614124-+-Set umask to 0002 for wikidev users on stat boxes

9d03ad023b-+-Manage llama user in puppet to work around package bug

e04a0f0778-+-Switch mail smarthosts to mx1001/mx2001

bb8569c4e2-+-Enable ferm on oxygen

6c24c64cdf-+-snapshots: Allow SSH from deployment hosts

cb3332bfe2-+-Enable ferm on mw1152

afd49e28ca-+-Enable ferm on mw1259

ea37532ab5-+-Move base::firewall include into the roles

2d066939c1-+-Enable ferm on remaining snapshot hosts

b9419e3b28-+-Enable ferm on snapshot1001

efce8bd50c-+-Enable ferm for role::mariadb::analytics

12db81d65d-+-tools: Don't explicitly install git

cf24c41550-+-Make gerrit offer newer key exchange algorithms for new sshs

0ee08ffafe-+-Ensure gerrit's plugins are kept in sync with plugin repo

2195113ba1-+-Replace Package['git-core'] with Package['git']

0c17f004c5-+-Remove support for Ubuntu Lucid/10.04

0b7f024ce9-+-Remove sodium from puppet (spare/decom)

739bdd07f8-+-Revert "mailman: ferm, allow rsync from sodium for migration"

cd7a19879a-+-lists: fix duplicate definition re: status module

ee34aad953-+-k8s: Make kubelet use the puppet SSL cert

2cc299029b-+-elastic: add diamond monitoring to eqiad

1db98dc051-+-elastic: apply elasticsearch::monitor::diamond to codfw

dde673d382-+-elastic: sane diamond collector for WMF

e562e29543-+-Labs:  Include python-openstackclient on the controller host.

34d729792d-+-lists: don't load mod status

31a1178671-+-Set replace=True for EventLogging MySQL consumer

9f96d90a85-+-Fix identation and wildcard in rsync for api.log

17a2ff9f04-+-Rename fluorine api rsync job to mw-api to avoid conflict with webrequest api log rsync job

9dad2693e6-+-Rsync api log archives from fluorine to stat1002

70b3aebb4f-+-modularize otrs

6ecfdf713c-+-Enable ferm on mw1160

66cf709d14-+-Enable ferm on mw1158, mw1159

97930d3b39-+-Enable ferm on mw1156, mw1157

831112e532-+-Enable ferm on mw1154/mw1155

385a1a7d3b-+-lists: group => Debian-exim for lists' certificate

a6f84a65e3-+-sslcert: add /etc/ssl/private, set mode to 0711

c65ae28d88-+-Enable ferm on mw1026-mw1029 and mw1110-mw1113

ea1691d3a2-+-cassandra: expose cassandra.yaml auto_bootstrap setting

4b6e999320-+-Enable ferm on mw1100 - mw1109

4bbfbf6cda-+-hhvm: explicitly declare existence and ownership of cache files

f0020f308e-+-Enable ferm on mw1140 - mw1148

f276fd564a-+-Enable ferm on mw1130 - mw1139

c79f539bcd-+-Enable ferm on mw1120-mw1129

d5da71234a-+-Add mx1001/mx2001 as role mail::mx

eea79d7ca7-+-Enable ferm for mw1189 and mw1200 - mw1208

bc91063c44-+-restbase: add cassandra password for test cluster

35039d0818-+-Enable ferm for mw1190 - mw1199

94f1fc05c5-+-Enable ferm on mw1221-mw1229

35208fe64b-+-Enable ferm on mw1230-mw1235

a720af6783-+-Openstack:  Move horizon to the same OpenStack version as everything else.

b03185d3c4-+-labs: Move *.labsdb aliases into DNS

f18b40a12b-+-define interface::manual for jessie LVS eth1-3 tweaks

821c80933f-+-new eqiad LVS: turn on LVS/pybal parts

b2ac3ccc60-+-Revert "exim: temp hack to stop exim when on fermium"

25eaf51e28-+-fixup lvs1007-12 eth0 netmasks

9e3026ae75-+-fixup lvs1007-12 eth0 vlan ids

e72c1d1fae-+-Rename analytics1011, 1016, and 1019 to aqs1001, 1002, 1003

953b32e224-+-cassandra: provision restbase user/password

d0d3babe16-+-Updated Kartotherian & Tilerator ports

5be6c56405-+-Revert "Temporarily disable import_waterlines cronjob"

cfb378f569-+-create application users

b65b2adc9f-+-Clean-up a small typo

768ce4588c-+-Wrap lvs class in has_lvs hiera variable

b7653bb279-+-nagios_common: Delay default evaluation of template()

b3c1d2aa1e-+-Make foreachwikiindblist accept dblist expressions

b57b592986-+-logstash: add monitoring for logstash process

00a116b207-+-Move host contact_groups to hiera and migrate existing

a332efc527-+-Temporarily disable import_waterlines cronjob

f87f23b30c-+-define search IPs for low-traffic codfw LVS

90c48daebf-+-contint: move some useful packags to a new base class

d8585c5f5b-+-contint: remove subversion::client

40728a4f24-+-contint: remove postgresql

fc606a1ae2-+-contint: remove obsolete ruby related packages

1aea182b1f-+-contint: upgrade setuptools from pypi

e7d4d7b40b-+-contint: Install chromedriver for running MW-Selenium tests

ac26f0668d-+-videoscaler: fix typo in mw1259 node definition

1b7e57beff-+-videoscaler: reimage tmh1001 as mw1259

aba42ed3f7-+-Enable ferm on mw1236 - mw1239

3bab5df893-+-Enable ferm on mw1090 - mw1099

7c291feb99-+-Enable ferm on mw1080 - mw1089

c4c96597da-+-Enable ferm on mw1070-mw1079

05ee4638a8-+-Enable ferm on mw1060-mw1069

ffce9a75fa-+-Enable for mw1050-mw1059

20f7143b02-+-Enable ferm on mw1040-mw1049

7b3516fbfb-+-Enable ferm on mw1030-mw1039

6299ff73e0-+-Enable ferm on mw1250 - mw1258

83d1f2ad05-+-Enable ferm on mw1240 - mw1249

1763fc4b84-+-Enable ferm on mw1180-mw1188

2221474d96-+-Enable ferm on mw1170-mw1179

306bdc30ea-+-Disable dynamic scripting in Elasticsearch

e159c2092e-+-Enable ferm on mw1161-1169

21165f293b-+-Enable ferm on mw1209-mw1220

612c9c1784-+-Revert change to always include python-pykafka

66ed87a8c3-+-Make main eventlogging class require eventlogging::package

df09d68076-+-Deploy eventlogging code to stat1002

def1eead51-+-Make sure python-pykafka is installed for eventlogging

d348ba94c0-+-s/hostname/fqdn/g in the controller vs. spare logic, again

c6d6a555ec-+-OpenStack:  Turn off keystone service and cron on spare controller.

99590ee50a-+-include standard temporarily for new eqiad LVS

97cd8b7509-+-disable lvs::balancer on new eqiad LVS for now

494a10fcbf-+-Openstack:  s/hostname/fqdn/g in the controller vs. spare logic

54ba5c5736-+-Openstack: Clarify differences between the controller and the spare:

10fe44f0d2-+-reprepro: switch default_distro to jessie

4b3e8734b1-+-videoscaler: add previously unpuppetized file

d1cb79186b-+-Configure nf_conntrack hash table size and install conntrack check via NRPE

1835ed49bf-+-configure datacenter set

8288b1aca8-+-Use backported ffmpeg for multimedia transcoding on Trusty

47a6a35671-+-lvs1007-12 basic puppetization

bab54042a7-+-elasticsearch: apply elasticsearch::server role to codfw

5b2a9dac64-+-Enable ferm for initial jobrunner in eqiad (mw1010)

8309c3a8a2-+-enable ferm on mw1149-mw1151

53a89b9eb3-+-Enable ferm for mw1115-mw1119

6e984caf08-+-Enable ferm on mw1019-mw1025 (canary appservers)

9c6f931361-+-Ensure correct order in postgresql::user

331b23eba6-+-Enable an initial image scaler with base::firewall in eqiad

b1ed6b0238-+-toollabs: add python-psycopg2

5abc9eec87-+-tools: Add k8s bastion class

c1996eb3d2-+-k8s: Default ssl usergroup to be root than kubernetes

decfd3ad9d-+-Revert "phab: disable tools crons"

9669ffacf8-+-delete misc/maintenance.pp, now empty

f2d9cc94d1-+-move mediawiki maintenance scripts to module

1016991175-+-Puppetize MariaDB init.d and bin in role::analytics::mysql::meta

7e25b26ae5-+-elasticsearch: add role/codfw/elasticsearch/server.yaml

cba4ef6b7f-+-releases: add new distro jessie for mediawiki releases

5b640f8b29-+-Puppetize MySQL/MariaDB server on analytics1015 in prep for moving Hive and Oozie

bbcace4613-+-Explicitly disable services on labcontrol1002.

53205e9180-+-elasticsearch: codfw initial node stanza

b22b0406c3-+-beta apache config: fix instances of 'wikibooks' that were copy+pasted everywhere

648f8e555f-+-beta apache config: Move wikipedia and wikibooks out of main.conf into their own files

240031af29-+-toolschecker:  Added db tests

8349a2997c-+-Enable ferm on mw1114 (API server)

65f1e180a5-+-Enable ferm on mw1018

e9c575d8cf-+-cassandra: force dependency on openjdk-8-jdk

13b5d1a26a-+-maps: Fix group membership for postgres log

51223efe4a-+-Raise default conntrack table size

33831bdc5b-+-udp2log: Use the DNS name in ferm rule

6d1d4f1998-+-quarry: Fix typo

c3e31fd491-+-toollabs: remove redis Sysctl[vm.overcommit_memory]

8a8c068c5a-+-contint: for Jessie s/ruby1.9.3/ruby2.1/

90765afe75-+-Add scap scripts to all canary app servers

82c47c0dd5-+-Tools: Migrate from labsdebrepo to aptly

a0972a4e67-+-aptly: Pin per-project aptly repository

4f589ad1d4-+-Follow-up for Iae36f1: actually provision the varnishprocessor module

bdcbec9361-+-Follow-up for I8be1929b2: remove mediawiki::monitoring::webserver

a162ab1fc7-+-phragile: Add role class

683caaa540-+-labs_lvm: Only run extend-instance-vol when needed

29f96aa1b8-+-Revert "switch wmfusercontent.org to RSA-only temporarily"

5bd47762fe-+-Revert "Temporarily move phab altdom into wikivoyage.org"

5db39d1c0f-+-Revert "switch phab altdom to phab.wikidata.org T112381"

a3fecd48ea-+-switch wmfusercontent.org to RSA-only temporarily

cd67962693-+-Send image varnish frontend data from logs to statsd

245e6398c2-+-Remove analytics1011, 1016, and 1019 as Hadoop workers

ad4ff5b4da-+-Adding new journalnodes in prep for decomissioning analytics1011 and analytics1019

902db46065-+-cassandra: enable ssl_storage_port (7001) in ferm

4f911cdc10-+-contint: apt conf and python packages for light slaves

49610288bd-+-mediawiki:monitoring:webserver: ensure => absent

f4971375c2-+-mediawiki: kill HHVM graphite checks

ff92d0207a-+-switch phab altdom to phab.wikidata.org T112381

2ef36fedff-+-Temporarily move phab altdom into wikivoyage.org

caefb8cced-+-Make copy of our instance puppet certs that tools checker can read.

db3fa6a171-+-Don't disable LRO/GRO on jessie LVS hosts

7fad38ae3e-+-fermium: back to regular role::lists

fd184dc7b5-+-nodepool: easily switch to nodepool user

72cd5316be-+-package_builder: support distribution name aliases

30aad3531d-+-cassandra: install certs and CA from private.git

6eae3163be-+-cassandra: new class ca_manager

125b51f987-+-k8s: Make kubelet run as root as well

2aeed84e07-+-k8s: Setup /var/lib/kubelet too

d786dd98f4-+-k8s: Add kubernetes user to the docker group

79faf1dd58-+-k8s: Setup /var/run for kubelet

12bbaa9d02-+-k8s: Switch to running everything as a kubernetes user

5ee82a8748-+-mailman: move scripts to /usr/local/sbin/

5d3b07ce57-+-k8s: Fix typo

4cdbec2d0c-+-k8s: Setup ssl certificates properly

161e02d2f2-+-ores: Turn on redis keepalive

ec7045be44-+-k8s: Break dependency cycle

ff84a9279a-+-k8s: Use the puppet certificates for authentication

10a6142019-+-k8s: Setup kubeconfig file for kubelet and kube-proxy

2ca50cec60-+-wdqs: set icinga contact group on node

9196a5aa74-+-k8s: Use insecure port for controller / scheduler

98451b7ace-+-redis: Handle the case when $persist is false

09cdab2529-+-redis: Have redis machines overcommit if persistance is enabled

653001f171-+-phab: re-enable dump script

55ed1d0849-+-wdqs: set icinga contact groups, add wdqs-admins

e34dbe6d18-+-contint: tweak Icinga contact group for prod servers

e9a89f157b-+-Parallelize 12 eventlogging client side processors on eventlog1001

1c8b924cb7-+-Turn off varnishncsa udp logging for eventlogging

56f62ca318-+-Remove unused ZMQ inputs and outputs

6fb3e26341-+-Remove eventlogging multiplexer, forward kafka eventlogging events to zmq port 8600

4d617c873f-+-Add do_gzip to the maps cache cluster

df1d5ff567-+-Add do_gzip to the misc_web cache cluster

5d1f983303-+-networks::constants: Bring up to par IPv4/IPv6

cd242ffebf-+-Make eventlogging mysql consumer consume from kafka instead of ZMQ

40a4543d89-+-ores: Fix typo

8d5062cfb8-+-ores: Allow customizing log_level

0257652f1f-+-Put Grafana behind password authentication

2b04535ff9-+-celery: Because puppet is possessive of parameters named loglevel

32da35e418-+-celery: Allow customizing loglevels

f68117b2c6-+-Designate/pdns changes for kilo.

a7adab3add-+-Move hdfs balancer cron command into a script to be sure stdout and stderr are properly redirected

b870997d76-+-Add ferm rules for scap proxy

ca4eb23316-+-phab: use mysql slave not master for scripts

64994797f1-+-Enable ferm on remaining appservers in codfw

ab8d156886-+-Enable ferm on remaining API appservers in codfw

e5dc0e582c-+-Enable ferm on remaining job runners in codfw

1248888ee9-+-Enable ferm on remaining image scalers in codfw

c89c0c407c-+-Enable the second video scaler in codfw

64dd11998a-+-cassandra: add restbase-test200[1-3] spares

3c33006053-+-mailman: rsyncd conf for exim sync

0d833f96ef-+-mailman: remove import scripts

dce4a8b690-+-mailman: also rsync qfiles

4026b5c3b1-+-Limit insecure POST to text-cluster only

b1c0524972-+-mailman: fix duplicate declaration rsync module

5f0a244a5e-+-fermium: back to migration role

3b16e48ed8-+-mailman: no more importing to an import dir

bd87a2a180-+-mailman: don't run service on migration host

054c2a6932-+-Set raw=True for raw file event consumers

4ca887d474-+-Use different default consumer group name for files consumers

4673bd5206-+-Not using hiera for kafka consumer args for file consumers

e1a098771e-+-Make eventlogging files consumer consume from Kafka instead of ZMQ

4fdb340839-+-Leave eventlogging server side raw forwarder outputting to zmq until we are ready to turn off all zmq

e7c8f85d0e-+-EventLogging client side processor now consumes from Kafka

4b654cef63-+-Remove eventlogging ZMQ based monitoring

be8e6edb3a-+-Modify eventlogging graphite alerts so that they are based on kafka metrics

301d9e877b-+-Labs: Allow self-hosted puppetmasters to auto-sign certificates

0d16246b00-+-nodepool: setup scripts are in integration/config

fb07206fde-+-Revert "nodepool: setup scripts are in integration/config"

4db685e870-+-Enable ferm on mw1017 (test.wikipedia.org)

45e1686993-+-Enable initial imagescaler in codfw

3219428cd2-+-Enable ferm on initial jobrunner in codfw (mw2081)

51456dac71-+-Disable ferm on mw2080, needs additional rules for rsyncd

bcc53506e4-+-Enable ferm on initial jobrunner in codfw

4b3d3b0a38-+-Enable initial api appserver in codfw

f4f74b1541-+-k8s: Switch to using token auth instead of basic auth

a57e2d0489-+-mediawiki jobrunner: mark as notrack

b637156c54-+-mailman: rsync for local import

8d2b48700e-+-mailman: rsync command for exim copy

ce3e6fb469-+-Use hiera to lookup eventlogging_host in varnishncsa eventlistener

939607c230-+-Don't prepend seq on zmq forwarder, as the kafka one already has done so.

1f32e21e42-+-Run server side zmq forwarder off of kafka

0060695a47-+-Separate zmq and kafka server side forwarder into different processes

e020474de7-+-Add some crappy but handy scripts for managing the grid during reboots.

b99563b343-+-nodepool: setup scripts are in integration/config

684ebaed44-+-Make eventlogging server side processor consume from and produce to kafka

ba2a1e5c45-+-Don't use async producer for eventlogging server side forwarder

3b35d3fec7-+-Use proper variable in eventlogging forwarder

f753509c6b-+-Puppetize EventLogging on Kafka server-side-forwarder on eventlog1001

8c68abff7d-+-Enable remaining Hadoop workers

17be00823a-+-k8s: Add ABAC for kubernetes

d0ead32e5d-+-k8s: Make sure that /var/run/kubernetes is present

bbfb7e2314-+-k8s: Setup basic authentication for kubernetes

8b9c128db3-+-Introduce mendelevium to the cluster

c9dc0b805b-+-maps: Improve water_polygons population

d6b5148b7e-+-k8s: Don't make docker explicitly require flannel

b4774a23ff-+-tools: Allow flannel to access etcd

0788ba260c-+-Enable ferm on half of remaining Hadoop workers

9b726c1e96-+-tools: Add a kubernetes worker role

f1d92268de-+-tools: Open up firewall holes for kube apiserver

c4e398fc28-+-tools: Add k8s tools master role

3806e9fb94-+-k8s; Switch to using debian packages for binary deployment

205d299335-+-Enable initial videoscaler in codfw

7bb7543762-+-Remove obsolete comment about apache-config

b4f67487d4-+-toollabs: remove duplicate python packages

2c524f8cb4-+-Save binary log coordinates from the master and the slave on backup

66ee80f0df-+-swift: graphite_alerts should be a define

7c538ad4ee-+-Remove class misc::deployment::passwordscripts

83ed7857e1-+-Enable ferm on two initial appservers in codfw

988d12e968-+-Add ferm rules for pybal SSH health checks

2d4752c5ba-+-swift: refactor graphite/icinga checks

ee4975d9c5-+-Remove/ensure => absent *_pass scripts

396a3c1e37-+-toollabs: add python-pil

5ec81b7b47-+-toollabs: add python-enum34

22d9d3cab5-+-toollabs: add python-pyicu

7bb8fe793b-+-toollabs: add script to generate python package listings

34e9c7a8ab-+-network: use mr1-eqiad/ulsfo's loopback IPs

d2b402310b-+-package_builder: require_packages and make ubuntu-friendly

8ab6d65414-+-aptly: Fix terrible typo

0ad966217c-+-aptly: Force remove multiarch support in precise

4e2ea1086a-+-aptly: Make client default to not having source packages

7565195a9a-+-Disable fss.so on all HHVM servers

d0103025ae-+-tools: Do not poke holes in firewall for etcd

95c424f1b4-+-tools: Add etcd role

be02fd9019-+-k8s: Drop outdate File require

b0570ccdd5-+-k8s: Don't make the master node a worker node as well

4f202bb4e7-+-k8s: Use debian package for flannel

f582d8e6f2-+-labs: Allow NFS to be turned off on a per-instance level

7cc356fd60-+-dumps: big wikis do abstracts in 4 chunks, no need for page ranges

09ca439f75-+-Remove snapshot roles and classes from osmium

3d4f498627-+-Document bug T111586 in a comment in site.pp

823b11489b-+-Apply snapshot role on osmium

f91ef4bd6d-+-wdsq: monitoring, remove spaces in check names

302613bb4a-+-Add icinga monitoring for WDQS services

767abce74c-+-Disable zerofetcher on text caches T111045

e77973e951-+-varnish: lint fixes

a6fd59c158-+-Remove etcd100X from manifests

e260b089ac-+-Restrict access to analytics network for Hadoop master/standby

8f8b3f6467-+-Restrict Hadoop access to the analytics network

433be8f644-+-Use base::firewall on analytics1015

df1442e900-+-apertium: Add new language pairs

b5b05d7ea8-+-grafana: graphite is the default datasource

0bb9b4d5e1-+-contint: move zuul_merger_hosts to hiera, use in ferm

05a796e0c2-+-Phabricator project creation/changes log email for Phab admins

a9e96d8fae-+-diamond: service stats puppet integration

f290b363af-+-diamond: wdqs and blazegraph collectors tweaks

d8c438ec4f-+-k8s: Run kube-proxy on the webproxy hosts

95735d6ae6-+-policy.wikimedia: remove puppetization

c845f08a4b-+-k8s: s/contents/content/

3b47e5354e-+-k8s: We aren't using k9s as we aren't a drug unit

9a445b12d7-+-k8s: Add simple webproxy

be9560f499-+-Add analytics1053 and analytic1057 as hadoop worker nodes

2eeb408dcb-+-k8s: Setup cluster-dns for k8s

db79409cb9-+-analytics1015 is no longer a hadoop worker

61870d106f-+-Enable ferm on analytics1028

13a30b027e-+-Set Yarn AppMaster possible port range to 55000-55199

8f4d4898ed-+-Assign grains for initial debdeploy clients

f0b848f9b1-+-k8s: Explicitly use the debian backports repo

f7d0306b51-+-elasticsearch: ferm for all nodes

503d887896-+-Enable ferm for mariadb core servers in codfw

f1a21bfec9-+-Remove the ferm rules from modules/rsync/manifests/server.pp

3d9e516570-+-Disable ferm on mw200[89], needs an additional rule unveiled by iptables logging

74c84f23d0-+-Enable ferm on initial appservers

5819b19e8d-+-Enable ferm for dbstore* in codfw

6dac6b27e6-+-Exempt mariadb core port from connection tracking

02eb4c6b95-+-Enable ferm for db2055-2070

1cc6b8d64a-+-Enable ferm for role::mariadb::core

00a6d1f16f-+-graphite: Add aggregation logic for ".sum" properties

529ab99317-+-labstore: Make NFS unavailability paging

cc775bdd9e-+-cassandra: storage_port is for cluster communication

eecb838ad1-+-labstore: Do cleanups of snapshots only on active labstore

f00d94f8cd-+-Tools: Replace reference to tools. in class toollabs::checker

38b3213355-+-Tools: Replace reference to tools. in class toollabs

1bb1e47c37-+-labstore: Make sure that check_http hits correct IP

bc2e297c42-+-apertium: fix typo errors

101975a352-+-Log for Apertium

45eae7321e-+-nodepool: adjust database configuration

c66ae152c2-+-Add a custom rsync ferm rule for swift storage

00fa15dea2-+-Also allow access to sanitatium from iron

1ddcb18d1e-+-Add ferm rules for mariadb sanitarium

11788a7624-+-Enable ferm for db1069/sanitarium

a594fd89d2-+-Enable ferm on remaining phabricator db hosts

deda561581-+-Add nodepooldb mysql database to m5 and grants from libnodepool1001

3fb4f80c16-+-Increase nutcracker ulimit via an Upstart override file

9c0d9fdb77-+-mailman: ferm, allow rsync from sodium for migration

824b214e76-+-elasticsearch: exclude 1001 from ferm for now

848c705f69-+-Make OpenStack Juno the new default, except for Horizon.

06576ff35c-+-Decom bits caches from beta/staging

1146407dc1-+-cache_mobile: raise max conns to 1k like text

8b163e135c-+-cache_mobile: limit 4xx to 1m like text

d06f8b8482-+-labstore: Check for instances being able to rw NFS

fd2279b266-+-contint: drop pip obsolete download-cache option

b29c34fe72-+-contint: install pip 7.1.0 from pypi

43c7724801-+-contint: drop /data/project/debianrepo

21a32d3606-+-elasticsearch: ferm for one and all

d7c66df9ec-+-Disable ferm on analytics1028, mapreduce.v2.mrappmaster needs to be researched further

7737385494-+-Add rule for journalnode on hadoop workers

2743278221-+-Enable ferm on analytics1028

859073c681-+-Enable ferm on analytics1021

a5c34a61d0-+-Enable ferm on db1048.eqiad.wmnet

21a72f816b-+-labstore: Make sure that the timer and service names match

e05bea173d-+-labstore: Run the cleanup script every day

531fb99ba2-+-osm: fix typo in ferm::service srange

7254d5966c-+-Enable ferm for role::osm::master (currently only used by labsdb1006)

c8b39a75a0-+-Enable ferm for osm::slave role (currently only used for labsdb1007)

69bd417654-+-Enable ferm for postgres::maste role (currently only used by labsdb1004)

08e35b2d8e-+-Enable base::firewall on labsdb1001

77ea8c60d8-+-Enable ferm on labsdb1002

2145acd2cb-+-Enable ferm on labsdb1003

30d4456416-+-genericize the cluster_nodes-like variables to reduce diffs

2625160fad-+-add zero updater to text.pp, align position

a1d6a55d67-+-trivial mobile/text.pp diff reductions

3911398c08-+-Bugfix for c6806db0 + misc-web VCL

44858cf2ba-+-mobile: add bits compat code

c6806db070-+-standardize hiera-overridable class/config params

4d4a717454-+-vcl: merge cluster_options into vcl_config, refactor

56a4166cf0-+-Make search on wikitech work again

cfff82c9ab-+-icinga: libssl0.9.8 for NRPE checks to run

8ce37ae200-+-icinga: no suprise upgrades with 'latest'

7a756dd8b3-+-openstack: fix non-capitalized resource references

cfa675e5a8-+-Revert "Add more nslcd notifying"

9df1191f0e-+-add various text backend defs to mobile

2ffdf7f0e1-+-elasticsearch: ferm for 4-7

b6e36a6d3b-+-Fix /static 404s in beta mobile

75ccadfc0a-+-Set up varnishkafka instance on cache servers to log raw client side events to kafka

6ebf5881b9-+-icinga: puppetise apache mods

0f62ccf348-+-Enable debdeploy for an initial set of servers

00d0344fc2-+-Add more nslcd notifying

7509808ab4-+-network: add bast2001 to bastions

0ec05cdfa9-+-network: indent/reflow $special_hosts

342dc06360-+-Explicitly include nslcd package.

5d28d43f07-+-Make ldap/nscd/nslcd install order more explicit.

6047bb13f8-+-require_package openjdk-7 in zookeeper role

ac09a37cc3-+-Move base::firewall include into the role definitions

ac2a9fd89f-+-Add ferm rules for Hadoop worker nodes

7987bf61c4-+-varnishncsa: fix process monitoring

7c5099663f-+-swift: enable firewall for ms-fe in eqiad

4105374adb-+-Add debdeploy master to palladium

8c100a8dcc-+-Remove stray lines (nop commit to test puppet-merge after enabling ferm on puppetmaster backends)

b972586cea-+-Enable ferm on strontium (and merge it to the role)

5ea62a1a5d-+-Enable ferm on rhodium

1ab63edc56-+-Query the puppetmaster from hiera instead of $::serverip

48dbf51d52-+-mailman: fix I/O monitoring on virtual machine

2d602fd2ab-+-icinga: fix host def for en.m.wp.o-legal-html check

0c78c8adfb-+-icinga: dupe resource name fix for legal

58dcfcdd3c-+-analytics: do not use node inheritance

6801c75731-+-icinga: apply icinga::monitor::legal to role

8b5d4d22a6-+-icinga: watch for the existence of certain html

405a54eeef-+-phab: disable tools crons

247a062e28-+-mailman: fix "no gate_news on jessie"

9d3f43e01d-+-remove stray line

519f87e5eb-+-Disable ferm on the puppetmaster backends

6cfb6a7e25-+-elasticsearch: ferm for [8-9][10-13]

782eb5c5c5-+-mailman: no gate_news debconf option on >= jessie

93529f3596-+-Don't alert on stopped eventlogging jobs on analytics1010

962cef3b81-+-elasticsearch: ferm for 14-17

1b1e5803d8-+-nodepool: update apt pinning

379b1678e6-+-Rename server-side kafka processor to server-side-0

cf205128bc-+-Puppetize multiple kafka eventlogging processors on analytics1010

9841505f34-+-Allow SSH access from puppet master for puppet-merge

60dd7381d0-+-maps: Fix typo in maps-admin name

67b781709a-+-maps: ensure PostgreSQL's logs as maps-admin

6173153a09-+-Enable ferm on swift/esams

082d3dbf59-+-also enable ferm on strontium (also move it to the role now)

270f3dfe11-+-Enable ferm on rhodium

1a8a993ed3-+-gridengine: Fix status check for gridengine-exec

384247c956-+-Exempt mediawiki/http from connection tracking

7b25d22ae1-+-Logstash: make sure all input defines deal with ferm

b1b2ed54ba-+-mailman: use role-based hiera lookup on fermium

ab7bdfee8a-+-mailman: apply list role on fermium

aaf8c189dc-+-exim: temp hack to stop exim when on fermium

b94a1010ec-+-elasticsearch: ferm for 18-23

0608f9ea8b-+-elasticseach: ferm for 27-31

e6652e73de-+-fermium: add mapped IPv6 address

bb9d993fd0-+-Make statsd host configurable via hiera

b9f66737bc-+-Add ferm rule for grafana traffic

289a1cfdce-+-Enable ferm on logstash100[1-3]

c1d01be1a7-+-Increase num.replica.fetchers to 12 across the Kafka cluster

a74d48055c-+-Increasing num.replica.fetchers all around the cluster

10110d57d6-+-Enable base::firewall on eqiad storage servers

5a550233f1-+-swift: enable base::firewall on ms-fe2*

06af077cb6-+-Require ethtool package for ethtool execs

31e09b39f3-+-Re-enable auto create topics for Kafka

7382949508-+-Decom analytics1021 as a Kafka broker

a01c0e0bbc-+-Enable base::firewall for swift storage in codfw

879c7e03cf-+-swift: lower conntrack TIME_WAIT timeout

90264258f2-+-aptly: Name distribution correctly in clients

4354d170ee-+-aptly: Get rid of 'main' in aptly repo name

07cba8d55c-+-base: Don't install command-not-found-data either

df84512c1f-+-aptly: Change naming schemes for repositories

c9ee6b492c-+-aptly: Setup depnedencies properly

99b2684079-+-aptly: Fix typo in distribution name

cb400738da-+-aptly: Specify arch explicitly for publishing

624c040cb9-+-aptly: Switch class to define

69596145e7-+-aptly: Auto setup published repos by default

d60cf04f8e-+-aptly: s/url/url/

88d6615c8f-+-aptly: Fix typo in role

93b0a2e5d0-+-Move the logstash ingestion rules into the role

ed13cb9260-+-Reorganization of new External Storage nodes

54bdf1b0e0-+-Comment out nova-network on labnet1001.

5256156a28-+-phab: use apache::conf for mpm_prefork

06b0aa4d70-+-Create ssh-agent-proxy internal permissions

aa6f3108e1-+-Adding new External Storage nodes as MariaDB::core

a84570e098-+-mailman: SSL settings to Apache 2.4 and "mid"

dbc61da00d-+-deployment servers: use role keyword for role

7f2d111afe-+-elasticsearch: fix fw canary regex

d850287bd0-+-elasticsearch: add firewalling to elastic102[3-6]

86d195c450-+-dumps: move scheduler args out of dump arg list

6eba7421c2-+-Remove refs to dc-migrate.  Unused and bitrotted.

a4fe0c83e5-+-add IPv6 for antimony (git web)

6a9f272af6-+-Enable ferm on elastic1023 first

50c61385bf-+-Disable connection tracking for elasticsearch

b387b453b4-+-backup: Add IPv6 address of director in firewall rules

4276d0f021-+-openstack firewall: get designate host from hiera

8055a1f6b4-+-Add ip6 address on helium

5c4e37a1ef-+-backups ferm: replace INTERNAL with ALL_NETWORKS

4f611aa360-+-base::service_unit: ship systemd units in /lib

5ae66840a3-+-Revert "Re-enable base::firewall for swift::storage"

dee26d1b58-+-Re-enable base::firewall for swift::storage

34e3e4092d-+-remove base::firewall temporarily until the Hiera access is sorted out

f5136634da-+-Swift storage backends also need to be accessed by the proxies

27e03c6720-+-Enable base::firewall for swift storage

4aa73bebcf-+-Add ferm rules for swift storage backends

8db374961e-+-deployment::server: re-puppetize nutcracker config

9d22da9cfc-+-phab: persist current mpm_worker tweaks

bc2c4e96cb-+-phab: remove stale elastic search code

dcfbd5774f-+-mailman: mini script to rsync lists

308fe1a732-+-Revert "Disable IPSec monitoring temporarily"

c3ca6dad5a-+-Bugfix for fff9aca5: s/concat/array_concat/

fff9aca531-+-Switch codfw to tier2

7020ad0f00-+-Disable IPSec monitoring temporarily

c75d798794-+-Revert "Revert of Iab860b8a5: Make puppet cronjob to run SecurePoll/cli/purgePrivateVoteData.php"

581c983025-+-ferm rules for nutcracker

ec405bad83-+-General maintenance script cleanup

1ca0689086-+-Maintenance script maintenance for labswiki

fff2c5e376-+-elasticsearch: Fix dependency on /etc/elasticsearch

fba2e78d2d-+-Fix mwgrep to work without dynamic scripting

8f276f5914-+-Add ferm rules for swift proxies

a19d2626d4-+-aptly: Setup client role

ac226d7f5b-+-Add ferm rules for Logstash/Elasticsearch

9788fec428-+-ores: Mark all roles requiring ores::base properly

38aca28c5e-+-ores: Add role+class for the precached daemon

fd3189a77f-+-quarry: Remove duplication of clone_path and other variables

e46d3e2f65-+-DHCP/puppet changes for fermium's public IP

046d146757-+-Exempt ocg service from connection tracking

5a98bb9ed3-+-Require openjdk-8-jdk

a329b58c01-+-mailman: add cronjob to delete old held messages

f4ef31bf42-+-maps: enable the ganglia diskstat plugin

cefa3b951a-+-Rename some migrate scripts to better identify what they do

005149de6b-+-Add sus-migrate, yet another attempt to support cold migration.

dfa7baf1cc-+-use_chroot => no so that we can preserve file ownership

68449e17d4-+-backups: remove the temporary helium nfs if clause

f9fc534791-+-Allow labcontrol1001 rsync access to the labvirt nodes.

d56139cc59-+-pybal: raise open files ulimit to 10240

d9e4ec39e1-+-Use fqdn for rsync allowed hosts.

fcb5fddfca-+-Include rsync::server before setting up server fragments.

8e877637c7-+-restbase: add deployment script

476445ad48-+-Change memcached icinga alert from anomaly to threshold

b1ed1b9de6-+-Set up an rsync daemon that allows rsyncing of nova instances among virt hosts.

837fc5917f-+-Enable base::firewall on analytics1026

2e2c73ff0c-+-Include kafka10(13|14|20) in the analytics Kafka cluster

18103f4128-+-Use require_package instead of ensure_package in role/analytics/hadoop.pp

0c1d8e8c1b-+-Add ferm rules for jmxtrans/impala

20f50c7c88-+-etcd: remove role from etc1002

474e78d204-+-etcd: remove role from etcd1001

ccd11cfcd0-+-ferm rules for elasticsearch

4a634f3c58-+-service: add deployment_script define

c9798c74d1-+-cassandra: Mute strict puppet-lint warnings

39f423e71e-+-Tools: Only execute cdnjs-packages-gen on changes

cc28fbf8fb-+-gridengine: Ensure that service gridengine-exec is running

c55b5ad265-+-Revert "Add root keypair connecting labvirt hosts."

9642175342-+-Revert "Use ssh::userkey rather than trying to get the pub key installed by hand."

b6428d8354-+-Use ssh::userkey rather than trying to get the pub key installed by hand.

6dc1195d3f-+-Add root keypair connecting labvirt hosts.

b013935547-+-wikistats: add cronjob for miraheze updates

3e3fb80a0f-+-Introduce new labs role for vagrant+lxc

ed9e64dbd2-+-Tools: Puppetize missing intermediate directory

29050798ac-+-Rename swift_new to swift

c56abc32da-+-Revert "disable ocsp updater cron for now"

f3c7f50d8e-+-Added a live-migrate script to wrap nova's standard block-migrate.

45088960b5-+-Set maximum execution time to 60 seconds

db3fd72be3-+-grafana: set Cache-Control: no-cache on dashboard definitions

adc7313afc-+-Repuppetize kafka1018 as a broker

135613f57b-+-silver/wikitech: fix ferm rule syntax

75db458790-+-silver/wikitech: also allow mysql from terbium

d09bad1a23-+-Add extra grants for labswiki from tin

3275fc7e33-+-disable ocsp updater cron for now

5e35fba765-+-swift: replace swift_check_http_host variable

fb9674db85-+-etherpad: Move apache configuration around

daf5a2fb51-+-Kill swift.pp

57da00dce1-+-Exclude yet more kernels that break nova-compute.

7ed45dc91b-+-Kill role::swift::labs

f67401665b-+-vcl_cookies: switch mobile to text-common code, mostly

0e9184f9d5-+-Switch ms-fe/ms-be eqiad to swift_new

ce9c816cb6-+-swift: move 'role swift::proxy' on top of node declaration

48649e7377-+-swift_new: bump max_connections to match swift

057f665978-+-labs: Set Vagrant Puppet environment in mwvagrant wrapper

b917771808-+-silver/wikitech: allow mysql connection from tin

159ce65b28-+-mailman: give g+x on scripts

14333a539e-+-mailman: move exim outbound ip config to hiera

639f89a0b5-+-Rename analytics1022 -> kafka1022

7f97f0d54e-+-Add analytics1050-1052, analytics1054-1056 as Hadoop worker nodes

f60e8b8e9d-+-add disable/enable list script to mailman::scripts

f90555e3a4-+-replace $::instanceproject with $::labsproject

72833da842-+-Switch ms-fe/ms-be esams to swift_new

8f36397027-+-swift: define ${mount_base}

3bb1b1527f-+-swift: add parted dependency

366771db04-+-swift: adjust variable names in label_filesystem

11dbb323e8-+-swift: reduce the delta with swift_new

6783c68ca5-+-swift_new: add precise support

e2942e3f2e-+-swift: remove support for Ganglia stats

e0724033e4-+-Add ferm rules for role::mariadb::misc::phabricator

d6e4a3a361-+-swift: roll role::swift::icehouse into swift.pp

d4d9b53dca-+-statistics::rsync_job: allow multiple jobs to have the same destination

ff5b82c14d-+-eventlogging: install python-pykafka on trusty only

c5fd4e6512-+-mailman: include scripts on migration host

8d891f02bf-+-mailman: add helper scripts for importing lists

13f5faf329-+-Replace some hardcoded labnet1001 refs with hiera values.

840a434bd4-+-videoscaler: reimage mw1152 as an experimental videoscaler

d6bb3039c3-+-Add multimedia packages (e.g. ghostscript for pdfinfo) to silver

b3fe7e1666-+-Use kafka1012 as hostname in Kafka cluster config

319db37b3d-+-Puppetize kafka1012 as kafka broker in analytics Kafka cluster

ad7c8803b2-+-Rename analytics1012 to kafka1012, site.pp puppetization coming in separate commit

8ebe12a098-+-Rsync cirrus user testing logs to stat1002

7a4f9e5e03-+-Make jq available on deployment servers

c89185d3f7-+-RESTBase: Add MobileApps endpoints and back-end config

6b075457ac-+-puppet_compiler: Create the workdir as well

8311f95667-+-xenon: redirect stdout to /dev/null, avoid cronspam

9a74417a99-+-Revert split of webrequest imports in multiple Camus jobs

a06f0d81f2-+-Split webrequest camus import job into multiple jobs for different size topics

5d0133af13-+-Disable kafka auto leader rebalance

57dfa2c43b-+-Revert "Remove hhvm-fss package from production"

969626ce36-+-Revert "hhvm: Don't load fss.so"

09f98b871f-+-hhvm: Don't load fss.so

641608fdfd-+-Remove hhvm-fss package from production

84652bf24c-+-Add icinga alert for anomalous logstash.rate.mediawiki.memcached.ERROR.count

664e4a1a70-+-Add ferm rules for role::mariadb::misc

f9fd34af61-+-Add ferm rules for role::mariadb::proxy

e6159d4b97-+-Enable ferm rules for role::mariadb::dbstore

2df8412957-+-git::install: fix default mode

25469c8c0a-+-puppet_compiler: fix puppet invocation, dest directories

d475416a2e-+-puppet_compiler: misc improvements

8549d4a741-+-puppet_compiler: small fixes

193b9dac34-+-git::install: make $lock_file truly optional

007957f9db-+-Setup LVS for mobileapps service on scb cluster

223a123f7f-+-puppet_compiler: refresh module/role

6340b5d992-+-Tilerator: start ncpu / 2 workers

60148cf3a6-+-service::node: Make the number of workers to start configurable

a4ce1ca421-+-base: ensure => absent on 'command-not-found'

ed104d04d4-+-fermium: adjust rsync import dir, ensure package

0f4c2673c0-+-fermium: re-include rsync server

9cb2ee818a-+-fermium: ferm rule to allow rsync from sodium

6540943110-+-logstash: normalize "level" fields across log types

780454d0c3-+-fermium: add rsync server to sync from sodium

2b51312e99-+-MobileApps: Add the port to the restbase_uri config

a48d2ebef5-+-Change percentage in EventLogging validation alert

1afb522cae-+-Add ferm rules for spark/jmxtrans

941ce3581e-+-maps: Add redis to the cluster

ec6665a49a-+-[WIP] eventlogging: Add statsd_host param to the mysql consumer url

d04aa0569f-+-Include role mobileapps in role scb

2944871085-+-wikidata query: add misc-web configuration

48d5d32cbe-+-Introducing mobileapps role and puppet module

d19183d6b5-+-ganglia::monitor::aggregator: fix upstart (take 2)

627e091e8f-+-maps: Add usernames/passwords to kartotherian config

c29fa1b4dd-+-update cassandra-metrics-collector version

e098d8de16-+-xenon: stop generating weekly logs; tag files with entry-point

d3ce329dc7-+-Make snapshot::packages compatible with trusty

9bdff4fb6f-+-Install python-pykafka  for eventlogging server

cb9759d48e-+-dumps: add ferm rule for port 2049 from INTERNAL

6d6b035219-+-Use monitoring::graphite_threshold for Kafka alerts

dd582780a7-+-logstash: Count MediaWiki log events with statsd

0eb67ae719-+-Use correct class graphite::monitoring_threshold for Kafka graphite based alert

baf71f5c0a-+-Update alerts and jmx for Kafka 0.8.2+

214308cd1a-+-Elastic: Unify default plugins_dir in /srv/deployment

b25de6dc51-+-Elastic: move auto_create_index into hiera instead of role

cae61618f9-+-varnish: director->backends is now always an array

4ab62cf4a2-+-Added tilerator service, granted kartotherian OSM DB read access

1cd724ac39-+-Get scb up to par with sca

7946233aff-+-varnish-misc: remove backend zirconium

d08aae2bbe-+-Add msw1-codfw and mr1-codfw to monitoring tools

5daab4f812-+-maps: Include tuning.conf in slaves as well

02cdf66317-+-zirconium: decom, rm from site.pp,DHCP,netboot

7273e074cb-+-grafana: remove role from zirconium

aa9cf27ad0-+-grafana: needs to load Apache mod_proxy_http too

53ff199aeb-+-Labs: put the real check interval for backups

2a92801377-+-cache_mobile: def_ttl 30d

36b680edf1-+-cache_(text|upload): frontend default_ttl => 30d

115a02e539-+-cache_(text|upload): remove runtime_params conditional

5c59d04182-+-logstash: fix ldap_bindpass

0df444e6db-+-labs: new role::logstash::stashbot class

f290715b9a-+-Update configuration for logstash 1.5.3

f137803dc3-+-postgres: stream WALs while doing pg_basebackup

ddc277d567-+-labstore: add timers for backups

886045c9eb-+-Revert "ganeti: move role from manifests/ into the role module"

fe7c0d5910-+-ganeti: assign cluster variable

589aa3cd60-+-ganeti: move role from manifests/ into the role module

7c61437239-+-no varnish::instance uses "backends" directly anymore

09f53331fb-+-remove now obselete snapshot hosts sudoers file

79c3d34d15-+-Revert "Revert "cache::config: replace lvs IP refs with service hostnames""

8b39ed56af-+-cache_misc: convert backends to director-style

ccba3d36ee-+-bugfix for aaa20e4ce

aaa20e4ced-+-strongswan: decrease log spam

c3b922122c-+-Grafana: Apache 2.3+ compatibility

a706fbc421-+-Send 0.8.2.1 Kafka metrics via jmxtrans to graphite/ganglia

2dc12ca3ab-+-Add webrequest_maps kafka topic output for cache_maps

97dfd5745a-+-Change varnishkafka webrequest required.acks to 1

a914763eb3-+-Revert "cache::config: replace lvs IP refs with service hostnames"

fa4b4be868-+-cache::config: replace lvs IP refs with service hostnames

1efa8871d8-+-grafana: add role to krypton (VM)

6ebe56b94e-+-Apertium: Add -j -m and parameters

8ca612e3b3-+-Better alias name for All topic metrics from kafka

d7867d2a84-+-Override kafka jmxtrans metrics to test new config for version 0.8.2.1

8e259c8f27-+-Split scb100{1,2} in their own role

70ee6b02c5-+-Add cr1-eqord and cr1-eqdfw to monitoring tools

c4630c5e2b-+-Redo "nrpe: Merge check_systemd_unit_lastrun into _state"

0d171b748a-+-Revert "nrpe: Merge check_systemd_unit_lastrun into _state"

3bf75f39a7-+-Disable kafka auto create topics until we are ready for eventlogging on Kafka

ac35c601ee-+-nrpe: Merge check_systemd_unit_lastrun into _state

811479c6c5-+-torrus: remove support for bits.wikimedia.org

b8a7205d67-+-apache: allow tuning of logrotate parameters

24d83a888f-+-aptly: Actually include the module in the role

4a8b6eb5b9-+-aptly: Add module + simple role

fee9554d21-+-Set a higher lock-grace-interval for wikidata dispatchers

c98ec5927d-+-quarry: Fix typo I've been making for time immemorial

f41f70fd65-+-quarry: Make the worker nodes use the celery module

fd07cf438b-+-Revert "toollabs: Allow HBA login to all hosts"

15bdf16c86-+-Add cache_maps and related LVS config, using cp104[34]

e09638b629-+-beta: Add script from Jenkins beta-update-databases

83372a5dda-+-toollabs: Allow HBA login to all hosts

8e4fc74763-+-toollabs: Add ecdsa keys to ssh_known_hosts

c5b0da3174-+-Revert "toollabs: Add ecdsa keys to ssh_known_hosts"

3f345ebce5-+-toollabs: Add ecdsa keys to ssh_known_hosts

3348737270-+-k8s: Don't start the flannel service before the file exists

1c000f3c7e-+-k8s: Add controller manager

a9a5572aa3-+-lists: stub role for migration/test on fermium

f2e0d833bc-+-Introduce pybal-test200{1,2,3}.codfw.wmnet

67f6a6acc9-+-Introduce scb100{1,2}.eqiad.wmnet

5d3ae0fcc8-+-osm: more fixes

b12f1759c3-+-service::node: Ensure saner permissions for logdir

b659ebb6c2-+-osm: various fixes

1a32d5c3d2-+-k8s: Provision worker nodes properly

8f9d5aa14e-+-k8s: Fix extra paren

c5c452f1f7-+-k8s: Add kube-proxy class

5b553f2d68-+-k8s: Add scheduler class

c3224a71ed-+-Revert "Revert "bacula: enable firewall on helium""

c5071a717b-+-remove cache::misc role from cp104[34]

6dec9074c9-+-k8s: Pass master_host to the api class

90ddfa7012-+-k8s: Set master_ip explicitly for the API server

cc123e9e25-+-k8s: Remove useless $master_ip ipresolve

88f363f38c-+-k8s: Add apiserver class + init script

182246a5fb-+-fermium: enable in site.pp, include admin

65cbd9c04e-+-fermium: comment from site.pp, just defaults for now

e8ae903f2c-+-fermium: add to site.pp, add firewalling

35b6a4e92e-+-Rename analytics1013,1014,1020 to kafka1013,1014,1020

e2bc9f602d-+-Use require_package for analytics and kafka nodes instead of ensure_packages

4f9a27cf85-+-Revert "bacula: enable firewall on helium"

5c15983273-+-bacula: enable firewall on helium

2f8510dfb3-+-old eqiad bits hosts -> cache::misc role

4075bd437e-+-Decom bits cluster varnish/lvs configuration

cba2a49535-+-Add empty eqiad security_audit backends

4e75f1570a-+-beta: varnish backend/director for isolated security audits

481c7a138d-+-k8s: Include docker in worker nodes as well

cd67a9c6f4-+-k8s: Create worker role and include that in master too

c832641dcd-+-Remove cache::bits role from bits-cluster hosts

4682d5e2aa-+-VCL: use network::constants::all_networks_lo

4f98fe5bfd-+-network::constants::all_networks(_lo)? via flatten()

88f3247fde-+-rsyslog: add rsyslog::receiver to deprecate syslog-ng

18476102d4-+-Add ferm rules for osm

84ee7493b1-+-add ferm rules for postgres

96e9766b4e-+-swift: suppress all output from swift-dispersion-stats

8b3422a207-+-update cassandra-metrics-collector to latest

d2702496e1-+-k8s: Make sure parent directories are created

e2ed1c6179-+-k8s: Fix typo

62d488bc90-+-k8s: Explicitly pass nameserver to ipresolve

1ed00d90b3-+-k8s: Add class for running kubelets

db846a208d-+-ganeti/ferm: open the migration TCP port

491eaad4b2-+-wdqs: multiple fixes - Create rules.log as a symlink to a file in /var - drop cookies when proxying request

233c286689-+-k8s: Open up flannel UDP port with ferm

fa39114d21-+-k8s: Use custom systemd unit for docker to get flannel support

1e8426d045-+-Move api listing rewrite rules to main project domains

120fe382d6-+-k8s: Explicitly declare the docker service

a6d48b1d02-+-k8s: Hook up docker to flannel

5bf5bf4023-+-k8s: Don't use quotes when passing params to flannel

83e31373ad-+-k8s: Initial terrible k8s module

4e31c16694-+-Add php5-curl package to Phragile.

e6dff5a4fc-+-statistics: remove blog pageviews script

b61f42296b-+-Fix for $dumps_servers_ips for role::labs::nfs::extras

5ee5e51216-+-labs: Setup /srv/statistics for rsync from stats hosts

ba1f395387-+-VCL: define vcl_config "layer" for parsoidcache

e4286073af-+-vhtcpd: /etc/init/varnishhtcpd.conf is long-gone now

5fc136003c-+-labs: Allow projects to opt into a 'statistics' NFS mount

d969127783-+-Mathoid: Enable advanced enpoint monitoring

4873758478-+-beta: Swap caches to deployment-cache-*04, which is jessie

7a0d1b1c0d-+-dumps: generate conf files for dump stage scheduler

b7e6f75760-+-Create a common ferm base class for the database hosts and move the existing labsdb slave definition over to it

f71f2f0e7b-+-cassandra: remove obsolete diamond collector

59347ba57c-+-bacula: remove fileset for blog

a8c9819ce9-+-Enable ferm for remaining mc1* systems

f2d66afc71-+-Add ferm rules for jmxtrans on Kafka brokers

45d75676be-+-T105080: add maintenance mode configs for nginx

fd0dfd674d-+-All running services are now ferm-enabled, so turn enable base::firewall on analytics1027.

747f4bceb5-+-Remove clear-profile script and documentation

4b1320739e-+-The generation of the openjdk source packages requires wdiff, so add it to the dependencies installed by package_builder.

221f832c84-+-Increase wikidata dispatch lag critical to >300s

8adbebcb5a-+-Enable ferm on mc1009

dbae0ed179-+-Add ferm rules for Hadoop jmxtrans

f58b0fbd8d-+-Add ferm rules for Hive server/metastore

112b885d55-+-filter pybal process check on root uid

29e7dc40e5-+-pybal: add Service, check_procs nrpe check

dbe0b64bbf-+-imagescalers: convert the last two servers to HAT

8f9bce6c09-+-Add DCAT-AP for Wikibase

8e3eca2c74-+-Reorder bacula keypair key/certificate

0dfbff0817-+-Disable connection tracking for poolcounter

b53f6a9381-+-dumps: move wikidatawiki, commonswiki to big wikis list

ac7478154a-+-Remove analytics1012 1013 1020 from list of kafka brokers in site.pp

b8664b5318-+-Remove newly provisioned kafka nodes from cluster

d66f51bd0c-+-remove db100[2-7] from install_server and coredb

34b78c447c-+-dumps: put base::firewall on dataset1001

a7d6045b63-+-role::mediawiki: tune down nutcracker log verbosity

37a29463fa-+-Add missing ferm rules

4241858d73-+-Set request.required.acks to -1 for varnishkafka

8b2068fdcf-+-Provision analytics1014 and analytics1020 as kafka brokers

2dfd816de1-+-Provisioning analytics1013 as Kafka broker in analytics cluster

eaddaa63ee-+-Enable the mobile data crunching job

090a4df593-+-enable ipsec for all upload caches

0a66ca466e-+-Revert "Enable base::firewall on dataset1001"

0cff68bb11-+-Removing analytics1013,1014 and 1018 from hadoop worker list in site.pp

1a0c3198a0-+-add ferm rules for udp2log

afa9718f4e-+-Enable base::firewall on dataset1001

cbb495b1f0-+-Add ferm rules for Hue server

4316d744fc-+-Add ferm rules for Oozie HTTP interface

c250918398-+-Fix the dumps list for ipv6

e2412a7a5c-+-Add a separate Hiera source for dumps mirrors only reachable via IPv6

4966e697fd-+-enable upload ipsec for eqiad + cp3034 for upload-reload testing

c82f7de143-+-Add ferm rules for puppet master backends

ca9a3e85cc-+-mail: bump MX's spamassassin max_children to 32

260a3495f3-+-ipvs: some rudimentary defenses via sysctl

90a6fc2816-+-Provision analytics1046-1049 as Hadoop worker nodes

a575f460e3-+-syslog-ng: remove srange for now

85f177a773-+-Enable base::firewall on lithium

b04be718b0-+-labstore: Remove autorestarting nfs-exports daemon

94619fcd79-+-labstore: Fixup start-nfs for new storage layout

1c62415eee-+-Labs: Subscribe self-hosted puppetmaster to hiera.yaml changes

a04dc2bba2-+-labstore: add tests for working backups

6a6167766b-+-charon tuning

628f7978ee-+-nrpe: Put the defines in the respectively named files

8dcf5f03a0-+-Add base role for debdeploy clients

feac9d8d94-+-Add a role to run a debdeploy master

c464326bbf-+-nrpe: add new checks for systemd unit health

5b078c2e88-+-global $::site_tier to replace varnish-level cluster_tier

e920b8aedc-+-wdqs: add monitoring group

78f92686dc-+-wdqs: declare system user and group

9dc3355336-+-labstore: tweak alerting thresholds

82e4d8fd7b-+-analytics refinery: remove jgage

c6db1bc670-+-Add ferm rules for rcstream

e01ec5748d-+-labstore: Fix ensure issues take 2

b2f9d06109-+-Resume running refreshLinks cron on enwiki

193d8aeac7-+-Get rid of old /home/wikipedia references

2111a5e687-+-Don't try to run l10nupdate on mira

1fee89e381-+-git: remove out-of-sync alert

6fbec5cbfe-+-diamond: start collecting nutcracker stats

a1e7c2b9ed-+-Deprecating mariadb::labsdb

0a50ff8c11-+-labstore: Fix ensure to be properly boolean

dcf1b66f1a-+-Revert "add base::firewall on labsdb1005"

8231ca1047-+-add base::firewall on labsdb1005

169ae98c3e-+-labstore: Use hiera to set currently active labstore

014169318b-+-nodepool: setup python logger

ed524be7cc-+-Labs: Remove various obsolete migration code

3304705be4-+-tlsproxy: refactor/cleanup, beta work

85ffc9f8e4-+-Enable base::firewall on ms1001

13ccccb871-+-zim: Add missing ferm rule

035a318261-+-Add legacy bits.wm.o support to text-lb VCL

56d99ee4ad-+-Enable base::firewall on multatuli

1a9f7b6573-+-Remove custom fact ec2id (2nd try), unused

a72fb7f614-+-mail: bump MX's spamassassin max_children to 16

1d456cb088-+-mail: rename role::mail::lists to role::lists

a5feb0d54b-+-exim: fold exim::roled into role::mail::mx

e0d0c4655c-+-enable ipsec for mobile and bits clusters

c96271543b-+-exim: reference the proper system_filter for OTRS

4142e84c2d-+-exim: use exim4 directly from role::otrs

d277955f4a-+-mail: re-add $outbound_ips/$list_outbound_ips to role

5d469e1e4d-+-exim: use exim4 directly from role::mail::lists

226d195522-+-exim: use exim4 directly from Phab/RT

4c12aa856e-+-exim: fix compilation failure due to ordering

5a576f7cd7-+-Add ferm rules for new Logstash ingestion module logstash::input::udp

b79c3638cc-+-exim: kill all exim::* classes except for ::roled

a65636cb23-+-exim: kill unused exim::roled parameters

faeb564f38-+-exim: inline @local_domains

bf70e33cd5-+-exim: remove $smart_route_list

0e82fe819f-+-mail: remove secondary MX role from sodium (2nd take)

a8265855c8-+-labstore: Add NRPE check for nfx-exports

ebe3886bed-+-labstore: Cleanup mysql user account creation for tools

68cb428ba7-+-labstore: Monitor that create-dbusers is running

f156401c7a-+-Add ferm rules for rsync server

45a22265a1-+-HHVM: Limit wall execution time of FCGI reqs to 145s

3e9b35dcf1-+-Add ferm rules for Kibana

55dc10a666-+-Add ferm rules for mariadb labsdb

3e6275024b-+-Add ferm rules for dataset NFS server

4001bc3baf-+-Set nutcracker log verbosity to LOG_INFO, per deployment recommendations

64f3750b83-+-nutcracker: prevent servers from being marked as dead indefinitely

333abb149d-+-enable ipsec on ulsfo text cluster

cac48f7cd9-+-labstore: fix typo in package name

c3a7fb7ef5-+-labstore: Fix typos

b298a09ea2-+-labstore: Add some package requirements for labstore*

437bdbf030-+-Add cleanup-snapshots script

18b747e8a1-+-Ignore warnings about URLs without modules for private repository

e5cffe6e4f-+-Add ferm rules for jobrunners

e099cb1299-+-nodepool: stop using diskimage

d3fdb4b7b2-+-nodepool: use OpenStack modules from jessie-backports

0bd82b6538-+-Ferm rules for Logstash log ingestion

b1d0a55005-+-enable ipsec on all remaining esams text

8672aff3b4-+-enable ipsec on cp3031,40,41

ecab80ea48-+-Add ferm rules for syslog-ng

ef9d458d3c-+-Use fixed ports for dataset NFS server

5765cf745f-+-ganglia: use recursion to tidy /tmp

b826921cc7-+-ganglia: cleanup old temporary graphs

56af628418-+-reduce tendril memory footprint due to OOM, and switch to /srv

390b3d7b70-+-enable ipsec for all eqiad text caches

651418a26d-+-enable ipsec for half eqiad text caches

ab3b0117ce-+-remove codfw cache::parsoid ipsec role (no tier2, breaks puppet)

c86d5d45df-+-enable ipsec for all codfw caches

11936276d5-+-nutcracker redis pool: listen on 6380, not 6379

f81f20280d-+-Re-add redis_auth to redis nutcracker group

347fe99a01-+-Labs: Remove reboot-if-idmap

ee3335d2cb-+-toollabs: Add support for uwsgi-plain webservice type

88c217b677-+-role::maps::master: Import waterlines on init and then weekly

5d179c82a9-+-session_redis twemproxy pool: listen on TCP, not Unix domain socket

6f7d949136-+-Cassandra logstash setup

8e5c86b0d9-+-cassandra: restrict data directory permissions

ef1510bfb9-+-exim: kill one-size-fits-all SMTP_IMAP_MM template

5d8ad82770-+-exim: split main MX config into a separate config erb

3494b96616-+-exim: split mailman config into a separate config erb

a96b3b4800-+-exim: split OTRS config into a separate config erb

c0c524b87a-+-exim: split rt_relay into a separate config erb

0d9f74c9a1-+-exim: split phab_relay into a separate config erb

2ae25fdc54-+-exim: untangle exim4.conf between roles & simplify

b9402fbfca-+-Revert "Add redis_auth to redis nutcracker group"

eb110f2e18-+-Add redis_auth to redis nutcracker group

810c16248e-+-Add 'session-redis' nutcracker group

17aa529560-+-labstore: Change permissions on db / ldap credentials

cbb4f3355a-+-labstore: Rewrite of replica-addusers.pl

36a1c71b06-+-Set up labnet1002 as a spare for labnet1001.

c9e0dda768-+-dynamicproxy: Make sure /var/www exists too

b96af94ade-+-dynamicproxy/tools: set up outage error system

bbf9e96a80-+-Labs: Fix puppetmaster::certcleaner for self-hosted puppet masters

9fc237ba09-+-switch nagios private contacts to secret()

025d2587e3-+-switch zerofetcher auth to secret()

2a717ca535-+-move majority of privates/files usage to secret()

36a0229e9d-+-Enable ferm for polonium

0b157807d6-+-Enable ferm on lead

abe4bcb885-+-base: Fix spacing / indent for service_unit

ede8b348ac-+-Add Phragile module.

4e94965164-+-labstore: Make storage-replicate executable

33395e5f6d-+-labstore: Fix boolean conditional to do actual needed check

cd259f1322-+-base: Properly support not specifying service {} in service_unit

fa7b6a8a33-+-labstore: Remove extra base::service_unit

3dfb6fc244-+-labstore: Add systemd units for replicating NFS volumes

89d8bd67f1-+-Labs: Script to back labstore filesystems up

6712d8c9a4-+-contint::packages: factor c::p::apt out

ad466b2641-+-contint::packages: factor c::p::python out

aacd597eaa-+-Add ferm rules for MX mail servers

03ce1f0225-+-contint: drop require to a user in LDAP

19ce477cad-+-contint: fully qualify unix command

eb5cb690e1-+-contint: pin tox to version 1.9.2

ae177229b3-+-contint: install etcd latest on Jessie light slaves

dfde70f491-+-Enable ferm for mc2* systems in codfw

70ee5ebd2a-+-add admin group 'wikidata query service deployers'

0850fa298b-+-Add ferm rules for HHVM admin site

e0ba61538b-+-add ferm rules for redis

10d2a5f8e3-+-erbium: add a log for beacon/impression

9c040fb203-+-Revert "cassandra: Fix strict puppet-lint warnings"

54b111324c-+-Add Android emulation prerequisites

67ecf83610-+-cassandra: Fix strict puppet-lint warnings

0185cf7df3-+-Provision analytics1042-1045 as analytics worker nodes

1b15f47a86-+-graphoid: enable spec-based monitoring

357366aa45-+-Remove firejail conditional

e8c64e206a-+-Add role::labs::mediawiki_vagrant

97babf3878-+-hhvm: expire APC keys after 2 days

470956c8e8-+-nodepool: systemd wrapper

cd0e67a58e-+-role::ganglia::web: fully qualify class inclusion

449bfc27c8-+-ganglia: rename ganglia_new to ganglia

a4d7c3b9a4-+-Enable ferm on labnodepool

356a345b5f-+-Make compaction alert less sensitive to short-time spikes

acdad279b4-+-ganglia: correctly use variable, not bareword

f6d32e746b-+-Enable firejail for graphoid

5a15145b7f-+-ganglia: standardize has_ganglia

c2133d3dbf-+-ssh: Disable LDAP key lookup for HBA

d8470866b7-+-phab: syntax fixes for extension management

672af2a71c-+-diamond: Use require_package instead of ensure_packages

ed6350c29e-+-Fix package_dir dependency for wdqs

121ed175cc-+-Ensure that phabricator/src/extensions exists

f1b8f55afe-+-grafana: Set a default dashboard

1927428ba5-+-ci: fix typo

af09086298-+-ci: fix ganglia plugins hotlinking

1ee6f3f849-+-ganglia: re-define generic ganglia class

c9b7e2219d-+-ganglia: remove ganglia.pp

e619f9b817-+-Revert "Ensure that phabricator/src/extensions exists"

f575e4feb5-+-ganglia: remove ganglia_class conditionals

4242b2fa03-+-Ensure that phabricator/src/extensions exists

cc92af4b84-+-Add definitions for WDQS service

6a8b42aa64-+-ganglia: remove references to ganglia::cname

d2f9bff236-+-ganglia: remove ganglia::aggregator

b37c1b4683-+-ganglia: move ganglia::collector to ganglia::deprecated::collector

88216b2d69-+-misc: remove misc::monitoring::htcp-loss

bdeccc17d0-+-misc::udp2log: use ganglia::plugins::python everywhere

2a714a9f4e-+-udp2log: use ganglia::plugins::python

237b6a3d84-+-ganglia: move ganglia::plugins::python to the correct location

04b685bfac-+-add ferm rules for memcached

3013f53445-+-ganglia: use ganglia_new by default, disable otherwise

daecd5a630-+-service::node: convert to base::service_unit, add systemd support

efee20514d-+-ores: Fix duplicate declaration of redisproxy in worker defs

f3937a34ed-+-ores: Use include style for redisproxy

d3c3b0faa2-+-ores: Add missing file

cf830402fb-+-ores: Add flower class /  role

0896404d6b-+-celery: Add celery::flower setup for setting up a flower monitor

8a6a76b1a2-+-postgresql: install postgis package for shp2pgsql and similar binaries

873ca50b7d-+-contint: drop jsduck from Debian slaves

5a7adbb4a5-+-maps: Tune postgresql

9562b829fe-+-Add icinga groups for maps boxes

848ee8208f-+-ores: Disable nginx cache temporarily

f56aea9401-+-Enable packet filter for stat1001

adfbc797ad-+-Setup LVS for kartotherian service on maps cluster

e28efe96a3-+-Assign role::kartotherian to maps role

48aed27c5d-+-Introduce kartotherian service puppet module and role

3667a1cce8-+-statistics: don't let Apache listen on 443 anymore

3d759c9fbf-+-role::postgres: Update to 9.4

cf144d29f1-+-postgresql: install pg_top to have a better idea what's going on

c5e469409b-+-Stop labsdb1004 replication to labsdb1005

16ecccfd18-+-wikilabels: Puppetize wikilabels infrastructure

308718305a-+-ganglia: Set up robots.txt at doc_root, not ganglia_webdir

98968394b4-+-ores: Install uwsgi python3 plugin only on web nodes

d8d76e6356-+-ores: Fix stupid typo

d3c34240e4-+-ores: Fix stupid typo

5525573401-+-ores: Install spanish dictionaries as well

67130e4aa8-+-maps: Include osm in role class

3e99a8fbf9-+-Revert "Set up a keypair for cold migration" and all followups.

c42da83eba-+-maps: lint the role

4315289886-+-maps: populate postgres granting SQL script

30af775b98-+-Specify a few more settings for nova::migration on controller

a09761c360-+-Don't require nova-compute.

587d9d0c43-+-Apparently a class name can't start with a space.

18b4f26c95-+-novamigrate.pp -> migrate.pp

69158f7dd2-+-More clearly define the novasync role on compute vs. controller nodes.

979e49aa8c-+-Set up a keypair for cold migration.

d9267f273a-+-WDQS: install info, site.pp for wdqs100*

d3de490d83-+-maps: Remove erroneous role:: prefix

1c10fab720-+-Assign roles to maps-test200{1,2,3,4}

1f0580ec56-+-eliminate redundant threshold alerts

fcb43ee888-+-The argument passing to check_conntrack is incorrect, it doesn't provide getopt-style argument parsing and with the currently passed arguments the script only displays the usage information.

5d0d9dc930-+-imagescalers: re-image mw115[6-8] to trusty, HHVM

afe908cf68-+-ulsfo upload caches: switch to ganglia_new

d12734ca49-+-ulsfo bits caches: switch to ganglia_new

94450d8dcc-+-ulsfo text caches: switch to ganglia_new

b625e2c8c1-+-ulsfo lvs: switch to ganglia_new

d30e98cb7b-+-ulsfo mobile caches: switch to ganglia_new

72d512aa96-+-firewall: add ferm rule for kafka

d1427ff00e-+-monitoring: detect saturation of nf_conntrack table

a5be4b1ba8-+-postgresql: Auto determine pgversion for user creation

a3883d9c45-+-ores: Add a separate worker role

c766a60ad0-+-puppetception: Run puppetception in  a cron

df2c33f5dc-+-Do not use releases::upload on beta cluster deployment server

07ca4e59aa-+-Do not backup beta cluster deployment server

6c57ea4a07-+-grafana: add ferm service for port 80

0f3194e998-+-iegreview: require package php5-curl

e0780d35ca-+-iegreview: remove role from zirconium

ca4af1cfde-+-cxserver: Allow for empty registry

929f220fee-+-racktables: delete namevirtualhost file

48570af765-+-use ensure_resource to avoid duplicate declarations

5277870553-+-Revert "hhvm: make cache files management explicit in puppet"

da1e112e74-+-iegreview: ensure deploy dir path exists

51c2d10551-+-ores: Add indonesian spell check package for ores

94bdbb5553-+-iegreview: add role to node krypton

37e638d411-+-Forbid robots from crawling ganglia

691694518a-+-ores: Switch staging to master branch

ef19f9ab56-+-ganglia::web: enable opcache

96f3050e19-+-Remove role::postgres::maps from labsdb1004

228542cb36-+-ores: Change wsgi file name / path to match new name

12d1767871-+-Split labs-specific bits of base into labs::base

8e99778e38-+-One last fix for https://gerrit.wikimedia.org/r/#/c/224465

0b015f4203-+-Labs puppetmaster still needs to set itself as hiera(labs_puppet_master)

52727eefd7-+-phab: create vcs user

b7abd3b3f2-+-puppetception: Simplify module a little bit

142ba6fbb7-+-phabricator::vcs: Fix package name to git-core

94e932918a-+-Phabricator: Clean up vcs manifest with proper dependencies

6fe5016098-+-service::node: fix typo

c4f2a4dfef-+-Use hiera for the puppetmaster name, everywhere.

d6aa09849f-+-citoid: enable advanced monitoring

c06b685793-+-service::monitoring: fix another typo

207b3be2b8-+-service::monitoring: fix typo

8e207715c4-+-restbase: spec-based monitoring

21ac034f3c-+-service::node: auto-monitoring of local endpoints

da1cd467ac-+-Gerrit: Remove ::labs role

01d12f07ca-+-Gerrit: Remove $extra_groups from replicationdest, nothing uses it

84fe960f8d-+-Gerrit: remove ::old role

457df0256d-+-misc-web: add node krypton as a backend

12443d1d8c-+-wikimania scholarships: remove namevirtualhost file

08b7089b79-+-wikimania scholarships: remove role from zirconium

f2a1c6e613-+-Don't use multi-master for labs salt.  It has never worked.

cad88a2d73-+-maps:: Add cassandra as a component of role::maps classes

0b30658d2b-+-Order postgresql::spatialdb after postgis

e574717883-+-postgresql::spatialdb is a define, not hiera autolookups

756335d227-+-sslcert: fix ::ca's ensure => absent

9510daf730-+-Phabricator: Turn on diffusion.allow-http-auth

52610530c0-+-role::maps: Assign postgresql::postgis::pgversion a value as well

29d603a5b6-+-Allow speficying postgis version in postgresql::spatialdb

1cd155b9a2-+-wm scholarships: fix puppet fail, missing deploy dir

63ef1d4db1-+-Use the labsproject fact rather than $::instanceproject from ldap

0a04537366-+-wikimania scholarships app: apply role on krypton

d2135689ca-+-add krypton to site.pp with base::firewall

f021924b45-+-ores: Use virtualenv package rather than python-virtualenv

4e9bd6817b-+-Introduce roles for the maps-team in labs

8db4ec187f-+-Enable packet filter for heze

13a912f919-+-move db1030 to correct node definition

b7d9b8d8cb-+-upgrade db1030 trusty

0ea5ca804d-+-varnish: default dynamic_directors true (changes eqiad)

79b721d77c-+-Remove dependency on echowikis.dblist

f041225075-+-monitoring: replace illegal chars in description

ca06c19227-+-Add ferm rules for statistics-web

6869bd2470-+-Run update-ca-certificates on CA removal as well

e4b19edbf9-+-mediawiki: fix jobqueue metric name

f56626c609-+-fix ganglia dns view host regexes

3795470125-+-fix typos from I67a16556

04264029ba-+-add frack subnets to network.pp, add frack-codfw to icinga firewall policy

74256e7b13-+-imagescalers: reimage mw1154, mw1155 to HAT

318b9d4e28-+-mediawiki: make www-data the default user

749c7ca1b3-+-Optionally disable connection tracking per service

3826311bdd-+-hhvm: use /var/cache/hhvm for hhbc files, per I83501931

84fd02499e-+-remove include ::diamond

6ce09ac927-+-site.pp - add comments about server roles

ccb5add2b6-+-Reclaim lanthanum: remove related puppet conf

67f211b28c-+-ferm rules for IRCd

38b90b5ab7-+-switch wmfusercontent.org to ECDSA+RSA

19e841eb90-+-tendril: add config template

77c512d5ab-+-Fix /static 404s in beta

c76a82fc3b-+-mail: hiera-ise mailman and lists

3f3e05ed83-+-puppetmaster: Cleanup of git-sync-upstream

cdbf9e1614-+-labs: Don't wait for NFS mountpoints every puppet run

2eea95ca52-+-ferm rules for bacula

e8710ff06b-+-openstack: lint fixes

111be211dc-+-ldap: Allow projects to override user's loginshells

fcc08866e6-+-Rename role::puppet::server::labs

b1f55a48d2-+-Move certmanager hostname configuration to hiera

50978eeaba-+-role::puppet::server::labs clean up allow_from

9dbb90d442-+-Switch on ECDSA Unified for primaries + parsoid

dbde6de8ce-+-role::puppet::server::labs Remove unused configuration

3ae9daa14c-+-nodepool: fix authentication URL

c2a357b135-+-remove OCSP for planet.wm.o cert (borked)

c229ddfe12-+-Switch on ECDSA Unified for misc-web cluster

1b74a49dd4-+-2layer: doc current weighting for eqiad-upload

6a96f4b9bc-+-nodepool: SSH private key is a payload, not a resource

217f578436-+-nodepool: fix typo pruge -> purge

3b92408c46-+-Increase the dispatching resources for Wikidata

f521eb155f-+-tendril: let puppet git clone on changes

197f80f462-+-Revert "test secret() again on cp1008"

72567539e8-+-deployment::server: move releases::upload into role

9840cb1d1d-+-Increase puppet-run interval from 20m to 30m

47826e45d2-+-misc SSL: switch to unified like others

a3b634fc48-+-Add a labsproject fact that doesn't rely on ldap config.

c868d78a60-+-mediawiki_singlenode: rename defined type

fa448134b9-+-openstack::nova::compute: use secret() for key

82f3375afe-+-move nginx->varnish dep to common ssl::local

dc100a4038-+-parsoid SSL: remove pointless SNI, add OCSP

57295097ca-+-removing rapidssl_ca sha1 intermediary from repo

cbf140451f-+-nodepool: create dib_base_path (/srv/dib)

5cb1948f14-+-test puppetized dual-cert on cp1008

c02df7087d-+-sslcert: refactor ::certificate/::std_cert around secret()

24ec683aa5-+-cassandra: upgrade cassandra-metrics-collector to latest version

f46cbb0379-+-hhvm: set apc expiration correctly

e6bc7d44a1-+-switch policysite role from zircon to bromine

4c1da25a53-+-nodepool: fill in SSH public key

f4a11fa02d-+-Install conntrack on hosts with the base::firewall class

08c48985b0-+-role::nodepool: use secret()

034e67ee26-+-Enable firejail for mathoid

c0c60092a4-+-Enable firejail for citoid

d9e62e20cc-+-Enable firejail containment for zotero

5f85c2acb5-+-sslcert::certificate consistency re title-vs-name

2c941daf08-+-sslcert::certificate use $group for crt, consistency with chained

a46811c844-+-Revert "sslcert::std_cert explicit deps"

11ee3a9815-+-Revert "Rename nodepool role to nodepool::server role"

9d9219a7ea-+-Rename nodepool role to nodepool::server role

28fec8cae8-+-nodepool: actually set $novaconfig

6992e867b1-+-nodepool: element to prepare an image for Jenkins

037293206d-+-nodepool: provide openstack env variables to system user

6c48a8b06c-+-nodepool: add guest disk image utilities

208c0e7410-+-nodepool: preliminary role and config file

798ccfb6c5-+-static bugzilla: add http monitoring

02fb417809-+-Add flag --all-projects to projectviews aggregator

9711c98260-+-mail: ferm rules for mailman

6835f9e9ac-+-cassandra: don't cronspam cassandra-metrics-collector output

05f69d7498-+-contint: Rename 'qunit' localvhost to 'worker'

0638bc9a65-+-contint: PIL 1.1.7 expects libs in /usr/lib

cde5b94f99-+-pybal::web: add the pybal syntax checker

addccd2a5b-+-pybal::web: only generate existing pools

053dfb37c7-+-pybal: fix dependencies

c51eaa31b5-+-pybal: refactor pybal::pool, print pools in pybal::web

66f17e1f4c-+-Bump phabricator tag to release/2015-07-08/1

1218e34558-+-releases::reprepro: move class into autoload layout

9607cfdd5b-+-few more lint fixes in role classes

fd7a8e47cb-+-Revert "ulsfo mobile caches: switch to ganglia_new"

27f8b5a638-+-ulsfo mobile caches: switch to ganglia_new

99902718a9-+-ganglia_new: add aggregator config for ulsfo

cc61d8b333-+-ganglia: add aggregator for ulsfo on bast4001

44f7aa14ca-+-Change php5 dependency to libapache2-mod-php5

3112288fcb-+-transparency: remove role from zirconium

ba977c0380-+-restbase: fix typos in description field

f62a5081f5-+-restbase - fix => alignment (lint)

d5bf2aa3fb-+-logstash: switch to ganglia_new

365e22087f-+-transparency: add role on bromine

b2fb3aa89b-+-Increase the NFS blocking time to 180 seconds.

d7faea6055-+-fix sslcert::certificate for sodium

e2b94d7eb3-+-make icinga firewall more readable

25303ef867-+-Add firewall to neptunium.

ddbce44c60-+-cassandra: use lock file with flock

56098fc751-+-cassandra: alternative metrics collector

97bf2e9880-+-test secret() again on cp1008

c9d01d1f51-+-ores: Fix typo

0ef09ec28b-+-Deactivate packet filter on potassium

5c7e961cab-+-Enable packet filter for potassium

e7a09478f8-+-uwsgi: Update Service['uwsgi'] to more accurate Service defs

b3daa1e1e5-+-uwsgi: Clean up uwsgi module

5af0ba4851-+-imagescalers: reimage mw1153 with HAT

76d4791a6d-+-Convert firewall resource declarations to an include for consistency

b09265c98b-+-sslcert::std_cert explicit deps

27fd49e23e-+-sslcert::certificate: no backup/show_diff on private

3a6b93a619-+-Revert "test secret()"

e09f14c42d-+-test secret()

c710d75965-+-annualreport: remove role from zirconium

ca17ef5661-+-tcpircbot: allow v4 connections from mira

2b13a65fa3-+-tcpircbot: allow connections from mira

bbccedf276-+-icinga: fix ferm rules on neon

46d989fd19-+-allow mira to connect to tcpircbot on neon

b2003ee9fd-+-annualreport: add role on bromine

290b106bab-+-chain fixes: ganglia, icinga, lists, rt, tendril, wikitech, gerrit

2b5e2d9ca9-+-deployment::server: move backup code into role

2113cf453c-+-remove GeoTrust_Global_CA => absent

ef6aa0d998-+-move 'include mysql' into role deployment::server

f0f1a4a95a-+-mira - deploy codfw - adjust roles to be like tin

76fa5917e5-+-sslcert: output both kinds of chain(ed) files

911c58e4a8-+-install mysql-client in role::deployment:server

b926ce3c41-+-Gitblit: Remove ssl cert stuff

a6e21382ca-+-Wipe bad Equifax-signed GeoTrust_Global_CA (ca-certificates has better installed)

6db1a6bbc2-+-beta: Replace deployment-logstash1 with deployment-logstash2

d67ceaf801-+-logstash: Enable user & group authz modules for Kibana

3eee71c447-+-uwsgi: Do not use custom startup script for jessie

f42677e071-+-enable ferm for nembus

ec64eb3fc4-+-Phabricator: Remove php5 from manifest

352063bc7b-+-contint: install python3-tk

22e2551d56-+-protactinium: add base::firewall

0fc5dc2663-+-Install nfs-no-idmap before probing nfs for exports.

ede70dd9af-+-Wait for a minute for NFS exports before trying to mount requested volumes.

8746c011db-+-fix for ce421097: .crt suffix for $ocsp_args

16b09ab876-+-fix for ce421097: kill dep loop

ce42109781-+-tlsproxy: multi-cert support, including ocsp

f2e190960d-+-Remove unused r::c::ssl::sni

cf56211724-+-switch tlsproxy back to "compat"; dhe is now implicit

9cb94333b0-+-upgrade db1041 to trusty + mariadb 10

024bbf957d-+-Move dhparam support from tlsproxy to sslcert/ciphersuite

d4cb7c23c1-+-Temporarily disable puppetization of EL processor on analytics1010 for testing

c2493bf67d-+-tlsproxy: enable DHE-2048 FS for Android 2.x, etc.

d910f3feac-+-uwsgi: Fix ruby plugin version for jessie

353bb894b8-+-celery: Specify template_name for systemd unit explicitly

f884b0412e-+-celery: Make celery::worker a define rather than a class

312eb9b554-+-ores: Vim has its problems, I must admit

bd6bc51c8f-+-ores: Fix conflict on including ores::base

5085eb2adc-+-uwsgi: Do not setup nrpe monitor in labs

888d4f9613-+-ores: worker role to do celery processing

dd8a03f1ff-+-static-bugzilla: remove role from zirconium

7a93e8ed17-+-Limit LDAP access to internal

7fdad2b164-+-labstore: Consolidate NFS exporting into daemon

631377f17b-+-Remove Gerrit replication to lanthanum.eqiad.wmnet

8ce752fd43-+-contint: do not install zuul on light slaves

3e91574d68-+-contint: authdns::lint on light Jessie slave

266825ab10-+-contint: role::ci::slave::labs::light

91f6b8a7da-+-misc-varnish: allow HTTP DELETE (for deleting dashboards in tessera)

d435252a18-+-Remove bastion1 and bastion2 from labs bastion hosts list

3c2d1f8dc8-+-ores: Fix scoping issue with src/venv/config paths

bb7cf7313c-+-ores: Move ores initial install setup into a base class

3586de4fce-+-celery: Create simple module for celery workers

82aac94604-+-Blacklist kernel modules

5a526d59f8-+-bromine: add standard

1bdecc1416-+-static-bugzilla: ensure /srv/org/wikimedia exists

da9e336bc4-+-Add the Services team to the contact list for RESTBase HTTP checks

8f97c58b00-+-add varnish::logging::rls to remaining 2layer varnishes

767dc10743-+-Add varnish stats reporter for ResourceLoader requests

7ebc10edf3-+-Switch on salt auto_accept for labs.

7654a5103e-+-puppetmaster: Enable autosigning puppet certs for labs

1acdb192f5-+-Use new ganglia IPs and Ports for analytics clusters

8a31987fbb-+-tools: Dark launch new webserice-new webservices

116b7258f6-+-labstore: Run exportfs on every run of the daemon

2745d77478-+-labstore: Restart nfs projects daemon when source changes

a51fc38348-+-add new node bromine, add bz-static role

468f1f752a-+-iridium: add ipv6 addr

368309dad0-+-Tools: Simplify and fix mail setup

808bd80d2d-+-phab dumps rsync using ipv4 client addr

ef430df862-+-rsync of phab dumps from iridium to dataset1001

f038395b8f-+-labstore: Fix implicit cyclic dependency

a90f47d310-+-labstore: Rename and sacrifice to Lord Puppet

1c8d27f2f9-+-labstore: Rewrite of manage-nfs-volumes-daemon

aab6ecc79e-+-Change privs for pdns.conf

5085d81dea-+-cassandra: add team-services for cql failure

00ad36a81b-+-restbase: check http connections

027447f35c-+-Allow optional firejail containment for nodejs services.

2b06db20e8-+-Replace static-hash with hostname normalization

356e5a5944-+-switch analytics and analytics_kafka to ganglia_new

7594f1f307-+-add bromine as a misc-web backend

c412c828d2-+-bugfixes for b13b9157 (dependencies)

76a5132487-+-Make Coal's whisper files accessible to Graphite front-ends.

b13b91576f-+-sslcert: replace install_certificate with sslcert::std_cert

1fa37806bd-+-tlsproxy: add 2048-bit dhparam file to nginx

2c9b7415b8-+-increase size of key cache to 400MB

4a4f10f319-+-Bump phabricator release tags refs T104047

b74bc765a3-+-labstore: Fix typo

6ca0f85ddf-+-Make ferm list into an actual list.

0a0408ea03-+-labstore: Move replica_addusers into its own puppet class

eff251a485-+-Tidy up firewall rules for puppetmaster and salt

63c490ce7e-+-Reenable ntp by default

721fc85339-+-Correct error in wikimetrics projectview simlink

5dc9e4842e-+-varnish: always generate the dynamic directors lists

3e1e2f0544-+-protoproxy/tlsproxy: big refactor commit

3890f0c2ab-+-Add Pageviews/LegacyPageviews to metrics website

ce669b3de6-+-etcd::ssl: do not restart the server upon changes

518ea45918-+-install-server: rename module to install_server

4a09514865-+-upgrade db1034

069716447f-+-Wikitech: rebuff requests to beacon/(.*) with an HTTP 204

2047e9c802-+-confd: wrap linting and manage error state file

a4b476272b-+-Tessera: Restrict POST / PUT / DELETE to wmf / ops / nda LDAP groups

c5b64b39b1-+-Fix-up for I2e47c63c0: correct Trebuchet deployment path for Tessera

7e09f6074e-+-Add tessera module and role; apply on graphite1001

0ec84c7ee4-+-tendril: git clone from wmf repo via puppet

c02fab7142-+-primary ssl services -> unified-only, not SNI

ea34a806a8-+-lvs: hieraize lvs_services and lvs::monitor

462ce24a2c-+-labstore: Fix typo

02c3a22827-+-labstore: Do not pass monitor_iface to labstore::fileserver

85b8a0b2b1-+-create ssl::unified as a non-SNI alternative to ssl::sni

830b04f56a-+-labstore: Split monitoring out into its own class

2f4c983e03-+-Add a new limn datafile generator: extdist

47c3365849-+-labs: Remove manage-keys-nfs and friends

b714ded291-+-labstore: Move stuff into module from ldap module

bba541fd2c-+-labstore: More puppetization fixes for labstore*

c52f2a43e9-+-Need to append stderr to log file for aggregator cron job

afd63131ad-+-Redirect stderr of this cron to the same logfile

b608e89ad4-+-confd: monitor template failures and file removals

00ccd09a28-+-Fix for lvs::monitor_service_http_https

e57398552e-+-restbase: drop illegal characters from alarm description

8eeffbe636-+-configure additional Cassandra metric alerts

71441fbd47-+-cassandra: enable diamond collector

d99cad3f3c-+-Enable auto commit for kafka consumer ingput in eventlogging  procressors on analytics1010

e226901da4-+-base: Install molly-guard everywhere

f0ad9ae29a-+-contint: Add 'libffi-dev' package

00c4333452-+-contint: Create symlink for composer in /usr/local/bin/

2748911d01-+-Use overridden direct DNS for all LVS

bc7fbbd01d-+-Update db1022 to mariadb 10

f761891a15-+-Don't prepend seqs for kafka forwarder

708e6557bb-+-Delete loginlb from LVS configuration

a7d9effdc1-+-s/projectviews/projectview/

632ad17864-+-Need to include the new projectview and projectcount aggregator classes

9538ec2a69-+-Add new projectview to projectcounts aggregation

79ea0ec9ad-+-Explicitly use eventlogging role so that hieradata for admin::groups is applied

542e932871-+-Remove eventlogging::reporter from hafnium

87f2f8fc31-+-Refactor eventlogging monitoring classes

f749d5eeb2-+-varnish: add service to the directors options

e9f5ed60a5-+-labs: Centralize config of which projects have NFS enabled

7dcfca324e-+-move text backend_random into "directors"

cfd4fadbb8-+-etcd: decommission etcd1003

017093abad-+-Typo fix

2d546323bb-+-apt::daemon: force hiera lookup for ensure argument

c13dacff11-+-etcd: add conf1003 to the cluster

3689d6d52c-+-etcd: configure and add conf1002

6d9036b94b-+-Use hiera to disable ntp fleet wise, with exceptions

f3dfc77627-+-Add ensure parameter to ntp::daemon

1c5ce3969f-+-lvs: add lb suffix to misc_web

98943f412d-+-Remove more unused lvs::monitor manifests

69e8e60943-+-Merge lvs::monitor hashes

aa176def3a-+-Merge all lvs::monitor_service manifests into one

5d37d5caee-+-lvs: split monitors to respective files

447e24da1f-+-Remove $::hostname == 'cp1048' gate from varnishxcps invocation

76e4f924ca-+-Add varnishxcps from I08679839 to 2layer role; still restricted to cp1048

942e983097-+-Accumulate X-Connection-Properties stats and report to StatsD

6a40661b3f-+-Turn on autoupdate_master by default.

bd924d4e97-+-Configure eventlogging kafka forwarder and processor

aebcc12421-+-Revert "Use cronolog and logrotate to avoid Puppetmaster Apache reloads"

85c05eb956-+-Need to escape % in cron command for hdfs balancer

d811179c75-+-Use multiplexer_host for graphite consumer

54fa58df5b-+-eventlogging: HAHAHAHA

8f85ba8d4e-+-Fully qualify references to ::eventlogging::monitoring

4ed0cbf2b0-+-Depend on eventlogging::monitoring class, not resource inside the class

28b7b0beae-+-Use require to include eventlogging::monitoring so it is evaluated first

c8ea8eb9d7-+-Name nrpe monitor services differently for graphite consumer and main monitor

3765726a86-+-Use include to avoid class conflict for eventlogging::monitoring

59bdea489e-+-Refactor eventlogging role classes to make it easier to include different processes on different hosts

874c4155a4-+-base: Sort list of packages in base

aa0e95090d-+-confd1001: join the etcd cluster

bea3be4a52-+-confd: do not declare rsyslog/logrotate rules for upstart-based distros.

7a345d7f46-+-lvs::configuration: use hiera for lvs_service_ips

576a3eab0a-+-Puppetize toolserver.org legacy server

73591b12db-+-planet: besides http_proxy need https_proxy too

b521fd31dc-+-planet: fix to variable name for proxy

853adcdce1-+-planet: proxy through url-downloader to fetch URLs

bb436e1149-+-planet: install xslt-proc

072d89d8a1-+-cache/misc: add planet1001 as a backend

ba4b43bc5a-+-planet: remove role from zirconium

b6ebdc533a-+-planet: remove feedparser.py

36175d73f4-+-logstash: jessie support and beta cluster cluster

a81690c478-+-Set hhvm.jit_pseudomain = false on all app servers

784c6196f0-+-cassandra: merge submodule

314dba8338-+-Remove subversion server support

e354fa557e-+-pybal dns_rec: flip config names to match pybal.conf for clarity

7d399bb207-+-Remove notifyNewProjects script

ca756f1897-+-dev.wikimedia.org: delete puppet module

7b3c59dc0d-+-define LVS for recdns over TCP

cc77446bf2-+-bugzilla_static: include role::backup::host

2f4176dd79-+-better role descriptions for some misc services

f4a028f796-+-Move the glance image dir from /a to /srv.

b57112d816-+-backup home dirs on bastion hosts per role

7ca429d00f-+-Add a cross-labstore key for backups

c0360ca895-+-Labs: fix completely dumb typo in role::labs::nfs

10d7593530-+-Make labstore configuration into a module

4bc222db96-+-restructure varnish::instance's "directors"

9a7bdca7de-+-Disable temporarelly on stat1003 a cron job (mobile data)

58a8b53960-+-lvs::monitor: merge configuration hashes

8b7a57e8e3-+-lvs::monitor: Removed hardcoded IPs

1329f9dc2b-+-Migrate lvs::monitor to hashes and create_resources

0417eb7cb0-+-ssh: Unify config between precise and trusty/jessie

d94724e73d-+-Get rid of unused director_options

ae47b3a70a-+-contint: Fix syntax error in localvhost documentation

f4e2c7dcc2-+-bugzilla: backup dump and static files

898a9a2947-+-Get rid of the default_backend setting

383315bd9f-+-confd: cleanup template and toml dirs

74240dcef4-+-Remove puppet defs for virt1000; add them for labcontrol1002.

11c83f3b26-+-Follow-up to I2af5c88f98: remove reference to xenon/theme

09f534da94-+-Bugzilla: remove module, keep static version

73b64057b0-+-Get rid of unnecessary WikitechPrivateSettings.php

c38c25b238-+-confd: nrpe two procs is still sane

2a8a991666-+-lvs: fix name of conftool cluster

5a5e8412d3-+-Setup a node pool file from etcd for lvs cluster

a5cb263ed5-+-varnish: actually use the dynamic directors list

2802197ce7-+-Add cdbs to default packages

42b9e22825-+-contint: no more install openjdk-6

954ba49841-+-confd: create sub-directories

03b031d588-+-varnish: add generation of the dynamic list of directors

9bb3219a67-+-Use cronolog and logrotate to avoid Puppetmaster Apache reloads

e84d2528de-+-Set www-data as owner of performance docroot

4b64e7ae2c-+-Move performance.wikimedia.org out of operations/puppet

fd85fefb1f-+-labstore: switch to ganglia_new

1dedff1070-+-planet1001: add to site, apply planet role

0c57a36823-+-rcstream: fix TLS configuration

d76d9bddb4-+-nova: fix string containing only a variable

28724a0587-+-Add a retry for wikipedia check_http checks.

a6a7b19d59-+-phab::migration => phab::tools with dump

a0a5a0ae91-+-Always include base in role::labs::instance

a8563a36bc-+-racktables: notify apache2 Service

6b13f8a6ef-+-racktables: increase default php memory limit

220ffc9cef-+-labs: Disable wikitech puppet status reporter

1b844acd6e-+-Update for Id19ed540bee9f4

4a4f2b0e1d-+-tools: Install python3-scipy only in Trusty

cd5a481ca8-+-puppetmaster: don't depend scripts on role::access_new_install

067c058851-+-tools: Install python3-scipy

71b2faf77c-+-wmflib: os_version handling of Debian point-releases

06f993c579-+-Updating es1004 to mariadb10

669e801ba5-+-Upgrading es1003 to mariadb10

94e8d0af09-+-puppetmaster::scripts: include reimaging scripts only in production

ffd2b53748-+-labs: Update to newest openssh-server only on labs precise instances

ab17058cbd-+-quarry: Add query killer role

c1cff56f81-+-role::conftool::master: fix puppet scoping (!!!)

9d2f990c2a-+-conftool: separate master role out

9f0a9a82d2-+-conftool: fix variable name

fa1014ec11-+-conftool: fix ssl_dir

c8d171cec2-+-role::conftool::master: introduction, apply on palladium

534140a8ab-+-puppetmaster: wrapper script to access d-i over ssh

fc24f43e17-+-Add silver to mw_appserver_networks, so it can be a deployment target

3626f7cb3b-+-Add cron to import eventlogging data from Kafka via Camus

81e71315a0-+-scap: allow mwdeploy to control Apache processes via sudo

e86b08c11d-+-lvs: Add definitions for conftool

9aed6f1124-+-scap: require python-psutil and python-netifaces

75f7d8f741-+-eventlogging::processor's output_invalid parameter is now smarter.  Make kafka processor use this

6aed5cb826-+-Server side eventlogging forwarder needs count => true to generate seqids

15a0e97a04-+-Install eventlogging on analytics1010 and configure it to process events for Kafka

872b4384e3-+-Modify eventlogging module to use new changes to eventlogging server

5066ed6ccd-+-Set default replication factor for kafka topics to min(3, size($brokers_array)

41b464ceef-+-confd: include the confd class in confd::file, start by default

8cae8716fa-+-mediawiki: remove useless lib* dependencies

3ba2740773-+-Wrap varnishkafka ganglia monitor with has_ganglia

0bef4f718a-+-quarry: Don't install flask and mwoauth everywhere

fe5ad9b299-+-mediawiki: add python-pygments package

5f3f9d033d-+-Revert "analytics_kafka: switch to ganglia_new"

1a73479560-+-analytics_kafka: switch to ganglia_new

c56207478a-+-Fix jmxtrans process check command for newer version of jmxtrans

7f87490838-+-mysql: set ganglia cluster in hiera, not site.pp

60cbc677bf-+-Update jmxmodule for jessie package, change ganglia host and port for zookeeper on conf100[123]

7e41040ac8-+-labcontrol2001,nembus,neptunium: set cluster in hiera

abcd411cbe-+-Switch back to varnishkafka graphite_threshold with percentage check, disable graphite_anomaly

b6924c76fb-+-Fix over => true for vk drerr anomaly detection

d301a2386e-+-Fix typo in graphite_anomaly

c4dfc8d95f-+-Use graphite_anomoly to alert on varnishkafka drrers rather than graphite_threshold

4a247c9e3a-+-Use class {} instead of include to include classes in eventlogging role

d509dfd5d5-+-switch misc cluster to ganglia_new

4c0032a1cc-+-Lint lvs::balancer

4b0b0ed17e-+-lvs::balancer: Remove old absent system::role resource

5dc05147cf-+-Lint lvs::monitor

454e1dbf1b-+-lvs: Move the role manifests into the role module

afc5251c6c-+-Revert "hhvm: add monitoring for translation cache space"

2adf142dba-+-lvs::realserver: Lint it

18843b0d1e-+-lvs: Add ulsfo in low-traffic

820f11257a-+-Remove site.pp references to analytics102[345]  They have been renamed conf100[123]

ad18b28df8-+-Update citoid tests

58c60ffe81-+-enable pybal for primary prod services in codfw

414a4bd70c-+-codfw: add primary prod svc IPs to lvs::balancer

8611882471-+-codfw: define primary prod LVS service IPs

dd0afbc62b-+-add codfw caches icinga monitoring groups

d63b05b33f-+-bugfix for 0ad33c01: s/wm_primary/mw_primary/

0ad33c0161-+-parsoidvarnish: svc backends at primary dc

b53e064610-+-parsoidvarnish: remove unused backend-backends

2c5d4208c8-+-Beta: CX: Enable Welsh -> Simple Apertium MT

bede212687-+-confd::file: revert change to the interface

db57385afd-+-Hieraize deployment configuration

fa5c134ca0-+-CX: Add support for Urdu<->Hindi Apertium MT

40d6e19f33-+-cassandra: install openjdk-7-jdk

c6c3fc7468-+-cassandra: ship logback.xml with longer retention periods

1198743cd8-+-Revert "install fonts-wqy-zenhei on app servers"

a3bb810d6b-+-install fonts-wqy-zenhei on app servers

9a09b3d189-+-coal-web: use linear interpolation to estimate missing values

8e6ce9091b-+-appservers: switch to ganglia_new

8d86b83ba7-+-mysql: switch to ganglia_new

59544473ea-+-analytics1025 -> conf1003

ed052719be-+-Qualify erb template variables

e6c56c9a42-+-Add exiftool to multimedia role

d6289b5c60-+-beta: Change kibana password location

2f55a30e2a-+-Update zookeeper ferm to allow connections from all internal networks

8df17a4365-+-analytics1024 -> conf1002

81dc25d09b-+-labs: do not use nfs on precises for ssh keys

498960609f-+-Revert "puppet/self: use the appropriate override"

103148552d-+-puppet/self: use the appropriate override

68ce216f65-+-fix up log rotation for salt minions/masters

2489b3d913-+-Revert "logstash: switch to ganglia_new"

917a739452-+-logstash: switch to ganglia_new

5f90a34c3f-+-upload caches: switch to ganglia_new

c2cd2077e2-+-Disable backend-layer retry503 for text and mobile

8ad3731b7c-+-Bump phabricator and security extension versions

430bb07094-+-Get controller_hostname from the designate config rather than pulling in a nova config.

67940b8210-+-mediawiki: fix jobqueue alarms after renaming

b1118ec88e-+-Provide python-nova-ldap with creds to the nova api.

00d70ce84a-+-text caches: switch to ganglia_new

7b300c4dbe-+-bits caches: switch to ganglia_new

838018d29b-+-analytics1023 -> conf1001

c4b27ff81c-+-nfs: kill most classes, now defunct

9b5e38c76d-+-Include python-novaclient on the designate host.

adbeed7b1a-+-Allow designate to call back to keystone.

f09b070d42-+-phab: update phd monitoring

ae03f73411-+-Prep for reinstall and rename of analytics zookeeper hosts

20ae2e24d2-+-API appservers: switch to ganglia_new

ac045b3921-+-LVS: switch to ganglia_new

894d2ba0d5-+-confd additions for pybal

9faee37402-+-pybal additions for confd

738418d41e-+-mathoid: remove the require

696ba14431-+-mathoid to service::node

f0d7596e16-+-Kill role::puppetmaster::config

2baa8353ca-+-Remove Parsoid job runners

a61e9f3628-+-Phabricator: Add a symlink to arcanist in /usr/local/bin

436bb6c305-+-Labs: move set-stripe-cache to cron

5f5e718291-+-elasticsearch: allow control of dynamic scripting

92ae93fe5c-+-zirconium: Remove the etherpad role

dff758cde6-+-HTTPS: keep new redirects code limited to text/mobile/upload for now

0fcc9fb027-+-Ensure openjdk-7-jdk is installed via the zookeeper::client role

a734fc4fe3-+-conftool: create puppet module

a217a40df3-+-tools: Remove exec_environ from shadow

99cfd3ce31-+-Resolving grant issue on parsercache

daaae5ce72-+-Revert "analytics: switch to ganglia_new"

dd31669ae7-+-analytics: switch to ganglia_new

441ab91bb0-+-mobile_caches: switch to ganglia_new

1cab0713b6-+-labcontrol/labnet1001: set cluster in hiera

8111296e7e-+-labs/virtualization: switch to ganglia_new

5e8e4801fd-+-misc-web: switch to ganglia_new

94ef7dca76-+-swift: switch to ganglia_new

cae2c046d2-+-service cluster A: switch to ganglia_new

d6d2c2dddf-+-mediawiki: do tidy /tmp, but with a cronjob

60499617ef-+-Give a hiera lookup a default of 'undef'.

cba55d069b-+-Work around ipresolve's intolerance of IPs

4e694882e8-+-Move labs-ns0 to labcontrol1001

5b67aa96bc-+-Restbase: add paging support configuration

6f0a0c416f-+-Phabricator: Enable the webserver to serve git repos

2f27a3cc29-+-Add Jessie zookeeper version conditional

f03bf847f9-+-corp OIT LDAP mirror: switch to ganglia_new

1df1fa0e1b-+-imagescaler: switch to ganglia_new

51c3885ee1-+-Use / instead of . in sysfs paths

e12424de9d-+-Rename file_line resource in tmpreaper

ecfd5645a4-+-Apply ::tmpreaper on canary app servers

4952ed4968-+-labsdb: Disable transaprent huge pages

1f5ec7aa3c-+-Revert s/en/de/ for LVS monitoring; switch ProxyFetch to TLS

fc5bb89486-+-ssh: Disable agent forwarding for production

1e1011cfbf-+-Add tmpreaper module

885701e858-+-confd::file: correct the regsubst arguments

15fdfd3138-+-Set hhvm.hack.lang.iconv_ignore_correct for //IGNORE behavior

b796008b33-+-labs: Update bastion host IPs in network.pp

cd343f9c03-+-Switch LVS monitoring to dewiki (mobile, too)

89c1673c8a-+-Switch LVS monitoring to dewiki

8090020dca-+-Fix masterregex in the base image puppet.conf

9fbe0e4c1a-+-Revert "Have cloud-init run firstboot.sh rather than using rc.local"

70eee71df1-+-restbase: switch to ganglia_new

1b83228728-+-Remove reference to firstbootrc.

675f0512bd-+-rcstream: swtich to ganglia_new

e2806bf4cc-+-elasticsearch: switch to ganglia_new

50c69d94b5-+-Have dnsmasq immediately feed the labs recursor dns server to new clients.

7e9b06daae-+-redis: switch to ganglia_new

e5ccb272f5-+-parsoid-cache: switch to ganglia_new

57c3ea5258-+-parsoid: switch to ganglia_new

90a9281ada-+-Add content parameter to diamond::collector define to allow for templatization of custom collectors

d3739f1b26-+-memcached: switch to ganglia_new

1faec5f2fd-+-tmh/videoscaler: switch to ganglia_new

a9a795e4fb-+-restbase: use transformNull for graphite metrics

3cc0d9d6ee-+-Fix T102142 - hotfix for phabricator Sprint extension.

0f30d980de-+-One last resolv.conf attempt before bed

0c9882ceb3-+-Blank out resolvconf right out of the gate.

8ce34728a8-+-Catch labs_bootstrapvz up with domain/dns changes

315953a091-+-restbase: add restbase100[789] to manifest and hieradata

dac02770ef-+-Add cloud.cfg to the labs_bootstrapvz setup.

0b32b9ee2b-+-Another attempt to get the right domain into resolv.conf on firstboot.

b52ec7c3c9-+-Make sure that python-diamond is included before adding the labs collector.

bef9446305-+-Update resolv.conf and puppet.conf for new domain and dns scheme

038df98bf1-+-Override default cloud.cfg with a custom file.

f27b32dd54-+-For cert names, use the fqdn instead of the ec2id.

ca27502786-+-Don't sync between glance hosts if we only have one.

264c4b6b2a-+-contint: authdns::lint is only now only for Jessie labs

078b98be61-+-Add etherpad1001.eqiad.wmnet as misc varnish backend

69ee829056-+-Sort misc varnish backends

7e2da1015e-+-lvs, cache: Clean lvs swift entries up. Populate cache configuration

c3a35f6098-+-jobrunners: switch to ganglia_new

29565924ee-+-puppet: temporarily disable the labsstatus reporter

a6d96362a1-+-varnish_instances: qualify var

148db78527-+-Revert "RT: remove HTTPS monitoring"

40a4c370a5-+-Revert "RT: stop installing SSL cert"

15f262dedc-+-Install python-kafka on statistics compute nodes

f6f2b47f70-+-add ipv6 nets to deployable_networks

d7214c7150-+-ldap: Remove ldapkeys file / user via puppet

650d1f7541-+-network: add IPv6 addresses for tin/mira

1801dfa2de-+-ldap: Move ldap key lookup ssh helper to /usr/sbin

354e891aea-+-archiva: fix SSL certificate filename bug

b3f7301214-+-certs: inline privatekey=false install_certificate

cd53d5eab8-+-certs: remove $group from install_certificate

0ed12cd7cf-+-ores: Explicitly define nginx cache to be true for prod lb

84a56aea6f-+-deployment_server: fix salt-call path

92e24a96dd-+-certs: replace require by collector ordering

5cd3618d1e-+-role::etherpad: include standard

8ddf8af80e-+-ssh: remove .ssh/authorized_keys support from prod

734c2df1b8-+-ssh: Don't look for keys in NFS on non-precise hosts

1e521f5436-+-labs: Disable mounting /public/keys on non-precise hosts

e1192aa2a3-+-ssh: Fix annoying indentation error

ca64646d5c-+-labs: Allow granular control over which NFS mounts are mounted

6b6a24d5f9-+-Bump phabricator release tag

88ac63118b-+-ores: Don't ensure latest the deployment repo

cda13917bd-+-labs: Count /data/scratch as shared storage

206705d1c8-+-ores: Switch to newer deployment model

31a04ae525-+-ores: Fix typo in role definition

a52a252506-+-ores: Add redis and redisproxy roles / classes

b5f4f8ffc6-+-labs: Allow using hiera to turn off NFS homes / shared storage

9626d6ff7c-+-tin: set cluster in hiera, not in site.pp

f097929626-+-Revert "Move labs-ns0 from virt1000 to labcontrol1001"

93ce7b3f03-+-Move labs-ns0 from virt1000 to labcontrol1001

d07e4fc410-+-ores: Don't overwrite staging branch with deploy branch all the time

3600ac2afb-+-Open openstack controller firewall for the nova api server

7941f1b3dc-+-Make labcontrol1001 the primary nova/keystone/glance host.

cf4c1ac4b0-+-Move HTTPS code into wikimedia.vcl

9987d1c494-+-Install varnish reqstats diamond collector on just cp1052 for testing

94d7cbec18-+-Add varnish request stats diamond collector

81e7b6800c-+-CX: Log to logstash

e617c67ab6-+-mediawiki: revert tidy of /tmp

42d113a22a-+-etherpad: Require the package before populating robots.txt

69841efe36-+-Tools: Add python-ipaddr to exec_environ

5eba353412-+-Assign roles to etherpad1001.eqiad.wmnet

afbe5861e7-+-etherpad: ensure present

7b31a24737-+-mediawiki::multimedia: only tidy /tmp/magick-tmp

6deb5b6aa2-+-mediawiki: tidy /tmp

2be00809dd-+-restbase: fix graphite description

59b127d88c-+-restbase: add error rates and storage latencies alerts

f7ca2ab84a-+-ores: Move virtualenv handling completely to fabric

c7b15ca21d-+-duplicate hieradata cache nodelists for ipsec

95c41f4d37-+-ipsec role: regsubst syntax fixup

5bf85bf1cd-+-ipsec: deploy to cp3030 + cp1065 (text caches)

509522839c-+-Make sure that glancesync can write to the imagedir.

076f215a8c-+-glancesync is a system user.

74ef63adc3-+-We don't really need a 'glancesync' group.

a3116af782-+-Rsync glance image files to the controller spare

acc4a831bc-+-Remove graphite hosts from backups

2ac2aea116-+-Disable eventlogging kafka client-side event processor and consumer

95ad6c0edb-+-openstack: Don't use special characters in mysql description

62edd540bb-+-openstack: Fix typo, follow up previous commit

258db001b2-+-openstack: Add a check to see if Tool Labs instances are spread enough

b2af43d3cc-+-role::etcd: use ssl, "fix" the ferm dependency

1c6045888d-+-role::etcd: require class explicitly in the ferm rules

257c41e96c-+-etcd: resource ordering fix, ganglia fix

851a826b93-+-Remove use_dnsmasq logic.

04bf8d0f38-+-role::etcd: define etcd::host

f6f3067aae-+-ectd::monitoring: fix typo

61ca1b7a2e-+-role::etcd: fix ferm, add monitoring

ed82fc508e-+-ocg: switch to ganglia_new

46d10afea1-+-Upgrade es1007 from MariaDB 5.5 to 10

76bfbe0a13-+-etcd: setup servers/ganglia stuff

ba3fa2a86f-+-Tools: Do not require package python-sh

92a6c35bc6-+-turn text/mobile-be retry503 behavior back on T97206

61841b150b-+-Use ipresolve in a few more places.

b26e3702da-+-RT: stop installing SSL cert

c097a86a56-+-RT: remove HTTPS monitoring

89825f8e07-+-remove ipsec role from cp1008

8df297913e-+-Add authdns::testns to cp1008

643e6fc39f-+-Revert "Rsync glance image files to the controller spare"

a9abf0e383-+-Rsync glance image files to the controller spare

e9a8435805-+-Move the glance image datadir into a puppet var.

086145c220-+-Fixed ferm syntax error

14bba242ed-+-Allow labvirt1001 to talk to keystone and nova and such on virt1000

5f02ce59d2-+-Rename openstack::firewall to openstack::controller_firewall

3327dd238c-+-Open up firewall to include a spare openstack controller

b4846929a3-+-ganglia: configure the ganglia aggregator for eqiad

ed933a33d3-+-ores: Fix typo

6432016ece-+-ores: Introduce staging role, make caching lb optional

873fb402ad-+-toollabs: Specify redis IP manually

73ee3e6fdb-+-labs_lvm: lint fixes

e9919f7aba-+-authdns: switch to new ed25519 key

1afa137383-+-base: remove wmf-ca ensure => absent

ff886bc634-+-base: kill the wmf-ca CA

4bc2face53-+-add IPv6 for silver (wikitech web)

6379a41ec0-+-rsync_slow_parse: run at 23h15m

bb8ef3114d-+-Rsyncing slow-parse logs from fluorine to dumps.wikimedia.org

da2f050608-+-base: kill annoying mpt-status emails

39fbec040f-+-Turn on Kafka auto topic creation

93e3183290-+-ssh: Make hba enable-able via hiera

4331f28f96-+-s/controller/host (type)

8efaff3a60-+-Distinguish between glance and keystone IP.

cb9b9353ef-+-Tool Labs: add old-style fqdn aliases to nodes

1894c81ac7-+-mysql: indentation fixes

8cab36bdd0-+-Make it possible to install multiple custom diamond collectors that use the same source

96e01822af-+-mobile: retry503x1 in fe, no other retries

e3c37aad67-+-no-op: remove explicit default retry5NN => 0

04aa01a524-+-Include ruby-ldap on puppetmasters.

ba200381a8-+-ganglia: use SSLCertificateChainFile

a481586876-+-disable text-backend retry503 behavior

38efa8e3ad-+-For self-hosted puppet, require simple puppetmaster name.

c7ffef8708-+-chainedcert deps: one more bugfix to prev commits

2ff7b1014b-+-add path to chainedcert exec

811844b2e3-+-sslcert::chainedcert deps: a better solution

68387501e8-+-temporary workaround for messed up chained gen

3a3d18aa59-+-trying to fix chain-regeneration dep issues...

ffe3ef08d2-+-Bump phabricator tag

38b0246124-+-ldap: fix broken dependencies

9d2e91ed46-+-varnishstatsd: notify service when code is touched; touch code

d959c8b639-+-zookeeper_hosts: qualify var

1b0b344dc2-+-ldap: remove wmf-ca addition from the truststores

c382972726-+-ldap: kill ldap::role::config::production/corp roles

afbcc94211-+-sslcert: cleanup for ::ca ensure => absents

1a195544ea-+-ldap: serve the full certificate chain for TLS

78e7e12d09-+-base::certs: remove backwards-compat ensure => absents

a36b2f4e7a-+-ldap: point TLS_CACERTFILE to ca-certificates.crt

10166f1c10-+-sslcert: remove source/content checks

d02ad89624-+-base::certs: rename CA filenames to their CNs

54bca9319f-+-sslcert: whitespace & comment cleanups

3740099b00-+-sslcert: automatically regenerate chained cert on changes

5cc8b0e73a-+-memorysize is a fact, qualify

c23ed23b25-+-sslcert: remove ::certificate's $content parameter

c2c3b2fd11-+-sslcert: include ::chainedcert from ::certificate

c564416681-+-base: certificates::base -> base::certificates

26353e2fd5-+-certs: inline certificate::<ca> classes to ::base

31532b38e1-+-certs: kill a bunch of Labs classes

d9221772cd-+-certs: remove random certificates::* includes

4a83b5e788-+-site.pp for cp20xx

7936de3dd5-+-toollabs: Source hosts file as template, not file

069ab26891-+-tools: Don't include killed labsdb client /etc/hosts class

25044c07a1-+-Revert "tools: Puppetize database aliases as host resources"

ab88b3170e-+-designate: Just use IP address directly for ferm rule

39c0925dc7-+-designate: Use ferm's resolve function than puppet ipresolve

da80053bd8-+-Merge "gitblit: don't install ssl cert anymore" into production

05d30f2f0d-+-gitblit: don't install ssl cert anymore

5cadf9033b-+-Merge "mailman monitoring: adjusting thresholds" into production

ddef0154ef-+-mailman monitoring: adjusting thresholds

9ee5b1d32a-+-memkeys-snapshot: forward to fluorine for aggregation

703de8cd0e-+-interface: access template variable via '@'

2ca883edcc-+-site: remove authdns::server from rubidium

790c793f26-+-site: add authdns::server role to radon

880eff57f3-+-site: Set up radon (move to public, jessie)

d615520289-+-Log a 20s sample of memcached usage to a file once a day

6e49aa2c88-+-Revert "Add basic alerts on RESTBase error rates and storage latencies"

5d04bd78d2-+-Add basic alerts on RESTBase error rates and storage latencies

682f26fb3e-+-HHVM: set light_process_count to 5, light_process_file_prefix to /tmp/hhvm.

ff3da1fd82-+-Merge "Apply ::varnish::logging::statsd on all varnishes, not just bits" into production

a3756d8b9b-+-Apply ::varnish::logging::statsd on all varnishes, not just bits

d99f22fd5a-+-HHVM APC: enable item expiration

422e7e595a-+-Merge "do not set ca parameter with install_certificate" into production

242f147659-+-do not set ca parameter with install_certificate

f1577ad9d3-+-Merge "Revert "icinga.wikimedia.org cert sha1 to sha256"" into production

9ababce8b1-+-Revert "icinga.wikimedia.org cert sha1 to sha256"

55e5ed6a54-+-Apply role::cache::statsd on bits

cce614853a-+-icinga.wikimedia.org cert sha1 to sha256

aa4ac5a375-+-Merge "dnsrecursor: ensure => 'present' rather than 'latest'" into production

acfeeefbb6-+-Deployment group for trebuchet

19468c981e-+-lists.wikimedia.org certificate sha1 to sha256

3e86d31310-+-sslcert: switch all install_certificate to x509-bundle

ee50f753f8-+-bugfix for 44c3d7201

44c3d7201b-+-add DigiCertSHA2HighAssuranceServerCA Intermediate cert, used by stream.wm.o cert

1ae18e7bad-+-sslcert: Deploy new x509-bundle script + test output

4b62682f08-+-Turn off recursing for labs pdns/mysql/designate.

a06257b3b4-+-Merge "Use the labs dns server for reverse-dns in the labs range" into production

acfc915d20-+-Merge "mailman: adjust monitoring thresholds" into production

7af4c4f63b-+-mailman: adjust monitoring thresholds

88383171ef-+-Don't hardcode dns listening IPs.

38d83156ee-+-Revert "Feed the puppet host IP directly to dnsmasq."

ef82b2adec-+-strongswan module: don't install ipsec-tools

4dc955c872-+-Allow the labs recursor to respond to all wmf networks.

8f002d50c6-+-Merge "people.wikimedia.org: HTTPS only" into production

8ba18f60e5-+-puppetmaster: Explicitly include config class before using it

a919e606cb-+-Allow a lax ssh policy on labs controllers.

b94b1f6ae8-+-dnsrecursor: ensure => 'present' rather than 'latest'

2aa4cc65d9-+-Use the labs dns server for reverse-dns in the labs range

0e722dc94b-+-Use the labs-recursor0 for labs dns

e1cc4be9da-+-Merge "s/heira/hiera/" into production

8cb5448bdc-+-Merge "Add additional_forward_zones arg to dnsrecursor class." into production

18de0eda0e-+-Fix for check_hadoop_yarn_node_state source path

b47d89ce84-+-Fix for nrpe with nagios_common.  This doesn't work!

be39fc0d7a-+-Merge "Rename ferm rules in the recursor" into production

98ebd70c11-+-Merge "Add a pdns recursor to holmium" into production

9f56a79011-+-Add icinga check for Hadoop YARN NodeManager Node-State

3e55886549-+-s/heira/hiera/

ed102761bc-+-Add additional_forward_zones arg to dnsrecursor class.

85e1fb1412-+-Rename ferm rules in the recursor

366901a5a1-+-Add a pdns recursor to holmium

261a65ea34-+-Default ip_aliases to undef rather than {}

74fefbc172-+-Added a labs-specific dns recursor.

14f799e336-+-ores: Specify labs lvm requirement correctly

7bc204449c-+-ores: Add experimental nginx proxy caching

c66daa8aa1-+-ores: Increase processes per CPU to 4

acacf97e2d-+-hhvm: add memory leak isolation scripts

2f52b66d86-+-people.wikimedia.org: HTTPS only

31e16160e4-+-strongswan: remove temporary hack for sysvinit

fd7271d177-+-Remove ssh::hostkeys-collect from mira

068cd3e3de-+-double OCSP fetch rate to cope with upstream error rate

e8d7e3accd-+-Apply varnishstatsd on cp1066 (text varnish) as well

6a99a9ee7f-+-varnishstatsd: honor key prefix parameter

13b153d385-+-Provision varnishstatsd

7b6671cf38-+-Merge "dumps: create misc dir under other" into production

aef823228f-+-dumps: create misc dir under other

b1d1b2db98-+-add varnishstatsd

da09dd66d7-+-Add varnishlog python module

171108ed5f-+-Switch labs pdns/mysql to the new db host

44d4872620-+-Moving pdns and designate databases from m1 to m5

5c82723d51-+-tools: Simplify and fix tools-redis master selection

c1e749f7bf-+-tools: Don't attempt to replicate from master to master

c768e5460a-+-toollabs: Specify IPv4 as addresstype for ipresolve

c370897961-+-tools: Make redis failover-able

ea21bdb377-+-confd: create module

822ef69990-+-Use ruby-mysql instead of libmysql-ruby.

a4b921bfbe-+-Merge "Don't clean the puppetcert for the puppetmaster service name." into production

ab9463ac6c-+-Don't clean the puppetcert for the puppetmaster service name.

57b2d2c573-+-mailman I/O monitoring: adjust Read Requests/Sec

e19195e12e-+-Reverting some changes that broke diamond in labs

492deb45b7-+-Fix dependency after collector module change

40c317f5cb-+-Add diamond collector_module class

175f8c1dd3-+-Removed use of labs_ldap_dns_host_secondary in 'local-address'.

d6cd563913-+-salt minions: prefer 2048 bit key size

00bf9f114e-+-Replace many references to virt1000 and labcontrol2001 with hiera lookups

92a9d127c5-+-Remove commented-out frack list from site.pp

57eadf5bc0-+-Revert v6 tokens for interface::tagged

5f1acfe2a9-+-deploy v6 token approach to all jessie/trusty

0f18bc4add-+-ssh: guard ssh_known_hosts generation behind $::realm

10a7e256cc-+-graphite1002: include only standard

fe8a343316-+-salt: small increase of workers on the master

5e59d5d366-+-ssh: fix completely broken host key collection

a361072135-+-sudo: fix sudo::user/group's ensure => absent

6e6841c59b-+-admin: clean up removed/revoked SSH keys

cf067c28c5-+-Deploy v6 token approach to some jessie/trusty hosts

2e76db1c19-+-tools: Remove exec_environ from gridengine master

5d6e8e5425-+-tools: Include labsdb aliases only in exec hosts

d8ec14c932-+-ipv6 token stuff: re-enable cp1008 testing

9a052b2bac-+-ipv6 token stuff: add flush on first set, update comments

cfd91a548b-+-ssh: remove fail()s from ssh::userkey

7d5959cdc7-+-admin: transition to ssh::userkey

18d820d9ab-+-gerrit: transition to ssh::userkey

fc1d36528d-+-jenkins: transition to ssh::userkey

4aec31007a-+-logging: transition to ssh::userkey

fbab1be179-+-datasets: transition to ssh::userkey

eac00c82e1-+-mha: transition to ssh::userkey

fb06565d22-+-Upgrade pc1003 to MariaDB 10 and trusty

bba684c626-+-Only include libmysql-ruby and libldap-ruby1.8 on precise.

b96e9a087b-+-Don't include include role::dns::ldap on labcontrol1001 yet.

d5d0149337-+-Merge "Labcontrol1001 will be the new virt1000" into production

528b2fd277-+-ores: Make uwsgi listen on http

8de821e354-+-Merge "add salt minion recon and auth timing params for performance" into production

8e1b7f41bf-+-Merge "Remove redundant or defunct ldap servers from the ldap list." into production

9197ecd063-+-Merge "ganeti: ferm::service for DRBD ports" into production

690b64ed00-+-ganeti: ferm::service for DRBD ports

0aaf55adde-+-Labcontrol1001 will be the new virt1000

3df45d8461-+-remove v6 token puppetization from cp1008 for testing

164626f7cb-+-ores: Add simple nginx load balancer

7477115530-+-ores: Initial module, with web class / role

cf58202ec8-+-Remove redundant or defunct ldap servers from the ldap list.

4f4b74feea-+-ve: switch jsbench/chromium user/groups to system

4a1d4e24c9-+-Remove txstatsd module and role class

a9b4b57afe-+-Add system => true to mysql_wmf::mysqluser

baf6b74d21-+-puppetmaster::autosigner: fix doc generation for class

146b3a01c9-+-Merge "Feed the puppet host IP directly to dnsmasq." into production

f7fe9e7af7-+-Updating pc1002 to MariaDB 10

59cbb03e72-+-Install kafkacat on analytics clients

3e85236dfd-+-add salt minion recon and auth timing params for performance

41daddd184-+-bump phabricator release tag.

226ae34520-+-udp2log: add conntrack exception firewall rule

4c9470993d-+-Small configuration fix for pc1001 database

108b73493a-+-Update of parsercache db servers to MariaDB 10 (#1)

34d28c8567-+-s/dysprosium/cp1099/ T96873

9c81720b7c-+-torrus: remove amssq nodes from tests/cdn.pp

cd4ee20450-+-Allow base modules' check_disk options to be overridden by hiera

225a4c3aef-+-Increase YARN max-disk-utilization-per-disk-percentage

982df6fd24-+-add strace to base package list

e8021f58c5-+-cpufrequtils: ensure configure governor is in use

9ab279d69e-+-Tools: Do not require redundant package python-celery-with-redis

52dc3ef6fb-+-Merge "labsdb1004: Enable daily osm planet sync" into production

162a7b9ee0-+-Tool Labs: add xvfb to exec environment

15fcbb132c-+-labsdb1004: Enable daily osm planet sync

2f8906005b-+-mesos: Setup a marathon event receiver on mesos proxy

ca99769177-+-mesos: Add marathon master class

d00e9d729f-+-dynamicproxy: Add redundanturl dynamicproxy

8be2e75c75-+-Merge "Tool Labs: install calibre for wsexport" into production

60107f8c63-+-Tool Labs: install calibre for wsexport

655b837b0a-+-mediawiki: Touch /etc/wikimedia-image-scaler on image scalers

feac761587-+-dynamicproxy: Hygiene fixes

47f5c988c1-+-ssh: Allow temporary opt out from more secure ssh

0c0b27abc0-+-mesos: Puppetize docker config file

eae3b530d1-+-graphite: set a coarser aggregation policy to relieve storage pressure

8417f6e1c1-+-mesos: Use require_package to get docker

a8f7e97a43-+-mesos: Install docker on all slaves

d891c2f710-+-contint: disable unattended upgrade

1c31cfb08e-+-Merge "contint: packages for Android SDK" into production

7251461acf-+-mira: add to salt_peer_run

b0378ef647-+-test retry503 on upload-fe for load effects and reboot resiliency

824c9c7a8b-+-Merge "Assign role::postgres::maps to labsdb1004" into production

f53f09505f-+-Assign role::postgres::maps to labsdb1004

78dc2fc316-+-labs: Set labs nameserver IP globally in $::nameservers

0db1c9d63c-+-Merge "puppetmaster::logstash remove inclusion of base::puppet" into production

07153af99a-+-puppetmaster::logstash remove inclusion of base::puppet

fab1cda48d-+-Merge "Remove inheritance from puppet::self::config" into production

1a5916129a-+-Remove inheritance from puppet::self::config

0b3315b5b8-+-beta: Update the puppetmaster more often

d804440c45-+-upgrade db1026 trusty mariadb 10

2f82f0b6b1-+-Merge "quarry: lint fixes" into production

4eabc8e2c8-+-Merge "scap: ensure /home/l10nupdate/.ssh exists" into production

710e49947d-+-scap: ensure /home/l10nupdate/.ssh exists

7fed969792-+-snapshot: lint fixes

595a6332a1-+-site.pp: small lint fixes

bdfb248f49-+-statistics: lint fixes

5db2d5c0aa-+-Fix up varnish director-level retries

660fe61c94-+-puppet/self: fix the kafkian puppet syntax

01a88ba5ba-+-Remove the unneeded priorites in filenames

a9c97795f0-+-Merge "puppetmaster: DRY on inclusion of hiera configuration" into production

a1465cfade-+-Merge "puppetmaster: Move backups to the role class" into production

c160ee6953-+-Merge "puppetmaster::logstash. Fix out of module dependencies" into production

7ca60c136e-+-Typo fix for Iaba1aee51: apache::mod::headers, not header

8d55d812f1-+-Make performance.wikimedia.org HTTPS-only

7e628093eb-+-Feed the puppet host IP directly to dnsmasq.

7b0044f780-+-Revert "Add storage cfg for cp1099 T96873"

0de969bab4-+-mira: add ssh::hostkeys-collect as role

a9e228eec9-+-Add deployment server role to mira

99ac180dc3-+-tools: Puppetize database aliases as host resources

606aa4eab0-+-Merge "mailman: restart mailman after config changes" into production

3f60ecb76c-+-puppetmaster: DRY on inclusion of hiera configuration

f964430bb5-+-puppetmaster: Move backups to the role class

1d73bede21-+-puppetmaster::logstash. Fix out of module dependencies

0a0aa3d33f-+-mailman: class for helper scripts

f35a9a4cc0-+-Merge "Introduce base::puppet::config definition" into production

2d716bc5f1-+-Introduce base::puppet::config definition

ef63648f3f-+-Merge "fundraising.pp: indentation fixes" into production

5bc8c40234-+-Merge "monitoring.pp - indentation fixes" into production

0ce2f0d20e-+-Enable graphoid in labs & production

924cfed2bf-+-puppetmaster: latest to present

b6ad52c755-+-puppetmaster::gitpuppet lint cleanups

c578f4049a-+-puppetmaster::config Avoid out of module dependencies

1e63f9670b-+-puppetmaster::config. Minor lints

ffc54d86f5-+-puppetmaster::reporter::logstash. Remove the reporter namespace

82ead80984-+-puppetmaster: remove extraneous empty line

38a36bac0a-+-Send refinery dump emails to Joseph as well

04e2a8e950-+-Fix stderr redirection for hdfs balancer log

7faa0e6b56-+-Merge "puppetmaster: cleanups in gitsync" into production

6336a05116-+-Merge "puppetmaster: remove legacy resources" into production

659b7037dc-+-hhvm: adjust TC size and ratios

1a7cf18333-+-etcd: create puppet module

ad7947e739-+-mailman: restart mailman after config changes

cf1fb79248-+-Disable RESTBase restarts by Puppet on config change

d2f856d35e-+-enable OCSP for misc cluster certs T97506

9eb4f1ce5f-+-New phabricator tag release/2015-05-20/1

34a7ac6b0b-+-Encode the tag name to be path-safe - fixes T98411

eb7528f232-+-upgrade db1045 to trusty + mariadb 10

c3fdfb4a1c-+-fundraising.pp: indentation fixes

626911dcf1-+-monitoring.pp - indentation fixes

a9a85c36f6-+-Merge "dynamicproxy: lint fixes" into production

3764ca669d-+-dynamicproxy: lint fixes

8d7ce05b4a-+-Change BZ references to Phabricator tickets in MediaWiki module

93e52a4c7d-+-Revert "varnishkafka: Drop trailing '\?' from the RxURL filter for statsv"

37831f5e96-+-Merge "ocg: indentation fixes" into production

5bfdea5b06-+-ocg: indentation fixes

e457842549-+-Fix-up for I9d3691b6

2fda09c655-+-git: lint fixes

f805e52334-+-varnishkafka/statsv: set instance name to 'frontend' on text

c39d91284f-+-Merge "varnishkafka: Drop trailing '\?' from the RxURL filter for statsv" into production

5b021bbff8-+-varnishkafka: Drop trailing '\?' from the RxURL filter for statsv

b22ba3aaae-+-Merge "phabricator: lint fixes" into production

9c1faf06e4-+-phabricator: lint fixes

f80f383c79-+-Merge "nrpe: lint fixes" into production

4878272d43-+-nrpe: lint fixes

36710a0e89-+-quarry: lint fixes

d48b0df616-+-Merge "gitblit: indentation fixes" into production

e75e72cfd7-+-Merge "jenkins,package_builder,labs_bootstrapvz: lint" into production

edca97f93d-+-gitblit: indentation fixes

9e881d1c59-+-jenkins,package_builder,labs_bootstrapvz: lint

dbebe89e00-+-Merge "mirrors: indentation fixes" into production

ebcf3f6bd4-+-mirrors: indentation fixes

629a956248-+-osm, rsync: lint fixes

aee98e3312-+-Merge "monitoring, RT: lint fixes" into production

6ac15815fd-+-Merge "contint: lint fixes" into production

64b261ef33-+-logstash: fix ordering of filters

040c167a07-+-Merge "geoip: indentation fixes" into production

dfdf198045-+-Merge "Revive virt1005, 1006.  Switch them and 1007 to Trusty." into production

1a22bb6379-+-Revive virt1005, 1006.  Switch them and 1007 to Trusty.

51b32a50ff-+-Merge "ganglia: indentation fixes" into production

42e0654b05-+-Merge "salt, spamassassin: indentation fixes" into production

a519ba7476-+-Merge "mysql_wmf, protoproxy: indentation fixes" into production

f1355ec988-+-Merge "mediawiki: indentation fixes" into production

ee8f0bd64e-+-Adjust Hadoop memory settings

1d393012d5-+-Merge "Typo fix in the keystone token cleanup cron" into production

3dfa77dd3a-+-Typo fix in the keystone token cleanup cron

eecf80ccb8-+-Merge "No longer include a database server as part of the nova controller." into production

4faa41f14c-+-Merge "Move the keystone token cleanup to a keystone manifest." into production

544f5155d2-+-No longer include a database server as part of the nova controller.

fa42809dd8-+-Move the keystone token cleanup to a keystone manifest.

8d9353aec4-+-Merge "Use m5-master.eqiad.wmnet for the openstack/labs db server" into production

cd75886380-+-Use m5-master.eqiad.wmnet for the openstack/labs db server

dd5c7f6efa-+-Merge "contint: Use device=none in tmpfs" into production

a40705f400-+-Merge "Typo: Fix typo in cxserver module" into production

b9d0c6b257-+-service::node: fix logstash port

f40fa33a85-+-hhvm: fix path for nrpe TC check

6fceeb5cb3-+-hhvm: add monitoring for translation cache space

2cdd08f968-+-tools: Make logrotate cron be marked executable

ca623efd4e-+-tools: Fix superfluous Package[logrotate] require

93f5a6b53b-+-tools: store verbose logrotate logs

6ea6ee2cb4-+-Revert "tools: store verbose logrotate logs"

cfd163592c-+-tools: store verbose logrotate logs

674a409490-+-Limit udp2log rsync daemon's bandwidth usage

7fac04bb74-+-Use udp2log::rsyncd class to set up rsyncd on fluorine

5ed0af3a7c-+-Typo: Fix typo in cxserver module

d288cffd83-+-monitoring, RT: lint fixes

f3eec4ac86-+-contint: lint fixes

2cf3986416-+-geoip: indentation fixes

ca1338f616-+-ganglia: indentation fixes

a61b14ce2f-+-salt, spamassassin: indentation fixes

8c84054ea0-+-mysql_wmf, protoproxy: indentation fixes

f47ea44d21-+-mediawiki: indentation fixes

27b910442f-+-logstash: indentation fixes

c3933864d0-+-kibana, labs_vmbuilder: indentation fixes

ac8e226bba-+-puppet,puppet_compiler: indentation fixes

ac354b3abc-+-statsite, wdq-mm: indentation fixes

82a496cd7a-+-ganeti, rancid: indentation fixes

6dc8f9f095-+-ipython, java: indentation fixes

e3e3d8692f-+-icinga ircbot, tor: indentation fixes

b620ec2cc8-+-publichtml,ircyall: indentation fixes

b2da43a37f-+-wikistats,planet: indentation fixes

b9e6d707f8-+-install-server: indentation fixes

6401ccfe68-+-zuul: indentation fixes

5ff89087db-+-don't dump wikidata along with the regular wikis

3577c5f9f7-+-datasets: indentation fixes

6d569f2bc5-+-contint: Use device=none in tmpfs

fd092106e2-+-chromium: indentation fix

9743ea4423-+-apt: indentation fixes

f7fe9a2180-+-Merge "Dang." into production

bc15c6fbf7-+-Dang.

c8a2841231-+-Merge "Use m5-master.eqiad.wmnet for the openstack/labs db server" into production

021db587ca-+-Use m5-master.eqiad.wmnet for the openstack/labs db server

ffe510c7c8-+-Fix for stat1002 CirrusSearchRequests.log rsync job

54fc7d9b28-+-Rsync CirrusSearchRequests.log from fluorine to stat1002

5c7764821a-+-Reverting just for a moment, until dns sorts itself out.

b0ed60e60f-+-Use m5-master.eqiad.wmnet for the openstack/labs db server

148e0640a3-+-ipsec: fix class name

b3607fc78a-+-reassign db1053 to s1

9b4b80f8e2-+-statistics: add spell checker packages

618c830ba8-+-Remove authdns role from multatuli

7c0c7869be-+-authdns: fix user creation on pristine systems

b3118987db-+-Re-add eeden to the active set of nameservers

2587b3d0b1-+-Rename eeden.esams -> eeden, switch to jessie

6444d6dd23-+-Remove eeden from the set of active NS

ef95b4d7d0-+-Merge "CX: Use RESTBase API for page fetch" into production

56a1e8ce43-+-Add multatuli as temporary esams authdns

35f50338ee-+-Adding a new MariaDB master node, part of a new shard (m5) for miscelaneous services in labs Bug: T92693

9ee5c8b4bd-+-mediawiki: adjust jobq alarms

9f2fe3d1fe-+-move db1019 to s4

f4363e67d3-+-Merge "puppetmaster: Do not manage certmanager's home" into production

657f0a88da-+-rename icinga-downtime script

e47b9543ae-+-Merge "icinga: add script to schedule host downtimes" into production

24fc8163e7-+-icinga: add script to schedule host downtimes

c7f7550948-+-Fix logster tracking for CirrusSearch-slow.log

b45abe6ee8-+-wikitech-static monitoring,fix check command setup

82ab8b8ab2-+-wikitech-static monitoring, install plugin

8d43e6f1a2-+-wikitech-static monitoring, ? is illegal character

979163072d-+-HHVM: enable DNS cache

f4ab0d1f71-+-wikitech: add monitoring::service for static sync

0185d470c6-+-hieraize nrpe

ee6bbf2978-+-remove temporary intel-microcode purge

83c4254dcd-+-Merge "puppetmaster: Move system::role to the role class" into production

3b74482fde-+-Merge "puppetmaster: Remove the package installed site" into production

cdc88ba5ff-+-monitoring: install libraries for nrpe systemd scripts

fb5c03e523-+-monitoring: add proper way to check systemd units

18c764d790-+-Upgrade db1018 to trusty and MariaDB 10

eb0a649157-+-Revert "contint: Move jenkins/tmpfs from slave::labs to slave::labs::common"

fb088d9530-+-base: Include ::rsyslog

1e34bd4aab-+-base::remote_syslog: handle $enable=>false more gracefully

3af2bb266e-+-Cleanup base::remote-syslog

4198f94d4b-+-Simplify statsv varnishkafka RxURL regex

fef5750c1a-+-statsv: migrate to text varnishes; nest under /beacon/.

ed7bcf918e-+-Clean up R session temp files from /tmp on stat nodes

9d97ee5e0a-+-Merge "Add mira to deployment network rule" into production

972ee73ab7-+-Revert "Install ceilometer on virt1000"

8d9bdad244-+-Install ceilometer on virt1000

3325d60a44-+-Merge "Deploy hotfixes for phabricator sprint extension bugs:" into production

43e24eb913-+-Merge "package_builder: Add lintian" into production

7a6c6d7fbb-+-MediaWiki: clean up EasyTimeline and png files in /tmp

f65ef41bb1-+-contint: packages for Android SDK

7321bc0263-+-Merge "Add support for OpenStack ceilometer" into production

0033eb421e-+-tools: add python-stdeb to -dev hosts

5d4807a4d9-+-Revert "Set dedicated SUL rename runner loop"

6661c6ab3e-+-Add support for OpenStack ceilometer

27f90f9b24-+-Update location of vlogdump and add comment

01875308ee-+-Merge "tools: make sure pyflakes is only included once" into production

b2f828ef47-+-tools: make sure pyflakes is only included once

cab59a56c8-+-base_jit_size: 100 Mb -> 200 Mb

836696e137-+-Merge "Add vlogdump to varnish module" into production

4f7617ede0-+-graphite: mirror traffic to codfw

d0cb4d8f14-+-puppetmaster: uuid-generator ensured absent

ec336342f2-+-Merge "puppetmaster: remove uuid-generator" into production

21dfd1bf38-+-Install new Apertium packages for ContentTranslation

35fdae9a32-+-Add vlogdump to varnish module

ed93bdc930-+-tools: Fix trusty vs precise packages

8ed3259e24-+-tools: Fix flake packages in trusty vs precise

b6b6d7273b-+-tools: silence sudo security e-mails

2b11587f61-+-Install flake8 (both python 2 and 3 versions)

0943401ef4-+-Add mira to deployment network rule

8ba9d3df5d-+-Deploy hotfixes for phabricator sprint extension bugs:

ec5d23a73f-+-add IPv6 to codfw deployment server

749c3e95ea-+-backup home dirs on codfw deployment host

6fb4920163-+-add firewall to mira - codfw deployment host

71e5a27898-+-Tool Labs: add whois to exec nodes

cfa3e39413-+-phab: phd is not lsb compliant and we work around it

d0d008df91-+-Be explicit about spark worker memory in hiera

bb75ff599f-+-mesos: Add simple mesos module

c8a9c53bb8-+-Use role to include hive, hadoop, and spark classes on analytics ciscos

5c01e30bd1-+-Run hdfs balancer every day

fc08b0c4f0-+-analytics1004 is a spark worker

9636f39cd5-+-Fix typo in site.pp for analytics1003 and 1010

a0154bf8a4-+-Need Hadoop and Hive clients to run spark

ac30915d4a-+-Puppetize standalone cluster on test Ciscos

d229c87575-+-Merge "puppetmaster: use require_packages" into production

a8a6046a91-+-role::cache: decommission statsite

d9d12cf0b2-+-CX: Use RESTBase API for page fetch

e52d41c166-+-beta: Remove custom apache2 log config

aea3fe8342-+-datasets: create directory for dataset rsyncing

3beb4b3de6-+-Revert "Set force_snat_range for labs floating ips."

bd983a76e3-+-Set force_snat_range for labs floating ips.

aa7ebb404f-+-package_builder: Add lintian

b48ccc3ef5-+-return db1054 to s2

5f7494f48c-+-IPsec: Icinga monitor for Strongswan connections

b9e6603ddb-+-Merge "phabricator: adjust monitoring of TaskmasterDaemon" into production

17c5e38076-+-phabricator: adjust monitoring of TaskmasterDaemon

ca50bf898f-+-Merge "Undefine virt1005 and 1006." into production

763a16b9bb-+-Undefine virt1005 and 1006.

4a123b7a36-+-puppetmaster: cleanups in gitsync

f13fada6a2-+-puppetmaster: remove legacy resources

122172ac41-+-puppetmaster: Do not manage certmanager's home

22459dc55e-+-puppetmaster: Move system::role to the role class

b279ad6388-+-puppetmaster: Remove the package installed site

4bae7b05fc-+-puppetmaster: remove uuid-generator

7dbf601bdf-+-puppetmaster: use require_packages

a0aef2ad9f-+-qualify that command.

aed0ca8a00-+-Symlink for sprint extension static files.

3a86dc5d51-+-phab: storage.upload-size-limit is obsolete

08f3a8067f-+-phab: metamta.maniphest.reply-handler-domain obsolete option

4ef67a1212-+-Phab: start-taskmasters renamed to taskmasters

6fcf53d462-+-Puppetize HA YARN ResourceManager for Hadoop

aead69a7bd-+-phab stage tags for upgrade

932b83c9a1-+-Rename virt1010 to labvirt1009

b7eda1cb15-+-Assign role::puppetmaster::backend to rhodium

787cea222e-+-graphite: split alerts role

2beb6686e2-+-statsite: decommission class

037131dbcd-+-Merge "EventLogging varnish log tailers: make '.gif' suffix optional" into production

4ae5a2c911-+-nova: install ::mediawiki::cgroup

c73fcb4bec-+-transparency: make it HTTPS only and enable HSTS

64569a40d6-+-EventLogging varnish log tailers: make '.gif' suffix optional

288d44f8be-+-move db1021 to s2 and db1054 to sideline

47039824e2-+-gridengine: Puppetize gridengine-mailer

3934537ac2-+-Merge "Labs: Add jamvm explicitly on all flavours" into production

0fccee1f88-+-purge intel-microcode, will remove after

244567c565-+-Labs: Add jamvm explicitly on all flavours

d96366b7b0-+-zookeeper: Refactor roles to be more generic

2a499cdddd-+-logstash: remove extra $::ganglia_aggregator

64417d0db5-+-varnishkafka: use statsd.eqiad.wmnet

babbb91706-+-Notify apache on ganglia_new::web php.ini updates

6f3433eddf-+-Merge "Assign weights to puppetmasters" into production

d90bd96242-+-ganglia_new::web. Increase the default memory limit

cb4e452320-+-Assign weights to puppetmasters

ad16dc93a4-+-Disable manual puppetmaster start/restart

810534f6e5-+-tools: Require uwsgi packages for checker

45d6ccb3d1-+-tools: Make checker class inherit toollabs base class

eebae5fe0f-+-tools: Make checkers submit hosts as well

c8a2bfe959-+-tools: Backup user crontabs on to NFS

6abeb43481-+-Set absolute path of yarn.app.mapreduce.am.env

3967874e81-+-Merge "add basic mira def to site.pp" into production

760a460f88-+-Set yarn.app.mapreduce.am.env to work around MAPREDUCE-5799

e5f0263807-+-add basic mira def to site.pp

fb5ed0056c-+-Graphoid configuration - add protocol

2476f20a60-+-Add parsoid_codfw icinga groups

13299c3880-+-Revert 7c3af0d.  This caused memory reservation errors in the mediacounts job

df395f428c-+-Add graphoid stanza for cache in labs

5c006e1a4e-+-labsnfs: fix loadavg check from copy/paste fail

574b74cb76-+-Adjust various Nagios check descriptions

2d1cbee436-+-Assign the parsoid::production role to codfw wtps

a7184cc4d3-+-reassign db1070 to s5

c671406a20-+-deploy db2048, db2049, db2050, db2051, db2052, db2053, db2054

152d5a3b01-+-script used for non-replicated dbstore backups

6488494988-+-Icinga: fix ripe atlas command definitions

7e63352b2f-+-Icinga: add icinga::monitor::ripeatlas

457f0972d6-+-Icinga: monitor failure rate to our anchors

927a54abce-+-tools: Appropriate .conf suffix for upstart file

fcfa633ad2-+-tools: Make toolschecker run directly as an upstart job

5ff35efcd1-+-Delete udp2log generated edit logs on on stat1002 that are older than 90 days

9c67de441f-+-mwprof: deprecation

725f085ef6-+-Add --line-buffered to 5xx grep command for ops kafkatee instance

bb4d4e3f2b-+-tools: Use uid rather than user to specify uwsgi user

9df326e3d9-+-tools: Fix typo in path of toolschecker uwsgi socket

2ea5b5d559-+-tools: Use require_package for package definitions

118490b5cb-+-tools: Fix permission string on toolschecker.py

7fcb8efc1f-+-tools: Add a toolschecker role / module / endpoint

284c215400-+-Follow-up to I2af6fb3d7: fix regex escapes in role::logging::eventlistener

4027fc48f4-+-Further attempts to fix the Horizon splash

3a513878fc-+-Spruce up Horizon graphics

0ae846c2cc-+-Standardize on 'glance_policy.json' vs 'image_policy.json'

bec52ee408-+-Add some glance policies for Horizon.

da3d3b87c1-+-Revert "Revert "admin group sudoers permissions cleanup""

423c8d6bbb-+-Admin: Cleanup permissions granted to wikidev

ac0fb7a2f0-+-add role::logging::eventlistener to text and mobile varnishes

4950aeb08c-+-Set up kafkatee instance on erbium to output fundraising logs

434a2b9977-+-Revert "admin group sudoers permissions cleanup"

722f2bbaf0-+-admin group sudoers permissions cleanup

9eb872459d-+-Store not running warning in balancer.log

1fdc0a4eb9-+-Use lockfiles instead of ps to conditionally start hdfs balancer

5a5bae2a91-+-Properly redirect hdfs balancer cron output

ad5c6512c7-+-Run hdfs balancer weekly

c76d089fc8-+-Fix typo with extra ' in 5xx kafkatee output

1db6a47881-+-Specify kafkatee::input parameters manually, resource defaults wasn't working

a595030eb4-+-Attempt to get resource defaults set by not globally qualifying kafkatee::input

e15608d601-+-Remove some (large) unused graphs from varnishkafka ganglia view

5f80b9239b-+-graphite: stop system carbon-c-relay

a13caa32fa-+-hhvm: make base_jit_size configurable

00b4afd450-+-tools: Remove mariadb-client from precise exec hosts

fbc47e0826-+-tools: Rever attempts to set $ssh_hba in puppet

00e0c25f88-+-tools: Set hba as a global variable

81e7b542b0-+-tools: Enable hba automatically for exec hosts

419cf95b18-+-Followup I5303c527: Use actual \n and not fake \n when joining

5d3eb0b48d-+-Labs: Make sure that nfs-no-idmap gets applied first

107de08b1b-+-Can't fully qualify a resource default tag

636a758eae-+-Set up kafkatee instance on oxygen for ops webrequest log debugging

f1e1bfe14d-+-Use require_package for python-redis

e412ad4e3c-+-Revert "Add the LVS blocks to url_downloader"

7dbc8b7e64-+-Merge "Graphoid: Varnish configuration" into production

0ede1b17c7-+-Add the LVS blocks to url_downloader

572a7fd033-+-Revert "eventlogging: adjust counters thresholds"

720f9dd9d1-+-statsite: enable extended counters by default

831d028172-+-deploy db2043 s3, db2044 s4, db2045, s5, db2046 s6, db2047 s7

a0af441cf8-+-add codfw db servers to site.pp

b6dbb0c58f-+-apt: Use $::operatingsystem fact rather than $::lsbdistid

8d6a2c29a0-+-labs_lvm: Mount swap partition so it sticks

bb4813cc25-+-tools: Create consistent 3x RAM swap on all exec nodes

7b180d62a7-+-Merge "Change BZ references to Phabricator tickets" into production

dc02d763ab-+-apt::init: avoid using case statement

1406e35358-+-Change BZ references to Phabricator tickets

443d253e58-+-Merge "backup: remove fileset for contacts again" into production

fc2dadd805-+-add codfw wtp parsoid servers to site.pp

604d70b231-+-Revert "tools: Have node::compute::general inherit from toollabs"

20b94763fa-+-Revert "tools: Move compute node code into tools::compute"

b423e64c91-+-tools: Move compute node code into tools::compute

f39a691279-+-de-dupe /static hashing for text/mobile

aaf7f3b1e6-+-gridengine: Include base class in exec_host

73aa5e8c56-+-tools: Have node::compute::general inherit from toollabs

28afac4a53-+-tools: Create separate /tmp LVM volume for all exec nodes

9afaaba00f-+-site.pp: add labcontrol1001

8820bf4565-+-Include python-virtualenv on redis hosts

f71a5581cb-+-dsh: remove template from scap-proxies and just use join()

7eb2107d6b-+-tools: Extended Exim diamond collector for Tool Labs

4a624197c0-+-backup: remove fileset for contacts again

fd74645eac-+-contacts: remove role from node and delete it

9251c692fd-+-varnish: set do_gzip to true for text

5ecdef5920-+-add policy microsite on zirconium

82560e6256-+-policy.wm.org: minimal module/role for microsite

a1c401a41e-+-RT - Raise HSTS max-age to 1 year

534b7aff14-+-Merge "reclaim tungsten" into production

abe5bcc1ba-+-reclaim tungsten

76ee4940b2-+-Labs: Remove idmap dependency on instances

4c1f7e9d10-+-Merge "contint: make Jessie slaves package builders" into production

eae7e2ab7e-+-Merge "Graphoid: LVS configuration" into production

d84dc0f7a4-+-Add alerts for missing hours in pagecounts_all_sites and pagecounts_raw

e9c3e82b36-+-Merge "Add public LVS network ranges in network.pp" into production

f06faff8b0-+-service: Add healthcheck_url parameter, ferm::service

1f7a3f08e3-+-Add public LVS network ranges in network.pp

3494033905-+-url_downloader: Fix typos in networking rules

9a74cfc868-+-contint: make Jessie slaves package builders

6c86ad6567-+-Rearrange/refactor some check_http commands

e97d977cc8-+-varnish: set do_gzip to true for mobile

98d7853ce8-+-Merge "Update dispatchChanges cronjob to use new script location" into production

a07bce5fee-+-Update dispatchChanges cronjob to use new script location

799f57ad1a-+-Revert "Extend Exim diamond collector for Tool Labs"

f27c111c7d-+-Add local crontab monitoring

e69bf03b6a-+-Extend Exim diamond collector for Tool Labs

1f257e7aee-+-varnish: enable gzip for mobile / text on labs

3101479e2e-+-Graphoid: Varnish configuration

8e6c60dcb9-+-Graphoid: LVS configuration

f56e53bb2d-+-Graphoid: service deployment on SCA

fc014a2b5a-+-Reinstall oxygen as Jessie and .eqiad.wmnet

7c3af0de12-+-Setting minimum allocation mb and vcores to 0 to allow Impala to submit small reservertion requests

37039e25be-+-varnish: implement 'do_gzip' cluster option for mobile/text frontend, too

e5a73a4135-+-contint: Move jenkins/tmpfs from slave::labs to slave::labs::common

0dc3f91a13-+-Tools: Fix and clean up generation of /etc/ssh/ssh_known_keys

bab61976a5-+-Fix sysfsutils service metaparameter

1b16980fb3-+-Merge changes I4cdaeeff,I39d30042 into production

e94d221b37-+-Use check_command for monitoring::service param

888f1de771-+-ganeti: switch to the sysfs module

ae459e73ec-+-Add sysfs module, to handle /sys settings

e887549fa1-+-Set up rsync module on copper

9d23fbb695-+-Remove oxygen udp2log related code

308030e59f-+-Merge "Graphoid: service deployment on SCA" into production

2977db2366-+-Turn off oxygen's udp2log instance, move 5xx error log to erbium, turn off some erbium filters

6a8e07391c-+-Adding a Last-Access cookie to text and mobile requests

255ba62755-+-Merge "Fix test for Trusty version for nova-compute" into production

d937a582f4-+-HHVM: Limit wall execution time of FCGI reqs to 290s

0f93fb41c4-+-Fix test for Trusty version for nova-compute

ac80fdde0e-+-Refuse to install nova-compute on broken kernels

7423d00100-+-Open more ports for impala, include impalad on hadoop worker nodes

9e7baf7388-+-Add ferm rules for impala daemons

1f429b184b-+-Merge "contacts: delete Apache template, adjust role" into production

013f690c0a-+-contacts: delete Apache template, adjust role

0cd6010e3f-+-ircecho: Restart if any of the files involved change

e2043edb40-+-Make sure icedtea-7-jre-jamvm is absent on analytics nodes

51ce41ef3e-+-Set dfs_datanode_hdfs_blocks_metadata_enabled in both labs and production for Impala use

8c7fde457f-+-Move the ganglia diskstat plugin to role::nova::compute

354cc4bad5-+-Enabled the ganglia diskstat plugin for labvirt100X

4f6a897f64-+-service: Use a package require instead of a class

556850dc27-+-Merge "apache: Mute warnings about right-to-left relationships" into production

e3c12afe2c-+-Merge "monitoring: selector outside a resource" into production

d0444af734-+-Merge "monitoring: selector outside a resource" into production

93edfcf133-+-logstash: Convert $::realm switches to hiera

d4d4c4b50c-+-logstash: Remove redis input

e4327e03df-+-logstash: Provision Elasticsearch only backend hosts

baad8aeb2e-+-Merge "contacts: remove Apache, add Backup" into production

ba79d49bad-+-tools: Temporarily and sadly puppetize /etc/hosts

5424d2428f-+-contacts: remove Apache, add Backup

5042881183-+-backup: add new fileset for contacts.wm

68e8e41e93-+-Merge "icinga-wm: configure to join -analytics channel" into production

714a82814f-+-icinga-wm: configure to join -analytics channel

22d84a3232-+-service::node: Deps fix + deployment-prep hieradata

b2e35979d5-+-graphite: introduce carbon-c-relay

f25e6128f4-+-tools: Generate packages.json for cdnjs

79fdeb0177-+-varnish does not like duplicate names for a director + backend

609311bbae-+-Set up /api/rest_v1/ entry point for restbase

14f85c5b2a-+-Merge "Wikidata builder" into production

0bae990a99-+-Use direct hiera lookup of impala master_host variable

df8b924075-+-Include analytics::clients on analytics1026 so that hadoop is configured propertly for impala

ca00c959d5-+-Update cdh module with impala and puppetize for Analytics Cluster

2f2f33311d-+-Merge "dumps: ferm service for rsyncd clients using hiera" into production

ca04787873-+-Merge "dumps: use role-based hiera lookup on dumps nodes" into production

b8bf0de2b4-+-toollabs: Include ldap labs config before using it

471ae7cebf-+-dumps: use role-based hiera lookup on dumps nodes

61b6d5c0f7-+-dumps: ferm service for rsyncd clients using hiera

03a4ed1f87-+-Add storage cfg for cp1099 T96873

aaec215168-+-update pybal weight descriptions

2484cc5c61-+-Initialize phd directory

43c14c12a0-+-Labs: Mute client-side notifications for wikitech Puppet status

cc77f47661-+-Create a shim module for citoid around service::node

d24ff7565f-+-logging: update CirrusSearch thresholds

12ebde30ad-+-Merge "dumps: let htmldumps-admin own HTML dumps docroot" into production

0625f11f66-+-htmldumps: include admins on francium

d15ffbf5dc-+-dumps::zim: include role in Hiera-friendly way

80458b6c39-+-dumps: let htmldumps-admin own HTML dumps docroot

0d73d8f4ae-+-tools: Setup a cdnjs mirror

3a8f7ef04f-+-labs: Move inlcude of labs_lvm to the Volume define

82ecb1d8c0-+-Merge "ocg: Fix ferm rules" into production

91f086fc1c-+-Merge "Labs: Add a script to reboot idmap instances" into production

f914085384-+-Merge "contint: allow gearman/zeromq from labnodepool1001" into production

082d81f40c-+-Labs: Add a script to reboot idmap instances

111d5dd9c2-+-git::install do fetch tags explicitly

a7c6bed6ae-+-upgrade db1019

e88441cded-+-check_to_check_nagios_paging: alert admins instead of pager_testing

a5e6eca411-+-Serve coal from performance.wikimedia.org/coal

cba7ecdc6f-+-coal: provision on graphite1001, not eventlog1001

5e44854f76-+-coal: Turn into a module; add uWSGI app

febcea588c-+-Merge "adding phabricator paging group" into production

20c4c93fc7-+-adding phabricator paging group

6fa1cacff9-+-Change RT references to Phabricator tickets

bf4eccfc3b-+-include base::firewall in role::package::builder

7b80f5d735-+-tools: Set tools.wmflabs.org to resolve internally to -webproxy-01

f6a964600f-+-tools: Make active proxy name available everywhere

987262fc80-+-contint: allow gearman/zeromq from labnodepool1001

067498b1c5-+-Improve package_builder tests

70eb8a1e04-+-Add quilt to package_builder packages

5593f10cba-+-re-arrange to align classes a bit...

74375871ec-+-drop ESI from labs-mobile

ceda74aaea-+-hieraize mobile $zero_site

59436ce991-+-remove realm conditional from parsoid lvs::realserver

21093362f9-+-hieraize bits/upload domainname options for labs

5d7bdecf62-+-get rid of realm conditionals on $memory_storage_size

422e7375f6-+-Apply class-param + hiera pattern to base+2layer

909a5b433e-+-normalize on $cluster_tier as string words

c63b45678d-+-creatively kill $realm storage conditionals

c40af8c71a-+-Switch inheritance to include; refactor storage conf

13fba8231d-+-Re-add Package['intel-microcode']

29c7284081-+-Remove invalid "microcode" package

5df4f54a41-+-base: is_virtual comparison fix

6eb732b345-+-Merge "make carbon a ganglia_new aggregator for eqiad" into production

eb1aad41a5-+-Merge "Run updateArticleCount on the 21st of each month, not 29th" into production

49df00f793-+-RT - Enable HSTS max-age=7 days

1e113369ea-+-graphite: enable locking writes

22c00eb45b-+-Run updateArticleCount on the 21st of each month, not 29th

3f5aeb739f-+-On post-kvm distros, link kvm binary to qemu-system-x86_64

266ff9f930-+-tools: Overcommit memory for redis instances

84a5ad11d6-+-coal: fix args

d2a5d41bf7-+-tools: Setup replication from master to all slave proxies

8a06ac1511-+-make carbon a ganglia_new aggregator for eqiad

b1266d5626-+-Note which LDAP groups are allowed in HTTP login prompts mentioning labs

00bd7f1602-+-Merge "Labs: set_strip_cache for labstores" into production

dc9a7c4c62-+-Merge "dynamicproxy: Open firewall for proxymanager" into production

56a7b33bd6-+-Labs: set_strip_cache for labstores

2edf11c308-+-Add sqlite3 and pixz utilities on html dumps host

c28b815016-+-Fix 5xx retry for parsoid backend

ae055fb7f3-+-Use chained cert for archiva if ca_name is set

775970bfe1-+-Use GlobalSign cert in cert chain for archiva by default

a184bd2742-+-ocg: Fix ferm rules

33d2852383-+-dynamicproxy: Open firewall for proxymanager

a9fba58bfb-+-Merge "Issue new certificate for virt-star" into production

1bdac2bb9e-+-Merge "Kill the old unused package-builder manifests" into production

209e32f9c3-+-zuul: update monitoring regex check

8968ecb3d8-+-Merge "base: be pedantic about template filenames" into production

d3a89faa57-+-package_builder: Use mirrors.wikimedia.org

b9ea412201-+-Merge "zuul: switch install to a Debian package" into production

92eab6e2db-+-disable rate limits on html dumps backend, proxy has them

3bae8cbf75-+-base: be pedantic about template filenames

5972e458fb-+-statsite: allow instance settings to be fetched from hiera

1eef931fb7-+-Reimage copper as jessie with role::package::builder

0889192319-+-zuul: switch install to a Debian package

87f3e13c26-+-Issue new certificate for virt-star

98ffd5c7f7-+-tools: Register only with 'active' proxy

113358714b-+-tools: Allow redis access between proxies

12976b8a13-+-tools: Install redis-tools on trusty bastions

e67ecd6547-+-dynamicproxy: Don't open up proxy api only to internal users

6e7d80c63d-+-dynamicproxy: Do not bind redis only on localhost

e365a18684-+-dynamicproxy: Include firewall for base proxy

4658ed535e-+-dynamicproxy: Explicitly open port for dynamicproxy-api

dd6973e4f2-+-tools: Enable firewall on webproxies

f5bc5cbccf-+-tools: Explicitly open port for proxylistener

40e04d6cd0-+-dynamicproxy: Add ferm rules for http / https

71ce186e08-+-dumps::zim: open port 80 for http connections

3bf0b5f615-+-dumps::zim: fix template source line

3d1dcb351a-+-Merge "dumps::zim: fix nginx setup / basic site template" into production

c1618b7112-+-dumps::zim: fix nginx setup / basic site template

a680e46a2f-+-lint: indentation fixes in roles

b9d3ca9ae7-+-Merge "Populate labvirtstar from wmf_ca_2014_2017" into production

0a1225c2c5-+-Rename rrd-navtiming to 'coal'; log to Whisper file instead of RRD

702ee9aea7-+-Merge "Tidy up codfw nova config a bit." into production

581801021e-+-Tidy up codfw nova config a bit.

07fe7773ed-+-dumps::zim: libsqlite3 is actually libsqlite3-0

9a01c9ad53-+-dumps::zim: add role and firewall to francium

54edcd9974-+-site.pp: add node francium.eqiad.wmnet

bc97d859e0-+-Merge "Add a codfw nova config." into production

58f0618402-+-Merge "html dumps will be served from host where they are produced, via proxy" into production

2a2c542eb6-+-Populate labvirtstar from wmf_ca_2014_2017

90a669b804-+-Add a codfw nova config.

30ac326cb5-+-Tune up use of the nova_ldap sink handler

74d23569b2-+-Merge "Have sink create ldap host entries." into production

0393466b22-+-Change the keystone token cleanup cron.

9e95f828a0-+-Ensure that apt preferences are named *.pref

dcde867a6d-+-move prof perf tweaks to separate include

28f55b1845-+-remove ancient+unused varnish::packages from base role

a7fd6ed229-+-restbase: add ganglia aggregators

46822cf639-+-eventlogging: adjust counters thresholds

f339140415-+-cache: change the label of the hiera lookup

066c4e59a6-+-tools: Remove tomcat node definitions from puppet

efd5d11896-+-Labs: puppetize labsdb1005's mysql setup

d172984913-+-Have sink create ldap host entries.

b02c803699-+-We need -y when calling salt-key -d remotely

c6791137b1-+-Fix insertion of the designate ip into the certmanager key

72125f8eca-+-Create the .ssh dir before sticking a key in it

b1af7be536-+-Move the cert_manager key to the designate user's home

3a166e9a36-+-Give certmanager a homedir

16ada5a712-+-Just hardcode the designate ip.

ad39c7199d-+-Install the cert_manager with a file resource

c363f363e6-+-Avoid duplicate definition of puppetmaster::certmanager

3c97c8fcc9-+-Set up ssh keys so that designate can clear salt and puppet certs.

a9f4eceaee-+-Revert "Revert "tools: Separate registration / unregistreation for proxylistener""

cd21e12bd8-+-Revert "tools: Separate registration / unregistreation for proxylistener"

10bdb685fa-+-tools: Separate registration / unregistreation for proxylistener

29ee03bae2-+-tools: Remove remnants of portgranter code

a5f5f06a49-+-Typo fix

200dbc6589-+-Merge "Typo fixes in role::ganeti" into production

e51331b785-+-Typo fixes in role::ganeti

5ab5764bc8-+-r::c::config::active_nodes -> hiera cache::$cluster::nodes

7cbe87e6d0-+-Merge "Install labvirt-star cert on labvirt nodes." into production

7a66a15bbf-+-Typo fix in ssh::userkey

084dc0d5a1-+-Followup fix for 7ba51bc

7ba51bc098-+-ganeti: Reference correctly the ganeti cluster nodes

6457adbce7-+-Merge "Move the keystone token cron into openstack::database-server" into production

de8f244a8a-+-package_builder: fix dependency order for hooks

8eb5dcf178-+-html dumps will be served from host where they are produced, via proxy

93f5058f37-+-various role classes: moar small lint fixes

5151d0ebf7-+-Set dedicated SUL rename runner loop

4ce16a56d6-+-mailman: adjust io stat monitoring threshold

6254a44744-+-get rid of $active_nodes[api] (unused)

a690eae4e1-+-releases: install unzip in module, not on node level

23d6eb4eac-+-Gzip SVGs on back upload varnishes.

92fab4a3eb-+-Merge changes I6ff831cf,I6cd2c8d5,If63159ae into production

2026c06e5a-+-cache config: remove decommed nodes list

c61d1266ef-+-Merge "contint: +libxml2-dev +libxslt1-dev" into production

09664d4a30-+-move parsoid applayer backends from $active_nodes to $backends

312cb1d3b0-+-contint: +libxml2-dev +libxslt1-dev

e001f1fde3-+-dynamicproxy: Provide list of active proxy entries for urlproxy

64cd060c18-+-Tools: Allow proxy certificate to be manually managed

1ebbcd5a17-+-Tools: Make list of proxies for portgrabber configurable

433fb8c543-+-Enable SVG GZip compression on cp1064

f90aa14ce8-+-Install labvirt-star cert on labvirt nodes.

70c208bf2f-+-Provision the ssh key added in 3c8c524

ac81509e24-+-Merge "ssh::userkey: Allow a prefix to be specified for a key" into production

5b3f1919e4-+-graphite: switch remaining machines to statsdlb

3940194aec-+-ssh::userkey: Allow a prefix to be specified for a key

930959ba7a-+-Specify ssh userkey policy for ganeti clusters

f5aeab3135-+-labnodepool1001: standard + add CI admins

a05558745f-+-Move the keystone token cron into openstack::database-server

0e43f5c804-+-Clean up expired keystone tokens.

0a391bbf7c-+-cache.pp cleanup: split one def per file, move to module loader

60ada68050-+-Merge "Labs: Disable idmap on instances" into production

a2e654d0af-+-varnishkafka: fix misplaced parenthesis

a396bb5269-+-cache.pp cleanup: various format nits

4e7d5a1da8-+-cache.pp cleanup: decompress ssl def usage

f7f2fb85df-+-cache.pp cleanup: qualify localssl helper def as r::c::ssl::local

b404402d1f-+-cache.pp cleanup: class names: s/r::c::varnish::/r::c::/

d3683a6e20-+-cache.pp cleanup: ws (some nodes unindent)

33453fc6f9-+-cache.pp cleanup: a little formatting

15ec5d0385-+-cache.pp cleanup: ws (classes unindent)

508db2ee4e-+-cache.pp cleanup: un-nest class defs

72dde6b87f-+-varnishkafka: fix spurious UNKNOWN alert

255e46485b-+-Restrict file persmissions on eventlogging mysql consumer

34314829f7-+-Add a generic node service module

acddc77d25-+-Make labvirt100x into compute nodes.

589026b07a-+-Simplify virt100x node definitions.

5e15039af7-+-Merge "Include openstack_version param in the scheduler class" into production

5440840dc7-+-Bugfix (I hope) for labs breakage from 3d2fadd5

465a6e9449-+-Add a custom pool-based filter for nova scheduler.

42b5837eec-+-Fix typo in template name

a80650dbda-+-Add brrd module

1dc4c69d66-+-Include openstack_version param in the scheduler class

85a8c3d5ce-+-mariadb: lint fixes in role class

3dd3e5386d-+-T86663 5.8: repool cp3010

061cdddef4-+-Merge changes I2944fe8e,I3369a68f into production

102b524697-+-T86663 5.8: switch cp3010 role

c731d444f9-+-T86663 5.8: pool 3049; depool 3010

b7cd4d6002-+-T86663 5.7: repool cp3009

be48eb98b2-+-T86663 5.7: switch cp3009 role

69280a0de0-+-T86663 5.7: pool 3048; depool 3009

dd10d78f2c-+-T86663 5.4: repool cp3006

9f9ea0d248-+-T86663 5.4: switch cp3006 role

76061ba90f-+-T86663 5.4: pool 3039; depool 3006

0b6ec4f57a-+-remove amssq* refs from site.pp and cache role stuff

4d220c2d45-+-Labs: Disable idmap on instances

782192105e-+-T86663: depool amssq56-58

218514c51f-+-statsite: look up the graphite host on hiera

4c05a245e7-+-Wikidata builder

93d3335ea1-+-T86663 5.3: repool cp3005

1a3fadf9a8-+-T86663 5.3: switch cp3005 role

920ea4adb7-+-T86663 5.3: pool 3038; depool 3005,amssq55

88b10d0e85-+-remove pointless esams $ganglia_aggregator from bits

3cd865f51b-+-T86663 5.6: repool cp3008

4c87b49345-+-T86663 5.6: switch cp3008 role

545239eeb6-+-T86663 5.6: pool 3047; depool 3008,amssq6[12]

b825ae537e-+-backup: lint

39bf4eaf60-+-Merge "beta: lint" into production

9595852396-+-beta: lint

d5caa7fbd9-+-T86663 5.2: repool cp3007

68ede62367-+-T86663 5.5: switch cp3007 role

07e970689b-+-T86663 5.5: pool 3046; depool 3007,amssq59-60

e622d056f5-+-T86663 5.2: repool cp3004

6fb963a0aa-+-T86663 5.2: switch cp3004 role

04fa488858-+-T86663 5.1: pool 3037; depool 3004,amssq5[34]

da047cff02-+-T86663 5.1: repool cp3003

8bde0742bb-+-T86663 5.1: switch cp3003 role

e2f42437f6-+-T86663 5.1: pool 3036; depool 3003,amssq5[12]

f961f411ba-+-contint: 'zip' package via ensure_packages()

6cc5fa1da0-+-package_builder: use ensure_packages()

57248b84b6-+-Use ensure_packages rather than package resource for many analytics and statistics roles

5795d0485f-+-kafka: adjust graphite checks for statsite names

3c8642536b-+-Install common compute packages on Hadoop cluster nodes in a better way than the last commit

19b48ed161-+-Ensure useful (mostly python) packages are on analytics worker and client nodes

0084b92918-+-standard: include admin wherever needed

194e92db4b-+-contint: update browsers package names for Jessie

fb8f9af9e4-+-Configure OCG to report counters rather than meters

02f39952b6-+-statsite: fix stream_cmd invocation

862cfe8fdb-+-ssh: remove lucid special casing for authorized_keys_file

ccc543dfdf-+-ssh: allow parameterization of authorized_keys

d6a0f451d8-+-Kill the old unused package-builder manifests

a728a4b8e7-+-icinga: update checks after statsite migration

b671a51f97-+-role::package::builder uses package_builder module

172bc6f224-+-Package builder module

f951a83ef8-+-statsite: fix hostname variable

0a603269db-+-statsite: support debian systems

3dc683347c-+-statsite: replace ::txstatsd class and role calls

a72bcaa012-+-statsite: s/8127/8128/

8637a8c1ed-+-contint: Jessie does not have openjdk-6-jdk

17de978bf5-+-statsdlb: s/decomission/decommission/

5286feb485-+-statsdlb: replace txstatsd with statsite

b7a417962a-+-statsite: new module

f4a322e11b-+-Better qualify the virt10xx node definitions.

bb1711babd-+-tools: Add switchover / hot standby capability to tools services

6de17ac6f0-+-swift: use keepLastValue where appropriate

62e26215b6-+-Use ensure_packages for java on hadoop clients

d5320f6b80-+-Remove references to vanadium in order to decomission

50b75cfb63-+-tools: Make toollabs::services inherit from toollabs

3b6cad447c-+-Merge "dataset: lint" into production

4b67ff149f-+-dataset: lint

36b3453912-+-gerrit: lint fixes in role class

42d1cecd72-+-logging: lint

ad56d6b03f-+-tools: Make services host a submit host

80bfcdfee4-+-Merge "labsdns: lint fixes" into production

1786b488e7-+-labsdns: lint fixes

cef7f6eef5-+-Merge "logstash: lint" into production

47d00f940e-+-tools: Add role / class for tools manifest services

bb1c17e051-+-T86663 4.4: repool cp301[48]

07dfb94fe8-+-T86663 4.4: shuffle roles, no repool yet

e8b7de6c72-+-logstash: lint

3780dabeed-+-T86663 4.4: pool 3045; depool 3018,3014,amssq49-50

b6926a612c-+-T86663 4.3: repool cp301[37]

019e4fe6f6-+-T86663 4.3: shuffle roles, no repool yet

479f81cc24-+-T86663 4.3: pool 3044; depool 3017,3013,amssq4[78]

9963a85bf6-+-T86663 4.2: repool cp301[26]

ba1480683e-+-T86663 4.2: shuffle roles, no repool yet

53fa4ea982-+-T86663 4.2: pool 3035; depool 3016,3012,amssq4[56]

cc8591f378-+-T86663 4.1: repool cp3015

aa0cb82354-+-T86663 4.1: shuffle roles, no repool yet

103db35cc7-+-T86663 4.1: pool cp3034; depool cp3015,amssq4[34]

c1ecb1af7b-+-limn: minor lint and Resource attributes quoting

0be1a4ba73-+-Fixes for rrd-navtiming

86833d02d4-+-Create Wikidata ttl dumps on Mondays 23:00:00 (UTC)

f0ebe084db-+-Make sure archiva certificate is installed before refreshing nginx service

7d86642fbe-+-Set up https with archiva certificate for archiva.wikmedia.org

62ae179bd4-+-phab: indentation fixes in role class

615e71c14d-+-Merge "ZIM dumps: install nodejs and libsqlite" into production

bdfdb4716c-+-Merge "dumps: add classes for zim dumps, add imagemagick" into production

7fce20b520-+-tungsten: deprovision roles

c488508712-+-puppet: selector outside a resource

6f645490e9-+-assign db2041 to s2

99f7b70a57-+-Merge "Add a script for storing NavTiming metrics using RRD" into production

3e10c96400-+-Add a script for storing NavTiming metrics using RRD

22f38b9516-+-snapshot: fixup for  I1863679d and Icc9aba2

a25059b2fc-+-graphite: fix carbon-relay queue check

0741e82371-+-esams upload: add cp304[23]

5c96bc70b0-+-esams upload: add cp303[23]

d62141dcfe-+-esams text: add cp304[01], kill amssq37-42

3af1cc6cf3-+-esams text: add cp303[12], kill amssq31-36

a0baf4dc1c-+-add site.pp cache roles for cp30[34]x

1ea67dbeec-+-clean up cp30xx site.pp regexes

3d2fadd5b5-+-scale varnish->varnish backend weight for prod 2layer clusters

7e5a7c5e8c-+-Merge "Increase I/O values for mailman check" into production

3ec2080d09-+-Increase I/O values for mailman check

45506c4bb3-+-create /srv/patches directory on tin

8499937455-+-Add git-new-workdir to tin (via deployment::deployment_server)

207589a960-+-Include labs ldap client config on holmium

f173fb61a8-+-Adding metric 'wikimetrics successful reports' to statsd labs

24b62f33a7-+-phabricator: re-include standard

eff2e014d3-+-assign db2042 to s1

ded7bedf06-+-phabricator: use hiera for admin

dc475714b6-+-analytics: use role, hiera

d14076df23-+-analytics: fix puppet dependency cycle

d31b2d1e60-+-analytics: correctly define dependencies

d0399bbfb6-+-Remove ferm rule for rsync & udpmcast from hooft

f2f75a1976-+-Fix the usual stupid puppet include loop bug

55f7a68871-+-pmacct: rewrite the module/role

5d061553d8-+-Repurpose rhenium, format as jessie

2ecf676cf3-+-otrs: kill exim_messages_in check

32df7eac47-+-Tools: Factor out registering with proxies

6281d545e9-+-Merge "Revert "dumps: ferm service for rsyncd clients using hiera"" into production

e2babb0916-+-Revert "dumps: ferm service for rsyncd clients using hiera"

7ffca4c203-+-Merge "dumps: ferm service for rsyncd clients using hiera" into production

81aace7d62-+-Merge "bugzilla: use https by default for static" into production

cb8afa03e1-+-phab: update phab version in labs to 2015-02-18

11427d9fc5-+-base: Allow hiera to override ldap use_dnsmasq variable

27022366c2-+-bugzilla: use https by default for static

e94b14dba1-+-decom rbf[1-2]00[1-2]

602d746af3-+-haedus / capella: remove from site.pp

72148dcde2-+-Merge "remove radon from site.pp" into production

26f92f2f02-+-remove radon from site.pp

f1002d7ca8-+-puppet_compiler: resource attributes quoting and minor lints

804869246e-+-ferm: resource attributes quoting

dca08e6fab-+-dynamicproxy: resource attributes quote

9c40d15c90-+-postgresql: small lint fixes for server.pp

87133af758-+-Merge changes I2288699d,I56879378 into production

5b8b9ab8d2-+-Alphabetise site.pp

b828721b12-+-labs: update bastion values in network.pp

861639cfba-+-Fix eventlogging graphite consumer on hafnium

f63fcdbed2-+-Don't use critical => 'true' for eventlogging disk space alerts; also fix /srv alert path

31cbe892cd-+-Set up disk full alerts for eventlogging that will notify the analytics contact group

d1968e2b83-+-various role classes - indentation fixes

0be61a17b5-+-Merge "network: add uranium.wm ipv6 to def" into production

691f213af3-+-Silence Phabricator/Bugzilla migration cronspam

102400fe39-+-Kill passwords.pp, superseded by labs-private

32a82ccef5-+-postgresql: choose distro-appropriate default version

d9d6a6cb8a-+-network: add uranium.wm ipv6 to def

ab0887d9f6-+-apache: Mute warnings about right-to-left relationships

bc3a2a292f-+-openstack firewall: avoid hardcoding iron IP

9816598417-+-openstack firewall: avoid hardcoding tendril IP

4f834ec21f-+-Tools: Update toollabs::toolwatcher documentation

9b19153a78-+-labs: Alert on high load in labstore*

852221430b-+-tools: Puppetize webservice2 requirement

fbe560cd2d-+-bacula: lint fixes

56dd9f53d0-+-Merge "Make vbench more generic" into production

4a12fd0698-+-tcpircbot: Use require_package

b5318516af-+-ircecho: Fix permissions for init script

4171b09a44-+-ircecho: Fix typo

5e9740a576-+-ircecho: Move all files into repo

bfb9a07046-+-Merge "otrs: fix duplicate package definition" into production

28d4fff0f3-+-otrs: fix duplicate package definition

d7cec062c1-+-Merge "scap: remove perl packages, fix duplicate declare" into production

2f862532e8-+-scap: remove perl packages, fix duplicate declare

f53f857a09-+-Merge "Fix duplicate Package[git-core] declaration" into production

104be7d0e5-+-Install jq in eventlogging role

3196131da6-+-Use ensure => present for default varnish::logging

6729205836-+-Use ensure => absent for varnish::logging vanadium

057b1556f6-+-varnish::logging: use service_unit

1ea5a386ab-+-Merge "Fix duplicate Package[gdb] declaration" into production

31cae723f5-+-Use eventlog1001 as main eventlogging host instead of vanadium

9bfc27307e-+-Puppetize eventlog1001

4bed9bcd7e-+-tools: Have webservice write out a service.manifest file

48f6d3e7c3-+-Ignore some warnings about case statements without default matches

ef6b09299b-+-labs: Add monitoring for high iowait on labstore instances

3322ffe99e-+-cassandra: add firewalling  on prod

ca3edd269a-+-Fix duplicate Package[git-core] declaration

e4d393808f-+-Fix duplicate Package[gdb] declaration

f90b2f5d69-+-ganglia: remove class ganglia::logtailer

0369be5843-+-move jobqueue monitoring out of ganglia.pp

b12a245ecb-+-Merge "install phpunit on release server" into production

32634e7e66-+-Merge "remove orientdb role from haedus and capella" into production

81f8fe0d93-+-remove orientdb role from haedus and capella

966275daa4-+-dumps: ferm service for rsyncd clients using hiera

1cd456cb76-+-shinken: typo fix

b39fda61c8-+-Citoid: switch from localsettings.js to config.yaml

88cca075dd-+-snapshot::wikidatadumps: Declare dependencies

ad417571c9-+-Fix snapshot::wikidatadumps::common inclusion

06e108fd83-+-Add a script to create Wikidata ttl dumps

498430d77b-+-Generalize wikidata dump scripts

1212f7b2c4-+-tools: Make webservice2 the default webservice

19d3929687-+-Make sure mediawiki-config is cloned before running sync-common

0f5e008117-+-repool cp107[1234] (eqiad upload) backends

faf79b71fd-+-Merge "Labs: monitor and alert labnet1001 for conntrack" into production

7cad5274f1-+-Default ignore alternate file domain config

49e858560c-+-Merge "Ganeti module/role introduced" into production

b5bbfb9d49-+-Merge "Assign role::ganeti to ganeti boxes" into production

f689c68821-+-Merge "ferm: install libnet-dns-perl" into production

371c5e3582-+-Merge "Labs: make net saturation monitoring configurable" into production

377b54a23e-+-Labs: make net saturation monitoring configurable

99b88ab00c-+-Correcting end of line on wikimetrics.pp

c6463d4e84-+-wikimania_scholarships: don't manage open/close dates

6afdf8380a-+-ferm: install libnet-dns-perl

4231bb2e9f-+-Merge "Add new wikidata folders, define dataset folders in puppet" into production

4910a7552a-+-Add new wikidata folders, define dataset folders in puppet

8b7c761798-+-cassandra: add ferm rules using hiera data

f70443cd1a-+-Labs: monitor and alert labnet1001 for conntrack

2bcf8970d1-+-Merge "Disable automatic updating of resolv.conf" into production

ea36c5efe1-+-Merge "One-letter fix!  s/horison/horizon/" into production

af91eda444-+-Merge "Add a Horizon-specific nova policy file." into production

d28b0e3684-+-Merge "Tweaks to the conntrack collector:" into production

326480631e-+-Tweaks to the conntrack collector:

87edd81b6e-+-Use csw2-esams' mgmt interface

e0492aef8a-+-Assign role::ganeti to ganeti boxes

191a5b6603-+-One-letter fix!  s/horison/horizon/

a1f6b5599d-+-Add a Horizon-specific nova policy file.

857f4ccfed-+-shinken: add wmt project to monitoring

50895a74ed-+-Disable automatic updating of resolv.conf

08250b9de7-+-shinken: Set up IRC notifications for cvn

403eabb6af-+-Merge "cassandra: firewall rule for JMX monitoring" into production

688c4d75d4-+-ZIM dumps: install nodejs and libsqlite

99c39a1cf4-+-install phpunit on release server

10ab3ee1c8-+-Hiera-ize the Elasticsearch config

1c20566524-+-fix token augeaus matching

03796fc818-+-add_ip6_mapped: use tokens on trusty/jessie+

5778337dbd-+-add_ip6_mapped: no-op refactor to make +token commit simpler

625c4cb010-+-ganglia: unbreak the labs NFS cluster

255ba1347d-+-Don't generate monthly Xenon graphs

f3ba2705a1-+-ganglia: autogenerate datasources from the list of clusters

85a1cd7e3d-+-Trebuchet group wikidev; mw-staging owner mwdeploy

cfbbc0ab3d-+-beta: Fix ::beta::autoupdater to work again

08038bec25-+-allow direct emails from vendors to procurement

44ffa78943-+-cassandra: firewall rule for JMX monitoring

bb860fa4ef-+-Merge "cassandra: fix syntax error, typo in ferm service" into production

10e809b64e-+-cassandra: fix syntax error, typo in ferm service

b832071d16-+-Merge "Remove randomness param from change dispatcher script cronjob" into production

57fd72751b-+-cassandra: firewalling for internode comms

8007f2e81f-+-Remove randomness param from change dispatcher script cronjob

b4ad39496a-+-cassandra: firewall hole for port 9042

8cfb22193d-+-dumps: add classes for zim dumps, add imagemagick

2aa65c3275-+-Labs: *correctly* collect conntrack stats

2a9bab8892-+-Merge "Labs: collect conntrack stats for labsnet1001" into production

b7b3775112-+-remove RT queue translations for phab

ac622af403-+-Override nameservers for lvs3002/4

030ab5a8c1-+-Labs: collect conntrack stats for labsnet1001

a46b6b0aa0-+-Merge "Conntrack collector for diamond" into production

2272312689-+-install-server: use /etc/dhcp consistently

e54467adc9-+-Adding logster to count requests to wikimetrics UI

ab3c192bf3-+-Labs: Monitor network staturation on labstores

4c96e01358-+-add_ip6_mapped: remove temporary code from last year

98de0fc938-+-Labs: Split out labstores substance into roles

523984c9d0-+-Deprecate the old in-subnet esams DNS IP (91.198.174.6)

b6ff756a36-+-nescio.esams -> nescio

f69a9b6761-+-Add dedicated runner for MessageIndexRebuildJob

00edaa7c1b-+-Conntrack collector for diamond

d7d96b915d-+-ganglia: remove unused configs from ganglia::collector::config

65859708eb-+-ganglia: DRY, use hiera

3c8c5248f3-+-Ganeti module/role introduced

0f5e4f96d6-+-give maerlant some NTP upstreams

bf291eced2-+-realm/autoinstall: switch esams' recursor to dns-rec-lb

b79a45d5d5-+-Make maerlant an (esams) NTP server

b28eb70a74-+-Add role dnsrecursor to maerlant

105ce8c005-+-lvs: split the config for high-traffic2 & esams/ulsfo

16ac239432-+-lvs: configure dns_rec for esams

e4aeecb76c-+-lvs: add dns_rec/dns_rec6 for esams

242b073343-+-lvs: fix IP for eqiad's dns_rec6

0c303a28f0-+-lvs: fix IP for codfw's dns_rec6

139c36fc44-+-mediawiki: install fonts metric-compatible with Calibri and Cambria

fae25390cc-+-icinga: check its own configuration

76923e99a3-+-Merge "cassandra: add monitoring for CQL interface" into production

5dd979f68f-+-cassandra: add monitoring for CQL interface

0c3496f928-+-Merge "mailman i/o monitoring: raise timeout" into production

62da0a43ab-+-mailman i/o monitoring: raise timeout

486747e905-+-Merge "Fix epic c/p error in the last rabbit password patch" into production

1a474d12c2-+-Fix epic c/p error in the last rabbit password patch

47effccb00-+-Merge "Update the password for labs rabbitmq" into production

e72f9710df-+-address mail loops on some exim servers

66ba1db74f-+-strongswan: lint fixes

e2d5b7bd4b-+-cp3001 & cp3002 no longer exist

509831e210-+-Install ipython-notebook on analytics client nodes

bc3c0c0c19-+-strongswan: fix typo in disable-sysvinit Exec

cc08151129-+-wikimetrics: lint

c1e66fb283-+-geoip: disable show_diff

9beffa5a03-+-Merge "swift: don't show diff for builder files" into production

5f66729304-+-swift: don't show diff for builder files

c50803130e-+-VarnishStatusCollector for diamond.

90a19789ad-+-Update the password for labs rabbitmq

6c111b8f24-+-Merge "lists: activate I/O monitoring on sodium" into production

9df50ecaa1-+-lists: activate I/O monitoring on sodium

3887fad4e8-+-actually deployed the provenance VCL

ae66b80832-+-fix exec: s/cmd/command/

61bf3a46a1-+-lists: fix duplicate definition of systat package

aa44082b9e-+-Merge "Use the custom nova_fixed_multi handler for sink." into production

ee3bf2d1c1-+-Use the custom nova_fixed_multi handler for sink.

be2dfc252c-+-Merge "install check_iostat on list server" into production

54af5e201e-+-install check_iostat on list server

aac97c4203-+-strongswan: divert sysvinit script, order pkg inst deps

5de0c8fe6a-+-ensure sysstat and bc installed on list servers

b3a2c7248d-+-(fixing white space) adding init.pp & power.xml entries for ps1-d1 to d8-eqiad

74410300d2-+-contint: migrate to require_package()

a5f87d1258-+-Apertium: Install needed language pairs for CX

ce13a2cc1b-+-icinga: define labsnfs_codfw hostgroup

f7343cd9f9-+-tools: Ensure that portgranter is running

1a42a6dd0b-+-mediawiki: don't check dsh group in codfw

9bd5bd111e-+-tools: Ensure that proxylistener service is running

3c1ce8b725-+-Merge "haproxy: quoting / lint" into production

419f356f7d-+-haproxy: quoting / lint

df18213d97-+-Merge "reprepro: lint fixes" into production

45936bdf61-+-reprepro: lint fixes

0bffd9f548-+-Merge "puppetception: lint" into production

5e35e57d1b-+-puppetception: lint

8a515223f3-+-Merge "iegreview: load Apache mod_headers" into production

2fcee83bcb-+-iegreview: load Apache mod_headers

a6d8eec43c-+-Merge "annual report: load mod_headers" into production

11680566c9-+-annual report: load mod_headers

f8f846b8b1-+-strongswan: cleanup Service invocation

85c442c098-+-phab: small lint fixes phd.pp,init.pp

21403f0eb7-+-Revert "IPsec: Icinga monitor for Strongswan connections"

a8ddc23f52-+-IPsec: Icinga monitor for Strongswan connections

05d334a960-+-IPsec: remove role from amssq*

6f56475e52-+-various betalabs cache storage sizing fixups

d4b45a90e8-+-Add multatuli, just standard for now

09a71bc7a4-+-Remove dummy redirect for fab-01

75a67f5f86-+-maerlant.esams.wikimedia.org -> maerlant.wikimedia.org

7112be58bc-+-Revert "exim4.conf.SMTP_IMAP_MM.erb local mail can cause loops"

38cf687f76-+-Add labstore200[12] minimal configuration

7c48dd35e2-+-enable OCSP Stapling everywhere

c667762976-+-mediawiki: re-enable monitoring in codfw

5742588465-+-zuul: lint

68259852c0-+-Merge "labs_vmbuilder: unquote ensure" into production

60f1de7687-+-Merge "ldap: selector outside a resource" into production

3a7a518013-+-labs_vmbuilder: unquote ensure

95c696c960-+-Merge "backup: resource attributes quoting" into production

e415af9315-+-Merge "mysql: selector outside a resource + 4 spaces" into production

13f0af7227-+-swift_new: lint and resource quoting

cae2c7874d-+-labs_vmbuilder: resource attributes quoting

f5f6a13d3b-+-nova: lint compute.pp

0ceb7a74d4-+-Make vbench more generic

c94aa1af89-+-Disable TCP slow-start restart on caches

0dbf450beb-+-bugfix for cp1008 test (puppet scoping?)

3ea37a3b5d-+-OCSP bugfix for 8aa4e450

47e02dfa51-+-test OCSP Stapling on cp1008

c1afe0288b-+-Merge "correct einsteinium node name" into production

8aa4e450b3-+-protoproxy/sslcert/cache: nginx ssl_stapling_file support

b649214c6c-+-add generic nrpe script check-fresh-files-in-dir.py

670a42ac43-+-correct einsteinium node name

2eb7fc2ce7-+-autoinstall: properly set up misc esams hosts

1cd9b8428e-+-Configure Labs Phabricators with default local repo store

5b535a7a09-+-phab phd user owns repo management scripts

c001d3981d-+-ipsec: drop the custom $site detection

df20122f00-+-puppetmaster: Keep reports only for 16 hours

973cd26b99-+-Re-add maerlant @ esams, format as jessie

c104dd8f3d-+-exim4.conf.SMTP_IMAP_MM.erb local mail can cause loops

35e9587b29-+-lvs: add loadbalancers for appservers, api and rendering

65fde18870-+-Don't include a node in its own seeds

95d7210e38-+-Firewall for Holmium

6b04789263-+-mediawiki: add dsh entries for codfw

332ed178f8-+-include firewall on uranium

0f6a9bea7c-+-Merge "puppet-lint: fix all 2sp_soft_tabs errors" into production

fa7a05cbaa-+-puppet-lint: fix all 2sp_soft_tabs errors

b8c1e19226-+-repool cp4009 T92476

a291f80a3d-+-Merge "puppet-lint: fix all 2sp_soft_tabs errors" into production

cb2b2296a4-+-Merge "Fix the fixed ip range for labs" into production

08de5aea87-+-Fix the fixed ip range for labs

575b76b562-+-puppet-lint: fix all 2sp_soft_tabs errors

99ac8313ca-+-Merge "Allow the labs dns server to recurse when hit from a labs instance." into production

763dd5d9eb-+-Allow the labs dns server to recurse when hit from a labs instance.

d8b4e0b9b5-+-toollabs: Add mosh to bastions

be8f1576b1-+-Log X-Cache header as new field in webrequest logs via varnishkafka

78def2b2dc-+-Merge "have base::firewall on codfw poolcounters" into production

ebf197d3d0-+-Merge "add ferm service for poolcounterd" into production

dfaa23412c-+-Merge "wikistats: lint" into production

372d45f75c-+-wikistats: lint

5c60924aad-+-Merge "scholarships: use HTTPS by default" into production

ae541f701d-+-scholarships: use HTTPS by default

61d666bb86-+-phab set daemon management scripts as phd user

fa5301ed3b-+-Tools: Make "admin" and "administrator" system aliases

0092361878-+-swift: increase rsync server max_connections

d72a449559-+-add ferm service for poolcounterd

94ba37e61e-+-have base::firewall on codfw poolcounters

aa0b83f8ac-+-add subra/suhail to site.pp as codfw poolcounters

63e32b4af0-+-Merge "gdash: mod_rewrite, mod_headers for proto redirect" into production

5a1c8fface-+-gdash: mod_rewrite, mod_headers for proto redirect

94a04f81c5-+-remove ori weekend commit check

d5fe388e2d-+-misc: remove tungsten

2b610013ac-+-misc: remove radon.eqiad.wmnet from cache.pp

4c9de968a3-+-disable nightly repairs

ab8b5e7cda-+-get rid of cache jessie conditionals

7298a6b15f-+-Merge "Add process monitoring for nova services." into production

830cd46e3d-+-repool cp1058

ece1d3a69f-+-depool cp1058 be

ebb072f33c-+-Add process monitoring for nova services.

2023034893-+-Icinga monitoring for nova-compute process.

7c7568cf22-+-Adjust RESTBase / Cassandra settings for deployment-prep

5abb86f8ea-+-Allow limn instances to specify Apache config for proxy

3d25c3cf67-+-ganglia: add views for a few of codfw clusters

742d58e307-+-swift: fix typo in label_filesystem

3276d10b46-+-swift: provision ms-be101[678]

2b94bcde79-+-Another fix for eventlogging varnishkafka timestamp format

b64b2f58cd-+-Use proper timestamp format in eventlogging varnishkafka messages

5403c0b72d-+-Set up kafka processor and kafka consumer for client side events from /beacon/event.gif via varnishkafka

10e7d8e4ca-+-phab update password location for phabtools

d3baf2bbb1-+-Set up eventlogging varnishkafka instance on production bits

f02142b76e-+-repool cp1047

22a6a7c70e-+-Make eventlogging forwarder define work with new forwarder config file format

2625aac65b-+-graphite: add error alerts

1d5de8f3df-+-sslcert: Don't delete manually managed private keys

bced31b2a0-+-overrid-able concurrent_compactors setting

22f090e5be-+-base: add tcpdump to standard-packages

87ac937f23-+-IPsec: big off switch

cfe6ec0363-+-add base::firewall on cassandra test hosts

b41340cc59-+-Merge "restbase: add ferm service for 7231/tcp" into production

efbf4be9da-+-mysql: selector outside a resource + 4 spaces

0b153166c9-+-Merge "extdist: minor lint" into production

eba876f651-+-Merge "Enable gzip of ico and svg files on labs bits" into production

f63f3f96c2-+-Merge "wikimania_scholarships: resource attributes quoting and minor lint" into production

a90aefc08e-+-restbase: add ferm service for 7231/tcp

eb3338678d-+-Enable gzip of ico and svg files on labs bits

6413a26864-+-Enable gzip compression for SVGs on upload on beta

c373c3802a-+-Fix default matches in case statements

fe693dccd2-+-Remove unused udp2log::nginx and relay configs from gadolinium and protactinium

738284017a-+-Merge "Revert "graphite: limit uwsgi workers memory"" into production

6458ed377f-+-Revert "graphite: limit uwsgi workers memory"

e4164ebed1-+-tendril - Increase HSTS max-age to 1 year

f3cba28663-+-Fix typo in I841c880b7

6cab5599f2-+-scap: lint

8a46ecefc0-+-Revert "set up bonded interface for ms1001 plus ipv6 for it"

2def030acb-+-set up bonded interface for ms1001 plus ipv6 for it

55691aebd7-+-diamond: stop collecting disk IO stats for partitions

3dc7a2a828-+-Run analytics/refinery/source guards on stat1002

14b9305ff7-+-Merge "Move labs/designate/pdns to ns2.wmflabs.org" into production

2669bfa77f-+-Move labs/designate/pdns to ns2.wmflabs.org

4520ad042a-+-Revert "Hiera-ize most of the Elasticsearch config"

ce3fa3b42f-+-sslcert: add sslcert::chainedcert

9f6dd86815-+-Hiera-ize most of the Elasticsearch config

12acad5f18-+-Merge "etherpad: minor lint" into production

55362df7e0-+-certs: remove legacy ensure => absent Files

24b99aedcf-+-Allow tendril access to silver for monitoring mysqld.

e5ff0efb44-+-backup: resource attributes quoting

c81f384f1a-+-extdist: minor lint

870dbdbce8-+-etherpad: minor lint

fdcc257836-+-wikimania_scholarships: resource attributes quoting and minor lint

4da7fcfef6-+-ocg: Move defaults to class params, rather than hiera

c38e1f300a-+-Revert "Revert "Include hiera classes in lab instance role""

818c0cab0a-+-citoid: Don't set default to undef for required parameters

180d1439f6-+-Revert "Include hiera classes in lab instance role"

f3a3ef4486-+-Fix ldap SSL cert deps

f1cf4368f0-+-Fix key source temporarily

70abda3eaf-+-sslcert: add sslcert::certificate

df6594adbe-+-sslcert: add sslcert::ca define, use it from certs

c383d8c10a-+-replace certificates::base code with ref to ::sslcert

3d2cd16b37-+-Introduce a new sslcert module to replace certs.pp

c6dc1c444a-+-Parameterize mail::mx role

8579b3a731-+-citoid: Specify default port for citoid in puppet itself

6727a323f8-+-sca: Include realserver only in production

a49df1427a-+-Use literal tab characters in eventlogging varnishkafka format

b6b07421cc-+-scap: Clone mediawiki-config on all scap masters

976ac21351-+-fix nova key source name

411f4645d6-+-fix nova key require

9ad29091b3-+-Revert "Introduce a new sslcert module (to replace certs.pp)"

0ab7a6b3d6-+-Introduce a new sslcert module (to replace certs.pp)

e5f5a56b7f-+-certs: kill install_additional_key

3dfeecbc5d-+-certs: inline create_pkcs12's only use and remove

2aed3e3cb1-+-certs: don't install pkcs12 certs on all systems

9388393d9e-+-certs: remove compatibility symlinks

9b1c3a1e9e-+-Tree-wide certificate path replacement, localcerts

b22edf7dc1-+-Add support for a pdns db admin account.

cf2cada27a-+-sca: Don't include admin in labs

22ed5ac715-+-graphite: increase relay queue size

0feb5ede33-+-Followup commit for cd41322

24aeb14769-+-ldap+yaml file puppet ENC for self hosted puppetmasters

1d37a2f3c7-+-Merge "Add configurable metric reporting for citoid" into production

cd413225eb-+-Merge "Backup /var/lib/jenkins/config.xml on gallium" into production

9683ee9666-+-Increase HHVM's memory_limit from 300M to 500M

d525ec394e-+-Backup /var/lib/jenkins/config.xml on gallium

9bf5c5798b-+-contint: Remove integration/kss.git

f2a3a5bce8-+-Add configurable metric reporting for citoid

4d5d7bb8ac-+-s/passwd/password -- I did this the wrong direction before.

0d3aba57f1-+-Fix a mismatch between 'password' and 'passwd'

530b218c7f-+-Holmium dns should use holmium's ip.

928f6c3f24-+-Give designate access to RabbitMQ on virt1000

fb39514d01-+-releases: fix syntax error in ferm rule

827012f436-+-switch ferm rule in releases to use network.pp

e1f43a8ba7-+-Merge "Added a node definition for holmium" into production

d3bf9b2273-+-Set up eventlogging varnishkafka instance in betalabs on bits host

1795ac08c3-+-pdns class and setup for labs designate

62d67a3957-+-Roughed in designate class

e6fb4294e0-+-Moved the labs ldap dns manifest into a module

492cd9c9ef-+-Moved the dns::recursor class into a module

5231804a61-+-phab work around dupe exim waiting on T9287

6707e84bb2-+-phab add group phabricator-admins to iridium

609a03ebaa-+-Added a node definition for holmium

846fd8011d-+-Fix syntax error in ferm rules for deployment ssh access

dd3b97c129-+-nova::manager: allow ssh from deployment

65177b8d88-+-mediawiki: allow ssh from deployment servers

4539cc445c-+-Allow kafka and zookeeper configuration in labs via hiera

2e251aa5cf-+-phab make mail processing bin executable

45d259cb7d-+-Add base::firewall on silver

0d87127aeb-+-depool cp107[34] backends

fdce5b0b6b-+-depool cp107[12] backends

42bc54f5fe-+-Merge "apply role::db::redis on rbf200[1-2]" into production

251e24e1d4-+-apply role::db::redis on rbf200[1-2]

bbc6f30930-+-Remove the conditional declaration for labs, should use hiera.

fb0a522e6c-+-repool cp1008, update node comments

90f9b979c0-+-depool cp3008 -> reinstall

d50f5b06d2-+-repool cp1049 after jessie reinstall

1607992fd6-+-depool cp1049 for reinstall

9e963c5937-+-uncomment cp1044

0ae5511d1f-+-phab setup for granular shell permissions v2

8b2f4ac34e-+-repool cp4015

364f2c2f86-+-phab setup to allow for granular shell permissions

4795c27ebb-+-depool cp4015 for reboot/bios

dca738de5a-+-puppetmaster: Fix typo in previous commit

573ac2de95-+-puppetmaster: Make the puppetmaster autoupdate variable hierable

f5f11592a8-+-Merge "puppetmaster: Refactor out the auto key signer" into production

acf55ae7f2-+-puppetmaster: Refactor out the auto key signer

3e2b3d60b2-+-replica-addusers: moar documentation

a37fd4b59d-+-Add pfw1-codfw to rancid, torrus

2ed56ca61f-+-Merge "selector outside a resource" into production

c48aa35257-+-mediawiki: disable checks, jobrunner in codfw

343a844e6c-+-repool cp104[35]

83080c5e67-+-depool cp104[35] (1/2 misc/parsoid)

295c5e01e2-+-repool cp3007

c13811036e-+-update varnish disk stuff for cp104[34] (misc)

252b73ebe2-+-depool cp3007 for reinstall

b4014a0264-+-repool cp1048

ba0cc3ceb1-+-depool cp1048 for reinstall

9feded0511-+-repool cp1050 after jessie reinstall

c89da1e221-+-depool cp1050 for reinstall

0a3860085e-+-Tiny lint change to extdist to test If1f7cbf5f

be78b18ed5-+-repool cp1051 after jessie reinstall

54e61453e8-+-cp4008 -> jessie

0c341103f8-+-repool cp3006

021297dd3b-+-depool cp1051 for reinstall (upload)

9495aa62f5-+-depool cp3006 for reinstall

116819d259-+-repool cp1066 after jessie reinstall

a833d487cf-+-pool cp107[34] backends

f915a1378e-+-pool cp107[12] backends

029570a81f-+-configure (but do not pool) cp107[1-4] for upload

d40d98142b-+-Merge "depool cp1066 for reinstall" into production

01e92b0558-+-Merge changes I342f2061,I8185344e into production

9cca1ad7b8-+-Merge "openstack: transition nova to ssh::userkey" into production

99c98d2339-+-Merge "Labs: puppetize replica-addusers" into production

ba2e7e9a8b-+-Labs: puppetize replica-addusers

96b782e192-+-Merge "Hit Parsoid directly" into production

d407a120be-+-Merge "Puppetise Citoid's configuration" into production

9410926d4d-+-Puppetise Citoid's configuration

c47c420269-+-Merge "Split mail smarthost for Labs" into production

87249095ee-+-Merge "reprepro: transition to ssh::userkey" into production

f5d4e42875-+-depool cp1066 for reinstall

4e07728c2f-+-deployment: Combine labs/prod deployment server roles

6ffae93be5-+-Merge changes Ia94c3b31,I96cfdc8d into production

5da9da363a-+-repool amssq31

960882db9b-+-IPsec: deploy on amssq*

8797106a46-+-Hit Parsoid directly

433adf01c1-+-Add restbase job runners

a4ef2e34de-+-puppet: transition to ssh::userkey

c7dec6ce7b-+-openstack: transition nova to ssh::userkey

121cc540ba-+-reprepro: transition to ssh::userkey

1f08784cb0-+-authdns: transition to ssh::userkey

3662f411b0-+-ssh: Make userkeys be world readable

b71e2ec3f7-+-repool cp3009

a29a521ece-+-depool cp3009 for reinstall

794dee3234-+-ssh: Don't give lucid nice things, because lucid is not nice

1d12052a10-+-cp1046/cp4009 -> jessie; depool cp4009 T92476

6771471ac0-+-mediawiki: transition to ssh::userkey

a6aaabf864-+-ssh: support /etc/ssh/userkeys in production too

2c6bb31454-+-ssh: change userkeys' path hierarchy

ae08121c8c-+-ssh: recurse/purge => true for /etc/ssh/userkeys

b6df55c894-+-ssh: introduce ssh::userkey resource

073262a28e-+-IPsec: refactor hiera data, clean up template

3a0e56f428-+-Merge "Move l10nupdate output directory" into production

38ad81a443-+-Move l10nupdate output directory

ff3064a742-+-Merge "Fix obvious bugs in previously l10nupdate fix" into production

64e2425650-+-Fix obvious bugs in previously l10nupdate fix

2ebe5a3bbd-+-Merge "Fix l10nupdate, have mwscript always use www-data" into production

798023dd74-+-Fix l10nupdate, have mwscript always use www-data

bc286d4701-+-tag cp1059 + cp4010 -> jessie

a16015cdac-+-tag amssq43-47 as Jessie

3d9cbaff6b-+-Merge "Added the jobchron daemon that complements jobrunner" into production

1b0b4ef14e-+-Added the jobchron daemon that complements jobrunner

37682f8e1a-+-Merge "gridengine: correct param order" into production

24e892ed16-+-Merge "git: fix param order" into production

5ea1c29839-+-repool cp1052 after jessie reinstall

f6d25e088d-+-more general s/wikimedia.org/wmnet/ fixups for cp* hosts

eb2db2c48b-+-rename/tag cp3019+cp3020

e499f21035-+-depool cp1052 for reinstall (text)

c91a831079-+-repool cp1061 after jessie reinstall

abdf394288-+-fix salt-minion on jessie

7691ddfc00-+-tag amssq39-41

a8c2bd3f87-+-Merge "depool cp1061 for reinstall" into production

83f246f29c-+-depool cp1061 for reinstall

f7288ec3a4-+-fix up ordering for salt-minion package, config, service

b3fa445d0d-+-repool cp1053 after jessie reinstall

f6ddf7550e-+-repool cp3005, tag cp4012

561a288dbd-+-admin module enable user cleanup

fe80c2e81f-+-depool cp3005 for reinstall

8d9850c47a-+-Add logrotate fragment for graphite-web

32117504a9-+-depool cp1053 for reinstall

c19eb3b627-+-various s/esams.wm.o/esams.wmnet/ fixups for cache hostnames

1f67c440d1-+-Merge "etherpad: remove SSL cert and settings frm role" into production

19ccb59e13-+-etherpad: remove SSL cert and settings frm role

eb78dc5634-+-Merge "planet: rm SSL settings and ports.conf.ssl" into production

507caec48f-+-planet: rm SSL settings and ports.conf.ssl

6daec757dd-+-repool cp3021,cp4004, mark amssq3[78]

76ae714840-+-Fix variable name conflict

66ef68ea05-+-Name refinery drop cron jobs accordingly

668d1126ca-+-Add cron job to drop refined webrequest partitions and data

0295b93503-+-Split mail smarthost for Labs

c0e4a9386d-+-depool cp3021 + cp4004 for reinstall

6cfbfd6896-+-Add master_key param for salt_minion module

505cac58ba-+-redis: set up servers in codfw

4798abe3cb-+-Make zuul use master branch on both prod and labs

4f99023c82-+-repool cp3004+cp4003

737ad84260-+-mediawiki: Make mwdeploy / l10nupdate pub keys hiera-able

8ec87de578-+-depool cp3004+cp4003 for reinstall

918a502b9c-+-tools: Fortify redis against OOM killing some more

9958005832-+-repool cp4016+cp4019

b1f0f5ddc7-+-depool cp4016 + cp4019 for reinstall

6543bb2294-+-repool cp4017 + cp4005

976201bf6f-+-depool cp4005 + cp4017

d87afb01ae-+-repool amssq58-62

aba8cbd1fe-+-Merge "bugzilla: remove SSL certs and settings" into production

f2a47904ee-+-bugzilla: remove SSL certs and settings

4c52c446b2-+-depool amssq58-62 for reinstall

631474cbd2-+-repool cp1054 after jessie reinstall

e3e14cf13c-+-Enable HSTS on tendril with max-age=7days

e0cbb98c6c-+-depool cp1054 for reinstall

4d8af109c8-+-repool cp1057 after jessie reinstall

314946ad49-+-Fix dependency cycle in archiva role

0b27b9b0ff-+-cp3011 disabled T92306

913070d32b-+-depool cp1057 for reinstall

7afa6adcb7-+-repool cp3010

56dd80aec3-+-repool cp1056 after jessie reinstall

c79d36c278-+-depool cp301[01] for reinstall

721a0e43b8-+-repool cp4006 + cp1062

3df7d26fcb-+-depool cp1056 for reinstall

3c775786d2-+-depool cp1062+cp4006 for reinstall

8f74980e64-+-apt: Remove invalid parameter $priority from apt::repository

81f00ec031-+-Labs: Puppetize labstore1003

ea0d65e77b-+-dsh: Allow setting group source via hiera

d5837b3885-+-trebuchet: Make the deployment server configurable via hiera

b4a2b42a30-+-mysql: Cleanup mysql::param

01a93d5488-+-git: fix param order

d3ee662201-+-gridengine: correct param order

0e36588b7d-+-network: Realm branch appserver ip ranges

5434f42516-+-ldap: selector outside a resource

381436045a-+-monitoring: selector outside a resource

98eb48fad6-+-monitoring: selector outside a resource

93d3b68541-+-selector outside a resource

bc64793ec2-+-repool cp3015,cp4007 - update amssq33

e795e3fcc5-+-depool cp4007,cp3015 for reinstall

609eedeb58-+-repool amssq54-57

1f4dc8cf9f-+-Merge "Remove duplicate definition of fonts-unfonts-core." into production

3d01e35e6d-+-Remove duplicate definition of fonts-unfonts-core.

998ffd54db-+-repool cp1067+cp4018

2c09fd90da-+-depool amssq54-57

ffeb2cc159-+-Merge "install fonts-unfonts-core, not just fonts-unfonts-extra" into production

9cbb77a16b-+-depool cp4018,cp1067 -> reinstall

a7432429b1-+-Merge "planet: webserver class, no ports.conf, simplify" into production

8fca5e01ea-+-planet: webserver class, no ports.conf, simplify

27b517d814-+-Deploy IPsec on cp1008

67701997a8-+-repool cp4002,cp4013

2b69964970-+-depool cp4002,cp4013

50f5cf939d-+-Merge "planet apache: don't install SSL cert and mod_ssl" into production

58678e3f6b-+-planet apache: don't install SSL cert and mod_ssl

8aa6a90ac3-+-repool cp3003

4e023b635f-+-depool cp3003 -> reinstall

cb7fc134f8-+-depool amssq31 for testing

dd41c3e770-+-Kill the ProxyFetch monitor for zotero LVS

4cc182f8e1-+-Add analytics1001 as misc varnish backend

4f7721128c-+-Set up proxy on misc web to serve Hadoop Yarn ResourceManager UI at yarn.wikimedia.org

b76dbb6f44-+-LVS configuration for zotero service

a50ad4ec3c-+-Add asw-esams to rancid, smokeping, torrus

9074f6d1fb-+-Include the zotero role in the sca role

ae2a10faf8-+-Merge "Puppet module for the zotero service" into production

5e05cc338d-+-Puppet module for the zotero service

40da7c3858-+-repool cp40[01]1

c47ff8e9b4-+-depool cp40[01]1 for reinstall

f0164ff4df-+-repool amssq48,49,52,53

d1b037a78d-+-repool amssq50-51

f120b26fd5-+-Merge "depool amssq52-53" into production

baea03217a-+-depool amssq52-53

165b73428d-+-Tools: Properly puppetize crontab replacement

fd783453be-+-Tools: Don't forward crontab to tools-submit for system users

677d5ab08a-+-tools: Switch redis maxmemory policy to allkeys-lru

453a1d9382-+-tools: Stop specifying params for redis maxmemory

3f8d110b51-+-depool amssq48-51

40bf2a7ccf-+-repool cp3012 (finally!)

c8caf414b2-+-repool cp4020

c123e68dc8-+-repool cp1055

6a0fbec89c-+-depool cp3012 for reinstall

f4b66fae94-+-depool cp1055

1c12d1cf9a-+-repool cp1069

fdb037373a-+-repool amssq36

f7858b47e2-+-repool amssq35

a2feebd244-+-depool cp4020+cp1069 for reinstall

2b712cd679-+-repool cp3016

c4e76b87d0-+-depool amssq3[56] for reinstall

fb242326ab-+-depool cp3016 and mark cp4014

f744ac1fa9-+-tools: Point internal DNS hack to webproxy-02 not webproxy

25c2c6f181-+-Tools: Split local apt repository by OS release

9f5ba5a49c-+-Increase number of Wikidata dispatchers by 1

a349c2896d-+-disable quickstack installation/update on jessie for now

b059a8b0e3-+-install fonts-unfonts-core, not just fonts-unfonts-extra

9faa6817f6-+-Increase the number of dispatchers again

340f4ac125-+-Force https for horizon, take two

804b4b62c3-+-Require https for horizon

6eb324a791-+-put base::firewall on calcium

8e801866fe-+-Labs: Don't start manage-nfs-volumes at boot

57396c527d-+-Merge "annualreport/devportal: add ferm service for http" into production

20a8eee37a-+-etherpad: remove ferm hole for 443

8fcc511428-+-annualreport/devportal: add ferm service for http

9e1e21041a-+-Merge "racktables: remove ferm service for 443" into production

41b8c99304-+-Merge "releases: remove ferm service for 443" into production

ae72b4e045-+-Merge "releases: typo in docs: ssh->tls/ssl" into production

e7a57d0ade-+-releases: typo in docs: ssh->tls/ssl

15cbbd1428-+-site.pp - adding a few node comments

c18ec81c9d-+-racktables: remove ferm service for 443

8164705c95-+-releases: remove ferm service for 443

3933c57f54-+-planet: remove ferm service for 443

59de8e5bb3-+-Merge "bugzilla: remove ferm service for port 443" into production

8a1d49e6b9-+-bugzilla: remove ferm service for port 443

9623228c72-+-Merge "Allow horizon host access to nova/keystone/glance" into production

a1f9ed4a81-+-Allow horizon host access to nova/keystone/glance

e45d0d279b-+-Merge changes Iad0d0f36,Ied0ecd79 into production

fb5f4c9b75-+-Merge "Let everyone see the horizon logo" into production

5932dbb7e2-+-Let everyone see the horizon logo

4b34bc88eb-+-Merge "disable phd autorestart for now" into production

bd1137cb87-+-disable phd autorestart for now

6827577fab-+-Add CORS to datasets.wikimedia.org

b0b30549aa-+-Labs: manage resolv.conf in labs also

db16895d7d-+-labs: Unify lvm roles

bd387c4a67-+-Tools: Use labsdeprepo

35815247a5-+-labsdeprepo: Allow more than one local repository

c5db3d6d66-+-repool amssq3[24], tag cp1063

7df50c01de-+-cp1068 -> jessie

747bef6205-+-repool cp4015

c616798e7b-+-depool cp4015

ab797e6251-+-Merge "contint: +libdistro-info-perl" into production

4d0748cf7b-+-horizon: add firewall hole for http

03c863f4ab-+-put base::firewall on californium

3e9f624332-+-depool amssq3[24] for reinstall

88492f22b4-+-mark jessie hosts

1f2d4b8ba7-+-repool cp3017

831116480c-+-depool cp3017

57061b1f17-+-repool cp3014,cp3022

4c62bee038-+-depool cp3013

ae121ab19d-+-Change dispatchChanges parameters for Wikidata

2d30711f0f-+-depool cp3022 for reinstall

81c6d1e12e-+-support both vlan domainnames for esams bits

0650ecb528-+-noc: unload mod_ssl - not used anymore

33a9baacd9-+-Move californium to a public ip, part two

486a769384-+-dbtree: add http->https protocol redirect

bc13d0e111-+-activate Apache site for dbtree

4f732e0cf2-+-ganglia: add codfw appservers

c3f9064fcf-+-repool cp301[48]

91ac2f4f06-+-swap cp301[48] roles, depool temporarily

95d9f20371-+-Merge "dbtree: add Apache config, move to own docroot" into production

7077518440-+-ganglia: add codfw jobrunners to the web views

db411dfd15-+-mediawiki: arrange mw-related clusters across rows

90addd641c-+-repool cp301[48] backends

13e5276ead-+-Merge "fix cp30xx storage sizes" into production

3deae003fb-+-fix cp30xx storage sizes

39bd5fd2d0-+-jobrunner: add ganglia config for codfw

55d0cc8302-+-Minor lint

558e179ed1-+-cp3018 -> jessie, s/upload/mobile/

6777169a01-+-cp3014 -> jessie, s/mobile/upload/

127307b24f-+-progress on cp3xxx storage config

825d09ebbc-+-wdq-mm: Stop monit

d2d255a24d-+-txstatsd: ensure $init_file attributes

95af5ceb35-+-Merge "lvs: init.pp lint" into production

b856f104bc-+-Merge "sysctl: move selector outside resource block" into production

d13c051a61-+-Merge "varnish: fix param order" into production

2d3a41afd8-+-varnish: fix param order

a4337c466e-+-Include hiera classes in lab instance role

65407552e8-+-sysctl: move selector outside resource block

4181239072-+-Parameterize roles for labs

1f984968d5-+-Tools: Install at

b3d10f6889-+-ipsec: facts in the right scope

3bf72432d3-+-lvs: init.pp lint

e3383f3822-+-base: move selector outside resource block

259e7622d7-+-network: add codfw to the appservers network ranges

a2f16b5ec6-+-Revert "mediawiki: correct dependency of php.ini file"

249c1aac62-+-mediawiki: correct dependency of php.ini file

f4a505aac9-+-apache: install mpm files after the package

865f7566d7-+-Tools: Deploy root web automatically

53e4b139f4-+-Add package 'tig' to tin (via deployment role) to assist with deployment

b4d1ad8b6f-+-base: move instance-upstarts to manifest

4e9c4cc70a-+-Merge "keyholder/eventlogging: replace UTF-8 chars" into production

b5a4f9ce2f-+-keyholder/eventlogging: replace UTF-8 chars

f3863f84df-+-hhvm: convert 'ASCII art' to ASCII

e9fbfbd6ee-+-statistics: remove 2 UTF-8 characters

e55ab067ae-+-role::deployment: add codfw deployment master (still tin)

d7c57800d9-+-repool amssq31

94807a52fd-+-depool amssq31 for reinstall

0bfc97d828-+-kill exec bit on systemd unit files

4c0fcb51e8-+-Merge "Use apt::repository instead of file resources" into production

cd2719b800-+-dbtree: add Apache config, move to own docroot

10a5fb395e-+-Also don't log the output of testwikidata's dispatchChanges

eadf63b020-+-Add four additional txStatsD backends on graphite1001

7ffb0bb077-+-planet: convert UTF-8 to HTML entities

e637dfe9c1-+-Merge "zotero: fix "invalid byte sequence in US-ASCII"" into production

3c77b8d989-+-zotero: fix "invalid byte sequence in US-ASCII"

e795a3633b-+-Switched horizon default version to icehouse

5873003a05-+-memcached_ip => ip

16b0b72133-+-Set up Californium as the Horizon host

b351a7c3af-+-Set up horizon.wikimedia.org on misc-web.

92ece23f15-+-Add class and role for Openstack Horizon

efd29f0704-+-Merge "Re-Organize (test)wikidata cron jobs" into production

ad211cbac9-+-remove old vk drerr check

c504b28c77-+-rm module apachesync

5de7b1d3c4-+-repool cp10(60|64|65|70),amssq42 post-reinstall

d004050e04-+-min_free_kbytes should always be an integer

873eb1e16c-+-cp1064 -> reinstall as well...

775048303d-+-depool cp10(60|65|70),amssq42 for reinstalls

b5ec1ab928-+-zuul: Use umask 022 for installing zuul

84efd127bb-+-Merge "Add hiera yaml for staging, refactor salt class" into production

7f17a0abb6-+-make bigobj min size on jessie labs

c60a27c01d-+-scale upload bigobj cache size

86cb0f2576-+-use mod/vk varnish_svc_name

1983981fe5-+-puppet-level dep of vk::instance on v instances

f25ef21cde-+-Merge "Remove labs sshd_banner" into production

079794e7b5-+-Re-Organize (test)wikidata cron jobs

a2c0096167-+-apache: fix typo

fc436a74c3-+-apache: perform the hard restart before refreshing the service

768a9c5aec-+-mediawiki: add codfw appservers to site.pp

bc446640bc-+-tools: Add redis slave role

9407b44789-+-Merge "Don't make script files writable by unprivileged users" into production

fc6c3958dd-+-Don't make script files writable by unprivileged users

c782e62d27-+-Remove labs sshd_banner

5ecb26a190-+-fix sysctl application on jessie

fd6b29663b-+-puppetize dbtree config file to connect to tendril

5536767c45-+-Merge "let puppet clone dbtree into noc/docroot/dbtree" into production

40d46a83f6-+-re-enable cp1064 uplaod backend in eqiad

9a12454ba8-+-Revert "wikitech: remove nutcracker"

33c7631ebe-+-Revert "Nutcracker should be 'stopped' rather than 'absent'"

ef7089a527-+-Nutcracker should be 'stopped' rather than 'absent'

90a657cf2d-+-Merge "wikitech: remove nutcracker" into production

5b272665bd-+-2layer caches: def 360G space for S3700 partitioning

7a5c308156-+-Render statistics-private mysql.conf credentials on stat1002

7a0a6d7b96-+-starting point for varnish storage sanitization T90583

cdc5af975f-+-depool cp1064 backend

3735dc79a2-+-Tools: Fix creating initial access.conf and shosts.equiv

897ce1c363-+-toollabs: Remove uwsgi node definitions

2b26b7d285-+-Tools: Puppetize toolwatcher

d4b7b63c57-+-Tools: Puppetize jobkill

feaab7b699-+-tools: Add uwsgi support to generic webgrid nodes

917a7be9e6-+-Strongswan: IPsec Puppet module

086d60254a-+-convert varnish to service_unit

433fe3975a-+-Add $template_name param to service_unit

bacd7a77a3-+-Add hiera yaml for staging, refactor salt class

47a6a8d940-+-statsdlb / txstatsd: add txstatsdctl and monitoring

3b70f59fd5-+-statsdlb: add two additional txstatsd instances

dc997f375b-+-statsdlb: quote $DAEMON_ARGS

6b276c7255-+-Add statsdlb role and provision on graphite1001

7cc147e34d-+-let puppet clone dbtree into noc/docroot/dbtree

92e9cf2a2f-+-Add statsdlb module

6074a9e356-+-tools: Add tomcat starter & required packages to generic nodes

da52f2fda3-+-tools: Move tomcat tools to generic node

93a0be8521-+-Merge "Tool Labs: fix test for creating known_hosts" into production

d5e6bf40f3-+-Alert critical if important Hadoop service processes are down

33dc153684-+-Tool Labs: fix test for creating known_hosts

52a98149ec-+-kernel/disk stuff for jessie cache installs

4dfecbf963-+-Merge "Revert "Disable cloning of TransparencyReport until the repo is public again"" into production

fd24ba0a62-+-Merge "Use the proper location for the libvirt driver on Trusty." into production

9cccde4d7b-+-Use the proper location for the libvirt driver on Trusty.

f83c4191b7-+-wikitech: remove nutcracker

7a46b9393b-+-Promote db1046 to m4 master

9fb159abd2-+-Switch EventLogging's MariaDB consumer to m4-master

8f72ce3a03-+-Merge "contint: Create /srv/deployment as 755 instead of 700" into production

594531b05b-+-contint: Create /srv/deployment as 755 instead of 700

f319ce3164-+-removing discard on jessie cache SSDs

33d28dc160-+-Deploy dbproxy1004 to m4

c8bcdc0d15-+-contint: Use 'wmf-deploy' branch for cloning mediawiki/tools/codesniffer

6bf403bebe-+-order nginx->varnish explicitly, take 2

9a4b1b7c78-+-order nginx->varnish explicitly

6db739f6e4-+-workaround PUP-2689 for localssl nginx files

51dbcecad8-+-Merge "Delete unused classes and templates." into production

15f6fc6870-+-Revert "Disable cloning of TransparencyReport until the repo is public again"

07d3736bfd-+-Synchronize mediacounts files to dumps.wikimedia.org

478568a669-+-Revert "Move beta elasticsearch config into hiera"

57586a4401-+-Move beta elasticsearch config into hiera

5206554ccd-+-cp1008 varnish storage size correction

5f1fb965a1-+-txstatsd: collect udp stats

64763b159e-+-Update cdh module and tweak FairScheduler settings to give more priority for essential jobs

241b87b5de-+-ci: Move jenkins access granting code into a role

98952606d4-+-mediawiki: make HHVM listen on localhost only

52b468dbd4-+-tools: Monitor toollabs home page

6775d229d9-+-Tools: Restart bigbrother when source changes

a1f378c862-+-Dbtree connects to the tendril database, so drop the ganglia job.

3d64a9cc62-+-Merge "Use cloud archive for non-icehouse Openstack on Trusty." into production

fbc91d3284-+-graphite: extend aggregation for statsite extended counters

09b1da10e9-+-Move jq package to module, all elasticsearch machines should have it

bceab054d4-+-phab role cleanup and puppetize phabtools.conf

cb7de17f65-+-kernel 3.19 for jessie caches

0ff8a60421-+-final jessie-cache VM tuning, for now

dea107e369-+-memcached: use distro version on modern distros

5f16b787cf-+-Add a daily incremental repair job

5dcb1469ca-+-Use cloud archive for non-icehouse Openstack on Trusty.

3377e78016-+-Merge "remove etherpad HTTPS monitoring" into production

43187e73a8-+-remove etherpad HTTPS monitoring

5d8fbca176-+-memcached: fix typo in mc2* definition

7a3f610838-+-memcached: add codfw monitoring group

578814322c-+-trebuchet: install git-fat on debian too

a5deedda3b-+-deployment: true vs 'true'

f12df0ee3b-+-cassandra: fix metrics-graphite.jar path

6615b6b7a5-+-cassandra: add cassandra::metrics class and deps

878bb37854-+-Merge "add zotero role class skeleton" into production

492ae7fe22-+-grants for misc db shards

ffdb8d57c9-+-prepare db1016 to take over as m1 master

edd6291bf3-+-Making alarms for NavigationTiming events less sensitive

fbed1ea65f-+-Configure hue to handle upstream https proxy

4fe91251fa-+-Remove non production ganglia aggregator analytics1010

11dd731f5b-+-Merge "Labs: Increase labnet1001 conntrack tables" into production

4dc88774bd-+-Merge "Tools: Only update ssh configuration when necessary" into production

1595d545ca-+-varnish+jessie filesystem stuff

803b7f585d-+-Execute scap-provided script as mediawiki::users::web

f97bba7c28-+-mediawiki: do not install php-apc on newer hosts

c67c72d0d4-+-admin: move to hiera, use roles/2

1717739d5a-+-admin: move to hiera, use roles where appropriate

93bb138cc1-+-Remove role::elasticsearch::config abstraction

331a9099df-+-Tools: Make crontab host configurable

438b4b6c34-+-Tools: Install byobu

a04e76b54b-+-Revert "phab update security extensions for access-request"

eebde3bd11-+-phab update security extensions for access-request

8c72f496e3-+-add zotero role class skeleton

0d3a26782b-+-Update ganglia aggregators for analytics cluster

03aa4544eb-+-mediawiki: install extension config files in the correct path

acb1fd9745-+-Merge "Reuse parsoid varnish for restbase" into production

d51198dc98-+-Restrict url_downloader's proxy to WMF

97d79984e8-+-Reuse parsoid varnish for restbase

694525dfae-+-Merge "Use network::constants to populate url_downloader ACLs" into production

c1f0e14d41-+-remove support for icinga-admin.wikimedia.org

cfd68f0375-+-report cassandra metrics with metrics-graphite

ed71d79a1f-+-set permissions on cassandra files

cdb29b2b1e-+-Set the cassandra localDc parameter

80b1336b5f-+-Merge "hhvm: raise the amount of cold TC cache available" into production

ddfa744834-+-Install spark on analytics client nodes

bcf1b3e352-+-contint: +libdistro-info-perl

ab447b0518-+-Remove critical => true from Cassandra alert

4a3a2015fc-+-hhvm: raise the amount of cold TC cache available

d7e64a2aa9-+-Use network::constants to populate url_downloader ACLs

af110706be-+-memcached: install one host in codfw for testing

4ddda82d95-+-Merge "sge: 4 digit file mode" into production

e2ada33cc9-+-Add a statsd_port parameter to the restbase class

daec23db32-+-Reduce backups retention period to 60 days

43f1db596a-+-puppetmaster: rename reimage.sh to wmf-reimage

cc2580ad01-+-sge: 4 digit file mode

1da49a9944-+-wikitech - add ferm rules for http/https

5a6726d044-+-phab update for deploy window

f8ed0ea196-+-cxserver: Add Yandex support

711b4b2c38-+-datasets: make sure rsyncd is running on them

86687715f5-+-enable ipv6 for ms1001

34452828ad-+-add extra_classpath argument

f464e8f8b9-+-update class defaults

c7d626e57f-+-fix additional_jvm_opts default

bf67814299-+-cassandra: deprecate cassandra::defaults class

fe9492b56c-+-memcached: systemd compatibility

48ce501d0b-+-service_unit: allow custom init script in a single initsystem

052bf83ab5-+-Merge "Use noc@ for apache2 ServerAdmin" into production

1e533ff84d-+-Use noc@ for apache2 ServerAdmin

fd19301ded-+-phabricator using mysql fulltext T89274, tweaked for mariadb/aria

a1c7af0201-+-Merge "Disable cloning of TransparencyReport until the repo is public again" into production

cd92bcdeab-+-Disable cloning of TransparencyReport until the repo is public again

b701dda11a-+-Merge "On debian, ensure that idmapd is running on labs instances." into production

ce72a3d043-+-Merge changes Icd6060b7,I8f8385af into production

5612837414-+-Set support_concurrency to false for hive

041c532498-+-logstash: Support MediaWiki logs via Syslog

ae2ca196bb-+-Merge "Add virt1012 to the nova-compute pool.  Remove virt1005." into production

8fa21c9cf9-+-maintenance: fixup for using www-data everywhere

0bb6518ecb-+-Merge "url_downloader: Vary squid config base on OS version" into production

0dadaf77e5-+-restbase: add internal LVS configuration

1d804ecc74-+-url_downloader: Vary squid config base on OS version

4e6392dba8-+-Merge "RESTBase: add Icinga check_procs check for Cassandra" into production

00c73d8f5b-+-RESTBase: add Icinga check_procs check for Cassandra

dceac74ef8-+-Add virt1012 to the nova-compute pool.  Remove virt1005.

b0489fa14b-+-contint: hhvm-dev on Trusty slaves

48ba63ecc7-+-Merge "toollabs: selector out of resource" into production

3577afbfe4-+-On debian, ensure that idmapd is running on labs instances.

0a340a7e8a-+-Use SNAPPY as default hive parquet compression, automatically load unversioned symlink of hcatalog jar

77e7d11c3a-+-Move url_downloader_ip configuration to hiera

e22104acd5-+-Make `es-tool ban-node` handle both IP addressses and hostnames

4b9ad4853f-+-Merge "annualreport: move apache site from template to file + minor lint" into production

a64692fb74-+-datasets: rsync from kiwix once an hour instead of every 15 minutes

b96a9a5abf-+-datasets: fix typo in html directory name

b3fdd1ed6e-+-annualreport: move apache site from template to file + minor lint

15306b9431-+-fix all 'variable not enclosed by {}'

23bce49bb4-+-Merge "wikimetrics: 4 digit file mode" into production

f4029e7b9b-+-Merge "localssl: fix optional parameter listed before required parameter" into production

e41f67312c-+-Merge "webserver: fix string containing only a variable" into production

f6e7fdd489-+-Merge "eventlogging: fix file mode" into production

461d1a63b7-+-Merge "interface: fix optional parameter listed before required parameter" into production

9682ed13a7-+-base: add the service_unit init wrapper

e6b9d10f82-+-Switch db1046 to a dedicated eventlogging role, soon to be a master.

eec2135307-+-protoproxy: mute nginx reload cron's output

a9b60a97cf-+-Tools: Only update ssh configuration when necessary

dd8059955c-+-eventlogging: fix file mode

1874f69641-+-interface: fix optional parameter listed before required parameter

e423fbb39e-+-webserver: fix string containing only a variable

acfcc2ac35-+-localssl: fix optional parameter listed before required parameter

7c47e06194-+-fix 5 string containing only a variable

68a20cf398-+-Use apt::repository instead of file resources

8fca1997d3-+-Merge "install gfortran and libs on stat1002/1003 nodes" into production

865f591101-+-install gfortran and libs on stat1002/1003 nodes

8fda34b778-+-Enable wikibase change dispatcher and pruning for test.wikidata

a95ad870c9-+-Update CDH module and set hadoop namenode heapsize to 4G

756f43a166-+-datasets: bw limit the kiwix rsync

34b2b399e5-+-datasets: pick up the newer kiwix wikipedia files

284fef3422-+-restbase: provision restbase/cassandra role

d6b586a46d-+-datasets: add and update legal notice

86471d011a-+-Merge "cxserver: Use different registry for Beta and Production" into production

a811c9649a-+-cxserver: Use different registry for Beta and Production

593c167156-+-Revert "varnish-fe hooks: place file everywhere"

860ec1890f-+-varnish-fe hooks: place file everywhere

51acb67edc-+-typo bugfix for 1299cf4f

1299cf4f89-+-varnish-fe hooks

08cdfb3268-+-datasets: fix the other directory name, sheesh.

45b32a0331-+-datasets: fix embarrassing typo in dir name

df43954344-+-datasets: add the dirs vars manifest, never got committed, woops

096afe810f-+-datasets: fix up html index files manifest

0bf3f330c6-+-dataset hosts: make the newly commited index html pages live

f8c5d9d539-+-add index.html pages for various directories on dataset hosts

42507c867c-+-mediawiki: add codfw monitoring groups

e2f44c8221-+-phab: direct_comments from wikimedia.org for 'domains'

76761d0505-+-phab: direct_comments_allowed for Domains tickets

bde6f0c4a7-+-vbench: add devwiki configuration

edf689b230-+-servermon: include Apache mod_headers

52ea28ad29-+-misc-web-lb changes to support servermon.wikimedia.org

ef0afbe4f5-+-Re-enable varnishkafka for bits again

3dc90dab09-+-Ensure temporary /etc/hosts cnames for hadoop names are absent now that dns change has propagated

024e058e33-+-logging: lint role

e6bd9d15bf-+-Labs: Increase labnet1001 conntrack tables

57e9edbb57-+-hadoop: minor lint

0728867ada-+-wikimetrics: 4 digit file mode

8387160060-+-toollabs: selector out of resource

72849b83fe-+-Merge "nova: lint selector" into production

baeea1dc5f-+-add chromium-admins to visual editor role

adc8d7c1b2-+-swift: minor lint

d1bd1d1ba7-+-nutcracker: revert to using a template for nutcracker config

a0331b2655-+-Include admin in role::ve

ec95f7e473-+-nova: lint selector

6952f8b8ae-+-Remove unused dictd package declarations in cxserver

482729c833-+-Merge "Make corp LDAP mirror alerts paging" into production

29d75a6f5a-+-assign dbproxy1003 to m3

ff285ff9d1-+-Poke mysql holes in virt1000 firewall for iron and monitoring.

f4b6862845-+-load mod_rewrite on static Bugzilla

4029ee3777-+-add index.html for static Bugzilla

d2a88c2bef-+-Merge "mv TransparencyReport docroot to /srv/org/wikimedia/" into production

119dd84e5b-+-mv TransparencyReport docroot to /srv/org/wikimedia/

5b3a5cb3b0-+-repool cp1070 for x-dc T88889

646b9f6385-+-Correcting docs and thresholds for eventlogging alarms

f8213b3b15-+-phab move logmail script to /usr/local/bin

8946fea23e-+-phab better header docs for manifests files

7105565346-+-phab update labs instance(s) search to mysql

294d32367c-+-Revert "Temporarily keep 40 instead of 31 days of webrequest data"

330f6c19ef-+-phab fail back to mysql search for now

f56208ae4b-+-phab local.json should trigger a phd restart

62624a0e68-+-phab link phd to /etc/init.d for service management

877f619592-+-clean up basic monitoring checks for all mariadb roles

db69bd6fce-+-incorrect private variable reference, mysql_repl_pass

1eb81524ac-+-Merge "randomize times the planet cron jobs run" into production

0c3802594e-+-randomize times the planet cron jobs run

7876c3a246-+-role::mariadb: Remove references to undefined $shard

3a6af2d01f-+-remove labsdb100[123] hacked role. use the mariadb config class.

bfb29ce3c0-+-repool cp1064 upload backend cache

694ca92b73-+-I guess we need these target dirs if we're going to backup to them.

48928e367c-+-downsize upload frontend mallocs to 1/12

92136d2e14-+-jessie vm tuning: back to more-conservative-ish

8835c2eaeb-+-Add a backup cron to the nova database class.

2067fbd9eb-+-fix PFS key rotation issues

dad6d71c66-+-Merge "Change these mw config files to mwdeploy:mwdeploy to avoid scap confusion" into production

bca2457b05-+-Merge "Revert "Temporary hack:  Turn off wikitech-static dump crons."" into production

a5c79cc6a1-+-Merge "Remove the nova::manager class from virt1000." into production

530468d5b4-+-Change these mw config files to mwdeploy:mwdeploy to avoid scap confusion

1b08881d2f-+-snapshots: move the admin include into the role

61bca3a6fb-+-Allow "hoo" to sudo into datasets

c1921f57b4-+-Revert "Temporary hack:  Turn off wikitech-static dump crons."

8b3b4f9a74-+-Remove the nova::manager class from virt1000.

b4e1ce8241-+-apparmor: minor lint fix

1212b10daa-+-Merge "Give wikitech (wherever it is) access to keystone and nova services." into production

0ba4d62d03-+-Give wikitech (wherever it is) access to keystone and nova services.

46d7dc9025-+-vbench: add 'vb' launcher

6b915014e7-+-Fix template name typo "paresercache" -> "parsercache"

b319e5ca2a-+-puppet-lint: ignore some var in single quoted strings

f04c95c31a-+-Update for Cassandra 2.1.2

2e0a4b94ba-+-dumps nginx: fixup ca cert name

44276c9136-+-redisdb: add ferm::service for redis-server

e36ce54505-+-reinstate bandwidth and conn caps for dumps.wm.org

a72490a03a-+-depool cp1064 upload backend

e280b02353-+-depool cp1070 in cache.pp: T88889

211ea1f5d2-+-reclaiming ms1004 to spares

9fed3ffa25-+-more-aggressive vm tuning for jessie-varnish

38c7ac408c-+-sysctl: brown-paper bag fix for service's Exec

0d9bf6f6d3-+-sysctl: make service call init system-agnostic

63b02ebe6d-+-re-disable compact_memory cron for jessie caches

5a89be89f0-+-add vm tuning params to jessie cache nodes

4a7f5ce62d-+-vbench: Instead of --proxy, use --host-rules to specify mapping of hosts

76ed803d98-+-xenon: links => follow for File['/srv/xenon']

5878b58782-+-Migrate role::performance to graphite1001

9684c0dece-+-Merge "ci/jenkins: add public key for VE sync to puppet" into production

6b3bc176f0-+-Merge "Clarify difference between nova::manager and nova::controller roles" into production

0c3101e200-+-Clarify difference between nova::manager and nova::controller roles

11993dca9b-+-ci/jenkins: add public key for VE sync to puppet

cf611ecf0b-+-Merge "Add some more php5 packages to Trusty wikitech." into production

13e6140b50-+-Add some more php5 packages to Trusty wikitech.

33ff706976-+-Merge "Include php5-memcached on Trusty openstack-manager hosts" into production

b10a2d01e9-+-Include php5-memcached on Trusty openstack-manager hosts

1791830515-+-re-enable cp1064 backend for testing

121bcd62c8-+-Tool Labs: nodejs-legacy is for Trusty only

c0bbc68573-+-tools: Install npm and nodesjs-legacy everywhere

5789850da2-+-Merge "base: move syslogs/remote-syslogs to manifests" into production

1843037070-+-remove deprecated legalpad.wm service

4e3dfc6e7d-+-Give deployers login on silver.

3e34f72e10-+-re-pool cp1063 backend T84809

54ca397819-+-graphite/txstatsd: fix require_packages vs package

0a071840ed-+-redisdb: add codfw monitoring group

9b8978a4dc-+-Labs: Make sure manage-nfs-volumes is running

d404a22258-+-monitoring: fix logo image location

3d74453ccd-+-Make gdash's uWSGI config.ru Ruby 1.9-compatible

15f37ce410-+-beta: allow defining the web user.

108da70d9f-+-maintenance: allow choosing the web user

f8d63c8c03-+-labstore: do not explicitly declare the apache user existence

a206e715e2-+-mediawiki: allow using a different web user than apache

8bd7bf8e18-+-toollabs: Add generic webgrid node type

07c19baf10-+-mediawiki: use lru pcre cache for all mediawiki hhvm installations

36bd155393-+-point dbproxy1001 at m1 db1001 db1016

bb4df6f71c-+-mariadb config for wikitech

f35265e756-+-Puppetize some symlinks that are on virt1000 and seem important.

ba6e627b47-+-Include the private wikitech password config on silver

e8b987eebc-+-disable cp1064 upload backend, tuning issues...

a0227b981b-+-logstash: move apifeatureusage output after default

fd19e6adaf-+-include standard on rbf codfw nodes

7382dad64c-+-use m1-master CNAME

030e21af32-+-Revert "temporarily depool cp1064 upload cache backend"

2347bf6701-+-temporarily depool cp1064 upload cache backend

0d826f5683-+-cp1063 backend disable for hw T84809

04648cb55b-+-Merge "ganglia: add more ferm rules for services" into production

67f4be651b-+-ganglia: add more ferm rules for services

675ecdeba7-+-base: move syslogs/remote-syslogs to manifests

50274a9092-+-base: move base::firewall to manifest

b7c514006a-+-re-enable compact_memory cron for jessie caches

6bc1924be3-+-Merge "setting dumps.w.o new intermediary cert" into production

a8b22fa4f4-+-setting dumps.w.o new intermediary cert

bc16d25afa-+-Revert bits cache sizes to 2G everywhere

9ffb0e354f-+-Actually provision the rapidssl_sha256_ca_G3

b56e6417e3-+-Provision the RapidSSL_SHA256_CA_-_G3 CA

2dd150d681-+-beta: Remove mediawiki appserver role

e3cd998f35-+-cache: Use new ip for deployment-mediawiki02

419055fbb3-+-graphite: move to graphite1001

9ce99aad5c-+-Make corp LDAP mirror alerts paging

e077f04aca-+-ganglia_new: move ferm::service from module to role

7e2bb8a8ba-+-cache: Use new ip for deployment-mediawiki01

d2939332d5-+-Generate grants SQL scripts in /etc/mysql

cf98803965-+-Merge "add ferm rules for ganglia_new::web" into production

4cd1372fde-+-add ferm rules for ganglia_new::web

9cafc49918-+-Revert "depool cp10[67]0 cache backends"

0d2df18f8b-+-Merge "replacing old gerrit sha1 cert with new globalsign sha256" into production

22ff493867-+-depool cp10[67]0 cache backends

97ac604128-+-kill jessie comment

99e38dd1e4-+-base: move screenconfig to manifest

d06a96c04a-+-base: move ::grub to grub.pp

2f001f5933-+-base: lint fixes

bddc9d8070-+-Revert "add network variables for dumps rsync clients"

1eaf5d2325-+-replacing old gerrit sha1 cert with new globalsign sha256

971b9d59ab-+-Merge "add network variables for dumps rsync clients" into production

7d47218ee0-+-Merge "fix another 28 puppet linter warnings" into production

95f1eae886-+-logstash: Configure Elasticsearch index.merge.scheduler.max_thread_count

3daa9f7a8a-+-fix another 28 puppet linter warnings

e023a27ec8-+-add IPv6 interface to dataset1001 (eth2)

2b9626b905-+-Revert "depool cp1065 from eqiad text backends"

1e359fdcad-+-depool cp1065 from eqiad text backends

3dd28f5cfd-+-switch cache nodes to perf cpufreq governor

104236d4d9-+-remove trailing space from cmd if !rss_pattern

927dc8850a-+-Merge "Add a db config to silver that resembles the one on virt1000" into production

4671f0b359-+-interface perf for jessie cache nodes

d944db8ce1-+-move bnx2x num_queues from lvs::balancer to interface::rps

60f9b26540-+-Add a db config to silver that resembles the one on virt1000

ae5643f84e-+-Temporary hack:  Turn off wikitech-static dump crons.

1ed8c3f303-+-Point varnishcsa multicast relay instances back at the socat relay on gadolinium.

0a45ed4a78-+-Revert "enable varnishncsa svcs at machine boot time"

cb43877541-+-Remove some unneeded dependencies.

a358886437-+-Split out the mysql config into a separate class.

f455a70782-+-add rbf2001/2002 to site.pp

022b56273f-+-setting citoid paging group to admins & parsoid

73651f2bc2-+-Include a database on silver, for wikitech mediawiki.

6c60e9a58f-+-add network variables for dumps rsync clients

d08cbb4a66-+-Merge "Modest changes in the wikitech config for Trusty" into production

044c3b5de9-+-Modest changes in the wikitech config for Trusty

316b4adf0d-+-Configure Logstash and Elasticsearch for ApiFeatureUsage

485be67a20-+-Revert "Revert "dumps: Strengthen ssl settings""

5080af461b-+-Merge "Add site.pp entry for silver." into production

69d65bfbfa-+-Merge "Remove ajax_proxy_url setting from nova config." into production

3c79fcf6a4-+-Add site.pp entry for silver.

2409aa1814-+-Install MaxMind DBs on Hadoop worker nodes

9b70fcc1d2-+-Remove ajax_proxy_url setting from nova config.

d439665d85-+-Revert "dumps: Strengthen ssl settings"

419fffbb31-+-dumps: Strengthen ssl settings

f514f84833-+-Actually run misc::maintenance::update_article_count

754f20e987-+-base::resolving: get rid of the global domain_search variable

761e34c3e4-+-Revert "add central systemctl daemon-reload exec"

0a8ef56dd5-+-add central systemctl daemon-reload exec

032c07b7c0-+-fix git::clone umask issues T87843

c103593736-+-Made the deployment-mx talk back to deployment wiki on receiving a bounce

93a4ebd3e1-+-graphite: explicit install python-twisted-core

6628263cc9-+-deployment: Unify salt_masters role for prod / labs

b1c6e9c243-+-puppetmaster: Send cherry-picked commit count stats to statsd

6a5c01cffa-+-vbench: don't disable sandbox or localstorage; clear cookies between runs

2b686dea15-+-ve: make profiles a little less noisy with additional CLI options

f780d1161f-+-Revert "toollabs: Add python3 support to uwsgi web services"

e38255caa4-+-toollabs: Add python3 support to uwsgi web services

2194054917-+-tools: Add webservice2 to tools-submit as well

beea864c2c-+-tools: Move webservice2 into puppet repo

089455a7a5-+-apertium: Remove jenkins_access class

4eefa4ff62-+-Also increase nginx archiva proxy send and connect timeout

52162dbb78-+-Set high proxy_read_timeout for archiva nginx proxy

2b4245a5c6-+-cp1047 -> out for hardware T88045

57929f3e59-+-ops-core is no longer an active project

2e4bb3eb01-+-Temporarily keep 40 instead of 31 days of webrequest data

c58797946f-+-decom cp1037,cp1038,cp1039,cp1040

f8f989dfd5-+-disable compact_memory on jessie T83809

fd58d75698-+-provision graphite[12]001

1ee11789d1-+-torrus: add http monitoring

faa7696f91-+-Add refined webrequests to refinery's webrequest status emails

07a0353fda-+-ircd fix dependencies for /etc/init/ircd.conf

63ff8e0d28-+-ircd: create upstart file and ensure running

2966646477-+-Remove final referneces to webstatscollector

205b788f98-+-Remove webstats puppet references

0a5b1b9998-+-Merge "chromium: specify additional command-line args" into production

2f74ddd7dd-+-chromium: specify additional command-line args

9de987079f-+-Remove dependency on webstatscollector service

b9805ea112-+-Decom webstatscollector step 1

52a7f2302d-+-Ensure monitoring::ganglia varnishkafka use is absent

89836a3673-+-SPDY for Jessie

f7c473539d-+-Raise and recalculate varnish frontend mallocs

f0310ff356-+-Get rid of superfluous diamond includes

c5c2bc469b-+-vbench: use numpy to compute stats; add warmup option

de43f36679-+-Merge "Use only cxserver/deploy in deployment" into production

8c48eeb000-+-Increasing warning threshold to 500

6faccb508d-+-Revert "Test if hiera is flailing on boolean falses"

b7397df988-+-Test if hiera is flailing on boolean falses

6c8fc3acd4-+-Use only cxserver/deploy in deployment

fdfe683b14-+-osmium: remove appserver role

302468cba6-+-Fix another variable reference

834f186b85-+-Merge "Remove server beryllium from site.pp" into production

6de307e1c7-+-Fix variable reference

39f64f49fc-+-Remove bad comma

4dd91a9a02-+-Remove server beryllium from site.pp

dfa345c290-+-Create geowiki module

2f5cde0ed7-+-Make standard class's exim including behavior configurable

2ab7f93c63-+-add basic Apache site and docroot for dev.wm.org

c6f22f444e-+-Add trailing / to incoming dir for pagecounts-raw copy

91e511276a-+-Copy pagecounts-raw dataset from stat1002 hdfs-archive (data generated by Hive) to dumps.wikimedia.org

32fd4dbe27-+-dysprosium -> jessie cache::text reinstall T83070

2080445cd1-+-cxserver: Remove unused dict packages

1aeaee731a-+-Fix typo introduced in 7bfad15

7bfad15490-+-Remove init script for default udp2log instance on fluorine

7038e2c971-+-logging: Move fatalmonitor into role::mediawiki::logging

3d9112a697-+-scap: Move rsync proxies into module

8b0bdf6421-+-scap: Fix typo

40b1c1f10a-+-scap: Move l10nupdate into module

500b5200c2-+-scap: Clean up absent'd lint related files / packages

74a7e82263-+-scap: Add missing role file

32de6cc1e7-+-scap: Move scap master code into own class

4759ef5db3-+-scap: Move 'common_scripts' into scripts class

c118f195a3-+-Switching wikimetrics to connect to labsdb1001

21d5cb5a04-+-decom amslvs1-4

c530202630-+-Remove duplicate 'admin' from osmium

314828dc43-+-Use role() to apply webserver role to osmium

0ad6a50ab1-+-Add role::mediawiki::appserver to osmium

0083191b2d-+-Pass --proxy-server=http://127.0.0.1 to Chromium on osmium

9c273e1b06-+-Let icinga client NTP check wait longer for success

d3f3fe7ba4-+-re-enable cp3016 backend

e9ea14dde8-+-re-enable cp3015 backend

54cfbc795e-+-disable cp3015 for reinstall as well

77781df664-+-ve: Add vbench tool

98d9c9b8c6-+-Remove osm-cp from site.pp

05c777ce13-+-put realm guard around including admin in role/cache

c5349f59a5-+-disable cp3016 for now

11a940b2ee-+-Alert analytics on obvious EventLogging validation issues

c1145b0bec-+-Use new db hostnames

d59e12374f-+-unbreak dbstore puppet

5790e36fed-+-switch dstore dumps to /srv

65ac80d31c-+-enable varnishncsa svcs at machine boot time

91086b8ab7-+-switch dbstore from /a to /srv

02ddcd6fa0-+-prep dbproxy1001

258d0442b7-+-Move webstats collector to protactinium

f14c16a4e4-+-Tell varnishncsa to use protactinium to be the new multicast udp2log relay

3743df5f7d-+-Set up protactinium as emergency gadolinium replacement

93f3e06ee2-+-remove search* machines references

c42e7f4768-+-Add logs from 'misc' caches to kafka pipeline

b47afff5ef-+-Mail webrequest partition status summaries to analytics ops

22adab88c5-+-hadoop: Disable gelf logging to logstasah

e0f5d5dca6-+-Remove exec that added hdfs user to analytics-admins group

6313c888d7-+-allowing direct to task email for onsite queues

ecce8ef40a-+-Disable all mail on phab-01 test instance

defa7d4518-+-enable amssq42 (jessie test) as text backend

bf009fe035-+-Manage the home of the chromium user

52926bdb7b-+-Add role::ve; apply on osmium

92327f6657-+-Import chromium module from mediawiki-vagrant

b43f0091fc-+-set up varnish instance defaults file even under systemd

5751e6a4b9-+-services: create sca role

802f594abf-+-logstash: remove support for most udp2log events

4d786a4132-+-virt: use role, hiera

d25e789282-+-Merge "Re-use Parsoid Varnishes for citoid too" into production

86d95562ef-+-Remove include of misc::statisics::cron_blog_pageviews from site.pp

96c5aa0473-+-Move cron_blog_pageviews to statistics module

c03193cf53-+-Move misc::statistics::limn::data* to statistics module

56cb05850e-+-Fixes for a few variable names now that they are in the statistics module

b802d86019-+-tools: Install rlwrap in dev_environ

8021996dc4-+-Remove now unused parts of misc/statistics.pp

a2e043692d-+-Fix document root for geowiki-private data in stats.wikimedia.org

503b534ace-+-require statistics::web in statistics::sites classes

3f36ef7d52-+-Merge "puppetize SSH private key for jenkins VE sync" into production

ebe2e3b5e6-+-Fix dependency, fix template variables

6fb0c552b5-+-puppetize SSH private key for jenkins VE sync

598d2e6dc3-+-Use proper path for statistics::sites templates

f71df46896-+-Re-use Parsoid Varnishes for citoid too

e3c8a0ac75-+-role::statistics::web now uses module classes

fe8e4b8d74-+-Use statistics::web class

4d32b53fa4-+-role::statistics::private now uses module includes

1e3dccdc78-+-role::statistics::cruncher now uses module classes (except for geowiki)

760cef9589-+-Fix dependency for class statistics::rsync::eventlogging

e20ddeb14d-+-Include more cruncher classes in new role classes

db8ac592be-+-Move custom researcher group researchdb password file definition into node definition

10c3721a6a-+-Comment out includes that are now covered by the new role

485a6978cf-+-Comment out uses of researchdb password classes

4c98f40a59-+-Comment out manual include of misc::statistics::packages::python in geowiki classes

726dbfd52a-+-Explicit provider for ganglia_new::monitor::service

057aecf982-+-Apply new statistics::compute class to stat1003

413ee9b5f5-+-Duplicate variable definition during migration to stat module

3522723466-+-Temporarily use local variables in misc statistics classes to satisfy existing class references

5991c01e91-+-Just make misc::statistics::base depend on ::statistics

7b8ce19e7a-+-Make misc::statistics::user and misc::statistics::base include module classes

f4b51bb87f-+-Merge "cleaning out holmium entries" into production

2106b5f37f-+-cleaning out holmium entries

79ff75d423-+-Globally qualify statistics module include

691c03a8cd-+-Fix typo in class name include

2d1fa5938f-+-First commit in a multi-commit effort to move misc/statistics.pp into modules/

c86c2ab162-+-snapshot: unify node declarations, use role, hiera

020892fdcb-+-mediawiki: Introduce feature flag to enable/disable lvs

06408a2169-+-mediawiki: Load prod/beta apache configurabion based on realm

1451dc55f2-+-Merge "let bastion hosts have base::firewall" into production

943bdc862a-+-Bump alert thresholds for EventLogging's overall events/s

fd52585a21-+-varnish systemd service stuff

24e3a619cf-+-contint: Don't include base firewall by default

62971fbe59-+-Update servermon settings

2cd2202ab9-+-Update servermon's service_name

2356ee6e31-+-update role::ganglia::config $data_sources

55e577727e-+-mediawiki: Explicitly open port 80 on mediawiki webservers

2f32217610-+-beta: Kill beta specific mediawiki logging role

816acdc16c-+-beta: Kill beta specific jobrunner class

51ee252aa7-+-beta: Kill videoscaler role

bb1c8e354a-+-mediawiki: Move jobrunner config into hiera

75d6dcbdc8-+-mediawiki: Fix incredibly annnoyyying stray space

457d58535e-+-redis: user role, hiera

633df0b2d1-+-memcached: use role, hiera

a93f85cf51-+-Tools: Install valgrind on bastions

6d17f31206-+-correct mysql ganglia aggregators for eqiad T87209

f11eee6a8f-+-deploy dbstore2001 dbstore2002

2681cdc8cc-+-lvs: use role, hiera

54deab47ff-+-beta: Clean up remnants of older apache-config setup

b2a7747960-+-beta: Kill fatal_monitor.rb script

193f8a33fc-+-restbase: use role, hiera

ab526aa820-+-logstash: Experimental logstash irc logging on production logstash

188dc37220-+-Followup commit to 0333eab

0333eab219-+-monitoring::service: mimic monitoring::host group handling

153985a55a-+-parsoid: use hiera, role

8b5e4cc5f9-+-parsoid: Include base::firewall on parsoid hosts

58f34e375b-+-upgrade db1054 to trusty and mariadb 10

c9e66a490f-+-deployment: Open up redis port on deployment masters

4f154e7c46-+-ocg: Don't include admin class in labs

26a4757d0b-+-mediawiki: Don't include ::admin in labs

fb72fb74f1-+-Add IP mapping for toolserver.org

bea8b80fb0-+-beta: Remove dup of /home/mwdeploy/.ssh

37fb792078-+-parsoid: Open port 8000 with ferm rule

87dcb09230-+-Temporarly override DNS  CNAME entries for hadoop  masters

31ce4069d8-+-Add subversion to Phabricator

fcc21344ad-+-disable amssq42 esams text cache backend

8f2a2c1473-+-Removing hadoop::standby role from analytics1004

2465d3aeb8-+-analytics1001 and analytics1002 are now the hadoop namenodes

4317cc5cff-+-Prep for migrating Hadoop namenodes to analytics1001 and analytics1002

dbfb1a400f-+-Followup commit for c914851

c914851d7f-+-Setup holmium as a backup::host

9328237962-+-Merge "*oid: Remove useless ferm declarations" into production

de961e8eeb-+-Merge "monitoring: allow host to check based on the fqdn of a host" into production

6fa3e5c215-+-*oid: Remove useless ferm declarations

f59dfc56ff-+-Add base::firewall to Service Cluster A

1e1c382ce4-+-monitoring: allow host to check based on the fqdn of a host

4a1c9aa05a-+-require at least one haproxy proxy, but allow multiple.

d33b0a3098-+-beta: Ensure that mw related users are present in scap targets

cc9cd9234e-+-mailman: move into a new, separate module

158364fcc6-+-Merge "ldap: cleanup unused role classes" into production

1f565b3c56-+-Merge "Remove decom'ed server "sanger" from site.pp" into production

3d6b5089e5-+-ldap: cleanup unused role classes

767b730457-+-Remove decom'ed server "sanger" from site.pp

da0188adb4-+-cxserver: Move comment to correct place

ae69eadad2-+-db1020 is primary

29626aa6b4-+-See if provider attribute fixes for systemd

b14c784788-+-Improve txstatsd-for-jessie patch 331bc33f

331bc33fb1-+-txstatsd s/upstart/systemd/ on jessie+

873851c788-+-annualreport: remove duplicate dir declaration

af14e9f8ad-+-Apache microsite for the WMF annual report

6313e9ef82-+-Followup to I2c7599bc2c032300c1bbaeed898b89614a16931f

d6fe35058e-+-beta: Fix mwdeploy's ssh key path to point to correct path

f469d95f3c-+-LVS configuration for Parsoid/CXServer HTTPS

a285ddecf0-+-Add HTTPS support to parsoid varnishes

646cd10e1f-+-certs: kill create_combined_cert

d0c113deb8-+-Kill webserver::static, now unused

a67f676859-+-mailman: add mod headers to Apache

639a83b8dd-+-mailman: fix $ssl_settings for Apache

b949e96e00-+-mailman: switch from lighttpd to apache2

502a117c9e-+-Remove dns::recursor::statistics

9675b0fe32-+-dumps: switch from lighttpd to nginx

94d8d1d7fd-+-Rename download::wikimedia to just "dumps"

b90f535ace-+-Remove download::mediawiki

7ba8501db8-+-Remove role::mirror classes

57b99f8c90-+-releases: fold ::backup into role class

9307b583fa-+-deployment: Open up port 80 on trebuchet deployment hosts

da3d3fb0c0-+-xenon: add ferm rule for redis too

708633aa5a-+-upgrade db1051 db1056 trusty mariadb 10

ba4849a79b-+-Merge "beta: deployment-bastion, add ferm rule for rsyncd" into production

186af69ba0-+-beta: deployment-bastion, add ferm rule for rsyncd

f85c0c2dfb-+-"Un-disable" xhprof

f714e5b48c-+-Only attempt to include ganglia diskstat monitor if ganglia is included

ccaa7561ac-+-udp2log: tighten up firewall rules

ea90f7747e-+-Merge "Don't use logrotate for the wikidata dump logs" into production

faceadeb3d-+-phab set owner and permissions on repo directory

60d553d1a1-+-Puppetize automated git push via http for stats user

a4069f0cba-+-Merge "ldap: Install ldapvi on terbium" into production

21846bf86b-+-mathoid: Unify mathoid production and beta roles

bf92b54cd5-+-Merge "citoid: Unify production and beta roles" into production

f4de4071d5-+-citoid: Unify production and beta roles

780c0fd8d3-+-Temporaily disable all bits varnishkafka production

285181034b-+-cxserver: Unify production and beta roles

e422d3fe99-+-apertium: Unify production and beta roles

5853c3a8da-+-ldap: Install ldapvi on terbium

4f7647a09a-+-phab update (and peripherals) for T78243

4b9e12408c-+-tools: Install python-socketio-client

b8ed2eb311-+-terbium: use hiera

898bdedbcf-+-puppet: use role for ocg services

1d714380a1-+-puppet: use role, hiera in rcstream

860c512791-+-puppet: use role for logstash

24e8914724-+-puppet: use hiera for elasticsearch nodes

12d6efbb42-+-videoscaler: use role keyword

9f8ae2ef3c-+-puppet: include admin in swift roles, not in site.pp

196f7b5046-+-puppet: use role for videoscalers as well

a63f23087b-+-swift: move role def before ganglia inclusion

b8f36042d9-+-swift: use roles and other linting

f520b33549-+-puppet: include admin in role classes for mediawiki and cache

2f00ab6452-+-puppet: use the role keyword for all varnishes

092566c195-+-puppet: fix ganglia lookup scoping

b5909127a8-+-mediawiki: move cluster definitions to hiera

7b174e0e27-+-Merge "puppet: move hiera lookups for the cluster to the actual classes" into production

63bb8c599d-+-logstash: Split beta role into two composable clearer ones

b863b2911b-+-puppet: move hiera lookups for the cluster to the actual classes

dc12f20bb8-+-Revert "puppet: move hiera lookups for the cluster to the actual classes"

5e63446b5f-+-puppet: move hiera lookups for the cluster to the actual classes

64f403fb70-+-Kill udpprofile::collector, unused

f49ed33517-+-Merge "Kill role::labsnfs, deprecated & empty" into production

7b10fd23e0-+-Kill role::labsnfs, deprecated & empty

cd32367543-+-Merge "Remove now unused iptables.pp" into production

4f18d79ffc-+-nutcracker: add UNIX domain socket server pool everywhere, but don't use it

1bddde7f60-+-Merge "udp2log: fix ferm error with udp2log_rsyncd" into production

efa48998f6-+-udp2log: fix ferm error with udp2log_rsyncd

98cade8837-+-Merge "ud2plog: open hole for monitoring, nrpe from icinga" into production

063123c591-+-ud2plog: open hole for monitoring, nrpe from icinga

2339562411-+-nutcracker: specify 0666 file mode for UNIX socket

0139f6c10e-+-Merge "udp2log: replace iptables with ferm" into production

574fb4aa37-+-Hardcode $hdfs_mount_point, revert previous change

8b0ad86da2-+-Atempt to properly resolve hdfs mount point from a variable

29017b69ed-+-Use globally qualified variable for $::cdh::hadoop::mount::mount_point in new aggregator class

aae12037a5-+-Remove $data_path dependency from aggregator cron

a1f48c5be7-+-Dependency fixes for new ::aggregator class

a8c0c13523-+-Fix for cron parameter in new ::agregator class

3c9db84ab0-+-Add jobs for aggregating hourly projectcount files to daily per wiki csvs

f68f9baef4-+-remove old unified cert ref from certs.pp T86689

b3e43ce422-+-Remove now unused iptables.pp

567b3a8331-+-udp2log: replace iptables with ferm

92606627f4-+-VCL: Get rid of hhvm.inc.vcl.erb

24ba8e0104-+-lsearchd: remove lucene role and class

cec8849740-+-poolcounter: ensure => installed

3cf4b18943-+-Labs: Remove /public/backups entirely

562e97b568-+-Labs: Unmount /public/backups

dbee268b8a-+-beta: Remove defunct graphite/icinga based monitoring

f5c1481cb6-+-beta: Kill role::syslog::centralserver::beta

f0baaa426f-+-lsearchd: remove udp2log configuration

5fbb5d63e7-+-lsearchd: remove all lvs references

d19d07e6df-+-lsearchd: remove lvs configuration

418d8204a1-+-mediawiki: activate net.ipv4.tcp_tw_reuse

5d1277a378-+-mediawiki: raise local_port_range for the api pool

7440fb357a-+-Move the codfw ldap server off of labcontrol2001.

ef19ad1d66-+-Merge "planet: puppetize feedparser.py bug workaround" into production

6d961a32d3-+-planet: load mod_headers

2cff1a4f61-+-Remove analytics1001 and 1002 from list of namenodes

238fa85129-+-Add analytics1001 and 1002 to list of namenode_hosts

839911deb5-+-Include hadoop::namenode::standby on analytics1001 and analytics1002

58a31496db-+-Remove unused udp2log awk scripts that forwarded to universities

72f55d6262-+-do not apply hw packages on virtuals

159fcd85f4-+-Merge "Move notices to -releng from -qa" into production

e6e960b69d-+-Install mcelog and intel-microcode everywhere

47fd5476ae-+-Don't declare /a/log/webrequest/archive directory

57c70db685-+-Sync Hive generated TSVs to stat1002

dfab2a45bd-+-Append the port to apertium url in cxserver

fb7cbafc36-+-Followup commit for 2e0ce6b

2e0ce6b021-+-Reuse parsoid varnish for cxserver

0629d5fe62-+-Move umask-wikidev.sh to role::deployment::common

690cd7ddea-+-Kill generic::upstart_job definition

2b337e3a4f-+-Split off module debconf out of the generic module

cb0907bb90-+-locales: add locales::all, Debian support, purge

844b1084ca-+-Split off module locales out of the generic module

920a5acce4-+-Merge "Revert "remove custom fact ec2id"" into production

b839aaeda8-+-Revert "remove custom fact ec2id"

38aea3a6fe-+-tools: Sort list of python dependencies

310dfe25ce-+-tools: Install python-unicodecsv

a721a30311-+-tools: Install some pywikibot dependencies

272b0f4ba4-+-Fix facter's virtual detection

198dcfac39-+-Remove the install_sudo script.

b7ab98e6dd-+-Move notices to -releng from -qa

d6aa199e6e-+-Merge "bugzilla: add Apache site for static BZ version" into production

b6d95b140c-+-bugzilla: add Apache site for static BZ version

be3fe3ed22-+-Temporarly disable esams bits varnishkafka

7bd5ee0272-+-Add job to crunch Language team data

ab9182aedc-+-Merge "LVS for cxserver" into production

b10023b9d5-+-Adjust the configuration file path for cxserver

643effa52d-+-Followup commit for a49baa9

bc5486383d-+-Remove custom fact ec2id, replaced by facter's ec2

a49baa9eb9-+-checkout cxserver/deploy as well

f6fd49ad48-+-Add a cxserver suffix to the package declaration

1d49058910-+-Revert "Labs: Make dynamic proxies use local resolver"

3cdeaca398-+-LVS for cxserver

d7fc542d9a-+-Apply cxserver role to sca

7446f1b36a-+-Use hiera for cxserver port

0c236b2ce5-+-Cleanup cxserver module/role

50eb888919-+-Revert "mediawiki: explicitly set the mpm module we're using"

309fda66d9-+-mediawiki: explicitly set the mpm module we're using

d55e0e5d83-+-contint: provision hhvm on CI slaves

2a414e502e-+-contint: hourly auto update of wikimedia packages

ab9667fa13-+-ocg: name apparmor.d profile properly

44eae89661-+-HAT: re-provision mw1152 as an experimental HAT imagescaler

240d6bc9e7-+-ocg: remove support for lucid & precise

9adc5e96a4-+-diamond: don't disable IPVS by default

c4ee59c907-+-Remove androidsdk module

8900e13490-+-coredb_mysql/mysql_wmf: remove MySQL-fb support

43846f8d5b-+-install-server: drop lucid support for DHCP

366f720635-+-cpufrequtils: move Ubuntu stupidity under if guard

7e39efbada-+-ipython: remove $::operatingsystem fail() check

cb035bfa25-+-monitoring: add icon for Debian hosts

9b46325246-+-upgrade db1016 to trusty and mariadb 10

63f793f325-+-cache: install the planet SSL cert on misc-web

6231246743-+-Merge "Duplicate -qa notifcations to -releng" into production

91ce7ed75b-+-Install jq on Hadoop worker nodes

0fec253a63-+-Set proper source file path for maven settings.xml

817c0648ed-+-Move maven init.pp into proper directory

89c94408f3-+-Install maven on analytics clients

04afbdf136-+-setting up no caching on gerrit behind misc-web

41eb5bc07a-+-Don't use logrotate for the wikidata dump logs

3e69160f8e-+-ssh: clarify comments surrounding ed25519 keys

20eb6e1103-+-ssh: add $::ipaddress6 to sshkey's aliases

7c27b2b8e8-+-switch min_free_kbytes to $::memorysize_mb

3e9ecab2cf-+-use $::memorysize_mb in cache.pp

ae2afa1d6f-+-cp1008 -> jessie installer

e645398ac9-+-ssh: purge unmanaged ssh_known_hosts keys

bf852092d1-+-ssh: do not export ssh-ed25519 keys

36a7b12d81-+-ssh: s/ssh-ecdsa/ecdsa-sha2-nistp256/, puppet error

cb30e056d2-+-ssh: remove ssh::hostkey definition

817258a292-+-ssh: use sshkey's host_aliases instead of three keys

9f079f80c0-+-ssh: export ECDSA & ed25519 hostkeys

42b9e34fac-+-Merge "Labs: Make dynamic proxies use local resolver" into production

3143a94ea9-+-Labs: Make dynamic proxies use local resolver

0f9416a088-+-network: Add shinken test server to $monitoring_hosts ferm rule

ae8255703d-+-Increase critical threshold for varnishkafka drerr

bab86c3093-+-apertium-eo-en instead of apertium-en-eo

11a2e13983-+-Fix up some /srv /a discrepencies on stat1001

1efa0be026-+-Followup commit for 51df8f0

78dd9b1dff-+-network: Add shinken-01 to monitoring_hosts for labs

43c3ae874f-+-labs: Remove explicitly set apt timeout

50121b6a9c-+-RSpec install-server fixes

fccf4e845e-+-mirrors: fix perms for ::debian's log directory

89303280cd-+-mirrors: brown paper bag fix for ::serve

35682800f9-+-mirrors: move to /srv/mirrors; new class ::serve

59664b578b-+-mirrors: don't purge archvsync logs

4b1e64aca8-+-apt: use our own Debian mirror instead of proxying

8500871271-+-mirrors: introduce mirrors::debian and use it

933db4f101-+-install-server::ubuntu-mirror -> mirrors::ubuntu

2971e7c0d3-+-base: update base::sysctl for trusty's new keys

189b20c142-+-nagios_common: add check_ssl's Package dependencies

88ec0a9117-+-Remove all references to solr

d44dbdc8ce-+-graphite: limit uwsgi workers memory

15d9737ee0-+-Have nutcracker listen on a UNIX domain socket on mw1230 and mw1231

a3ee6b8f79-+-api: restore ganglia aggregators

24c33d11af-+-mediawiki: create "canary" pools to allow testing on subclusters

aebbd2dbc5-+-sideline db1002 db1003 db1005 db1006 db1009

68ed21e277-+-deploy db1050 in s6

67619f33e1-+-assign a round of codfw slaves to shards

631ee36eed-+-decom zinc for reclaim

cb6f94c5e4-+-Duplicate -qa notifcations to -releng

14de168a8a-+-Include base puppetization on new nodes analytics1001 and analytics1002

c9c84499c8-+-Merge "Adjust the check_http command for apertium monitoring" into production

6ae9c95513-+-Fix for varnishkafka kafka_drerr graphite query for icinga check

51df8f0229-+-Adjust the check_http command for apertium monitoring

13cd9da689-+-redis: Get rid of unused (and unhelpful) module parameters

57e1d43546-+-Change name of varnishkafka drerr graphite_threshold check

c2d53a04a1-+-Use monitoring::graphite_threshold for varnishkafka delivery error check

0ef51a0689-+-Apply the role::apertium::production role to sca cluster

2e763c1630-+-hhvm: make cache files management explicit in puppet

b69881c4d9-+-Remove naggen (v1), unused nowadays

398feea968-+-deploy es2009 es2010 to es3 codfw

75281d2523-+-deploy es2005 es2007 es2 codfw

d6ce95bcb4-+-sideline db1004 db1007 db1010. move db1015 to s3

3d410cfa2c-+-Add freepats for Score usage

a3d98292ef-+-Revert "map ipv6 on dataset1001"

ce1370fbca-+-map ipv6 on dataset1001

b316f20460-+-Install virtualenv on stat* boxes now that they are in the Analytics VLAN

d7f8e060fd-+-Merge "contint: Add tmpfs mount in jenkins-deploy homedir for labs slaves" into production

4fc0aba7aa-+-Merge "contint: tmpfs is now root:root and world writable" into production

31b8ed7c65-+-planet: puppetize feedparser.py bug workaround

99e243f5c7-+-Merge "ganglia_new: fix indentation warnings" into production

4458025682-+-Merge "monitoring: fix a bunch of indentation warnings" into production

6d997e179d-+-motd: manage /etc/motd, support Debian

0276e4ed50-+-Use motd::script instead of File across the tree

b6f06c360d-+-base: include the motd class by default

74bf275a3d-+-motd: add motd::defaults class

a1c85afb51-+-motd: misc fixes

bbd2735a81-+-Remove update-notifier-common from labs instances.

246b412b44-+-phab remove security load-libraries entry

a87adae3e3-+-phab disable the security event listener temp

d7308a6c01-+-phab reset sprint app to 0.6.1.4

f4690662f0-+-phab src suffix for security library

a5fdfc6276-+-phab load-libraries is meant to be an array of strings

c02dbc1f99-+-phab change lockfile name on git::install

5291142fac-+-phab libext lock files per extension repo

5016339c5e-+-phab adding security extension

138d39c474-+-contint: Add tmpfs mount in jenkins-deploy homedir for labs slaves

9e6387590e-+-Follow pagecounts-all-sites move in HDFS

54932673a7-+-Serve hue requests to backend analytics1027 on port 8888

debc812a81-+-labslamp: Add php5-cli

f54adde25b-+-Set up hue.wikimedia.org backend on misc-web-lb

f2218287bf-+-Lower request topic_request_timeout_ms on all varnishkafkas to 2000 (2 seconds)

6051955d83-+-Update cached article count monthly to avoid social unrest

18d5049619-+-Remove analytics1003 rsync job

59908cc91e-+-Send ganglia-logtailer cron output to logfile

4e75b6ec87-+-mediawiki: use role keyword in node defs, get rid of duplicate regexes

7de1bd94e6-+-contint: tmpfs is now root:root and world writable

89d89698c9-+-ganglia_new: fix indentation warnings

04ac6737ae-+-monitoring: fix a bunch of indentation warnings

5fb33287b5-+-move db1061 to s6, db1062 to s7

0ec73b9075-+-Install the ldap-codfw cert on nembus.

d110314216-+-Make nembus an ldap server

1344583b40-+-contint: Apply contint::qunit_localhost to labs slaves

d3ee04451d-+-Don't include base::instance-upstarts on Debian.

52b75373ed-+-Don't specify provider => upstart

99068136f4-+-beta: Rename shinken config file to make more sense

7350b82438-+-reassign db1057 to s1

477b74c97d-+-deploy es2002 es2003 es2004

fa8ccdbea2-+-upgrade db1061 to trusty and mariadb 10

6503196011-+-upgrade db1065 to trusty and mariadb 10

c2410586c4-+-nagios: actually ship check_sslxNN

0a82b22b56-+-cache: use check_sslxNN instead of NN x check_ssl

0be6e47cff-+-ganglia: export $cname when ganglia_new is used

34b5d87ac7-+-ganglia: remove unused reference to neon

bf42ad9223-+-Install local txstatsd and logster job for varnishkafka on all cache servers

f64f07bb5b-+-Run logster job for varnishkafka every minute to get smooth derivative in grafana graphs

505d32b84f-+-txstatsd: set explicit permissions and ownership

edf9100110-+-Extract cache_type from $topic and use it in varnishkafka statsd prefixes

ffb852628f-+-Emergency fix for last change.  stdlib's delete did not do what I thought it did

64c7ea2ca7-+-Add cache type into statsd prefix for varnishkafka metrics

240690823a-+-Fix for new varnishkafka logster job

3dd74fc104-+-shinken: Move shinkengen into ops/puppet

7454468fa8-+-Use logster to parse varnishkafka logs and send to statsd

dce2650b87-+-Merge "Change postgresql dir to have version and cluster" into production

7ff5920055-+-Merge "Fixed spacing and alignment" into production

15dda97f0e-+-Delete unused classes and templates.

22ff755148-+-Fixed spacing and alignment

6cec69e162-+-Fix trailing spaces

7aef349a90-+-shinken: Provide ldap information for shinkengen

8367db7b84-+-backups: define next_pool for the production pool

f89e203b4c-+-backups: Support next pool directive

c1beb68ca4-+-backups: Create an offsite pool

1653edc56d-+-Add abacist module & role; provision on stat1001

eaa64ec6a0-+-Phabricator Sprint (0.6.1.4)

704b3acccd-+-phab add ldap user field to userpage

85e18a13ab-+-nagios: kill check_ssl_cert, now unused

df2c46e778-+-nagios: fix check for unified certificate

a3fce7f1ab-+-nagios: use check_ssl for checking localssl caches

ccd573b151-+-nagios: use check_ssl for checking lists/otrs/svn

4966287d1d-+-nagios: use check_ssl for the check_ssl_ldap check

f639fbda9d-+-nagios: kill currently unused check_cert check

f42fb3c481-+-mediawiki: remove one stanza from regex.yaml

dca17e434e-+-puppet: re-enter $cluster at the node level

6fbadc4f3a-+-hiera: make mw1017 use the role backend

a6247461fc-+-toollabs: Add support for running uwsgi web services

a1a4e6b780-+-add db2030 to m1 temporarily for T85150

156ff780ed-+-phabricator: strip Ubuntu 12.04 (precise) support

ae3933007f-+-tools: Add uwsgi machines to the appropriate queue

40da1a52de-+-tools: Add Mono fastcgi server package to exec_environ

fa67dece7c-+-Merge "Properly align indentation of =>" into production

11afaf4074-+-Merge "Quote file modes" into production

094a2d137c-+-Properly align indentation of =>

3215ba1618-+-Merge "Properly align indentation of =>" into production

d660744944-+-Merge "Beta: Add support for more language pairs" into production

3b6e56a68b-+-Beta: Add support for more language pairs

be1eed25ab-+-tools: Add initial set of uwsgi nodes

d27e14d8fd-+-Installation of the orientdb test cluster

6782c7d506-+-Removed a useless dependency

8ea2c1890d-+-Our custom build of bootstrap-vz is called python-bootstrap-vz

3d6c505338-+-Properly align indentation of =>

8e0787d1a3-+-Quote file modes

3a1134921b-+-Reorder package install for qemu a bit.

08b5610ca8-+-mediawiki::hhvm: re-enable xenon

bfe30f52f3-+-Merge "Remove qemu-kvm in favor of qemu-system." into production

bc8c768c61-+-Fix indentation in various files

1f50a7818a-+-toollabs: Add class and role for static file server

b8c9788c8d-+-Remove qemu-kvm in favor of qemu-system.

5db2a824bf-+-Turn off nova-compute on virt1012 -- we're keeping this one in reserve.

4df35f8c77-+-upgrade db1028 to trusty

bcb462302c-+-Set up alias rsync module for /a on stat1003

b21c73c0bc-+-Fix fqdn name for stat1003 for geowiki data sync

308a2473a7-+-Use stat box internel addresses (.eqiad.wmnet) for everything

ea132ae266-+-mediawiki: disable temporarily the hhvm hotprofiler

b782b94b2c-+-Temporary mountpoints for heze/helium bacula SDs

4b470cc8ad-+-sudo: (hopefully) fix dependency loop in Labs

2dee81a3b5-+-Switch public SSL terminators to new unified cert

010fc56509-+-sudo: actually make the linting safety checks work

a9ab021e4f-+-admin: remove ::sudo in favor of sudo::user/group

da5ff659ef-+-admin: rename "privs" to "privileges"

8a3de4c1fb-+-Replace admin::sudo calls with sudo::user/group

ee7895abe7-+-admin::sudo: remove comment support

c2efb4e707-+-admin::sudo: remove privs => [absent] support

41c4e058a1-+-sudo: port over linting & sudoers from admin::sudo

31ab22d830-+-sudo: reduce delta between ::group & ::user

4b77fe88fb-+-sudo: fold sudo::labs_project into the role class

4f27e9ab2c-+-Move /etc/sudoers from module "admin" to "sudo"

71ebcbefe5-+-sudo: move sudo-ldap Package from "ldap" to "sudo"

1c54a34542-+-Monitor bacula director/sd processes

d318b4e5d6-+-Distinguish bacula Storage devices based on hostname

4466ce3d75-+-misc::maintenance: fix a bunch of cronspam

aa1a3199bf-+-phab: update direct mail routes

13ffe95991-+-Get betalabs localsettings.js file from deploy repo (just like prod)

2c9ca63f4f-+-phab add rt mail routes to projects

7891dc8285-+-Merge "Fix aliases file URL" into production

cdb662f0e0-+-Fix aliases file URL

571fba73da-+-Merge "Create a special alias router for RT" into production

9d7857bf65-+-Create a special alias router for RT

6b406c3b4a-+-quarry: Remove sudo hack for quarry

5208588afe-+-rt redirect relevant queues to ops-private

aa9df4a01d-+-Merge "contint: +libmysqlclient-dev package on labs slaves" into production

a59c6e08d0-+-beta: Log !log messages from #wikimedia-qa

a11a71088c-+-contint: +libmysqlclient-dev package on labs slaves

10f2908e2c-+-apt: remove class apt::puppet

79b1005605-+-base: puppet cleanups

3b220fc443-+-tools: Add hhvm to exec_environ

91f7162769-+-install-server: add hasstatus => false to atftpd

5d5d238580-+-install-server: replace lighttpd with nginx

d3e1eeb27a-+-Merge "phab metrics: switch cron from daily to monthly" into production

fd3d0b8abd-+-phab metrics: switch cron from daily to monthly

79d4d81e9e-+-install-server::tftp-server cleanups

c8a3bd7aec-+-Merge "Remove the /srv mount point for /dev/sdb" into production

e353013c9f-+-Remove the /srv mount point for /dev/sdb

af263bda29-+-Merge "Fix lint warnings in authdns.pp" into production

6f6a7eb5e7-+-Merge "Add cxserver role for production" into production

99d716be1a-+-jobrunner: provision an additional jobrunner on trusty

d6c99e4e74-+-Customize the nova instance partition to support different server types

ab082069a5-+-Merge "Hm, not this one." into production

dd38c237bd-+-Hm, not this one.

0dd4cccbac-+-Merge "Oops, these are in base." into production

7339b213e8-+-upgrade db1064 to trusty and mariadb 10

73c7759889-+-Oops, these are in base.

e0ac6ecce8-+-Include nova-compute on new virt servers.

c0f2d12eaa-+-Fix alignment in parted command

f56f25e4d2-+-We're going to need these packages

149e583961-+-Create a big filesystem for virt storage on the hp virt servers.

b6b4511f8c-+-upgrade db1066 to trusty

36a98702d3-+-Fix lint warnings in authdns.pp

578796f5bd-+-Disable automatic Hue user creation in production

f598a7d30b-+-Support bootstrap-vz for building labs debian images

365b9e1b53-+-Beta: Drop log_dir for Apertium

108af7fdf2-+-Merge "Add apertium role for production" into production

20292a3d39-+-Add apertium role for production

6c53e4d84d-+-Add cxserver role for production

c9ef6a749a-+-Add README, RSpecs and tests for squid3 module

d1ee476f14-+-Bouncehandler: Use the API pool for API requests

19646ed820-+-phabricator: community metrics stats mail

8a15dd79b3-+-Merge "monitoring: move decom_host define into autoload" into production

a4630b35ca-+-Merge "Beta: Fixed comment" into production

e6708f934d-+-Merge "openstack-database-server: enclose variables" into production

ad7c56b5aa-+-Merge "Move the top level variables in phabricator role in a class" into production

a3e9446daf-+-deployment: make the keyholder key path configurable

17f95544ef-+-mediawiki: enhancements to hhvm_cleanup_cache

be9e3dd852-+-Beta: Fixed comment

b26c0f0ba7-+-Move the top level variables in phabricator role in a class

25e3711864-+-upgrade db1055 to trusty and mariadb 10

8d59473956-+-hhvm: fix include_path

ea5ba8e841-+-xenon: gzip svgs; add custom header/footer + stylesheet

40894efaa3-+-phab route issues by localpart to project

230b1829e6-+-Install python-netaddr on stat1002 and stat1003

c92a671bdd-+-Fix-ups for I09926c8c2

65eec0c87c-+-Typo fix ('xenon' -> 'xenon-log')

1fecdaddce-+-Apply role::xenon on fluorine

793c30b11d-+-Add 'xenon' module for aggregating ext_xenon-produced traces

7f9571aa14-+-rcstream: remove requires_os('ubuntu >= trusty')

b2820fc166-+-Merge "udp2log: rsync, add ferm service for rsyncd" into production

f811bd7684-+-Merge "Delete the install-server::caching-proxy class" into production

45229a3b3e-+-Merge "Remove module url_downloader" into production

1a7b293ff6-+-let bastion hosts have base::firewall

82bbd581ac-+-udp2log: rsync, add ferm service for rsyncd

d4fb51a14c-+-openstack-manager: re-add tmp removed mwdeploy user

7058c1bce3-+-graphite: remove $::lsbdistcodename branch

8a25988bc2-+-install-server: add relevant entries for einsteinium

5258b69cdd-+-apt: fix for failure case

3842d24786-+-hhvm: remove jemalloc profiling completely

2b81c6200d-+-hhvm: run the tidy cron once per day...

b31ab624ad-+-hhvm: fix tidy perf maps cronjob

8f1ddeb640-+-Remove module url_downloader

2228880574-+-Delete the install-server::caching-proxy class

233906e042-+-varnish: fix scope warnings in templates

0bf6dfc158-+-Don't ensure $hadoop_journal_directory directory in role class, this is already done in journalnode.pp in cdh module

c7db8993fb-+-Merge "kafkatee: webstats-collector, add ferm service" into production

81acaf202d-+-Merge "role/logging: add ferm service webstats-collector" into production

a13612b17f-+-openstack-database-server: enclose variables

ab298cab6a-+-Merge "openstack-manager: fix compiler warnings" into production

038fb8bc68-+-Merge "openstack: firewall, enclose variables in {}" into production

e0be191c5e-+-openstack-manager: fix compiler warnings

38f5436f19-+-openstack: firewall, enclose variables in {}

911264eb87-+-monitoring: do not warn for > 1 salt-minion procs

911b11baf6-+-role/logging: add ferm service webstats-collector

b2c256034a-+-kafkatee: webstats-collector, add ferm service

a505b6cdf2-+-Merge "zuul: move parameters around for lint" into production

a8db2ac9a2-+-Brown paper bag fix for 7909d4c

0750f77187-+-Merge "Run "apt-get update" outside of/before puppet" into production

33de3b212c-+-Merge "smokeping: fix minor compiler warnings" into production

7909d4c07c-+-Run "apt-get update" outside of/before puppet

94c93ebb71-+-Merge "grub: use augeas to modify the config" into production

2175c32dea-+-tor: remove redundant firewall rule

acdfb44d19-+-Move idiosyncratic gdbinit to /home/ori

272cfdd475-+-hhvm: set hhvm.xenon.period to 600

e3685a7e18-+-Set default logging level to 'warn'

c9dce8f705-+-zuul: move parameters around for lint

0e88a1a874-+-monitoring: move decom_host define into autoload

5902c312d6-+-test uni.wm.o cert on cp1008

b8a3325002-+-smokeping: fix minor compiler warnings

37c6807aa9-+-adding unified project cert from globalsign

eed062240a-+-mwprof: use graphite-in.eqiad.wmnet

f85ad4ff1d-+-grub: use augeas to modify the config

1b64d9c097-+-Add a new squid3 module and replace in-grown use

d96e810811-+-toollabs: DTRT with both trusty and >= trusty

fe46e1fb49-+-Merge "Rotate Wikidata json dump logs" into production

fb75fcacae-+-Need to add mahout.pp role!

0a5d0cdabb-+-Include mahout package on analytics client nodes

b158368174-+-Rotate Wikidata json dump logs

a15292c8bd-+-mediawiki: allow use of mpm_worker instead of mpm_prefork

f473e0bd7a-+-Remove apt::pin for squid packages

60d728d4a1-+-install-server: remove pre-precise/squid 2 compat

6c9622ebac-+-url_downloader: remove pre-precise/squid 2 compat

85414844f5-+-Merge changes Ibf090319,I2d7f45b5 into production

b6bcc53ce9-+-Merge "ganglia: remove Labs support" into production

c6b5c854ac-+-tools: Fix libboost-python-dev

8850cf8b60-+-Merge "mediawiki::monitoring::webserver: provision `apachetop`" into production

1a67ca4dde-+-Remove include of non existient community_analytics class

1b7f481aa1-+-Remove community-analytics site, it is not used

8ee5192a9a-+-Remove SSL configs for stats.wikmedia.org

e3f8f26fcb-+-tools: Remove pv from exec_environ, is provided by base now

1768e58e8c-+-add `pv` (pipe viewer) to base::standard-packages

20cdceff22-+-admins: use concat() instead of an inline template

33a281f814-+-Merge "stats.wm: load mod_headers in Apache for STS" into production

9181e21b21-+-stats.wm: load mod_headers in Apache for STS

79405c78c3-+-Merge "stats.wm.org: use ssl_ciphersuite" into production

832ca04b6e-+-ganglia_new::web: switch to apache-2.4 ssl ciphers

36ae689972-+-ganglia_new: remove Labs support

d12f5c7d6f-+-ganglia: remove Labs support

1b423f81fc-+-Kill ganglia::web, replaced by ganglia_new::web

136d5c483f-+-Add quickstack to all-distros standard-packages

9cb0b75b0b-+-Remove Ubuntu >= 12.04 conditionals for Labs

30ef957f04-+-Fix Labs ldap/ssh for Debian

ec0ab16c08-+-apache: add || debian >= jessie to os_version

0f547bfccb-+-webserver: add || debian >= jessie to os_version

f8b70a2d34-+-Remove more excess Service provider => upstarts

d96b48c407-+-wdq-mm: Add loadbalancer

791b9b9f40-+-Provision HHVM source tree in /usr/src instead of /usr/local/src

edad70a2cd-+-assign db1004 to s7

cccf48d9c2-+-upgrade db1015 to trusty and mariadb 10

b5edbfddcf-+-Reclaim ssl[13]00x

a4acf3ab70-+-contint: use Apache <IfVersion> instead of os_version

fef9056494-+-pybal: use Apache <IfVersion> instead of os_version

6c89693850-+-grub: check for the existence of /e/default/grub

880527efa2-+-grub: show the menu on the VGA console as well

2f74d53ed1-+-grub: strip quiet even if splash is not there

033fa96c29-+-Remove provider => upstart from Service[rsyslog]

be92ae94a1-+-rename graphite1001 to graphite1002

527dd9f5c2-+-apt: switch components based on $::lsbdistid

0b5ff31ee1-+-phab add Sprint extension (0.6.1.2)

ea817349a7-+-phab update tag for upgrade per T77082

2217df4ece-+-Add "standard" to ssl[13]xxx hosts

fa2d28e990-+-Merge "outreach/contacts: move out of misc into role" into production

669ec97ee8-+-outreach/contacts: move out of misc into role

f0f23c123a-+-stats.wm.org: use ssl_ciphersuite

cab8d42195-+-Replace "non-free" with "thirdparty" in apt/d-i

a4342b4a6e-+-dynamicproxy: required parameters before optional

9fddddec6e-+-Merge "mediawiki: remove ssh.override/nice -10 for SSH" into production

0df39a0e21-+-mediawiki: remove ssh.override/nice -10 for SSH

77c21e5681-+-labsproxy: switch to use ssl_ciphersuite

ce2687a3c8-+-Remove class base::packages::emacs

8bf18e6004-+-Kill base::platform with fire

3c2c05c99b-+-mediawiki: hhvm_cleanup_cache - housekeeping tool for hhvm cache

6a5428163c-+-Merge "icinga: move ssl_settings to role class" into production

96edc065af-+-icinga: move ssl_settings to role class

b783a76419-+-Merge "icinga: use ssl_ciphersuite" into production

5ff0079ff4-+-icinga: use ssl_ciphersuite

df2d2348d9-+-diamond: install python-statsd on >= precise

109c54f110-+-ganglia_new: fix broken dependency

9699299040-+-ganglia_new: switch to stock upstart script

d0d4b1af70-+-Log stderr of dumpwikidatajson to /var/log/wikidatadump

7983a6c93c-+-upgrade db1007 to trusty and mariadb 10

ec8bd58720-+-upgrade db1037 to trusty and mariadb 10

67f50c1fe6-+-mediawiki::monitoring::webserver: provision `apachetop`

9d1a1fdffc-+-upgrade db1039 to trusty and mariadb 10

1ee301af88-+-wdq-mm: Setup monit based monitoring to restart service

47525d60d1-+-wdq-mm: Initial module + labs role

3dd092769c-+-Initial commit of statsv

dd8465508b-+-Fix name of varnishkafka instance in require dependency

492b674c07-+-Rename all webrequest varnishkafka instances as 'webrequest'

b6f6c8ad9a-+-Add an 'apache' user to eqiad labstores.

3b4bbd9f57-+-Experiment with different request ack timeout for varnishkafka on a bits host

3a92040132-+-Revert "diamond: install python-statsd on >= precise"

2d3f3cbc38-+-diamond: install python-statsd on >= precise

bdce49d7e5-+-mysql: remove Ubuntu 11.10 conditional for /run

b372b67d6b-+-Kill a few more hardy references

d673b7c922-+-apt: make per-host proxy conditional on $lsbdistid

83562e378b-+-apt::puppet: ensure => absent

ea7b39bc8f-+-interface: drop support for Ubuntu < 10.04

7ea926ce0e-+-base: drop support for old Ubuntu version/Solaris

6894764b04-+-realm: remove $gid = '500'

8c02499c6c-+-Replace ubuntu_version callsites that were missed

8e57978687-+-replace usage of requires_ubuntu / ubuntu_version with requires_os / os_version

4c86070893-+-wmflib: add os_version() & requires_os()

7d1609284b-+-ganglia: drop the "gmond" Service alias

88e7864443-+-Merge "ganglia: remove legacy gmond compatibility stanzas" into production

c4909ae888-+-Merge "salt: remove provider => upstart from the Service" into production

9572eacfae-+-Merge "Don't install sudo on labs.  We use sudo-ldap instead." into production

eebffdfc31-+-upgrade db1010 to trusty and mariadb 10

1adc51a431-+-Don't install sudo on labs.  We use sudo-ldap instead.

6685f72dc8-+-Define package['python-statsd'] in ganglia_reporter.

d5aaf0736f-+-ganglia: remove legacy gmond compatibility stanzas

c3616accea-+-salt: remove provider => upstart from the Service

2f524c6d7d-+-ssh: remove provider => upstart from the Service

aa04b175ac-+-certs: add missing dep & make apparmor optional

7bd01d648b-+-nrpe: do not install nagios-plugins-extra

4468e649fa-+-sudo: ensure Package['sudo'] is installed

5bbe4ba003-+-Revert "monitoring: add config class"

dba222ac61-+-Send limn-public-data cron stderr to log file

fac2f349f6-+-Add libmaxminddb to m::statistics::packages::utilities

6fd89a720e-+-node definitions: cp3001, cp3002, berkelium, curium

15bb90b3a7-+-Revert of Iab860b8a5: Make puppet cronjob to run SecurePoll/cli/purgePrivateVoteData.php

deae97622d-+-HHVM: enable stat cache everywhere

15f922fd85-+-python-statsd: use require_package everywhere

cdba8d84ac-+-load tidy.so everywhere (but don't enable it)

91c53947b4-+-diamond: require python-statsd

78656d99c7-+-Allow puppetmaster to send reports to logstash

d31e44821c-+-shinken: Add fixed up init script

7030448907-+-On labs, raise the timeout for apt.

3399369c2a-+-upgrade db1049 to trusty and mariadb 10

6a7db05a06-+-Tools: Add perl library to toollabs exec_environ

590be6d0ff-+-base: Do include ssh::server on all hosts

7f193d036d-+-Tools: Add libraries to toollabs exec_environ

18eedfa96c-+-Merge "Minor lint in base manifests" into production

24586a239c-+-Fix Parsoid in beta

be706ba9fa-+-Minor lint in base manifests

bdb07fed69-+-Emit alert when Ori commits on a weekend

6dbd33d1ad-+-nagios_common: Rename check_http_generic appropriately

49280d2dc9-+-Fix typo in f09525d

f09525d447-+-Introducing server heze

8d822a8be8-+-Merge "Drop role::zuul::labs" into production

f9eb61a4d4-+-Merge "contint: mw multimedia packages on labs slaves" into production

fdd4d02b1e-+-upgrade db1059 to trusty and mariadb 10

a9006adc90-+-Drop role::zuul::labs

4a6d7a56d4-+-contint: mw multimedia packages on labs slaves

6836e6996c-+-Migrate to ganglia_new::web::view

3c3e438c65-+-upgrade db1027 to trusty and mariadb 10

5e0889aca4-+-upgrade db1060 to trusty and mariadb 10

0cfa62b764-+-eventlogging: Explicitly include monitoring class when we require it

c2b38313bc-+-Merge "eventlogging: couple less tightly to ganglia" into production

2c0ed644a6-+-Move include of role::cache::varnish::kafka::statsv into prodution realm conditional

c32294e75f-+-eventlogging: couple less tightly to ganglia

a073932a68-+-stats bits endpoint: don't require a trailing slash

00706a9cdd-+-Move Kafka MessagesIn anomaly alert to role::graphite::production

8058bb3d85-+-Add anomaly detection for # of messages sent to Kafka

fd60cd04a2-+-Add job to crunch the Edit team's EL data

009479dd07-+-Drop 'Phabricator' suffix from gerrit's ITS actions

c103a02dff-+-Remove hooks-bugzilla configuration

c38c6ccf38-+-Move gerrit's remaining ITS templates into gerrit module

0ea5997b90-+-Fix PURGE regex for betalabs upload servers

14cd5a86e1-+-Disable log age monitoring for udp2log-lucene now that most searches are in elasticsearch

2cd1b093b1-+-Allow host-specific HHVM config overrides via Hiera

0f3ce6e9f0-+-Remove alert for hhvm-appservers.svc.eqiad.wmnet

ad286071be-+-labs_vagrant: Check out precise-compat branch for precise hosts

abc6646d0a-+-logstash: Forward syslog events for apache2 + hhvm

0274819053-+-facilities: move to module

864a0c57eb-+-Use hiera to configure udp2log endpoint for ::mediawiki

9189f6cd04-+-Send kafka jmx stats via jmxtrans to statsd (not to graphite directly)

e6e120f3e8-+-Merge "logstash: Rules for processing MW input via Redis" into production

e5f25ac59c-+-Add statsd host in restbase config

7f19d285a6-+-Send kafka jmx stats to graphite using JMXtrans

3d0340d53b-+-Merge "Fix mathoid.svc LVS check" into production

9ad80d9b22-+-Disable webrequest partition checks in icinga

a6727f2f96-+-Use Cassandra's datacenter1 default

c9bca030f6-+-Fix mathoid.svc LVS check

a6fbcef6c9-+-HAT: remove the last references to the hhvm pool

ffc1d0ffdc-+-Disable kafaktee on analytics1003 (at least tempoarily)

7b9a765622-+-shinken: Unify shinken::hosts and shinken::services

a030b9d922-+-HAT: remove last references to the HHVM pools

3697221426-+-lvs: remove the HHVM specialized pools

31ec86cb7d-+-mediawiki: convert hhvm appservers to be part of the common pool

e671e6abe5-+-firewall: move "allow NTP" rule to role::ntp

e3a5e77182-+-Allow HTTP traffic WMF OIT space -> holmium (blog)

088ee15d89-+-Merge "apachesync - delete sync-apache script" into production

96180ee20e-+-Add cron job that generates flow statistics

5c396d224e-+-Include new class misc::statistics::packages::utilities on stat1002 and stat1003

4d90c82f29-+-Switch SSL loadbalancing to sh scheduler

e2b038d20e-+-Remove old protoproxy / ssl[13]00x config / star certs

601bb45824-+-ldap: neptunium is eqiad, virt1000 is no more

70e97e5976-+-ldap: fix LDAP's monitoring::service CN matching

6bea4e5984-+-hhvm: remove check_procs' WARNING state

b05f92824a-+-Merge "Unbreak misc::statistics on <= precise systems" into production

fa501acbb5-+-Unbreak misc::statistics on <= precise systems

40b0a6e61e-+-monitoring: refine alarms on HHVM

42b07f314d-+-extdist: Add composer location to config

da8ef33b3c-+-jobrunners: revert to rdb1001

d3a2b1e1b4-+-jobrunner: fix the jobrunners, not just the videoscalers

5e67acc9a9-+-jobrunner: failover the redis server in use

1f02de94e1-+-shinken: Setup IRC notification for shinken

59cae37041-+-hhvm: Don't load tidy.so

6d0d7328d2-+-HHVM: provision hhvm-tidy and load tidy.so

7cc72ccf87-+-tools: Add postgis package to exec_environ

260323d779-+-extdist: composer depends on php5-cli

60860a9016-+-extdist: clone composer into /srv/composer

f5ec8a315b-+-graphite/txstatsd: re-introduce require_package

1a5ebeeec1-+-Revert "ocg: Temp hack to bypass hiera for redis passwords"

8fe0944b3b-+-switch remaining m2 boxen to role::mariadb::misc

df6b33e329-+-Revert "ocg: Temp hack to fix empty redis password, take 2"

8da2bc7b3c-+-ocg: Temp hack to fix empty redis password, take 2

cf6ff6f9e3-+-ocg: Temp hack to bypass hiera for redis passwords

44c570f022-+-tools: Remove experimental mongo role/class

c62d87a300-+-Merge "ci/Travis: ensure .ssh dir is present" into production

381dd85c1a-+-ci/Travis: ensure .ssh dir is present

d8d0d2e693-+-shinken: Add checks for labs puppetmaster

92f72d3125-+-Merge "ci: travis user, typo 'nmptravis' vs. 'npmtravis'" into production

415cd47853-+-ci: travis user, typo 'nmptravis' vs. 'npmtravis'

145ec26a63-+-Merge "CI: install private ssh key for Travis integration" into production

08f352be83-+-CI: install private ssh key for Travis integration

ce9ef737d4-+-geoip: kill geoliteupdate in favor of geoipupdate

885a1bee3f-+-realm: remove pmtpa, add codfw

95e900eaf7-+-mediawiki: fix passing of the Authorization header in HAT

ef528399a4-+-Merge "mha: replace pmtpa with codfw" into production

c638049544-+-mha: replace pmtpa with codfw

beca8da50f-+-Merge "wikistats: add cron to enable wikia updates" into production

196bae8187-+-wikistats: add cron to enable wikia updates

89117686dc-+-logstash: Rules for processing MW input via Redis

f8488f01ce-+-apachesync - delete sync-apache script

259f20d6e9-+-delete class ldap::client::autofs

a3683b5739-+-Merge "delete class facilities::dc-cam-transcoder" into production

19438b9ad7-+-Merge "ganglia: remove pmtpa varnish stanza" into production

3fa175c2a4-+-Include and configure the restbase role on the test cluster

b8fddf49bf-+-icinga: Remove CPU alerts for contint from icinga

1e4a5a63e9-+-Fix incorrect beta MX hostname

9a9e40b7ee-+-shinken: Cleanup to be better compatible with autoload layout

0be03efa8d-+-puppetmaster: Add script to track upstream changes

3433c68c21-+-deployment: make scap proxies configured in one place

c911209787-+-contint: Move monitoring into shinken rather than icinga

14027a9dd0-+-Merge "toollabs: lint" into production

76ba81a0a4-+-toollabs: lint

f0d0a028b7-+-mediawiki: adjust hhvm max threads to number of cpus as well

6015e1aec5-+-ocg: simplify module hierarchy

9f4c4840e0-+-icinga: Remove checks for betalabs and toollabs

8e1eac312a-+-vm: lint

f54f46510a-+-wikitech: lint

d039a0003a-+-Give parsoid-admins access to ruthenium

448c61ca2b-+-Switch Cassandra test hosts to the new role class

880e1aeb9b-+-Switch LVS to use localssl at all sites

957b8d83c5-+-Turn on r::c::ssl::sni locally for varnishes

4e0d43ebd3-+-r::c::ssl::misc: switch to r::c::localssl like prod SNI

1d70884add-+-Merge "bits varnish: serve 204s for /statsv" into production

75f1da2f75-+-bits varnish: serve 204s for /statsv

39451e4cbe-+-Merge "Removed ldap server role from virt1000." into production

c9bb03d0c1-+-Add 'apache-status' shell script

15e20463ee-+-phab run user updates once daily

20b0edaacc-+-Revert "r::c::localssl: monitor based on $certname"

8ce369c16b-+-Merge "Switch keystone over to use the new ldap server name, ldap-eqiad" into production

250f45794d-+-r::c::localssl: monitor based on $certname

359a68e71b-+-txstatsd: gather runtime self metrics under statsd

903a8f9cb1-+-hhvm::debug: provision perf-tools

c67c4aee1f-+-misc::statistics::packages: add libyaml-cpp0.3-dev

4c5dfaa8f7-+-bugzilla: disable cron jobs

14c052fa43-+-bugzilla: switch svc_name to old-bugzilla

ed2c057fd3-+-phab bz user metadata update crons

1131b36fc5-+-switch MariaDB ::misc (only used by m2; still ::coredb on m1) to /srv

8d59b2bc5d-+-* Correction for maniphest vs manifest in variable name * add a catch all redirect for bugzilla.wikimedia.org/

4dbcff0a22-+-phab handle cherry-pick for T1343

5ecfe25035-+-Set up redirects for bugzilla urls to redirect to phabricator.

f25d9b7d2a-+-Replace memcached_ip with ip in one last place

0510711b0d-+-Removed ldap server role from virt1000.

7b807e9b7b-+-Switch keystone over to use the new ldap server name, ldap-eqiad

c5ce49e064-+-Force Class['::keyholder'] to apply before Keyholder::Private_key because WTF labs

652e9c8675-+-Enable submodule checkout for restbase

4ad1482da4-+-ensure ::keyholder is applied before ::keyholder::monitoring

7d40e2d69f-+-tools: Add python3-dev to dev_environ

d6182892c5-+-Fix two bugs in cassandra module defaults

bd5b347924-+-Switch r::c::ssl::sni to new certs

af94c12480-+-use GlobalSign CA for all sni.* cert names

b125a82e44-+-syslog: deprecate /home/wikipedia/syslog

f6f6c9beee-+-HAT: create mediawiki::hhvm::housekeeping

fe3b4665ae-+-mediawiki: include admin on the new appservers

c150e79f8d-+-HAT: start the jemalloc disabler _after_ apache is started and configured

74b4a76bb2-+-Move the openstack_version setting to hiera.

a35d3ea2d1-+-Merge "Allow sshd to pull ssh keys from ldap on Trusty." into production

dc27cf1572-+-mediawiki::packages: require ::apt

08a7504ae8-+-torrus: Remove stray characters in file causing failures

b54aef1a9a-+-Increase heapsize for hive-server2 and hive-metastore

6ab5f13448-+-extdist: Support distributing skins

7b5f8a180b-+-Switch back to using the wikistatus package.

f90ba13add-+-mediawiki: add node-level definitions for new appservers

9eec504f8e-+-Merge "Modularize torrus" into production

d4dffa157d-+-Fix for varnish::kafka::statsv include

7978f101b3-+-Modularize torrus

b27fb0d40f-+-add varnish::kafka::statsv

5d35de45a7-+-ircyall: Introduce module for web2irc relay

dd10032676-+-puppetmaster: Make time to keep old reports for configurable

1a193dfcee-+-Fix for ensure_jemalloc_prof_deactivated check

361684ad5e-+-HHVM: enable perf_pid_map for FCGI only; not CLI.

41baefc9fe-+-hhvm: enable perf_pid.map files w/automatic pruning

f36ea9f3bf-+-Add libgoogle-glog-dev on stat1002 and stat1003 for Ironholds

97ea73de41-+-Link aggregator dataset into wikimetrics public webspace

fbb6dbd3bb-+-Allow sshd to pull ssh keys from ldap on Trusty.

54609ab7b1-+-Merge "Update labs compute nodes to icehouse" into production

d38802dde2-+-Merge "Upgrade labnet1001 to icehouse" into production

cf7d55145e-+-Make BounceHandler extension work on test2wiki

a907674967-+-Update labs compute nodes to icehouse

8ccfb89447-+-Upgrade labnet1001 to icehouse

8fa8488ef6-+-Turn off keystone/redis for the icehouse upgrade.

20ea048576-+-Replaced some broken single-quotes

35424a5cec-+-Update virt1000 (labs controller node) to icehouse

e6342cad69-+-Consolidate entries for virt1001-1009.

e77a438058-+-ganglia: remove pmtpa varnish stanza

cbd20d4add-+-puppet: various lookup fixes in site.pp/hiera

5c5cda10f4-+-Add libboost-regex-dev, libboost-system-dev and libyaml-cpp0.3 to stat1002 and 1003 for Ironholds

96c7538c12-+-monitoring: fix duplicate hostgroup def

72477358e4-+-icinga: add monitor_group definition

6a79118623-+-monitoring: add config class

cbd6e30803-+-gdash: install rubygems only <trusty

bde09eb52b-+-add graphite role to graphite1001

0e52d26e52-+-Lay the ground for the openstack icehouse migration.

097c976b22-+-Merge "Add cassandra role" into production

5ddd2435cd-+-Switch m2-master to db1046

b2a9a8279b-+-Merge "Revert "set up redirects for bugzilla urls to redirect to phabricator."" into production

de7bb8b947-+-Revert "set up redirects for bugzilla urls to redirect to phabricator."

ff7c11245f-+-Add cassandra role

c90c139018-+-Merge "Add 'phaste' tool for pastebinning text to Phabricator" into production

c25efc6178-+-Add 'phaste' tool for pastebinning text to Phabricator

f906a7c17b-+-Add a simple restbase role

79894c864e-+-Merge "set up redirects for bugzilla urls to redirect to phabricator." into production

d5ee2a77dc-+-Merge "ganglia/gerrit: move install_cert out of site.pp" into production

4a97fd3f31-+-Update varnishkafka module to f3b76bd

604570fac6-+-set up redirects for bugzilla urls to redirect to phabricator.

464568b144-+-s/config-head/config/ bugfix for 69f3b4ec

c6ed63ffef-+-ganglia/gerrit: move install_cert out of site.pp

69f3b4ec4c-+-Switch gdnsd config-geo mechanism to $include

e40cfe9424-+-Fix-up for Iac35f2329

cdd19aed01-+-varnishkafka: update submodule; convert to multi-instance

fc8700f6ef-+-icinga: give a non-null default group to monitoring::service

3c9adc3c4d-+-Merge "Fix-up for I8fbef8279" into production

7a17f3e1a3-+-Fix-up for I8fbef8279

560731512a-+-fix: monitor_service is now monitoring::service

a657c45016-+-add monitoring for search.wm (Apple dict bridge)

9276f4487c-+-Merge "lvs (labs) config: remove pmtpa" into production

ae18f5a254-+-Merge "remove gluster from ganglia config" into production

919d68a2ae-+-remove gluster from ganglia config

1562ef20fb-+-delete class facilities::dc-cam-transcoder

c083853ebf-+-Merge "logstash beta: remove pmtpa, do TODO" into production

67a0c1ccf8-+-Merge "fix misc jenkins warnings in multiple modules" into production

65f6274c85-+-memcached: tidy

0a986672b8-+-hadoop: gelf: libjson: support precise + trusty

1abf923406-+-Update EventLogging listener IP for labs

b49f9877f4-+-Merge "openstack: folsom -> havana as default version" into production

e16a831b85-+-memcached: Make ganglia inclusion optional

e331067e17-+-nagios: convert monitor_service to monitoring::service

5a0c2d10b8-+-Deduplicate etherpad's monitor_service checks

8b77a11730-+-keyholder: add icinga check

92753115f7-+-allow multiple sudo::user grants for same user

0c901c8ebe-+-mediawiki: simplify apache config

ecd3dbeb2a-+-base: Allow overriding core dump path via hiera

942215ea5d-+-fix misc jenkins warnings in multiple modules

5ac350d957-+-logstash beta: remove pmtpa, do TODO

d4abd64556-+-openstack: folsom -> havana as default version

58f0475d9b-+-lvs (labs) config: remove pmtpa

c79573857b-+-pmacct - remove commented pmtpa core router

a6eeaac1c1-+-Remove all references to pmtpa from role::cache

4cc81931e6-+-Merge "ssh server: make PermitRootLogin configurable" into production

47dcefb74d-+-mediawiki: move beta::mwdeploy_sudo to mediawiki::users

6098429c3b-+-Merge changes Icb4cbadb,Iefbe62a2 into production

cec593088f-+-tools: Remove unused MountCollector ensure => absent

6931e8c5d6-+-Merge "Removed some obsolete roles." into production

5318aa889d-+-keyholder: add /etc/keyholder.d and `keyholder arm` subcommand

b1a2655eab-+-Merge "protoproxy - update usage examples to current" into production

1ade6d7a80-+-protoproxy - update usage examples to current

791f79765f-+-Update zookeeper version to reflect upgraded version after Trusty upgrade

6e39978d9a-+-Re-do several lost fixes in restbase module

84ff6cda99-+-Removed some obsolete roles.

ed38bde900-+-Link EventLogging logs into /var/log/eventlogging

d764655f1d-+-ssh server: make PermitRootLogin configurable

3dfd4a4cce-+-ssh server: make ListenAddress configurable

c7e89533f7-+-role::cache: make ganglia inclusion optional

ca3655e6dd-+-varnish: make varnish::instance not depend on ganglia

7225f41827-+-puppet: get rid of the nagios_group global variable

f54ac9befc-+-remove nickel from ganglia server aliases

cb353ed4c2-+-remove nickel from puppet

a5a4abd9c7-+-keyholder: fix `keyholder` script

44923c76f1-+-Turn EventLogging's logrotate config into template

f578379bde-+-Merge "Provision mwdeploy's private key on tin" into production

6ab95c1d97-+-Move Eventlogging logs underneath /srv, which has more free space

1f53b563aa-+-Merge "Revert "Add cron job that generates flow statistics"" into production

85f04f2ee9-+-Revert "Add cron job that generates flow statistics"

247dcd3f20-+-Merge "Add cron job that generates flow statistics" into production

60f7ab1ec5-+-ssh server: make listening port configurable

3cbb1eba8a-+-Initial RESTBase puppet module

8918dd8653-+-monitoring: move monitor_host to monitoring::host

ea82d796c3-+-Merge "elasticsearch: disable noisy check_elasticsearch" into production

2cd997ea97-+-phab update tag

c2ada02474-+-Merge "icinga: Move ircecho code into module" into production

ec43e43905-+-icinga: Move ircecho code into module

cd52429f0e-+-nagios_common: Parameterize path used for ircecho

6e142bd238-+-mysql_wmf - autoload layout and lint fixes

c3ef91a292-+-Remove sync-l10nupdate(-1)?

c9348c5cba-+-Provision mwdeploy's private key on tin

1592d72817-+-phab remove bad save value

fcf4360297-+-phab email pipe cleanup and allow maint

cdeca23a63-+-Merge "shinken: Don't say 'icinga' in shinken notification emails" into production

69e893722c-+-shinken: Don't say 'icinga' in shinken notification emails

002601ee68-+-swift: expand txstats complete configuration

802c7568a6-+-Groundwork work for keyholder-based MediaWiki deployments

90748f4a5a-+-keyholder: require_package('python3')

8a7a29eec4-+-keyholder: provision /run/keyholder

4c6556f660-+-role::deployment: apply keyholder class

b5bed42469-+-role::deployment: retab

16ba981ca1-+-remove nickel from network.pp

63eb4bf1ea-+-add `keyholder` module for managing a shared ssh-agent

a2f8906939-+-shinken: Add basic service checks for all of labs

738c421148-+-role::ganglia::web fix invocation of rrdcached class

4a9ad17e4e-+-Merge "Allow specifying journal_dir for rrdcached" into production

eed057682e-+-Extract EventLoggings log directory into a variable

8b77ea78da-+-Allow specifying journal_dir for rrdcached

a5d63984dd-+-swift: report statsd data to localhost

92cc764ea9-+-Fixes for role::ganglia::web

d7ae62db95-+-Don't include misc::monitoring::views on uranium

905424cc2e-+-Merge "Assign role::ganglia::web to uranium" into production

f69d5fd7c4-+-Merge "Introduce role::ganglia classes" into production

99a2a10022-+-Change postgresql dir to have version and cluster

5997a87661-+-base: standardize the path and file name of core dumps

69dbfdaa9c-+-osm: avoid cronspam from osmosis

dde36db10f-+-Assign role::ganglia::web to uranium

63ffdf404f-+-Introduce role::ganglia classes

ed4d75eb46-+-Kill ceph module

3d7229796b-+-Merge "No longer ensure => absent package python-memcache" into production

86786f7922-+-Initial commit of Cassandra puppet module

d2be05c391-+-Merge "Move ganglia memcache.py to gmond_memcached.py" into production

7c4143d2d8-+-txstatsd/graphite: switch back to package

eb3e3dbd81-+-graphite: Kill labs archiver

bc818bef58-+-swift: report statsd data to localhost

72f9ec6fa7-+-jheapdump: gdb-based heap dump for JVM

3f01c786c6-+-elasticsearch: disable noisy check_elasticsearch

ddc60d423f-+-Fix planet sync cron command

8d8b1b19c0-+-monitoring: remove monitoring::group from nagios.pp

3bda2cc380-+-Merge "beta: Remove redundant shinken declaration" into production

6f54226ad4-+-beta: Remove redundant shinken declaration

01532e6aac-+-Merge "geoip: add support for GeoLite2" into production

93c6e3d2c9-+-geoip: add support for GeoLite2

64ed19e24d-+-Merge "hhvm::debug: add apache2-utils" into production

640abe765f-+-geoip: remove product 121 (GeoIPISP) from config

61fce57905-+-geoip: switch data::maxmind to geoipupdate

8b43046480-+-hhvm::debug: add apache2-utils

123a59de84-+-map ip6 on uranium

3eb97b08f0-+-shinken: Fix typo in previous commit fixing typo

d284339d54-+-Merge "map ipv6 on magnesium" into production

cb65b0d4cc-+-Fix-up for I4f3534ea2

d3b69d9ca9-+-hhvm: ensure that jemalloc heap profiling is disabled.

ba80ee43c7-+-bugzilla - silence collectstats cron jobs

f1c2bab9c1-+-fix require_package documentation and txstatsd/graphite usage

234d5ce45f-+-work around puppet function arity issues

7f560661a7-+-txstats/graphite: fix package conflict, use require_package

4e54ac2ed6-+-nagios: fix virtual resource collection

45b8a90700-+-monitoring: convert monitor_group to monitoring::group

db6bc720de-+-apache: very minor lint

a4dc612764-+-Merge "Revert "Disable l10nupdate for the duration of CLDR 26 plural migration"" into production

d8c3e63ec1-+-txstatsd: add graphite-carbon dependency

6b744131c2-+-jenkins: use openjdk-7-jre-headless

4ab224b409-+-map ipv6 on magnesium

556e2cfe99-+-No longer ensure => absent package python-memcache

a0f286b006-+-Move ganglia memcache.py to gmond_memcached.py

4c4318dffc-+-dataset: lint fixes

e3748124c1-+-phab ensure prod cron gets removed in labs

1c2b3be4b5-+-Merge "Minor changes for labs testing" into production

43bb05b469-+-authdns: lint fixes

c0f1028d95-+-site.pp: lint fixes

120b1e7f13-+-eventlogging: fix lint errors

8e6b17eed9-+-Merge "openstreetmap: Split expired tile list files" into production

30f48975bd-+-Merge "Add restbase deploy target" into production

9fb0eeb8f0-+-Add restbase deploy target

fe3b167977-+-Make varnishkafka pick up Range header

36849de02a-+-Add cron job that generates flow statistics

481cee48c2-+-Create eventlogging-roots group, add qchris

50e78e6114-+-apache::monitoring: provision 'links' package

323926d0c8-+-Merge "Manually revert "Grant access to Magnus Edenhill on analytics1003"" into production

dd05cabec1-+-Manually revert "Grant access to Magnus Edenhill on analytics1003"

9e19a590a2-+-Move OCG logging off of root partition; logrotate hourly.

d29229d73c-+-Don't need to manage rsync_from and output directories

54222282e7-+-Separate rsync from generate cron job

8a8783ce79-+-Remove management of source_dir ownership

a61c89b122-+-Fix source_dir variable reference

bb7c9fd7be-+-Couple of more fixes for misc::statistics::limn::data::generate refactor

acbf6053b7-+-Fix typo variable name in statistics.pp

0766e1465a-+-Slightly refactor  misc::statistics::limn::mobile_data_sync

64e20d54b3-+-Use mysql::config::client to render a research pw file readable by the stats user.

66b6020455-+-hhvm: remove unnecessary upstart stanza, config option

936ab7be16-+-Revert "Disable l10nupdate for the duration of CLDR 26 plural migration"

8d24f622d6-+-Allow syslog to actually write to the ocg logdir

33247fbadd-+-beta monitoring (labmon): fix graphite class name

a28c5b75d0-+-beta: linting and autoload modules

fb83039378-+-Install libvips, libvips-dev and libvips-tools on Trusty.

98bad53ccf-+-Remove eventlogging logs older than 90 days

d5d48e402a-+-Merge "mysql: lint fixes" into production

1b99cedc6d-+-toollabs: install p7zip-full on exec nodes

9c487a8d03-+-Use mysql::config::client to render research db user and password

a2bec84119-+-Include research mysql user and password in file on stat1002

cb88a2a1b2-+-Add defines for working with mysql config files, and mysql client settings

b575b69692-+-tools: Add python-gdal package

04067a743f-+-contint: Fix graphite monitoring to use monitoring::*

92788c7060-+-openstreetmap: Split expired tile list files

89b45f0800-+-Merge "Make wtp a ganglia aggregator" into production

bc7a22b3cc-+-Merge "servermon: Execute make_updates every hour" into production

6727e3ac38-+-tools: Don't try to install libvips on trusty hosts yet

fe06baf4d4-+-tools: Use ensure => latest for all packages in dev_environ

80a50843fa-+-tools: Specify newer package name for libboost-python-dev

dd5670fea8-+-dbproxy1002 haproxy monitoring

f39fab8797-+-Make wtp a ganglia aggregator

c0677a90ac-+-contint: Fix allow/deny rules for Apache 2.4

30411aa191-+-gitblit - move certificate installation into role

5e4728a63e-+-svn - move certificate installation into role

e52c75aeab-+-contint: switch Zuul conf to new repository

d700cdb67a-+-contint: Move /srv/localhost/qunit resource out of qunit_localhost class

a164896e3c-+-Merge "cxserver: lint fixes" into production

8f46518885-+-Merge "admin: puppet lint fixes" into production

f1c7bc004c-+-cxserver: lint fixes

ca0795da4c-+-Merge "elasticsearch: lint fixes" into production

e37eb4c9af-+-Merge "openstack: lint fixes" into production

5ae80af6f1-+-elasticsearch: lint fixes

9b2cb3204f-+-apache: lint fixes

533dd08700-+-openstack: lint fixes

9259931302-+-Merge "puppetmaster - lint fixes" into production

b9f25c2106-+-mysql: lint fixes

7558897668-+-puppetmaster - lint fixes

cbf7e14dd3-+-hhvm: add hhvm_health Ganglia module and hhvmadm script

1c95ba6168-+-contint: Clean up order of statements

576bf1d3d0-+-extdist: lint fixes

c6d7e24d1b-+-ceph: lint fixes

aff9d64fad-+-Change phab_update_tag script to remove library lock file

09764677a4-+-Merge "Consolidate debugging-related configurations in hhvm::debug" into production

174bf08ca5-+-phab should get standard

ea4bdd314b-+-phab only manage repo directory if set

4663426679-+-servermon: Execute make_updates every hour

d48646f459-+-Merge "contint: ruby2.0 on Trusty slaves" into production

669f348646-+-Consolidate debugging-related configurations in hhvm::debug

3f3ca01372-+-Switch misc SSL to new sni.wm.o cert

c610b3168c-+-Set correct CA for sni.wm.o cert

b4c7dd24e3-+-Merge "apparmor: lint fixes" into production

19471c02af-+-Merge "swift_new: lint fixes" into production

8ebd9459c1-+-Merge "releases: lint fixes" into production

4b4665dc6a-+-switch r::c::ssl::sni (cp1008 only) to new wm.o cert

8cf3e596fa-+-icinga - lint fixes

a9341b340a-+-shinken: Fix typo

20aac946aa-+-Merge "contint: linting fixes and autoload module" into production

4bc05893e0-+-contint: linting fixes and autoload module

0758dcd0f9-+-Merge "ferm: lint fixes" into production

544b8ae353-+-Merge "dynamicproxy: lint fixes" into production

3725a46b51-+-Merge "archiva: lint fixes" into production

5ace39fc1d-+-Merge "bugzilla: linting fixes" into production

4691ec6924-+-Merge "blog - remove puppet and apache config" into production

8d173f551b-+-blog - remove puppet and apache config

4d88b7d318-+-Minor changes for labs testing

d5975dcb44-+-Include the vendor repo in mediawiki checkouts.

b6ff76376e-+-monitoring: move stuff out of nagios.pp, part 4

4d736a8fcc-+-monitoring: move stuff out of nagios.pp, part 3

205a9109ab-+-monitoring: move stuff out of nagios.pp, part 2

39a0fb24ec-+-monitoring: move stuff out of nagios.pp, part 1

9099b204ef-+-Merge "labs: specify a admin user for postgres" into production

1002a926df-+-Merge "osm: Fix rsync monitoring" into production

44c8108f96-+-puppetmaster: install ruby-httpclient in labs

21d55a79f6-+-puppetmaster: use the correct hiera config

30bc5dbd79-+-labs: specify a admin user for postgres

09834a296b-+-osm: Fix rsync monitoring

0327a085d9-+-HHVM: fix monitoring.

5514644e67-+-Disable Icinga warnings from dbstore1001 delayed slave.

786d32cfbf-+-Fix incorrect role parameter.

b7df2dd52a-+-prepare dbproxy1002 for trials

339087f125-+-ferm: lint fixes

1963de748c-+-dynamicproxy: lint fixes

87d57e99c8-+-bugzilla: linting fixes

ea7d473929-+-swift_new: lint fixes

ec3cc52533-+-archiva: lint fixes

756978deea-+-apparmor: lint fixes

13e06d924d-+-releases: lint fixes

1f74b640e5-+-admin: puppet lint fixes

c546a9bb7b-+-Merge "puppetception: lint fixes" into production

c0b8750912-+-puppetception: lint fixes

cacb80f4ac-+-Merge "shinken - move hosts define to own file" into production

e4e055c063-+-Merge "hhvm: make source installation update whenever package is updated" into production

570a3be468-+-hhvm: make source installation update whenever package is updated

5a5e3a1a6b-+-Added labswiki to the dump skip list to avoid error spam

14cb58c146-+-Make sure refinery is included before hive role so that auxpath is properly set

29e1364de7-+-Include refinery-hive in hive's auxpath if it is deployed on the current node

92b3d03567-+-Fix comment about row of analytics1012

2d18658be3-+-Merge "De-lint modules/ocg/manifests/decommission.pp." into production

0780167c78-+-Install kafkatee on stat1002

dd91ba767f-+-De-lint modules/ocg/manifests/decommission.pp.

68c80630d3-+-ganglia DNS views: Remove the colon character

d997bf20e4-+-Merge "phab: move defines into autoload layout" into production

d450290cd9-+-Merge "Beta: Restart CXServer on change in config.erb" into production

5a5b614cc1-+-Merge "For ganglia views, use description as name only if it is set" into production

a90d70a21e-+-osmium: remove specific classes.

d25ea589d3-+-Beta: Restart CXServer on change in config.erb

4008767720-+-phab: move defines into autoload layout

0f8d556eec-+-shinken - move hosts define to own file

e017bdcb9f-+-logstash: hadoop: reenable gelf output

bf25b1d78b-+-Merge "contint: Graphviz on Jenkins slaves" into production

b9967effc7-+-hhvm: remove 'hhvm-watch-mem' script

e4035e4dbc-+-For ganglia views, use description as name only if it is set

32e9e6df4d-+-contint: Graphviz on Jenkins slaves

9d5f66de0e-+-Introduce postgres role for labsdb1004, labsdb1005

36aa5da239-+-servermon: run make_update 6 times a day

165f718c13-+-Merge "Install libmysqlclient-dev on Trusty but not on Precise." into production

26d88f896d-+-Install libmysqlclient-dev on Trusty but not on Precise.

8f80bf6d0c-+-Merge "Replace libmariadbclient-dev with libmysqlclient-dev." into production

85c00dfef6-+-Replace libmariadbclient-dev with libmysqlclient-dev.

749880a8d5-+-Create analytics-roots group, add qchris

7086127910-+-Disable test kafkatee webstatscollector instance to troubleshoot missing lines

6492faebf4-+-Fix typo with backup::set

a0785a8977-+-mediawiki: do not restart hhvm for now

6f1c78a897-+-Add descriptions to DNS ganglia views

6240ec714b-+-Merge "Add a description parameter to ganglia::view" into production

e49ffac198-+-Fix for stat1002 host in rsync job for aggregate datasets

91e6efe2e0-+-Add a description parameter to ganglia::view

06b153bab9-+-Enable ganglia diskstat plugin on ganglia::web

8a8b346961-+-Merge "ganglia web: avoid using tmpfs on trusty" into production

320d40b96c-+-mediawiki: do not page ops with hhvm processes errors.

560ec09fe8-+-ganglia web: avoid using tmpfs on trusty

a38742ee86-+-Modularize backups.pp

11eb982bde-+-Revert "mail: remove secondary MX role from sodium"

a94c939f81-+-mail: remove secondary MX role from sodium

e853c77cf6-+-Periodically restart HHVM

8ce8d11a42-+-Merge "firewall: remove, unused" into production

832ae53761-+-Remove old elasticsearch masters

88bad969a9-+-osm: Fix matching the rsync process via nrpe

1b839d5d82-+-osm: Fix typo introduced in 2d96ee8

9e84081616-+-Backup user home dirs

2d96ee88b5-+-osm export the expired tile list

05afd267e2-+-Add three more master node to elasticsearch

37228258e8-+-Require 2 ACKs from kafka brokers per default

3b40019b0c-+-Remove PMTPA from icinga::nsca::firewall

b23e1ba88b-+-Merge "webserver - replace firewall rules with ferm" into production

876790bd8e-+-logstash: hadoop: disable output temporarily

5d22c2981f-+-Increase HHVM server thread count

2885425f2c-+-Merge "RT - add mail aliases" into production

16e3a5f7b9-+-RT - add mail aliases

a14a2e38ea-+-Revert "Add ::apt to stage => first"

134de68a53-+-Add ::apt to stage => first

633c1339e1-+-Fix-up for I777ae49ca

1acf1ec192-+-hhvm: make HHVM's working directory be /var/tmp/hhvm

5f00507194-+-add check for https://phabricator.wikimedia.org

c3532049e0-+-Merge "phab: add monitoring class, monitor TaskMaster" into production

65f15ced49-+-phab: add monitoring class, monitor TaskMaster

528ff8abf7-+-Parameterize adminscripts class

8da04a57aa-+-webserver - replace firewall rules with ferm

71d29cafa4-+-firewall: remove, unused

b66a5e85e7-+-Merge "firewall: nitpicks" into production

6b0b876eb4-+-hhvm::packages: add graphviz and gv, for pprof --pdf/--svg &c.

c2691bb769-+-Merge "backups: minor lint" into production

3280e56f7c-+-geoip: fetch all MaxMind products that we pay for

741a6ebfdd-+-Add centralauth parameters to wikimetrics role

917c5a24f5-+-Include elasticsearch role on all elastic* nodes

2b7053a996-+-Add rack information for new elasticsearch nodes

a08ee683d3-+-Merge "Made the beta clusters use deployment-mx for outgoing mail delivery" into production

e9767d3401-+-Include elasticsearch role on new elastic1020

650de77e64-+-hadoop: avoid ganglia diskstat duplicate delaration

aa8cf35a00-+-firewall: nitpicks

1a6fc3de60-+-backups: minor lint

b6c7378ad4-+-Increase updatequerypages frequency to twice per month for all wikis.

fa587a6ca0-+-Merge "wikistats - add update cron for wikivoyage" into production

c316b888ec-+-wikistats - add update cron for wikivoyage

ee2f533345-+-phabricator: don't hardcode mail smarthost

c659fba584-+-phabricator: s/noreply/no-reply/

f69894372a-+-mail: kill role::mail::oldmx, not used anymore

2eed7ab754-+-Revert "contacts - fix template path for module"

418cb049e9-+-Revert "contacts/outreach - move to module"

2a72557415-+-apache: reload when config changes (bugfix)

ab8b9c25ca-+-phab allow pygmentizing

d4f7ca59ee-+-contacts - fix template path for module

2621db576f-+-phab update phd daemons 4->10

34d534d9f6-+-Merge "rancid - adjust file pathes to module structure" into production

f634ef8702-+-phab update phd configuration

bf1d498fc8-+-rancid - adjust file pathes to module structure

47a9bc82dc-+-rancid - move to module

e453ec06ea-+-contacts/outreach - move to module

53a47cca2d-+-role/deployment - remove pmtpa

10dea165dd-+-ipmi - fix path to file in module

0b0a553f9e-+-management/ipmi - move to module

f097ecaeec-+-Merge "NTP, lucene - remove pmtpa remnants" into production

5f6a4bcbed-+-Made the beta clusters use deployment-mx for outgoing mail delivery

321f007487-+-re-enable amssq42 text varnish backend

75f3ed73ce-+-Merge "Tampa cleanup - delete dynamicproxy::pmtpa role" into production

5c0de158e6-+-salt check: crit if over 4 processes

87cde73056-+-Specifiy mountpoint for bast1001's netapp::home mount

63ada93fd8-+-ganglia_new: remove manutius, add uranium

fdfc7a8efb-+-Move uranium/nickel in the correct network stanza

b2bb410a49-+-Install base system on new elasticsearch nodes

802ce6d63c-+-Fix require_package conversion typo

83c1b2a445-+-nfs::netapp::home backwards compatibility

8c303574eb-+-Merge "Disable l10nupdate for the duration of CLDR 26 plural migration" into production

bfb0e2ce79-+-kafka - remove/replace pmtpa

6f9c16f802-+-icinga: fix typo

d691d9b568-+-webserver: move to a module, fix and remove a few things

0d6bd22047-+-NTP, lucene - remove pmtpa remnants

39ee3d6d25-+-Tampa cleanup - delete dynamicproxy::pmtpa role

4d4a430755-+-Tampa cleanup - remove pmtpa monitoring groups

8087b7fb55-+-Phabricator: repository.default-local-path to proper location

a0c8d067f3-+-Merge "hhvm::monitoring: typo fix for ganglia module" into production

150afea4bc-+-hhvm::monitoring: typo fix for ganglia module

0de49e4cf1-+-default gmetad host -> uranium for monitor_ganglia

fd27815a69-+-Merge "Open up more zookeeper ports in ferm" into production

da41d80aa3-+-move 'noc' from misc to module

b6bc09a3d7-+-misc::statistics: use require_package('nodejs'), as we do elsewhere

09e84e6536-+-contint: Add Xvfb module, role::ci::slave::localbrowser and Chromium

50b5b87e6a-+-reclaiming server francium to spares

d293711386-+-Merge "role::labs::instance: include sudo::labs_project" into production

38ee6f0e2d-+-Minor changes in bastionhost ferm rules

2dbcc9c115-+-Add a ferm service for ssh on all bastionhosts

f5f32b0b67-+-Merge "make hooft a real 'bastionhost'" into production

7805043c38-+-Set state file path for osm ganglia plugin

4b5dbb9758-+-make hooft a real 'bastionhost'

bdde5682a3-+-Sync up gmetad clusters

17a4480a16-+-ganglia_aggregators for sca, openldap_corp_mirror

b4c23b9b2b-+-Various ganglia::web fixes

5b02e75232-+-Disable l10nupdate for the duration of CLDR 26 plural migration

fc009c367f-+-role::labs::instance: include sudo::labs_project

280ec6746c-+-sudo: create module, remove old files

224d73a967-+-HHVM: report memory stats to Ganglia

13c503a06d-+-Tool Labs: Tweaks to gridengine puppetization

fe05e9b1d7-+-Tool Labs: rm obsolete gridengine::resource param

3cd6e8aa55-+-Merge "Tool Labs: final fixes to gridengine III" into production

776dc19372-+-Add virt1006 back to the compute pool.

ccf408f482-+-Move keystone-service to keystone::service

c531d993bb-+-Rename some files so the puppet loader can find them

1ab6050937-+-Tool Labs: final fixes to gridengine III

baf54adcfc-+-File nova services in a 'nova' subdir and namespace.

273f79b7d9-+-Merge "Beta: Remove pmtpa reference from comments" into production

d5db6077f0-+-Tool Labs: remove unnecessary dependencies

c5e5e38ba0-+-Tool Labs: More bugfixes to gridengine class

ce0bbfd151-+-Beta: Remove pmtpa reference from comments

d3019cf735-+-Merge "Tool Labs: really final(??) gridengine fix" into production

e3fad855a6-+-Merge "Moved glance-service into glance subdir, renamed glance::service" into production

035fd2cbb4-+-Merge "Moved neutron- classes into a neutron subdir and renamed." into production

e08dff05cf-+-Tool Labs: really final(??) gridengine fix

474952fa72-+-Merge "Tool Labs: final(?) fixes to gridengine III" into production

f41306c524-+-Moved glance-service into glance subdir, renamed glance::service

a9b787cd19-+-Moved neutron- classes into a neutron subdir and renamed.

5ff470fc8c-+-Tool Labs: final(?) fixes to gridengine III

2c34d897bc-+-Enable GELF for MRAppManager part 2

18d6f3c1f2-+-Merge "Make ganglia::web trusty aware and puppetized" into production

fd3bd8c475-+-Merge "s/backup::host/role::backup::host as per a recent change." into production

c95c2c2848-+-Merge "ganglia plugin for openstreetmap sync delay" into production

86e1cdbcc9-+-s/backup::host/role::backup::host as per a recent change.

68ed076fa0-+-Remove pmtpa from deployment role

908468fafe-+-ganglia plugin for openstreetmap sync delay

ac934ff04c-+-Merge "Move openstack files and manifests into a module" into production

b9646312c3-+-Tool Labs: allow exec hosts to be submit hosts

fc620ac925-+-Move openstack files and manifests into a module

25fd575822-+-Tool Labs: more minor fixes to gridengine

922f1bd802-+-Tool Labs: fixes for gridengine puppetization III

682fe7c60d-+-Merge "Tool Labs: Gridengine puppetization, III" into production

a507eb8738-+-Tool Labs: Gridengine puppetization, III

69f0ed600d-+-Merge "Added the beta hostname to local_domains to make exim use mw_verp_api" into production

a27dc88e80-+-Make ganglia::web trusty aware and puppetized

832ef48163-+-Require 2 ACKs from kafka brokers for bits caches

5ef7232b99-+-Remove all kraken references

7b0cc38331-+-Introduce uranium as ganglia server

5e7e0cd39f-+-Tool Labs: remove stray dependency

b946a749cd-+-Tool Labs: trivial fix to the gridengine manifest

79f4fa38a4-+-Gridengine: trivial fix of an incorrect dependency

a1fd5cbd23-+-Merge "Gridengine: proper puppetization, part deux" into production

b4afac8d0b-+-Gridengine: proper puppetization, part deux

93f5d665db-+-tor - motd script needs shebang line

4d42acdd1e-+-motd - update-motd.d file must be executable

e124f5406c-+-tor - fix syntax error in motd script

57d7fa35f9-+-tor - add custom motd message about arm

c55f00f1ec-+-tor - not using /srv, it's /var/lib

b23689f0ea-+-Merge "logstash: Remove upstart jobs" into production

8426eb1385-+-Depool amssq42 backend for trusty testing

85b63b9350-+-logstash: Remove upstart jobs

597c315e07-+-Open up more zookeeper ports in ferm

9f1b90f62f-+-logstash: Add support for redis password

8621eeec02-+-Added the beta hostname to local_domains to make exim use mw_verp_api

ba50579ce4-+-Gridengine: remove redundant inclusion of parent

3d03a79171-+-Tool Labs: web nodes are not infrastructure

a7cadb190c-+-Merge "Tool Labs: major cleanup of classes and roles" into production

f20ab63e7f-+-Fix-up for I8f16b61f2

586dff3e7f-+-Merge "hhvm: add a 'creates' clause for source code installation" into production

199f2af7d0-+-hhvm: add a 'creates' clause for source code installation

e5aa40cdef-+-Merge "shinken: Autogenerate config from shinkengen" into production

30049adf0c-+-shinken: Autogenerate config from shinkengen

dfaa5e518c-+-remove Tampa networks from network.pp

725e72a780-+-Merge "nfs.pp - remove pmtpa, add codfw" into production

18fc2f5b1e-+-nfs.pp - remove pmtpa, add codfw

54bb4003bd-+-Made the deployment mx talk back to mediawiki-verp labs host

ed51bf06ec-+-hhvm: Make source file installation refreshonly

affc7ec9fd-+-HHVM: install source to /usr/local/src/hhvm

0031aa374b-+-Declare datanode's mount directories only once

5d0f82dcd2-+-Declare namenode directory only once

11517a202b-+-Add nickel to $MONITORING_HOSTS network, rename ferm::rule icinga-all to monitoring-all

cd2515a3e6-+-ocg: stop erratic puppet failures.

e1c35ceb08-+-Require 2 ACKs from kafka brokers for text caches

1235235ce5-+-Merge "backup ganglia data on the collector" into production

76924269e4-+-backup ganglia data on the collector

ff6eb86402-+-gerrit: move to module

b44b121351-+-Backup /var/lib/carbon/whisper on graphite

1c5a153dcf-+-Merge "hhvm: Make source file installation refreshonly" into production

c20333362b-+-Merge "HHVM: install source to /usr/local/src/hhvm" into production

b28786760d-+-tor - include passwords for control pass

99ca11e447-+-tor - adjust nickname

baa1481225-+-tor - ensure /srv/tor exists/owned by debian-tor

1eb35b9d75-+-apply role::tor on radium

6b5e1219c6-+-racktables - replace webserver:: includes

38211fdf8c-+-move racktables from misc to module

395718f470-+-Merge "Add 'motd' module from MediaWiki-Vagrant" into production

7751691300-+-Add 'motd' module from MediaWiki-Vagrant

1e5eced6a6-+-Merge "delete deployment::packages" into production

c4684e1c0d-+-Tool Labs: major cleanup of classes and roles

f9c595ef5b-+-Merge "Reorganize backup roles" into production

61e2fe1f38-+-redirector for bugzilla -> phabricator

eb5c27843f-+-Reorganize backup roles

1632dd15af-+-Merge "puppet::self::master - remove pmtpa" into production

ad33e17e8e-+-puppetmaster - allow_from codfw.wmnet

c3304ac579-+-puppetmaster - remove pmtpa from allow_from

0b4e7c5d64-+-puppet::self::master - remove pmtpa

48ccb43715-+-delete deployment::packages

accacfbc45-+-Configure gerrit's its-phabricator

b112d66d6c-+-Standardize declaration of nodejs package

1d557e4dae-+-decom elastic04 from beta, last precise host

166e49c645-+-Decom deployment-elastic0[1-3] from beta

942a0f0d21-+-ocg: yet another variable name change

c0bb4ddbe5-+-ocg: use the correct variable

a14f55c5cd-+-ocg: sanitize role::ocg::production, change alerts

4f6ba147ef-+-Require 2 ACKs from kafka brokers for mobile caches

1af7a8c4c3-+-Don't enable ganglia config on beta

70f827e563-+-Fix regression introduced in 9b8ead0

cecfa1a72d-+-Merge "remove 10.0.0.0/16 Tampa subnet" into production

42dcdfbc27-+-Beta: Apertium: Remove unused comments for parameters

9b8ead055c-+-remove 10.0.0.0/16 Tampa subnet

2b028c108f-+-Merge "Beta: No CI for Apertium" into production

b585db9960-+-graphite: Fix location of archiver class

b778f23d92-+-graphite: Add labs archiver script

3419257d62-+-Beta: No CI for Apertium

6490adf35f-+-turn RT from misc/* into puppet module

b22488510b-+-osmium: add appserver role

06bc2c0b7d-+-Fix Elasticsearch in ci

7420260345-+-Merge "Work around Citoid bug in health check" into production

7ea296c9a5-+-gerrit: Remove duplicate mirrors

e630f89529-+-hhvm: add hhvm-watch-mem

ec305cf5f5-+-Re-remove deployment::target

0a1f9e0364-+-Merge "Add quickstack to standard-packages; remove from hhvm::packages" into production

89cdf2e666-+-Revert "Revert "trebuchet: derive the grain name from the repo name""

b7f05356e9-+-Add quickstack to standard-packages; remove from hhvm::packages

aa92cd3a6c-+-hhvm: provision quickstack package

ee6074cd82-+-Merge "shinken: Set up separate directory for generated configs" into production

77788f5303-+-shinken: Set up separate directory for generated configs

b90d73dac9-+-Merge "Beta: Update cxserver to use Apertium service" into production

ba6f31a3a4-+-Beta: Update cxserver to use Apertium service

0e69f1308e-+-Simplify apertium module

bb9b518ddf-+-shinken: Puppetize templates.cfg

777d11186d-+-Configure Beta Elasticsearch for statsd

2844c7eee2-+-Add apertium module tests

03ca6e9c3c-+-Beta: Apertium service configuration

c4988a0e06-+-Merge "iegreview - include app passwords from private" into production

838a919e49-+-iegreview - include app passwords from private

a1361eb48a-+-iegreview: fix hostname for logging server

dacf3896b2-+-iegreview: Provision iegreview application

172c1aba0f-+-Merge "iegreview: Create module and role for deployment" into production

b1e843f241-+-Merge "tor-relay - add firewalling" into production

b1ce21a5a0-+-add IPv6 interface to radium

7f1f570048-+-add node radium to site.pp

1bdb74184c-+-iegreview: Create module and role for deployment

4eadeaa33c-+-webserver::php5-mysql: use require_package()

450338a188-+-Merge "webserver - use ssl_ciphersuite in generic_vhost" into production

8e420d4c5e-+-Merge "puppetmaster - use ssl_ciphersuite" into production

c3ca6060fe-+-hhvm: include .::packages rather than require

8f8e27b722-+-HHVM: provision debug symbols for libraries used by HHVM

3326274005-+-Merge "Labs: final fix of gridengine class" into production

6be320190a-+-Labs: final fix of gridengine class

fa20928048-+-Disable SSLv3 completely

33745f72a6-+-Labs: more tweaks to gridengine puppetization

41b67255a5-+-Labs: more tweaks to the gridengine class

0ffdfcdeee-+-Labs: more fixes to gridengine puppetization

9d081b1ccf-+-tor-relay - add firewalling

3599867dc2-+-Labs: more gridengine class fixes

bb62d6e353-+-Labs: more explicit paths

07ca7ae8a7-+-Labs: further fixes to gridengine puppetization

8b7464dfba-+-Labs: more fixes to gridengine class

d2eaa8db7b-+-Labs: typo fix

51e65ac257-+-Tool Labs: fix c&p fail in hostgroup::collector

8b9df83a67-+-Labs: further fixes to toollabs and gridengine

d67485f8d4-+-Labs: minor fixes to toollabs module

9d94fc4a75-+-Labs: fix err in toollabs module structure

490efb0c45-+-Labs: remove $configsource from gridengine::master

cef289201a-+-Labs: decouple exec_host and submit_host

ed12d670b0-+-Labs: puppetize gridengine

cf02c18afe-+-Merge "gerrit: Disable SSLv3" into production

9b346320c2-+-gerrit: Disable SSLv3

e26236010a-+-Grant access to Magnus Edenhill on analytics1003

8b602c08df-+-Revert "trebuchet: derive the grain name from the repo name"

198d191c3f-+-trebuchet: derive the grain name from the repo name

46f0881b98-+-prepare es2001

1ec85f66e2-+-labs: reduce acct archiving retention

e41db153b2-+-Merge "publichtml: tidy" into production

78d84a2eb2-+-Merge "ishmael - remove SSL config remnants" into production

9484ab47ef-+-ishmael - remove SSL config remnants

6a530923a1-+-ldap: Move ldapsupportlib.py to standard location

d3bc115ba1-+-publichtml: tidy

f844accc3e-+-Merge "Beta: Add missing link to init with upstart-job" into production

25a3853871-+-Merge "Labs: clean exec resources in gridengine class" into production

816e6e27ff-+-Labs: clean exec resources in gridengine class

efd0ec5502-+-Include ganglia in standard only for production

9c077f7163-+-prepare es2006 and es2008

f288417eb5-+-Merge "Bugzilla - disable SSL3" into production

a08e4a8fb1-+-Labs: quoting and explicit bash -c in gridengine

9e1e65928b-+-Labs: Further tweaks to class gridengine

35c9c5d1c9-+-Labs: Tweak for toollabs gridengine config

735657b2d6-+-Labs: more gridengine puppetness

6ad811fff1-+-Bugzilla - disable SSL3

063964f8f2-+-Merge "Beta: Define cxserver port" into production

2f77b8dcdb-+-ganglia: use install2001 public name

52714b770a-+-use the old deployment::target class for trebuchet test repo

7f11bd94b9-+-Revert "Remove deployment::target"

a66fe895bd-+-beta: bastion ssh rule needs the class that defines bastion ip

a6ec9d9029-+-mediawiki::monitoring::webserver: tidy

7d05ab065c-+-Remove deployment::target

db5df7464d-+-role::ci::slave: Convert to package<|provider==trebuchet|>

a44cef6f4b-+-Merge "role::analytics: Convert to package<|provider==trebuchet|>" into production

86da996366-+-role::elasticsearch: Convert to package<|provider==trebuchet|>

c065381093-+-role::parsoid: Convert to package<|provider==trebuchet|>

8df2d9e4f0-+-Merge "ocg: Convert to package<|provider==trebuchet|>" into production

429feecf5f-+-Merge "role::performance: Convert to package<|provider==trebuchet|>" into production

22857337f3-+-labs beta: make a class that explicitly has test repo plus ferm ssh rule

65000e168d-+-apache: disable diamond collector

393563aea8-+-Add some dumb but useful scripts for querying nova

be29b6ca7d-+-Move some nova scripts into a new class, openstack::adminscripts

65242b2f89-+-mediawiki: do hhvm rendering checks on any webserver

cae733dedf-+-apache: fix diamond stats collections.

eafb01c8b1-+-Merge "Labs: allow for growing volumes" into production

ccc17ce078-+-puppet::self::master : fix hiera dir name

fa798cd66e-+-beta: use hiera for nutcracker host list

1fec906530-+-Beta: Define cxserver port

bd15778d67-+-Beta: Add missing link to init with upstart-job

bd73121c6e-+-deployment: turn off gitfat for testrepo

29af704721-+-Merge "Make sure openstack::openstack-manager creates /a" into production

dad3aa10d1-+-Merge "role::librenms: Convert to package<|provider==trebuchet|>" into production

2f18f35203-+-Merge "role::mathoid: Convert to package<|provider==trebuchet|>" into production

7395dd0ead-+-servermon: Set a cron for the make_updates command

025409ded0-+-mwprof: Convert to package<|provider==trebuchet|>

9941d49f46-+-First of (hopefully many) es-tool commands

9d54bc2993-+-fix test of trebuchet provider

b7b0479183-+-netmon1001's ganglia aggregator pmtpa removal

42f050c63c-+-hhvm: monitor busy threads and queued requests.

2848a3b222-+-Merge "role::servermon: Convert to package<|provider==trebuchet|>" into production

123a3e2948-+-Make sure openstack::openstack-manager creates /a

ca526c6906-+-Labs: allow for growing volumes

8251d1be08-+-ocg: Convert to package<|provider==trebuchet|>

0c5f28f944-+-role::mathoid: Convert to package<|provider==trebuchet|>

e7d4b97f24-+-role::servermon: Convert to package<|provider==trebuchet|>

b8cfe162bc-+-role::librenms: Convert to package<|provider==trebuchet|>

cfde127602-+-role::performance: Convert to package<|provider==trebuchet|>

4ccad9f41a-+-role::analytics: Convert to package<|provider==trebuchet|>

566d0dc507-+-Fix-ups for 3d3c9144 and 8dc45e87af

3d3c914471-+-role::logstash: Convert to package<|provider==trebuchet|>

116391ac6d-+-kibana: Convert to package<|provider==trebuchet|>

8dc45e87af-+-eventlogging: Convert to package<|provider==trebuchet|>

59d456c795-+-scholarships: Convert to package<|provider==trebuchet|>

4f64ea8c7c-+-role::deployment::test: Convert to package<|provider==trebuchet|>

c1e4433738-+-gdash: Convert to package<|provider==trebuchet|>

8a4b69f96b-+-add update cronjobs for wikisite/editthis

b7c54cf205-+-contacts.wm - remove ferm/443, remove SSL cert

a25416c0cc-+-Merge "ganglia_new - remove pmtpa from configuration" into production

5b24f00fad-+-ganglia_new - remove pmtpa from configuration

6812d73f20-+-Fix double-include of 'admin'

0cc5e593da-+-Add deployment access to the tmh boxes.

a52e099238-+-Merge "contint: Sikuli is no longer used anywhere" into production

971bb7b690-+-contint: Sikuli is no longer used anywhere

a19e4c17f7-+-Merge "labsdebrepo: Fix initial run" into production

fe31558028-+-Merge "T620: Timezone should not default to America/Los_Angeles" into production

42d1f7630d-+-Merge "nagios_common: Move checkcommands.cfg into module, from icinga" into production

36d567a31a-+-Merge "icinga: Split mysql related config entries into separate file" into production

4f5e953ab7-+-T620: Timezone should not default to America/Los_Angeles

a07535043d-+-Phabricator: Ensure root directory is created before cloning in it

f329b96587-+-nagios_common: Move checkcommands.cfg into module, from icinga

6f89199494-+-icinga: Split mysql related config entries into separate file

d3c8d2527c-+-icinga: Separate smtp configuration into own file

1207d2617b-+-nagios_common: Allow content to be set for command config

4b857a07f6-+-contint: ruby2.0 on Trusty slaves

f9d72d0175-+-mediawiki: fix typo in resource dependency

2008e36813-+-mediawiki: collect hhvm stats

346d5cb862-+-swift: enable container-server statsd reporting

a282546bd0-+-Prepare db1046 for upgrade, switch to production MariaDB 10 config.

7fff221fcd-+-Merge "androidsdk: Make sure that JDK is present" into production

37edb318ae-+-androidsdk: Make sure that JDK is present

4dc41ffa39-+-Merge "Install logstash-contrib too" into production

e4713bcc5c-+-Merge "Remove squid monitoring from torrus" into production

51a4f8c49d-+-Remove squid monitoring from torrus

36d5542be5-+-Merge "facilities - remove Tampa power strip monitors" into production

fe4deb009b-+-Work around Citoid bug in health check

8e4cc2910f-+-Remove all IMAP configuration and Puppet manifests

cad082cf1b-+-Add LVS for citoid

8ecd20bb9b-+-Add parsoid-admin ocg-render-admin to tin and bast1001.

e007ff6451-+-base::standard-packages: install `perf`

93da619306-+-remove pdf servers,role::pdf and misc pdf class

f78a0f9d81-+-Merge "elasticsearch - delete pmtpa remnants" into production

6670531fc3-+-Merge "redis - remove pmtpa monitoring group" into production

bdcbd3bbf3-+-Merge "salt_minion monitoring - only CRIT if > 2" into production

dc3ff7d362-+-salt_minion monitoring - only CRIT if > 2

1ebe7633ca-+-remove role::mail::sender from role::labs::instance, it's already included via standard

8d3de11df5-+-swift: fix container-sync template

8d26857474-+-swift: add container sync

b2f9adbba8-+-mediawiki: consolidate apache configs

a8305a06b3-+-mediawiki: consolidate hosts in site.pp, convert mw1053

c0d30a118a-+-redis - remove pmtpa monitoring group

a93e4a0792-+-elasticsearch - delete pmtpa remnants

e705f8aa8f-+-facilities - remove Tampa power strip monitors

b76f03c05f-+-Merge "Add djvu tools for OCG." into production

bc70b3bf4d-+-remove boron node from site.pp

68e47b4c56-+-Download the Maxmind Geoip Connection-Type databases

19c66b8484-+-remove one last pmtpa remnant in domain_search

761a52459a-+-remove virt0 from site.pp and DHCP

226f66d569-+-Merge "icinga: no more misc in pmtpa" into production

00a5d717eb-+-Specify citoid/deploy as package name

ab9d49140a-+-Add citoid module to sca1001 and sca1002

c2bdeb906e-+-Citoid puppetization

81d8fca21a-+-Config for graphite plugin for Elasticsearch

9ad61aa3c9-+-And another decrease in Parsoid job parallelism

210243af15-+-Reduce Parsoid job parallelism slightly further

f9ca50c387-+-Reduce Parsoid job processing parallelism further

b342e4a1ac-+-datasets: re-enable rsync between peers

0c8717930e-+-datasets: remove obsoleted script rsync-dumps.sh

452a3b835f-+-ms1001 takes over job of gone dataset2 as secondary for dumps

42fabe41e7-+-Install logstash-contrib too

1eedd5d1c7-+-decom dataset2, replace with dataset1001

f02218aee7-+-mediawiki: mediawiki-math-texvc is in precise-wikimedia too

1991434f72-+-ship {texvc,texvccheck} via mediawiki-math-texvc

6360c81cd9-+-Merge "Collect ganglia metrics from NFS servers" into production

77f01aa900-+-Collect ganglia metrics from NFS servers

9befb017bf-+-swift: remove ganglia stats via ganglia-logtailer

834894df6f-+-mediawiki: repool mw1163 for scap, convert to hhvm.

ac6d4bdf20-+-remove Tampa network gear from netmon

7eaecab6e8-+-Extract wmf-beta-scap to sudo-withagent wrapper script

10956f743b-+-Reduce number of parsoid runners even further

f34cfb9a5b-+-syslog-ng: update to trusty

49b5fadbd7-+-Merge "gitblit: fix monitoring check" into production

8dd9519636-+-gitblit: fix monitoring check

fe1705a04f-+-upgrade db1042 mariadb 10

ccf739a910-+-mysql_wmf: db1001 is in eqiad not in pmtpa

00ddc51c63-+-Merge "Word-wrap fix for comment block" into production

5c8ddd589b-+-Word-wrap fix for comment block

006fbbde6b-+-Disable cr1-esams BGP check for now

7d1aeb31da-+-icinga: Setup perms for command files

266992356a-+-fix mr1-esams IP for monitoring

2d9c6cfc13-+-clean up esams router monitoring a bit

f4a3822b6b-+-fix icinga BGP checks, mostly

fe7b0c1a97-+-Remove old ns1/mexia refs from authdns

fc82cc2fe1-+-decom mchenry

d5135c3c72-+-decom dobson

ab17c12e05-+-decom mexia

30c9220075-+-Move fatalmonitor to fluorine

3d94157ad4-+-Add djvu tools for OCG.

92ce486c09-+-require_package python3 on Hadoop nodes

57afb300c1-+-mediawiki::packages::php5: formatting tweak

abf1b3c764-+-mediawiki: install php5-dbg on Zend app servers

d2948ff7cf-+-decom tarin (formerly pmtpa ganglia)

2df0d586d9-+-Merge "decom nfs1" into production

e546909ff6-+-Decrease the number of parsoid job runners

24ccf3a7cc-+-decom nfs1

6c440acc80-+-icinga: no more misc in pmtpa

140131e499-+-Merge "add check if salt-minion is running to base" into production

0e36f99b3e-+-add check if salt-minion is running to base

372d183ef2-+-Remove autofs setup in vmbuilder.

c76076cc22-+-Removed a bunch of 'refreshonly' directives.

48fc981b48-+-fix dupe monitor defs on cp1008

59ce01948a-+-Give sca cluster the mathoid LVS IP

c07ee4f8a2-+-Followup commit to bfaaff1. Remove the unneeded require

bfaaff142c-+-Remove /srv/deployment/mathoid/mathoid resource

a20bb3cd8c-+-Merge "icinga: Fix typo" into production

2de9379e3a-+-icinga: Fix typo

b1d49e1495-+-Merge "icinga: Make all config files belong to icinga:icinga" into production

acb305ee2d-+-HAT: mark failed requests with an additional header

d8e5c9aba2-+-swift: point ganglia codfw cluster to install2001

33d5eba781-+-swift: update ganglia_new and gdash dashboards

df0d329835-+-contint: python3.4 on Trusty labs slaves

4307a236b5-+-use scap's embedded linking, remove lint script

08ef72ca29-+-remove pmtpa from all $domain_search

e60439008f-+-icinga: Make all config files belong to icinga:icinga

bb63ce9862-+-remove deprecated labsnfs class and files

2ca6be4733-+-Merge "Install exim4-daemon-heavy the ugly way" into production

67bb112372-+-syslog-ng: create archive directory

d9132fb8cc-+-Install exim4-daemon-heavy the ugly way

092c7e8623-+-Merge "Revert "Use exim4-daemon-heavy on the tools mail relay"" into production

153f427359-+-Revert "Use exim4-daemon-heavy on the tools mail relay"

840a170c68-+-Merge "Use exim4-daemon-heavy on the tools mail relay" into production

5956da9e87-+-Use exim4-daemon-heavy on the tools mail relay

223a9a240d-+-HHVM build-deps: add condition to exec, move to contint

c9e118ce9d-+-dataset1001, not datasets1001 in $hosts_allow in role::analytics::rsyncd

992b97de82-+-Rsync Hive generated webstats pagecounts_all_sites dataset

8ce7c940b1-+-Add check_ifstatus_nomon and use it for routers

2cd2bd2ecd-+-icinga: Remove misc/icinga.pp

abbf32dec7-+-Abstracts Sprint install with defined resource type phabricator::libext

076937428c-+-Merge "icinga: Move misc files/dirs into module" into production

1f2741cc84-+-Merge "icinga: Move purge resource script into module" into production

7ee6e276ca-+-nagios_common: allow use of a template for contacts.

99477582c5-+-swift: add codfw monitoring and dashboards

19c061e626-+-puppet: drop global variable $puppet_version

c82909da69-+-hiera: use hiera to lookup the cluster

da0fe76f9e-+-swift: clean up

a09c56575a-+-misc::maintenance: clean-up

db642b0816-+-mediawiki::hhvm: warm up the JIT in an Upstart task

f0fd8bd781-+-Merge "mediawiki_singlenode - don't use pmtpa servername" into production

76e1acd4eb-+-pdf servers - remove from dsh,dhcp,ganglia

f4f0af0483-+-icinga: Move misc files/dirs into module

ac175fcd09-+-icinga: Move purge resource script into module

46028342eb-+-Merge "rbf100{1,2}: set vm.overcommit_memory = 1, per redis requirements" into production

8fed4ede0f-+-add router mon for [cm]r[12]-(codfw|ulsfo)

a104038c90-+-rbf100{1,2}: set vm.overcommit_memory = 1, per redis requirements

ff5e27621e-+-toollabs: Remove gridengine ganglia monitoring

faa32dbb69-+-Fix typo in hive role that caused hive to not work in labs

ea7f2e327c-+-mediawiki::hhvm: add 'furl' cli tool

41e68e6d27-+-remove old 'searchqa' classes and files

99ed1771e2-+-Raise ocg health check limits to 400k/800k

db1c635b8e-+-icinga: Get rid of ganglios

a1aa79fb6b-+-icinag: Remove unused global variables

a545ea83ed-+-Add swift to codfw LVS balancers

f06b0dcb96-+-swift: this isn't python, sorted vs sort

85717d4219-+-swift: fix credentials #2

947ac962b1-+-Use codfw LVS-based recdns

33b72ae6dc-+-swift: fix credentials variable

d3139209c6-+-lvs: add swift in codfw

9158f5a157-+-Merge "replace sanger,sfo-aaa1 with ldap1/ldap2.corp" into production

56b0cd6ab6-+-swift: fix auth url usage

df904237ae-+-Merge "network.pp - remove fenari" into production

38d0c72615-+-remove old pmtpa es nodes

2167ec2075-+-swift: use fully-qualified vars

c3c28a064a-+-remove Tampa db's from site and dsh

2620c3576a-+-swift_new: include role::swift::base

bbefd4786b-+-Merge "swift: fix system::role description" into production

f6f00181be-+-swift: fix system::role description

7447a69676-+-mediawiki: reimage mw1022 to HAT

31808292a9-+-phab update for local mwoauth provider

9b6c0caba8-+-prepare db1063 for upgrade

20790b71d3-+-mediawiki_singlenode - don't use pmtpa servername

82f1344cb8-+-phab add lock file for tools repo

b9a09965dc-+-phab readd migration tools repo

4b9daceb72-+-icinga: Move permission fixing HACKs into module

8cea539da8-+-Collapse /etc/hhvm/fcgi into /etc/hhvm

9d4f0fd1d6-+-fix gitrepo for role::authdns::testns

d16421a733-+-use cp1008 to test authdns stuff too

94854ac850-+-prepare es1010 for upgrade

626b2c1670-+-prepare es1008 for upgrade

e115a6cba1-+-Merge "Fix to the ssl_certs apparmor profile install" into production

6d276271ae-+-remove pmtpa db's from coredb role config

e88c692279-+-Fix to the ssl_certs apparmor profile install

0482c9c3fe-+-Fix apparmor to allow for new cert scheme.

73e97c8652-+-Merge "tcpircbot - remove fenari references" into production

492825b43b-+-Merge "Replace a couple of notify  that were accidentally removed in d8bbd59292f26806f44b9f0b5492b7594858f6ba" into production

4be914576a-+-Merge "remove fenari from site.pp" into production

d6c1fc94d8-+-Revert "Stop sending apache syslogs to remote syslog"

8cc903583a-+-Stop sending apache syslogs to remote syslog

644c8d9165-+-HHVM: Get rid of HDF files

c9f30676cb-+-Merge "Sync up ganglia_new configuration with ganglia" into production

ab99292f14-+-tcpircbot - remove fenari references

f355b7140c-+-network.pp - remove fenari

03459ac081-+-remove fenari from site.pp

dcea1742f1-+-load mod_rewrite on terbium Apache

1be0f38da1-+-replace sanger,sfo-aaa1 with ldap1/ldap2.corp

eaa1c745b1-+-Sync up ganglia_new configuration with ganglia

1e6ef1afe7-+-Switch kibana to the new ldap servers.

b66a8cd64e-+-Move tendril ldap to the new ldap servers.

7f281ec86c-+-Move ishmael to the new ldap servers.

49379943a0-+-Merge "include admin for pollux, plutonium" into production

1bea9e9366-+-Merge "ganglia collector for OCG service" into production

277d27fbac-+-ganglia collector for OCG service

cdc33c8661-+-include admin for pollux, plutonium

26dd4765f8-+-Move graphite ldap to the new ldap servers.

407b902647-+-Merge "Moved labs-ns0 and labs-ns1." into production

4275ad235e-+-deploy pollux as codfw corp ldap

55d3e5d447-+-mexia out of authdns-update list

3c4c491e2c-+-syslog-server: switch log directory to present

d3b537073e-+-turn off rsync to dataset2 from dataset1001

3aeabd1a4a-+-lithium: exclude from remote-syslog

715560b825-+-lithium: provision as syslog server

73d702b9b0-+-Merge pdns precise/trusty configs, unbreak nescio

b23e246eae-+-Point beta redis at the domain instead of ip

6b6667fc36-+-search - remove commented check_lucene_frontend

0ff2ea6428-+-grafana::web: include mod_proxy_balancer

1230ead07c-+-Grafana: use LogStash's ElasticSearch for dashboard storage

8635a68d23-+-Replace a couple of notify  that were accidentally removed in d8bbd59292f26806f44b9f0b5492b7594858f6ba

53befa1d34-+-Fix typo with typo

9a8104750c-+-Certificate config had wrong group for dir

a5ccbf7118-+-Use the Ubuntu Way of installing SSL certs

ee3b3afe6a-+-Fix comment in cache.pp about $topic_request_required_acks

120009b609-+-Not ensuring that python3-matplotlib is installed, not all stat machines are Trusty

20dbc13744-+-Experiment with different topic_request_required_acks settings

7992a7fa6e-+-Moved labs-ns0 and labs-ns1.

4587225486-+-Merge "Include libnet-dns-perl with ferm.  It's needed for certain ferm functions." into production

f9b715a638-+-beta: update mwdeploy sudo grants

f223a9499b-+-Merge "HHVM: Set a fatal handler that logs traces" into production

5650d46afb-+-Add python-matplotlib on stat servers

a2bb16d157-+-swift: fix filesystem provisioning

74d2ce1f7d-+-swift: check device, not partition for xfs

449fd87897-+-remove linne from site.pp

828cee7f83-+-Merge "gerrit - raise HSTS max-age to 1 year" into production

2010830472-+-add standard to swift_new -based hosts in site.pp

f5b66d2b8c-+-Try a different approach for handling wmf_ca_2014_2017

0c662b3d1a-+-decom silver

0759688739-+-HHVM: Set a fatal handler that logs traces

36535302ca-+-assign base::firewall to plutonium

d2775b89fe-+-Assign ldap-mirror.wikimedia.org WMF CA cert

28741ffcff-+-holmium more corrections, service not rule for ferm definitions

01067efe96-+-properly applying the firewall rules per role class on holmium

01192469a4-+-Introduce wmf_ca_2014_2017

c2ccc45b1b-+-Merge "add $::site to openldap monitoring group declaration" into production

a47fe52d8b-+-add $::site to openldap monitoring group declaration

b62d61a0ed-+-Reset queue_buffering_max_ms to default 1000 ms for varnishkafka

adef159541-+-restrict holmium firewall to corporate office access only

421f987aa2-+-Merge "remove OCG health check filesystem collection/alerting" into production

b259a9a146-+-remove OCG health check filesystem collection/alerting

acd578a2b7-+-Include libnet-dns-perl with ferm.  It's needed for certain ferm functions.

bdf00fce7d-+-Need double-quotes if there are variables!

42d04e4ca7-+-Split out dist-specific configs for pdns

53634ea170-+-phab email pipe needs to be executable

944bb09190-+-Revert "Revert "Include base::firewall in labcontrol2001""

600bbb31b9-+-Merge "Move ldap ferm rules to the ldap module" into production

135c51daa6-+-specify the correct password class

3c67d9651e-+-fix typo (install-certificate -> install_certificate)

f6d929540f-+-openldap_corp_mirror in ganglia clusters

7fd3d2ac5f-+-Introduce role::openldap::corp

7fbce1215a-+-phab remove obsolete option

55fa09e67b-+-phab update for T171

dee36c3634-+-Merge "Revert "Include base::firewall in labcontrol2001"" into production

5c0f3571af-+-remove pmtpa network monitor defs

3a6fbb5eef-+-Fix icinga network checks

f58efa7824-+-hiera: use hieradata everywhere

f965926955-+-Merge "openldap module" into production

a5787c94cd-+-Include base::firewall in labcontrol2001

a662d8b85c-+-Merge "Add ferm rules to allow our labs dns server to actually serve." into production

81b57a922f-+-Merge "Set up labcontrol2001 as a dns server." into production

b3e2e961cd-+-swift: refactor into module, add codfw

888024a6c9-+-Revert "swift: refactor into module, add codfw"

9368becea1-+-hhvm: create module + list all dev dependencies

758a6f8159-+-swift: refactor into module, add codfw

d8dad0d168-+-zuul: client to easily query Gearman server

f8752b0d80-+-contint: configuration files renaming

d94819a345-+-Fix bits monitoring URLs

c56417f062-+-authdns: switch to all IPs on all hosts

693e19171c-+-mediawiki: move memcached servers list to a hiera variable

6e5ba5fb85-+-contint: Ensure nodejs-legacy is installed

e400119741-+-HHVM: warm up the JIT by making web requests in Upstart post-start

fa9f344159-+-Set appropriate 500 and 404 documents for HHVM

88c73802e8-+-prepare to retire remaining pmtpa DBs

4b6d8ba1e1-+-Move ldap ferm rules to the ldap module

97a4af86f4-+-Revert "Include base::firewall in labcontrol2001"

2fa8161719-+-Add ferm rules to allow our labs dns server to actually serve.

0d38ca6e02-+-Set up labcontrol2001 as a dns server.

9f832fc168-+-For labs, give mathoid and empty lvs_service_ips list.

5de0072e55-+-Re-add "wmflib: add to_milliseconds() / to_seconds()" w/fix

4d128c86db-+-Merge "integration: Ensure that /srv/deployment/integration is present" into production

a0afb7c502-+-Merge "Revert "wmflib: add to_milliseconds() / to_seconds()"" into production

9a6ad71d4c-+-integration: Ensure that /srv/deployment/integration is present

99bc8f7310-+-Revert "wmflib: add to_milliseconds() / to_seconds()"

0759f84958-+-Allow wikidev users to restart HHVM

191dda5d7f-+-wmflib: add to_milliseconds() / to_seconds()

1a36303989-+-Merge "Revert "Switch kibana to the new ldap servers."" into production

de319d4171-+-Revert "Switch kibana to the new ldap servers."

24672a62a0-+-Merge "Revert "Move tendril ldap to the new ldap servers."" into production

b0d9ca5003-+-Merge "Revert "Move ishmael to the new ldap servers."" into production

11acd2a095-+-Revert "Move ishmael to the new ldap servers."

54e730c11b-+-Revert "Move tendril ldap to the new ldap servers."

12ce405fd7-+-Merge "Move tendril ldap to the new ldap servers." into production

1a01423e2b-+-Removed references to the old virt0 puppetmaster

57ce100add-+-Move tendril ldap to the new ldap servers.

06b4cd0ba9-+-Purged virt0 refs from the ldap module.

ee49c4d1c6-+-Purge a bunch of pmtpa labs defs from openstack manifests.

4e12b3b0b6-+-Merge "Fully qualify icinga module in icinga role" into production

9b42b81c15-+-Fully qualify icinga module in icinga role

d376c17f84-+-Switch over to using a labcontrol2001 as the labs salt secondary.

d93359e76c-+-icinga: Setup icinga role!

8121933528-+-Merge "Minor purge of virt0/pmtpa refs." into production

c66f868439-+-Include icinga base class in ::web and ::naggen

afba406b12-+-Move dependencies into icinga module classes

cdb6ccb49c-+-Add hhvm_api varnish backend director

7913c7b5ef-+-Switch kibana to the new ldap servers.

d5068268ab-+-icinga: Move web module into appropriate file

2af327290b-+-icinga: Setup icinga class, consolidate from other classes

401971ba03-+-Minor purge of virt0/pmtpa refs.

c1ecb4a81c-+-Merge "Move ishmael to the new ldap servers." into production

bdd6e63898-+-icinga: Move plugins into module

615fbcbf7f-+-icinga: Move service definition into module

75ccc63e2b-+-icinga: Move config into module

5e9b551ac8-+-icinga: Move initscript into module

cdcdfcf683-+-nagios_common: Move check_ganglia into module

74264124dd-+-icinga: Move global monitoring hostgroups into module

8d866c326e-+-icinga: Move naggen into module

12dc7415c5-+-Merge "fix duplicate declaration of http check" into production

94f5cdf7b4-+-fix duplicate declaration of http check

d8502ce042-+-terbium - include misc::noc-wikimedia

4125a9a643-+-Use $::instanceproject as Hadoop user group in labs

968cc80cc3-+-Increase OCG warning/critical space thresholds.

4a7f826794-+-hhvm: serve API as well

6079fcc19e-+-openldap module

6ab3d25257-+-Merge "Update labs instances to use the new ldap-eqiad server" into production

e5615cdf3d-+-icinga: Move packages into module

0fd1cb9f23-+-icinga: Remove resource.cfg from refresh list

63311cb818-+-shinken: Specify config_dir for contacts

16f9712795-+-Setup ldap client in terbium

c76f4ae45e-+-Remove all vumi related code

5b10cb2e97-+-puppet-compiler: fix typos

984e47131c-+-authdns: set up extra listeners for codfw transitions

8930c23890-+-dsh: Move dsh related code into a module

bafa768c31-+-mediawiki: allow additional pools on one mediawiki host

b856e7285a-+-convert mathoid from high-traffic to low-traffic

6d4095388b-+-Add service ip for apis under hhvm

0c7d4ce603-+-lvs: add hhvm-api.svc.eqiad.wmnet

1bdc047d6b-+-Move ishmael to the new ldap servers.

c3473c664f-+-We need ldap certs on some production boxes as well.

846cb58ac1-+-hhvm: do not install a specific version anymore

1128c2f579-+-Include CA certs everywhere rather than just when we need them.

c79f865b06-+-Update labs instances to use the new ldap-eqiad server

132be0594e-+-Merge "beta: Remove Apache::Conf['hhvm_catchall'] from mediawiki::web::beta_sites" into production

6e7fae04eb-+-beta: more deps for beta cluster jobrunners

bb9c35c041-+-nagios_common: Fix stupid copy paste error

cd12d8c2d9-+-beta: Remove Apache::Conf['hhvm_catchall'] from mediawiki::web::beta_sites

0832c72e5d-+-Ensure icedtea-7-jre-jamvm is absent on analytics::clients

55baa9eb02-+-Mount HDFS at /mnt/hdfs read only on role::analytics::clients (stat1002 and analytics1027)

0d9476a031-+-Configure archive table name

a05b98a8da-+-temp fix for virt100X ntp

94a4446892-+-Switch all clients to new NTP servers

1948be0db3-+-ntp: another eu s2 list improvement

9cd5ac1e99-+-fix one of the EU ntp s2

856e5cb667-+-ntp: use explicit S2 upstreams

0bff6c4ce8-+-nagios_common: Move contacts managing into module

5d2c83d8c6-+-Merge "nagios_common: Move check_paging into module" into production

a286a7bcb8-+-Merge "icinga: Move wikidata monitoring into module" into production

19f447584c-+-Merge "icinga: Remove analytics.cfg according to TEMP: message" into production

69d2774060-+-Merge "icinga: Move NSCA code into module" into production

f5389165dc-+-HHVM: update JIT settings

3d330207ac-+-Merge "icinga: Move user / group setup into module" into production

39f3e70f7e-+-Merge "icinga: Move logrotate into module" into production

95d5eb2491-+-Merge "icinga: Move icinga web into module" into production

450debfefd-+-nagios_common: Move check_paging into module

49b324973f-+-icinga: Move wikidata monitoring into module

bd07f52e8c-+-icinga: Remove analytics.cfg according to TEMP: message

e2f2006ac9-+-icinga: Move NSCA code into module

b0cb191f13-+-icinga: Move user / group setup into module

e3324e42e4-+-icinga: Move logrotate into module

b7e9289100-+-icinga: Move icinga web into module

fb29fcac11-+-Temporarily add the ldap-codfw cert to neptunium.

ec972548cc-+-nagios_common: Move notification_commands into own class

b48229955f-+-nagios_common: Move timeperiods definition into module

73da7aca41-+-NTP config refactoring + updates

9be08e8808-+-nagios_common: Move notification commands into module

1068abea41-+-nagios_common: move vsz into module

e83a6212a4-+-nagios_common: move procs into module

e72d72431f-+-nagios_common: move ping into module

5cd755ac7e-+-nagios_common: move pgsql into module

9749a1342c-+-nagios_common: move ntp into module

18c0e3f5d5-+-nagios_common: move nt into module

f3dc160624-+-nagios_common: move news into module

082d5a0083-+-nagios_common: move netware into module

4a25fc5e4e-+-nagios_common: move mysql into module

5710b91277-+-nagios_common: move mrtg into module

bc898af0b6-+-nagios_common: Move mail into module

76fd031a00-+-nagios_common: Move load into module

0a4ad91d9c-+-nagios_common: Move ldap  into module

9d673b5cb3-+-nagios_common: Move ifstatus into module

8d9887cf4e-+-nagios_common: Move http into module

7765cde751-+-icinga: Remove hppjd check

2cda5204cf-+-nagios_common: Move ftp into module

22349f1316-+-nagios_common: Move flexlm into module

3cd518f39f-+-nagios_common: Move dummy into module

8bc6177e65-+-nagios_common: Move dns into module

6a843a43ab-+-nagios_common: Move disk into module

701e9a34f5-+-nagios_common: Move disk-smb into module

f5ae8bccaa-+-nagios_common: Move dhcp into module

7f81716e78-+-Merge "nagios_common: Move breeze into module" into production

64692c86f8-+-Merge "nagios_common: Move apt into module" into production

8824c29de9-+-Merge "nagios_common: Move tcp_udp into module" into production

e2b6774ef1-+-Merge "nagios_common: Move rpc-nfs into module" into production

b0cffc3ff3-+-Merge "nagios_common: Move radius into module" into production

173b668ec0-+-Merge "nagios_common: Move real into module" into production

25cb06be53-+-Don't run a dns server on neptunium

183f6d2b06-+-nagios_common: Move breeze into module

d57e35939a-+-nagios_common: Move apt into module

b0118018c7-+-nagios_common: Move tcp_udp into module

9fdd6e14e7-+-nagios_common: Move rpc-nfs into module

3447bacfa2-+-nagios_common: Move radius into module

25929a45a9-+-nagios_common: Move real into module

d3ff237679-+-nagios_common: Move snmp into module

e4e86d2dcb-+-Merge "nagios_common: Move ssh into module" into production

7f4082b89f-+-Merge "nagios_common: Move telnet into module" into production

ba63a5829c-+-Escape awk variable in kafkatee output

a49e2ad18a-+-Less exciting Elasticsearch configuration

ee18f2c874-+-Merge "contint: labs slaves +mediawiki::packages::fonts" into production

e183a6800f-+-Merge "Graphite: enable CORS for Grafana" into production

88e8212010-+-Graphite: enable CORS for Grafana

1f9b41504e-+-Merge "Apply the app server role on mw1022" into production

51a06bf998-+-Apply the app server role on mw1022

6039df8ccc-+-Install mediawiki-math-texvc on application servers

1e8d2bb9b9-+-Add ALL the ldap servers to the replication firewall def

8ba91ef049-+-Add ldap cert to neptunium

e18199da40-+-Make neptunium an ldap and dns server

07562af26d-+-Merge "Don't declare puppet_version='3' for virt*" into production

a49e304275-+-adjust ocg job status queue warn/critical thresholds for expected normal range

767fab00ec-+-Don't declare puppet_version='3' for virt*

03bb909144-+-puppet::self::master: symlink the hieradata directory

94c802958c-+-contint: labs slaves +mediawiki::packages::fonts

833fd4e5d2-+-osm: Export an expired tiles list to $expire_dir

924077ecc4-+-openstreetmap syncing should use less memory

f455e505e1-+-grafana: qualify graphite URL

27ee7f5e92-+-Merge "remove cron that rsynced nfs home" into production

1899447d52-+-remove cron that rsynced nfs home

078b78a96d-+-phabricator add header module

af4cd2a568-+-Merge "remove ferm rule for amanda/tridge" into production

1b8507f940-+-Merge "fix monitoring of url-downloader" into production

c40e8cb533-+-fix monitoring of url-downloader

883d5f208f-+-minor typo fix in url_downloader role

890b5412e3-+-fix mount parameter

69600ccd64-+-searchidx: mount /srv/mediawiki as a bind from /a

d1c5500b5b-+-Merge "Remove git::clone support for converting clones to shared" into production

ef1ea59dbb-+-nagios_common: Move ssh into module

4de840965d-+-nagios_common: Move telnet into module

3d7721267d-+-nagios_common: Move users check into module

204e88040c-+-nagios_common: Move check_all_memcached into module

df91b1fba1-+-nagios_common: Move check_ssl_cert into module

fd7e64e388-+-mediawiki: simplify api and rendering

1f0041029b-+-mediawiki: use hiera in appserver role

ac7a7fef36-+-mediawiki: first step in simplification

c45f8cea30-+-hiera: test functionality of dynlookup feature

8152a3e00c-+-url_downloader: assign to chromium

b06baad758-+-module/role for url-downloader

ea5665745f-+-puppet: introduce hiera for production

288857360f-+-grafana: pass server_name to grafana::web::apache

1af3af1b4e-+-Add Grafana module & role

77675457a0-+-Remove git::clone support for converting clones to shared

da66a02441-+-remove ferm rule for amanda/tridge

af46eef562-+-Remove tridge

6ee15f40ad-+-HHVM: Update the extension dir path for 3.3 changes

81944f8076-+-Add a couple of custom schema that were present on virt1000 but not puppetized

b67266a4c5-+-Merge "minor typo fix in url_downloader role" into production

246bf7342e-+-set phab file domain

7f437e707b-+-be explicit about server names for misc default

37799a06ca-+-Confusingly, ldap::role::server::labs is the server for labs, not a server in labs.

f04b910275-+-Set up firewall rules for ldap servers.

0a66d883dd-+-Remove a bunch of iptables classes that haven't been used for ages.

34cfa627d7-+-nagios_common: Move check_solr into module

33528403fb-+-nagios_common: Move check_cert into module

0189cf510f-+-nagios_common: Move wikidata check into module

80706b5ae3-+-nagios_common: Move check_dsh_groups into module

52247b6733-+-nagios_common: Refactor custom command definitions

a457947200-+-nagios_common: Extract user_definitions from icinga

330dd8472f-+-Merge "Fix typo in mathoid LVS group description" into production

73045a9935-+-misc-varnish: add palladium

79fdad1c83-+-config-master: serve through misc-web-lb

f052028ac4-+-Merge "labmon: Increase CPU sensitivity for contint from 95-99 to 90-97" into production

b51797df5f-+-labmon: Increase CPU sensitivity for contint from 95-99 to 90-97

7f768726a7-+-hhvm: disable internal stat collection

39ff6d4b80-+-icinga - fix syntax error for check_ssl_ldap

e47dec24be-+-fix SSL cert monitoring on LDAP servers

08715b700a-+-Merge "ensure_service(): fix docs, add more usage" into production

78b9b1f885-+-Fix typo in mathoid LVS group description

99b56d0812-+-Set a 'php' Salt grain, indicating the name of the PHP runtime

99637d2ca4-+-include GlobalSign CA cert on neon for monitoring

9704ed2cfa-+-include GlobalSign CA on labs LDAP servers

164e4f9e15-+-ensure_service(): fix docs, add more usage

65a3d8eb0c-+-Remove virt1006 from the nova-compute pool

4394c55c94-+-Switch to new service-specific ldap certs

6970eaff38-+-Merge "labs-vagrant: Fix initial clone and ownership" into production

2b6f7fb4e7-+-mediawiki::syslog: add docs

a232240c96-+-Lower the basic job runner parallelism

3e7727e5aa-+-adding mysql_codfw hostgroup

ba3629580f-+-adding appservers_hhvm monitor group

8a06ff481e-+-Merge "librenms: Provide a database purge script" into production

3ede152c4e-+-Merge "nfs cleanups" into production

c0d48a6b69-+-HAT: depool faulty servers, monitor hhvm rendering

32b70f6dd9-+-hhvm: disable collection of sql stats

65e88c1c2a-+-mediawiki: make HAT appservers a separate cluster in ganglia

3557d194bb-+-hhvm: make the admin server available on job runners

ad746213c0-+-fix server_name for star-cert stuff

3ba86339ca-+-Fix monitoring for star cert stuff

6283ec3372-+-fix server_aliases for sni_star

ae440307c3-+-fix sni_star def

f8a6dc39ac-+-oops, not cp1008.e.wm.o ...

f5a24da314-+-Add cp1008.wm.o to puppet

bfa1ba534a-+-labs-vagrant: Fix initial clone and ownership

030ac8fdc1-+-Merge "remove webserver::apache from etherpad role" into production

dd89bf2060-+-mediawiki::hhvm: add additional documentation

2e68c7457a-+-Merge "shinken: Experimental monitoring for betacluster" into production

67b280a51b-+-Merge "Remove legacy manifests.d/vagrant-managed.pp" into production

1df1bd8209-+-Merge "Added the bouncehandler router to catch in all bounce emails" into production

159bc21664-+-Remove legacy manifests.d/vagrant-managed.pp

998a324215-+-shinken: Experimental monitoring for betacluster

3d4873af69-+-Add role::cache::ssl::sni

26bcd3fb72-+-Merge "Initial shinken setup for labs" into production

36d70f6db1-+-mediawiki::cgroup: add docs

f0cc8283cd-+-Merge "beta: Move monitoring role into module" into production

d2003fcb42-+-Stop making so many virtual resources

9039beb36f-+-Added the bouncehandler router to catch in all bounce emails

618ad82cba-+-Remove the now defunct backup::server class

a5c3cde254-+-beta: Move monitoring role into module

afcd0d18c2-+-Initial shinken setup for labs

43785bd528-+-nfs cleanups

ce74f7e32a-+-Merge "Ensure snmp package on icinga for PDU monitoring" into production

fa2c1efac6-+-Merge "Remove protoproxy::init enabled parameter" into production

a08fca05f4-+-Remove protoproxy::init enabled parameter

6bf5bf6c46-+-metrics: disable SSL virtualhost and cert

25ddc824a4-+-Remove protoproxy::localssl enabled parameter

621887b384-+-Add protoproxy::localssl server_aliases parameter

d28240d4c4-+-swift: lower container availability threshold to >1 host

aba37143c2-+-Revert "disable wmfusercontent.org site on misc for now, nginx borked"

f3564da6c6-+-metrics: move from stat1001 to varnish

8caf8494df-+-kill dead/strange videos protoproxy

0ef9949c56-+-rename misc_web_https to misc_web-https for consistency

a83389ea72-+-Ensure snmp package on icinga for PDU monitoring

6ed0cdc7f3-+-cp300[12] do not exist

f5ec84d802-+-Merge "Only set the ipv6only listen option on the default server" into production

005430ff34-+-remove webserver::apache from etherpad role

f2bf4eaa62-+-fixup iface addrs for lvs200x

0a77f80dec-+-fix quoting in token stuff

99a6a1145b-+-use regsubst instead of inline_template

ab33cc177c-+-perhaps @var will work

8429169120-+-apparently no string interp for inline_template?

de3aa3d8c5-+-use v6 SLAAC tokens for interface::tagged, optionally

4cd6d45718-+-Set up ldap servers for codfw

4f2ce52e8d-+-Don't rely on labcontrol2001 quite yet.

09c94741d2-+-Turn on dns and ldap on labcontrol2001.

72f6dd5c7e-+-Tell palladium about all the domains

ca7703865f-+-Merge "Virt1000 is no longer a redis slave of virt0." into production

dff48424f3-+-Merge "labmon: Add contint monitoring for /mnt space as well" into production

9d7ce978ba-+-labmon: Add contint monitoring for /mnt space as well

95b7fcc538-+-Merge "labmon: Add basic graphite based monitoring for contint" into production

eda838ee25-+-labmon: Add basic graphite based monitoring for contint

c90909def1-+-Virt1000 is no longer a redis slave of virt0.

99c556d6d3-+-Merge "labmon: Kill CPU usage monitors for toollabs" into production

0a18ea5877-+-labmon: Kill CPU usage monitors for toollabs

c739455fbf-+-Put wikimetrics $var_directory in /srv.

d14c6aacde-+-Move make-instance-vol file into labs_lvm base class

9362b30bc7-+-Assign LVS IP address to mathoid

98380a281a-+-Only set the ipv6only listen option on the default server

e869a5e5fc-+-Merge "racktables: clean up ssl config, not needed" into production

fcd874d621-+-racktables: clean up ssl config, not needed

40d45cba18-+-Merge "labmon: Make tools CPU check more accomodating" into production

34c595b61f-+-labmon: Make tools CPU check more accomodating

6ed9d2c2f2-+-turn autoconf back on for v6_mapped ifaces

bcde4d8ff5-+-hhvm: switch on stats collection.

d8843ec566-+-librenms: Provide a database purge script

d3f02f6cc5-+-Merge "librenms requires snmp" into production

f5ffdc93c3-+-Remove the last resources of snmp on hosts

4615ebd473-+-librenms requires snmp

380b2a87a5-+-Remove the snmptt user

6084646d29-+-mathoid: create /srv/deployment

92c66e69f8-+-mathoid: Remove duplicate resource and fix docs

b4c88a9679-+-mathoid ganglia cluster renamed to sca

9f52b38514-+-Merge "Introducing Service Cluster A, hosting mathoid" into production

9caeccc4ff-+-Introducing Service Cluster A, hosting mathoid

d8bbd59292-+-Removal of all snmptrap functionality

260d64f7ce-+-icinga - use apache::site

3f9692aad7-+-assign codfw slaves: x1 db2009, m1 db2010, m2 db2011, m3 db2012

8e353b88e8-+-move lvs200x to private subnet

fe6e7bd846-+-icinga - partly revert logfile permission fix

1e152d8a3f-+-add recdns to codfw pybal

0a7fbf2439-+-add codfw to runcommand

36e040f2e6-+-Puppetize icinga log file permission fix.

826dfba4ef-+-interface-tweaks consistency

23d81e7bd9-+-fix interface::txqueuelen name param

20508e2b6c-+-Remove the dependency on the compute service for wikiupdates.

b22d5e171b-+-Revert "Use require_package('python-mwclient') to solve a duplicate package def"

c4291d0f62-+-Use require_package('python-mwclient') to solve a duplicate package def

e3fb9a18ae-+-Include wikiupdates on all nova boxes.

b51adfff75-+-De-duplicate various LVS ethernet fixes/optimizations across DCs

cbfd71b4fc-+-Merge "ishmael - include ::apache::mod::headers" into production

02b9601ab5-+-ishmael - include ::apache::mod::headers

01155e89a2-+-HHVM: increase JitAColdSize to 60 MiB

86eebfe796-+-Include kafkatee::monitoring on analytics1003

aa33ac3236-+-Bring more udp2log filters over to kafkatee on analytics1003

daf3be769a-+-puppet: hiera backend for the WMF

e63af393f0-+-Merge "phabricator: Set base-uri to https for labs" into production

13aebc6d12-+-phabricator: Set base-uri to https for labs

2aac127382-+-Merge "Ensure cron absent for misc::nfs-server::home::backup" into production

178f90ed82-+-Disable IPv6 global autoconf if explicit addr config for interface

8076191564-+-add all ytterbium addrs to git repl rules

c849ac98f4-+-add neon v6 mapped to net constants

94b92641ce-+-add ip6_mapped addr for neon

48ed90ec26-+-assign codfw DBs to s[1-7]

13775398c4-+-Remove dead protoproxy entries completely

95ad7b5277-+-add login-lb to eqiad protoproxy

790945b11a-+-Remove dead addrs from protoproxies

1df461cb65-+-Need network::constants to render ferm defs.conf

296f9013f0-+-Render defs.conf for ferm on zookeeper servers

601b8bbe80-+-add textsvc/uploadsvc in ulsfo for consistency

f88264abfa-+-Include ferm class on zookeeper servers

02f4dd63a1-+-Add ferm::service rule for zookeeper admin port

74d581f7f5-+-For regular webstatscollector installs, use latest version

996f4f269e-+-remove dead esams donatelbsecure

f42a7700a1-+-remove old mobile/bits addrs in eqiad+esams

514b31f27c-+-Use $labs_finger as default $master finger in salt role

48c02ef873-+-salt: fix scoping and cluster definition

3035205ed5-+-Sanitize text-related addrs for eqiad

901408ca62-+-Remove eda1::0 from esams protoproxy completely

99db7efa4e-+-wikimetrics: Put mysql data in /srv, use mysql::server

3c8b1d3c56-+-Flip ed1a::0 and ed1a::1 in protoproxy

e4a352c415-+-prepare db1036 for upgrade

df6aa8e127-+-Remove salt-minion.override

a31fd69292-+-Fix-up for param name and leading whitespace in Id158f154

b0ca92dcfc-+-Clean up salt::minion

f1dab8299b-+-Clean up salt::grain

6f248ab96c-+-Merge "hhvm: add comment about translation cache" into production

3b03ccf7e8-+-Update topology for es2 master switch. Disable snapshots on es1007, temporarily switched to on db1004.

214f33638f-+-prepare es1005 for upgrade, part 2

f9ad4bbe15-+-prepare es1005 for upgrade

fbb766a192-+-hhvm: add comment about translation cache

132038174a-+-mediawiki: add some in-line documentation

a3bcec432c-+-labs: update /data/project/apache/common-local -> /srv/mediawiki

791dd25e5a-+-Merge "racktables - apache, load mod_headers" into production

e172d3994a-+-racktables - apache, load mod_headers

cd528960ec-+-deployment: remove declarations of obsoleted paths

fb8a18da49-+-mediawiki::scap: update for I083d6e58e

7e3471f30b-+-Merge "decom /etc/cluster file on app servers" into production

4153e73e59-+-disable wmfusercontent.org site on misc for now, nginx borked

a04e86e49b-+-Merge "need to have ca certs for globalsign" into production

e6360df351-+-need to have ca certs for globalsign

6e34ba734d-+-Merge "SSL certs - add class for GlobalSign CA" into production

a78626e071-+-SSL certs - add class for GlobalSign CA

527e79b2ad-+-Merge "fold deployment::vars into mediawiki::scap" into production

08e79cdaf3-+-Merge "ssl certs - configure CA for wmfusercontent.org" into production

40c1ad76bb-+-fold deployment::vars into mediawiki::scap

e6bf667c9b-+-ssl certs - configure CA for wmfusercontent.org

b2018c411c-+-merge regression fix & re-enable GELF logging

3bb1e88433-+-decom /etc/cluster file on app servers

25b8ee4641-+-Cleanup: remove old 'localssl' nginx site

7abd1e1fd1-+-Replace role::cache::ssl::wikimedia with an SNI capable role::cache::ssl::misc

5063e03535-+-Merge "Rename MW_COMMON{_SOURCE} vars" into production

4e5e80d9dd-+-Rename MW_COMMON{_SOURCE} vars

5bf8ee85ad-+-define codfw recursive DNS

f41d6794b5-+-Merge "Add protoproxy::localssl default_server and server_name parameters" into production

ca666a18be-+-Add protoproxy::localssl default_server and server_name parameters

fd527ce701-+-Remove unused dns_auth LVS defs

d4a776bbc7-+-Use the protoproxy::localssl $name as nginx site config name

2f726731f5-+-Replace role::cache::ssl if statement with a selector

5b3980fbb8-+-mediawiki::sync: re-declare deployment paths

c4ba41becc-+-Merge "Wikitech: update paths for /srv/mediawiki" into production

8f9cefdece-+-Wikitech: update paths for /srv/mediawiki

e5a40005c5-+-Merge "toollabs - IRC notifications for labs" into production

0beecffe8d-+-Merge "beta - IRC notifications for the QA team" into production

f139adff6d-+-toollabs - IRC notifications for labs

291a71ebbd-+-/fully/qualify/path/to/mwscript

dc18fe1309-+-beta - IRC notifications for the QA team

8e55e1db38-+-tools: Install libvips* only on precise

4466b7f4b0-+-mediawiki: update remaining path references for /srv/mediawiki

73be67b4ff-+-Merge "androidsdk: Specify required libraries for trusty as well" into production

36b03c72bd-+-Merge "graphite: Don't realm branch in graphite role" into production

220fb322e6-+-androidsdk: Specify required libraries for trusty as well

ff45467cde-+-Remove MW_DBLISTS config vars

92c1d0bc72-+-graphite: Don't realm branch in graphite role

26136dd62a-+-Merge "phab legal compliant footer" into production

5bbd74ee0f-+-Merge "labmon: Add monitoring for CPU usage on toollabs" into production

0e7526bf84-+-phab legal compliant footer

0a9b3f6264-+-update labs phab to phT172 (footer needed)

9f88b71a75-+-labmon: Add monitoring for CPU usage on toollabs

b6b6e668be-+-pybal: serve the virtualhost with pybal lb files with a dedicated vhost

298b31b503-+-gerrit - raise HSTS max-age to 1 year

42afb4f7db-+-icinga: Move production 5xx checks to the prod role

85e9e44854-+-Set ns1 hostnames to ns1-$real_hostname

b5bf6b35aa-+-Merge "labmon: Add puppet freshness check for betalabs" into production

47cc39d982-+-Merge "labmon: Add low space check for / on betalabs" into production

3a4ddcb36b-+-Merge "labmon: Use a common prefix for betalabs icinga checks" into production

7cd56acfd4-+-Ensure cron absent for misc::nfs-server::home::backup

ddba53401f-+-labmon: Add basic monitoring for toollabs

cd120f118b-+-labmon: Add puppet freshness check for betalabs

68fe9386b6-+-labmon: Add low space check for / on betalabs

659bc37ae7-+-labmon: Use a common prefix for betalabs icinga checks

5a7a514865-+-Purge the amanda-server packages/configurations

dedbf2a641-+-Merge "wikistats-crons for updates of sourceforge, orain" into production

6f4034322e-+-wikistats-crons for updates of sourceforge, orain

c1bcd7eb14-+-webserver - use ssl_ciphersuite in generic_vhost

4a21e6498f-+-Merge "delete "check_bad_apaches" monitoring" into production

8fc62ec315-+-Merge "contint-use apache::site,move config to templates" into production

13b0dd4978-+-delete "check_bad_apaches" monitoring

a96b4aaf67-+-Merge "remove 'virt cluster pmtpa' from ganglia" into production

cc7a75f2d9-+-add esams.wmnet to search in resolv.conf

5790215439-+-icinga: Add graphite_series_threshold check

bb9d1c9d43-+-Run mw maintenance jobs as 'apache' rather than mwdeploy.

9a8422b346-+-Remove the backup::client class

36dad81a06-+-Remove all already absent backup::server crons/schedules

fa53432262-+-Purge all backup::client related packages/confs

453e3c9907-+-swift: separate access log from general log

b2340f858d-+-Merge "put racktables behind misc. varnish" into production

c4ad7a67bd-+-put racktables behind misc. varnish

1c0da5c30a-+-contint-use apache::site,move config to templates

99a90b7db3-+-Merge "contint: migrate localvhost to apache::site" into production

ea2a8f1d99-+-phab dont apply migration tools just yet

c9d2734f61-+-Merge "contint: switch localvhost to apache::conf" into production

2c05282ccc-+-remove git-core from phab as dupe w/ standard

2ad0a8b7c8-+-standard no-exim for iridium

ca449b97b5-+-phab path fix for migration tools

b048a5585f-+-phab tools for migrating content

f71fd596b4-+-beta: switch to /srv/mediawiki

220f6fe8d8-+-fix baham ns IP

0b70d0b55c-+-add domain_search wikimedia.org to terbium

eb76f320e7-+-Merge "releases: allow uploads from tin" into production

ea34f60f91-+-remove 'virt cluster pmtpa' from ganglia

b6053a76f4-+-Set up sampled-1000 output for kafkatee on analytics1003

c8a85a3103-+-Fix for mobile-100 kafkatee output filter

9f59048618-+-Increase queue_buffering_max_ms again to cover for 10+ second pauses on analytics1021

25a3e56a61-+-Manage varnishkafka rsyslog conf file with puppet

aa3f61196b-+-Fixups for servermon

e08b89d37f-+-Add baham (future ns1) config

0ff815303f-+-module/role class for servermon

366e175a31-+-Ensure backup::client configs absent

84ad148fec-+-Directory removal needs force => true

f779115bee-+-Merge "Ensure amanda configuration absent" into production

41e5319ae8-+-Remove the puppet freshness check

16f5b9390c-+-Ensure amanda configuration absent

1c3eb2bdf7-+-releases: allow uploads from tin

f2476755bc-+-Ensure amanda schedules absent

6fb76e7b65-+-HAT: turn off mod_php

d09df834e7-+-Merge "ishmael behind varnish, make neon a backend" into production

a752953f6c-+-ishmael behind varnish, make neon a backend

0d3c548465-+-Merge "mediawiki: /usr/local/apache/common-local => /srv/mediawiki" into production

586f70d066-+-Merge "public_html directory service, see RT #6862" into production

374dacb774-+-Merge "jenkins: retab + some linting" into production

08e15680f0-+-tcpircbot: add tin's IPv6 in ferm rules

9e95c74e04-+-Revert "Assign recursive dns roles to acamar/achernar"

a9dd692f66-+-Assign recursive dns roles to acamar/achernar

025ef0a661-+-puppetize icinga tmpfs mount in prod

30696af4d0-+-beta: use HHVM everywhere, get rid of mod_php

8ab60f6987-+-image scalers: bump workers limits

04b2a74586-+-manage phabricator extensions

f15109ae22-+-add python-phabricator package to phab module

a5ea9b311b-+-public_html directory service, see RT #6862

157ed0d3c5-+-Check DSH groups once in 60 mins

d002bbf676-+-Typo fix for Id1143c335

23473b93e0-+-redis: make /srv/redis the default directory

709efe0a1e-+-Merge "Assigned rbf100[12] to the redis role" into production

69322ed601-+-Assigned rbf100[12] to the redis role

24f1911f75-+-Merge "fix typo in dsh group monitoring command name" into production

3d9b106f5e-+-fix typo in dsh group monitoring command name

ca8238b60f-+-labmon: Monitor for low disk space in /var for betalabs

16ab4ec585-+-mediawiki: /usr/local/apache/common-local => /srv/mediawiki

51ee3332df-+-Merge "Monitor mediawiki-installation DSH group" into production

00871cd61b-+-Monitor mediawiki-installation DSH group

47846a3c6c-+-Setting max celery concurrency to 24

5392520350-+-puppet-compiler: fixups

248ec63395-+-puppet-compiler: alleviate disk space problems

8e35c26ccd-+-remove db1004 from s4 (previously depooled)

68a55a5d6a-+-monitor replication on mariadb 10 slaves

c06cd1025e-+-prepare es1002 for upgrade

7452ffc760-+-prepare db1062 and db1068 for upgrade

552c72f1c7-+-Merge "fix swift eqiad-prod container monitoring" into production

8f868c842b-+-fix swift eqiad-prod container monitoring

63c8e1b2e3-+-Revert "Puppetize icinga log file permission fix."

dd4aec1497-+-check_graphite_threshold - fix wrong usage info

6315806e10-+-gerrit: Enable StrictTransportSecurity max-age=7days

1552a80e88-+-fix beta labs puppet fail monitoring

ee0c633391-+-Puppetize icinga tmpfs mount.

ce495e30fa-+-Merge "Puppetize icinga log file permission fix." into production

13cba8225b-+-mediawiki::monitoring::errors: add owner/group/mode

a164b1a563-+-mediawiki::monitoring::errors: report to statsd

86069e5b27-+-Puppetize icinga log file permission fix.

17008427f2-+-Merge "icinga-wm - configure to also serve #wikidata" into production

2927ff4ab3-+-icinga-wm - configure to also serve #wikidata

6416fcceae-+-Merge "Consolidate python-redis package declarations in ::redis::client::python" into production

a336a7f20e-+-Merge "icinga check wikidata: use new contact group" into production

e5c4b328e8-+-add $default param to phabricator::mailrelay

9381713d08-+-Revert "Revert "phabricator better email relay settings""

0844c50b04-+-Revert "phabricator better email relay settings"

cfac7413a3-+-phabricator better email relay settings

ad641da2f4-+-Consolidate python-redis package declarations in ::redis::client::python

c261b99025-+-Remove $wgDBpassword from wikitech private settings

a64805b159-+-Installing libbz2-dev on stat servers.  RT 8278

5a89a87ca7-+-trebuchet::packages: s/hardy/lucid/

7aefda7fa4-+-trebuchet::packages: fix conditional install

f6f9f3d0dd-+-trebuchet::packages: use ensure_packages from stdlib

53c2cb9b5c-+-icinga check wikidata: use new contact group

724bd55def-+-labmon: Add http:// prefix for graphite URL

5b6fd92c6f-+-rcstream: remove duplicate package declaration

aae399604c-+-remove breaking comma from swift monitor

5457f87af0-+-Merge "wikidata monitoring - work-around wrapper" into production

74597a2101-+-wikidata monitoring - work-around wrapper

fb122aa035-+-Merge "icinga: Set default value for from in graphite threshold checks" into production

16ecc5d707-+-Change our mediawiki crons to use the new mw install in /usr/local

c7d75f048c-+-mediawiki::hhvm: set docroot to /srv/mediawiki/docroot

20ad9acb3e-+-Merge virt1000 apache config back into wikitech apache config

d1c979dc5a-+-Add misc::deployment::common_scripts to nova controller.

d8a9069b00-+-reduce number of dumps we keep, need moar space

8fc0074806-+-mediawiki: Create /srv/mediawiki symbolic link

f3b8db8098-+-snapshot: change $apachedir to /usr/local/apache/common-local

05d06cf74c-+-rsyslog: ignore 50-default.conf instead of provisioning it

e124236b5e-+-add missing misc_ulsfo hostgroup to Icinga

5b43d1e622-+-Buffer up to 10 seconds on varnishkafka to account for possible long leader election times

a310b0a76c-+-mediawiki: move definition of /a/common to misc::deployment

591275b58f-+-icinga check wikidata: avoid double quotes

3aac5a2b13-+-set required variable "from" for labs graphite

8e6ad3f70b-+-nutcracker: make configs notify service again

1c4c386bb5-+-icinga: Set default value for from in graphite threshold checks

400b10cd9e-+-Ensure varnishkafka rsyslog file does not get removed by rsyslog module

4b5832eab0-+-Merge "labmon: Pass 'warning' threshold to betalabs puppet check" into production

8f9b94d5b8-+-Merge "Split private wikitech settings files into two." into production

c858552945-+-add missing misc_esams hostgroup to icinga

c5ce2c8a8f-+-labmon: Pass 'warning' threshold to betalabs puppet check

026758c5c0-+-Merge "labmon: Setup icinga alerts for betalabs puppet failures" into production

924e71b9dd-+-labmon: Setup icinga alerts for betalabs puppet failures

2a4c738499-+-Ensure that dependent packages for Trebuchet are installed

1a25c64401-+-icinga check wikidata: escape arguments

2f140ba935-+-releases: fully qualify sudo command

52c4169fe8-+-Merge "releases: do not include hostname in sudoers.d" into production

efa57f36a6-+-swift: check high load average on backend machines

2fb968bae5-+-Merge "Assign all hosts to a nagios hostgroup" into production

adc1d24c84-+-phabricator email relay to task creation

a57709181b-+-phab::mail renamed to phab::mailrelay

ac7310c1e2-+-iridium exim roled for phab

442d22b888-+-OCG-raise monitor threshold for output file size

7744626acf-+-Merge "Tool Labs: add php5-xdebug to exec environment" into production

fba126b89f-+-wikitech: specify correct port for memcached instance

86aae3080e-+-Tool Labs: add php5-xdebug to exec environment

77a05cc7f2-+-labmon: Send metrics from all projects to labmon1001

a4e0fc3efb-+-Merge "Add icinga check for wikidata dispatch lag" into production

49793fd5ae-+-Add icinga check for wikidata dispatch lag

8d67f48d05-+-Uncomment include of role::analytics::kafkatee::webrequest::webstatscollector on analytics1003

f2e28c89ad-+-Bring in recent changes for production webstatscollector to test kafkatee webstats collector on analytics1003

3ac0d4cddc-+-ganglia - make codfw use ganglia_new::monitor

e0268b4db6-+-releases: do not include hostname in sudoers.d

fdc1542149-+-Assign all hosts to a nagios hostgroup

7a1783cb42-+-Merge "elasticsearch: deploy shard percentage check" into production

f8e881da65-+-mediawiki::packages: remove libtidy-0.99-0

816fc32fb8-+-beta: manage virtualhosts via puppet

527dc8cf7e-+-Merge "mailman: leave used_languages alone, use site_languages" into production

b7f017f7b9-+-Mariadb 10 slave config changes. - Prepare for engine-independent index statistics - Enable extra port 3307 in case of emergency - Remove deprecated innodb setting

6692305672-+-assign db1044 to s3

9d96b41b0b-+-disable gelf due to problems with hive

6a1b2149dd-+-Split private wikitech settings files into two.

0662f27dd5-+-Remove packages duplicated in ::mediawiki::packages::php5

9f91aff7e7-+-Include mediawiki::packages::php5 in nova controller role, for mediawiki

aca6debc46-+-Add codfw subnets (now: remove pmtpa IPv6 networks)

fe9f7239a7-+-Add nutcracker to nova controller role

0f016f661a-+-virtualize monitor host for wikidata monitoring

1ad98eb423-+-prepare es1001 for upgrade

fc65675472-+-reassign db1071 to s5

a709dbe6c1-+-Lower the priority for virt1000 vhost

1eb86ceb93-+-Stab in the dark:  Move the virt1000 vhost to openstack.pp

ce18ead9ba-+-put standard class back on amslvs[1-4]

c92e6bff9e-+-Puppet LVS cleanup

2e597539e6-+-Add temporary virt1000.wikimedia.org.erb for wikitech migration to multiversion

7474917c6f-+-Remove most amslvs[1-4] references

fa6c3f8f17-+-hhvm: do not autoupdate packages

f090aaa4bd-+-Labs: provide saner nscd defaults

69a0a031bb-+-prepare db1067 for upgrade

b7a312fd48-+-prepare db1035 for upgrade

9762ba4819-+-Merge "Add DNS views in ganglia" into production

4d11a580a7-+-elasticsearch: add python-requests dependency

12911e75ce-+-wikistats - add cron for gamepedia updates

bc8e348592-+-hadoop: re-enable gelf logging with config update

7ba6cf0d4f-+-Merge "wikistats - fix typo in cronjob name" into production

aa4a46e31b-+-wikistats - fix typo in cronjob name

707cc84471-+-mediawiki: add packages::fonts and packages::multimedia

0d98b67b73-+-labmon: Collect metrics from tools

12f6028b02-+-labmon: Send diamond metrics from labs to labmon1001

5a715f8069-+-tools: Add python-sh package to exec_environ

1c657b3c78-+-Add DNS views in ganglia

132fa4f426-+-reassign db1070 to s4

ff186f0f54-+-ganglia-aggregators on install2001 as data sources

3e2fb5e6eb-+-Move scap files back to /usr

62bdfe0577-+-Merge "install2001 - just incl. base, not standard" into production

6ae5ea86bc-+-install2001 - just incl. base, not standard

afc0508508-+-Merge "do not set $cluster on install2001" into production

18be95cfeb-+-do not set $cluster on install2001

f04771b1f4-+-Merge "add ganglia_new aggregator to install2001/codfw" into production

787d7fe24e-+-add ganglia_new aggregator to install2001/codfw

c993ebb843-+-icinga - add monitor group for misc codfw servers

8d9f103ce9-+-allow codfw networks to send snmptraps to icinga

9a105acdf7-+-Link /usr/local/apache/common-local to /a/common-local

e2f229a3c1-+-adding in install2001 as a aggregator data source

f62e5b74bc-+-Disable darkconsole on legalpad.wm.o

833b2c9765-+-graphite: Only send data from betacluster to graphite.wmflabs.org

3618bb8c30-+-Merge "mw-rc-irc - actually use the Apache class" into production

c2a7dfbdc7-+-adding admin class to bast2001

bd6265db75-+-mw-rc-irc - actually use the Apache class

32e3695eb7-+-Moved ::mediawiki::sync to the Openstack manager class.

572819b040-+-Add ::mediawiki::sync to virt1000.

fad2c8f6eb-+-point phabricator to main es

8e51ecc204-+-Set uid, gid and mode options for webstats-collector tmpfs mount

cdc0d0cdfb-+-$domain_search: convert to an array of values

6ed4ad8c1b-+-lvs200x initial puppet config

15600db4ef-+-Merge "install params for bast2001, also updating domain_search bastions" into production

c233f0a915-+-install params for bast2001, also updating domain_search bastions

0a099fd936-+-phabricator elastic search logic

ffe80382e7-+-mediawiki: use 'udplog' service alias instead of hard-coding fluorine

715b9fa520-+-Merge "download.wm.org - use apache::site method" into production

a65343eaa7-+-releases: setup tin to upload

48fafa4ddc-+-Run refinery-drop-webrequest-partitions every 4 hours

06e2be0852-+-Merge "add ssh-based uploads to releases.wikimedia.org" into production

1927835856-+-add ssh-based uploads to releases.wikimedia.org

39e8a72707-+-Run webstats collector in a dedicated tmpfs directory

241a9d0f1e-+-puppet: fix duplicate declarations

5620a00515-+-Add oit to lead and polonium RT8214

e74ba5c421-+-mailman: leave used_languages alone, use site_languages

db6745bf6a-+-Mathoid role for production

6bf3b2e0fe-+-wikistats - add cron for w3c table updates

5ee33b8946-+-download.wm.org - use apache::site method

bf08813010-+-Merge "mw-rc-irc - use apache::site" into production

d456f16832-+-puppetmaster - use ssl_ciphersuite

ba8518c9d1-+-Merge "gerrit - use apache::site" into production

a76e903528-+-gerrit - use apache::site

b31cfe0136-+-Drop write and execute on webstatscollector's upstart configuration

240c916561-+-Fix dependency on webstats-collector.conf init file

eb4c40eac7-+-Merge "install2001 site.pp entry" into production

6811f17a07-+-install2001 site.pp entry

f547e5654c-+-Correct webstatcollector's upstart name

81a00d0153-+-Merge "Run webstats collector in /run/shm to reduce disk io for temp files" into production

0f1d56f1c9-+-Merge "adding in codfw realm in ganglia" into production

c0c5e2dd16-+-Run webstats collector in /run/shm to reduce disk io for temp files

67eace2904-+-adding in codfw realm in ganglia

936b9c1f15-+-Revert: Phabricator files domain

489aef84d5-+-Hadoop: Logstash: send to logstash1002

80e1e72f07-+-Revert "Provision role::jobrunner on osmium"

8b66d90ba4-+-Merge "stats: Setup rsync for stat1002 as well" into production

b8ec7f48f6-+-stats: Setup rsync for stat1002 as well

cb4b59d550-+-Revert "ensure hhvm is stopped on osmium"

841d9e8866-+-Provision role::jobrunner on osmium

e5b2a54036-+-ensure hhvm is stopped on osmium

de42eafdd6-+-Add codfw in various places

e922624cd7-+-Add mediawiki::packages::php5

4a3147233b-+-Merge "quarry: Add python-translitcodec package" into production

ecd2b2b6a9-+-quarry: Add python-translitcodec package

98155c1ba5-+-Merge "Gerrit: Remove no_apache parameter, unused" into production

26ed8d3eea-+-quarry: Add python-unicodecsv module

82cab341b6-+-Disable gelf logging temporarily

65b960f4d6-+-elasticsearch: deploy shard percentage check

e529225bf2-+-Configure wikimetrics' replication lag checking

c74c686917-+-reassign db1054 to s2

593bc221bc-+-Add private wikitech settings to /a/common/private on tin

4e407f7214-+-phab security.alternate-file-domain needs http://

c407a83f44-+-prod phab settings update

ca36c3541a-+-Merge "Turn on elasticsearch row awareness for shard allocation" into production

b3caef71a0-+-Merge "Tool Labs: add melt" into production

c39712a9e0-+-Turn on elasticsearch row awareness for shard allocation

03b0d001b4-+-Revert "mediawiki: HAT appserver should turn off mod_php"

38184b77ba-+-mediawiki: HAT appserver should turn off mod_php

153c91e701-+-Tool Labs: add melt

5d5d1d0a36-+-beta: specify weight param in nutcracker config

a6cffb80f4-+-Gerrit: Remove no_apache parameter, unused

54b68e4bc2-+-Merge "noc.wm.org - use ssl_ciphersuite" into production

60f4cd93b4-+-Temporarily disable webstatscollector puppetization on analytics1003

30cee6859d-+-Remove special-case test, enable Hadoop->Logstash in the role

9f2375f365-+-Fix deployment server override variable name

d5ee8582b4-+-Merge "jobrunner: use trebuchet package provider" into production

539b847900-+-apache: when sourcing env-enabled/*, redirect stdout to stderr

fa21a46088-+-Merge "hhvm: dedupe mysql config key" into production

f0cc6d2943-+-mediawiki::sync: run sync-common unless InitialiseSettings.php exists

e7eecf7b36-+-Set varnishkafka queue_buffering_max_ms to 5 seconds

1365625987-+-Don't include ::diamond in apache::monitoring

44912f7f77-+-ssl proxies: use ssl_ciphersuite

ef7a239bad-+-tools: Add texlive to exec_environ

23606a2cc6-+-mw-rc-irc - use apache::site

b38e08f3fc-+-hhvm: dedupe mysql config key

32f9f13f48-+-Labs: point /public/dumps to the new server

b4a68a5181-+-Remove IPv6 address from fenari

cd4b32f90b-+-jobrunner: use trebuchet package provider

18f94dfe7f-+-tools: Install package python-pygments

43067733b5-+-Merge "Use Trebuchet package provider for scap" into production

3593d0aaa7-+-Merge "wikitech - use ssl_ciphersuite to add HSTS" into production

0650026024-+-declare hhvm_appservers lvs service ip for labs, too

17d1aedeb6-+-Send filtered logs to webstats-collector over network

c5ab582192-+-kafkatee webstatscollector only needs mobile and text roles

e4c730d4e8-+-Move misc udp2log instance (sqstat) from analytics1003 to analytics1026

badb4f7d28-+-Use Trebuchet package provider for scap

90b2cf5ff2-+-Use Trebuchet package provider for RCStream

92c56bf3c4-+-Add 'trebuchet' package provider and role.

d8ecff7e69-+-Run webstatscollector (modified) with kafkatee on analytics1003

8b80a03f9b-+-mediawiki: restore scap symlinks

d970558a5c-+-Reassign db1053 to s4

00f3880034-+-Merge "contint: phpcs mw standard on labs slaves" into production

9f05ccc02d-+-Add cron job to drop old data in HDFS

6fabc384b2-+-contint: phpcs mw standard on labs slaves

dcbc944096-+-contint: migrate localvhost to apache::site

785f3aebd5-+-contint: switch localvhost to apache::conf

9a2ee147ca-+-Trusty app servers should use HHVM app server LVS pool

a7b1c50076-+-Add monitoring for LVS service hhvm-appservers.svc.eqiad.wmnet

6e7fc4d30a-+-Create internal LVS cluster 'hhvm_appservers'

825644a53e-+-Separate HHVM app servers backend.

66fe20b563-+-Merge "gerrit - use global ssl_ciphersuite settings" into production

918c590709-+-Merge "OTRS - use ssl_ciphersuite" into production

53060458c6-+-Merge "bugzilla - use ssl_ciphersuite to add HSTS" into production

6c54296c8e-+-move mailman queue monitor script to /usr/local

ab287e45e3-+-fix typo in mailman queue check path

754c5d5dc9-+-fix mailman queue monitoring

65673f992a-+-Merge "mailman: search for a new string on new web ui" into production

62a4785ea2-+-mailman: search for a new string on new web ui

0c31918f87-+-mailman: use a new default theme (prettier mailman)

25d463f126-+-kafkatee should consume from all partitions

1228a0149c-+-swift: raise container availability thresholds

894aab77eb-+-wikistats - ensure php5-mysql is installed

ec26f3acd2-+-Revert "stats.wm.org - use ssl_ciphersuite"

d7e8f583b7-+-stats.wm.org - use ssl_ciphersuite

edbea07e6f-+-Merge "wikistats - install deb package locally" into production

a8767b3b58-+-Merge changes I8f037684,Ib9f31a33,I0e16e5a8 into production

3c6c2c207c-+-Merge "mailman: new languages" into production

c1912b3ba1-+-stats: Install sqlite3

b868d71a85-+-nrpe::monitor::service -> nrpe::monitor_service

aa5cdd9318-+-Merge "contint: monitor tmpfs mount on production slaves" into production

0a974d78e5-+-contint: monitor tmpfs mount on production slaves

a1fa354cab-+-wikistats - install deb package locally

29e51d4313-+-mailman: new languages

e75a2b05c5-+-wikistats - add mariadb-server class

fa4a219de8-+-Merge "stats: Add python-pygeoip and python-ua-parser" into production

fad80d00ed-+-Merge "wikistats - rm broken namevirtualhost setup" into production

af0e5b32df-+-wikistats - rm broken namevirtualhost setup

07306de517-+-Merge "wikistats - fix user/owner for docroot,logdirs" into production

95d1f84988-+-wikistats - fix user/owner for docroot,logdirs

e39063d573-+-Merge "wikistats - use correct user for cronjobs" into production

4be8e24722-+-wikistats - use correct user for cronjobs

29c927692f-+-Merge "fix group name for wikistats systemuser" into production

7473ffa1fc-+-fix group name for wikistats systemuser

f7376c40f4-+-Merge changes I603d656a,I7525d4dd into production

c7f0798f68-+-stats: Add python-pygeoip and python-ua-parser

07a5f6474c-+-Merge "beta: Change auth realmmessage for logstash-beta" into production

aafdcad354-+-beta: Change auth realmmessage for logstash-beta

6e15e6eb7d-+-Fix for Infinity error on stat1002

acf0ff0ddd-+-More debug notify statements in search of Infinity error

77facdca2b-+-Merge "ganglia - use ssl_ciphersuite" into production

46d93aa632-+-Comment out memory_per_container_mb calculation, trying to get to the bottom of this Infinity error

b87ef7b2dc-+-Temporary debug notify statements to find 'Infinity' on stat1002

bc5e268772-+-Fix for -Xmx opts Hadoop propeties, need to add units

33842c79e6-+-Merge "subversion - use ssl_ciphersuite" into production

f9ec50f641-+-Fix for variable $::memorysize_mb in hadoop role

a42dd1e326-+-Merge "etherpad - use ssl_ciphersuite" into production

b91bb9a1e3-+-Tune YARN and MapReduce memory settings

f6638c8edd-+-Dumps: reenable labs rsync

e2c0dee0d8-+-Add virt1009 to the eqiad virt pool.

02c1f05bba-+-labmon: Fix dependency rename miss for graphite role

d4c00c81fb-+-labmon: Split role::graphite into base role and prod/labmon roles

e59c4c79a9-+-Merge "labmon: Fix typo in txstatsd role" into production

e57633bad9-+-labmon: Fix typo in txstatsd role

66a15e806f-+-Merge "labmon: Store graphite data in /srv/carbon" into production

5805afef86-+-diamond: enable on labs project 'integration'

6ecbd7289a-+-Split role::diamond  $labs_enabled_projects array

fb2a14b31f-+-labmon: Store graphite data in /srv/carbon

144c9413fc-+-Labs: add default domain_search to labstore*

acfe427427-+-Labs: give labstore1003 a (barebones) manifest

07018e0d90-+-labmon: Add labmon role to labmon1001

1b824365af-+-Merge "graphite: Fixes to work with trusty" into production

668e5e1d64-+-Crreot another file reference from I11b85c87a

1c23cee2c8-+-Correct erronuous file references from I11b85c87a

55cff64377-+-Merge "HHVM: improvements to logging" into production

92d9385cb8-+-tendril - use ssl_ciphersuite

7c0c1a28d1-+-OTRS - use ssl_ciphersuite

04744fcf10-+-bugzilla - use ssl_ciphersuite to add HSTS

32cf3bd640-+-metrics: remove broken dependency on Apache site

e7852747dd-+-Merge "metrics.wikimedia.org - use apache::site" into production

5d7ae7c96b-+-Merge "ishmael - use ssl_ciphersuite" into production

19f701dda4-+-ganglia - use ssl_ciphersuite

d2e59b68f2-+-Merge "rt - use ssl_ciphersuite" into production

e5cadda895-+-Merge "racktables - use ssl_ciphersuite" into production

167e98f609-+-metrics.wikimedia.org - use apache::site

6ac1c0fe64-+-Merge "Bring description of snapshot::wikidatajsondump in line with others" into production

426ae51a7b-+-Make permanent some elasticsearch settings

7245920b3b-+-labs instances default to local login

9f1d5eb802-+-Add search-roots access on zinc

9f7adf9480-+-Bring description of snapshot::wikidatajsondump in line with others

6875bcc241-+-graphite: Fixes to work with trusty

8d744b60ae-+-contint: proxy the colocated Gerrit instance

4838b01342-+-contint: website config on labs

2e25611e7c-+-quarry: Add a cron based query killer

d642130a79-+-quarry: Use mariadb 10

f138537112-+-HHVM: improvements to logging

53645ee921-+-take amssq33 out of backend texts lists

d313ca1e72-+-wikitech - use ssl_ciphersuite to add HSTS

f4f031a59a-+-noc.wm.org - use ssl_ciphersuite

b0ba65152e-+-rt - use ssl_ciphersuite

6382aacb73-+-etherpad - use ssl_ciphersuite

6467c25fc7-+-ishmael - use ssl_ciphersuite

8a2036e7e3-+-subversion - use ssl_ciphersuite

a95ce0fa55-+-racktables - use ssl_ciphersuite

49a279cb96-+-alternatives::config -> alternatives::select

cd3e5889e0-+-stats.wm.org - revert port config via apache::conf

e83c6569c7-+-Merge "wikitech - use ssl_ciphersuite" into production

55d87bd296-+-stats.wm.org - use apache::site

ffb7952691-+-Fix group parameter on cdh::hadoop::users class

d051000c21-+-Manage automatically HDFS user directories in multiple groups

47ed31a19f-+-MediaWiki/HHVM: log fatals to fluorine:/a/mw-log/hhvm-fatal.log

a913b4cb96-+-HHVM: use syslog; route to fluorine

f973ebf12e-+-/var/lib/mailman/templates is a link to /etc/mailman

0a466aa0bb-+-Merge "wikistats - use apache::site" into production

1601a59791-+-fix lighttpd reload command

f595c35e5d-+-Make lists.wikimedia.org HTTPS only

f5f65964cf-+-Bumped SlowQueryThreshold since the log is spammy and untruncated

b6ecd36ee5-+-Disable cdh::hadoop::users temporarily

2bb8528872-+-Merge "svn - move Apache config from file to template" into production

fea07f395d-+-Merge "ganglia - use apache::site" into production

126894eb23-+-Auto create HDFS user directories for users in a group

22afde1a4e-+-Merge "performance.wm.org - use apache::site" into production

c44b064a3a-+-add labmon1001 to site.pp

9bcac99a98-+-Include role::analytics::refinery::data::check on analytics1027

468d0ba8d7-+-Merge "ishmael - use apache::site" into production

1e8169d17d-+-performance.wm.org - use apache::site

8a05a7e97a-+-Merge "graphite - use apache::site" into production

d5667b747d-+-Revert "wmflib: add ensure_final_newline()"

04945e956f-+-wmflib: add ensure_final_newline()

2195fe921f-+-Merge "tendril - use apache::site" into production

5e30b0a7f4-+-ishmael - use apache::site

e14864fa0a-+-Override group permissions on /etc/send_nsca.cfg on Hadoop worker nodes

eaa440fe91-+-Increased the number of parsoid job runners to lower queue size

7965a48444-+-Additional python packages for stats servers

532a718ffb-+-nutcracker: used ordered_yaml()

9a77edb629-+-Nutcracker: move declaration to role::mediawiki; parametrize

dc4b27979e-+-Merge "beta: Set runners_* for role::beta::jobrunner" into production

80865bbda0-+-apache: change mpm dependency to work on trusty as well.

917272152f-+-jobrunner: use mpm_worker instead of mpm_prefork

09f2bea89d-+-apache::conf: append trailing newline if missing

f0306cd975-+-jobrunner: parametrize the port for the fcgi interface

a75046b19e-+-jobrunner: puppetize HAT runner

89d1946a80-+-Unmanage ports.conf, following I0e4aa8800

c01d744a91-+-puppetmaster - use apache::site

563e43ee70-+-svn - move Apache config from file to template

03fcc363bb-+-wikitech - use ssl_ciphersuite

abd9411559-+-gerrit - use global ssl_ciphersuite settings

c4fe671d76-+-wikistats - use apache::site

3164df7e5c-+-ganglia - use apache::site

b986a0b4a6-+-graphite - use apache::site

652d569b2d-+-tendril - use apache::site

a64123c2ab-+-openstack Apache conf, also listen on port 80

c7990e5da5-+-Merge "gdash - use apache::site" into production

31486712e7-+-Merge "openstack - use apache::conf for port" into production

9ed16b756e-+-Merge "kibana - use apache::site" into production

1041eab5f2-+-openstack - use apache::conf for port

8f5c32aace-+-wmflib: add validate_ensure()

f3aca29e51-+-Merge "Revert "Revert "openstack - use apache::site""" into production

9147665397-+-kibana - use apache::site

5b1aad6314-+-gdash - use apache::site

d23199a5c5-+-mediawiki: create common-local directory

5a3b82e0c3-+-Revert "Revert "openstack - use apache::site""

f27758f863-+-Create icinga::monitor::nsca::client class

053369443c-+-Revert "openstack - use apache::site"

851859c7f5-+-openstack - use apache::site

0e9aafa45f-+-Set up passive icinga for webrequest data imports in HDFS and Hive

5101798921-+-apache: add a 'replaces' parameter to apache::conf

86cb849a9c-+-Tools: Include mediawiki::multimedia::fonts in exec_environ

3d280090f5-+-Merge "Get rid of symlinks to scap scripts" into production

8ccd096d7a-+-Get rid of symlinks to scap scripts

1b9cebfc89-+-Add 'udplog' to $nova_dnsmasq_aliases

fcf5123160-+-puppetmaster: fix typo in scripts.pp

9115a16e13-+-puppetmaster: make reimaging servers easier.

caa52c4fc6-+-jenkins: retab + some linting

49ea85f19e-+-osm planet import/sync, make sure we use hstore

6751a5abb3-+-tendril: add access for ldap groups ops and nda

2cad95b204-+-Fix kafka & udp2log filtering of ZERO

caf701d669-+-New admin group for eventlogging troubleshooting.

10cb6ca62e-+-remove aluminium from sites.pp and dhcp config

0704a1eabe-+-salt-minion service should fail to start if master rejects key

76a2c38b62-+-Sanitarium sysv script + basic monitoring.

75bcddfb77-+-MariaDB 10 in the Sanitarium (pre-labsdb)

a9eb3472b0-+-Small lint-fix for hhvm.pp

18a39832a7-+-Enable mathoid deployment::target on beta

c839164693-+-osm: Enable ganglia diskstat plugin

6433773039-+-Merge "enable gelf logging from hadoop workers" into production

37be54a3e5-+-Merge "rm old puppet_disabled check,replaced by new chk" into production

5e9fad6b0a-+-rm old puppet_disabled check,replaced by new chk

552926572f-+-enable gelf logging from hadoop workers

8df79cd612-+-Merge "Hadoop role: depend on JARs for GELF, pass param" into production

7d8c357279-+-Hadoop role: depend on JARs for GELF, pass param

f73da31191-+-Merge "remove deprecated config related to fundraising/aluminium" into production

3f6b6e33b1-+-remove deprecated config related to fundraising/aluminium

e053aa37f4-+-Tools: Install libgd-gd2-perl

a4cf953778-+-Tools: Sort package lists alphabetically

7ed6935644-+-Tools: Install php5-imagick

fe78c3ac6f-+-Tools: Remove lint

ac3759d67a-+-Merge "Tools: Add some i386 compat packages to exec nodes" into production

41bae0de2e-+-Tools: Add some i386 compat packages to exec nodes

03a1cf35d8-+-Merge "Tools: Use apt::repository instead of file resources" into production

2a3c482e1e-+-Merge "zuul: typo in role::zuul::merger description" into production

3d3b897472-+-Merge "contint: analytics packages are not on Trusty yet" into production

d398ad9bfd-+-Merge "OTRS - use apache::site instead of file resource" into production

b1c1d9101f-+-Merge "noc.wm - use apache::site and move to templates" into production

a2f0ef6edf-+-Merge "planet - use ssl_ciphersuite" into production

239b04b594-+-Merge "role/parsoid - minor lint fixes" into production

38b373c695-+-Merge "sudo.pp - minor linting fixes" into production

ab1076b0f0-+-role/parsoid - minor lint fixes

2b603b3f3f-+-sudo.pp - minor linting fixes

9ceb6e4448-+-planet - use ssl_ciphersuite

07a7fa8245-+-noc.wm - use apache::site and move to templates

9c28326133-+-OTRS - use apache::site instead of file resource

de7e2c6bc7-+-contint: analytics packages are not on Trusty yet

f11a98195f-+-zuul: typo in role::zuul::merger description

852a8e1ab8-+-Merge "diamond: Enable stats collection for quarry" into production

f9617ca65b-+-kibana: add access for ldap groups ops and nda

d82345acee-+-diamond: Enable stats collection for quarry

7addf7f862-+-add (and use) shell_exports() and apache::vars

f9420ee369-+-Quarry: Add sqlalchemy as an explicit dependency

ed53966bc7-+-Merge "graphite: add access for ldap groups ops and nda" into production

fe46ea36f4-+-Merge "Allow ldap "nda" users to access ishmael" into production

ac0e6bef34-+-beta: puppet rebase script

60c01d2958-+-beta: Fix IP mapping for stream.wmflabs.org

290a6575ab-+-Merge "apache::def: port to env-{enabled,disabled}" into production

c21ee30f31-+-switch rcstream to source hash LVS scheduling

a91f8bc778-+-HHVM: simplify logging options

26bbb68185-+-apache::def: port to env-{enabled,disabled}

bd0681bc14-+-Distribute via.inc.vcl to Varnishes

9138a982e2-+-graphite: add access for ldap groups ops and nda

10a3060b0d-+-Allow ldap "nda" users to access ishmael

0ffb016f23-+-beta: Set runners_* for role::beta::jobrunner

6362aa78cb-+-Merge "restrict access to puppet logs to root users" into production

6137689981-+-restrict access to puppet logs to root users

5d2e7bb727-+-bugzilla: use ssl_ciphersuite

a85360d360-+-Merge "scholarships - convert to use apache::site" into production

d2f2fbc391-+-scholarships - convert to use apache::site

09b81cf396-+-add '|| true' to env-enabled/* glob

56d6702752-+-apache: add env-{available,enabled}

f180aa365b-+-Merge "fix Apache site setup for Bugzilla" into production

71e36e2243-+-mediawiki::hhvm: require 'apache' user

fbfcc9733c-+-Partially revert 9393f239ff, moving dist-check in-line

bba59db931-+-decom tantalum, former OCG QA box

781128708b-+-osm.planet sync up

7debc10594-+-HAT: fix class inclusion

33e63ab422-+-fix Apache site setup for Bugzilla

208b170658-+-mediawiki: basic HHVM monitoring

3dc4b22597-+-hhvm::admin: bring back $ensure

fd3ce6d0ca-+-hhvm: add process monitoring

4ef1ba7aca-+-hhvm::status -> hhvm::admin + small lint fixes

85d82e2c4e-+-hhvm: fix status

952ad52f05-+-Remove mysql_multi_instance from labsdb1003, for upgrade.

8928f9eb91-+-include nrpe on ocg100[*]

dc0f2a3722-+-remove ^check_ from name, it gets prepended later for greater redundancy

d19dadb22a-+-another stab at nrpe ocg health check config

838c63d682-+-grr, redo ocg nagios check foo, was all wrong

749f6223cb-+-HHVM: set a 5s graceful shutdown timeout

53b93fa35c-+-change from icinga to nagios-plugins as require for ocg plugin

403947c459-+-grr. hate virtual resources.

ada0ade246-+-Merge "make sure nagios ocg plugin gets installed in ocg::nagios::check" into production

856bd97587-+-make sure nagios ocg plugin gets installed in ocg::nagios::check

66bfd4f959-+-Revert "process monitoring for labsdb"

d995a2b223-+-fix site name for planet default site

066d0fc3c6-+-Merge "fix apache site setup for planet" into production

e0abcafd08-+-fix apache site setup for planet

f074e85f1b-+-fix variable reassignment error in ocg::nagios::check

8799247d2e-+-Merge "puppetize check_ocg_health nagios check" into production

757507c4b5-+-Merge "fix apache site setup for planet languages" into production

e5d262e4eb-+-fix apache site setup for planet languages

85804c35a1-+-puppetize check_ocg_health nagios check

3b0fb92109-+-Merge "fix Apache site setup for contacts.wm" into production

7cacee8326-+-fix Apache site setup for contacts.wm

d950078db2-+-Merge "fix etherpad-lite monitoring" into production

666ad7b7f1-+-Merge "osm: Move postgres datadir to /srv/postgres" into production

6175f092f3-+-fix etherpad-lite monitoring

3148b49bc3-+-Merge "enable firewall on ytterbium" into production

867c306a49-+-enable firewall on ytterbium

8129aa4d11-+-contint: rubygems is provided by ruby since Trusty

2ada2399f8-+-process monitoring for labsdb

8e21a349a8-+-mailman: monitor queue size

2e08f4eb0b-+-beta: Clone mediawiki/vendor instead of mediawiki/core/vendor

78fb5f3f6e-+-postgres: Followup commit for ebcb7cd

bd2774969b-+-Revert "Labs: switch dumps to the new server"

bf93830ac0-+-osm: Move postgres datadir to /srv/postgres

2466f676a1-+-Merge "Allow overriding postgres datadir" into production

407ab03956-+-HHVM: keep DSO path up-to-date; rename script

351113570c-+-Merge "HHVM: add hhvm-debug-dump script" into production

98938b47d5-+-transparency.wikimedia.org: set actual launch time

e16b546709-+-HHVM: add hhvm-debug-dump script

48de178aac-+-provision transparency.wikimedia.org

356ee2b829-+-HHVM: update dynamic_extension_path for new package

2c5f9de16e-+-HHVM: add ::hhvm::status

c27671146e-+-RT 7858: datasets Apache and Puppet edits.

ebcb7cd844-+-Allow overriding postgres datadir

84e444e84e-+-Group own refinery logs by analytics-admins, add hdfs to analytics-admins group

6b3655bd7c-+-Create analytics-admins group with qchris as member

7144d9842d-+-Create analytics-privatedata-users group

8d726b4499-+-puppet_compiler: remove python-pip declaration.

fc45abd7b0-+-puppet_compiler: use ensure_packages to avoid conflicts.

5b4e1d65f1-+-puppet_compiler: remove puppet 2, new version

3581f7814f-+-hhvm: Enable admin server

d7556aff1d-+-datasets... still trying to kill labs cron with fire... grrrrr

494a312b66-+-datasets: remove labs cron file deps when cron itself is not enabled

61e3992452-+-Merge "contint: tie android SDK packages to Precise" into production

3cd61c6ede-+-datasets: really turn off labs cron instead of pretending to

c68afc84e4-+-datasets: don't mount labs fs if cron using it is not enabled

b4ee927411-+-contint: tie android SDK packages to Precise

e7bdd66d3e-+-turn off dataset rsync to labs til labstore1003 mnt issue is fixed

cf99d1b917-+-HHVM: add explanatory comment re: runtime error level

55b24154d3-+-Merge "Set 300M memory_limit default for HHVM fcgi servers" into production

f573c2b0f9-+-Set 300M memory_limit default for HHVM fcgi servers

4e81e5312f-+-mediawiki: add envvars class, get rid of cleaning directive.

03013332da-+-fix file_line matching

70506364dd-+-Fix the envvars file to our specifications

f6679984bd-+-Revert "mediawiki: get rid of envvars files in puppet."

9ce64f38a6-+-mediawiki: get rid of envvars files in puppet.

29f4ec3b44-+-apache: remove $rejected_pkgs

dfe8899917-+-mediawiki: fix envvars permissions, remove cruft.

cc9bc06778-+-Tidy up after I4aa104920, dropping declaration of absented resources

0a47604cce-+-mediawiki: use HHVM module on trusty

c4a3168b0a-+-Let OCG do file cleanup

03ca7e47cb-+-mediawiki::web: get rid of envvars.appserver

283bf28215-+-Merge "quarry: Switch to halfak's mwoauth library" into production

702e6ba0e9-+-stats: Install php commandline packages to the crunchers

59aeb52749-+-beta: Remove require of Ferm::Rule['bastion-ssh']

64e9cde43f-+-Merge "Mathoid configuration for beta labs" into production

b45a1775b7-+-Remove source reference to mail.ini

ae09b1e141-+-Mathoid configuration for beta labs

fa4c0997cb-+-Merge "Removed exim errors_to to support custom Return-Path" into production

010400b575-+-Removed exim errors_to to support custom Return-Path

bc2f81ea72-+-Fix errors introduced in 487eead

487eeadd2e-+-etherpad: convert into a module

342fe22461-+-mediawiki: Redo cURL dispatcher config for jobrunner

3f2beeb4b1-+-Use the new "dispatcher" config format and use curl with HHVM

4bdfea04ce-+-HHVM: set hhvm.server.gzip_compression_level = 0

aee0ec4dee-+-HHVM: set an empty string as the value for hhvm.pid_file

2ce544aa2a-+-quarry: Switch to halfak's mwoauth library

502528c809-+-Labs: switch dumps to the new server

606cb4ce5c-+-HHVM: fix syntax of php_ini.rb and ini parameter name

0a4b97dac3-+-Merge "Rename pdf-render-admins to ocg-render-admins" into production

0310cf6823-+-Rename pdf-render-admins to ocg-render-admins

90e63f6773-+-Merge "Tweaks to HHVM module" into production

3de8b1b122-+-Tweaks to HHVM module

7d745a10d7-+-Setup labsdb1006, labsdb1007 as osmdbs

5761c870ff-+-Add HHVM module

d0c509ef44-+-Merge "swift:lint" into production

7181ae7c21-+-Merge "Role + Module for Quarry Labs tool" into production

aee7273abb-+-Merge "exec_environ.pp: Install libaio1 to enable asynchronous I/O system calls" into production

1dde47ba27-+-exec_environ.pp: Install libaio1 to enable asynchronous I/O system calls

05570a7757-+-swift: monitor object/container availability

2a10938603-+-Remove mysql_multi_instance from labsdb1001 after migration.

e0abe0d1dc-+-webnode.pp: Install LUA support for lighttpd (lighttpd-mod-magnet)

f6d6ab237d-+-Role + Module for Quarry Labs tool

0140d316a2-+-slow down default check_ganglia interval from 1 to 3 mins

892edebb61-+-fix tcpircbot group setup?

10fcf2d0e4-+-Increase hive.variable.substitute.depth to 10000

0efedcde99-+-Merge "deployment: wrap packages with ensure_packages()" into production

1c9b2b66a8-+-Merge "sudo privileges should be in array" into production

1c283475b2-+-mediawiki: re-enabling mod_filter

afc07d5fdb-+-fix duplicate inclusion of resource

eacabec175-+-Merge "logstash: Don't pin package version" into production

262375ee84-+-mediawiki: syntax typo fix, remove unused modules

7ca4fd235e-+-mediawiki fix service name

d55dd70505-+-swift:lint

e1d1db3710-+-deployment: wrap packages with ensure_packages()

61d553e644-+-mediawiki: fix typo (again)

0693be6668-+-mediawiki: fix typo

a2575813c7-+-mediawiki: fix issues with moving to mods-enabled

ca7b020c9e-+-apache: fix another merge fail

dbc34de0e6-+-apache: fix duplicate declaration

9393f239ff-+-mediawiki: use mods-enabled, prepare for HAT

8cf058a119-+-logstash: Don't pin package version

e6b4e595ee-+-Add explicit mmap addrs for varnish persistent storage

9cad7766c5-+-fix cp104[34] domainnames in cache.pp

5c39f699d2-+-Merge "Give OCG admins the ability to run things as OCG" into production

a47b78eb57-+-Remove DNS recursor on sodium

8a5d3e16e4-+-Add refinery deploy target to stat1002

5da7076801-+-statistics: Add packages for halfak

8141260fbf-+-apache: cherry-pick mods added in Ia46312071

9ff8c9a84e-+-sudo privileges should be in array

0509ac815e-+-Removed old jobrunner.ini file

b613047a48-+-Merge "Add extdist module + role for labs" into production

6c3b8c139d-+-Add extdist module + role for labs

cae5518a80-+-Give OCG admins the ability to run things as OCG

8f14fc7cdb-+-Remove resource ensure => absent'ed by Ie064cadf2

4a7eb4e5ab-+-Merge "mediawiki: add tidy resource for temp multimedia files" into production

2608e76724-+-Let gmond talk to ocg1001

901d2f5256-+-mediawiki: add tidy resource for temp multimedia files

99839ed292-+-Merge "mediawiki::jobrunner: Added JSON version of jobrunner config file" into production

0f7f270092-+-mediawiki::jobrunner: Added JSON version of jobrunner config file

3478a28a14-+-Merge "Tell gmond about ocg1001" into production

32eda15b6b-+-Tell gmond about ocg1001

460989f014-+-Re-enable varnishkafka delivery error alerts

ee972aed82-+-Merge "Add puppet module for a tor relay" into production

796aae7671-+-Merge "Revert "Declare OCG ganglia monitor group"" into production

a5e5f73127-+-Revert "Declare OCG ganglia monitor group"

96919b599d-+-Merge "Declare OCG ganglia monitor group" into production

498acb6961-+-Declare OCG ganglia monitor group

0127d23296-+-fix postmortem cleanup cron

4366375731-+-diamond: Enable for 'cvn' project in labs

365a875fe5-+-mediawiki::multimedia: stop managing /a/magick-tmp; provision fontconfig-config

a142f8fd63-+-Merge "apache2: rename apache2_test_config => apache2_test_config_and_restart" into production

23f71c00eb-+-Re-enable LuaSandbox on mw1053

96c0462b5b-+-Merge "ocg - fix logfile name and remove logdir" into production

f289c3da11-+-ocg - fix logfile name and remove logdir

e72568d554-+-Merge "Add a wikitech cron to send echo emails." into production

0abc5f97d7-+-Merge "All OCG servers should have syslog readable" into production

822bc119ba-+-All OCG servers should have syslog readable

aa6b9f7777-+-add parameter for logfile names to base::syslogs

007c02af3e-+-Merge "New packages and apparmor entries" into production

1d459712f8-+-Increased basic job runners by 1 per server

c23c497d34-+-New packages and apparmor entries

3bed30f25b-+-osmium: include admin w/group => deployment, per discussion with joe

69b09cddf3-+-increase /mnt/tmpfs to 32GB on ocg100*

e811cad58d-+-apache2: rename apache2_test_config => apache2_test_config_and_restart

a7ead8ef12-+-Use wikimetrics' new configurable pool sizes

c4d9b0bf58-+-Set authorization_service_authorization_enabled for Oozie.

a2b81e4a63-+-Install hive on hadoop workers to get hive-hcatalog packages

0aec70919a-+-contint: qunit local vhost needs mod_rewrite

aed876cf24-+-contint: /srv/localhost should belong to jenkins-slave

04d331f992-+-contint: setup localhost.qunit vhost on lanthanum

203304d1d2-+-Allow world read/write + sticky on ocg tmpfs

c1b998d6a0-+-add swift account for search backups

241449cc0e-+-beta::natfix removal step 2

ebe9339c25-+-Add a wikitech cron to send echo emails.

01f7c085ce-+-Remove mysql_multi_instance from labsdb1002 after migration.

61e651ed4f-+-site.pp - remove fresh tabs

55f6c4eb22-+-add missing monitor_group pdf_eqiad

860a85c31a-+-Revert "tools: remove libvips from exec_environ"

541754f9d2-+-Merge "remove more classes from aluminium, the less prod puppet the better" into production

66313a495b-+-remove more classes from aluminium, the less prod puppet the better

73972ae688-+-Update wikimetrics module, run with higher concurrency in prod

57b32f4404-+-Merge "Bump Parsoid backend connection limit" into production

e396386242-+-Merge "protoproxy: don't include apache::monitoring" into production

c267bc9b5d-+-protoproxy: don't include apache::monitoring

bda5587a88-+-Merge "Add OCG servers to the PDF ganglia cluster" into production

f71fa0d4fc-+-Add OCG servers to the PDF ganglia cluster

5e3f369cb9-+-apache::monitoring: add diamond support; ensure mod_status is enabled

09c57b00a2-+-Merge "Tools: Install user-requested packages" into production

22a332f8da-+-Tools: Install user-requested packages

1b744e5e40-+-statistics: Add packages for rgdal

5e4f185cfd-+-contint: install Zuul on all CI slaves

28f4e426de-+-Merge "Specify owner/group/mode for apache::conf" into production

eb4e34b3ed-+-Merge "zuul: allow gearman access from mergers" into production

26cc9748c9-+-zuul: allow gearman access from mergers

e6d3f56224-+-Bump Parsoid backend connection limit

68917c7d99-+-fixup for jobrunners

91e24a6891-+-phabricator => include apache::mod::php5

627e49afbd-+-Merge "Fix-up for Ic952146b5: check $mpm, not $selected_mod" into production

8630cc4d5b-+-Fix-up for Ic952146b5: check $mpm, not $selected_mod

c7009c322b-+-jobrunners: install the first hhvm jobrunner

8048b84552-+-fix template path for phabricator login message

fdd688d6ce-+-Merge "phab - configurable login message by auth type" into production

cb71b57475-+-Merge "the last tab char in any .pp file !?" into production

c79e4366f0-+-apache::mod_conf: add explanatory comment

a265abf0b3-+-apache: add apache::mpm

6e741a0199-+-Specify owner/group/mode for apache::conf

e977edd8c7-+-svn.wikimedia.org uses apache::site

1224c4c707-+-zuul: run install after packages installation

ccc32837ef-+-zuul: switch installer from setuptools to pip

2ecba5cfa1-+-zuul: switch to run as 'zuul' user BREAKING CHANGE

1d2d6c46ac-+-Prepare MariaDB 10 on labsdb100[13]

19e0232c1a-+-zuul: introduce 'zuul' system user

e93cb53c41-+-zuul: phase out zuulwikimedia

54486fad2b-+-zuul: remove $zuul_url from zuul::server

882ecc33ef-+-zuul: migrate settings to role::zuul::configuration

b6799c3b06-+-Merge "zuul: introduced config hash in role::zuul::configuration" into production

f070ffb8e0-+-Merge "swift - retab" into production

76c6984526-+-phab - configurable login message by auth type

ad8c559009-+-the last tab char in any .pp file !?

e16c86e40c-+-include 'bastionhost' on bastion hosts

3405c57a46-+-Add puppet module for a tor relay

ef2ece14a6-+-alternate horrible hack to make ocg-related logs readable to coders

28beee3de6-+-hack horribly to make it possible for coders to read ocg-related logs, ref. RT 7596

f9b6c8f945-+-Install jq on analytics clients

346607e72e-+-Merge "phab - small lint fixes" into production

b65bddc733-+-Merge "graphite::web: bump uWSGI workers from 4 to 8" into production

e7f8947fcb-+-rcstream: require ubuntu >= trusty

a5b287b557-+-wmflib: add funcs requires_realm() and requires_ubuntu()

c9822e3574-+-graphite::web: bump uWSGI workers from 4 to 8

84d56d189d-+-add tmpfs for ocg production role, minor ocg manifest cleanup

8d25d96761-+-Beta: fill missing $lvs_service_ips['ocg']

e6f867ead6-+-mediawiki: lint

f91efb7453-+-beta: load site configs from /usr/local/apache/conf/all.conf

e43f7872e0-+-apache: ensure 'Include' wildcard globs always match

b371f124bd-+-role::cache on beta: switch over appservers to HHVM

6fa2005007-+-releases: add reprepro repository

09dfd85aa6-+-Fix stdlib's min()

ae61daa3dc-+-mediawiki::web: use floor/min instead of inline_template

7c89aaa984-+-Merge "gridengine::master::monitoring: Add dependencies" into production

95ecfbd432-+-phab - small lint fixes

b37cbfbd31-+-gridengine::master::monitoring: Add dependencies

5a5dab3170-+-Tools: Install libcgi-fast-perl

e511e9ebd7-+-HAT: reinstall mw1053 with trusty

4ccbf9bad6-+-Merge "beta: New script to restart apaches" into production

cf7b9ba186-+-jobrunner: create hhvm-only jobrunners

c04683883f-+-node config for ocg100[123]

e5758243a8-+-role::ocg::production -> add LVS config + better icinga check

04e7c8daf9-+-swift - retab

06143f3989-+-Remove unused gluster module

7315b7ddb7-+-Remove openstack::project-storage and related

7611e7f03d-+-fix temp dir for ocg production role too

c6ee3ee202-+-fix escaping in etherpad https icinga check

7b70af3b81-+-Merge "role::mediawiki: include mediawiki::web::sites in role class" into production

0576cb05b0-+-role::mediawiki: include mediawiki::web::sites in role class

685e38b6e1-+-Merge "puppetception: Initial commit" into production

7e0bb12ef2-+-unpuppetize deprecated aluminium config

54d968575e-+-etherpad: monitor https access

0317463150-+-beta: New script to restart apaches

22bc4aa065-+-Merge "etherpad: monitor web access" into production

b3dcf7ce07-+-etherpad: monitor web access

48df68fcf6-+-Update for cdh module, move fair-schedule.xml.erb queue allocation to puppet repo

f3742c56c8-+-Merge "Set default sql server for mysql" into production

31a853e599-+-Set default sql server for mysql

5673ecc90a-+-change ocg temp dir to /mnt/tmpfs

fcb9fd0896-+-Merge "labs_vagrant: Ensure proper ownership of vagrant homedir" into production

4c219fe3b6-+-wmflib: add ensure_directory() and ensure_link()

65a7e114e8-+-mediawiki::multimedia: on trusty, install libvips37 rather than libvips15

83e69139f6-+-beta: Add mediawiki/core/vendor to beta

247ee05def-+-Get rid of deprecated HHVM module

c5c18236b0-+-nutcracker: set service dependency

45de16f9c3-+-Increase the number of parsoid job runners

138996e6f6-+-Add 1 more runner per job runner server

b5218e274d-+-labs_vagrant: Ensure proper ownership of vagrant homedir

0ca8bece8c-+-osmium(hhvm test host): remove ::hhvm::dev

a7481dbe66-+-Merge "mediawiki::multimedia: install libav-tools instead of ffmpeg on trusty" into production

a33b1f7c7f-+-mediawiki::multimedia: install libav-tools instead of ffmpeg on trusty

6c1b027d91-+-puppetception: Initial commit

fba0ef19f0-+-mediawiki: only provision ini files for igbinary and wmerrors on precise

aaec26d3ee-+-Merge "mediawiki::packages: place deprecated packages behind lsbdist guard" into production

16042c9c4b-+-mediawiki::packages: place deprecated packages behind lsbdist guard

04ff62df0b-+-Contint: add ocaml-nox package; dedupe imagemagick

65046b44e6-+-Revert "mediawiki: Fix duplicate imagemagick package definition"

7a38cd29b8-+-Revert "Revert "contint: reduce duplication with mediawiki::packages""

68d18ae56f-+-mediawiki: Fix duplicate imagemagick package definition

f678ce2506-+-contint: fix duplicate definition of imagemagick

fb00921516-+-phab.wm.o https

32ab4e1556-+-php-mailparse for phabricator module

0db42f676f-+-Merge "delete unused role/smokeping.pp" into production

f9af557362-+-reverse proxy ssl for phabricator.wm.o => iridium

683ea71250-+-role::phabricator cleanup

31757a6e25-+-iridium.wikimedia.org => iridium.eqiad.wmnet

6c09e459db-+-delete unused role/smokeping.pp

83e6c57b2d-+-Merge "swift: use statsd_default_sample_rate default" into production

0f579c8b1c-+-mediawiki: use sites-available everywhere.

e5f308f163-+-Tool Labs: tweaks to bigbrother

f1015e7aa6-+-Remove db1050 from s1, to be repurposed for dumps.

ec774b4017-+-swift: use statsd_default_sample_rate default

4e35d257ce-+-Merge "cache: lint" into production

b19581fb5d-+-wikidata json dumps: manifest filename had typo

75db0fb89d-+-Introduce snapshot::wikidatajsondump

28f0b5185c-+-beta: Remove hacks from misc::deployment::vars

d59a1ad5ea-+-Revert "Remove /etc/init.d/dnsmasq on labs network nodes."

c5ebb1ed91-+-Revert "Don't try to stop dnsmasq if we've already removed the init script"

dcb3399c55-+-Set /etc/mailname to contain $::fqdn

4f2d769452-+-beta: Apply ::mediawiki::sync on all host participating in scap

f7787dfc42-+-Set the statsd server for the jobrunners

73e862c541-+-Merge "racktables - use apache::conf instead of file{}" into production

35ed3d6169-+-racktables - use apache::conf instead of file{}

349bb3f2ef-+-mediawiki: profile.d script to add scap to $PATH

077d45812f-+-Merge "fix racktables Apache setup" into production

1578539d6b-+-Merge "fix RT Apache setup" into production

352b1d5569-+-fix racktables Apache setup

937f28bbe0-+-fix RT Apache setup

fc24f5fe0e-+-phabricator moving shared settings to defaults

9e49b07f83-+-Merge "AppArmor module and profile for OCG" into production

2999282f6d-+-Merge "decom mediawiki::jobqueue" into production

21d5220525-+-phabricator inbound email handler

6732407fb3-+-decom mediawiki::jobqueue

766a1da05f-+-Ensure hadoop directories exist in labs

b30cfc025f-+-Merge "Moved remaning job runner slots to the new loop" into production

95b52b9b48-+-Moved remaning job runner slots to the new loop

2a872f5be4-+-AppArmor module and profile for OCG

931684d080-+-route incoming mail for phabricator.wm.org to iridium

f60f5b6c57-+-Revert "mediawiki: use native min/floor funcs rather than inline_template"

3f266c6bb0-+-mediawiki: use native min/floor funcs rather than inline_template

b16d5f977b-+-Don't try to stop dnsmasq if we've already removed the init script

1b4f6128f4-+-Remove /etc/init.d/dnsmasq on labs network nodes.

7a2b174cfd-+-Moved more runners to the new job loop

59ed8ae9a2-+-jobrunner: use a more standard config file location

fbbed76053-+-mediawiki: manage sites with apache::sites

a2e482f092-+-Revert "mediawiki: manage single configs via apache::site (one server))"

586b073296-+-mediawiki: manage single configs via apache::site (one server))

3fc63b7ab4-+-Duplicate some of mariadb::config for role::mariadb::labs during migration, as the conflicts with mysql_multi_instance are various.

a1cbddecf9-+-Skip packages_wmf which clashes with mysql_multi_instance, until after migration is done.

2eb11de749-+-Labsdb MariaDB 10 config starting with s5

d485a956c4-+-Merge "bugzilla - remove DHE ciphers" into production

b11a97cc39-+-Merge "retab role/gerrit.pp" into production

6b331a83ac-+-Merge "Increase timeout for run of deployment_server_sync_all." into production

d022e73d1d-+-beta::natfix removal step 1

0211346f88-+-mailman - monitor archive page (of wikimedia-l)

f348325bba-+-Increase timeout for run of deployment_server_sync_all.

0f01540f81-+-Merge "mailman: monitor listinfo page (of wikimedia-l)" into production

6b92be3712-+-mailman: monitor listinfo page (of wikimedia-l)

0dc3fcead9-+-fix semicolon escaping in ocg cleanup commands

089982b505-+-Use hadoop config class in hive and hue roles

38969592f4-+-Use hadoop config class in oozie role to find oozie host in labs

ee5304c97b-+-Wrap ganglia::plugin::python { 'diskstat': } in if !defined in hadoop and kafka roles

af8ad7be0b-+-Offline Content Generator LVS config

b0e5c41313-+-Move more runners over to the new job loop

61a0399366-+-Tool Labs: first draft of the bigbrother daemon

93ef503408-+-New Variables for OCG Service

e987e45632-+-mailman monitor-only check procs by list user

358916e5b9-+-Merge "enhance mailman monitoring" into production

8135b7bf6f-+-enhance mailman monitoring

bd5e9ee740-+-jobrunner: whitespace / formatting tweaks

ff0522f43d-+-apache module: test config before attempting restart

cc46bf667e-+-bugzilla - remove DHE ciphers

50e2c4ec51-+-Make permanent some Elasticsearch config

fffcad29a3-+-Tools: Install pdf2svg

937e63daa2-+-Add logrotation for /var/log/mediawiki/*

bc9b47fd3a-+-Fold mediawiki::web::config back into mediawiki::web

5d899e15f7-+-mediawiki: move File['/usr/local/apache'] from web.pp -> sync.pp

00a7302148-+-Merge "mailman: monitor number of running processes" into production

be226145f0-+-labs_vagrant: Ensure that lvm volume is mounted first

5bcad060cc-+-jobrunner: include passwords:redis, to populate template var

23e6ff6b3d-+-jobrunner: inform trebuchet of service name

942d240682-+-mailman: monitor number of running processes

5fc95c3b73-+-jobrunner: install on all jobrunners

eaa91296ce-+-jobrunner: provision on mw1001; fix template

5826ce1724-+-add jobrunner deployment target to job runners

eb86e97ea9-+-Tools: Remove redundant package requirement

dbe6fab581-+-mediawiki: use canonical apache module

cca1251024-+-wikitech-make ServerAlias configurable as well

4205b0c6d3-+-Merge "mediawiki: remove module-local apache service" into production

7fe6b57b34-+-twemproxy: remove leftovers post-decom

a622a82f04-+-mediawiki: remove module-local apache service

daab1e2a4a-+-labs_vagrant: cleanup sudoers config

410a54cb96-+-Merge "labs_vagrant: Install to /srv/vagrant" into production

b3c1a38660-+-Add Camus cron job on analytics1027

ebd10daa5e-+-Fix hasty syntax error

b87ff9a608-+-Ensuring stats user and group exist for refinery deployments

2d5b024bc4-+-Deploy analytics/refinery repository to analytics1027

e0c81689f8-+-kafka process monitoring: make it send pages

d065bd9a69-+-correct parameters for spamassassin class in otrs role class

143c0256ae-+-beta: Stop using obsolete 'maxclients' param for mediawiki::web

26a3057d01-+-mediawiki: remove twemproxy::decom

4d37b0618e-+-dedupe File['/etc/cluster']

b72370c442-+-Merge "tin: include ::mediawiki" into production

24cdee169c-+-tin: include ::mediawiki

dea4c918db-+-Merge "tools: remove libvips from exec_environ" into production

02cbb091c3-+-tools: remove libvips from exec_environ

2f70625579-+-Paramerize # runners per loop and add a transcode one

afca9ed3c5-+-Revert "mediawiki: use apache module"

10dbb75bb3-+-mediawiki: use apache module

6b0eddbc36-+-Install CDH5 clients on stat1002

8c0ffd8182-+-mediawiki: move SSHD nice override from web.pp to init.pp

708d06e4dd-+-Merge "rename: Exec['apache2-restart'] => Exec['apache2_hard_restart']" into production

9cd7bb9dd9-+-Modify nova role to better support labs uses.

75e4cf8c5d-+-Fix unused variable in oozie.pp

3324e02679-+-rename: Exec['apache2-restart'] => Exec['apache2_hard_restart']

139b4982f8-+-removing admins.pp

a3090e5f6f-+-retab role/gerrit.pp

4aeb427faf-+-Merge "Tools: Unify Tools and Toolsbeta configuration" into production

255a4774f8-+-apache: on service refresh, do a graceful reload instead of start/stop

189ae31ada-+-Merge "Tools: Add IP mapping for tools.wmflabs.org" into production

809fd913bd-+-Merge "tools: Actually branch on distro name for packages" into production

ea73525ef7-+-Merge "Revert "platform: simplify hardware specific configuration"" into production

94f140a7e6-+-Revert "platform: simplify hardware specific configuration"

4aa18cd3dc-+-Merge "platform: simplify hardware specific configuration" into production

9c44e8064a-+-Don't include role::analytics::clients on stat1002 while CDH5 upgrade is in progress

62a5121839-+-tools: Actually branch on distro name for packages

5a536b2803-+-Add and apply twemproxy::decom

15c54a77c6-+-add swift icehouse repo to ms-fe*

2fdfb91c51-+-Tools: Add IP mapping for tools.wmflabs.org

be68a2f722-+-labs_vagrant: Install to /srv/vagrant

f827f496f0-+-analytics1004 is the new standby NameNode

b902be55d5-+-Only include analytics-users on NameNodes

e1dcb814ce-+-Remove references to cdh4

a387700137-+-Remove duplicate parameter in hadoop.pp

7d9d379c69-+-Add new 14 DataNode to Hadoop puppetization

fe43ddbd04-+-StrictTransportSecurity for OTRS

cda3a84375-+-Merge "beta: apply mediawiki::jobrunner on jobrunners" into production

b212cbbffd-+-labsdebrepo: Fix initial run

7774a77e03-+-Merge changes If06efe55,If8d97284 into production

704048b103-+-Enable StrictTransportSecurity for wikitech

89edba1ea9-+-Document use of stat1001.wikimedia.org's default site

bc5bf31946-+-beta: apply mediawiki::jobrunner on jobrunners

570dc01386-+-perms fix for file_mover?

ffb5cc824a-+-fix file_mover .ssh dir

519054d1a1-+-Add explicit homedirs for file_mover + pybal-check

176e73b33d-+-Merge "zuul: remove /var/lib/git from server" into production

ee6af3c813-+-Merge changes I493494e0,I99bfb7a4,I060de5a3 into production

786fa611ac-+-Tools: Use apt::repository instead of file resources

87bd718e67-+-Production now uses CDH (CDH5) module, also refactor roles

ebcbef5056-+-Merge "tools: Specify packages that are different in precuse vs trusty" into production

8be2955ea9-+-Merge "tools: Don't specify postgresql-client version" into production

948a7c498f-+-tools: Specify packages that are different in precuse vs trusty

5f4a9a7046-+-tools: Don't specify postgresql-client version

1240675af7-+-Merge "toollabs: Don't add mariadb repo  on trusty hosts" into production

aa75c3e5d7-+-Merge "Revert "icinga: have gallium/lanthanum notified to contint"" into production

ed4c18f1e8-+-Revert "icinga: have gallium/lanthanum notified to contint"

c7d92798f3-+-Merge "icinga: have gallium/lanthanum notified to contint" into production

48f8c93706-+-icinga: have gallium/lanthanum notified to contint

bee5c7c0a7-+-Fixed spacing and lint rules for manifests/misc files.

53293fdb8e-+-zuul: introduced config hash in role::zuul::configuration

cd10ba2168-+-zuul: remove /var/lib/git from server

c001474ffa-+-zuul: monitor Zuul merger via nrpe

6df4f9cf0b-+-zuul: move Icinga checks to zuul::monitoring::server

13b6e2e05c-+-zuul: install zuul from role classes

ac682d5119-+-Merge "swift: add swift-dispersion-report and stats" into production

29ef9756b7-+-mediawiki: make apache MaxClients be always smaller than ServerLimit

f1ebeca845-+-Merge "Added jobrunner.ini file" into production

f9a37f91db-+-cache: lint

3f0d87133e-+-mediawiki: manage with puppet on all nodes

b4f1b85d8a-+-toollabs: Don't add mariadb repo  on trusty hosts

e93859ab2a-+-phabricator class for installing in labs

f40469272a-+-generic: remove systemuser definition

03f227af3b-+-Merge "nfs - replace generic::systemuser with user" into production

3d7598892a-+-Merge "openstack-replace generic::systemuser with user" into production

dc99b07584-+-Merge "dynamicproxy: Block non-local Redis connections" into production

2010eac668-+-Merge "fundraising, replace generic::systemuser" into production

8749823a26-+-Merge "bugzilla: update cipher_suite" into production

780671b7cf-+-Added jobrunner.ini file

09a086fdf0-+-fix email auth bug in legalpad

6fd206afae-+-dynamicproxy: Block non-local Redis connections

4c5cd6266e-+-platform: simplify hardware specific configuration

992a70a899-+-Merge "Add jobrunner class" into production

72fb176caf-+-Add jobrunner class

9c5a00d654-+-Tools: Unify Tools and Toolsbeta configuration

9b9d473fa4-+-Tools: Remove unused syslog role

5c29cbb1a0-+-swift: add swift-dispersion-report and stats

964b889449-+-mediawiki: manage the apache config via puppet

76b495c3ad-+-bugzilla: update cipher_suite

37a466fb6a-+-Merge "bugzilla apache: Enable required modules for caching" into production

14dc194934-+-dataset-replace generic::systemuser with user

cd046cbd7a-+-parsoid - replace generic::systemuser with user

b1706ae088-+-search - replace generic::systemuser with user

96269ed926-+-turn on amssq47 text backend

7cd6bc94f0-+-phab.wm.org no https yet

7042812ce3-+-Phabricator for iridium

a85eeae765-+-Add archive-project-volumes

dd4a4bf67b-+-add mpt-status deps

6500718dbc-+-(another) typo fix for Ia424c6433

747cf1da24-+-typo fix

c38caeb763-+-Remove beta::hhvm

7737b025fc-+-Fix-up for Ia424c6433: resolve duplicate def'n

914d877cc0-+-Fixup for Ia424c6433

29c8268ce6-+-role::mediawiki::webserver: set maxclients dynamically

01fc6febdc-+-role::mediawiki: don't monitor twemproxy; about to be decom'd

b111daa906-+-nutcracker: fix username arg for service check

cc904c8e2c-+-Merge "bastion: lint" into production

ba600f4d3c-+-managed file_mover home dir

1b0b5a6b43-+-stop diamond on non-specified labs projects

c557164627-+-Tools: Install xsltproc

ff07ef0a71-+-Merge "Fixed puppet-lint issues on manifests/role/analytics/hadoop.pp." into production

9def7112d7-+-Tools: Install npm for users' use

3faf7960e3-+-Fixed puppet-lint issues on manifests/role/analytics/hadoop.pp.

32a94696ad-+-convert amssq47 to normal text cache in private1-esams

45d8ebffdf-+-Fixed spacing and puppet-lint issues in manifests/role.

8e4d79dffe-+-Increase bacula poolsize to 50

d04ba0ffac-+-zuul: migrate server logging.conf out of zuulwikimedia

27d14b4e25-+-monitor m3 replication on dbstore boxes

994f538674-+-mediawiki: do not notify apache for now

38915878f3-+-mediawiki: add apache-config as a submodule, upload it via puppet

ddead99102-+-zuul: further split merger and server

fb46b146c4-+-Fix typo in bacula module

50a9f8b65a-+-Merge "bacula-dir reads a copy of puppet's private key" into production

55a62ca976-+-zuul: migrate statsd_host to zuul::server

dfb0770665-+-zuul: split conf file for server and merger

984ffdd0a7-+-phabricator login screen message

59024e44da-+-legalpad fix outbound email

a142fe39e6-+-Feed logs from ssl terminators again into webstatscollector's filter

a52381a564-+-diamond: Let diamond read the puppet state file (take 2)

f053f5927b-+-Nutcracker: hotfix to not make nutcracker restart with every puppet run

1723a728c1-+-re-replace OTRS favicon with wmf (metawiki) one, Bugzilla 17271

a90b8c047c-+-nutcracker: correct whitespace in config, stats port

6db871cdee-+-Merge "vimrc: remove from puppet" into production

edb6481e31-+-Merge changes I121cd202,I8796373a into production

32b600a4be-+-nutcracker: move config in puppet, work with new packages

e06014b50e-+-vimrc: remove from puppet

0688f298e2-+-nutcracker migration: allow wikidev to (re-)start nutcracker

f728bce86f-+-Eventlogging monitoring, pass true w/o quotes

6bd04ead9e-+-Merge "mha: lint" into production

edc5107ae6-+-beta: minor lint

a78ec018ae-+-Merge "firewall: lint" into production

eb7b205f34-+-bastion: lint

f7a4199e7f-+-diamond: Make ensure => absent work

274306d0e8-+-diamond: keep only current day's logs when running in labs

07bc23c866-+-Revert "diamond: Let diamond read the puppet state file"

a2fba3ac44-+-diamond: Let diamond read the puppet state file

ef47c01d73-+-Fix eventlogging duplicate definition

d168ac0491-+-Merge "apt: minor lint" into production

8af1b06419-+-db1047 mariadb 10 now replicates s2

0d33508f13-+-Merge "add system group for bugzilla reporter user" into production

2b2661d881-+-Merge "planet - add system group for system user" into production

9dcc707df0-+-wikistats - add system group for system user

a288bb6f24-+-planet - add system group for system user

c485a433a6-+-add system group for bugzilla reporter user

19538d1e06-+-openstack-replace generic::systemuser with user

362ad6f98f-+-nfs - replace generic::systemuser with user

e2428ee4d4-+-fundraising, replace generic::systemuser

5446de6ff3-+-terbium: install python-mysqldb

6db3c2758e-+-Labs: add sync-exports to repo

8dd505ab91-+-firewall for phablegal

dc85c5764e-+-update phab tag for legalpad

a7f16305a5-+-don't require second approval for mediawiki accounts

cdd9f3f0d6-+-sync_limit param is on zookeeper class

d3ca9f7194-+-Should be 16000, not 160000 for kafka zk timeouts, and proper new zk param is sync_limit, not sync_time

c0517202f9-+-Merge "Remove some obsolete gluster scripts:" into production

2cb295979e-+-Set zookeeper kafka client timeout to 16 seconds

d07545f58c-+-Merge "openstack - aliging and quoting" into production

339597e2c0-+-Merge "openstack-unquoted file modes" into production

d7c02f3756-+-bacula-dir reads a copy of puppet's private key

29ddad6f8a-+-Move "mail aliases to OIT" cron to role::mail::mx

1e10458aa1-+-Fix hue error in production

7f6eb37c8f-+-Use ensure_packages for things that include python-yaml

b0841cd307-+-mediawiki: enable the monitoring vhost everywhere

786afc74fa-+-mediawiki-monitoring: deploy to all mw appservers

1f3b6bc128-+-apt: minor lint

a1554c4dc7-+-Graphite monitoring for NavigationTiming to Event Logging

3f8a2c2eb9-+-Remove zfs monitoring

8ebbacdd6f-+-db1017 is no longer s5-analytics-slave

2cfb3f8d1f-+-mediawiki-monitoring: correct diamond naming, path

65e4eb037c-+-mediawiki-monitoring: fix mountpoints, python class name

6a1538c51d-+-mediawiki-monitoring: use the correct dependency

70ba653f4b-+-mediawiki: collect apc variables via diamond

06d0fe4b09-+-phlegal role banner

2bdd6b3fd3-+-Merge "modules/coredb_mysql/ sans systemuser" into production

f60fa6f268-+-Merge "deployment,replace generic::systemuser with user" into production

1e0f61fd59-+-Merge "facilities (cams) - add system group" into production

8587e5245a-+-Merge "misc/statistics - also add system group" into production

2e53ef038a-+-misc/statistics - also add system group

db162d8e87-+-role/logging -set system => true for system group

ec8aad3873-+-facilities (cams) - add system group

180e8a82cd-+-Merge "install-server-replace generic::systemuser" into production

84fa774402-+-install-server-replace generic::systemuser

afbff5062e-+-openstack - aliging and quoting

39b32b9cd0-+-openstack-unquoted file modes

66255b6755-+-Merge "facilities, replace generic::systemuser with user" into production

c6e5f5b649-+-facilities, replace generic::systemuser with user

9be2426669-+-stats - replace generic::systemuser with user

0288030dc3-+-Merge "Requote a boolean" into production

658d23e3dd-+-exim: set o+x to /var/spool/exim4

1b75d99acc-+-mail: add lead as second smarthost, remove mchenry

2dc7228552-+-outbound mail for legalpad.wikimedia.org

b0d54941ab-+-Use CDH5 for pig, sqoop and hue in labs

1442a908a6-+-Use CDH5 for oozie in labs

5212e31bfb-+-Merge "logging-replace generic::systemuser with user" into production

9370eaf9a6-+-Merge "Use CDH5 Hive for labs instances" into production

fe8208f997-+-Use CDH5 Hive for labs instances

71ec50f986-+-Requote a boolean

a3e97aa01e-+-Remove unused upstream Openstack module

6a8ddb74b8-+-Merge "labs: Enable  MinimalPuppetAgent collector on all nodes" into production

dfae5b053a-+-mailrelay: convert 'true' into a real boolean

8949b3dcad-+-Merge "Fix string interpolation in cxserver" into production

edb045da79-+-swift: add icehouse pinning to ms-be1*

239b5e2db5-+-spamassassin: fix failed dependency

ea6b4f7aa2-+-spamassassin: don't create user/group debian-spamd

b27cc7b455-+-Add role::mail::mx to lead

b94f124a60-+-labs: Enable  MinimalPuppetAgent collector on all nodes

3eb4a91dac-+-mediawiki oauth for phab

4191919a85-+-legalpad to radon

bf78006dc2-+-apache: improve docs; provision apache::def before apache::{mod_conf,conf}

2787d885ec-+-Use hive serde jar from site's hive setup

ba22581c04-+-apache: get rid of apache::vhost

de03e2d86b-+-labs: role::deployment - port apache::vhost to apache::site

18facf9312-+-trusty friendly phabricator

34a37126ae-+-setting up the node definitions for francium as blog server

7c7022ba53-+-Add apache::conf

36eea51ba8-+-add apache::def resource

8e5116369f-+-Fix string interpolation in cxserver

b18249e72f-+-gitblit: use apache::site

76b2bd4b7e-+-Merge "gerrit - replace generic::systemuser with user" into production

d6235ddec0-+-Intentionally break puppet compile for virt1008

42331a1a29-+-gerrit - replace generic::systemuser with user

036429f961-+-modules/coredb_mysql/ sans systemuser

dabbeae335-+-bugzilla apache: Enable required modules for caching

5481ae24c8-+-Merge "toollabs: Remove broken ganglia monitoring of exim messages" into production

70a1df1271-+-Merge "toollabs: Allow diamond to sudo to reach out to exim" into production

d9dd655d02-+-Merge "Revert un-quoting of booleans in webserver.pp" into production

7131ec4e56-+-Revert un-quoting of booleans in webserver.pp

9b955b8040-+-fix quoting error in iptables.pp

82327d852f-+-toollabs: Remove broken ganglia monitoring of exim messages

8d9204e9f4-+-toollabs: Allow diamond to sudo to reach out to exim

92bd7ddf75-+-Merge "toollabs: Send exim queue length to graphite" into production

6e95edbc52-+-Fix undefined variable reference in hadoop.pp

36c6607c85-+-Merge "torrus: lint" into production

4cb2cb6e87-+-Now using CDH5 in labs for new Hadoop clusters.

64a1fa1498-+-Merge "scap: /usr/local/bin/sync-common-file is unused" into production

ce79488160-+-toollabs: Send exim queue length to graphite

a50511e443-+-Merge "put legalpad phab behind misc. varnish" into production

e4b2ea0e07-+-rcs: do not declare upstream twice

a76dfb2ee4-+-Merge "Tools: Fix pastebinit configuration" into production

da669926d0-+-Fixed spacing and lint rules for manifests files.

5c89575903-+-Merge "misc::statistics::sites::default: use apache::site, not apache::vhost" into production

1f799a20d9-+-misc::statistics::sites::default: use apache::site, not apache::vhost

8c346eb401-+-Merge "role::deployment: port apache::vhost to apache::site" into production

8b718622aa-+-Merge "mediawiki_singlenode: port apache::vhost to apache::site" into production

da2d157a74-+-scap: /usr/local/bin/sync-common-file is unused

aba7ed926b-+-run spamd as user debian-spamd and manage that user+homedir

18fac33c49-+-make iodine (otrs) spamassassin daemon run as default user (spamd)

e030c07fd8-+-rcstream: add SSL support

789e25daf9-+-zuul: merger now has its own default file

873950d6f3-+-zuul: prefix server default template with 'zuul.'

040a3923c3-+-Merge changes Ied2ed92d,I87c86ed7,I3b034976 into production

3142a2503b-+-add db1044 to mariadb 10 s1 for HA tests

1221813cbf-+-switch tendril backend to db1011

c99ee2d3bf-+-Deploy db1072 and db1073 as future S1.

f8e38e49e0-+-Remove some obsolete gluster scripts:

13cae31e8e-+-Tools: Fix pastebinit configuration

42e439e665-+-toollabs: Fix package conflict for python-redis

2441a1caa5-+-toollabs: Fix path to pastebinit.conf config

7691387726-+-Merge "dynamicproxy: Fix puppet include for nginx monitoring" into production

e3ba007e95-+-Make virt1008 a live compute node; make virt1009 the puppet canary.

0707118780-+-Merge "ganglia - replace generic::systemuser with user" into production

89dc2e8d99-+-ganglia - replace generic::systemuser with user

45af656b4c-+-dynamicproxy: Fix puppet include for nginx monitoring

c183db73e8-+-Merge "toollabs: Collect NFS Mount stats from all toollabs nodes" into production

ecf5686462-+-Merge "toollabs: Collect active users metric for bastion hosts" into production

34dc720a50-+-Merge "toollabs: Remove superfluous setting in redis monitoring" into production

e455f129cf-+-dynamicproxy: Send proxy redis stats to graphite as well

adcd342e45-+-dynamicproxy: Enable diamond collector for nginx

0a7a6b62d0-+-Revert "Intentionally break puppet compile for virt1008"

4362b295f7-+-Merge "toollabs: Reduce number of things being logged" into production

bd2e0d16a0-+-toollabs: Reduce number of things being logged

06ebe9c67b-+-Merge "[WIP] Process alarm for graphite EventLogging consumer" into production

f82325df82-+-Document wikimetrics' use of the $::wikimetrics_backup global

2ae84033eb-+-Have wikimetrics cleanup its backup upon absenting it

203cd61569-+-Append hostname to wikimetrics backup target

2cbe6504b2-+-Merge "cxserver configuration for beta labs" into production

9b35b5166b-+-cxserver configuration for beta labs

bad132ac9b-+-[WIP] Process alarm for graphite EventLogging consumer

7e8da547b5-+-rcstream: add ipv6 addresses to backends

7e3e3eab40-+-diamond: Keep only 1 day of logs for labs

c9781db14e-+-toollabs: Collect NFS Mount stats from all toollabs nodes

7b2a6eaad5-+-toollabs: Collect active users metric for bastion hosts

ddc2a127ac-+-toollabs: Remove superfluous setting in redis monitoring

2bdd837f58-+-Intentionally break puppet compile for virt1008

87130c4267-+-mediawiki_singlenode: port apache::vhost to apache::site

0068071287-+-dynamicproxy: Use nginx module

306638711a-+-Merge "role/labs: touch an empty conf file in sites-local" into production

203610a1dd-+-role/labs: touch an empty conf file in sites-local

0af965d98c-+-Replace apache::mod::php with apache::mod::php5

fa3b54538c-+-role::deployment: port apache::vhost to apache::site

a1b288c12b-+-put legalpad phab behind misc. varnish

406853ee54-+-Fix double parameter definition

de4342c5cc-+-check_puppetrun needs sudo privs

bbea56426c-+-Populate the rest of the nagios hostgroups

a5a16dc255-+-Add the rest of the datacenter virt_ hostgroups

355eaa1f98-+-add global nagios hostgroup for virt hosts

4dfb0effa5-+-Fix typo in warning vs critical

720df7efa7-+-Puppet 3.x needs storeconfigs=true for thin_storeconfigs to work

d4749d7276-+-Split base::puppet to it own file. Amend puppet freshness check

0efa62b7ee-+-toollabs: Install python-redis module for diamond collector

73a226350c-+-toollabs: Enable diamond monitoring for Redis

e6899bf5e0-+-Merge "graphite: Remove auth requirement for labs" into production

6f84f5891e-+-Enable the new backup role in wikimetrics if set

9740f5b8de-+-Have Wikimetrics use the redis module's configuration again

219c829f05-+-Merge "Sanitize nrpe::check title parameter" into production

9ddc20029f-+-graphite: Remove auth requirement for labs

6862b8d306-+-add apache::mod::proxy_fcgi

a557c26690-+-Missing module name.

7501fb801d-+-master/slave configuration for m3/phabricator

4328615724-+-Update coredb topology array which is out of sync after slave moves. Remove role::coredb::m2 as it is no longer in use.

572b313fd7-+-Merge "On Labs, provision an Apache config dir that is not managed by Puppet" into production

ee065718d9-+-On Labs, provision an Apache config dir that is not managed by Puppet

4d3a3055dc-+-Replicate operations/puppet/cdh to puppet-cdh

c493e1ac81-+-Merge "Revert "Intentionally break puppet compile for virt1008"" into production

910083d98c-+-Merge "add file{} definition for new puppet run check" into production

48009d5829-+-add file{} definition for new puppet run check

334a7b2ca2-+-Revert "Intentionally break puppet compile for virt1008"

59fb83a62f-+-deployment,replace generic::systemuser with user

6de4536319-+-diamond::collector: make settings default to undef

2cf9a16cc9-+-diamond: clean out collector enabled => true settings

6582692b50-+-remove eth bonding for dataset1001, now has 10gb nic

561f063640-+-Merge "beta: Small scap fixes" into production

ce9e2c8226-+-Add a lightweight apache::site resource

01c7fe7169-+-Add cp3017-cp3018 to list of esams upload caches

043bbc0001-+-diamond: Prefix metrics with project name

e48675b795-+-diamond: Enable diamond collection on labs

a139353494-+-graphite: manage graphite-carbon on boot status

0ba8e5f782-+-Check puppet's last run

aee21e6fb5-+-Add public->private mappings for labs to dnsmasq aliases

2abe222d99-+-Add cp3015-cp3016 to list of esams upload caches

4fe543c9d0-+-zuul: migrate server definitions to server.pp

34f7254a8f-+-zuul: migrate merger definitions to merger.pp

553c2f9fa8-+-zuul: mv python-voluptous in the array of packages

aedb1310c7-+-swift: trial icehouse upgrade in esams

e22dff5fc0-+-zuul: python-statsd has been packaged

6b033d6c61-+-m3/phabricator role with strict sql_mode

f75be0a1c6-+-Phabricator module

9ba4bdfb4a-+-allow setting mysql_mode though mysql::config

81da267693-+-jenkins needs explicit jenkins-slave group

88657d3466-+-jenkins - replace generic::systemuser with user

66ef1d477b-+-modules/mysql_multi_instance/ sans systemuser

843559abe8-+-require to fix ordering issues on vcl reload

06db88d546-+-improve reload-vcl retry mechanism (no double-exec on fix)

1367b447f2-+-Move the ordered_json parser function to a shared module and remove the copy-pasta found in deployment, statsd and gdash modules.

3b0ee071bd-+-Add exception for smaller main storage size for upload caches cp301[5-8]

4d3ec60e55-+-A new method for persistent vcl reload failure

3989b72365-+-Revert 3b7e966b + 4179c38c (does not work right)

4643b593ce-+-git::install updates (diff/file lock/diff notice)

36f40baab9-+-Comment out reload-vcl check for now...

4179c38c9b-+-naive fix for vcl-reload checking

3b7e966bf2-+-Turn reload-vcl failures into persistent puppet failures

b6e9a8ead1-+-Make sure that elasticsearch won't start if required plugins aren't available

6e19950e39-+-contint: python-simplejson on slaves

1d9dbaa5ea-+-gitblit: move service monitoring to role class

25a20d4d93-+-Sanitize nrpe::check title parameter

67d5697b22-+-Reassign db1049 to s5

5bb6186926-+-Use G1 garbage collector for Kafka brokers

778edfa84c-+-re-added varnish module directly (no longer submod)

676b3730e8-+-Merge "redisdb: lint" into production

e072a56a2e-+-Adding  $deployable_networks variable in network.pp

a1432a342f-+-Merge "Remove no longer needed base::access::dc-techs" into production

a402236db2-+-Fix for .gitconfig file content and apache_site that was broken in previous lint patch

464a94064c-+-Fix for stats .gitconfig path that was broken in previous lint patch

add065bae4-+-Lint fixes for misc/statistics.pp

a4a5de1a2f-+-statistics: lint

f6c1e32d34-+-kafka: lint

08e0634484-+-Set cluster_tier for bits caches

2447fddd7a-+-Parametrize redis' settings needed for Wikimetrics

a28d4e64ae-+-Merge "backups: lint bacula part" into production

8884e91443-+-backups: lint bacula part

badbfa9b6b-+-fix swift cache directory permissions

02120d3a66-+-Add roles for testing swift in labs

0cac022288-+-Replace hardcoded references with $mail_smarthost

54ad0b3497-+-Switch gerrit to use wiki-mail.wikimedia.org as SMTP server

ce6d36c36b-+-Merge "lucene: lint" into production

fd8957907a-+-Merge "pmacct - also create group for systemuser" into production

abc45fbca8-+-Merge "rancid: also create system group for system user" into production

e6f3bcb018-+-include standard in the labs role.

56ae36b344-+-Apply site.pp defaults for production only.

d164048d5a-+-Merge "tools: Install openbabel" into production

8e5ec5920f-+-Intentionally break puppet compile for virt1008

309d87b76e-+-tools: Install openbabel

f028c9d536-+-authdns: move standard include from role to site.pp

b4b72ae023-+-enable ganglia aggregator on lvs300[12]

2f88ea0c24-+-remove admin yaml from labstore* until RT #7732

963f15f6d5-+-add admin users to default node definition

7b5213f407-+-swift: source is a bashism! replace with .

91cea25542-+-repurpose eqiad bits appservers as general appservers

a1765575fe-+-Merge "swift: don't automatically restart backend services" into production

667308785d-+-Marked out a networking WIP on labstore1001

9fef50ae26-+-Switch tridge from base to standard

601d5786ea-+-Merge changes I41ef6a4c,I293baae6 into production

04a415e664-+-swift: don't automatically restart backend services

6550cd76a5-+-mail: add system::role to role::mail::mx

1ba0e7b1f6-+-mail: add polonium to smarthosts as primary, remove lists

a7756587fc-+-mail: add network::constants include to role class

cbc2f7cfcf-+-mail: add spamassassin to role::mail::mx

3059dfd5b6-+-puppet3: switch everything else to puppet 3

6ca52a33e6-+-mail: remove hardcoded mchenry/lists values

9b52a16a65-+-realm: rename exim_default_route_list & exim_mediawiki_route_list

4a98aad6ae-+-exim: remove otrs_mail_from_hosts

b8b7f80b96-+-realm: remove $all_prefixes

b010016f7e-+-beta: remove duplicate ferm::rule

537e35e0be-+-beta: drop now unneed ssh ferm rule

7ce71b2fa1-+-Remove no longer needed base::access::dc-techs

05c4af31c6-+-toollabs: Add phantomjs package

6b9d53fb3d-+-torrus: lint

3d69863ea3-+-rancid: also create system group for system user

a467335101-+-pmacct - also create group for systemuser

7cd8146862-+-pmacct - replace generic::systemuser with user

59bdfa3f69-+-Merge "solr: lint" into production

2282e81065-+-rancid - replace generic::systemuser with user

3877250332-+-fix path to smokeping.fcgi

c28cb12c7c-+-admin yaml mc*

0b17f8f6f9-+-Merge "rancid.pp - lint and tidy, quoting, arrows, retab" into production

8d2dd76e23-+-puppet3: contint servers

f187501b0a-+-puppet3: migrate swift (be and fe)

9ffb446df9-+-puppet3: pc caches

029adbebe2-+-puppet3: ssl terminators

b75d136f8c-+-kafkatee: convert logrotate script into a template

7ed3992f91-+-puppet3: all databases to puppet 3

1c427163e7-+-puppet3: tpa databases to puppet 3

a54b29477c-+-toollabs: Add GeoIP packages

dd32ad0f93-+-apache::mod: fix perl module config name

7eaae2bbcd-+-Merge "kafkatee: lint" into production

fbee49e4f0-+-Merge "Minor lint base::monitoring::host" into production

d19c1d71d3-+-Merge "labsdebrepo: lint" into production

a16ce9f825-+-labsdebrepo: lint

526e7a90ac-+-puppet3: move rcs, to test trusty clients

64270cdaf0-+-rancid.pp - lint and tidy, quoting, arrows, retab

58cbfc554d-+-do not wrap cron lines

d71b870e61-+-Merge "misc/management.pp - retab and lint fixes" into production

453c1bbbcf-+-do not reassing password variable :(

daf7e29cd8-+-misc/management.pp - retab and lint fixes

0ea32a40e4-+-report swift global statistics to statsd

33932673fd-+-Merge "apt/pin.pp - retab and mini quoting fix" into production

4c5712b4d5-+-Merge "Tools: Install cmake" into production

4e3406ec70-+-puppet3: lvs 2 of 2

15f66d96b3-+-Tools: Install cmake

d592a8d15b-+-puppet3: lvs 1 of 2

43ec5611e8-+-mail: brown paper bag fix, fix spurious include

c959335903-+-mail: add a root system alias to role::mail::mx

89e85cb323-+-exim: get rid of the implicit secondary MX feature

64bd18b07e-+-mail: move wiki-mail-eqiad IP stanzas to site.pp

b266323387-+-solr: lint

a23daab91b-+-puppet3: caches 4 of 4

3eab798846-+-puppet3: caches 3 of 4

a2f7ad8cbb-+-puppet3: caches 2 of 4

87197c217c-+-puppet3: caches 1 of 4

4ddb749daa-+-beta: bring in mediawiki/skins.git

71495548d4-+-redisdb: lint

0687c757eb-+-lucene: lint

cd82624109-+-kafkatee: lint

46d3c9f474-+-apt/pin.pp - retab and mini quoting fix

eeee32cd34-+-mha: lint

75b8836db1-+-Merge "planet - replace generic::systemuser with user" into production

226ebcd750-+-planet - replace generic::systemuser with user

359077eaff-+-Puppetizing cp3015-cp3018 as cache uploads

da6aa25b64-+-Merge "bugzilla - replace generic::systemuser with user" into production

169ad7953b-+-Merge "beta: add role::cache::configuration::backends['labs']['bits']" into production

65e1c3b955-+-*really* disable irqbalance if doing RSS

3af7107999-+-Fix duplicate require in wikimetrics role

05220a3591-+-Use custom redis.conf.erb template for wikimetrics in labs

242406501d-+-puppet3: move remaining appservers

7c605ca092-+-puppet3: imagescalers 2 of 2

3ffd76e175-+-Parameterize redis config template

738ee20cb7-+-puppet3: imagescalers 1 of 2

0e64a4052f-+-puppet3: bits appservers

16f309f2b8-+-puppet3: api appservers 2 of 2

4572dcf2e3-+-puppet 3: api appservers 1 of 2

bbaac80a9f-+-all LVS on "standard" now (w/ NTP)

ae8aa82d19-+-Fixing stat1001.wikimedia.org website

cebdd5dbe3-+-puppet3: migrate mediawiki appservers 2 of 2

916972f0cf-+-Merge "puppet interval to 20 mins" into production

3ef7c58995-+-puppet3: migrate mediawiki appservers 1 of 2

d68aae07ef-+-puppet 3: convert jobrunners 2 of 2

40b4f10797-+-puppet 3: convert jobrunners 1 of 2

da9c03dd83-+-apache::vhost: get rid of logroot param

3be008016f-+-puppet interval to 20 mins

10dd6bec36-+-Merge "Tools: Install Catalan locale" into production

5998653d93-+-Update ganglia data sources to match the aggregators in I61d35c978.

cdc4b6f694-+-Make sanitarium hosts aggregators, since they're bored. Make db1021 deaf, since it shows consistently higher load than its siblings and there isn't much else to turn off.

38e70549ef-+-Merge "(Final!) fix-ups for Iddc778a28" into production

9f45788993-+-(Final!) fix-ups for Iddc778a28

009ea97b5a-+-Kill two last stray symlinks left behind by Iddc778a28

18999ddbf1-+-Fix-ups for Iddc778a28

3af533a43b-+-otrs: resolve duplicate def'n of libapache2-mod-perl2

404441980f-+-graphite/kibana: remove duplicate site config

0bae6338ff-+-Tools: Install Catalan locale

fa69e217a8-+-Un-dummy apache2 service

7d05d6ff2a-+-kill apache_confd

b866b8ef8b-+-kill apache_site

871c54f0c6-+-Kill apache_module

547aa9cce3-+-udp2log: lint

10f7998ab2-+-Remove package dependency for apache::mod::proxy

71395212ba-+-Move wikitech back to wikitech.wikimedia.org.

4356c66521-+-Merge "nova: lint" into production

66b595fa8b-+-Merge "Don't declare Package[libapache2-mod-passenger] in puppetmaster" into production

d10fb5f0fb-+-snmptt - replace generic::systemuser with user

4969ee2a2b-+-nova: lint

8fa1a06466-+-Consolidate httpd/apache2 Service and Package

e2bb60da80-+-Take another step in the direction of Apache consolidation

5a2a6890bb-+-Don't declare Package[libapache2-mod-passenger] in puppetmaster

9749b2341e-+-apache::vhost: retab

5c9cab19a2-+-dirty hack to fix service['httpd'] conflict

2db73da672-+-resolve apache package conflict

65f32356e7-+-Delete webserver::apache::module

02c5c23813-+-Merge "delete apache::vhost::proxy and apache::vhost::redirect" into production

b8be67efb6-+-rt: retab

d6f201f196-+-Merge "salt: lint" into production

3ca0a38421-+-mirror: lint

bc50946eda-+-ganglia_new: retab instance.pp

750cd82b64-+-puppet: switch masters to puppet 3

6f67ae7e9d-+-Merge "fundraising: lint" into production

34e0f194c9-+-scap: ensure=>absent /usr/local/bin/sync-common-file

59408eb0c8-+-delete webserver::apache2::rpaf

15aa54a1f9-+-delete webserver::apache2

375cbc7585-+-delete webserver::modproxy

6397d08ba1-+-salt: lint

c42e14bc88-+-delete apache::vhost::proxy and apache::vhost::redirect

af9dd542f4-+-beta: Small scap fixes

e459688528-+-Merge "mediawiki: small clean-ups" into production

83ec08d2bf-+-mediawiki: small clean-ups

d47a3aa8c4-+-fundraising: lint

3c115a922a-+-beta: add role::cache::configuration::backends['labs']['bits']

7b285c73e3-+-diamond trusty disable default IPVS

b3b089fca7-+-Merge "rcstream: un-comment diamond collectors" into production

5154f0d467-+-rcstream: un-comment diamond collectors

7536f17944-+-diamond not in labs and on trusty

0e6db2c050-+-Fix analytics1018 typo

8b58c4398f-+-Set num.replica.fetchers to 4

20fc3070f7-+-Repurpose analytics1018 as kafka broker

d6c491d66e-+-firewall: lint

7440f7b399-+-Ensure log file for mobile data job exists

020800bfb6-+-enable statsd reporting for swift proxy

79e00984ef-+-Fix log target for mobile apps data job

3b367fd66f-+-add apache::mod::filter, omitted from I5abf01810

bbe8da0fce-+-Merge "apache: include mod_{filter,access_compat,version} by default" into production

b567abe7eb-+-apache: include mod_{filter,access_compat,version} by default

3662aac08c-+-videoscalers: remove extra args

26cd40108e-+-turn on amssq43-46 esams text varnish backends

93eeadba02-+-turn on amssq39-42 esams text varnish backends

20440d8a8e-+-Merge "wikistats - replace generic::systemuser with user" into production

0899e21266-+-Turn on amssq35-38 backend traffic (text esams)

172170613d-+-Add logging to limn mobile data job

3003af2937-+-Drop apache::params; remove ref to A2mod

20752338cf-+-exim: replace SQLite userdb lookup with static file

a9d3590c2d-+-turn on amssq3[1234].esams text cache backends

0dbc1e0c1a-+-s/sda/sda3/ fix for 99865c78a

99865c78ae-+-better storage params for amssq31-46

ce0bc38faf-+-manutius: decom

9964ebe293-+-Add wiki-mail-eqiad to polonium

61e4fc4bce-+-Add IPv6 to polonium

a79ed93f98-+-exim: add legacy_mailing_lists localpart list

a9ea8a3be4-+-add amssq31-46 storage settings

102ad9b788-+-Use polonium's proper hostname (duh!)

832e3bd592-+-provision amssq31-46 for reinstall as private1-esams text

194212465c-+-Add role::mail::mx and set up polonium

527dd5d3db-+-exim: s/secondary_relay_domains/wikimedia_domains/

9931dfd4f8-+-exim: swap the meaning of enable_external_mail

d55f341da5-+-exim: remove default value of outbound_ips

b371a87cca-+-Add role::diamond to standard-noexim

8b84955c17-+-netmon1001: add ganglia_new::monitor::aggregator

1b8460c680-+-Minor lint base::monitoring::host

a01e97e621-+-mail: use real booleans rather than quoted

1ee678fe36-+-mediawiki: re-include deployment users

ff8a5f5da2-+-Merge "apache: replace apache::mod::* hierarchy with simpler equivalent from MWV" into production

154e2e4ba2-+-Set up varnishkafka on varnish uploads

50d99698d0-+-cache: remove pointer to pmtpa for labs

98c1e2e1d8-+-admin enforcing an empty authorized_keys

5f19503d86-+-apache: replace apache::mod::* hierarchy with simpler equivalent from MWV

793fdfa983-+-Use new kafka cluster ganglia octet

5fab160b3d-+-Include Analytics Kafka cluster eqiad aggregator data sources

383b8e004a-+-Usign analytics1012 and analytics1022 as ganglia aggregators for analytics kafka cluster

d79e6b05c3-+-turn on NTP for ulsfo LVS

f85b1dbcd6-+-Disable eventlogging -> kafka consumer (kafka producer)

0761bc3db9-+-mediawiki/apache: load all.conf from canonical path rather than symlink

4dd9f31955-+-Tool Labs: add libfcgi0ldbl for tcl fcgi

9be796a126-+-All brokers use all disks

fb942a6fbf-+-Use all disks for kafka data on analytics1012

4a661866af-+-Use $brokers_array in kafka monitoring view rather than hardcoding kafka brokers

12146383ed-+-Merge "grr, restore warning= parameter to otrs/exim/nagios" into production

f180a1aba3-+-grr, restore warning= parameter to otrs/exim/nagios

0d197b60a9-+-Refinery keeping 31 days of data, deleting every 4 hours

2a00871553-+-hopefully one last tweak otrs exim icinga thresholds

5cef0da045-+-Merge "toollabs: Add tcl8.5-dev package" into production

6ff0dd3ae8-+-Not renaming monitor_ganglia warning and critical parameters

b8b17fa21f-+-Fix for $critical param on monitor_ganglia define

bd796aba92-+-toollabs: Add tcl8.5-dev package

e76a2d1311-+-Merge "another tweak of exim/ganglia OTRS monitoring thresholds" into production

ad4a13fd1d-+-Merge "cache: remove pmtpa hosts" into production

a3ee665708-+-another tweak of exim/ganglia OTRS monitoring thresholds

b05e9a0d00-+-cache: remove pmtpa hosts

1a89a1c209-+-Merge "Fix-up for I28bcbab76: strip whitespace from clear_magick_tmp cronjob" into production

81ef5f581b-+-Merge "contint: localhost.mediawiki vhost on ci labs slave" into production

6819e5b7e9-+-Merge "more tweaking OTRS exim_messages_in alert thresholds" into production

55b58a8760-+-more tweaking OTRS exim_messages_in alert thresholds

cb56346c27-+-Merge "Update stdlib to latest supported release from PuppetLabs" into production

c9db0633d3-+-qualify $hostname in network.pp

5fffff60ce-+-check git merge: use outstanding commits, not time

f20358fff0-+-Migrate mobile-lb.esams to new IP addresses (Zero scheme)

9909031822-+-contint: localhost.mediawiki vhost on ci labs slave

7903f95593-+-Merge "Purge vimrc.local" into production

20553e286f-+-Merge "Increase bacula pool size" into production

2060f42e7a-+-redis: restart service upon first install

8aeb257cac-+-manutius: remove torrus

5dcdc3a4c2-+-torrus: csw2-esams in accessswitches, not corerouters

ea8d8070e5-+-Remove amanda from carbon

74fbe2da22-+-Fix-up for I28bcbab76: strip whitespace from clear_magick_tmp cronjob

d0ae011400-+-Add rsyslog module and port existing usage

113dc97b75-+-apache: clean up init.pp & params.pp

1b73e730a4-+-apache::vhost: removed unused 'configure_firewall' option

282b51975a-+-::apache: delete everything we're not already using

51293be42d-+-Merge "Fixup lsearchd config slightly" into production

31da4e5cc3-+-Fixup lsearchd config slightly

eb56d21f6c-+-Tools: Resolve virtual package requirements

0f351c93ce-+-change ganglia metric name 'exim messages in' to 'exim_messages_in'

87593b151c-+-Merge "tweak icinga check intervals for exim incoming mail rate on OTRS server" into production

274213363a-+-tweak icinga check intervals for exim incoming mail rate on OTRS server

f737e777c9-+-Merge "Include role::mail::sender in role::labs::instance" into production

d7a7fcff9d-+-monitor incoming mail for OTRS

5956bc7a09-+-Fix miss aligned close brackets

b9bf069447-+-inserted iotop to toollabs

ca93720e71-+-Add partman recipe for 12 drive Kafka Brokers

479e263b05-+-Update stdlib to latest supported release from PuppetLabs

6ac5ce2059-+-Merge "Redirect https traffic from old metrics sites to wikimetrics" into production

86e40f2a0c-+-Merge "beta: fix scap for videoscalers" into production

77bf09b49f-+-Merge "memcached: remove pmtpa virtual group and lint" into production

bb1733efc6-+-memcached: remove pmtpa virtual group and lint

fa72f10a2d-+-decom ekrem, former irc box

2918c6c99c-+-remove deprecated fundraising mail config

1ad7f49a19-+-Replace exim::simple-mail-sender with a role class

52841a92a2-+-Kill role::puppetproxy

69442ca622-+-Merge "puppetproxy: match role name to class name" into production

81bed3ab57-+-exim4: revert files' permission to previous state

9ad1df897f-+-mail: fix dependency cycle

d1e4c37b24-+-Merge "Introduce a new minimal exim4 module" into production

789020d1ef-+-monitoring: make define name unique

e8f6ccec3a-+-Introduce a new minimal exim4 module

3d4ba970bb-+-mail: move backup includes in the role class

816e4bb59f-+-mail: move clamav include in the role class

ffcbc38e3f-+-Create a new role::mail hierarchy

3f6bae544a-+-check_git_merge: fix execution switches and permissions

4035c11e4a-+-monitoring: fix require name

816d8e08fa-+-mchenry: remove classes that don't work

225bb0e091-+-monitoring: add check for git merging of important repos

fe141ab8b8-+-Make dbstore non-delayed by default. Apply suitable replag thresholds to dbstore1001 for 24h pt-slave-delay, and dbstore1002 for analytics.

65b0426c5e-+-Move db1048 into m3 as future lvm snapshot slave for phabricator. Combine m2 boxes db1020 and db1046 into same role::mariadb::misc.

c66e5686a5-+-Remove db1048 from m2

794a05b3e5-+-logging-replace generic::systemuser with user

0fa8dd7ea5-+-bugzilla - replace generic::systemuser with user

7b60c8b5fc-+-wikistats - replace generic::systemuser with user

4a2fb3a8ea-+-Merge "Add jpegtran dependency for metadata manipulation to OCG" into production

9b29dd4a04-+-Save hive-drop-webrequest-partition cron output in log_dir

003a616d7e-+-Include role::analytics::refinery::data::drop on analytics1026

99760b3b61-+-Merge "Add class role::analytics::refinery::data::drop" into production

3de5ace9b8-+-fix tabs vs spaces, put includes in alpha order

886cdb7381-+-Merge "add base::firewall to ocg role classes" into production

5f8c123622-+-add base::firewall to ocg role classes

b8a85dd1a7-+-remove lucene::users adn ::admins remnants

5b25a4b0a3-+-Add class role::analytics::refinery::data::drop

7030c8e1bc-+-Merge "lucene: admins on node level, remove redundant admin class" into production

98d113752f-+-Merge "labsbastion: lint" into production

bd37472439-+-puppetproxy: match role name to class name

b539d51117-+-Merge "gitblit: firewall already on node level" into production

7ae9d38cb1-+-Merge "puppetproxy: remove firewall" into production

3e24351eb2-+-Merge "Add Farsi fonts for OCG" into production

ac5fabb8c2-+-Merge "Specify puppet:///modules/labs_vmbuilder" into production

bf66ba181a-+-labslamp: includes in a sane way

fabf1efdf1-+-Add jpegtran dependency for metadata manipulation to OCG

9966aae3c8-+-Add Farsi fonts for OCG

55ec647469-+-labs: default all clients to puppet 3

a20931a5e9-+-Redirect https traffic from old metrics sites to wikimetrics

919fdaf2e0-+-Merge "labs: lint, clean and remove heartbleed leftover" into production

34118f9b27-+-access_new_install: minor lint

75c902a24c-+-lucene: admins on node level, remove redundant admin class

1884ab02ed-+-labs: lint, clean and remove heartbleed leftover

cdf5a771a1-+-Merge "Remove varnishkafka delivery errors check" into production

9b95e571ce-+-Remove varnishkafka delivery errors check

7674b711bd-+-Add a clean coredb-equivalent configuration MariaDB role. Use it on db1020 as a slave for m2 not handling real traffic.

42370d078b-+-labsbastion: lint

9c4f700aae-+-puppetproxy: remove firewall

c0ff5c37d4-+-gitblit: firewall already on node level

a12c9b87be-+-re-quote booleans for exim::roled class call because unquoting seems to break the template

937a57b509-+-beta: fix scap for videoscalers

0143b78fd2-+-Merge "Revert "contint: reduce duplication with mediawiki::packages"" into production

41efa253fb-+-Merge changes I21ddf15b,I1fc922d8 into production

682e4a6908-+-Revert "contint: reduce duplication with mediawiki::packages"

606cce4b68-+-Merge "zuul: bring in python babel and prettytable modules" into production

b21c30fbfc-+-add template for OTRS main config file Kernel/Config.pm

c386de2912-+-otrs sans systemuser

8b02a05fd6-+-Merge "no-op formatting cleanup of role::otrs manifest" into production

d897f1bb4c-+-no-op formatting cleanup of role::otrs manifest

8c767a9f46-+-Merge "Setting up solr100[1-3] as elastic101[7-9]" into production

be44bbdad2-+-contint: reduce duplication with mediawiki::packages

e10061c9c0-+-Revert recent generic::systemuser conversions

37f891ead7-+-Setting up solr100[1-3] as elastic101[7-9]

f843447daa-+-Merge "ipython use generic::systemuser" into production

13932dcfe3-+-ipython use generic::systemuser

c3bd7981e5-+-Merge "ocg use generic::systemuser" into production

dcf55c490c-+-ocg use generic::systemuser

b66eb8c7a5-+-icinga - fix dependency cycle for system user

582c5f415f-+-Merge "icinga use generic::systemuser" into production

c944744111-+-Merge "tcpircbot use generic::systemuser" into production

c7ed60977b-+-Merge "librenms use generic::systemuser" into production

e5bb77532f-+-Merge "limn use generic::systemuser" into production

ed456d9ba9-+-Merge "kiwix use generic::systemuser" into production

26dfea94f6-+-puppetsigner: actually use the file in the repository

2e456057a4-+-simplify zero update url, remove outdated $zero_realm

1b60026c5c-+-netmapper URL based on realm (prod/labs)

95610e7aad-+-Merge "mediawiki::php: restore php5-igbinary; delete some unused files" into production

3df5adda2a-+-puppet3: remove 2.7 prefs, not the actual ones

7f0935b4f9-+-mediawiki::php: restore php5-igbinary; delete some unused files

43f03b75c2-+-puppet3: correct resource title for removal

b44cb1ff9f-+-puppet: ensure defining $puppet_version does upgrade

e9452957f5-+-puppetmaster: acls only in apache for puppet 3

b214f196df-+-Merge "Adding GELF support to LogStash" into production

dfb0a19171-+-Adding GELF support to LogStash

fb16f9cb1e-+-Merge "Revert "ocg use generic::systemuser"" into production

7b1f2c9493-+-Revert "ocg use generic::systemuser"

aaddd4634d-+-Merge "ocg use generic::systemuser" into production

76fdd4a29d-+-icinga use generic::systemuser

b6f8462bb6-+-librenms use generic::systemuser

98e6ab557e-+-limn use generic::systemuser

9c5fc38432-+-kiwix use generic::systemuser

65f7255f60-+-ocg use generic::systemuser

3ba59bc5dc-+-tcpircbot use generic::systemuser

41f2facf81-+-Merge "gid not a valid parameter for generic::systemuser" into production

3df220dbe6-+-gid not a valid parameter for generic::systemuser

a71d3fd6f4-+-Merge "gitblit use generic::systemuser" into production

80d3f1fcb9-+-gitblit use generic::systemuser

6c9b107942-+-Merge "webserver: fixing duplicate declaration of apache-mpm" into production

9425305d93-+-Fix type in OCG role

b0f34e4e7d-+-rcstream: move app mount to top-level

a5ef5f6774-+-Move cp301[5-8] to internal esams network, add site.pp node entry for cp3018

3ab7344080-+-typo fix for I28bcbab76

64b515ed5f-+-migrate ::imagescaler -> ::mediawiki::multimedia

caccff7217-+-puppet: upgrade labs puppetmasters to version 3

f2cf1dd885-+-puppet3: make puppet::self::master work in puppet 3

8771b911c6-+-puppet: pin packages for puppet::self::master as well

89964cc795-+-Increase bacula pool size

80bb610d34-+-zuul: bring in python babel and prettytable modules

46e1e177aa-+-properly flatten the bits backend list

8d3c9fc837-+-merge bits appservers into appservers

65c7b0fc94-+-Prepare to replicate additional tables to labsdb (with Legal OK):

d825668d98-+-Switch LVS servers to include standard

9a5a167f2b-+-Remove temporary file-removal for /etc/init/enable-rps...

201399b61c-+-switch RPS to using up_command

4df3cb9c6f-+-mediawiki::monitor -> mediawiki::monitoring

dc5fdd1378-+-Merge "mediawiki module - lint fixes" into production

f107bf3a8c-+-disable ondemand service w/ cpufrequtils

a39bb2731e-+-mediawiki module - lint fixes

8422a2ca28-+-mediawiki::jobrunner -> mediawiki::jobqueue

9d01137511-+-bump esams lvs txqlen to 20k

1e7bf18d25-+-Merge "Allowing a configurable StatsD server" into production

72faa54470-+-manifests/misc/statistics.pp specify group as array

4e7a2d3750-+-fix trebuchet groups to be an array

ad9e465610-+-Disable job restarter if run_jobs_enabled is false

39adcae810-+-bring systemuser group into class systemuser::groups

6bffbfd2ec-+-Merge "Adding Ferm rule for OCG HTTP" into production

10ee973864-+-service accounts get 'systemuser' group by default

5bf6809923-+-Purge vimrc.local

807745aa1f-+-Merge "rename role::mediawiki::job_runner -> role::mediawiki::jobrunner" into production

b55f64d847-+-Merge "beta: NFS no longer used for mediawiki deployment" into production

23bf61422a-+-eventlogging: moving monitor graphite class in autoload layout

e2ea1b4b63-+-Merge "Monitoring: monitor eventlogging thresholds" into production

362e435e10-+-Monitoring: monitor eventlogging thresholds

527a49ff17-+-Merge "contint: split Zuul server and merger" into production

1ccba2abc9-+-contint: split Zuul server and merger

ca4cfd6b42-+-rcstream: listen on ipv6 too; apply lvs::realserver

254c2f574d-+-Log wikidata cron jobs to /var/log/wikidata

5c7cefea68-+-stream: fix ip allocation, nginx configuration

62ae28a807-+-stream: fix copy/paste of IPs

2a0f39d535-+-Allowing a configurable StatsD server

f009aea976-+-stream.w.o: move to high-traffic2 pool

6baf0c8a01-+-contint: fix resource ordering for labs slave

357f8e6281-+-rcstream: add lvs, modify mountpoint

f10b24b421-+-Adding Ferm rule for OCG HTTP

d2151aabaa-+-mediawiki::monitor::graphite: monitor thresholds over 1hr interval

f6dad99ebf-+-beta: NFS no longer used for mediawiki deployment

ebe3ebbdd8-+-rename role::mediawiki::job_runner -> role::mediawiki::jobrunner

0588e29b84-+-Migrate beta appserver configs to role::beta::appserver

3b6b28530c-+-remove Deployment::Target['mediawiki']

d4712b4fb9-+-Merge "Completely remove misc::maintenance::geodata" into production

7404385b5b-+-Completely remove misc::maintenance::geodata

cebdf36341-+-remove pmtpa app server monitor_groups

abe5ba59eb-+-Merge "Move OCG default port to 8000" into production

9f3601aeb8-+-Fix maintenance::geodata

163fb2a81c-+-Merge "Kill GeoData Solr, decom servers" into production

a8460357cf-+-admins.pp remove unused groupings and service vol 1

da36a049ca-+-role::mediawiki: drop redundant role descriptions

be18de414e-+-Kill GeoData Solr, decom servers

6e24fa6c7a-+-Clear up duplicate /var/log/mediawiki/wikidata dir

9e83f888fb-+-file_mover uid/gid fix

d9cd9f8cbb-+-file_mover user to generic::systemuser

8d21970882-+-mediawiki::sync: Drop File['/apache']

a494ca52c7-+-Merge "Typofix" into production

5519883e63-+-Move Nrpe::Monitor_service[twemproxy] to twemproxy::monitoring

3144abb442-+-Move Apache gmond module to ::apache::monitoring; pep8 fixes

1b5a127527-+-More refactoring for role::mediawiki

24c82595e6-+-role::mediawiki: drop $run_jobs_enabled param from role classes

74a5d2fc3f-+-toollabs: Remove unused and empty webproxy role

d6b291a8bf-+-toollabs: Add role for mongodb

173376388c-+-Merge "use lsearch as group for generic system user" into production

85442aa953-+-use lsearch as group for generic system user

ada66650ea-+-Merge "remove deleted search admin group from search" into production

0682e70445-+-remove deleted search admin group from search

ce2fda22f4-+-Merge "don't define /var/log/mediawiki in maintenance" into production

1da25e73dc-+-don't define /var/log/mediawiki in maintenance

7db109463e-+-Merge "Move logs to /var/log/mediawiki" into production

1140059dfc-+-clean up fr account stuff in prod for admin

43df9f7b78-+-Move logs to /var/log/mediawiki

31f847299c-+-Merge "run all maintenance crons as apache user" into production

37828fd3fd-+-Merge "beta: Remove File['/usr/local/apache/common'] from ::beta::common" into production

7c7fdda119-+-Merge "add newline to researchdb pw file, easier to read" into production

c424ce87fc-+-admin yam to aluminium.wikimedia.org

aa13595421-+-add newline to researchdb pw file, easier to read

386af25b8f-+-run all maintenance crons as apache user

8e555feba5-+-Fix typo in 2b16da9b4137

6bc7227e5f-+-toollabs: Add MongoDB role

a7d3495ef7-+-syntax error in admins.pp

ba2e6d3273-+-rainman account absented

443a56c87a-+-Specify table and chain for role::dns::recursor notrack rules

696e3d048f-+-Merge "Fix missing semicolon in ferm in role::dns::recursor" into production

069de6ad7b-+-admins.pp deprecation warning

a2887c1e93-+-Fix missing semicolon in ferm in role::dns::recursor

43557e44f0-+-dns recurses: add firewll

76254b6d31-+-rm old admins::mortals class, replaced by yaml

232e287ab6-+-mediawiki: add python-imaging to required packages

65d82b3f8d-+-use analytics-users group vs. stats group

21be64bf45-+-Add custom Diamond collector for RCStream

ec19c23ce4-+-Allow Elasticsearch java version to float again

2b16da9b41-+-monitoring: monitor mediawiki jobs

10875c9a18-+-jobrunner: restart with full path.

6f8ececf3e-+-mediawiki: make jobrunners restart work.

b120464cb4-+-Use m2-master CNAME to make DB rotations neater. This allows a master switch to be a DNS change plus a simple port 3306 tcp redirect with socat until TTL. Should also help if we switch to a haproxy configuration in the future.

2f1b295e66-+-beta: Remove File['/usr/local/apache/common'] from ::beta::common

8e95e7a5e9-+-Move OCG default port to 8000

d2fb5f28cd-+-fix ethtool command for ring as well

82520982b6-+-fix s/ring/setting/ in interface::ring usage

35a3f4a4a0-+-Set rx ring params for bnx2x on 10GbE LVS

0bf93a88cf-+-Periodically restart job runners to avoid pipeline shrinking issue

6cd280ca29-+-replace Service['procps'] with an Exec

324d0540f5-+-mediawiki::web: make $maxclients numeric; simplify config

4000fa348d-+-get rid of {jobrunner,videoscaler}-apache-service-stopped Execs

c0083fc89c-+-role::mediawiki::job_runner: same config for beta & prod

3259a3f6c8-+-Bump vm.min_free_kbytes on LVS/cache nodes

e5745c7b4d-+-File['/a/common']: symlink to common-local; replace => False

eea89f2569-+-Clean up system::role

07bfd0b292-+-hafnium: add firewall

626e765066-+-Merge "Remove declaration of File['/a'] from imagescaler manifest" into production

f07d1f6c3f-+-Remove declaration of File['/a'] from imagescaler manifest

052a0a69b0-+-Merge "stat1010: stats group -> analytics user group" into production

4a63400aa1-+-stat1010: stats group -> analytics user group

a8d8047e04-+-rm old admins::pmacct class, replaced by yaml

a43a568aa8-+-rm old admins::parsoid class, replaced by yaml

d989c07a88-+-add yaml group for PDF QA users, switch tantalum

84e0352833-+-admin yaml labstore*

199dff1416-+-admin yaml /virt100[8-9].eqiad.wmnet/

646230f667-+-Move beta-specific configs from role::mediawiki::common to role::mediawiki::appserver::beta

fdc2044ede-+-role::mediawiki::common: remove if $::realm == production guard

d9f61a2316-+-Merge "Comment out diamond::collector::nginx on rcs100x" into production

b7f22710ed-+-admin yaml analytics1026 refs 'analytics-users'

27d3830c07-+-Comment out diamond::collector::nginx on rcs100x

2565fd35ae-+-cleanup old ircd and ekrem

1b6a5e6068-+-Merge "include ::diamond in ::diamond::collector" into production

5ba61a7d8e-+-Use proper analytics/refinery git url

3819adc3fd-+-include ::diamond in ::diamond::collector

decbec48ef-+-Add deployment config for analytics/refinery

df3b002d21-+-Merge "rm admins::ldap, replaced by ldap-admins yaml" into production

39b53bb41e-+-Merge "diamond: add diamond::collector::nginx resource" into production

869ec7e3f7-+-admin yaml sanger

c08717551e-+-diamond: add diamond::collector::nginx resource

433f00aa47-+-Fix /a/common duplicate def'n

f3cd785fce-+-rm admins::ldap, replaced by ldap-admins yaml

e2c221fb28-+-rcstream: enroll in ganglia; add system role

d4a6125b3f-+-Add service check for rcstream backends

35b6f43af4-+-Get rid of role::mediawiki::appserver::test

5b9fd5a747-+-Merge "mediawiki::web: Remove $::lsbdistrelease guard" into production

95723650d9-+-Merge "mediawiki::sync: mkdir /a/common" into production

62b63f187e-+-admin yaml stat* and analytics fixups

14ddc98bbe-+-ircd stats enabled vs enable

c266560c9a-+-webserver: fixing duplicate declaration of apache-mpm

74e4240a8b-+-Only run ifup for tagged if something changed

534efca5df-+-only re-apply RPS on change

842c39f41f-+-Not saving Kafka jmx  metrics via jmxtrans to an outfile on disk

260ee56e7a-+-Add path param for txqueuelen check

17d3c8940c-+-txqueuelen 10K for 10Gbps LVS interfaces

7a41d85fef-+-ircd_stats path fix

62935c6d32-+-send user and channel count to statsd for ircd

77853ced4f-+-Merge "disabling/removing users kwang and csalvia from admins, site.pp, data.yaml, icinga contact groups" into production

762473c776-+-disabling/removing users kwang and csalvia from admins, site.pp, data.yaml, icinga contact groups

2e14c11237-+-Merge "Tools: Install user-requested packages" into production

4d3f9bab61-+-Add bgwriter ganglia stats to postgresql

a99ee29540-+-granting brion and dr0ptp4kt stat1003 access RT768 and RT7569

d37109dc98-+-set datasets user shell back to /bin/bash

ec0eda5f72-+-admin yaml for tin

69908a8f91-+-admin yaml for wtp* (parsoid)

3e50e3cc0c-+-admin yaml terbium.eqiad.wmnet typo

8477ccbe80-+-admin yaml terbium.eqiad.wmnet

ed896cce9b-+-admin yaml for labnet1001

5f86438ece-+-admin yaml rhenium.wikimedia.org

49ae08ffcc-+-admin yaml for virt1000

d3dad40153-+-admin yaml for virt0

b14ac7772b-+-delete admins::labs, has 0 members currently

fc1cc1a2ea-+-provision role::rcstream on rcs1001 & rcs1002

a8f98afccb-+-Move rcstream server implementation to external repo

b7fb78e2c1-+-Force Hive to pick HCatalog from local file system

3d7162f264-+-admin yaml for titanium (archiva)

125e5dbc15-+-admin yaml for osmium (hhvm box)

3930260401-+-zirconium yaml: it's 'admin', not 'admins', duh

21c42ae949-+-admin yaml for zirconium

fe37d396cf-+-adding bonded port labstore1001

52798aba21-+-ensure passwords dir exists on stat1003

d9c9df58ab-+-mediawiki::web: Remove $::lsbdistrelease guard

246289b875-+-Tidy role::mediawiki following I9fe649547

d5ee28ca71-+-role::mediawiki: clear up nested class hierarchy

abfcbfa816-+-puppetize researchdb password file

6e783f45b8-+-admin yaml fix gadolinium.wikimedia.org

c84707b90b-+-admin yaml fixing dataset user dependencies

5bce1ee880-+-admin yaml convert oxygen and snapshot*

9735a249de-+-Specify the backup pool in mysqlset

9365ee6f50-+-Merge "Fix a variable reassignment issue" into production

13cdc0bb7e-+-Fix a variable reassignment issue

7d504db942-+-Use HCatalog as default auxpath for Hive

83a557b878-+-Weekly schedule for dbstore1001

56978dfdec-+-puppet_compiler: add ferm rule to allow web access

4079bebc52-+-mediawiki::sync: mkdir /a/common

a6a7a7cbd2-+-remove dangling reference to appserver package in contint module

c963738b99-+-mediawiki: add /apache symlink; move symlinks to mediawiki::sync

31aee72ea0-+-stop managing Package['wikimedia-task-appserver']

189520ec60-+-add /etc/apache2/wmf & /usr/local/apache/common

c3ce0d4234-+-fixing generic::systemuser typos ..again

ec2ef38306-+-Merge "Remove wikimedia-task-appserver from app servers" into production

8557abb7a4-+-bad var interpolation from ssh_key resource systemuser

9b8eb8e902-+-typo for ssh_key in systemuser.pp

ecc5c73c34-+-datasets systemuser under dataset role

4e5e04fbc1-+-Remove wikimedia-task-appserver from app servers

fdcfb3c1ea-+-admin yaml for rdb (redis) boxes

f2dfc27a95-+- admin yaml ssl*

2112ce904b-+-convert logstash root users to admin yaml

735b1751d7-+-enable RSS for LVS servers

1842e08982-+-Add optional RSS setup to interface RPS script

1c6719a80a-+-admin yaml for mw*

3f23eaa04d-+-admin yaml /^mw10(0[1-9]|1[0-6])\.eqiad\.wmnet$/

d8cbc7c414-+-admin yaml osm-cp100[1-4]\.wikimedia\.org

f8ed4522af-+-admin yaml stragglers

9f71130fa0-+-Drop stub role::mediawiki::maintenance class

7d963c84c9-+-admin yaml potassium & sodium

82a9bc008b-+-admin yaml for pdf* and  pc100[1-3]

111cbed296-+-Merge "dissolve mediawiki::pybal_check into mediawiki::users" into production

e3bda0acfa-+-admin yaml vanadium.eqiad.wmnet

8bc81cbd3c-+-admin yaml  /^tmh100[1-2]\.eqiad\.wmnet/

72cf3179de-+-admin yaml  /^solr100[1-3]\.eqiad\.wmnet/

694dd4dedb-+-dissolve mediawiki::pybal_check into mediawiki::users

472e4df0b0-+-admin yaml node /virt100[1-7].eqiad.wmnet/

42cb9160ed-+-admin yaml for potassium

349d9b6b50-+-admin yaml tungsten

a837fb24b4-+-admin yaml analytics*

1c1448cfc0-+-admin yaml for iodine

0c41247aa0-+-admin yaml for palladium

b825b86f90-+-admin yaml analytics1009.eqiad.wmnet

535576ba7c-+-admin yaml for tridge (backups)

c091c93735-+-Merge "Switch LVS to "performance" cpufreq governor" into production

c2a1762afe-+-naggen: avoid clash with saltmaster for packages

93f7aa80b9-+-naggen2: remove ensure_resource

bc5bb37456-+-naggen2: remove references to the config file

751cf961b2-+-naggen2: fix ensure_resource

dc900ee381-+-naggen2: read config from puppet.conf

5b5206c684-+-Fix a typo introduced in 1a0605b

1a0605bf52-+-Split interface-rps script File resources to class

692919dd54-+-icinga: replace naggen

21f6fe4f83-+-Remove misc::deployment::scap_scripts from terbium

58988c7253-+-Merge "Update reference to role::mediawiki::configuration::php" into production

1312d48a6e-+-Merge "remove admins::jenkins, replaced by yaml" into production

2537181e85-+-Update reference to role::mediawiki::configuration::php

c878097d7b-+-remove duplicate admins::roots from contint boxes

f450e33bf6-+-add missing whitespace in contint yaml

329d1a1825-+-Switch LVS to "performance" cpufreq governor

ab47728f4f-+-Move RPS config to site.pp where it belongs.

5e3c7233cb-+-remove admins::jenkins, replaced by yaml

2bf06804b4-+-migrate jenkins users/admins/roots to admin.yaml

ab2b9d7f90-+-admin yaml for analytics1004.eqiad.wmnet

e92b974034-+-admin yaml analytics1003.eqiad.wmnet

493c2913b8-+-search-roots group for search*

ce50baf54b-+-admin yaml for silver (ldap)

a1d4dfdbda-+-adding deployment group to search*

7222087844-+-remove dupe wikidev logic for lucene role

8eecac82ae-+-admin yaml for search*

81317d3202-+-apply mediawiki::sync class on tin

32b72bd95b-+-admin yaml for swift boxes

daf430805e-+-admin yaml for strontium

883b75f58c-+-Merge "remove mobile1001-1004 from site.pp - unused" into production

bda342a178-+-restore /etc/php5/conf.d/igbinary.ini on app servers

15ddc24d92-+-remove mobile1001-1004 from site.pp - unused

0231274b7c-+-admin yaml for ms* hosts

3e4377bdb5-+-admin yaml mobile100[1-4]\.wikimedia\.org/

94f0819ee2-+-admin yaml for zinc (solr::ttm)

44378c0e06-+-admin yaml for hafnium

c56214fbef-+-commenting out admin logic on mchenry.  Accounts are added fine, but it creates a lot of old puppet noise.  If we added new opsen we could uncomment and run but since that's rare this seems reasonable.

aaecf92684-+-admin yaml for mchenry/mexia/rubidium

1852d176f3-+-admin yaml for nitrogen

fff33b68ef-+-admin yaml for nickel

afc007cd20-+-magnesium admin yaml

26f832066e-+-admin yaml for neon (icinga)

0167ac14ed-+-admin yaml for remaining lvs hosts

0a8684f826-+-dissolve mediawiki::config::*

c1feb9f28a-+-admin yaml for linne.wikimedia.org

fdf8fa46f7-+-Revert "add researchers yaml group to stat1003"

fa7755b9ac-+-add researchers yaml group to stat1003

88fdd4e974-+-Include role::mail::sender in role::labs::instance

d362ec4086-+-Revert "Labs: Add deployment related sudoer rules for svn group"

fe64d6db24-+-remove admin for labstore tmp

c2a9c4a468-+-admin yaml for labstore100[12]\.eqiad\.wmnet/

44d76fc123-+-admin yaml for es([569]|10)\.pmtpa\.wmnet/

ea4dd64497-+-fix dupe user logic for erbium

a094b8bbd3-+-admin yaml for erbium.eqiad.wmnet

bbea317b99-+-add releaser roles to node caesium

abb49c4972-+-admin yaml for tarin.pmtpa.wmnet

e6309ed3aa-+-admin yaml for eeden.esams.wikimedia.org

280233f7e0-+-admin yaml for dysprosium.eqiad.wmnet

793819fbff-+-admin yaml for ekrem

6b7ed48c8c-+-admin yaml for dobson

ba593fb5db-+-admin yaml dedup account logic for dataset hosts

708a521cae-+-add new yaml groups for release uploaders

6e47c0a03a-+-admin yaml for dbstore hosts

96d27e15a4-+-admin yaml to dataset hosts

b851e03b8e-+-still require the wikidev resource but not class

62fe465b28-+-remove wikidev requirement from releases role

9587faac00-+-Revert "caesium - revert yaml admin include"

b60fdb774c-+-include vs. require wikidev in releasers group

e1c2d4e204-+-remove dupe embedded user/group management

40085609f7-+-Merge "grant cscott deployment access" into production

92d37fa130-+-redeploy admin to fenari

a04c3eac03-+-Typofix

291d3c20d3-+-grant cscott deployment access

c650279ded-+-enable spamassassin SPF debug logging

f32fd267ca-+-Specify puppet:///modules/labs_vmbuilder

36d55f4c4d-+-Tools: Install user-requested packages

e95a7ae460-+-toollabs: Install pastebinit

d08802a82a-+-eventlogging: Remove unused MongoDB code

5266f04f54-+-dynamicproxy: Make proxy depend on cert being installed

03d5bd0458-+-caesium - revert yaml admin include

dd35b5d232-+-Revert "fenari to admins yaml"

fa3cb31eab-+-remove duplicate awjrichards from fenari

fba205fdbc-+-fix syntax for elasticsearch group

63bf555d4c-+-admins: add elasticsearch-roots to elasticsearch nodes

c79ad642ef-+-helium,holmium,hooft,manutius,iron to admin yaml

c147140d17-+-Replace the bits of labsmediawiki that aren't wikidata-related.

c3939782b8-+-fluorine.eqiad.wmnet to admin yaml

15ff55bb31-+-fenari to admins yaml

bef5ae2974-+-misc admin yaml includes

069ac2efa4-+-migrate cassandra roots to admin yaml

e64072904a-+-bast1001 to admin yaml

23969bcb92-+-Fix indent

0822677492-+-puppet3: correct pin file extension

c83f5cee83-+-move contents of mail.ini to standalone file

03a7c561c5-+-some small lint/style fixes on 'ocg'

66e7c33a6b-+-Merge "Allow override of redis host" into production

7e335c4ff4-+-Allow override of redis host

0974851725-+-puppet: pin packages to the correct version

2423f3bd8b-+-Merge "puppet: remove restart cronjob" into production

0cbae0407b-+-Remove mysql client from bastionhost

4a5a13995b-+-remove 'maerlant' from site.pp/dsh/dhcp

dbc8399c0a-+-postgresql.pyconf is a template not a file

9dc5fc61e4-+-postgresql ganglia plugins

04d44bf381-+-contint: rsync host in labs

31a2a17f53-+-contint: puppet-lint is now available in labs

634b4b25eb-+-Merge changes I5886bee1,I2aed0e2c into production

fd20d0d1f9-+-let tin have a proper IPv6 address

ae37fbe76e-+-fix "read_only" setting in rsyncd setups

28eae4e75f-+-puppet3: fix videoscaler role

ba61bc092a-+-remove wikidev group include, duplicate now

1e4c717afe-+-migrate ytterbium to admin yaml

10de405f77-+-migrate antimony to admin yaml

6d34d4d47e-+-Add a warning about running scripts as mwdeploy to misc/maintenance.pp

3002bb2156-+-convert parsoid users for cp1045 to yaml

a267498752-+-Merge "delete mwlib.pp? (pediapress) move to pdf/ocg?" into production

6f6db0631a-+-re-add glanceconfig to role::keystone::server

fdc8c63b0d-+-dupe wikidev management for some hosts like cp1045

346c3950c6-+-ams text varnish outliers from cp* admin deploy

2ebd0bfaf2-+-Merge "add tgr to stat1003 special accounts" into production

83f37e4c10-+-add tgr to stat1003 special accounts

35c4d2cad4-+-add tgr to admins::mortals (deployers)

f467498035-+-admin user management amslvs, db*, labsdb hosts

6cccc9c4a4-+-Merge "move refreshLinks cron logs to /var/log/mediawiki" into production

579463b2b0-+-move refreshLinks cron logs to /var/log/mediawiki

58466ce536-+-trying again w/ amslvs1

17d68a1d51-+-not catching amslvs1 yet for admin

9077bc1701-+-admin deploy amvslvs1, db72.pmtpa.wmnet, labsdb1001.eqiad.wmnet

cbc039c6a1-+-Merge "retab role/nova.pp" into production

d370ccb916-+-Merge "parsoid: systemuser is only for production" into production

eb9a76c88b-+-retab role/nova.pp

f83526eab4-+-deploy admin for ops to cp* and es*

b7605bb8eb-+-admin module deploy cp1037 and es1004

247bd21d6c-+-Merge "Adjust role::zuul::labs" into production

516eb4fdad-+-contint/beta: set natfix for the labs shared proxy

6195b1664e-+-contint: apply beta natfix on Jenkins slaves

77fb3535c5-+-Add memkeys to role::memcached

9eaa849f19-+-Merge "contint: symlink for Jenkins email templates" into production

363f40180f-+-Merge "contint: install python-requests on all hosts" into production

bdde240c26-+-Merge "contint: get composer on Jenkins slaves" into production

ba8a56048a-+-Merge "Labs: Add deployment related sudoer rules for svn group" into production

2c90ba94fd-+-Merge "contint: remove ruby-bundler outdated package" into production

5fbdd29b27-+-puppet_compiler: assign mime types to produced files

6621f5320f-+-puppet_compiler: update to 0.2.2

b134536258-+-prevent apache2 service log churn on non-web mediawiki servers

7c944ee060-+-puppet3: fix $mariadb dynamic lookup

72c2531ffa-+-fix analytics servicegroup name

2f03e0fa44-+-remove db1011 from s4

0fb5987170-+-deploy db1068 to s4

9bf97bc1d7-+-fix sudo stuff for ops/sudoers

8016cd3b10-+-manage wikidev group explicitly

6a4033c086-+-initial data.yaml for users/groups

16109c2643-+-Merge "fix quoting, arrows etc in deployment.pp" into production

41be3def0e-+-standardize a few things in admins.pp for conversion

461a59fac5-+-Labs: Add deployment related sudoer rules for svn group

951fdaf17f-+-restore old ircd role/module for ekrem

6352ce2021-+-puppet_compiler: fix user in differ

250b51ab10-+-puppet_compiler: add naggen installation

088b3c7ee6-+-wm-rc-irc echo and not relay typo

3e76a140ea-+-ircd-ratbox and udpmxircecho puppetized

6dcce8495e-+-Renumber many users to match labs:

c8153f2076-+-puppet_compiler: easier jenkins launch with parameters

d27352ffb1-+-role::puppet_compiler - lint and fix

4c9e6e861a-+-Merge "tools: Tune nginx to handle higher load" into production

e5be046a63-+-tools: Tune nginx to handle higher load

33a1b798d6-+-creation of role::puppet_compiler

de63d2783d-+-Merge "Avoid connection tracking for DNS recursors" into production

901140dafa-+-Merge "puppet:self::master use newer package names" into production

319ec367c8-+-icinga: stop pages from 5xx alerts

cd14c2158a-+-fix quoting, arrows etc in deployment.pp

88507c53fc-+-retab misc/deployment.pp

98fc972a57-+-add tgr to admins::bastion

8dcc61281e-+-create account for gtisza (tgr)

1f585cec9c-+-Merge "Tools: Install git-svn" into production

db360bfb3e-+-contint: install python-requests on all hosts

de87cabb1c-+-contint: symlink for Jenkins email templates

1de38a3dd9-+-parsoid: systemuser is only for production

986fefb570-+-Adjust role::zuul::labs

33c3abbab4-+-contint: remove ruby-bundler outdated package

bd7c01f5f7-+-contint: get composer on Jenkins slaves

f1361f939b-+-puppet:self::master use newer package names

de345342e7-+-Remove mw1151 from the bits appservers

95755d0349-+-removing automatic cleanup logic.

057dc2fa3a-+-admin module for user/group/permissions cleanup

78c9da0da4-+-diamond to remaining lvs servers

cf6fb2433a-+-Avoid connection tracking for DNS recursors

ea6fce36e3-+-Merge "dns recursors: add ferm rules" into production

6068c00df3-+-pmactt: correct compilation under puppet 3

7a0dba6780-+-puppet-compiler: module for installation

ed894a15dc-+-Skip jobrunner role def on tmh nodes

876f081b2e-+-Use role-specific Exec to manage wikimedia-task-appserver's apache

9e9980ec12-+-Qualify mediawiki::jobrunner in a couple of other places

b9d3037a6f-+-Fix-ups for Ie0807c706

98f3808af6-+-Consolidate applicationserver and mediawiki modules

a41f2d234c-+-drop unused 'group' param for role::applicationserver::common

c245b33296-+-deduplicate mediawiki / snapshot packages

059e82a6c8-+-Merge applicationserver::packages into mediawiki::packages

2ba343debb-+-Rename jamesofur to jamesur and sync UID to labs.

0ba7c9e1aa-+-Mark River Tarnell's account as disabled.

6a44a2c7ad-+-Merge "Use m2-master CNAME to make DB rotations neater. This allows a master switch to be a DNS change plus a simple port 3306 tcp redirect with socat until TTL. Should also help if we switch to a haproxy configuration in the future." into production

7727534615-+-move applicationserver::hhvm to beta::hhvm

415d0917bf-+-Merge applicationserver::sudo into mediawiki::users

8a88dcd15d-+-remove reference to obsoleted configchange script

f89a5599a1-+-Consolidate mediawiki::users::* into a single class

d8a61ef24b-+-Remove duplicate packages from imagescaler manifest

0cad9846ba-+-Correct typo in lilypond package name

b372b7de8c-+-Express additional package dependencies of wikimedia-task-appserver

0cb6d2386c-+-Add package dependencies from wikimedia-task-appserver

45f15e28fd-+-Delete applicationserver::cron

f121c4a847-+-Merge "Remove cleanupipc cronjob" into production

58a10afbbc-+-Remove cleanupipc cronjob

0c938db40b-+-icinga: Fix anomaly detection checks

52f93ad05a-+-bacula/backups: Use defaults-extra-file instead

a680fe4ce4-+-Adding the predump script

cdc9abe8ce-+-Also add /srv/backups

32ef12c233-+-Add /a/backups fileset to bacula director

70346aecd6-+-Revert "Revert "Introduce role::mariadb::backup""

f1d22656f0-+-Revert "Introduce role::mariadb::backup"

0cdadcd153-+-Introduce role::mariadb::backup

644b0a4a56-+-reassign db1056 to S4 commonswiki

ca9f1a65a0-+-bacula: allow mysqldumps to be kept locally

225ecfd3b6-+-Revert "diamond: use native Puppet types for collector vars"

d503c304b0-+-Merge "adjust rsync path for httpd configs" into production

2ef3d9ed05-+-adjust rsync path for httpd configs

0f1c1c6a03-+-Remove libapache2-mod-php5 from manifests::misc::noc

da9ec4fadf-+-dns recursors: add ferm rules

14a493c27b-+-Merge "Run rebuildEntityPerPage.php on Wikidata (once per week)" into production

2b35e0a316-+-Merge "diamond: use native Puppet types for collector vars" into production

6da150c96e-+-diamond: use native Puppet types for collector vars

b9029c0e0b-+-Run rebuildEntityPerPage.php on Wikidata (once per week)

e70d1d8f6c-+-sync apache:incl.rsync server & network constants

c9d0bf7f6c-+-add rsyncd config for apache config sync

0c6f2df8ef-+-Merge "Give roots access to osmium" into production

58b83c71a5-+-Merge "role::analytics::kafka: do not call keys() on non-hash" into production

dd669c195d-+-role::analytics::kafka: do not call keys() on non-hash

0a4220346e-+-Give roots access to osmium

0e62205c89-+-add /srv/httpdconf to replace /h/w/conf/httpd

83bdf01274-+-tidy up applicationserver::packages

03960f9559-+-Merge "Lint mediawiki::cgroup" into production

bbc429c32b-+-misc diamond hosts who do not use standard

e21fea75f6-+-Lint mediawiki::cgroup

92ab022ebe-+-Merge "Provision apache user via Puppet" into production

cee5191256-+-Provision apache user via Puppet

05a38ccb15-+-amslvs diamond deployment

dec9d42d88-+-diamond for dataset and ^lvs1*

7f7dc67de7-+-lint mediawiki module's init.pp

9758e6b664-+-remove mediawiki::twemproxy

af29d60476-+-use twemproxy module on mw106*

b98771d82d-+-Merge "twemproxy: allow /etc/default/twemproxy to be passed in" into production

1db9e0119c-+-twemproxy: allow /etc/default/twemproxy to be passed in

85808ddfe4-+-Add gerrit ferm rules for production

eee182b206-+-use identical check command for all LVS monitors

65cbe8b2e4-+-deploy db1070 and db1071 to S1

8f0ec6fe3f-+-Adding libwww-perl on stat1003 for Erik Z's wikistats stuff

6aa713a0a6-+-Amend twemproxy config_file path

b74843ec70-+-Follow-up to I3f57347d2: Qualify class path

2b93254567-+-Apply twemproxy module from I6f1f1039b on mw1063

0c2fd1c47f-+-Factor twemproxy out of mediawiki module

2f5e115538-+-Merge "Logstash: Add support for logging irc !log messages" into production

4c1ec53575-+-Logstash: Add support for logging irc !log messages

a2e5aea837-+-Apply mediawiki::cgroup on osmium

6a70821a47-+-hhvm:dev: install libthai-dev for wikidiff2

1ae41b6874-+-fix service group in kafka role to unbreak icinga

c2cc897a1c-+-set carbon cache/creates/updates on shutdown

19767ee173-+-puppet-lint in labs

91340f7cf0-+-Merge "bits: change test URL in static assets check" into production

58e1c9b763-+-bits: change test URL in static assets check

db427fd08a-+-Add wikidiff2 to osmium checkouts

a15c8062d2-+-mobile varnishes: enable GeoIP

cffaf7f44f-+-Tools: Install git-svn

16583544b9-+-fix carbon destinations with additional workers

78694e019e-+-Only using hive-partitioner to create partitions on pagecounts table

9094606c88-+-Adding Leila Zia's new ssh key

80c43ea007-+-Merge "osmium: git-clone luasandbox and fss as well" into production

18eb3d72f5-+-osmium: git-clone luasandbox and fss as well

2126f4675c-+-Role for miscellaneous services DBs m[123], but currently only m3. Reassign db1043 to m3 since it no longer suits s1.

4c9684aae8-+-uWSGI apps should place sockets in /run/uwsgi

b0e559bfa3-+-disable prefer_ipv6 on esams mobile/upload caches

c8ba224cdf-+-blog: remove nrpe

cdedb3c7b3-+-blog: moving firewall to node level

23ae323b4f-+-Merge "rollout diamond in standard for precise only" into production

41ff296065-+-Fix another call to the swift password class.

a061095221-+-rollout diamond in standard for precise only

c8b7c120c9-+-changeup diamond collection to 60s

890721becc-+-Including standard and admins::roots on analytics1004

b77d4c08b5-+-Adding manybubbles on analytics1004 for some elasticsearch testing

52fa7f82cd-+-Make class call work.

0498dc1481-+-protoproxy: call enable_ipv6_proxy in a sane way

6b54e73ead-+-Removing Leila Zia's SSH key

e910607ec3-+-Fix dynamic scoping in iptables.pp

47eedfd352-+-Get rid of redundant and confusing $cluster defs.

6ed0479e34-+-RT ferm rule: fix protocol, it's tcp not smtp

484cfb5a78-+-specify protocol as TCP in ferm rule for RT smtp

0e191c580c-+-add ferm rule to allow smtp from mchenry/sodium to magnesium

8e3f809136-+-Fix dynamic scope lookup in maintenance.pp

0ee2be64c5-+-Merge "Fix dynamic scope lookup in openldap module." into production

ac58a48628-+-Fix dynamic scope lookup in openldap module.

81c5bedf1b-+-Explicitly set config in openstack template.

9eb9526a07-+-Fix the use of $nagios_group.

111961591c-+-Merge "Tidy ::applicationserver & ::applicationserver::pybal_check" into production

4f27bba018-+-Fix a typo (planembad=>planemad)

c7bc4a7e37-+-Create a wikimaps_atlas postgis database

a8f35698cc-+-Merge "Include the labs_initial_content role in labs_vagrant." into production

10ea96c9a8-+-toollabs: Add gdal-bin to the exec environment

5a9eef6ce7-+-Tidy ::applicationserver & ::applicationserver::pybal_check

c4b0fec821-+-Run Wikidata maint. scripts as apache instead of mwdeploy

13ca5ff1a1-+-Remove long absent Wikidata crons from puppet

7b6149989d-+-add kleduc to analytics users for hadoop access

558dadc419-+-Include the labs_initial_content role in labs_vagrant.

e20343fc85-+-account for kleduc and add to admins::privatedata

8aa0f76675-+-Merge "Remove the wikidata_singlenode module and the labsmediawiki role" into production

ceb8991944-+-toollabs: Add maven to dev_environ

67f62fd160-+-Remove the wikidata_singlenode module and the labsmediawiki role

cf9dbb02d9-+-Merge "Disable the 'sam reed old' account." into production

8da1988280-+-Merge "Rearrange handling of the 'vagrant' user for labs vagrant." into production

82a37f1f57-+-Rearrange handling of the 'vagrant' user for labs vagrant.

a817c4cc4e-+-toollabs: Add expect to exec nodes

70a7f618c2-+-snapshots, dumps and datasets all use datasets user instead of backup

e084f47a7d-+-Add oit admin group with jkrauska, Add access to sanger RT #7428

a55f9f1833-+-Disable the 'sam reed old' account.

3fa6a46b4b-+-Add 'rcstream' module for broadcasting recent changes over WebSockets

f9869d11a7-+-Adding modules/mariadb as a git submodule

c663bb0918-+-Removing mariadb module in prep for adding it as a git submodule

b8ea5a845d-+-Removing modules/varnish in prep for adding it as a git submodule

12dd0ea751-+-Removing nginx module in order to add it as a git submodule

d60548a776-+-deploy db1067 to s2

0f03db7790-+-deploy db1066 to s1

1dbc89ed43-+-remove release users from admins::restricted

bb504088db-+-Merge "Tools: Install jq and pdftk" into production

ef1d0e80f2-+-Copying glam_nara logs from erbium to stat1002

8f19cf5f71-+-add dbrant to stat1003 "special users" and bast

e51bb6d033-+-Tools: Install jq and pdftk

306784d4b9-+-add dbrant to mobile release uploaders

f9d604a70a-+-add account for Dmitry Brant

6fe56faacb-+-create admins::bastion for _just_ bastion access

169a46f3e8-+-antimony: add firewall

1748c08977-+-caesium: add firewall

a334ab1b85-+-releases: add ferm rule

7e9efd076e-+-magnesium: add firewall

550ede39ca-+-Merge "racktables: add ferm rules" into production

0eab35362c-+-Merge "rt: add ferm rules" into production

9766e50491-+-zirconium: add firewall

12d827e563-+-Merge "contacts: add ferm rule" into production

4681f9b911-+-Merge "bugzilla: add ferm rules" into production

0c3d0ea931-+-Merge "wikimania_scholarships: add ferm rule" into production

049f82dae4-+-contacts: add ferm rule

31cd96feee-+-Merge "etherpad: add ferm rule" into production

622a9e1740-+-Merge "planet: add ferm rules" into production

b7dcaa4b6c-+-wikimania_scholarships: add ferm rule

9ca7bdf781-+-role class for diamond, move generic into init

5e16ae3fc7-+-Attempt to fix RANCID cron job

3787a77791-+-deploy db1064 to s4, db1065 to s1

325d650a7b-+-Move cluster definition to the node level.

ccdb53fa8b-+-make role/coredb more readable

3b62077dc9-+-delete mwlib.pp? (pediapress) move to pdf/ocg?

581fa16f4f-+-Merge "Revert "include admins::mortals on osmium, to allow MediaWiki deployments"" into production

b4ae28a36a-+-Merge "re-add apache-graceful-all with some fixes" into production

dd4b4ee023-+-re-add apache-graceful-all with some fixes

9853bcc660-+-Revert "include admins::mortals on osmium, to allow MediaWiki deployments"

84f88847d2-+-include admins::mortals on osmium, to allow MediaWiki deployments

ee98209383-+-Make mediawiki::sync depend on mediawiki::user::*

0aa48f7c3b-+-Provision mediawiki::sync on osmium

11c623a5fe-+-Remove dependency on mediawiki::packages from mediawiki::sync

49d518f3ec-+-Apply ::mediawiki::jobrunner on osmium

2cd1af3c65-+-Give netmon1001 manutius's special ganglia handling

bea2c7d0d2-+-ganglia::collector on netmon1001

89e342e595-+-Add missing sites/roles in cache.pp #2

f40549108d-+-Merge "contint: get rid of testswarm user" into production

f1d96b43f1-+-contint: get rid of testswarm user

023c3f1078-+-Add missing sites in cache.pp

05730b3103-+-Merge "add upstart job for idmapd" into production

34d64e3b4a-+-Get rid of $myshell dynamic lookup.

5d674e4796-+-add upstart job for idmapd

05f15629ad-+-tidy mediawiki::jobrunner

9371af3865-+-Make mediawiki::jobrunner not include ::mediawiki

14e97c3c0a-+-Get rid of apache-graceful-all

178754d1e1-+-Fix ganglia check command.

8ddd290b03-+-Pass the correct arguments to check_ganglia.

dbe2db3992-+-Use m2-master CNAME to make DB master rotations neater. This allows a master switch to be a DNS change plus a simple port 3306 tcp redirect with socat until TTL. Should also help if we switch to a haproxy configuration in the future.

e0ce5a1f10-+-few more seed nodes for diamond

8071dca759-+-first diamond nodes

7b2add1f3e-+-Merge "diamond::generic manifest and updates to match" into production

7ee59bd339-+-diamond::generic manifest and updates to match

644afa4d9d-+-Merge "Provision scap scripts using trebuchet" into production

a8d4610c2b-+-Adding modify-ldap-group to permissions

67fb569c13-+-Revert "netmon1001 as a ganglia collector/aggregator"

71ff513364-+-netmon1001 as a ganglia collector/aggregator

9b7baf060a-+-fix more naming collisions when calling unixaccount

761518c9d2-+-fix puppet collision at naming unixaccount invocations for user Gilles

caa5e61ff4-+-logrotate.d/eventlogging: maxage 90 days

25a84d5cbf-+-Use proper DB packages on tendril and dbstore

9fbd8435a6-+-Add amire80 to 'admins::restricted '

8488724f92-+-Add 'gilles' in places where 'gdubuc' was installed.

8f1588573c-+-Add mattflaschen to mortals (following rename from 'mflaschen')

dc6902e636-+-Mention ms-fe servers need to be XFF trusted by MW

4ff1a73dd1-+-Replace db1020 with db1049 in s4

8608d7a133-+-just include ldap::role::client::labs in role

435cbaeb0e-+-include accounts in LDAP admin role, add demon

f8e0aaf652-+-Rename mflaschen to mattflaschen and change UID to match labs.

d2b3253fbc-+-add mhurd to bast1001

879e70ab75-+-add account mhurd to stat1003

21bed0a690-+-add shell  account for Monte Hurd

4cf291da9f-+-full sudo ALL for jkrauska on pmacct (rhenium)

9109523294-+-Move Nik Everett/manybubbles to UID 3304 to match labs

4150ffa56d-+-Update dartar's UID to match labs

be70e7bff7-+-Rename gdubuc to 'gilles' to match labs.

d104dc7577-+-Rename aaharoni to amire80 to match labs.

448ffc4d72-+-Use m2-master CNAME to make DB rotations neater. This allows a master switch to be a DNS change plus a simple port 3306 tcp redirect with socat until TTL. Should also help if we switch to a haproxy configuration in the future.

e9354e3d3b-+-Remove db68 from site.pp. To be rebuilt.

dc6c0db9fb-+-Use correct replication channel name s/m1/m2

1027fab5c8-+-MariaDB multi-source replication monitoring.

2f94dd5d60-+-puppet: remove restart cronjob

52ed82eb73-+-Provision scap scripts using trebuchet

65c16f5942-+-Merge "Change mhernandez uid to 4990, as in labs." into production

07da83f95c-+-Revert "Fix LDAP admin privs"

0cb79a1cd3-+-Fix LDAP admin privs

f55095c879-+-s/git-deploy/Trebuchet/g

a1d98dca7e-+-Get rid of $scriptpath

65d5377f7e-+-Merge "Sync UIDs with ldap for a bunch of  users:" into production

d7c606a610-+-Tool Labs: move git-review to exec_environ

ed00fd672c-+-Change the graphite url to check.

4a69b1f09f-+-blog: bump max backend connections to 256

abf75d1f77-+-Update netmon1001 torrus configuration

39f14b2a3b-+-Merge "Fixing checks for graphite and gdash." into production

f2985160de-+-Fixing checks for graphite and gdash.

97c18e7245-+-Another small fix to icinga config.

2cbe865cdd-+-Add another check using graphite, small fixes.

b92b8a7d39-+-Add scap/scap trebuchet target

c2281b0ce4-+-fix pathnames for /etc/zerofetcher

2d4be01a7c-+-Rename manifest to fix class-lookup issue?

cca5ac9780-+-Update Zero netmapper data from zero.wikimedia.org

f2f872ed76-+-etherpad: add ferm rule

4cd83ae885-+-bugzilla: add ferm rules

2b7039f1e1-+-planet: add ferm rules

abd1f6ae4c-+-rt: add ferm rules

7f6b298d57-+-racktables: add ferm rules

1c906f14a6-+-Add the non SLAAC IPv6 addresses for bastions

7aba65d836-+-motd updates must be sh wrappers

3d940c5248-+-and fix up maxsem's key the rest of the way (still waking up...)

61bd2e194a-+-fix up maxsem's ssh key

1b1156110e-+-Add my new key

2b4aa5e7f9-+-Merge "Add jkrauska to rhenium using an admin group" into production

2431b8b806-+-Add jkrauska to rhenium using an admin group

27eb57e288-+-Scap: Remove mergeCdbFileUpdates symlink

dc2687a45e-+-Scap: purge mergeCdbFileUpdates symlink

f60499f0f9-+-apply role::pmacct on node rhenium

6804b74f2b-+-add 'rhenium' (netflow box) to site.pp

78c99743f5-+-Changing Camus job name

cc666e7e60-+-Fixing quieting of logster job

22dc594823-+-Removing mw-log udp2log instance from nfs1 - this now lives on fluorine

cc086b5ccc-+-Merge "Rename abaso to dr0ptp4kt in a couple other places." into production

9fdf6ecf2b-+-Importing eventlogging logs into HDFS via Kafka and Camus

43cb809a75-+-Change mhernandez uid to 4990, as in labs.

c0750c6512-+-Sync UIDs with ldap for a bunch of  users:

d290295162-+-Change UIDs for a bunch of users:

5b6248b11e-+-add public addrs to lvs300x over 802.1q

b0fe803071-+-fix pathnames for /etc/zerofetcher

255190ff33-+-Rename manifest to fix class-lookup issue?

0054f826ff-+-Update Zero netmapper data from zero.wikimedia.org

16565913ca-+-Rename tfinc to tomasz to match labs.  Also change uid to 1155.

6784ed4f9c-+-Rename mholmquist to marktraceur and sync UID with labs

a915ac189b-+-Merge "otrs: fix allowed smtp address" into production

bb4543848e-+-otrs: fix allowed smtp address

28bbc3d2fd-+-iodine: add firewall

e2861399ba-+-Add 2>/dev/null to processEcho maintenance cron

3c02bd9524-+-Merge "Usage of a weighted loadfactor in puppetmaster" into production

417488084a-+-Merge "otrs: add ferm rule" into production

73793eaf8e-+-Usage of a weighted loadfactor in puppetmaster

83a23b0151-+-otrs: add ferm rule

93b469f07c-+-Merge "split out apache sync scripts from mw deploy" into production

be74467704-+-torrus: Conditionalize declaration of rewrite

971af217d1-+-split out apache sync scripts from mw deploy

6247238579-+-Make puppet cronjob to run SecurePoll/cli/purgePrivateVoteData.php

e789b2b836-+-Torrus: add torrus to netmon1001

b300dac162-+-Introduce role::puppetmaster classes

a9acfbe23b-+-rename ypanda to yuvipanda

3693565b2e-+-fix Yuvi's user name in role for mobile releases

0312b9c4fa-+-Add hhvm::dev; provision on osmium

aa43508350-+-Add wikidev and mortals to osmium

ae1a3a3184-+-Move beta scap source directory off of NFS

097dad52e8-+-Fix typo in key

acb3f65076-+-Tool Labs: minor tweaks to tomcat node manifest

666afc022c-+-Tool Labs: (partial) tomcat support

7d31d176ae-+-Give haithams access to stat1003.

f135fee1ad-+-Add a fresh key for user haithams.

1f02132153-+-Don't ensure=>absent dab's group

6436cf8989-+-titanium: add firewall to the host

5b7ec94f77-+-archiva: add ferm rule

2d855ef9b4-+-Rename misc::maintenance::purge_abusefilter cron job name

173caca6c6-+-Adding diskstat monitoring to hadoop nodes

337d31a171-+-include the snapshot role common class in the other snapshot role classes

b3d0ff7d38-+-Merge "fix pmacct service name" into production

8cf27aef3a-+-fix pmacct service name

8819160adb-+-make sure snapshots have common role class

60f6116d3c-+-Merge "ferm rule for bacula director" into production

7ced02d40d-+-Using separate job for eventlogging camus imports

46fef689eb-+-ferm rule for bacula director

482e36a2f4-+-disable Bayes auto-learn for OTRS now that the db is working well

1cfaf54f91-+-add wikidev group to admins::pmacct

ce34172775-+-Rename abaso to dr0ptp4kt in a couple other places.

6a36e242dd-+-Rename abaso to dr0ptp4kt and change his UID to match labs ldap.

90c918b7c2-+-Change Hashar's UID to match labs.

e764c81a19-+-Remove access for Daniel Bauer

ae6dfbeda0-+-change my UID to match labs

fb52d19522-+-Merge "Sync UIDS with ldap for Faidon and Alexandros" into production

6e5fe0ff2d-+-Merge "miscellaneous improvements for diamond module" into production

73fced9081-+-Adding haithams on bast1001 in order to access stat1003

5550f126db-+-Merge "STFU update-geodata" into production

a1e03a3aa0-+-STFU update-geodata

aca65f865f-+-Remove references to sdtpa devices

93214fa8ad-+-Kill check_job_queue

2a55e9e608-+-miscellaneous improvements for diamond module

34d37e25f0-+-contint: extract android SDK dependencies to a module

6ca735e292-+-Merge "Tools: Install package libxml2-utils for xmllint" into production

a538962440-+-Adding diskstat percent_io_time and io_time to ganglia Kafka view

8d09fddf70-+-Running camus every 10 minutes

a46e926a73-+-Call scap-rebuild-cdbs after sync-common

66299b2f01-+-New config for db1047 as MariaDB 10 all-shards analytics slave.

8fb5f39787-+-Merge "Redirect metrics.wikimedia.org to Wikimetrics" into production

36983015a8-+-Redirect metrics.wikimedia.org to Wikimetrics

a89ac5427f-+-enable bayes_auto_learn for iodine to help rebuild the db

bbc1eb360e-+-remove unused IRC bot from openstack

407a7acc83-+-Tools: Install package libxml2-utils for xmllint

0f5ca79490-+-show what's backed up in motd (rt #469)

e1afdb3b5f-+-Replace Linux RPS setting with a smarter script

abbb2c8c06-+-Merge "echoirc,wikistats,don't quote 'default' in switch" into production

1787143492-+-echoirc,wikistats,don't quote 'default' in switch

d9807348c7-+-Add cp3014 to esams mobile cache backends

58ec33912c-+-icinga-wm/echoirc: add $::realm case for labs

240c1c188b-+-icinga-wm/ircecho: do not set variables in node

165356c0f1-+-remove remnants of the old decom script

c115680d82-+-decom the decom script

6ec194cd24-+-Merge "fundraising: remove nrpe from role" into production

9f93d503a8-+-Merge "poolcounter: remove nrpe from role" into production

42711e040c-+-otrs: remove nrpe from role

8c1aa0712e-+-poolcounter: remove nrpe from role

448fd8fe46-+-fundraising: remove nrpe from role

d362442160-+-Merge "gitblit: remove nrpe from role" into production

df819d3123-+-Add cp3013 to esams mobile cache backends

3b53299c11-+-Exec saltutil.sync_all when adding deployment_server grain

7ccc14d09d-+-Adding 15 minute load average and iowait to Kafka ganglia view

ebcda508b5-+-Sync UIDS with ldap for Faidon and Alexandros

e282c23b57-+-Remove EventLogging consumer for db1047

c16e208f71-+-Merge "Disable account for Peter Gehres" into production

7b6299c2ff-+-Add EventLogging consumer for db1048

f9ee992953-+-Change five UIDs to match ldap

d767e17f6e-+-Merge "Add fonts-vlgothic to imagescalers" into production

36fc24f7f9-+-Add fonts-vlgothic to imagescalers

6d88252e19-+-Merge "turn ircecho into a parameterized class" into production

f43b302a51-+-turn ircecho into a parameterized class

fd9af17167-+-add shell account for jkrauska

ea138161cb-+-Merge "subversion: move ferm rules from module to role" into production

c355e7f5b4-+-Fix the monitor_graphite_threshold check.

fe74c4c925-+-Include standard for the new mariadb roles. Remove duplicate includes added previously to node definitions.

3a09c54d1d-+-rm old wikibugs - replaced by pywikibugs

55b0a080e9-+-Merge "disable account 'akhanna'" into production

f5bcf57d55-+-Substituting the check_graphite script.

4834e9c46b-+-disable account 'akhanna'

2e0b49d73c-+-disable Siebrand's shell account

b964595c68-+-subversion: move ferm rules from module to role

d73aa98c71-+-Update ncsa/snmp rules to include more LANs

e0412278df-+-Merge "Remove access for Jeremy Postlethwaite" into production

84e49eeb2d-+-Merge "Backup gerrit review site" into production

2dee40ca89-+-Remove access for Jeremy Postlethwaite

c01980a33c-+-Backup gerrit review site

d9b6196e46-+-Remove access for four former analytics users:

662c4081f2-+-Update frack ncsa/nrpe icinga rules

c6a0bee0d7-+-fix check_procs for tcpircbot

9619d7ed8c-+-Merge "use --ereg-argument-array  for tcpircbot check_procs" into production

31161b2d2d-+-Add frack to icinga ncsa/nrpe firewall

ee6345117c-+-use --ereg-argument-array  for tcpircbot check_procs

4098786545-+-Fix ferm syntax error in role::tcpircbot

a003a1dd4e-+-snmptraps are UDP not TCP

e2c5830c3b-+-Fix ferm syntax errors on icinga

047028bd0f-+-Merge "firewall: enable on neon" into production

8d4dfa65fc-+-Merge "icinga: replace iptable with ferm rules" into production

e7f78baa88-+-firewall: enable on neon

aacfc21186-+-Add IPv6 address to carbon

0921621446-+-tcpircbot: add a role

cc809360b2-+-Revert "turn off rsyncs to/from dataset2, prep for 12th floor move"

6868ae50b7-+-disable account aengels

b9c79393d3-+-update-initramfs for bnx2x early boot options

c0864a71f3-+-move cp301[34] to private1-esams

d2a0678169-+-Merge "Puppet templates are 'content'" into production

607dfa1951-+-Puppet templates are 'content'

1734ad3df8-+-Merge "Customize the node runtime per OS" into production

5e767fb14b-+-Customize the node runtime per OS

55f6eb4a6e-+-Oo, devices => array of disks did not work as advertised for diskstat plugin, commenting out

ee54352459-+-Using only Kafka log disks in diskstats monitoring, adding to kafka ganglia view

da288c2850-+-webperf: Add statsd module for mw-js-deprecate

6f76974d94-+-Including ganglia::plugin::python { 'diskstat': } on Kafka servers

6c2fcc2a84-+-Merge "Tool Labs: remove conflicting package" into production

08fd22693a-+-Fixing varnishkafka view host regex, removing erroneous client req

86df338e2d-+-Tool Labs: remove conflicting package

2ac4e1f8df-+-remove sudo::appserver from bastions

00b232ea34-+-Fixing kafkatee ganglia view host regex for a few metrics

8ea4674c2a-+-remove last vestiges of stafford, long since retired

08ea7dbd7e-+-Fixing metric names in kafkatee ganglia view

e34b6e8faa-+-Disable account for Peter Gehres

717dbb2061-+-gitblit: remove nrpe from role

825387e769-+-swift: bump rsync max connections

f9fde53c12-+-Removed decommissioned pdus from monitoring.

1b13ee221f-+-icinga: replace iptable with ferm rules

6b414d499f-+-remove nfs2 from site.pp

11b24d0f7f-+-remove nfs2 from ldap and base config

c5b8fa0631-+-Merge "Don't try to have puppet remove werdna's old keys" into production

89f35ff6f2-+-Don't try to have puppet remove werdna's old keys

ccb93ffdbe-+-Now running varnishkafka on text varnishes

420bb96913-+-Merge "One more andrew/werdna renaming bit" into production

4599e0216f-+-One more andrew/werdna renaming bit

fd8058b1ca-+-Merge "Specify 'user' for removed ssh keys" into production

158109aa40-+-Merge "Rearrange andrew vs werdna:" into production

5de5e1e1d8-+-Specify 'user' for removed ssh keys

b59b2f6b27-+-Including kafka::config class, not ::client

f4c8914d81-+-Add EventLogging Kafka writer plug-in

8d9737f676-+-Adding kafkatee monitoring

fa0fccfea0-+-Using offset => stored for kafkatee

d2d2521a4f-+-Set bnx2x num_queues to match physical cores on lvs nodes

56437c50b7-+-Rearrange andrew vs werdna:

f7e3807a32-+-Quieting logster::job cron

3aaee5a17b-+-swift: remove swift role from tampa

4f7ca294ae-+-url-downloader: fix module path

5afa94cd90-+-dataset: fix module path

7a135617bc-+-Decommission pdu checks in sdtpa.

4a3781dcc3-+-elastic1014 master eligible

094a96ad3c-+-Merge "turn off rsyncs to/from dataset2, prep for 12th floor move" into production

e2ed8d1c3b-+-labs_vagrant: Allow wikidev group to sudo as vagrant

e4d6036822-+-Configure scap master and clients in beta

0b0d31bebc-+-remove cp3013 from esams backends

ea4571d252-+-fix missing comma in 922bea82

922bea8296-+-enable cp3013 mobile backend in esams

b9bfd58d93-+-Remove db48 from m2, properly this time.

93215dc45d-+-Switch db63 for db60 in s1, as latter is on 12th floor.

5c59667d4c-+-Remove db48 from m2.

cb259cc186-+-Merge "Remove all traces of labstore[34] from puppet" into production

3cfbc91d5b-+-elastic1007 + master eligible, elastic1008 - master eligible

4f9e25560f-+-Remove all traces of labstore[34] from puppet

92fe80e286-+-Remove labstore1 and 2 from puppet

bd28bda351-+-formey: decom

6c67d83498-+-Removing references to stat1, adding stat1 to decomissioning.pp

19ab359794-+-remove ms-fe[14] from puppet, decom

70a9a2f106-+-remove all Tampa ms-be swift boxes from puppet

63149ac230-+-turn off rsyncs to/from dataset2, prep for 12th floor move

30f3a0c651-+-Merge "bugzilla, use better SSL cipher suite" into production

d0b09f6730-+-contint: gives access to Bryan Davis

25cc6c774b-+-MHA site-switch templates are broken with less than two available DCs, and technically useless in this situation anyway. Disable them until we get a replacement for PMTPA that could actually handle a switch over.

af53759059-+-Revert "add ntp servers on eeden.esams, rubidium (rt #7101)"

c61d2f35ea-+-Add ttf-kochi-mincho and ttf-kochi-gothic to imagescalers

c877ffc661-+-add ntp servers on eeden.esams, rubidium (rt #7101)

8f1fc25780-+-Merge "remove admins::restricted from lucene role" into production

88511061b8-+-change gitblit url check to retrieve something lightweight

450bcf6695-+-attempt to fix ordering issue w/ nameservers_prefix

7d7dd8a220-+-fix recursive dns on lvs100[25]

5ad75bbe98-+-Follow-up to I02673456f

810ce1bfb9-+-Merge "Sysctl: make the default priority 70" into production

e04b86ce06-+-Decommissioning emery

f98d58347f-+-icinga: allow private1-esams through firewall

594e87296e-+-Removing references to emery in prep for emery's decommission

79ba1d60b7-+-Changing erbium's udp2log instance to use unicast on port 8419

1ac5b5e1f4-+-elastic1002 now master eligible, elastic1001 no longer

12da1a7880-+-Purge nginx logs after two days.

7e49dfd922-+-Setting up varnishncsa instance for erbium

514cce499d-+-Adding ensure parameter to varnish::logging

742a3cb988-+-Adding ensure parameter to varnish::logging

f732a9f4dd-+-Added role::labs::lvm::biglogs

20a17d4889-+-Merge "add role ldap operations on silver" into production

30bb7634f9-+-Merge "bugzilla,make Apache SSL CipherSuite configurable" into production

ff58e40a1a-+-add role ldap operations on silver

2116fbe83b-+-ganglia: add group Swift esams, remove Ceph esams

dfa5857ebc-+-Merge "remove ms-fe.pmtpa monitoring" into production

0a89fdbb66-+-remove ms-fe.pmtpa monitoring

764eeac916-+-ganglia_new: add esams to Swift's sites

1c185f170c-+-remove admins::restricted from lucene role

d7247b9a99-+-remove sumanah's LDAP admin permissions

de63821100-+-Merge "Add ttf-dejavu-core,ttf-dejavu-extra to image scalers for "DejaVu (Sans|Serif) Condensed"." into production

f261da11e2-+-Add ttf-dejavu-core,ttf-dejavu-extra to image scalers for "DejaVu (Sans|Serif) Condensed".

4968a92945-+-Merge "Remove unneeded priority settings" into production

a20300cda9-+-Remove db35 from m1.

945cee48f2-+-Sysctl: make the default priority 70

a3e383ec29-+-Installing zpubsub on stat* servers

07cd4ad4ab-+-Remove unneeded priority settings

65a463f4d7-+-Merge "Adding Node 0.10 dependency back to OCG" into production

467ee26101-+-Including yuvipanda on stat1003 and bast1001

5b72928139-+-Increase priority of Sysctl::Parameters['big rmem']

cb9389338a-+-Requiring deployment::packages in deployment::target

fa4f454d2b-+-Merge "toollabs: Setup ssl cert for tools.wmflabs.org" into production

cdc084c56b-+-beta: do not use private key for star.wmflabs.org cert

7ad2ac1a5e-+-toollabs: Setup ssl cert for tools.wmflabs.org

843d6615bf-+-Removing some references to stat1, replacing some of them with stat1003

94a9224666-+-move LDAP admin permissions,tools out of site.pp

d10607195e-+-Merge "zuul: remove push_change_refs setting" into production

420539e490-+-Merge "contint: soften python-voluptuous version requirement" into production

8cfd9d2ed8-+-zuul: remove push_change_refs setting

b646c547f5-+-bugzilla, use better SSL cipher suite

b50d5d40f0-+-Merge "decom virt5-11, pmtpa compute nodes" into production

427f4e7d47-+-decom virt5-11, pmtpa compute nodes

8d775276e5-+-contint: soften python-voluptuous version requirement

c7be355c60-+-Merge "contint::slave-scripts recurse submodules" into production

86a404b7bd-+-Merge changes If356c815,I45317e87 into production

01578c7da9-+-Merge "Initial commit of pmacct module and role" into production

89d21d65ba-+-Merge "admins::jenkins sort account list" into production

dadc254c2a-+-Merge "role::beta::uploadservice to allow port 80" into production

f1db937cf6-+-Merge "misc/dsh.pp: retab and almost pass puppet lint" into production

b271206d33-+-beta: adjust protoproxy for eqiad

6ac517bfd4-+-Merge "beta: drop pmtpa instances from the natfix subclass" into production

4325930a21-+-Merge "remove pmtpa payments LVS monitoring" into production

d772099c69-+-Remove virt2 from puppet.

8e249799be-+-Remove db38 from x1 shard

cf986e0457-+-bugzilla,make Apache SSL CipherSuite configurable

2764bd3798-+-Swift: add esams-prod role classes and use them

8ea251dd90-+-swift: remove pmtpa-labs & pmtpa-labsupgrade roles

404e9e1df3-+-admins::jenkins sort account list

596b0a8fc2-+-Setting nagios retries and check intervals on CirrusSearch-slow-queries alert

e363f6ac0e-+-Fix bad server names for labs

17152564d8-+-Tool Labs: install python-mwparserfromhell

280ae18d76-+-Adding Node 0.10 dependency back to OCG

554b2a61a5-+-Use webproxy.$site.wmnet alias instead of carbon

b2d1ab3816-+-retab role/applicationserver

3b027d868d-+-Merge "applicationserver: rm code for labs instance in pmtpa" into production

27e6d7caa1-+-applicationserver: rm code for labs instance in pmtpa

b71aba6a23-+-Make Elasticsearch more reliable in beta

19f987ec83-+-Merge "Move ms-fe30xx/ms-be30xx to private1-esams" into production

df3c8ebc65-+-Move ms-fe30xx/ms-be30xx to private1-esams

7ae19c4ea7-+-Merge "gerrit: remove one replication to gallium" into production

756c297bc8-+-Added GeoTrust_Global_CA.pem to the star.wmflabs.org cert chain

691cfcd32c-+-star.wmflabs.org: fix intermediate CA

fbbf63856d-+-rp_filter check tunings

5e8cae65da-+-Introduce check to test if dhclient is running

ddbd0cf47d-+-Merge "Puppet masters in labs needs puppet::self::geoip" into production

e0ae9c3792-+-gerrit: remove one replication to gallium

0bb629bccb-+-Remove virt12-15 from puppet

dc0b55ce09-+-add monitoring for Ubuntu mirror being in sync

af50945f26-+-contint: directory to hold debian-glue packages

8cb850a34d-+-contint: get rid of misc::pbuilder on slaves

abe6ce773b-+-contint::slave-scripts recurse submodules

678a2c9ad7-+-Puppet masters in labs needs puppet::self::geoip

a3491ac17c-+-decom db78 (was once fundraising db)

db03c29c41-+-remove db67 from coredb,decom db64,db65,db66,db70

8ccc96e20a-+-subversion role lint, pass svn hostname to cert check

0e6621c87a-+-openstack: generic::upstart_job() now uses boolean values

d87488e5d4-+-Sending Zookeeper JVM stats to Ganglia

6c0898b4bc-+-Use eth0 IP rather than localhost for multi-region

12f81a5fcf-+-Enable a labs site override option for nova config

bdf1129f51-+-remove subversion role from formey

8c25524d15-+-Can't use domain names because ip6tables gets upset

2d1ceab7fd-+-Allowing rsync from public stat* servers, as well as internal

798f878a32-+-ms1001 should no longer sync from nas, long since obsolete

0c7d5bd555-+-Correct land_polygons file names

4dc47574f8-+-Merge "Import coastlines and land polygons into OSM db" into production

dd8eb979a8-+-remove pmtpa payments LVS monitoring

aac1b27c16-+-Import coastlines and land polygons into OSM db

adeb7ac12c-+-lint role/keystone (labs)

4610124bc6-+-Merge "Remove deprecated roles, and lint remaining labsproxy.pp" into production

95482e70a6-+-lint role/deployment

17c11f3c46-+-Remove deprecated roles, and lint remaining labsproxy.pp

aefe2123db-+-Merge "puppetize apache-graceful-all" into production

8dbd419700-+-decom : brewster

89add6c27a-+-Merge "Create and import shapelines from a pre-existing dump" into production

922455743e-+-Graphite/Carbon: less logspam

8dc02a3217-+-Graphite/Carbon: set max open files via Upstart 'limit' directive

3bb485628b-+-Running CirrusSearch-log at 0 minute every hour

0ee8ba00ec-+-Running CirrusSearch-slow.log logster job every 60 minutes

2688aae65f-+-Adding logster module and using it to monitor CirrusSearch-slow.log

aba119f343-+-Enabling base::firewall on stat1003

97be7d67f0-+-Using exec path rather than fully qualifying

6f7572758f-+-Need to fully qualify all executables in unless command

a9d3a12390-+-Adding hdfs user to stats group

46571b63c3-+-Merge "Revoke my key, I'm relocating to SF" into production

6117d07589-+-Installing java version 7u25-2.3.10-1ubuntu0.12.04.2 for elasticsearch

386756c791-+-Allowing wikimetrics $debug parameter to be set from labsconsole

6737441f9d-+-Revoke my key, I'm relocating to SF

fea530c20b-+-role::beta::uploadservice to allow port 80

2e5decd87c-+-Installing jq on all elasticsearch server nodes

24b1465d5a-+-Adding howief, jmorgan and msyed to bast1001

4cf2d44671-+-Correct LVS sysctl oid checks

b251b467a4-+-Puppetizing Camus cronjob

d2c57bf380-+-beta: drop pmtpa instances from the natfix subclass

dc612d9fc9-+-Setting checkout_submodules and gitfat_enabled for test/testrepo for testing

87f90ecf5f-+-Merge "Move check_rp_filter_disabled check to role::lvs" into production

5933f73032-+-Move check_rp_filter_disabled check to role::lvs

3b5ae31a97-+-remove resolv.conf dependencies on dobson+mchenry(.pmtpa)

5722b1242f-+-jenkins: logrotate main file on a daily basis

b27ff11b9e-+-add esams.wmnet to strontium puppet allow_from

4578fd4d99-+-Correct check_sysctl source path

72bd9d36d7-+-Set up a check for LVS rp_filter is disabled

51131f5aa0-+-Merge "Have check_sysctl populated on all hosts" into production

8373a257af-+-Have check_sysctl populated on all hosts

66f915e073-+-remove dysfunctional DNS recursor from LVSes

8f5f19742d-+-collector definition.  CPU and Network collector enable.

e966110e54-+-add lvs300[1234] to lvs::configuration

781af0c6b1-+-add public service IPs to lvs300[1234]

9c32c405e3-+-Merge "contint: apply maven settings on labs slaves" into production

47c2ff69aa-+-contint: apply maven settings on labs slaves

04f4de6f0e-+-puppetize apache-graceful-all

0e2d424d18-+-Merge "module to manage new python-diamond package" into production

4c374927e4-+-module to manage new python-diamond package

d73bcc778b-+-Merge "Increase count of carbon cache instances to eight" into production

535d5eb7c1-+-Merge "Corrections to the inline documentation for role::graphite" into production

212385d972-+-Increase count of carbon cache instances to eight

b11b4f8751-+-Fully qualify reference to hhvm class

c6601b8d4e-+-Adding analytics networks to $mw_appserver_networks variable

a5799c0015-+-Using kraken/deploy repository for deployments instead of kraken

bd1366242f-+-Corrections to the inline documentation for role::graphite

8529042252-+-mwprof: change collector port to 3811

1e3fff70da-+-Installing make on stat nodes

5c2ba2b25f-+-Adding two carbon-cache workers to graphite.

91ecae9af6-+-Merge "decom: ms6" into production

bfbb946248-+-Merge "RT #7243 add filippo to admins::roots" into production

d26b70e351-+-Check the proper cert on the cache boxes

25f593c740-+-RT #7243 add filippo to admins::roots

024418f71e-+-This is still wrong but slightly better!

d7932c7b4c-+-Fix bug introduced in I4a7a2c71be

bbf5942687-+-Merge "Improve the check_eth check" into production

ef01517c58-+-Merge "create shell account for Filippo Giunchedi" into production

387f343c9c-+-Improve the check_eth check

d6a4d8e08d-+-decom: ms6

1081e6e504-+-create shell account for Filippo Giunchedi

ca4a1da110-+-Revert "Make (graphite|gdash).wm.o go through misc-eqiad-lb"

5a32066e70-+-Merge "Partial revert of a87afea676375aba4f0ec28228e28df0502e5321" into production

2e65b7b46a-+-Merge "beta: reenable fatalmonitor script on eqiad" into production

22c95176fa-+-Partial revert of a87afea676375aba4f0ec28228e28df0502e5321

144dcd41fe-+-Merge "Hammer down a few more bogus https failures." into production

53d9a14c85-+-Merge "Create symlink for compile-wikiversions in /usr/local/bin" into production

4f11fcc622-+-Hammer down a few more bogus https failures.

a87afea676-+-Make (graphite|gdash).wm.o go through misc-eqiad-lb

3984214abc-+-Add service checks for mwprof, uwsgi, graphite-web & gdash

417545f209-+-Add 'uwsgictl' tool for managing services

ecf16f6e61-+-Merge "Update graphite::web for I8c214e0fd" into production

dae57838dc-+-Update graphite::web for I8c214e0fd

3b3503db8a-+-Merge "Replace uWSGI's broken init.d scripts with Upstart job def" into production

158dec5552-+-Replace uWSGI's broken init.d scripts with Upstart job def

c2db9b6e41-+-Create symlink for compile-wikiversions in /usr/local/bin

7ff103e427-+-Removing ethtool package from other places

0b755f8b35-+-beta: reenable fatalmonitor script on eqiad

0e8cf01b67-+-Disabling statistics roles on stat1

2e686e4e65-+-When checking unified certs, check for *.wikipedia.org

c17b56d85f-+-Merge "enable base monitoring for ALL hosts" into production

cf33aeca83-+-enable base monitoring for ALL hosts

4bd70596ca-+-Install and use check_ssl_cert tool to validate certs.

2e017aa902-+-Revert "Giving Nik shell access to analytics1004 to do some elasticsearch load testing"

3ee5c85c11-+-Merge "Tool Labs: forcibly upgrade libssl" into production

cd5116e13f-+-add nrpe to base

843433f93f-+-Tool Labs: forcibly upgrade libssl

29cd2011fd-+-Merge "adding ethtool to standard-packages.pp to be able to monitor interface speed" into production

94a1ff12c2-+-adding ethtool to standard-packages.pp to be able to monitor interface speed

b01073a285-+-Remove unused db1014 block. db1014 was renamed tungsten rt5871.

700cb5f651-+-Add eth1 checks to nova compute hosts.

282111f1ce-+-base: add debian-goodies

33a91a10ae-+-Support eqiad labs secondary disk

1b2b68be30-+-Support eqiad labs secondary disk

15211d986b-+-Adding + 2 Hadoop journalnodes in Row D

7a1fb192f5-+-Merge "Add Icinga checks for important sysctl params" into production

73f39a53e1-+-l10nupdate: add support for --verbose flag

278ed648ef-+-Adding swalling, maryana and jforrester to bast1001

4701dcb9ac-+-Not monitoring logs on analytics1003 misc udp2log instance

4b008e1575-+-Including standard and admins::roots on analytics1003

ad45441b3d-+-Need to include udp2log class since ::misc doesn't inherit

1b18df17e7-+-Setting up misc udp2log instance on analytics1003 to test moving sqstat there

e0cc9e737c-+-ganglia: address selector in a define

8c4748b496-+-ganglia: lint manifest!

a6594e3899-+-ganglia: class defined in class moved to top

c6ee102e86-+-Merge "mail :lint" into production

e3a6075b12-+-Purge /etc/apt/apt.conf

14ecc89543-+-Add an account for subbu on Parsoid / Cassandra test hosts

6a52c94857-+-removing spetrea's ssh key per RT #7203

d8a9e00cd7-+-Merge "Jon Robson access to fluorine" into production

5f07e6950d-+-Add Icinga checks for important sysctl params

152e14101c-+-base::firewall always needs defs, but main-input should be absent if ensure => absent

223354e164-+-No need to remove ferm confs on base::firewall ensure => absent

9037355b1e-+-Disabling base::firewall on stat1003

f0bd1489d6-+-Reverting previous change, we will figure this out next week.

9c062f2b56-+-Merge "Tool Labs: Fixes for webgrid" into production

1edbce0b1e-+-Adding stat1003 accounts to bast1001

cec4c169fd-+-Tool Labs: Fixes for webgrid

e8a07beebc-+-Labs: -pmtpa support from role::labs::instance

0f426c7b0c-+-Including base::firewall on stat1003, allowing rsyncd traffic within internal network

00d3f06d84-+-Adding $ensure parameter to base::firewall

d67ecf4305-+-Adding $srange parameter to ferm::service

9c746e90ae-+-Update docu around analytics rsync source

67bc2473b7-+-Remove group writability for analitycs files /a/squid, and /a/log

5febf46338-+-decom: hume

36cc2d2d60-+-Merge "deactivating salt grain-ensure in global role" into production

0c9f2b5e8f-+-deactivating salt grain-ensure in global role

e337c2b44b-+-hhvm: abstract out backports to a hhvm module

815d84620e-+-Create and import shapelines from a pre-existing dump

cb86a552c7-+-mail :lint

78379aa208-+-Jon Robson access to fluorine

d256ed35ac-+-Ensuring parent directories for limn::mobile_data_sync exist

185c6cb7ae-+-Making stat1003 use /srv instead of /a

1727ce0479-+-Tiny lint fix

5449f51b2a-+-Merge "Fix a minor chown/chmod issue with a README" into production

4e1ec04d35-+- Adding new scheduler mode to wikimetrics.

2e186f1342-+-allow esams.wmnet puppet fileserver access

c282e594e4-+-enable apt proxy via carbon for esams

d02c5c182e-+-add 10.20.0.0/24 => esams for $::site

5296dabf97-+-lvs300[1234] -> empty service ips for now

b452273fb3-+-add lvs role to new esams lvses

ddb77ed8ec-+-Using www-data as wikimetrics group if running in apache web mode

2ff367bc31-+-brewster to carbon migration

444295756a-+-Merge "Create u_kolossos,u_aude dbs and users" into production

748a038227-+-Merge "contint: bring puppet-lint on lab slaves" into production

14fe2c502a-+-hhvm on beta: use 'hhvm' package, not 'hhvm-fastcgi'

4c38bfb76c-+-Merge "Follow-up to Iacd6a8250: remove reference to repack-libmemcached10" into production

03a751024d-+-Merge "Tool Labs: tweaks to the YuviProxy for tools" into production

e2dcaaf572-+-Tool Labs: tweaks to the YuviProxy for tools

e85aad0797-+-Make role::graphite work in Labs

e5f47ebedc-+-Follow-up to Iacd6a8250: remove reference to repack-libmemcached10

2394324f51-+-hhvm on beta: remove repack-libmemcached10 hack

0cdcaa52f0-+-Merge "toollabs: Setup proxylistener.py on proxy host" into production

43ce6bda28-+-contint: bring puppet-lint on lab slaves

65007d5aeb-+-Moving privatedata users on stat1002 into admins::privatedata class

729569511a-+-Removing standard and admins::roots from base statistics class

5d6b58c284-+-Don't try to reset $certname

bad357cfd2-+-Merge "Labs: prevent ec2id fact from returing errors" into production

2b646a0d1f-+-Fix a minor chown/chmod issue with a README

35a4ac4e7a-+-Create u_kolossos,u_aude dbs and users

c1f6ff44af-+-Puppetize purge-checkuser

4a33953bd1-+-Labs: prevent ec2id fact from returing errors

0691dc9c6d-+-Removing gerrit_stats class from misc/statistics.pp

b644d30f91-+-Merge "iptables.pp: retab to four spaces" into production

c51ae9c545-+-Adding role and user classes to stat1003

62fcf3eb18-+-Removing some includes of erosen and mgrover accounts

1dd135d317-+-Removing gerrit_stats class from role::statistics::cruncher

87b78ecc9b-+-Add db1027 to coredb topology in S3. This omission caused db1027 to only have the standard icinga checks.

c2da6ff327-+-Remove unneeded client packages. The wmf-mariadb package provides the usual command line utilities, and other packages are free to use the usual stock libmysqlclient* dependencies without conflict.

0d61e9b47d-+-eventlogging: make statsd:// consumer write to tungsten

200afd29f4-+-Add eventlogging::service::reporter for reporting to StatsD

affab1303a-+-toollabs: Setup proxylistener.py on proxy host

c45e855593-+-Merge "toollabs: Install python-redis on dynamicproxy host" into production

9842195441-+-toollabs: Install python-redis on dynamicproxy host

ff1cae6e27-+-Merge "ganglia: fix some missing paths for labs" into production

f779c1abc1-+-Merge "dynamicproxy: Add explicit DNS resolver to tools proxy role" into production

061d746223-+-dynamicproxy: Add explicit DNS resolver to tools proxy role

904e7b949a-+-Merge "Tools: Install php5-pgsql" into production

749be4eabe-+-Create "/a/backup/public" on wikitech.

0c6b7bdb2f-+-Tools: Install php5-pgsql

f0311c927a-+-ganglia: fix some missing paths for labs

1b310cdbdb-+-Merge changes If6dad2fe,I9e02b1e5 into production

45a7041ee4-+-Initial commit of pmacct module and role

07eacbf7ae-+-ms10: decom

72fd636cfa-+-Merge "In production, the apache controller is always called 'wikitech'" into production

18de283eb6-+-In production, the apache controller is always called 'wikitech'

70a0b4c5c8-+-Adding stat1003 and standard class in site.pp

7ece4bd087-+-capella: decom

4f65f11b3f-+-Using template_variables parameter to fix puppet lint problem

84b8e388bc-+-ganglia: tweak settings for labs in eqiad

f6b9fbe0a1-+-Merge "Adding bacula backup::set for /var/lib/archiva." into production

481bbd82ff-+-misc/dsh.pp: retab and almost pass puppet lint

613b22c7c0-+-Merge "add Giuseppe (oblivian) to admins::roots" into production

cbf901a3fe-+-iptables.pp: retab to four spaces

a080824206-+-Add mw1161 and mw1201 as scap proxies for EQIAD row C and D

76a1317360-+-Manage scap proxy rsync config in puppet

2557f20ac8-+-Merge "Lint misc/icinga.pp" into production

568644f902-+-add Giuseppe (oblivian) to admins::roots

1a2705bfdc-+-add shell account for Giuseppe (oblivian)

12f166c261-+-Merge "beta: lower # of procs on jobrunner" into production

f7b0f0fc25-+-Correct package name typo.

bda511ef96-+-Class for wmf-mariadb build, versions 5.5 and 10.0. Roll out 5.5.36 on db1044.

e3472ebe78-+-MariaDB monitoring for disk and process(es)

fcbd960e02-+-Remove reference to old cgi-bin files on noc

c3d8998720-+-db: lint role

cb602ebac2-+-add git deploy target for reporter

c66c22ab7e-+-Added zerowiki to $private_wikis

c5046d4cd0-+-Add legalteamwiki to private_wikis

8dbd4c8bf9-+-Revert "Properly puppeti[sz]e purge-checkuser"

5742368656-+-Properly puppeti[sz]e purge-checkuser

8758476bb2-+-beta: send Parsoid log to shared dir

3c979741b3-+-access: revoke steve bernardin

356a472097-+-access: revoke Leslie Carr

81a270ec9f-+-beta: lower # of procs on jobrunner

65412fef6a-+-Periodically deleting old fairscheduler event logs

51680c6ef0-+-Comment gerrit's usage of ${name}

f8be030058-+-Revert "role/gerrit: single quoted string containing a variable"

6f3ed3fb0d-+-role/gerrit: single quoted string containing a variable

b330837402-+-Merge "contint: browsertests need ruby1.9.1-dev" into production

13b634185d-+-Merge "lint fundraising" into production

4ea07a2504-+-glance: lint

a8d4f11c3e-+-Merge "retab role/glance" into production

926221a50f-+-Merge "role::parsoid::beta needs contint slave scripts" into production

5fe9eca834-+-beta: bring in scap related scripts on bastion

eb72a112dd-+-beta: update deployment-cache-upload address

7106f5e056-+-contint: browsertests need ruby1.9.1-dev

6a4cbd3711-+-lint fundraising

07c9cefa56-+-role::parsoid::beta needs contint slave scripts

b54ccbdaa0-+-Lint misc/icinga.pp

a46bc8b9a3-+-Merge "Change home directory of vagrant user" into production

673326b12c-+-Set userstat=ON for mysql_multi_instance roles, to match coredb. This was previously SET GLOBAL on labsdb, so make it stick.

1703c2c3f5-+-Change home directory of vagrant user

194c349779-+-Adding bacula backup::set for /var/lib/archiva.

9402e46734-+-Add esanders shell account

4cf9fda493-+-package-builder.pp: --create must be 1st arg to pbuilder

22c4cc3fc7-+-package-builder.pp: duplicate $build_place

edf516019a-+-package-builder.pp: create aptcache dir

dc359f29c1-+-contint: include browsertest role on labs slaves

cc0912d03b-+-elasticsearch: prevent dupe packages

d27bdc8d98-+-retab role/glance

e9c300f0d3-+-add missing system roles

2262d77231-+-package-builder.pp: set buildplace/aptcache

3051f17036-+-package-builder.pp: pass $pbuilder_root to image{}

515ba694bb-+-pbuilder root on labs need to be a directory

002cb7ff15-+-contint: migrate slaves to use role pbuilder class

092a1f7cce-+-Disable slow_digest job on coredb s[1-7]

761dbe58f2-+-applicationserver::hhvm: add /var/run/hhvm

1519b7085f-+-hhvm on beta: fix upstart job filename (add .conf suffix)

75ab755f03-+-Merge "contint: use role::labs::lvm::mnt on eqiad slaves" into production

3fae1f3a69-+-Merge "role::labs::lvm::srv to mount second disk on /srv" into production

af3c159a01-+-Merge "hhvm on beta: remove /etc/init.d/hhvm; simplify libmemcached check" into production

5e0bbfd670-+-role::labs::lvm::srv to mount second disk on /srv

e29e4bd6fa-+-Merge "Allow user to specify mount point for role::labs::lvm::mnt" into production

79a6e5b1c4-+-Role classes wrapper for misc::package-pbuilder

b9c3642229-+-Merge "package-builder.pp: parameterized $pbuilder_root" into production

2a86b625e8-+-hhvm on beta: remove /etc/init.d/hhvm; simplify libmemcached check

d3125e3c98-+-Merge "package-builder.pp: convert notify to use 'message'" into production

67885907dc-+-Merge "Lint misc::package-builder" into production

4863c7a415-+-Turn on git-fat for Elasticsearch plugins

db57bfa8c0-+-hhvm on beta: use upstart

1a3f941985-+-package-builder.pp: parameterized $pbuilder_root

ca189b6831-+-Moving analytics ganglia cluster definition into site.pp

825232efda-+-role::analytics must be included before standard so that ganglia_cluster is set properly

ccdd135285-+-Moving inclusion of standard and admins::roots out of analytics roles

efe607db80-+-Add labs eqiad bastions in networks.pp

d6200ed94b-+-beta: fix wrong include in role::beta::natfix

b86de49c2b-+-Create roles for syslog-ng

7afa9d618a-+-Make syslog-ng basepath a parameter

8562ddde8e-+-download.wikimedia.org to misc web cluster with dataset1001 backend

133bfb3809-+-reassign db1034 to s7

2703630483-+-Merge "ldap: switch CA name to Equifax_Secure_CA" into production

a928ed0cc1-+-ldap: switch CA name to Equifax_Secure_CA

c136e22404-+-Revert "Update ldapconfig CA to RapidSSL"

8806427799-+-Update ldapconfig CA to RapidSSL

24017f7c33-+-Fixing git-deploy git-fat support

ab5a181f38-+-beta cluster: hhvm => true

5638cb54b1-+-Enabling git-fat on kraken deployment

8690562d75-+-Adding extra property configs to nginx simple-proxy.erb, upping client_max_body_size for archiva proxy

c8f8ae3b68-+-create /srv/deployment on ocg server

8d7176fb1e-+-Tool Labs: add user-requested packages

e6285f7d5e-+-Tools: Rename references to local-admin to tools.admin

3492a7cd1a-+-add cert to the downloads wikimedia conf file

0c515afd4a-+-system role for nova compute nodes

4275b40a5e-+-system role for the osm dbs

5a08f7c186-+-Include group/user blocks for testing tarballs in place of debs

cb4381aaf9-+-add system role for elastic search boxes

f471e34d4b-+-Puppetize dbstore100[12]

26436a408f-+-system roles for snapshot xml dumps (they have it for everything else)

3187ff4a43-+-need standard for salt::minion grain-ensure

ee727fe26f-+-Add a MariaDB module.

c0f18807ca-+-adding user gdubuc to stat1

154e77dc33-+-access: remove giovanni

1d8b02e580-+-access: remove fschulenburg

5da274a7cf-+-add salt grains automatically in system::role

b11114700f-+-Setting up simple nginx proxy to archiva on port 8080

3924d027f5-+-Setting recurse_submodules => true on labs self hosted puppet clones

0e72c38660-+-Setting archiva port properly

8c3c21935c-+-Adding archiva module and role, applying on titanium

5e8407ceed-+-access: remove erosen

4168b923a3-+-Merge "Fix error: timidity service can not be stopped" into production

52f5b21a72-+-Merge "Add subnet private1-esams, remove storage1-esams" into production

873a54e22c-+-decom snapshot1-4

d982ff280f-+-add config file for media list generation on snapshots

054221d56b-+-Add subnet private1-esams, remove storage1-esams

4d49d01251-+-puppetize generation of media lists cron job on snapshot hosts

47cb39e1a2-+-Merge "twmeproxy: monitor the memcache port as well" into production

fe4b03795c-+-twmeproxy: monitor the memcache port as well

37fc9579e6-+-fix typo in releases accounts for yuvi

c0dff1ab65-+-pc[123] have been shutdown for decom

b14b3d2356-+-let yuvipanda upload mobile tarballs

1344a512e9-+-Switch to a new aggregator instance.

9220e864cf-+-Merge changes I2dd0a99f,I8530218e into production

8b9b4d0840-+-decom ms5

7adcecc457-+-Move the labs ganglia aggregator to eqiad.

4c97a553b3-+-GeoIP cookie: expand deployment from Labs to production

da8db64144-+-Add csteipp & aaron to admins::jenkins group

b53add7311-+-Merge "Tool Labs: split HBA config from execnode" into production

2ac9a016e9-+-Tool Labs: split HBA config from execnode

f6313c7e72-+-Merge "Tool Labs: add postgresql-client" into production

0478fdf263-+-RT 7090 - adding analytics contact group to researchdb icinga alerts

50ab8abf0d-+-Merge "Updating NRPE allowed hosts to new icinga instance (pmtpa to eqiad migration)" into production

53fcd2220d-+-Merge "removing stat1002 access for amir & santhosh" into production

69f2c440e1-+-Updating NRPE allowed hosts to new icinga instance (pmtpa to eqiad migration)

009f1a0264-+-removing stat1002 access for amir & santhosh

840302b609-+-Moving labs icinga from pmtpa to eqiad

6b1914d909-+-Merge "decom: remove searchidx2" into production

2e3a194a7e-+-Fixing Stefan's public key

61583e4001-+-decom: remove searchidx2

db37cd30ad-+-Tool Labs: add postgresql-client

87e46ea6f2-+-Merge "Tool Labs: ensure latest for requested packages" into production

5e9756e61a-+-Tool Labs: ensure latest for requested packages

1c6c2e18ad-+-Revoking Stefan's most recent key and adding a shorter one

f17dffe9c6-+-Removing Stefan Petrea's old ssh keys, installing new

637bceb80e-+-Merge "Tool Labs: add role for the new submit host" into production

8cc035667c-+-Tool Labs: add role for the new submit host

42ed20b4ee-+-remove searchlogs rsync conf from datasets manifests, no longer used

dad243a9c3-+-Merge "Tool Labs: avoid double definition of /usr/bin/sql" into production

5bed4c66f2-+-Tool Labs: avoid double definition of /usr/bin/sql

8fcaef3d9f-+-Merge "Tools: Remove obsolete webserver class" into production

c9b3eeb79c-+-Merge "Tool Labs: new-style cron via submit host" into production

08e4f2021a-+-Tool Labs: new-style cron via submit host

ed7a8147b8-+-otrs: add missing network::constants include

74c4f16000-+-clamav: move into a module

e2ac03d47a-+-spamassassin: cleanup module

b37c58c70a-+-spamassassin: move into a module

f34ca40615-+-Fold exim::rt into role::rt

f54293dbf5-+-snapshots: move centralauthdump cron out of role into module

466eeafdfa-+-Fix error: timidity service can not be stopped

4087a61f47-+-Tools: Remove obsolete webserver class

b6b835c143-+-install-server fix logrotate for squid3

9708066473-+-Merge "applicationserver::hhvm: add boost backports ppa for beta" into production

f13f911e1f-+-Make a self-hosted puppetmaster workalike for puppet::geoip

756593522d-+-Merge "ToolLabs: Add the sql command to the exec hosts" into production

19b2eded19-+-Migrate the auth method of OSM user to trust

59586d359e-+-Merge "Decomission lvs[1-6]" into production

3ddab3b3dc-+-Add subnet analytics1-d-eqiad

ca9035af24-+-Decomission lvs[1-6]

15c6d79536-+-OSM: Tune shmmax sysctl parameter

6234edc00e-+-Fix typo introduced in db8c944

80a19d3935-+-OSM: Better checking for planet_osm existence

f91acf5779-+-package-builder.pp: convert notify to use 'message'

c79689dbe5-+-Lint misc::package-builder

53562d0796-+-contint: typo in contint::packages::labs

d93abc1ed0-+-contint: puppetize jenkins-debian-glue

f2aa983e7d-+-Tool Labs: remove 'tree' from exec_environ

f5b19f4524-+-applicationserver::hhvm: add boost backports ppa for beta

d1fa38c78b-+-Create a user for access to OSM db

db8c9448c9-+-Merge "Tune labsdb postgresql" into production

54172989ea-+-move mounts on stat1/1002 from dataset2 to dataset1001

65bd6a6675-+-Merge "Make logstash and kibana roles work in labs" into production

fab4d8f3cc-+-re-enable adds-changes dumps out of cron (caught up backlog)

c3982e7647-+-Allow user to specify mount point for role::labs::lvm::mnt

dd60e599b7-+-Vary Zero configuration by $::realm

acd57ec37c-+-Tune labsdb postgresql

e80341e1eb-+-Cobalt had a serial problem, using titanium for new archiva server instead

081c8f2315-+-Adding configs for new install of cobalt

de4a59699f-+-Merge "add tree command" into production

8c324d4e74-+-Fix parsoid sudo rules

2e8ae4d5df-+-Merge "Tools: Install packages git-review and joe" into production

535918e799-+-Tools: Install packages git-review and joe

6a1d60b9d6-+-lint admins.pp

4a42c1d004-+-Update misc::nfs-server::home::rsyncd hosts_allow

27e9978e84-+-ToolLabs: Add the sql command to the exec hosts

5235c667aa-+-Merge "Labs: Remove Bots project motd" into production

7eafe586dd-+-Decomission sq67, sq68, sq69, sq70

4e3b06d291-+-Merge "Convert syslog-ng conf to templates" into production

3d827015ec-+-Merge "salt: qualify site and realm" into production

3b643a327d-+-Labs: Remove Bots project motd

483a70d718-+-Make trebuchet work in eqiad.wmflabs

78d641d9d9-+-Merge "Enable planet.osm population on labsdb1004" into production

8003912846-+-Merge "osm module" into production

12b4ce9c26-+-Make logstash and kibana roles work in labs

01e223c972-+-Merge "applicationserver: don't set beta's twemproxy to false" into production

ff952dd2ea-+-Merge "beta: fill in swift backend for upload varnish" into production

7c44870956-+-contint: use role::labs::lvm::mnt on eqiad slaves

1e8b731504-+-Merge "Lint misc/logging.pp" into production

b0deb62903-+-beta: fill in swift backend for upload varnish

581afed389-+-Fix bug introduced in 68e354d

68e354d659-+-Add cron job to run characterEditStats.php on multilingual wikis weekly

2d043249cc-+-Convert syslog-ng conf to templates

540b421f08-+-Git::clone: set core.sharedRepository=group for shared repos

b4000d2249-+-Merge "Git::clone: correct onlyif checks" into production

184c3045ed-+-applicationserver: don't set beta's twemproxy to false

3f59e53456-+-Git::clone: correct onlyif checks

2b011c027c-+-salt: qualify site and realm

68f4571edc-+-Restore generic::upstart_job parameters

28a14c8299-+-space out page titles and media titles generation on snapshots

9208d38164-+-Enable planet.osm population on labsdb1004

c8fc5571ab-+-osm module

a3064ac78b-+-beta: vary fluoride instance per $::site

ac1be13f24-+-Merge "Configuration for beta cluster caches in eqiad" into production

9250e3c09a-+-beta: vary logstash instance per $::site

5dcb0ef261-+-Configuration for beta cluster caches in eqiad

e88fc523ab-+-Lint misc/logging.pp

8e459cfd55-+-Create a simple role class to set up a big /mnt volume on labs

4bf13a8b4a-+-Fix MW_STATSD_PORT to point to correct listener

ad56aa525f-+-Merge "contint: ensure /mnt is mounted on eqiad" into production

bac74b5856-+-Quick fix to sudoers

7c80dc0a62-+-contint: ensure /mnt is mounted on eqiad

5de2a2f8e6-+-Rename RT classes into misc::rt & role::rt

656c45e824-+-Give group wikidev the right to restart parsoid

25d649f55b-+-Merge "labs_lvm: logoutput => on_failure for all exec calls" into production

457e1398dd-+-Amend "Update caching proxy squid configuration"

76be125c38-+-Merge changes I049ed4dc,I5c6bac5c into production

529eed0434-+-snapshots should include standard, not just base + extra

1984977baf-+-fix config file path for pagetitles dumps on snapshots

bd4de1360c-+-contint: mount lvm disk for eqiad slaves

f22043f671-+-contint: consitent indent in manifest/role/ci.pp

32cf4562a6-+-Merge "planet: Resource reference capitalize" into production

6163da4d26-+-Merge "webperf:  '$' in prototype" into production

d527eb49a6-+-Merge "dataset:  '$' in prototype" into production

805ce3c4c1-+-Merge "dns: lint" into production

df220635ea-+-planet: Resource reference capitalize

d1407d929b-+-webperf:  '$' in prototype

a22367c909-+-dataset:  '$' in prototype

5404f3470b-+-Make puppet cronjob to run AbuseFilter/maintenance/purgeOldLogIPData.php

3fc93bbd84-+-lint maintenance.pp-part 2-double quoted strings

2a2284a372-+-Merge "lint maintenance.pp - part 1 - modes and titles" into production

718d473dee-+-Reassign db1037 to s5. Sideline db1034 for filesystem rebuild.

1a3ea7473e-+-lint maintenance.pp - part 1 - modes and titles

00f2769c90-+-add tree command

48fd51d179-+-Merge "Git::clone: correct group bit for shared repositories" into production

1815a11bde-+-Git::clone: correct group bit for shared repositories

366a98549b-+-icinga: make snmptt cronjob less spammy

184e30ee40-+-Kill misc::maintenance::aft5 class

24f375eaca-+-move datasets user to own group so it can run maintenance scripts

5a8509d9d2-+-coredb_mysql:  puppet 3 compatibility fix: fully qualify variable

b64ad7e2e4-+-dns: lint

912edf25e3-+-all crons to eqiad snapshots; all rsyncs to/from eqiad dataset host

a3ad678bd9-+-Merge "Don't try to bond network ports in labs." into production

b709ed4080-+-Fix a typo introduced in dc08f68

0b5cebf340-+-Merge "Labs: remove mode and owner from mountpoints dirs" into production

a3ca2ff09e-+-Labs: remove mode and owner from mountpoints dirs

b0f884af88-+-role::installserver pin packages varied on distro

6e4fac5909-+-install-server module. Precise has squid3

80e17cb3f9-+-Fix typo introduced in d7d97a0

d7d97a075a-+-Fix dependency in install-server::dhcp-server

5a65b94643-+-install-server::dhcp-server made precise aware

a4b6271f8e-+-puppetize generation of media directory lists for snapshots

4ca8c30d2d-+-Merge "Creating a spatially enabled db on osmlab dbs" into production

b86723730a-+-Merge "Support spatial_ref_sys and comments in postgres" into production

852028ee1d-+-Revert "Initial commit of mwprof::reporter"

5e3f4b1b73-+-puppetize generation of lists of good dumps for rsyncers

dc08f689aa-+-Creating a spatially enabled db on osmlab dbs

e959057aae-+-Support spatial_ref_sys and comments in postgres

4a9657875a-+-puppetize adds-changes dumps (so-called incrementals)

f6fcdc6818-+-puppetize conf file for pagetitles dump on snapshots

9956ef54bf-+-Don't try to bond network ports in labs.

388bbf8037-+-puppetize page titles generation on snapshot hosts

0be0e1b320-+-on snapshots fix config file names

6013a7d659-+-snapshot central auth dump to use puppetized configs

49fbf6e793-+-eqiad snapshot hosts to use puppetized templates and configs

e3faac38c8-+-dumps templates, configs, dblists added to snapshot module

43c5126ed1-+-Merge "Add redis config for keystone in labs" into production

eddbda5e57-+-Add redis config for keystone in labs

3eaf1728c6-+-Merge "Fix a dependency foul-up on labs." into production

34ddc893ec-+-Fix a dependency foul-up on labs.

27be6e968c-+-Initial commit of mwprof::reporter

d7de57ffd9-+-Add scap-purge-l10n-cache to /usr/local/bin

884c794e16-+-Set core.sharedRepository to 'group' for shared clones

b65e6ff9cf-+-Fix typo from I96287df09

22d327d65f-+-Merge "Configure the scap repository to be shared by wikidev group" into production

ab0d54a791-+-Merge "git::clone: Include umask as part of command" into production

4e0cf70a39-+-git::clone: Include umask as part of command

d068686ab2-+-Merge "Tool Labs: minor fix to mailrelay.pp" into production

a60971dc4c-+-Merge "Git::Clone: support shared repositories" into production

91c1b5d87c-+-Tool Labs: minor fix to mailrelay.pp

74cd7ade25-+-Git::Clone: support shared repositories

534790c9c4-+-Merge "Tool Labs: update mail relay to allow incoming" into production

17ee544c1f-+-Tool Labs: update mail relay to allow incoming

f04247b193-+-Configure the scap repository to be shared by wikidev group

27c8677a37-+-Decommission solr[1-3]

964002e053-+-beta: get rid of /home/wikipedia/logs shortcut

cb97a59ffc-+-beta: define /a on bastion

757a1d4309-+-contint: remove dsc sudo from servers

28fe9a8fc8-+-beta: fix l10nupdate homedir

44959ad80e-+-Fix second bug introduced in 577ea6a

e8afd5648a-+-Merge "beta: skip mwdeploy user creation" into production

fc79b36acb-+-Fix bug introduced in 577ea6a

898bc30102-+-beta: skip mwdeploy user creation

5790b7f37d-+-beta: fix really broken dependencies

e7a7ee3e8e-+-Merge "beta: skip l10nupdate user/group creation" into production

af8b971764-+-deployment::target does not work in labs, skip it

71ae122626-+-Merge "certs: lint" into production

18a3e6dbab-+-Merge "nfs: lint" into production

416a1fb936-+-Re-enable GeoIP Set-Cookie on Labs

e118ae1246-+-Tool Labs: prepare mailrelay for tool processing

050569306e-+-ersch: decom

197afd4a06-+-tmh: decommed

847371f24a-+-Merge "Remove image scalers, mw api, mw and bits appserver and job runner ganglia groups" into production

9379927131-+-rm access revoked comment from Daniel's entry in admins::restricted

c8bf8a730a-+-Enable daniel's key (should have been in 2156ba5e)

e98c17426f-+-Remove image scalers, mw api, mw and bits appserver and job runner ganglia groups

2156ba5e23-+-enable Daniel Kinzler shell access - RT#7028

70ed1a302e-+-labs_lvm: logoutput => on_failure for all exec calls

d1b721da7a-+-contint: python-dev on labs slaves

a182ad1d5d-+-Merge "Add another compute node." into production

7853ae6669-+-Add another compute node.

8e8adb5921-+-Merge "Fix eqiad labs range" into production

0e15ceb2fb-+-Merge "mwlib: lint" into production

c24f0ead74-+-Merge "swift: lint" into production

656ca4a2c2-+-Merge "ldap: remove lookupvar and replace with top scope @ var" into production

983a15f987-+-swift: lint

045f662769-+-Merge "ganglia_new: lint clean" into production

49d5e406d7-+-Merge "gerrit: lint" into production

236112c5c3-+-Merge "webserver: lint" into production

b6db56eb02-+-nfs: lint

084e77c777-+-Add missing config from role::deployment::salt_masters::labs

6e6c2a0392-+-Simplify trebuchet developer environment creation

72b0bfa4c7-+-Fix eqiad labs range

577ea6aca5-+-beta: skip l10nupdate user/group creation

c8382b75bf-+-Add 10.64.48.0/22 to scap allowed hosts

228c4a1fee-+-Silence netmapper_update cron

40212e6c02-+-Silence netmapper_update cron

25a8df2e2b-+-Disable labsness of labstore[34]

e4abf2edc4-+-remove snapshots.pp manifest, no longer used

9f975becd7-+-all snapshot hosts using snapshot module

56ee504400-+-ganglia_new: lint clean

2cf5982635-+-webserver: lint

0bd240f237-+-fix snapshot module dependency cycle

69aa9825ea-+-snapshot module in use on a pmtpa snap host

9c1617cdc3-+-Default innodb_file_per_table=OFF for S3 as that shard has many more tables than the others (OFF reduces file handle usage, among other things).

1274eee18c-+-DB nodes whitespace

65e8f9892a-+-S1 uses only mariadb

bcea9aa882-+-S1 deploy db1061 db1062, S2 deploy db1063

d9d449daee-+-rename planet::site to planet::apachesite

e8e26be51d-+-turn planet into a module

6b9682fb20-+-Merge "More tweaks to the labs rsync of public dumps" into production

4cf7754f79-+-More tweaks to the labs rsync of public dumps

c7e7f83b95-+-Merge "mediawiki::sync one file{} statement per file" into production

598e9296d9-+-Merge "Change dumps to labs for eqiad" into production

27a2a9c182-+-Change dumps to labs for eqiad

710cf58db7-+-unpuppetize some fundraising-related symlinks, remove deprecated ssh keys, all for aluminium

25548338b5-+-Merge "ganglia_new: remove lookupvar and replace with top scope @ var and fix scoping" into production

27def8dbac-+-gerrit: lint

c97a1d7bed-+-Merge "Tool Labs: shadow master for eqiad" into production

74403c6c90-+-Tool Labs: shadow master for eqiad

a3504b190a-+-add account for Chase and add to admins::root add key RT #7004

f7ade07074-+-Merge "remove darrell shell account" into production

b99adb1a50-+-Merge "bugzilla: remove the new from motd, old is dead" into production

2ea9299f6d-+-mediawiki::sync one file{} statement per file

5cbf9a131d-+-Merge "Move Global_JobQueue_length ganglia graph to terbium in eqiad" into production

84100bf797-+-Merge "Specify region-appropriate dns resolver." into production

a19eb6abd6-+-Move Global_JobQueue_length ganglia graph to terbium in eqiad

c5b2cc608d-+-remove darrell shell account

529349efbf-+-ganglia_new: remove lookupvar and replace with top scope @ var and fix scoping

4ac3aac9f9-+-openstack: remove var and replace with top scope ::var

bb21c3ddd4-+-Merge "convert oooold snapshot manifest to module" into production

c83167ac4c-+-Merge "puppet::self::master: Specify IP range for eqiad" into production

4a719e61bc-+-puppet::self::master: Specify IP range for eqiad

48807455a1-+-Specify region-appropriate dns resolver.

98eeca5ba2-+-Merge "HHVM enabler for application servers" into production

042dc902a1-+-reclaim arsenic as spare

5ff1def05b-+-HHVM enabler for application servers

dcd1c6099f-+-Merge "Increase the cache size for dnsmasq." into production

e778c51f9e-+-Increase the cache size for dnsmasq.

8e0a0b3216-+-convert oooold snapshot manifest to module

e7c3d1b4d4-+-snapshot common role gets account related classes

365e755346-+-puppetize the weekly centralauth mysql dump

435e49bb73-+-Need accounts::manybubbles

be929bf215-+-Giving Nik shell access to analytics1004 to do some elasticsearch load testing

2b6a87c0a3-+-fix up page count copy script perms, require the user that runs them

9167a1f827-+-Merge "Make wikimetrics' database setup depend on alembic" into production

80ce702b96-+-puppetize the page count files copy job from gadolinium and move it

0e30a230d8-+-Allow Internet Archive to archive etherpads

77ff5bdbd0-+-Setup eqiad LVS servers for row D real servers

29af85881c-+-fix puppet doc for nrpe/bacula module

9c5f851101-+-Merge "nagios: remove broken solaris icon pointer" into production

d823a59485-+-beta: lower memcached memory usage

d4d8fb13f8-+-nagios: remove broken solaris icon pointer

5c9b08abdd-+-Remove removed scap symlinks

6ea38dac67-+-Remove dangling scap symlinks

0191ee091a-+-python cron script needs python

92db4720a7-+-datasets: enable the python rsync script in cron

69de1d496a-+-remove rsync/cron/nfs stuff from download module, cleanup roles

f30747f74d-+-dataset2 to use new dataset module

bb3088c323-+-dataset: rsync nice and ionice only for nonpublic rsyncs

7e64c099af-+-one more nfs remnant to toss from download web server manifest

3f3e1c44ee-+-remove nfs stuff from download web server manifest

6bbcdd3bbe-+-dataset1001 to use new dataset role

43a79a903a-+-datasets: rsyncd conf file pieces must end in .conf for the concat

406828eb4f-+-pull rsync and cron jobs out of 'download' into new dataset module

d13248dfdf-+-slim down download::common in prep for refactor

61f74326e1-+-bugzilla: remove the new from motd, old is dead

69b85ab3e1-+-Revert "Create global /etc/gitconfig for deployment hosts"

e008c4fa99-+-Fix-up for Ia67474053: Create global /etc/gitconfig for deployment hosts

d0f1c2299d-+-Make wikimetrics' database setup depend on alembic

f8929ca826-+-Tool Labs: package tweak

47d8f561f1-+-Tool Labs: package addition to exec environ

a3116d154a-+-Merge "Removed notes_url from nagios host extra info" into production

20b5573468-+-Create global /etc/gitconfig for deployment hosts

0953bf805b-+-Merge "Adding submodule update support to git::clone" into production

815a427d08-+-Merge "Use ruthenium.eqiad.wmnet, .wikimedia.org won't work" into production

e899ce99ce-+-Use ruthenium.eqiad.wmnet, .wikimedia.org won't work

427f820485-+-Merge "Add parsoid-tests.wikimedia.org proxy forward to misc" into production

1395165933-+-Add parsoid-tests.wikimedia.org proxy forward to misc

dbb5935e27-+-remove some Tampa LVS monitoring

65e43a0921-+-Remove pmtpa apaches from site.pp

31f72d68bc-+-Merge "bots: minor lint" into production

a3fe04d06f-+-beta: run fatalmonitor only on pmtpa

0da27f5fa9-+-Labs: Disable FSC on all NFS mounts

a79ceb0091-+-use correct auth_name

33e5e8dd73-+-ops ldap group too restrictive

f47b3b355b-+-Adding submodule update support to git::clone

c3fcdb8a7c-+-remove sockpuppet from puppet

dff291a391-+-Labs: Minor fixes to labs_lvm::volume

2385ffbc29-+-Merge "contint: clone some more repos for labs CI slaves" into production

b731f8efaf-+-contint: clone some more repos for labs CI slaves

04dfcebbd7-+-Merge "Tools: Install package supybot" into production

b4c5d04786-+-Merge "beta: on eqiad mount /srv using labs_lvm" into production

e3474388a0-+-Merge "beta: vary deployment-bastion by ::site" into production

b9f0867cda-+-beta: on eqiad mount /srv using labs_lvm

5a55acddcf-+-beta: vary deployment-bastion by ::site

37505994c1-+-beta: natfixup for eqiad public IP addresses

ec90213096-+-Merge "Don't hard-code the labs status region to pmtpa" into production

8673899cc1-+-Don't hard-code the labs status region to pmtpa

3d3d034025-+-Merge "Disable cookie-based geolocation on text varnishes" into production

8236bb1383-+-Disable cookie-based geolocation on text varnishes

a13e48718e-+-Merge "facilities: lint" into production

c6d1ca0043-+-applicationserver: provision stub HHVM role on Beta Labs

2ca109aef5-+-Merge "contint: Icinga now notify on contint related stuff" into production

6264804d9c-+-Merge "contint: install hhvm on labs slaves" into production

4319a1d7d9-+-Enable cookie-based geolocation on all frontend text Varnishes

1951c7d145-+-Finish setting up elastic1013 in ganglia

a6db702c1c-+-Config changes for Elasticsearch

bb1f578656-+-ldap: remove lookupvar and replace with top scope @ var

94cce3bb9d-+-Changing replica_lag_max_messages and replica_lag_time_max_ms

a50167ebe5-+-contint: install hhvm on labs slaves

3143de26fe-+-contint: Icinga now notify on contint related stuff

bed28fdf53-+-fluoride is no longer a target, switch to eventlogging

3f8a3fb53f-+-Change sudo format for pillar fetching and service restarts for trigger

f81cd3b332-+-Adding python-gitdb dependency

656fbaed55-+-Deployment module changes for trebuchet-trigger

f1c6ecd041-+-Enable geo_cookie on cp1055 as well

ca28643256-+-Set $text_enable_geo to true for cp1066

d391594880-+-Update netmapper JSON from noc.wikimedia.org

6c72229707-+-Update netmapper JSON from noc.wikimedia.org

2b1328533d-+-Require config file for staring Elasticsearch

0f79425d1c-+-Merge "contint: slaves now have openjdk-{6,7}-jdk" into production

d56f5ea132-+-Merge "Enable GeoIP cookie on Labs" into production

9f3923eb16-+-Enable GeoIP cookie on Labs

8d8756b6ef-+-remove 'zhen' from site.pp,dsh,dhcpd

8a0356fdc1-+-Tool Labs: forget puppet for now

36d7f96027-+-Tool Labs: class mysql expects a boolean log_bin

dea407085f-+-Tool Labs: set labs-db up (real servers this time)

f0c7254b0f-+-remove 'yvon' from site.pp,dsh,dhcpd

eb109deb3c-+-Tool Labs: use LVM by default

8f7283274d-+-Kunal Mehta access to terbium/flow database, rt #6895

5521e02636-+-Adding hoo to admins::mortals

d71b595759-+-Don't need to require wikimetrics::database

f085dcf68a-+-Revert "disable dumps rsync cron jobs temporarily"

1a5ce52c7f-+-Setting up rsync job to copy kafkatee generated zero logs from analytics1003 to stat1002

aa612180b0-+-contint: maven_webproxy is not using autoload layout

e4d5832f9f-+-Tools: Install package supybot

5b0e70b159-+-disable dumps rsync cron jobs temporarily

65a15fb418-+-Break dependency cycle in osm

8df4aecb0c-+-Fix some variable scoping issues in osm

44ae8d59fb-+-Labs: Some tweaks and saner defaults for labs LVM

affa16f752-+-Merge "fixing etherpad certificate chain" into production

efb8f9668f-+-fixing etherpad certificate chain

1d983528f9-+-Adding elastic101[3-6] to elasticsearch cluster

39fa9197a7-+-Include standard in role::osm

352e3a22d5-+-contint: webproxy for maven on CI production slaves

d2e7ff21f5-+-Puppetizing elastic1013-elastic1016 (not adding to ES cluster yet)

3c7ded4f2a-+-contint: pip shared cache on labs slaves

02971b060c-+-Merge "Use mw_primary for Varnish swift backends" into production

15647dfff6-+-Use mw_primary for Varnish swift backends

4c4ac09bdd-+-Enable keystone redis driver and switch replication around

d9f90f3f97-+-enhanced comments re UIDs and key verification

a25a3055e6-+-turn wikistats into module

2de5d4ef4b-+-Labs: Disable labs LVM until image fixes

f51743556c-+-decom pdf1,remove from site.pp,dsh,dhcpd

4f0f44ba2b-+-ganglia, pdf1 is dead, monitor pdf2/3 not pdf1/2

501f898a7d-+-Merge "Define root disk space check for labs." into production

386b2bcf01-+-enable mglaser's ssh key

26a7bb3460-+-Merge "add cron for bugzilla reporter script" into production

5908b5b725-+-Add integration/php-coveralls to git-deploy

b39b3d48e3-+-enable Mark Hershberger's ssh key

683a6f9505-+-Need to specify type => pipe for processes

a8509af682-+-Merge "add users mah and mglaser to releases webserver, w/o enabling keys pending final verification" into production

c56b0dc4d2-+-add users mah and mglaser to releases webserver, w/o enabling keys pending final verification

44efe848a8-+-Capturing zero request logs via kafkatee on analytics1003

5c38912822-+-Setting up rsync job to copy kafkatee generated webrequest logs to stat1002

f74a14c268-+-Configure Elasticsearch for safe full restart

cec5925a33-+-base: remove redundant ensure => absent Packages

936f719eb5-+-Amir Aharoni access to stat1002, rt #6760

033da2cc4c-+-contint: slaves now have openjdk-{6,7}-jdk

3f4fb2ac9c-+-Add two more compute nodes to eqiad

c484a860f4-+-Puppetize the new_install key on palladium, add to iron.

2322eff539-+-add cron for bugzilla reporter script

55e9f7e355-+-Define root disk space check for labs.

4cc4b7393c-+-labs_lvm: use subshell instead of trust puppet

3ef5f73267-+-labs_lvm: include path in execs

c62da4a8a0-+-labs_lvm: improve detection of existing volumes

0c49801d89-+-Labs: document labs_lvm class and include in eqiad

c9d02a0389-+-labs_vfs: requires -> require

57737199c4-+-labs_lvm: change parameter names

f188976519-+-Fixing kafaktee typo, adding kafak to typos

5dfe83fc5d-+-labs_lvm class tweaks

f6ed33203d-+-Setting up kafkatee on analytics1003 to log mobile webrequest logs

03691b6b32-+-Fixes to the labs_lvm class

707b5a82ec-+-Labs: Fix directory name in labs_lvm module

2f9f34050e-+-Labs: fixes to the test role

544711d248-+-Labs: manage LVM volumes on instance

7792810f79-+-swap in tantalum for rhodium for pdf/trusty testing

a42ad3c935-+-grant hashar,reedy access to caesium per RT 6861

e7e172cdd3-+-Give manybubbles and demon sudo on logstash100X

246d74bd49-+-Refactor GeoIP lookup code; add tests

b5d775a23d-+-Turn the labs::nfs::client class off for eqiad.

37c593eac0-+-Merge "Introduce labsdb100[45].eqiad.wmnet" into production

f0cb820f3d-+-Merge "Adding OSM role classes" into production

be438ffa95-+-Introduce labsdb100[45].eqiad.wmnet

d28b646a61-+-Adding OSM role classes

3aeefe966f-+-Merge "PostgreSQL/Postgis module" into production

0e9436f53b-+-text varnishes: set enable_geoiplookup to false

123fc23599-+-Add a geoip::dev class to use for VCL compilation

2ad7e38512-+-text varnishes: require geoip; set enable_geoiplookup for frontend

d047730991-+-Refactor GeoIP lookup code; add tests

9814020597-+-Updated dc-migrate a bit.

e6e8bc9d15-+-ishmael.wikimedia.org to use its own cert, not wildcard

3b9987677d-+-Clear master certs if we change puppet.conf

761c877a99-+-Merge "icinga-admin to use own cert, not wildcard" into production

a3896b3629-+-icinga-admin to use own cert, not wildcard

2c043f310b-+-Merge "remove kaulen from puppet,dsh,dhcp" into production

c03f1332d4-+-techblog.wikimedia.org to get its own certificate

5b940c882e-+-Log Elasticsearch hot_threads

d8e184f743-+-remove kaulen from puppet,dsh,dhcp

aaa19aeedd-+-Add a fact to pull the ec2id out of instance metadata.

25dd951c96-+-Merge "Revert "Set enable_geoiplookup on cp1066 for geo_cookie"" into production

95c3dbd9c3-+-Revert "Set enable_geoiplookup on cp1066 for geo_cookie"

d6c2a9ad89-+-Merge "Set enable_geoiplookup on cp1066 for geo_cookie" into production

15e1120bb4-+-Add standard headers to the virtscripts.

94f1e1a0cc-+-Merge "Add some labs management scripts." into production

5b972a0ecb-+-Set enable_geoiplookup on cp1066 for geo_cookie

8bb7b45230-+-Random stab at fixing breakage in 49f9f658

f4e0fff2a3-+-Merge "contint: tweak browsertests URLs" into production

7503d57296-+-contint: tweak browsertests URLs

49f9f658a7-+-Adding $brokers_array variable to role kafka config

c5d3dccc94-+-contint: require => needs File[], not just the path

3dd17c00a3-+-contint: get redis under /mnt/redis

9a2fa9b824-+-contint: bring elasticsearch for browsertests

7b531a1834-+-Add some labs management scripts.

045df81148-+-Send Vary header on http to http redirect

5a0459f334-+-txStatsD: add dependency on python-twisted-web

d955aeec88-+-Merge "Open up ssh for wikitech hosts." into production

8c70e43b19-+-Tool Labs: eqiad tweaks to master.pp

51e4159308-+-Open up ssh for wikitech hosts.

dcf239b7d4-+-eqiad should not include role::labsnfs::client

d6a90b9b37-+-Tool Labs: make the /var/lib/gridengine mountpoint

cb67dd51e0-+-Tool Labs: use bind mount for /var/lib/gridengine

cb75e89887-+-Tool Labs: more eqiad fixes

60a9225c52-+-Tool Labs: typo fix in master.pp

7d9ad61f54-+-Tool Labs: Omnibus fix to gridengine for eqiad

63dd86af83-+-Tool Labs: support eqiad grid master

c54badbdda-+-Tool Labs: Fixes for eqiad support

f528446542-+-Add a couple more compute nodes to eqiad labs.

a8f50fe14f-+-remove shell access and key for mgrover

0e7b22e2ad-+-remove smerritt shell account

e46af2e64a-+-removed orion shell account

853c9a00ef-+-regularly compact memory on varnish caches

b15a9f6db3-+-Bump TTM's avg req time alert to 5 seconds(!)

97f3e877d1-+-Merge "Revert "Revert "Reenable redis for keystone in eqiad""" into production

c722aeac8f-+-Revert "Revert "Reenable redis for keystone in eqiad""

7e41942f1c-+-Populate network.pp with eqiad row D networks

76656dc058-+-Add asw-d-eqiad to torrus

54c613a959-+-Labs: manage idmapd.conf on instances

6a91a74533-+-Revert "Reenable redis for keystone in eqiad"

509a2fc2d3-+-Merge "Reenable redis for keystone in eqiad" into production

2678a1e277-+-Merge "Fix virt1000 hostname in redis config" into production

f3fce1d758-+-Reenable redis for keystone in eqiad

d53c19c092-+-Fix virt1000 hostname in redis config

855b1cc79e-+-Revert "Improve LVS check for Elasticsearch"

73c53dbaae-+-Improve LVS check for Elasticsearch

9f98046273-+-Fixing metric for ISR expands and shrinks

35a132090f-+-Adding ISRShrinks and ISRExpands to Ganglia kafka view

d695b6cdca-+-Merge "Turns out every two minutes is not often enough." into production

6de8f2d1ce-+-Switch back to sql driver for keystone in eqiad

7bff54788a-+-Add DNS ferm rules for labs DNS

0d6c97e9dd-+-Fix labs_nodes subnet in firewall config

239be797ca-+-Add http/https to ferm rules on wikitech

8e2b14f42d-+-Add base::firewall to openstack's firewall class

d8e1ab120c-+-Change redis config hash key to hostname rather than fqdn

afe390208d-+-Move the keystone token driver password back into common

12dfb68d2e-+-Combine labs and production classes for keystone redis and include with keystone server

2b950fa3e1-+-Enable keystone redis driver for eqiad.

f3a33e6092-+-Add redis support to keystone in labs

532a8d32ea-+-Merge "Add redis config for keystone in labs" into production

1b3b2af3eb-+-Labs: Kick sshd when /public/keys is mounted

98f6820369-+-Turns out every two minutes is not often enough.

3fa1842f48-+-Reducing varnishkafka queue_buffering_max_messages from 2M to 500K

5e646e5bb8-+-Symlink remaining scap scripts to the scap repository

543bcaafcd-+-Add an eventual consistency call for deploy.deployment_server_init

4a6032acf1-+-Updating kafka module and increasing replica.lag.max.messages to 10000

e57dff2ede-+-Rename subnet labs-hosts1-c-eqiad to labs-support1-c-eqiad

542944f15b-+-Revert "Handle role::labs::instance properly in pmtpa."

4428ec3b7c-+-Merge "site: lint" into production

ab6fe0882e-+-Labs: Fix permissions for nfsmanager

782bb6e04b-+-Tool Labs: Install tabix on exec_environ

114f93ed07-+-Merge "jenkins: remove accesslog rotation absent statment" into production

7f4d57aa3a-+-Merge "parsoid: remove init script absent statment" into production

8fba553ef3-+-parsoid: remove init script absent statment

aaa448c267-+-mwlib: lint

defee69065-+-site: lint

b3e663217c-+-contint: get ocaml-nox package for Math texvc

dc763746e2-+-PostgreSQL/Postgis module

7187591526-+-jenkins: remove accesslog rotation absent statment

fee24295e8-+-Handle role::labs::instance properly in pmtpa.

1db9f56a74-+-disable netmapper update cron temporarily

98979cd412-+-disable netmapper update cron temporarily

67e26aaabb-+-Drop enabled => true param on Parsoid upstart Service resource

ac1d65879d-+-Merge "alert earlier for disk space on parsoid servers, rt 6851" into production

e0198af024-+-remove shell account for lwelling and access to stat1

90e2a14082-+-Merge "Remove old public key" into production

96c49ef489-+-Labs: fix inversion in ldap::role::client

27dbe65de0-+-Move labs-specific stuff out of base

1df2ae1926-+-Labs: remove unneeded (and broken) autofs stop

db09c7f96e-+-Labs: NFS mounts for labs instances

6cb12d203c-+-Varnish: disable WAP on mobile frontends

51ebacb570-+-Varnish: disable WAP on mobile frontends

00344a7fbb-+-Labs: make a generic "every instance" class

78b19c5e87-+-Move manage-keys-nfs cron to the actual nfs class.

b897e2a0bc-+-Add cron for manage-keys.

837db573bf-+-Labs: Tweaks to labstore config for migration

d2829a58ce-+-Labs: Add labstore100[12] node entry

339edff69e-+-Revert "nuria access to erbium, rt #6836"

d2e0f86fc3-+-nuria access to erbium, rt #6836

08329cb85f-+-alert earlier for disk space on parsoid servers, rt 6851

165bb6c1b9-+-releases role indentation and style fixes

3b2acb4e65-+-Merge "Havana wikinotifier needs to use conductor &c." into production

c189a99f89-+-Merge "In Havana, switch back to a driver-based wikinotifier." into production

8ebe68a15e-+-limit to ops for now

45e4e357d0-+-tendril add missing manifest

e0549ffbcd-+-tendril.wikimedia.org, borrow basic structure from ishmael which is already on neon.

d90e34bca6-+-Havana wikinotifier needs to use conductor &c.

afeb0fd572-+-In Havana, switch back to a driver-based wikinotifier.

384e4406c6-+-Update puppet every two minutes, not at two after the hour.

61e99d9186-+-Fix some of the string-substitution magic in the labs vm build.

d4ecffb804-+-Merge "Add cron entries to update puppet repos on labs puppetmasters." into production

7542abcb1a-+-s1 assign db1034

098a2082e0-+-Remove old public key

eb77f4403e-+-eventlogging: manage /etc/eventlogging.d recursively

2ebd6c3a96-+-Migrate EventLogging to "%{..}x"-style format specifiers

05aa97d2e8-+-Add shell account for santhosh, admins restricted + stats1002

234eb4cf21-+-Add cron entries to update puppet repos on labs puppetmasters.

84fa064875-+-Add a second compute node.

256127e24e-+-Merge "Change eqiad instance IP range." into production

f03a0ebbf6-+-reassign db1030 to s6

8065c65dae-+-remove es[123] for decom

bd5e8234e5-+-Merge "load Bugzilla virtual host first" into production

536ccb50a4-+-load Bugzilla virtual host first

05b4027973-+-Disable EventLogging's MongoDB writer

058fda428e-+-Removing cp1001/1002 from ganglia.pp and cache.pp

24f4e16008-+-Merge "Switch to a bigger fixed IP range for eqiad labs" into production

db1ceeac17-+-makes template symlink for otrs

59f61d8b39-+-Change eqiad instance IP range.

0386de0722-+-Switch to a bigger fixed IP range for eqiad labs

08be3869ea-+-Small reorg around reuse of  network_flat_interface_name and  network_flat_interface

89671f3672-+-Switch eqiad network host to use eth0 and eth1.

9fc76a0d3b-+-remove old Bugzilla puppet class/role

6bed8a8c3f-+-Merge "remove old db9 bugzilla_report script from kaulen" into production

92c959ce03-+-remove old db9 bugzilla_report script from kaulen

4c082e9d32-+-prepare db9 for decom

02ff70ed57-+-Merge "add 'mwgrep' common script" into production

8201c6aafd-+-add 'mwgrep' common script

a4f702373d-+-switch new Bugzilla db from _testing to prod

22f6deef22-+-Putting analytics users on analytics1027 so they can ssh tunnel to hue

e8796c72ea-+-Remove old parsoid init script

73e75adb56-+-Sahar access to analytics hosts

cc6d3eecb3-+-Sahar access to stats servers, rt #6767

34177d0b91-+-rsyslog: use provider => 'upstart'

59d733c08d-+-remove streber from puppet,dsh,dhcpd

47239a7d2c-+-base: remove initcwnd if-up.d hook for >= oneiric

533e8f7161-+-remove locke from puppet,dsh,dhcpd,ud2log filter

4f908413c1-+-[DO NOT MERGE] Setting batch_num_messages to 6000

fac3753c20-+-add shell account for phuedx and add to mortals

80e0f2b65e-+-hourly logrot for parsoid for now

ac32311247-+-Add redis config for keystone in labs

6cd3828d29-+-Merge "scap: ensure local copy is up-to-date; chgrp wikidev" into production

ba20f940c6-+-scap: ensure local copy is up-to-date; chgrp wikidev

78ca8bf6ba-+-locke: decom, remove logging doc comments

8d8cc3073d-+-Revoke key per request

c8ec8308f6-+-decom 'harmon' - rm from site/dsh/partman/dhcp

5cec16129b-+-Adding new research leila, giving access to stat1 and stat1002 and bastions

781864dc5d-+-ssh: use provider => 'upstart'

fd42e67c9f-+-salt: remove pinning to specific package version

2d7f401912-+-install-server: fix late_command for trusty

05525956c4-+-contint: file{} needs 'owner' not 'user'

66ce75b01d-+-contint: .gitconfig for jenkins-deploy user

54c771de5f-+-contint: move jenkins-deploy user home to /dev/vdb

26abefdb0f-+-Add shell account for hoo, admins restricted

abb8635c66-+-Removed notes_url from nagios host extra info

decb528410-+-caesium added as backend for varnish misc web cluster

77ed10dfb4-+-Switch nova-network vlan from 1118 to 1102.

7fece069ab-+-Move ports-wikitech.conf out of templates and into files.

0e0af62c2a-+-caesium as releases webserver (mw tarballs etc)

317a7fd7c7-+-module for releases webserver (mobile and mw tarballs)

90acc9180e-+-contint: fix slave-scripts deployment on labs

13823c36ec-+-contint: slave-scripts are deployed via git-deploy

9f24da006d-+-contint: browsers for testing + xvfb for headless

39120be8f4-+-Merge "puppetize ports-wikitech.conf on wikitech hosts." into production

49c612d58c-+-Merge "logstash: Add normalized_message field to all events" into production

8cf6cd3dca-+-Merge "Added role::nova::manager to virt1000, so I can debug OSM." into production

4c859f4b06-+-update coredb topology for s2 master switch

0013c08035-+-Remove old parsoid deploy repos and remove parsoid salt module

6ca91d46fd-+-puppetize ports-wikitech.conf on wikitech hosts.

721d80d0b5-+-Added role::nova::manager to virt1000, so I can debug OSM.

a93dda0bc5-+-Revert "Include the nova-api-metadata service in havana."

6213f68868-+-Include the nova-api-metadata service in havana.

82b00a5de7-+-Appears to need same fix as If0117511497ee1457e63d2710f1c3e29f4f44bc0

fb138a5819-+-Set up eth4.1118 on labnet1001

1524852456-+-Use 10g interface for labnet1001

b21bda950e-+-Add role::nova::network to labnet1001

40ec00edd4-+-Add the use_neutron switch.

cc5ef32ec0-+-Replace some nova-network configs for eqiad.

05199d32b5-+-logstash: Add normalized_message field to all events

643d6f135e-+-Adding alerts for Kafka Broker replication metrics

1ba62586f4-+-fix whitespace in mysql nrpe check command

8834591e11-+-fix mysql process monitoring and puppet run on pc

03ac8b7d8c-+-Split exim stats to own class and add it to mchenry

f549a1980e-+-Merge "Don't configure a nova-network interface in havana." into production

bc02d41d56-+-Merge "Add eth1.1102 interface to compute nodes" into production

962f431819-+-mysql: change nrpe monitoring to use nrpe::monitor

5fe66ddd6a-+-Merge "Tools: Fully qualify variables for Puppet 3 compatibility" into production

dc269b5583-+-Merge "lucene: puppet 3 compatibility fix: fully qualify variable" into production

2539ee6501-+-Don't configure a nova-network interface in havana.

abd0ded421-+-Add eth1.1102 interface to compute nodes

dd06ef4692-+-Cut down to just one compute node for now.

8874078ae8-+-Specify sysctl priority for openstack settings.

7d2b63b007-+-Merge "Configure novnc for instance debugging." into production

f3ba9b677b-+-lucene: puppet 3 compatibility fix: fully qualify variable

df09f41d53-+-Reflect emery -> erbium move in documentation

fa2c85521e-+-Configure novnc for instance debugging.

9157654048-+-Fixing domain name for erbium host

d103c57199-+-Increasing num_replica_fetchers to 2 on kafka brokers

73b671bff7-+-Further attempt to actually add neutron_ldap_user_pass to nova.conf

63cec508b2-+-Try using a proper username/pass for neutron auth

14b2f57e9b-+-Remove a weird redefinition of controller_hostname.

6943e7ec50-+-Tools: Fully qualify variables for Puppet 3 compatibility

64414d16df-+-Merge "Added auth_uri to a few more places, as requested by havana." into production

2d54e16530-+-Added auth_uri to a few more places, as requested by havana.

738ed92f5c-+-Merge "contint: on slave labs, install tox from pip" into production

f8fd2de24f-+-Merge "Fix up ownership for /var/lib/nova/instances" into production

e581d644db-+-contint: on slave labs, install tox from pip

d27d169fb9-+-Fix up ownership for /var/lib/nova/instances

acf6ec9f07-+-Temporarily disable multi-master salt

449239ea17-+-Merge "replace scap bash script with equivalent python code" into production

1c53cb39cd-+-replace scap bash script with equivalent python code

6444158b80-+-Reduce labsdb1003 mariadb global memory usage (buffer pool size) to allow for high per-thread usage. Kernel OOM killer hit instance on port 3306.

ea4bc7d2ac-+-Sideline db1034 for hardware checks RT 6783. Assign db1024 to s2 as replacement.

8dd8f92df2-+-clean up s2 and s4

4afdd63ca1-+-remove old erzurumi ActiveMQ monitoring

7a1913c9d0-+-mail: change mailman check to use nrpe::monitor_service

072ab9e16b-+-Adding Replica-MaxLag to Ganglia kafka view

6d3a0f7f30-+-offhost_backups: remove, per jeff green on IRC and

e405e7e622-+-emery: RT #6143 move two logs to erbium

19117009c0-+-Merge "Bug 60694: Make the config file path configurable" into production

53c592117a-+-Bug 60694: Make the config file path configurable

225c9e2ed8-+-Rewrite 'scap' script in Python

5f670f605a-+-There's no neutron-plugin-openvswitch-agent service on the controller.

043830f9e9-+-Merge "Simple typo fix:  s/ip_address/ipaddress" into production

43c81ddbc3-+-Merge "Pass the data interface ip down to the vhost plugin config." into production

db611ccf20-+-Merge "Upping nofiles ulimit for production kafka" into production

59eab3e4b2-+-Removing references to metrics.wikimedia.org puppetization

8ad9fc0b0e-+-Upping nofiles ulimit for production kafka

38d369da0b-+-Merge "Revert "icinga: remove check_ram.sh doesn't seem to be used anywhere"" into production

e569246397-+-Revert "icinga: remove check_ram.sh doesn't seem to be used anywhere"

95fdd05504-+-icinga: remove check_ram.sh doesn't seem to be used anywhere

2720dbe275-+-Merge "Assign eth4.1102 ('data') an IP." into production

d070d1fce2-+-Merge "spamd: change to use nrpe::monitor_service" into production

be8432169f-+-spamd: change to use nrpe::monitor_service

d7988ed434-+-nrpe: move carbon checks to use nrpe::monitor_service

32f6a4fe21-+-update coredb topology for s1 master

f6e1800aa4-+-Make scap script files symlinks to /srv/scap/bin files

d7dfb24dff-+-Move Git::clone['mediawiki/tools/scap'] to mediawiki::sync

2a09375f99-+-Git::clone['/srv/scap']: owner => 'root'

4f1260b111-+-Configure staging area for scap rewrites in /srv/scap

77974333be-+-Simple typo fix:  s/ip_address/ipaddress

14021fac0e-+-Pass the data interface ip down to the vhost plugin config.

877e2d1803-+-Best to assign a value to neutronconfig before passing it.

07a06562c1-+-Added metadata-service.

34f5f6f608-+-Set up three separate neutron rolls: controller, netnode, compute.

893186bb49-+-Added support for the metadata secret.

3e078a9b97-+-Merge "Assign eth4.1102 ('data') an IP within the 'tagged' resource." into production

5356c9c6dd-+-Assign eth4.1102 ('data') an IP within the 'tagged' resource.

67675405b1-+-Assign eth4.1102 ('data') an IP.

0d76c6c0aa-+-Set br-ex by hand because Augeas hates it.

42cd8c2e1b-+-Merge "Use the new 10g network adapters for neutron." into production

e8a06c47d4-+-Use the new 10g network adapters for neutron.

38121a3930-+-bots: minor lint

c81b7ac0eb-+-certs: lint

c280049d5f-+-package-builder.pp: add admonition to not refactor or lint this module

68f2f21c90-+-facilities: lint

bd5952ebf0-+-Add another network interface to neutron server.

c9bd75bfd8-+-Merge "Add a note about a couple of steps we did w/out puppet" into production

7621f1f3aa-+-Tools: Mirror font packages used in production

85423f256c-+-Merge "Tools: Add Ukrainian locale and sort list" into production

6a3b22d216-+-labnet1001 interface addressing adding external interface + removing unneeded site selector

b85c8bf10a-+-Tools: Add Ukrainian locale and sort list

f11337262b-+-Add a note about a couple of steps we did w/out puppet

292c8b3ce6-+-Pass proper external interface to openvswitch

0bcdfceb8a-+-Set up second net interface for neutron

699d42a05a-+-Adding critical parameter to nrpe::monitor_service

b860cad745-+-labs: send puppet traps to icinga.pmtpa.wmflabs

e7a6d1b5cd-+-beta: convert into a module

26f73fe5a5-+-assign db1027 to s3

d094e851e7-+-Add a few more neutron packages, adjust sysctl settings.

b3ae6bf704-+-Using line graphs for queue graphs in varnishkafka ganglia view

43922e333a-+-Adding varnish.client_req to varnishkafka ganglia view

19197cd63e-+-Merge "WIP: Phase 2 of switching to the new Parsoid deploy system" into production

2a1d6160f9-+-Disable access for mhoover.

08dc5b92be-+-updated IP address of icinga for labs.

804c5b812d-+-Restore LVS sysctl priority of 50

9389764698-+-Mount /dev/md1 on /var/lib/nova/instances for compute nodes.

d7a4aef4f6-+-/fully/qualify some exec paths

1b193dd62c-+-Change my 'after' to a 'before' because I guess there's no such thing as 'after'

9c69c48c0a-+-Configure bridges and ports for OVS

477f3af8c5-+-Add openvswitch-datapath-dkms package.

04e9119c71-+-update coredb topology for s4 master

0274ca4998-+-Merge "Configure ovs_neutron_plugin" into production

fdd3612248-+-Merge "Include openvswitch plugin with neutron." into production

7490c3697f-+-Merge "Fix up the auth section for neutron" into production

2739ca1869-+-Merge "Specify rabbit_host for neutron." into production

1f7853856b-+-Merge "jenkins: change nrpe check to use nrpe::monitor_service" into production

90592e8552-+-jenkins: change nrpe check to use nrpe::monitor_service

e27242d99c-+-A short script for viewing exceptions

cb5d4a0852-+-Configure ovs_neutron_plugin

8b9d6ef4dc-+-Include openvswitch plugin with neutron.

53ce84e41d-+-Fix up the auth section for neutron

4e408c5713-+-Specify rabbit_host for neutron.

b06e842d8b-+-Lint fixes for neutron bits.

c57e93c423-+-Rough in a neutron service for labnet1001.

cd52a815c3-+-Merge "blasted white space!!! adding payments1-4 to decom.pp" into production

0c21844cb5-+-blasted white space!!! adding payments1-4 to decom.pp

f928812164-+-WIP: Phase 2 of switching to the new Parsoid deploy system

53fe254e22-+-parsoid: ensure => absent on /etc/init/parsoid-test

e254227c8e-+-add FIXMEs for erzurumi references

99a63d1fbb-+-removing professor as an example from statsd/man/init.pp

207092cf22-+-Adding loudon to decom.pp

89da0ab61b-+-kibana: Set default dashboard

f17e045f0e-+-WIP: Phase 1 of moving to new parsoid repo / upstart

7033a246f1-+-Upping varnishkafka produce buffer to keep up with traffic on bits servers

6707bcc17c-+-Replace and fix the havana libvirt driver hotpatch.

16e9e49318-+-Merge "Rename last references of labsconsole to wikitech" into production

f601401559-+-Rename last references of labsconsole to wikitech

65c31348a3-+-Revert "Creating network config for eqiad nova network controller"

1514c11cbe-+-Revert "fixing typo - taged to tagged"

053318480a-+-Add nova-conductor to havana installs.

50d98904b8-+-Don't hotpatch the virtdriver for havana.

c6128d5c60-+-Move a few more things from virt1005 to labnet1001

2f88159259-+-Enable new cron jobs for wikidata change dispatcher and pruning

4f3e7f1f72-+-Fix variable assignment for wikidata cron jobs

6a76a6b685-+-update wikibase cronjobs to use wikidata build

74c2dbd81f-+-Giving shell access to Christian on gerrit and gitblit boxes

0404c6d584-+-Allow PUT method to hosts behind the misc Varnish cluster

7a0a811c28-+-nagios: puppet 3 compatibility fix: fully qualify variables

e431f04575-+-emery: move rsync api job to erbium

3073e9e0f4-+-poolcounter: convert into a module

c2dccdad08-+-Include python-novaclient for nova/havana.

b478587009-+-removing pappas from dsh/dhcpd and site.pp

6db0b00109-+-decom professor, add decommissioning.pp

ae3eebd297-+-set lists.wikimedia.org to use own cert, not wildcard

b3715ad776-+-ticket.wikimedia.org to use own cert, not wildcard

db6cc4beed-+-Merge "svn.wikimedia.org to use own cert, not wildcard" into production

88b70e0c87-+-svn.wikimedia.org to use own cert, not wildcard

582cd232da-+-Adding jgonera to admins::mortals group for deploy rights

06cdb6e4c7-+-payments1-4 decom

7b7f03356b-+-fixing typo - taged to tagged

6d23f80021-+-Creating network config for eqiad nova network controller

3cedadb796-+-generic-definitions: lint

ecbed367f6-+-emery: move rsync teahouse job

fd6d3c7e15-+-fix whine.pl whining cron for new Bugzilla

06c23a393b-+-fix collectstats.pl cron for new Bugzilla

e17e2bc67e-+-Merge "fix svn::client include in contint module" into production

64aae1d73c-+-fix svn::client include in contint module

4d9ae174a2-+-Proxy ubuntu cloud archive so we can install openstack stuff.

872ecc8455-+-Merge "fix svn::client requirement in ganglia::web" into production

a2b11f60b9-+-fix svn::client requirement in ganglia::web

2b1e93b67c-+-Openstack Havana in eqiad, baby step:

93c82d01a1-+-Merge "imagescaler: lint" into production

d3ad8c18c0-+-Merge "deployment:  puppet 3 compatibility fix: full path to puppet file server" into production

afe73c6e5e-+-Merge "snapshots: lint" into production

b0460b8e41-+-deployment:  puppet 3 compatibility fix: full path to puppet file server

c04b4366b5-+-svn: convert into a module

d558995770-+-emery: remove rsync arab banner job

f4be20a148-+-graphite: fix storage aggregation patterns

8e985f2475-+-Allow caller to specify Pin-Priority in apt::repository

e10631cf8a-+-Pass in explicit --defaults-file=/root/.my.cnf to db creation calls.

6b2b2a4c23-+-wikitech: Add intermediate certificates to chain

d0a7d1ceb8-+-Merge "Add scap-recompile to puppet instead of wikimedia-task-appserver" into production

c34a1d2b85-+-setting ca_name for wikitech.w.o cert

9b78c2cb8c-+-Add scap-recompile to puppet instead of wikimedia-task-appserver

582c0cc30a-+-Removing metrics site (UMAPI) from stat1001

55ea411fad-+-Remove obsoleted views from Ganglia

d245fb215a-+-handle different varnishkafka frontend for bits

aa8f0fcd6a-+-Merge "Enable varnishkafka on bits caches" into production

ca82723b1f-+-beta: remove beta_monitor_fatals_every_hours

d0816b46ec-+-beta: fix fatal monitor duration detection

9268db5eb4-+-beta: fatal monitor twice per days

6a6d5d6cff-+-Merge "ldap: puppet 3 compatibility fix: fully qualify variable" into production

92d2652915-+-ldap: puppet 3 compatibility fix: fully qualify variable

975375603b-+-remove professor from site.pp

4b98a01459-+-Merge "network: lint" into production

45d2c2ae62-+-Merge "change search monitor_group description to eqiad" into production

f1f8c376ed-+-Add VisualEditor timing data reporter

5c0dac6aba-+-tcpircbot: allow 'channels' to be either a string or an array

91501ed002-+-retire logmsgbot from #wikimedia-dev

b000b67a1d-+-Merge "Save backups for 4 days rather than 7." into production

9cfd7192e8-+-update coredb topology after s6 master rotation

8f6c7979ed-+-Merge "set time intervals properly" into production

4c6b6feb84-+-Enable varnishkafka on bits caches

2287f93482-+-Revert "setup misc-web-lb to cache for blog.w.o server holmium"

6c72267401-+-Merge "Provision performance.wikimedia.org" into production

6846b3dc76-+-network: lint

02484b50a6-+-Provision performance.wikimedia.org

73d246ab8f-+-Using correct variables for labsdb database creds

61208714bf-+-Save backups for 4 days rather than 7.

892875ffd9-+-Some fixes for wikimetrics in labs

80d3b3f43f-+-set time intervals properly

211dc6c728-+-Puppetizing wikimetrics for use in labs

783f4757f1-+-Wrapping some package openjdk-7-jdk installs in if !defined

2e46b6b542-+-Including role::analytics::clients on stat1002

874ecdb8f6-+-Access for nuria on analytics cluster

a16d2093c5-+-::qualify some top-level class references

200fb2fa16-+-Run every 12 hours instead of every minute.

6a70873908-+-snapshots: lint

f0ebbd4b05-+-send BZ community metrics to communitymetrics@

830985cb9c-+-Merge "Simple Openstack test cluster" into production

a3d05928d0-+-Merge "dyanmicproxy: Add license headers to files" into production

c2272550be-+-Simple Openstack test cluster

4635518f83-+-mobile: lint

dc62717a25-+-change search monitor_group description to eqiad

b8e76e8d24-+-Merge "search: lint" into production

2c15557e9d-+-Merge "webperf: Remove misleading references to Ganglia" into production

57ff4250d5-+-search: lint

9037df8976-+-switch db1015 to innodb_file_per_table

5b1cc56b7c-+-Fix gitblit duplicate definition

5bbd97bc8e-+-Import the stackforge openstack module for testing.

4d7c747068-+-Tools: Install python-magic

e715c79c45-+-imagescaler: lint

ffc8c6e287-+-Use statsd service alias where appropriate

d54ef708f5-+-txstatsd: max-queue-size = 1m, max-datapoints = 10k

ed20ec3d6f-+-formey has wildcard cert, removing it from installation

65ed415ad2-+-Add cscott to admin::restricted

f80fc0475c-+-add account for cscott and add to rhodium

9befe9b6fb-+-retab openstack.pp

39cd75676a-+-dyanmicproxy: Add license headers to files

badf655cb3-+-Merge "Enable collect_exim_stats_via_gmetric cron for mail relay" into production

a68d4c338d-+-Fix wikitech-robots.txt url

2089da0dbe-+-puppetize wikitech robots.txt

45956a3b55-+-Merge "base: remove sun hardware related from platform" into production

b67dd2fd5d-+-Merge "gdash: remove 'intervals' options" into production

5e66fcc3d6-+-gdash: remove 'intervals' options

e56a5ff1a7-+-reassign db1010 to s6

8fd16c6ad8-+-Add IPv6 address to hooft too

3d191d4454-+-Add IPv6 address to bastion hosts

8ff7a17a36-+-gdash: configure dynamic time intervals

16f6e25211-+-base: remove sun hardware related from platform

2116a2b09d-+-removing ssl mod load for gallium

504018953f-+-stop gallium installing star certs

44495d20d8-+-blog.w.o to use own certificate, not wildcard

2bc0a585de-+-replacing wikitech's star cert with specific cert

b640a0ba80-+-Enable collect_exim_stats_via_gmetric cron for mail relay

970e04a1d7-+-use bugzilla-daemon as sender address for scripts

059182e6f8-+-Merge "disable Bugzilla collectstats.pl" into production

2d13441370-+-disable Bugzilla collectstats.pl

7974957277-+-Merge "disable Bugzilla whining cron spam" into production

7016f33d8c-+-disable Bugzilla whining cron spam

bcdcdb046c-+-Merge "re-enable bugzilla audit/metrics mails" into production

0deaf8275e-+-re-enable bugzilla audit/metrics mails

2a0073f965-+-puppetize beta fatal monitor

a29f15308e-+-Merge "revert to star cert on virt0/1000 for web services" into production

66b3549040-+-txstatsd: use pickle receiver port (2004)

e5bebd74fa-+-graphite: max_cache_size to 10,000,000

cfb59489b2-+-disable swift statsd logging for now

066c1adc2b-+-update cert names for web servers on virt0/virt1000

ca2c3ef28f-+-swift: log_statsd_sample_rate_factor = 0.01

a67e09ac2f-+-monitor_service's "passive" parameter should be a string, not a boolean

a0b659cbc9-+-Logstash: fixes and tweaks

e6b56e4ec5-+-Merge "apache: bump MaxClients from 40 to 100 for bits" into production

d7963299fb-+-Merge "setup misc-web-lb to cache for blog.w.o server holmium" into production

1805aa4ba0-+-setup misc-web-lb to cache for blog.w.o server holmium

c44233488e-+-Reset key for anomie (Brad Jorsch)

9eeddbb049-+-Need to escape ! in icinga check

e081f645aa-+-Add service check for https://git.wikimedia.org/

ae49c7c035-+-Updating git::clone so that gerrit urls can be assumed by default

60bb2b8f11-+-Adding icinga alert if primary Hadoop NameNode is not in active state

e7befa3312-+-Merge "bugzilla reporter needs to be template not file" into production

054d4d2cd2-+-bugzilla reporter needs to be template not file

a3974e44fe-+-openstack: convert iptables to ferm

2adc16ea0e-+-fixing change for virt0/1000 certificate install

522840f684-+-Merge "replace wildcard cert for labs ldap" into production

d28cc603d8-+-bugzilla: remove hardcoded db host

7dd17dcd3b-+-apache: bump MaxClients from 40 to 100 for bits

e33dc38424-+-route navtiming stats directly to statsd instance on tungsten

6688bf5cc8-+-revert to star cert on virt0/1000 for web services

074a2790ee-+-replace wildcard cert for labs ldap

1b72ba84f7-+-webperf: Remove misleading references to Ganglia

5ae3d79b59-+-asset-check: report to Graphite rather than Ganglia

acdb1444ea-+-webperf: factor out local configuration to role class

8a44203f3d-+-Merge "txstatsd: specify tungsten as graphite host (rather than 'localhost')" into production

76a1a5a259-+-txstatsd: specify tungsten as graphite host (rather than 'localhost')

774c7eb61e-+-removing loudon and erzurumi from puppet

c2c131d9df-+-Backup /var/lib/puppet/volatile

7dd59b2d2a-+-Creating account for Charles Salvia and granting access to analytics and stat nodes

e0c57bc9a0-+-Add upstart job definition file for Gitblit

b11d6dc8a8-+-udp2log: puppet 3 compatibility fix: fully qualify variable

26dbde9d19-+-base: lint clean

41f63f9eec-+-Merge "deployment: lint clean" into production

114cb20071-+-dynamicproxy: lint clean

ba2152fe21-+-deployment: lint clean

97fb42a555-+-gridengine: lint clean

58c638ebef-+-Revoke anomie's key per his request

1a6c697ebe-+-Remove single-quotes around a $variable.

ae51646457-+-Merge "ldap : lint cleanup" into production

59630ea7bf-+-Merge "generic: lint clean" into production

709abc8a43-+-ldap : lint cleanup

4887dc90a2-+-generic: lint clean

e066bfd713-+-apt: lint clean

e862bde876-+-url-downloader: convert into a module

1fea232818-+-gitblit: make gitblit user home dir /var/lib/gitblit

adbcbd7f39-+-role::gitblit: fix scope resolution error

f179c03f20-+-gitblit: fix for https://gerrit.wikimedia.org/r/#/c/107555/

1c32e81f63-+-gitblit: convert into a module

1a64760eb8-+-db63 ganglia aggregator for remaining pmtpa db boxes

ae1e04b1b6-+-Update coredb topology for mha.

04810cbef3-+-sideline db1024, RT 6672

5ffd410917-+-reassign db1033 to s7 during schema changes

011aa76f0a-+-logstash: Reduce filter worker count to 1

7d5086f6ec-+-Forward UDP logs to logstash1001.eqiad.wmnet

d838e36232-+-Add iron.wikimedia.org to bastion_hosts

0b531ffe1b-+-Merge "geoip: puppet 3 compatibility fix: module path" into production

09ccd13647-+-Merge "smokeping: puppet 3 compatibility fix: module path" into production

1dd978a7a8-+-Merge "hive: puppet 3 compatibility fix: fully qualify variables" into production

05668d0a8d-+-Merge "contint: lint packages.pp before spliting up" into production

9616cd6c7d-+-Port statsd role to use txStatsD; apply to tungsten

17b0b6e63d-+-Add txStatsD module

d6af239418-+-Another ganglia aggregator for db multicast group to try to reduce stats gaps.

6adb755554-+-Add logstash config for udp2log

caddd18df4-+-Merge "a little file ownership and formatting cleanup in fundraising.pp" into production

07d10c14ff-+-a little file ownership and formatting cleanup in fundraising.pp

adf3d89702-+-Merge "Revert "varnish: add Ganglia metrics for memory statistics"" into production

68b3d17719-+-Revert "varnish: add Ganglia metrics for memory statistics"

1996515b60-+-Merge "varnish: add Ganglia metrics for memory statistics" into production

7954abe4aa-+-Logstash: Configure Elasticsearch to automatically create indices

0ffa1d4318-+-varnish: add Ganglia metrics for memory statistics

a9fe1601aa-+-fix duplicate file install error

1bb6d824cd-+-redo install layout for legacy paypal IPN listener

ba860ff504-+-Log cron job output to files for geowiki's process_data step

0ffe598bd6-+-analytics1012 is no longer a journalnode

e0aee9f0ba-+-remove and/or move several fundraising conf files to aluminium:/etc/fundraising

ec69b18609-+-Escaping '!' negation in varnishkafka drerr icinga threshold

c4fceda991-+-Fixing threshold for varnishkafka drerr alert

e202b06d43-+-Fix for check_ganglia, removing unused checkcommands

98a49f9fe9-+-Using monitor_ganglia for udp2log packet_loss_avg and vanrishkafka drerr

363b57bd90-+-Fixing missing comma

13b6d75db2-+-monitor_ganglia cannot require icinga::ganglia::check

0ab17995a4-+-Trying out monitor_ganglia with kafka-broker-MessagesIn check.

a210209298-+-Adding define monitor_ganglia

d6f1d0d965-+-Adding class icinga::ganglia::check to install check_ganglia

dc4f192202-+-Style fixes for nagios.pp

f6b9ac114e-+-Merge "removing remenants of db29 from puppet, adding to decom.pp" into production

d0954b1354-+-removing remenants of db29 from puppet, adding to decom.pp

d29791bc27-+-contint: invoke gerrit-sync-ve-push.sh as jenkins

a3d3d3e891-+-geoip: puppet 3 compatibility fix: module path

ebc732de6d-+-smokeping: puppet 3 compatibility fix: module path

3211d2757d-+-Merge "cpufrequtils: lint clean" into production

1d3ba9530f-+-Merge "download: lint clean" into production

e686e4629a-+-decom hooper,eiximenis

28533a8edf-+-hive: puppet 3 compatibility fix: fully qualify variables

f81bfb41c4-+-webserver: puppet 3 compatibility fix

819557cc79-+-OCG: update trebuchet config and remove Node

0f49722cdb-+-tcpircbot: fix multiple unreferenced var errors

dee62150d9-+-remove db29 for decom

67955d0eda-+-Better (12.04) packages for OCG

65a7da010e-+-Add standard role to rhodium

1b2f0f144a-+-Apparently Cscott does not have shell

676694d0df-+-Introducing the role:ocg:production

0e8840cd53-+-Qualified Lookup of OCG Class

872f857497-+-Merge "Do not include and declare the OCG class" into production

b62ae24719-+-Do not include and declare the OCG class

4d1acd9b6f-+-Make it possible for logmsgbot to report to more than one channel

eb505e07ff-+-Add 'graphite-index' script and cron job

2d0dfebb05-+-download: lint clean

5a6a2d7127-+-Merge "Collection Renderer (Now a module!)" into production

25323d8d05-+-Merge "Mark iptables as being soon deprecated." into production

58ef7fb304-+-kibana: enable Apache2 rewrite module

bcb3db3e53-+-Collection Renderer (Now a module!)

796de37d8a-+-Give Nik & Chad root access to lucene search boxes

712e36f222-+-Revert "Initial commit of pmacct module"

940e42fe88-+-Proxy logstash.wikimedia.org via misc varnish cluster

482837419f-+-Give iodine a predictable IPv6 address

d0ac304c01-+-Fix Kibana init.pp file location

8eb0ccc3f1-+-Kibana puppet class

0b9324ac36-+-dport is important

4e9f095783-+-allow udp by default with ferm

94252e3c73-+-Adding in semicolon for proper ferm syntax

457a235d59-+-requiring ferm winds up making cyclical dependancy

790ffbb433-+-including class ferm (to make ferm rules work)

584330b4a0-+-cannot have two require statements

6cdd3ec119-+-requiring ferm class if ferm rule is called

aaa956e0c8-+-Applying pmacct to netmon1001

2e7954be2d-+-Initial commit of pmacct module

3da5f034d2-+-add user gdubuc per RT 6619

b45cff1abe-+-Mark iptables as being soon deprecated.

aa4f6383ac-+-remove fundraising users from aluminium, they have migrated to lutetium

790e741072-+-reassign db1040 to s4

a93abfb122-+-bacula: lint clean

2480f37efd-+-contint: lint packages.pp before spliting up

2d24a43ff4-+-cpufrequtils: lint clean

ca77f32140-+-switch db1049 to innodb_file_per_table=1 during reclone

ed9fb8639b-+-Raise number of job runners by 1 per server

71e07d6803-+-Merge "poolcounter: monitor TCP port 7531 replies" into production

3a7fa4da4b-+-Merge "poolcounter.pp: retab/puppet lint fix" into production

3350bf9a0f-+-Fix various typos

0a15bdf392-+-poolcounter: monitor TCP port 7531 replies

242d2c0b4a-+-poolcounter.pp: retab/puppet lint fix

35c5df22c1-+-Remove all occurences of old etherpad

8941e4676b-+-Merge "add nuria to privatedata admins" into production

8a1721ae69-+-Merge "stages.pp puppet lint fixes" into production

6375a023c4-+-retab certs.pp

946c3572e3-+-identd:lint

1fe7349f5e-+-librenms: make main class' "config" option simpler

6e5b05ade6-+-librenms: another syslog blacklist entry

19c72884e7-+-librensm: adjust syslog blacklist

bf05367edc-+-assign db1023 to s6

784458119b-+-Merge "install rapidssl_ca_2.pem" into production

87f1dc1e3c-+-install rapidssl_ca_2.pem

10da886fd8-+-Merge "fixes star.wikimedia.org intermidite certificate chain" into production

e1150c1638-+-fixes star.wikimedia.org intermidite certificate chain

2ea1f1c8f9-+-librenms: add librenms::syslog class

03fa16018b-+-Merge "star.wikimedia.org cert chain fix" into production

63be243f4d-+-star.wikimedia.org cert chain fix

62294bd939-+-contint: disable tmpfs on labs slave

932d133d4a-+-webserver::apache::site: fix syntax error

f7ffa2c2d8-+-librenms: install SSL certificate & enable vhost

9bf5134a32-+-librenms: discovery fixes

d996975e63-+-Add IPv6 address to netmon1001

084e0a6139-+-librenms: another round of misc fixes

b6be72bfb7-+-webserver::apache: misc adjustments

90f029a181-+-add nuria to privatedata admins

a3fef109fe-+-librenms: more syntax fixups

60c7a8eb67-+-Update core routers list

b4f53b9f75-+-Using hcatalog-core for hive partitioning

14edbf9519-+-Updating cdh4 module and installing hcatalog on hive clients

532e714ae1-+-librenms: fix another scoping/dependency cycle

976b263cdb-+-webserver: remove broken docroot logic

583e7b64d2-+-librenms: fix role class include scoping

80f309f5ad-+-Add librenms module and role class & apply it

db000ca8c8-+-webserver::apache: misc SSL fixes

5a7f4d65e5-+-Merge "shell and deployment rights for Kartik Mistry" into production

6b3e51b64b-+-shell and deployment rights for Kartik Mistry

cc2d56e729-+-applicationserver: pass puppetlint / retab

5fbf0f9b6a-+-Merge "Removed the unneeded now wikidiff2.ini override" into production

6ba2681501-+-Assign db1060 to S2 (future master)

4146f0e15c-+-Assign db1055 to S1

a30216d1cb-+-remove star cert from aluminium

aca1f55980-+-Removed the unneeded now wikidiff2.ini override

99d11112dc-+-noc: remove ishmael & cleanup

53ab8fa610-+-deployment: switch carbon host to tungsten

acb4dee323-+-deployment: s/mw_statsd/mw_carbon/

93748ae3ee-+-varnish: adds gallium to misc-varnish

fe2ec8ec12-+-Merge "beta: remove old parsoid updater" into production

0acabab255-+-zuul: update git-daemon URL

bd097dec29-+-zuul: switch to nrpe::monitor_service

e717f11ba0-+-zuul: monitor gearman service

7fa8bb12fa-+-zuul: define push_change_refs as false

06b4f22494-+-zuul.pp retab + some puppet-lint fix

8d8680900f-+-Expose max_user_connections var in mysql_multi instance .cnf

268671336a-+-Purge etherpad package

0b2fd9367d-+-Merge "Ensure that logstash is running" into production

c9539ff4e9-+-Ensure that logstash is running

361d407567-+-Merge "replace wildcard cert for contacts.wikimedia.org" into production

06a58ecd33-+-replace wildcard cert for contacts.wikimedia.org

78390f6a8c-+-Merge "Fix file permissions and command args for logstash" into production

114763ca16-+-Fix file permissions and command args for logstash

27bc94449e-+-Merge "etherpad to use own cert, not wildcard" into production

ba4e010e6d-+-etherpad to use own cert, not wildcard

d5bc6ff35a-+-giving the CORRECT secondary ip to aluminium - rt 6601

f912d7afc0-+-giving secondary ip to aluminum

d377c51bfe-+-Replace * cert with rt.wikimedia.org cert

8ddbd07609-+-Replace * cert with rt.wikimedia.org cert

65949805bf-+-replace wildcard cert with standard cert for racktables

f79633124f-+-Reverting addition of camus github mirror

002ad64231-+-Setting up replication of analytics/camus to github wikimedia/camus

e8e2c27f1c-+-EventLogging: send esams data directly to vanadium using private iface

3ce4d8d31b-+-Add user-agent header to the format spec of EventLogging's varnishncsa instance

bf1428a6b8-+-Merge "dynamicproxy: Enable XFF based on a parameter" into production

1b1e2ede88-+-add user Sherah Smith (ssmith) and include in fr-tech group

6c1b6ec0c6-+-Tool Labs: install fonts for vCat tool

91dff9d0a8-+-Tools: Install requested package python-pyexiv2

ef4fab93d2-+-Tools: Add requested package libjpeg-turbo-progs

e374ddffc2-+-Tool Labs: package libfcgi-dev

55675273b8-+-Tools: Install ksh

41cbcf16a1-+-Fix regex error, ship smokeping.fcgi file

64b2a445f2-+-Fix web interface configuration, add pathnames file

3601ddf4eb-+-Install smokeping (including web frontend) on netmon1001

40457e47b2-+-Move smokeping to a module

40d6448927-+-Add web service for smokeping

99c4d6f427-+-Separate out the config section into misc::smokeping::config

0b30a9cf5b-+-beta: remove old parsoid updater

7933d9eeab-+-stages.pp puppet lint fixes

78a4f3b356-+-contint: package curl on slaves

965b90dfb8-+-Clean up leftover misc::graphite junk

3842c616ba-+-Merge "Move misc::graphite::navtiming into webperf role" into production

b7613aa83b-+-Move misc::graphite::navtiming into webperf role

961cc47c51-+-Fix puppet file source declarations for logstash

cb436974b2-+-Remove unnecessary reference to logstash class

763754e59c-+-Fix circular dependency in Logstash::Conf

677b00ff7d-+-logstash: Comment out openjdk-7-jdk package resource

c3537376ed-+-logstash: re-order ::redis::ganglia include to avoid resource conflict

e4e0ed0ae4-+-Logstash puppet class

2f6391f3c8-+-replacing star cert with noc.wikimedia.org on fenari

cce9cbaba9-+-zuul: support for zuul.zuul_url

6e2a95010e-+-zuul: let us change branch of zuul-config repo

19879abadc-+-Replace wildcard with icinga.wikimedia.org certificate

dbac0e37a4-+-ganglia to use fqdn cert - replace wildcard

a140bd82ab-+-ganglia to use fqdn cert - replace wildcard

7673d2e9bf-+-Removing typo from configuration.pp

81d7790697-+-Adding neon in the list of gmetad hosts

70d128f792-+-dynamicproxy: Enable XFF based on a parameter

c59c02aeeb-+-Merge "install graphviz on bugzilla role" into production

47a397e3aa-+-gdash: tweak letter case of site header

3eef03bf78-+-graphite: enable carbon over UDP

cd038c7579-+-Merge "add root@backup4001's ssh key to fundraising backupmover auth keys" into production

8b46a0c967-+-add root@backup4001's ssh key to fundraising backupmover auth keys

e5a3cca7dc-+-gdash: fix owner/group/mode for templates

a2a6c779b3-+-Fix RANCID directory modes

e261793401-+-Add RANCID .cloginrc file

d480d84a7d-+-Fix rancid file modes

547cd0e80f-+-Add RANCID cron job

f86263f86d-+-Add /etc/rancid/rancid.conf to config management

abcac506d2-+-Add systemuser creation

5019c67c60-+-Setup RANCID on netmon1001

1cf4d9f718-+-Fix indentation

f154fdbd4f-+-Revoke sumanah keys after her request.

4a4e830cb3-+-Fix misplaced closing brace for manage-exports

7c3ea45cdb-+-Specify the command to remove for manage-exports

c072b4f863-+-Added a separate scap-rebuild-cdbs phase to scap

0202cafa93-+-Add a global that turns off the ssh banner for a bastion.

aa015d7f2e-+-Merge "Remove old ulsfo LVS service IPs" into production

fccac13b63-+-Remove old ulsfo LVS service IPs

36c644c851-+-Merge "Swap old and new LVS service IPs for ulsfo" into production

0706d83b0f-+-Swap old and new LVS service IPs for ulsfo

eddec2c5d7-+-Recommission virt1001, 1002, 1003

7962e9bf42-+-beta: parsoid: typo in file definition

e999785b0e-+-beta: finish parsoid switching to jenkins job

6621d4cf78-+-Merge "beta: parsoid localsettings.js" into production

59e4cadf60-+-Merge "Swap old and new mobile-lb.eqiad LVS service IPs (IPv6)" into production

7dccab1777-+-Swap old and new mobile-lb.eqiad LVS service IPs (IPv6)

0749fc0b08-+-Merge "Add new mobile LVS service IPs to protoproxies (Zero scheme)" into production

0bc1844c31-+-Add new mobile LVS service IPs to protoproxies (Zero scheme)

7e639fca5f-+-Merge "Remove site pmtpa from the protoproxy configuration" into production

b6bac122c1-+-Remove site pmtpa from the protoproxy configuration

32b69adb9e-+-Merge "Add new mobile-lb LVS service IPs (Zero scheme)" into production

dafc0be95e-+-Add new mobile-lb LVS service IPs (Zero scheme)

1922140ba0-+-Merge "Swap old and new bits-lb.eqiad IPv6 LVS service IPs" into production

f8fefd6651-+-Swap old and new bits-lb.eqiad IPv6 LVS service IPs

2fc5069be6-+-Merge "Swap new and old bits-lb LVS service IPs for esams" into production

acbd6a03ad-+-Swap new and old bits-lb LVS service IPs for esams

fb467c2c97-+-beta: parsoid localsettings.js

a94498936d-+-Merge "beta: parsoid switch to jenkins deployed parsoid" into production

03239e866f-+-beta: parsoid switch to jenkins deployed parsoid

658650293a-+-Install python{,3}-dev packages on stat1

54bed3de4a-+-beta: allow ssh from gallium on parsoid instance

ccc6c80de9-+-Migrate ircecho module's nrpe checks to nrpe module

d93083dc11-+-Merge "Add integration/kss to deployment repo config" into production

b804867bb9-+-ircecho: move to a module

e3b6961ee3-+-Merge "beta: sudo policy for refreshCdbJsonFiles" into production

f567cce013-+-Removing unused misc/analytics.pp file

ec82c7cf16-+-Adding icinga checks for Kafka Broker MessagesIn and Varnishkafka drerr

d3d6621bae-+-Including mobile cache ganglia aggregators on neon's gmetad.conf

af0a42476c-+-Factoring out ganglia collector config from ganglia::collector

dccf25e3fe-+-beta: sudo policy for refreshCdbJsonFiles

5d1f427fd9-+-Re-including ganglios on neon for icinga ganlios checks

0040924b89-+-Making varnishkafka ganglia view into a define to pass topic_regex

df881e08c2-+-Removing email from Dan's key

ce65f624eb-+-Changing Dan's production ssh key

17d13a32b5-+-Changing Nuria's ssh key per her request

4b31245f8d-+-Removing parens in nrpe descriptions

032552f132-+-Fix typo with ensure parameter

6b25837da6-+-Resolve a bug with apache_site name parameter miss

e2a85179dc-+-Give etherpad-old a coup de grace

e42c95f929-+-Merge "interface: lint clean" into production

a851296113-+-labs_vmbuilder: lint clean

e0d08ed7b5-+-interface: lint clean

d86783497b-+-Tools: Install requested packages

64c5e1faea-+-ipython: lint clean

14fcce4b62-+-labs_vagrant:lint clean

752b316640-+-Tools: Remove obsolete tyrant class/role

c2962b306d-+-Revert "Hack: cron job to clean up tifs from /tmp on app servers"

e551edc767-+-Removed scap-1skins for performance

8509513c2e-+-Move lighttpd_config into mail.pp and rename.

3bd2957468-+-adding python-stompy for awight

0a9256c808-+-Fixing hadoop stacked graphs.

f94947122e-+-Including hadoop view

d983d61b55-+-Adding Hadoop Ganglia view

4f5a884c25-+-Removing disabled views

5ed4d3f071-+-Merge "Add Katie Filbert (Aude) to mortals." into production

6bb785ed38-+-Add Katie Filbert (Aude) to mortals.

3666904291-+-Now using jmxtrans instead of built in ganglia support for Hadoop

3874e31c49-+-scap: place mergeCdbFileUpdates & refreshCdbJsonFiles in scriptpath

b06d18bd45-+-install graphviz on bugzilla role

3ffdb18225-+-use db user bugs_test for testing

c9f5ae0a33-+-include missing passwords::bugzilla

6f5ee7bd92-+-Turning on Snappy compression in Hadoop by default

bb705227d8-+-Adding nrpe process checks for Kafka and Hadoop services

a75605c8ae-+-Not using tee when writing to log file in cron job

c507540d96-+-Add nuria to sudoers on vanadium

6402e01302-+-Adding Nuria so to admins::restricted

d7b1f581e1-+-Updating puppet entries to reflect server name changes (analytics to virts)

b10de2b91f-+-Including groups::wikidev on vanadium

e1cac37a24-+-varnish: adjust first_byte_timeout for mobile too

f21e7ac9c9-+-install-server: further cleanups to apt-repository

7e1be58081-+-Giving Nuria access to vanadium

1bf16c4566-+-Removing sudo_user otto from vanadium

96c844ab81-+-comment out OCG icinga check for now

66b5dc29a6-+-assign db1033 to s1

e6abbc3a06-+-Add integration/kss to deployment repo config

4714c72de0-+-Provide emptyish manifests for virt100[1-9] and labnet1001.

032665caa4-+-Tool Labs: package installs

ad30011826-+-Removing puppet entries for db31|3|4|6|7 db47|9 db50|4|7

f7dfbc9fcc-+-Adding some renamed analytics boxes to decommissioning.pp

1df94abd68-+-Debug https://gerrit.wikimedia.org/r/96403

ad77f18987-+-role and module structure for ishmael

322a5bcb64-+-Updated ZERO URL to get just the carrier IPs

5dd5a92602-+-Now logging frontend varnish logs through varnishkafka

b73369421a-+-Tool Labs: fix he locale

368d24353e-+-Tool Labs: package installation round

7d78adf048-+-Memcached: Convert into a module

67983577c3-+-Memcached: tabs to spaces

5303fa0004-+-Memcached: split off ganglia monitoring into a sub class

61ea4de69c-+-Memcached: reformat

dd249b6d9e-+-Fix ulsfo LVS monitoring duplicate definition

319f9e9bf1-+-Fix lvs::monitor_service_custom name

4093ba0e63-+-Add empty LVS service IP hashes for pmtpa

ef3328935b-+-role/cache: tabs to spaces

33a3594bf9-+-LVS: Convert to a module

ee4b0aec1b-+-LVS: tabs to spaces

baaabb278d-+-LVS: Pass parameter $pybal_global_options as well

ef809232f5-+-LVS: Really add parameter $lvs_class_hosts

aa7d2163cd-+-LVS: Add missing parameter $lvs_class_hosts

f6b608c4ec-+-Fix lvs::monitor_service_custom name

49608008b6-+-LVS: remove lvs::balancer dependencies on lvs::configuration

44dd1523f8-+-LVS: rename monitor_service definitions

b6c201a2ee-+-LVS: remove lvs::static_labs_ips

2f4ab89b67-+-Remove duplicate definition of add_ip6_mapped

0a4d7c587a-+-Attempt to fix new class resource conflict

31c46eaa68-+-Fix name conflict

e453bd54a1-+-Fix parameter name

5f480b0e0e-+-Attempt to fix undefined param in dns::recursor

6105317394-+-Use root level lvs::balancer

4cbb581aa5-+-Introduce LVS role class

a21ea8c21b-+-Tools: Fix quoting error

4669a1c9e7-+-add second ssh key for Yuvi

0c057efd0a-+-Tools: Add key for MariaDB repository

6f0c7f91ca-+-Merge "install various Perl modules needed by Bugzilla" into production

04f0e1fdd2-+-Updating hive-partitioner cron job to use hive-serdes

3806031777-+-Merge "Launch Wikimania Scholarships app" into production

eb1d7cf867-+-Launch Wikimania Scholarships app

18d761087f-+-install various Perl modules needed by Bugzilla

a2f3e69204-+-Merge "nrpe: two space to 4 space" into production

b59522fe4d-+-Changing topic to webrequest_mobile, now subscribing to config file

61c9a2965d-+-create stat1 shell account for Nuria Ruiz

e539138a7e-+-Making drerr regex more precise in ganglia varnishkafka view

f46ba47e3d-+-toollabs: lint cleanup

81c838c922-+-Merge "Remove unused 'specials' LVS class" into production

77bcbc06d6-+-Remove unused 'specials' LVS class

3d8367da72-+-Merge "Remove now redundant LVS service 'ipv6'" into production

afd2d7bc5d-+-Setting up nrpe alert for varnishkafka process

85975e391a-+-Merge "Move eqiad text IPv6 addresses to text, update LVS monitoring" into production

f8fa73f089-+-role/gerrit.pp: Mirror VisualEditor to github as wikimedia/VisualEditor

0b9cc37d02-+-role/gerrit.pp: Clean up extra line breaks

d7de698a3a-+-Log X-Analytics header of response instead of request

67a703e562-+-mediawiki_singlenode : lint cleanup

4991f4186d-+-Remove now redundant LVS service 'ipv6'

26f0746e79-+-Move eqiad text IPv6 addresses to text, update LVS monitoring

93b096b44b-+-Merge "Add new bits IPs to the https section" into production

d42e1986cb-+-Add new bits IPs to the https section

7494119e02-+-Merge "Add new bits-lb IPs (new Zero scheme)" into production

f0a166e729-+-Add new bits-lb IPs (new Zero scheme)

70540d92f6-+-beta: fix up parsoid restarter

3e5e6d569d-+-Remove old Ganglia groups

61887eb93d-+-Update Icinga cache groups

86b854304e-+-Merge "Rename role::cache::varnish::text/upload to role::cache::text/upload" into production

fc967e6b66-+-Rename role::cache::varnish::text/upload to role::cache::text/upload

094b7a8d3f-+-beta: properly connect to parsoid instance

6390c401d4-+-parsoid: upstart provider does not support 'enable'

92642dba0a-+-move brion from roots to mortals, rt #4798

635e7b7906-+-beta: manage parsoid using upstart

cd76b26683-+-Re-disable Scholarship app until scheduled deployment

120a574f94-+-Configure twig cache directory for Scholarships

747bf32b3e-+-Merge "temp disable bugzilla auditlog/metrics mails" into production

b80fbb9193-+-temp disable bugzilla auditlog/metrics mails

b6ca6f0530-+-Fix duplicate definition for openstack in labs

8ae75017bb-+-Update NavigationTiming metric processor for I933a1e3a2

f03246a766-+-create shell account for msyed

87b2d0c26d-+-Setting log_statistics_interval to 15 for varnishkafka

276024fd25-+-Only install mysql on openstack database node

269f0562f2-+-Merge "Update Scholarships configuration for deploy" into production

243935e33c-+-Deploying varnishkafka to remaining mobile varnishes.

168e8f6ae8-+-Merge "Add 1 more default job runner process per server" into production

67c7dd717c-+-rtt.avg is not per_second

10687a1c41-+-Update Scholarships configuration for deploy

f7fa8afe0e-+-Updating varnishkafka ganglia view with per_second metrics

d3c68088fe-+-Add 1 more default job runner process per server

569c245e2e-+-pmtpa squids to decommissioning.pp, decommed rt #6520

ee3fcd1752-+-Rename LVS service 'text-varnish' to 'text'

1cbe406aad-+-Remove reference to LVS 'text' IPs

a617d1caf9-+-Remove LVS service 'text' (Squid)

ad33a7f331-+-Remove ssl1-4 node entries

e1e722942b-+-Decommission bits.pmtpa servers

a3b1e138ae-+-Merge "contint: install libsikuli-script-java for browser tests" into production

4da97e3960-+-Temporarily restore the old wikimedia-lb IP (for donate)

728d5b718f-+-contint: install libsikuli-script-java for browser tests

44a90d2c84-+-Remove bits-lb.pmtpa LVS service monitoring

c2120970af-+-Remove pmtpa as bits backend for esams/ulsfo

5574f07496-+-Remove pmtpa text LVS service IPs

e3b663c92f-+-Remove Squid manifests and files

1446205eab-+-Remove -squid host lists

2794dea740-+-Remove role::cache::squid

bbbc5f005f-+-Move all existing Squids to the decommission lists

c4bc7dd118-+-Merge "Use eqiad ($mw_primary) as secondary upstream instead of pmtpa" into production

6bf1539046-+-Use eqiad ($mw_primary) as secondary upstream instead of pmtpa

def452a8fe-+-Merge "Remove esams videos.wikimedia.org" into production

d680b2a462-+-Remove esams videos.wikimedia.org

96763dd6cb-+-Merge "Remove old esams service IPs from protoproxies" into production

7cc274b4b2-+-Merge "Remove esams ipv6 LVS service IPs" into production

82c879c385-+-Remove old esams service IPs from protoproxies

5df3ca12af-+-Remove esams ipv6 LVS service IPs

3145879add-+-Merge "Remove old eqiad/esams LVS service IPs" into production

6c0c39fa79-+-Remove old eqiad/esams LVS service IPs

73d81cad1f-+-Merge "Remove old esams text LVS service IPs for https" into production

aac4dd5f11-+-Remove old esams text LVS service IPs for https

653d2950e3-+-Merge "Remove old esams text LVS service IPs" into production

6a7a3316f8-+-Remove old esams text LVS service IPs

6f46d019bb-+-Merge "Move esams text IPv6 termination to Varnish directly" into production

7c6b8d01d0-+-Move esams text IPv6 termination to Varnish directly

62336d569a-+-Remove all node definitions for Squids

aa72232f70-+-update coredb topology after pmtpa changes

5639898f4a-+-mwprof module: update package deps & Upstart job def

2dc0bda6dc-+-Merge "Update elasticsearch settings" into production

6bda389bf7-+-Merge "fix another deprecation notice from jenkins" into production

9020187e53-+-fix another deprecation notice from jenkins

85c6f1951a-+-capitalize resource reference

8bf1e37eec-+-Update elasticsearch settings

6eac305b82-+-Allow salt/puppet access from pmtpa and eqiad labs

1f45d32de0-+-Merge "Add secondary salt master into labs minion config" into production

7faa6d449b-+-Add secondary salt master into labs minion config

894d495dec-+-Make virt1000 a secondary salt master for labs

382a26d73e-+-Merge "Up vmbuilder version to 3" into production

eaf886b224-+-Up vmbuilder version to 3

9fe8de27ed-+-Merge "Add firstboot script and ubuntu-standard package" into production

647b071e0d-+-Ganglia aggregators for upload caches eqiad are cp1048, cp1061.

cec6e46074-+-Add firstboot script and ubuntu-standard package

a5c05a4f53-+-Installing mysql client on stat* machines.

2415336a09-+-Temporarily use the old service IP name

5cc2a8bc37-+-Remove LVS monitoring for now unused esams project LB LVS services

831cf75ad3-+-Merge "Remove pmtpa Squid LVS monitoring" into production

580062490b-+-Remove pmtpa Squid LVS monitoring

a8cc7da2c4-+-keep one pmtpa es[123] host each on 12th floor

672191d22e-+-add missing analytics row a network info

843f16bb02-+-pull pmtpa db boxes from m1, m2, x1, es1, es2, es3 for decom and/or shipping

3b4b29abbd-+-decom all pmtpa s[1-7] db nodes except the temporary masters

19185d5359-+-Merge "Also open ganglia TCP ports" into production

6426af0d48-+-comment out dysprosium in decomm list so configs cleanup won't

3930fbe52c-+-Also open ganglia TCP ports

aa76364061-+-Temporarily punch holes for hooft and bast4001

e340273c19-+-role::parsoid::beta must allow port 8000

0355f36216-+-beta: ferm on appservers must allow port 80

07f5f99450-+-beta: public IP rewriting using DNAT

be82dc658a-+-dhcp is called bootps in /etc/services

c0bdeaea5a-+-Merge "tftp is udp not tcp" into production

f6c838022d-+-tftp is udp not tcp

ea83ec3039-+-fix typo in one of the bastion host ips for labs

3a42d351c5-+-Fix ferm rules for install-server, haproxy, backup

0f03d0e66c-+-Adding install-server::ubuntu-mirror class

929affbd7a-+-Migrate to new install-server module

991e52c153-+-access to pdf1,2,3 for mwalker, rt #6468

ccd4dd4c52-+-Modularize misc::install-server classes

5dacc9f342-+-Merge "Add nodejs to stat1" into production

9ea787fe58-+-Add nodejs to stat1

e21f597af7-+-Update role::statsd's graphiteHost to tungsten

717c0d7cc2-+-Merge "add package libdatetime-perl for bugzilla" into production

c86f811a35-+-Correct link target of /etc/apache2/sites-available/gdash

d465ee1392-+-Correct uWSGI parameters for Gdash & add authnz_ldap for Graphite

bea4f1a721-+-add package libdatetime-perl for bugzilla

c782ef2625-+-Merge "include the bugzilla config in puppet" into production

f0cc3a724e-+-include the bugzilla config in puppet

fcd1813dbb-+-Configure Gdash and Graphite to use mod_uwsgi

33c0734f5f-+-Add apache::mod::uwsgi

f00d3ac223-+-Not subscribing varnishkafka to its config files

71dd696b5a-+-beta: dont restart apache on fake mwsync

6b8312d37f-+-imagescaler: replace virtual font package with real package

81b2e3619f-+-Correct file reference in Ib87eb5db

48244c54d8-+-Correct typo in template path reference introduced in Ib87eb5dbc

df8419cde0-+-Serve gdash.wikimedia.org via Apache

7e81b967be-+-Decouple Nginx from Gdash module; serve via Apache instead

733d00f1d5-+-Use Apache to serve Graphite

2d4d886274-+-Merge "Decouple Nginx configs from graphite::web & relegate to subclass" into production

f7878629f1-+-assign db1017 to s5 for analytics

1d6a0a1cd4-+-stat1002 access for ironholds, rt #6452

be73d4c2a3-+-Decouple Nginx configs from graphite::web & relegate to subclass

2daf84a63b-+-Merge "Add gage as a root" into production

81e15a116c-+-Add gage as a root

cf2b1e71d6-+-Merge "Backup geowiki's data-private bare repository" into production

ffbf371950-+-Merge "Added subbu to 'mortals' so that he can actually deploy." into production

03362d810b-+-Merge "Add totalPageLoadTime (navStart to loadEventEnd) to Ganglia" into production

8b2b27fc37-+-Add totalPageLoadTime (navStart to loadEventEnd) to Ganglia

dc0547af7d-+-Merge "Set storage size to default 300G for role::cache::text" into production

31120ec62e-+-Set storage size to default 300G for role::cache::text

456c13e763-+-Backup geowiki's data-private bare repository

e98fd7508a-+-Merge "beta: ensure /usr/local/apache* belong to mwdeploy" into production

da112b5a33-+-add analytics1010 (row b aggregator) to gmetad

a688ef516a-+-beta: ensure /usr/local/apache* belong to mwdeploy

d7b8460340-+-Merge "Template ferm's defs.production" into production

0698f34900-+-remove bd808 from restricted, already in mortals

9db42c68e1-+-access to zirconium for bd808, rt #6448

f30bff08c2-+-on puppetmasters, remove default ubuntu logrotate for apache

3bca259b82-+-logstash: re-order includes to avoid duplicate def'n

296ea28f0d-+-logstash: specify /var/run/redis as redis $dir

467fc1972a-+-Include redis on logstash servers

8a7afc43b7-+-Reconfigure and turn on geowiki monitoring again

7a5d70b0f5-+-analytics1010 is in Row B, need a Gangalia aggregator there

7204e4cac4-+-include ::bugzilla instead of bugzilla

4b50ea9f8d-+-Test service restarts in test/testrepo

4f6e59e351-+-Merge "Manual restart for parsoid" into production

345312be40-+-Merge "Add a deploy.restart runner and module call" into production

1b29a7fa3b-+-use include in role instead of class declaration

4439f3c02d-+-disable bayes_auto_learn on iodine (for otrs)

dd6ca4b5dd-+-Manual restart for parsoid

a4e06a9474-+-Add a deploy.restart runner and module call

3f20d50aa1-+-remove the system role from the bugzilla module

808eedd9b8-+-change bugzilla role classes

ec664d56c2-+-contint: djvulibre-bin for mw djvu unit tests

21324fc66b-+-Tool Labs: Add a couple requested packages

ebf04b4b90-+-Merge "icinga: raise timeout of check_job_queue nrpe command" into production

fab5ddb571-+-removing asher's access per his request

339688111e-+-parsoid: nodejs ensure s/latest/present/

5ad54c53dc-+-Also need to change gmetad config for analytics ganglia aggregators

27696a8554-+-Putting ganglia aggregators for Analytics cluster in different Rows

e2b9e32224-+-puppet error after recent lint

3a8f12297e-+-monitoring.pp - betterin varnishkafka view

d589904bcb-+-Fixing varnishkafka ganglia view name

b3a28ffe8b-+-Adding ganglia view for varnishkafka.

32d2dc64b9-+-Merge "mysql_multi_instance : lint cleanup" into production

44448fee93-+-Template ferm's defs.production

fe81d89d14-+-Only install mosh on bastion if precise or above

08a56dd0e5-+-mysql_multi_instance : lint cleanup

1e0abd7471-+-icinga: raise timeout of check_job_queue nrpe command

7e19a9f003-+-Merge "Add a content parameter to ferm::conf" into production

02c0a790ab-+-When reporting labs hostname, use $::instancename

879b43399c-+-Add proper nova auth to labsstatus.rb

d5338ba416-+-switch es1010 to mariadb

eb95709a92-+-switch es1007 to mariadb

e353226cc5-+-Labs: Record puppet run status in instance metadata

a0ab324fb2-+-nrpe: let us specify timeout of check_nrpe

4d39ac2e7f-+-Parametrize Graphite's DOCUMENTATION_URL option & set it to [[wikitech:Graphite]]

6489f92ab0-+-Graphite: add system role; tweak storage schemas to be thriftier

79d0d873d6-+-Graphite web: create admin user

cec3ddec35-+-Merge "graphite: notify uWSGI when local_settings.py changes" into production

0391860342-+-graphite: notify uWSGI when local_settings.py changes

fed0fb37db-+-Merge "add puppet doc compatible comments to bugzilla module" into production

c2dd214e06-+-add puppet doc compatible comments to bugzilla module

b1b321d449-+-remove sahar's account from aluminium, he's migrated to lutetium

5d2341b5ed-+-logstash nodes: assign $cluster before includes

f15c5b2449-+-Merge "fix parameter order in bugzilla logmail" into production

c50764ea48-+-Specify $cluster = 'logstash' on logstash hosts

877d114118-+-fix parameter order in bugzilla logmail

24f8591321-+-logstash: add Ganglia group and specify aggregators

5489cc1825-+-Add a content parameter to ferm::conf

737d521a35-+-Merge "bugzilla module" into production

f632b56396-+-Revert "Point the puppet freshness check to nagios.wmflabs.org"

0a3aeea904-+-varnish: automatically pull Zero proxies from meta

3bd073fcee-+-Revert "added groups::wikidev and accounts::bd808 to zirconium for scholarship app"

e1154d7ed1-+-switch es1001 to mariadb

7bc0da97d1-+-base: don't ensure => latest for rsyslog

622ae9ace9-+-Fix passwords::mysql::wikimania_scholarships include

e81de218f3-+-added groups::wikidev and accounts::bd808 to zirconium for scholarship app

9bbe0c8587-+-Add configuration for Wikimania Scholarships

b250098e26-+-Fixing kafka broker config in role/cache.pp, updating varnishkafka module

b59a2a3aa0-+-Merge "mysql_wmf : lint cleanup" into production

f7d4f1d4c7-+-Setting up varnishkafka on 3 mobile varnish hosts.

10e9bf35f8-+-bugzilla module

7f789606da-+-Merge "puppet: lint cleanup" into production

a127a31416-+-Merge "toollabs: remove old tips absent declarations." into production

1b12a71721-+-salt: lint cleanup

819c9b205d-+-remove cp3013 from mobile esams backend list

c110240df0-+-mysql_wmf : lint cleanup

56a0b013b1-+-nrpe: two space to 4 space

39f617f844-+-puppet: lint cleanup

ed40e6575a-+-s/onlyif/unless/ on interface::ip (doh)

8c410dc01e-+-Fixup for interface::ip

5f79af3efa-+-Silence interface::ip with an onlyif

b498637691-+-varnish: sort bits esams backends

8ce4ffd97b-+-graphite/carbon: Leave default aggregation pattern unspecified

dc005cb957-+-Carbon: allow storage aggregation rules to be specified as class parameters

4d982fccda-+-switch es1002 to mariadb

2d2924f089-+-toollabs: remove old tips absent declarations.

bc008b675d-+-Merge "Revert "Disable elasticsearch nagios/ganglia monitoring on logstash cluster"" into production

e3edf9f63f-+-Revert "Disable elasticsearch nagios/ganglia monitoring on logstash cluster"

df01601333-+-Rename role::elasticsearch -> role::elasticsearch::server

bcc1bc40ff-+-temporarily add cp3013 to esams mobile list

08a70e9776-+-Disable elasticsearch nagios/ganglia monitoring on logstash cluster

eed2cf5d76-+-switch es1003 to mariadb

617d5f81e5-+-Qualify elasticsearch class names in role::elasticsearch, too

c5f97e870f-+-Qualify elasticsearch includes in role::logstash

27175b8c3b-+-Added logstash role and applied it to logging logstash servers

5fbd638a86-+-Hosting public-datasets from /a partition

c1a4667580-+-Added subbu to 'mortals' so that he can actually deploy.

83eddbc76a-+-varnish: lint fixups

8f2af07dd6-+-varnish: whitespace & lint cleanups

db21a5e963-+-openstack-manager: add nrpe

fb522fcb73-+-protoproxy: fix pmtpa mobile stanza

a4e263183b-+-Point the puppet freshness check to nagios.wmflabs.org

2cdf339f0b-+-redis:  redis.py is absent everywhere

34b9afc73f-+-redis: lint clean

7e4179ba32-+-Merge "role.pp: minor lint clean" into production

fb0fcd2e87-+-Graphite: use package's default storage dir

976f4bffea-+-Add a sqldump script wrapper around mysqldump

bdb43306df-+-beta: parsoid init script needs root

98a567a94a-+-Merge "deployment: integration/slave-scripts has submodules" into production

c11b061d2c-+-Merge "beta: let jenkins-deploy restart Parsoid" into production

813a986dbc-+-deployment: integration/slave-scripts has submodules

f61c23d641-+-switch es1004 to mariadb

c361b7f656-+-Add accounts for bd808 and aaron on logstash nodes

800e7966ac-+-Add logstash100[1-3] to site.pp & add bd808 & aaron as sudo per RT 6366

5c199fcd54-+-Specify managehome => false for "/nonexistent" $HOMEs

cc4ccdfba8-+-RT: 6428 deploy logstash1001-1003

6dc5721092-+-beta: let jenkins-deploy restart Parsoid

72fa0f73a1-+-varnish: adjust first_byte_timeout to 180s (text)

33c0da1aed-+-Merge "Add mwprof module" into production

8c2689fa11-+-Tool Labs: install pyflakes in dev environ

06c4358e3f-+-Add mwprof module

77bd3296d7-+-Tool Labs: install pep8 in dev environ

63e1b4ca82-+-admins.pp: Update SSH pub key for user 'krinkle'

cc8215f76e-+-unbreak puppet run on pc[123]

17523c4c42-+-varnish: lint fixups

36c686c533-+-Merge "varnish: whitespace & lint cleanups" into production

a6ef38280e-+-Merge "tcpircbot: tabs to spaces" into production

f8ae070fb0-+-upgrade db1046

8946fee1fc-+-switch pc1003 to mariadb

fc2cf2cb08-+-switch pc1002 to mariadb

891787e461-+-Reduce mysqld footprints temporarily for investigation.

6008c87d5c-+-role.pp: minor lint clean

e98e28cd18-+-tcpircbot: tabs to spaces

8d50b8760c-+-varnish: whitespace & lint cleanups

af62f12b4b-+-Merge "parsoid: role class for beta and factor out common code" into production

535cccec95-+-pc1001 upgrade to mariadb

c38c6b82aa-+-Add mwprof build dependencies to mwprof role

c57af79f49-+-Add Salt deployment module for mwprof

cd6ff1b513-+-Remove user accounts from the labstore boxes.

12fa245bc6-+-Add mwprof to git-deploy; apply to tungsten as role::mwprof

44f79578aa-+-Change fflorin's uid.

8ab0218b92-+-parsoid: role class for beta and factor out common code

67d2398b96-+-mark stuff in decomm.pp with their rt tickets for easier tracking

00ec560682-+-decom gdash on professor

6cb87f4469-+-webperf :lint-clean

7e6f7c1c12-+-Merge "Serve gdash.wikimedia.org on misc varnish" into production

ff51cc39dc-+-Serve gdash.wikimedia.org on misc varnish

8bbd93ee00-+-Specify hasrestart => true for nginx and uwsgi services

e3d55d0322-+-Gdash module: remove professor-specific hacks; use canonical locations

3164bf1859-+-reqstats 5xx: shorten period to -1hours-now

597be10037-+-Merge "role::ocg: fix typo in config file name" into production

1718744d9a-+-Merge "tungsten: serve gdash on gdash.wm.o vhost" into production

ed4c355ff3-+-role::ocg: fix typo in config file name

1f0ddde79c-+-tungsten: serve gdash on gdash.wm.o vhost

f2d5d41257-+-Merge "Fix template file path in Gdash role" into production

f652cdb6d0-+-Add mysqld process icinga check.

0121b183b1-+-Fix template file path in Gdash role

e69b3fe8ea-+-Configure gdash to be served by nginx::site

878a2ae37f-+-dynamicproxy: Make 404 fallback servers configurable

e267e03b21-+-qualify $hostname and $ipaddress references

d4bd1a9308-+-netmapper perms/owner fixups

e368f1237e-+-More fixes for file permissions/ownerships

ee77d4d7db-+-Fix erroneous attribute

c6e3016359-+-Fixing ownerships, permissions in various places

3507339f34-+-Made netmapper updates more frequent

b4b438e7fd-+-Add admins::labs class to other labs boxes.

85bad7755c-+-dynamicproxy: Ensure that default site config is always enabled

a76462e1e8-+-dynamicproxy: Separate api configuration into own file

5fb4df3750-+-dynamicproxy: Add URL based router

10ae4fbd33-+-Merge "Specify hasrestart => true for nginx and uwsgi services" into production

6e12cc9a99-+-wikidata_singlenode : lint clean

a52f79fe80-+-I guess we need a group for mike to belong to...

fde32ddd45-+-Merge "Create an admin::labs class with one member:  mike." into production

92b4c040b7-+-dynamicproxy: Don't include API by default in class

d0cd00fea1-+-Merge "Give mike an actual account to use his sudo from." into production

783eb71e46-+-Merge "fix the SSL cert chain for *.planet.wm" into production

347ff78226-+-fix the SSL cert chain for *.planet.wm

cd8fc1776c-+-Replace some weird class syntax.

8d48b68233-+-expose archive to labs, suitably redacted

09c81b805d-+-Fix typo in parameter name (enable -> enabled)

2fd1069a67-+-rewrite nginx module

e9cf709dd1-+-Merge "Simplify our attempt to fix repo dir permissions." into production

dad39d6f9d-+-Simplify our attempt to fix repo dir permissions.

38afdfd46f-+-contint: adds tmpfs on browsertests slave

42c3c4542d-+-Initial Puppet Try for OCG::Collection Role

ebbea09099-+-contint: unzip/imagemagick duplicate definition

b7afffbb1b-+-contint: librsvg2-bin duplicate definition

6e75b3a919-+-Add packages needed for Collection OCG to contint::packages::labs

54c009f88a-+-Revert "Add mobile views to ganglia"

3183df9602-+-memcached: use nrpe when binding to localhost

88f0040fd6-+-Add firewall to holmium/blog

f023950774-+-Tool Labs: install doxygen{,-latex}

78cc5db791-+-Tool Labs: Install djvulibre support

e2c01b215f-+-role classes for download servers

e35ae5877c-+-Revert geowiki separate class & backup changes

0e8047ee3d-+-Add check_graphite & a reqstats 5xx check

17cf61276b-+-Qualify puppetmaster backends checks

a44b71d26d-+-qualify $decommissioned_servers

5acd376976-+-Change the way cron run times are calculated

71688757e7-+-Cleanup puppetmaster's apache Listen ports

3cfdcfbf28-+-Capitalize resources, fix deprecation notice

ced0bfc266-+-qualify $hostname and $ipaddress references

f87c83dad6-+-Merge "Backup geowiki's data-private bare repository" into production

2c815c9202-+-Merge "Extract geowiki paramaters into separate class" into production

b19e891d04-+-log scap timing to graphite; parametrize statsd host/port

c31d9f3cf7-+-Merge "Add icinga monitoring for Gerrit and Gitblit" into production

962d78e6ce-+-graphite::web: Correct parameter name

8d135804aa-+-graphite::web: parametrize site_name; declare in role class

30ca6f1f65-+-remove bellin/blondel references, they don't exist

b5a4247464-+-qualify vars planet_domain_name, planet_languages

992a2652a6-+-Merge "retab, quoting, linting of ishmael.pp" into production

4131d665ba-+-Merge "etherpad - tabbing, quoting & aligning" into production

7082973068-+-Hack: cron job to clean up tifs from /tmp on app servers

4c8e30703e-+-Add icinga monitoring for Gerrit and Gitblit

18aac01f9f-+-add role::ocg::test to rhodium

77548e3c78-+-Give mhoover root on a bunch of labs hosts

2f199eed77-+-Merge "Adding Mike Hoover" into production

7b53acdc91-+-Merge "add standard to ocg base server" into production

d48ee2c9c6-+-Adding Mike Hoover

ca12b6524c-+-add standard to ocg base server

276f8f84d9-+-Merge "add deploy redis module to ocg test server" into production

8e48f516f1-+-add deploy redis module to ocg test server

509b24a528-+-decom'ing sq44 and 48 -removed from dsh, dhcpd, role.pp and added to decom.pp

74ba8c2e3d-+-Run the check_job_queue check only on terbium

8e78d1daeb-+-Add firewall rules for SVN

8045aa56ca-+-etherpad - tabbing, quoting & aligning

6781f175e5-+-Renaming role::haproxy to role::puppetproxy

5a731d4a71-+-Tool Labs: fix pysvn installation

9383991cba-+-Merge "Tool Labs: Multiple dependencies installed" into production

ceb3496194-+-Backup geowiki's data-private bare repository

0ec1823e5f-+-Extract geowiki paramaters into separate class

e5b7899e2c-+-Merge "haproxy: get rid of misc, add a role and template" into production

cc8acb61f1-+-haproxy: get rid of misc, add a role and template

e5c47dc574-+-Tool Labs: Multiple dependencies installed

a89f7d5a6c-+-Tool Labs: install libhtml-template-perl

92341c3120-+-Add Gdash role class; apply to tungsten

770bc64538-+-Make the monthly querypages updates not hit each cluster on the same day

19f69633fe-+-pull cp3013, 3014 from mobile cache list

0d9590a912-+-Merge "If /a/common is a symlink, don't replace it with an empty directory" into production

2212562365-+-add roots to rhodium

56ebbde53a-+-If /a/common is a symlink, don't replace it with an empty directory

addda74685-+-Include role::applicationserver in role::applicationserver::configuration::php

4926a80ad3-+-Include role::applicationserver in role::applicationserver::webserver

35ab9c914c-+-Merge "Make rsyslog forward Apache error log to fluorine" into production

d87e44e68e-+-Make rsyslog forward Apache error log to fluorine

3d3311a173-+-add a role::ocg::test class for testing config

230bab6dc5-+-add groups::wikidev to rhodium

3dfe776bab-+-Merge "add $gid=500 to rhodium (again)" into production

2a8e387903-+-add $gid=500 to rhodium (again)

97d338ec75-+-Setting up JournalNode on analytics1014

078d7ad0c8-+-add host rhodium for ocg pipeline testing

b7cc417ef3-+-Setting $ganglia_aggregator to true for elastic100[17]

b10c99d6b1-+-Adding ganglia aggregators for elasticsearch cluster

0210ed6cef-+-Merge "Allow ytterbium access to CI and gitblit" into production

6012ac12b0-+-Adding net-topology.py.erb to make hadoop topology aware.

e3aaad272e-+-Allow ytterbium access to CI and gitblit

79037e4edd-+-Remove redundant DROP rules.

4b3fa219cb-+-Amend "Punch hole for icinga servers to monitor all"

220e220443-+-Revert "nrpe: iptables accept neon public IP address"

f205de5c82-+-Punch hole for icinga servers to monitor all

7235ea7c7f-+-Change default ferm policy to DROP

1ae5bd6a03-+-role::ci::slave::labs

971c438eb0-+-Tool Labs: install links and lynx to dev_environ

660188c311-+-beta: symlink /a/common

5796e98075-+-Tool Labs: install ufraw-batch

f5e75d1f06-+-Tool Labs: install rrdtool

5f3d96957c-+-Tool Labs: install socat to exec environment

00a79f5167-+-remove last entries for ms7, going away at last

ad940b15b5-+-zuul: configuration for gearman

7da5ace461-+-retab, quoting, linting of ishmael.pp

2494125786-+-Install curl when installing Elasticsearch

9293b2e8a2-+-Merge "retab misc/pdf and role/pdf" into production

dc5bffb8a2-+-retab misc/pdf and role/pdf

806d562f5b-+-Merge "Indent & format role/parsoid.pp" into production

8797db6594-+-Indent & format role/parsoid.pp

a26149ba62-+-Merge "rename misc::parsoid to role::parsoid::production" into production

51fe491d60-+-rename misc::parsoid to role::parsoid::production

ffb390f1b8-+-nrpe: iptables accept neon public IP address

da63c6830b-+-add ferm rule to only allow nrpe/5666 from intern

6001cb94ab-+-Merge "deployment: integration/jenkins for Jenkins CI slaves" into production

e05e364c16-+-misc::contint merged in role::ci::master

f5b2ad0eb1-+-set multiple salt masters for minions

ed26f57db5-+-ferm rule for bacula connections from internal

93098d3bc2-+-Remove puppetmaster from sockpuppet/stafford

4aba9d0c5a-+-Merge "retab role/gitblit to spaces" into production

30a850c4eb-+-remove dysprosium from decom temporarily (to be reclaimed)

46781700f1-+-retab role/gitblit to spaces

dc4b24b44e-+-varnish: bump parsoid's max_connections to 1000

95903ed331-+-move IRC server to module

2a2f6bc639-+-Merge "sigh. finished fixing tabs-->spaces" into production

edc148235a-+-Merge "removing access from dsc" into production

e004543966-+-sigh. finished fixing tabs-->spaces

5a201265a2-+-!tabs! fixed tabs to spaces

4f12c7eb28-+-removing access from dsc

b97018c780-+-resurrecting ocg role

173c24eaf2-+-remove deprecated fundraising config

f3a531eb7d-+-add list of fundraising hosts to site.pp for reference

d4be515a6a-+-Merge "Removed misc::deployment::scripts class." into production

342b45ebf6-+-deployment: integration/jenkins for Jenkins CI slaves

4422989a33-+-ganglia_new perms/owner fixes

e45183fbbc-+-role/swift: fix a typo

6d5d813f53-+-Overzealous mode change in 31c9a130

7ce8b6d2cf-+-ganglia::plugin::python owner/perms fixups

089e2afe43-+-misc::udp2log owner/perms fixups

3c62be38a4-+-misc::monitoring::net::udp owner/perms fixups

b7af76c8fb-+-l10nupdate logrotate configuration owner fix

dafd0e280a-+-wikidata logrotate configuration owner fix

b17e0155a1-+-mysql_wmf::pc::conf perms/owner fixups

3badb33334-+-role::logging::mediawiki owner/perms fixups

1a64858997-+-netmapper perms/owner fixups

ad7af55294-+-fix perms/owner for memcached ganglia plugins

b995ee4ef7-+-Fix role::swift::ganglia_reporter perms/owner

dcb1d1a3c5-+-Fix owner/perms for misc/logging.pp

31c9a1302c-+-Fix applicationserver ganglia plugins perms

d7dc74f3a5-+-remove gurvin from dhcp, dsh and site.pp

0dfab5b8df-+-Fix Solr OOM on labs

9319c6d0ae-+-Create an admin::labs class with one member:  mike.

b87dccc619-+-Give mike an actual account to use his sudo from.

8d961a9e3e-+-add role::ocg::collection to rhodium for enhanced testing power

f9e1770c03-+-fix repo reference for ocg stuff

8c4bbd6f92-+-Remove explicit creation of /var/lib/git/operations/puppet

0f74fa3013-+-Remove explicit creation of /var/lib/git/operations/software

cde8f4bf8b-+-Added a 'no longer puppetmaster' motd on sockpuppet and stafford

22d6dc1217-+-Puppet configuration for new elasticsearch servers

2144aca85f-+-Merge "Fixing git::clone so that it respects permissions on directory" into production

da4b131ed4-+-Fixing git::clone so that it respects permissions on directory

f1b43f92e1-+-Merge "remove civicrm dev sites from aluminium" into production

34a5234920-+-remove civicrm dev sites from aluminium

87401eb41b-+-Enforce clone ownership for geowiki clones

1093d38591-+-Merge "contint: migrate firewall rules to ferm" into production

1dff6c6125-+-contint: migrate firewall rules to ferm

ad0279315e-+-salt for streber just like every other host

e2b2c30492-+-remove barium from everywhere and grosley mostly

f0896a3039-+-Revert "run puppet once an hour instead of every half hour"

a6451a7f9c-+-Fix owner/perms ganglia_new::monitor::aggregator

fc36723672-+-Swap production puppetmasters to use db1001

96640ed7b8-+-fix alignments in maintenance.pp and tabs->spaces

4508b7b34c-+-db74 to S6 during pmtpa decom

9004b8ae90-+-fix typo ('mode' should have been 'group')

56ba865f98-+-Merge "contint: jenkins git config core.packedGitLimit=2G" into production

3d390fc867-+-Merge "base: add check_disk check exception for Varnish" into production

9197bd2af6-+-Merge "search: disable the lucene_search icinga check" into production

1ed3315063-+-base: add check_disk check exception for Varnish

878ae28f23-+-search: disable the lucene_search icinga check

8afa9887cc-+-adding site.pp entry for elastic1001-12

bec8b5bb97-+-install unzip on tin

8965adee53-+-contint: jenkins git config core.packedGitLimit=2G

0b0d5a3edc-+-Merge "Move android::sdk and packages::ant18 into contint module." into production

04aa995f11-+-Merge "(bug 56412) Make all sidebar phrases on Planet translatable" into production

5390485cd3-+-(bug 56412) Make all sidebar phrases on Planet translatable

237384d505-+-Move android::sdk and packages::ant18 into contint module.

87175fb369-+-Reduce threshold for flushing of dirty pages

03937e1ee4-+-Cleaning up analytics role classes

1637d1e539-+-Remove Kraken-specific varnishncsa instance

38458f8532-+-Revert "Revoke Yuri's shell access" and change pub key

63debcf3b7-+-Remove misc::maintenance::foundationwiki cronjobs

51049b68df-+-Merge "More fixes for file permissions/ownerships" into production

88a5d963df-+-Remove references to 'olivneh' account from node defs

6b39166528-+-monitoring for text-varnish wikipedia in eqiad

e05b26929a-+-Tool Labs: install cvs on dev_environ

fda6c6f219-+-Restrict access to geowiki's data-private checkout

7c04d85164-+-Fix indentation in manifests/misc/statistic.pp

a436110658-+-More fixes for file permissions/ownerships

ca6fe4efc3-+-Qualify the path to Python

fa3eaf7b5a-+-Add Graphite module & role

feabece830-+-Specify perms for generic::upstart_job

50dd498eac-+-Merge "Move eqiad wikipedia traffic to Varnish" into production

cda8ba2d8b-+-Move eqiad wikipedia traffic to Varnish

2e9f6dfdf1-+-Merge "Migrate textsvc from text to text-varnish" into production

292064b3f1-+-Migrate textsvc from text to text-varnish

3ac38b5bef-+-Merge "Add a 2nd 200GB persistent storage backend per SSD" into production

7f1649b394-+-Add a 2nd 200GB persistent storage backend per SSD

b5bbf071a4-+-Specify puppetmaster::gitclone missing ownerships

834b4f3eb9-+-Fix erroneous attribute

2f639f8d90-+-Merge "Fixing ownerships, permissions in various places" into production

b115b745b4-+-clean up cruft for db fundraising hosts

f24443183a-+-Adding trailing / to geowiki private data bare paths in rsync command

ac3c0d222e-+-Clone geowiki repos for geowiki's group

362ecbe3e1-+-Rsync geowiki's data-private bare repo as $geowiki_user

da86b77abc-+-Initialize geowiki_base_path for geowiki's private data repo

3fce2103e3-+-Checkout geowiki's data-private repo also on statistics' webservers

a93313efd4-+-Rsync geowiki's bare data-private repository to statistics' webservers

27648cc0f9-+-Turn on generating geowiki's limn files

587e05da23-+-Split geowiki data repository into private and public parts

4bd4a54a8c-+-Move geowiki data checkout into geowiki's base directory

f1332d202f-+-Rename geowiki backups to logs, as they are only logs

b0b30245ea-+-Move geowiki scripts into geowiki's scripts subdirectory

9500024d17-+-Split geowiki paths in base path and scripts

bdade619a0-+-Move geowiki's name for globaldev MySQL config into separate variable

ebd29bff69-+-Move geowiki's name for research MySQL config into separate variable

9e9b3150ea-+-Turn off geowiki monitoring

ead6a36766-+-Merge "Backup dynamicproxy-api's data.db" into production

9773a16eb8-+-Fixing ownerships, permissions in various places

3abe92f63d-+-fix mpt-statusd mess

d5a1ce7775-+-Disallow commit, merge, rebase on backends private

e35a69af19-+-Add the new upload-lb.eqiad IP addresses to the protoproxies

48e64f049a-+-Add new upload-lb.eqiad IP addresses according to the new Zero scheme

f13bcf2611-+-Change osm-lb.eqiad IP address

193f8b4ece-+-Adding mptsas support in check-raids

a847c9865a-+-Add custom replication rules for oojs/core and oojs/ui

f0c00dc99b-+-Disable prefer_ipv6 until IPv6 interface address selection are sorted

df228681a2-+-Backup dynamicproxy-api's data.db

1798bc2196-+-On amssq47..62, sda is a HD, not an SSD

5c16670a5b-+-Removing db 33,39 5[1-5][8-9] from dsh group and ganglia.pp

bed39dd937-+-Merge "decommision db3[29] db4[2-6] db5[1235689]" into production

467b23f995-+-tool labs exec_environ: add python-twitter package

c755b8fef7-+-decommision db3[29] db4[2-6] db5[1235689]

0fbf65d1e8-+-Merge "Check for administratively disabled puppet" into production

22368b3fda-+-and fix up the java dependency for elastic search too, woops

28e4392c0c-+-fix up java package for elastic search

e46a426c5b-+-fix up java package for statistics

3463df7307-+-hadoop install needs java

d2ea13ed3d-+-Using OneMinuteRate instead of FifteenMinuteRate in Kafka view

1042f5809c-+-Backslashes are being rendered doubly in ganglia view JSON output.  Not using them.

b5388dd81e-+-Adding ensure parameters to some misc::monitoring::view classes/defines

2d36efb13c-+-Updating kafka ganglia view with metrics from 0.8

b89f5f0763-+-Replacing tabs with spaces in misc/monitoring.pp

f1c84da300-+-Adding ensure parameter to ganglia::view for removing views.

c413be4a62-+-Merge "Move the textsvc ip from text to text-varnish" into production

b966438e4b-+-Move the textsvc ip from text to text-varnish

57aa08d81e-+-Check for administratively disabled puppet

298fa2905a-+-Include role::cache::text instead of role::cache::varnish::text

9eecb7af3a-+-Made netmapper updates more frequent

2e7fa2f868-+-Kill the java module with fire

b24135cbe0-+-Including analytics::users on namenodes.

ad8d39bd13-+-Adding Yuvi Panda on analytics nodes - RT 6103

009ce4c98a-+-Setup LVS monitoring of text-lb.esams

467038400c-+-Merge "beta: auto update Parsoid dependencies using npm" into production

bd8603f1c3-+-beta: auto update Parsoid dependencies using npm

60d38be8c8-+-sudo -u parsoid access for parsoid admins

e2eb26b804-+-add empty pmtpa lucene frontends and indexers

1818053de5-+-Update font packages to not use virtual packages

f29dca84bb-+-horrible hack to fix up puppet on formey til the host goes away

7e299c6d4f-+-Writing Kafka stats to jmxtrans outfile at /var/log/kafka/kafka-jmx.log

5ef8575281-+-ensure /srv/org/wikimedia exists on bugzilla server ..and some minor formatting

787cf5601a-+-quoting fixes in svn.pp (puppet-lint)

4be43275c1-+-puppetize enabling apache svn authz  module

649d00f745-+-Backup svn::server svnroot

78ddc7c941-+-Removing search13-21 from puppet manifest

deafd1c465-+-Merge "antimony already has apache installed" into production

4778f288de-+-antimony already has apache installed

a3a51051d9-+-Various dynamicproxy-api changes:

29f742bd77-+-Apply SVN manifests to antimony in prep for move to eqiad

a6dfd28aad-+-Merge "Removing all entries for ms1-4 as they're being decommissioned ::" into production

3729141073-+-Now using jmxtrans instead of KafkaGanglia class.

793f7b8358-+-Removing all entries for ms1-4 as they're being decommissioned ::

b594cbf611-+-Merge "Add new esams LVS service IPs" into production

3d0fdc718d-+-Add new esams LVS service IPs

dad1a15d8c-+-geoip: s/misc::geoip/geoip/

9d5fb2ba89-+-Merge "authdns: switch to geoip::data::puppet" into production

bba9fdef04-+-Merge "puppetmaster/geoip: make the symlinks relative" into production

dd6c1729c1-+-Merge "geoip: simplify the module" into production

d123a1dd73-+-authdns: switch to geoip::data::puppet

8f8f3f0a92-+-puppetmaster/geoip: make the symlinks relative

692194a285-+-Merge "Move esams text-varnish IPs to text" into production

f0f6a6c1c0-+-Move esams text-varnish IPs to text

3983691779-+-geoip: simplify the module

f2aee45444-+-geoip: don't filebucket geoip databases

a92182f8fc-+-puppetmaster: fixup to $is_labs_puppet_master ref

e7f80ad3cb-+-Correct monitoring IP references

4fb0cf4734-+-Move the text-varnish IPs in pmtpa back to text

901552775b-+-Depool amssq47, was used as test host

4e8fad4e4e-+-geoip: remove the broken geoip::data base class

06086c0043-+-geoip: make geoliteupdate executable

2956a565d4-+-puppetmaster: another fixup for geoip

fd8c5a98f7-+-puppetmaster: fixup for geoip changes

783faea369-+-puppetmaster: add GeoLite to geoip, fix for Labs

87d0bcf533-+-geoip: add a geoip::data::lite class

26332a16b1-+-move knsq23-29 to decommissioned_role in cache

f9408a15ac-+-Merge "Swap old/new esams upload LVS service IPs" into production

253bd468ce-+-Swap old/new esams upload LVS service IPs

bc3ef08c6f-+-remove knsq* from dhcp, dsh groups, ganglia refs, decommed

2e72ed41c6-+-Add new esams upload LVS service IPs to the protoproxies

30eff3f320-+-Pull lvs::realserver_ips from lvs::configuration

ca0c74bb4c-+-change refs to is_labs_puppet_master, it's not top scope

e75aa70091-+-Add new esams upload LVS service IPs to the https cluster

46af68a59c-+-remove Tampa search-pool monitoring

153e3dc9b4-+-Merge "Add new esams upload LVS service IPs" into production

8198ba5d34-+-Add new esams upload LVS service IPs

423f251b56-+-sudo for myself on arsenic

bc021541ad-+-palladium/strontium as puppetmasters

99a3f0bfc6-+-Puppetmaster module multi-master capable

911aed3307-+-Merge "Modularizing puppetmaster" into production

375897eff2-+-Modularizing puppetmaster

7b9e203487-+-Cleanup old/now unused ulsfo upload service IPs

b3ec2cf204-+-Revoke Yuri's shell access

a2cbd073c5-+-payments as empty hash for lvs service ips in eqiad

487f992ed8-+-Move the nfs-noid upstart job into an 'nfs' directory.

d9f0ea7a02-+-Change output format of Gerrit review count gsql to JSON_SINGLE

4b8da3a02c-+-reassign db69 to s2 and db71 to s3 during pmtpa decomm (both 12th floor)

bc1a796e0c-+-remove hosts no longer in dns from dsh files too

e20b42a470-+-remove msfe1002 from decomm, long since out of monitoring

6fbdbcaf74-+-pull various pmtpa db boxes from coredb pending 12th floor reorg and imminent decomm/reclaim

66841f8b79-+-Merge "Make Upstart_job check service status before attempting to start it" into production

8755ec3569-+-Remove a bunch of dangling commas in param lists.

e3c18b51dc-+-Remove the payments LVS service in eqiad

ee0e935b78-+-Add monitoring for the ulsfo text-lb LVS service

bf554dd7d1-+-contint: rm /var/lib/jenkins/tmpfs no more needed

b5c06a5994-+-Make Upstart_job check service status before attempting to start it

f7b3bc2b41-+-Upstart_job -> Generic::Upstart_job

7d60b976d6-+-Systemuser -> Generic::Systemuser

5a6d6033cf-+-Add a 'generic' module.

fa426589a8-+-Added the system module and the system::role class.

3b008cf17e-+-Merge "fixing mediawiki addtion to arsenic" into production

f919bcf48c-+-fixing mediawiki addtion to arsenic

265479422d-+-Merge "install gnupg on download-wikimedia server" into production

689c7e87ea-+-arsenic as cirrussearch script host

a86cbf1533-+-install gnupg on download-wikimedia server

3990149436-+-Merge "Restore internal svc address for ulsfo upload" into production

b7d93f65ce-+-Restore internal svc address for ulsfo upload

de8f69990d-+-Merge "deployment: integration/phpunit for Jenkins CI slaves" into production

cdd23fc08c-+-Swap old/new upload LVS service IPs in ulsfo

099404d083-+-Update ulsfo Text LVS service IPs to new Zero scheme

9a160864c5-+-Add new ulsfo upload LVS service IPs

b1d2fc4029-+-deployment: integration/phpunit for Jenkins CI slaves

2bd860a8c7-+-Adding ruthenium to site.pp netboot and dhcpd

2e3d2193c5-+-gallium: let ci folks sudo as jenkins-slave

7270b15542-+-removing search21-36 from site.pp

263d878470-+-Removing search21-36 from lucene.pp

7ee0f10075-+-Specify group => 'root' for the logrotate config.

3fd4651fd0-+-Move generic::gluster* into a module

3c2a0bfff2-+-Remove generic::sysfs::enable-rps

11f085a142-+-site.pp: removed apache-utils

ac610eb09d-+-removing search21-36 from decommissioning.pp

18696927bb-+-Apply misc::monitoring::view::mobile on nickel

0105a50bed-+-adding search21-36 to decom.pp

c6f1303c19-+-Revert "adding search21-36 to decom.pp"

e80cca9d73-+-adding search21-36 to decom.pp

e357e2e45c-+-Stamp out the last reference to nginx_site, remove.

d3464ba82b-+-Decommission mw110

79255b249a-+-Removing site.pp entries for wm126-134

35c2a49226-+-Add Text caches ulsfo cluster

5702a2a68c-+-Add ulsfo text caches

e3f7219ed1-+-Use Varnish by default for role::cache::text

63052a06e9-+-put the glusterfs mount back (dumps rsyncs)

aa26ddaab7-+-Report MediaWiki wfDebug() log counts to Ganglia via Gmetric

f5f08f861e-+-Updating udp2log.pp so that udp2log instance monitoring is not configured if $misc::udp2log::monitor == false

a1d8858013-+-add account fflorin and add to stat1

c6f870675b-+-Merge "promote milimetric from restricted to mortals" into production

35829c0d97-+-promote milimetric from restricted to mortals

50536adbae-+-Merge "Add mobile views to ganglia" into production

ec0a176b3f-+-Install the latest python-flask, so it pulls from labsdebrepo.

f25c6037b2-+-Add mobile views to ganglia

8f662abfd0-+-Merge "Only display login banner on labs bastions." into production

98f69a131f-+-Only display login banner on labs bastions.

d01194eef9-+-fix duplicate account::ebernhardson on stat1

d3702ff6b7-+-Merge "Add install and upstart for proxy api" into production

26dca78cb9-+-don't use nfs for rsync of pagecount data from dumps hosts

c80529f7fe-+-Add rsync daemon to labstore[34]

f47dc3e0a6-+-woops, needed fully qualified class name

33dab5c49f-+-turn off udp2log monitoring on silver, it's broken (rt #6023)

9563f2eb43-+-Unmount NFS mount

7ba6373da6-+-fix up name of nfs server for dump host pagecount rsync

8d93b95584-+-Merge "add mount points for download rsync cron jobs" into production

0442ef72d0-+-add mount points for download rsync cron jobs

bdd6bd73e2-+-Merge "Add amssq48-62" into production

d057e3ddc7-+-Add amssq48-62

41a2f572cf-+-Merge "Add Text caches esams" into production

b936d656e6-+-Add Text caches esams

ee0d05648c-+-dumps: Copy pagecounts data to public labs nfs too

ad2eac42d1-+-Repool cp3004

a8b12034bd-+-remove bash-ism from cron job command

0851625aee-+-add account marktraceur and add to stat1

4525080426-+-Add install and upstart for proxy api

82c6bb8e0c-+-Merge "Changing eqiad upload cache ganglia data sources to cp1048 and cp1061" into production

f9855ffb2b-+-Ensure a specific version of salt

4203d526fa-+-Merge "Namespace mediawiki repos for deployment" into production

528fa40732-+-Merge "Maintain repositories on deployment server" into production

f220e0eaaa-+-Changing eqiad upload cache ganglia data sources to cp1048 and cp1061

3f26667109-+-Add mobile caches ulsfo aggregators

36c3b8f533-+-Add mobile HTTPS LVS service in ulsfo

a3267d1b75-+-Add ulsfo mobile LVS service monitoring

bd219f4cf3-+-Setup ulsfo boxes as mobile caches

3ae007b994-+-remove htpasswd from icinga config, not used (see r51315)

3d56a07528-+-ganglia::python::plugin --> ganglia::plugin::python

5a2c97e4c9-+-contint: monitor CI server diskstats in Ganglia

b212772708-+-ganglia wrapper for py plugins

88e2267a88-+-Namespace mediawiki repos for deployment

dee7995cf6-+-Maintain repositories on deployment server

fcb337d45f-+-cassandra: add sysctl.d tunable

f426f28caf-+-Removed misc::deployment::scripts class.

ac8c9f38c8-+-Merge "Arg lists for fetch and checkout module calls" into production

c6ecb5e08b-+-Merge "Cleanup of config options and pillars" into production

8ca5907667-+-Merge "IPython: make $ipythondir writable for IPython user" into production

f1712e3b5e-+-IPython: make $ipythondir writable for IPython user

d4fba8684d-+-Merge "Remove hook definition calls on deployment server" into production

ddbc0986d0-+-Sudo for gwicke on cassandra test cluster

7b76885b99-+-Arg lists for fetch and checkout module calls

c381335012-+-Fixed a bunch of file resource paths.

2c37ade9e0-+-s/generic::gluster-client/gluster::client/

8223ec5dcf-+-Merge "Replace system_role with system::role in a recent patch." into production

79f0922e00-+-Merge "Forward beta cluster UDP logs to logstash.pmtpa.wmflabs" into production

9966851acf-+-Merge "download: convert into a module and clean up" into production

298728ac39-+-Forward beta cluster UDP logs to logstash.pmtpa.wmflabs

66984bf364-+-download: convert into a module and clean up

ae55ffd7e6-+-deployment: mediawiki/tools/codesniffer for Jenkins CI slaves

8a02752eeb-+-Serve geowiki datafiles folder directly

e0b2168659-+-Serve geowiki's private data through statistics websever

ef45d8d6ae-+-Add a static IPv6 address to Gerrit

fa8f5dd8cd-+-Provide a force ssh command+key for private update

a990fc1785-+-Varnish: switch upload to eqiad Swift cluster

8a82fa50d8-+-Correct parsoid cache port

ebea2a3e93-+-Swap old / new upload-lb.eqiad service IPs

dfe2980700-+-Merge "Remove parsoidcache ips from low-traffic LVS servers" into production

923593f298-+-Remove parsoidcache ips from low-traffic LVS servers

e3c8a25232-+-Merge "Parsoid caches need IPv6 addresses now" into production

4128ec9196-+-Parsoid caches need IPv6 addresses now

901167bc46-+-Merge "Migrating Parsoid caches to public" into production

cf51058706-+-Migrating Parsoid caches to public

f320a419c0-+-Gdash: Provision uwsgi::app on Ubuntu 12.04+

88cd8e5df3-+-Provision uWSGI app for Gdash

e1a6913918-+-Port graphite module to use uwsgi::app

f1c778be2f-+-Add uWSGI module

c9b6425b3b-+-whine about puppet freshness after 3 hours

0079c7696b-+-Remove duplicate definition of python-rsvg

31f6e650cb-+-Make appserver common a mediawiki deploy target

0cdb726938-+-Merge "Move ldapsupportlib.py into /usr/bin to keep ldaplist company" into production

71432b457c-+-Move ldapsupportlib.py into /usr/bin to keep ldaplist company

4d60f371b3-+-Add mediawiki module for fetch and checkout hooks

5a504ae2fd-+-Merge "ldap: make ldaplist runnable by anyone" into production

234ac60717-+-ldap: make ldaplist runnable by anyone

630ae0a4b5-+-Tool Labs: Dependencies for BZ 56996

74818fac61-+-Tool Labs: Import many dependencies from TS's Jira

033671bce1-+-Merge "zuul: dependencies for Gearman based version" into production

6c34e788cf-+-Merge "contint: deny Zuul gearman port (4370) beside localhost" into production

a0c057600c-+-deployment: integration/phpcs for Jenkins CI slaves

6ffcab3b1d-+-Using interface::add_ip6_mapped on analytics Kafka brokers.

563277e630-+-zuul: dependencies for Gearman based version

5facfbe4b8-+-contint: deny Zuul gearman port (4370) beside localhost

27242004ac-+-Cleanup of config options and pillars

0424d6f74d-+-Remove hook definition calls on deployment server

3effc612c5-+-Replace system_role with system::role in a recent patch.

d51754d55f-+-sideline db1017 for a time, disk & config issues

176bb5f598-+-db1041 using mariadb

8343013457-+-Add Greg Grossmeier as a mortal

122326ee57-+-Ganglia VE view: one graph cached / uncached / overall

5ea6278146-+-Merge "Adding site.pp entry for cerium,praseodymium and xenon" into production

a0912eb4ac-+-Adding site.pp entry for cerium,praseodymium and xenon

65e1fce64a-+-Fix typo in metric regex for VE DOM retrieve stats

9cbfbb1154-+-Merge "Add Ganglia view for VisualEditor metrics" into production

d43504b863-+-Add Ganglia view for VisualEditor metrics

6f3c900672-+-Change  for user 'olivneh' to dedupe.

28a308bbe4-+-Rename / promote 'olivneh' => 'ori'

c04cd2642c-+-Piping stderr into logfile for kraken jobs

645a4e2ea3-+-Installing doc opt on Kraken nodes

fa89930291-+-Running pagecount-importer and hive-partitioner hourly

9cf4a0bc2d-+-Fix typo in role name

892f80acc4-+-Merge "Labs: Rename confusing role name to more accurate role name" into production

2ed714ec15-+-Labs: Rename confusing role name to more accurate role name

9cb845832a-+-Remove unused apparmor class

073f1668e0-+-Merge "Remove the last of mysql.pp" into production

8df13f9748-+-toollabs: Install graphviz

dbcdd1866d-+-toollabs: Install ant on -login and -dev

88d7ef0886-+-toollabs: Sort package names in dev_environ

ea6fc37cb5-+-fix up path for skrillex.yaml.erb (now in mysql_wmf module)

3298b8201a-+-Remove the last of mysql.pp

779d315802-+-Remove generic::mysql::packages in favor of mysql module

2362460df0-+-one more path fixup for icinga/percona files

a570d16f91-+-update path for icinga/percona files (now in mysql_wmf module)

be67a0c86c-+-fix wrong path for files/charset.cnf (mysql_wmf module)

a13d199b8e-+-Specify group & permissions for a couple of files.

6dc5c4b276-+-Merge "Move mysql_wmf into a module." into production

b8525f4772-+-db1034 using mariadb

ae2aa57385-+-Move mysql_wmf into a module.

7f5669ff9c-+-Missing | character in pagecounts hourly import cron job

b8f5696ec1-+-Fix drac module broken in 22d7837

ab7f2d2c79-+-icinga pmp-check-mysql-innodb idle_blocker_duration

aadc85d11f-+-Remove unused (and broken) labs config from squid manifest

280e93331e-+-Rename 'bastion' module to 'bastionhost'

762cecbd6b-+-bastion: convert into a module

15b9560835-+-Remove reference to ssh::bastion

fb663a63b3-+-Reenable LVS paging check for ms-fe.eqiad.wmnet

36c7f7d90c-+-ssh: convert into a module

e23bcc60c6-+-Removing mc1-16 to mc1001-1016 and mc1001-1016 to mc1-16 redis

e948137dda-+-Add ulsfo upload LVS service monitoring

935506998e-+-Add ulsfo upload caches aggregators to gmetad

c929ad6a38-+-Fix ulsfo upload LVS services

0e53f0e62c-+-Make Varnish the default for upload now

6e8e7f6a66-+-Add ulsfo upload cache node entries

7ea4323361-+-Merge "Add ulsfo upload caches" into production

38d6f8ab7e-+-Add ulsfo upload caches

1e82029c9e-+-db1019 (s3) -> file_per_table, mariadb

8aa7116b95-+-Merge "Add ulsfo cache Icinga groups" into production

2f2c4e42eb-+-remove owa1-3, boxes long since wiped and reclaimed (rt #5143)

69dd7d462f-+-Add ulsfo cache Icinga groups

eba3834154-+-coredb_mysql: convert a few additional leftover tabs to spaces

dd7248d198-+-stop generating icinga messages for db hosts out of action

b13b6e0e11-+-update topology after rotations and upgrades

bfc01c5e73-+-coredb_mysql: lint

20673ca884-+-dpkg-reconfigure after my.cnf changes

b6cb517957-+-Merge "install the bug-attachment.wm.org cert on kaulen" into production

90c50520ba-+-install the bug-attachment.wm.org cert on kaulen

17c1380750-+-Merge "Include php5-cli in mediawiki_singlenode." into production

7317e57c33-+-Merge "Switch labs instances to use the mysql module." into production

d16afbfa1e-+-Include php5-cli in mediawiki_singlenode.

644e61d764-+-install imagemagick on stat1

c791885503-+-"enable_esi" setting to the mobile beta labs varnish

f2b3b3b6a2-+-position-of-the-moon : absent on all servers

e2788e7e53-+-Link IPv6 HTTPS LVS checks to the IPv6 host

d18baf0e36-+-Cleanup pmtpa LVS service monitoring as well

924dff2922-+-Add ulsfo bits LVS monitoring

c9e1a8c757-+-Fix misc_web LVS check

888d58c395-+-Cleanup LVS checks

516374ec27-+-Merge "Disable LRO on lvs40xx boxes" into production

876926fede-+-Disable LRO on lvs40xx boxes

08795bb35a-+-Tool Labs: make a combined exec_sumbit_host class

5196fd8bb3-+-Pick the proper mysql version, depending on distro

4a9f58f363-+-Removing servers: arsenic, niobium, palladium, strontium from puppet dsh groups

cfaf1409b2-+-Tool Labs: make the webservice nodes sumbit nodes

78e13eb57f-+-Removing mc1-16 from dsh group, dhcpd, ganglia.pp, decom.pp remvoing oc1-3 from site.pp

0e76694b63-+-ci: raise tmpfs dir size from 128M to 512M

a4e0a32616-+-Add a HTTPS service for bits in ulsfo

e39884432d-+-Add HTTPS service for text in ulsfo

a3725cb343-+-Make eqiad nameservers the default

eaaeeae0b5-+-(bug 38946) : Added culmus-fancy font to help render svg

b57e84c060-+-absence of /usr/local/sbin on some hosts was causing puppet errors, add to base

dae3a230c8-+-webperf: count number of CSS rules, log to Ganglia

e8b2d2e0e5-+-Merge "planet - add Ukranian language and feeds" into production

446b4bd254-+-planet - add Ukranian language and feeds

ff07d17697-+-Add Ganglia view for bits varnishes TTFB

7b18e6f31f-+-remove awight@boo ssh key, RT#5965

8055147d9b-+-NavigationTiming: aggregate data by bits cache host; add 'totalPageLoadTime'

4ca0690adb-+-Merge "contint: fetch slave scripts on slaves" into production

ccdd62fa9c-+-Merge "db1006 (s6) -> file_per_table, mariadb" into production

e73b087a72-+-db1006 (s6) -> file_per_table, mariadb

c173648eb9-+-Minor tweaks to admins.pp.

4d6b484eff-+-Switch labs instances to use the mysql module.

a13d760ad9-+-Merge "Fix docroot ownership for sartoris project" into production

84709bb1a6-+-Fix docroot ownership for sartoris project

c271be5d63-+-Dumb variable rename; attempting to mollify puppet lint.

acd457c19a-+-Add a tiny bit of app-armor management to mysql module.

7ec3a362c3-+-Fix private key installation

39626c67da-+-Add local SSL terminators to ulsfo bits caches

73b9b564f9-+-Change the labs rt role to use the mysql module.

9ed6239dd1-+-one more text -> text-varnish (wikibookslb eqiad)

833d769968-+-clear out old puppet reports twice a day (gives more breathing room)

07912faee1-+-rotate passenger logs on puppetmaster

c3ebeb8463-+-remove puppet reports older than 36 hours (was 2 days)

15a3753c29-+-Add a salt master override for labs

9f73496ab7-+-Deployment apache for sartoris project

d35c3992cb-+-Remove redundant sartoris definition

d90368777c-+-Toollabs: Add sbt to dev environments

67120561a1-+-Tool Labs: lighttpd: move to final paths

fb18dcecff-+-Tool Labs: completely rejigger the lighttpd setup

bb4f87648c-+-Rearrange mysql module my.cnf defaults.

44bf8664b3-+-Merge "Add roles for testing sartoris in labs" into production

f6ae18ce08-+-Merge "Change deploy repo config to repo => config" into production

8f5ef29abc-+-run puppet once an hour instead of every half hour

315579ae0a-+-planet feeds - add Japanese translations

361c6eeeee-+-Merge "planet feeds - add Indonesian language" into production

04c7621dd3-+-manual test cnf for db1044

1bc2002547-+-Remove an obsolete role file, labsmw.pp

60ed61075c-+-Add roles for testing sartoris in labs

d05707924b-+-Change deploy repo config to repo => config

9a2ca5592a-+-Merge "Log Puppet run times to StatsD via custom Puppet reporter" into production

56ba0858d4-+-planet feeds - add Indonesian language

1078c2211b-+-Ensure certain perl modules (and git) are installed on exec nodes

726978240e-+-Fix mysql module so it can work w/out mariadb

89cc6c38d5-+-Tool Labs: puppetize the new webnode type instance

c6fa8ee263-+-Merge "Removed mysql server from the stats cruncher role." into production

b3bcfa7c0b-+-Add ulsfo BGP peer addresses

28de7d1a21-+-db1024 -> file_per_table, mariadb

f2761665e4-+-db1045 to s5

06c1e40004-+-db1044 install mariadb

1b25b8a4dc-+-db1007 to mariadb

e2c00008b9-+-adding ulsfo into snmp allow list

062fe661dc-+-Log Puppet run times to StatsD via custom Puppet reporter

cc3471fa17-+-Adding ironholds to admins::restricted.

222d1834b0-+-Merge "Enable elastic search plugins" into production

0d8451a335-+-Merge "Moving my account to admins::roots" into production

d73af24357-+-Moving my account to admins::roots

94904cf8da-+-Enable elastic search plugins

13fe7cc904-+-Pointing analytics/kraken deployment to /srv/deployment/analytics/kraken

b5b79a8364-+-Removed mysql server from the stats cruncher role.

2674bee978-+-Adding deployment target for analytics/kraken repository

9ecf279720-+-Turn off fetching geowiki-data until it comes back in gerrit

c570d44c26-+-Tune up installation behavior for /usr/lib/nagios/plugins/check_elasticsearch

cbb058e667-+-Merge "Correct typo" into production

f2a0c59b13-+-Correct typo

42cce01e46-+-Merge "Correct text/text-varnish IP hash references" into production

640f03810c-+-Correct text/text-varnish IP hash references

b033bfba07-+-elasticsearch plugins in git-deploy

c706bd3fc0-+-Fixing role for amssq48-62, reverting amssq47 change

6400e954ef-+-db1039 to s7

248b86ccb0-+-Merge "Move the remaining non-wikipedia projects to text-varnish" into production

19082f3b4c-+-fix up amssq node expr (caught non squid hosts)

1a70751a12-+-Merge "Remove the trivial class base::mwclient" into production

724df4d8d5-+-setting up amssq48-62 as text varnish remove ssl role

b17d3fd161-+-Move the remaining non-wikipedia projects to text-varnish

0682914e2d-+-Move mediawiki.org and wikimediafoundation.org to text-varnish

1a86c30613-+-additional rsa/ssh key for awight

b284cd465e-+-apt-get should not install recommends

81355f58c9-+-Merge "db1040 -> mariadb and file_per_table" into production

61c7c9bc14-+-Add ttf-sinhala-lkmug to imagescalers

dac382f18c-+-db1040 -> mariadb and file_per_table

c4d276f58c-+-Remove the trivial class base::mwclient

7b3da5574f-+-rm williams from site.pp,use iodine for otrs mail

43fae5b49d-+-access to analytics boxes for Halfaker (rt 5836), Tarborelli (rt 5835)

b5d3923384-+-swift: fixup to statsd commit

1fb4186b61-+-swift: add statsd support to proxy-server

1c576b0508-+-swift: inline swift::proxy::config

536ccd18a2-+-Merge "zuul: statsd sent to tungsten.eqiad.wmnet" into production

18cf2d7794-+-Merge "Cleanup swift monitor_service entries" into production

90bcf5f508-+-add neverett to stats1002, rt 5886

521458df9e-+-Cleanup swift monitor_service entries

849557102e-+-sub db1015 into s6 during slave upgrades

68da49cf05-+-db1022 to mariadb

f35b41cf61-+-zuul: statsd sent to tungsten.eqiad.wmnet

af592c6b7a-+-Merge "statsd on tungsten: explicitly specify graphitePort" into production

c8c8b03cdc-+-statsd on tungsten: explicitly specify graphitePort

7620f5df22-+-Merge "Add role::statsd; provision on tungsten; grant self access" into production

a1dd159e42-+-Add role::statsd; provision on tungsten; grant self access

ddc6a217b3-+-swift: fix swift::proxy::monitoring for eqiad

f9e6a5ef7c-+-Remove labstore4 & labstore1002 from decom

8ad862fbb4-+-base: cleanup sudo definitions for check-raid.py

781608cc92-+-check-raid: readd support for arcconf (Adaptec)

23bc2b8862-+-Replace wikimedia-raid-utils by up-to-date megacli

92dbfeb353-+-miredo: fix typo in source => caused by conversion

f828578275-+-Merge "Use line (rather than stack) graph type for static assets" into production

681b2433ce-+-planet, retab from tabs to 4 spaces, align =>'s, quoting..

92ad82bfff-+-load mod_expires on planet webserver

a3169cca9c-+-Use line (rather than stack) graph type for static assets

a2ef1a04b8-+-remove misc::fundraising::jenkins from aluminium

0563f311da-+-Merge "fundraising: remove jenkins." into production

16075a5480-+-db1039 to s6, plus switch to mariadb

5e30c9212a-+-add ironholds to role analytics (RT #5831)

35fdb02809-+-db1003 to mariadb

3580889270-+-swift: remove swift::utilities

5a1837f8c2-+-swift: remove conditional for lucid

68f1f5376d-+-swift: remove swift::iptables

d68980f3dc-+-swift: remove swiftcleaner

b70bc10fbf-+-Merge "Correct invalid public key for bd808." into production

e1f3dc90ae-+-Merge "Initial commit of labs_vmbuilder module" into production

7a54d4e407-+-Correct invalid public key for bd808.

b1d87a672d-+-Initial commit of labs_vmbuilder module

a2a52fa798-+-Shell access for Bryan Davis.

4d37841ac8-+-search-pool5 was in twice

4fa57712ef-+-swift: switch eqiad to tempauth backend

22d7837e19-+-drac: convert into a module

6e3c590666-+-Merge "swift: change eqiad to the new partition layout" into production

d1587ba51a-+-swift: change eqiad to the new partition layout

3f1319efaa-+-Remove jfsutils from base::standard-packages

ee145d1643-+-fundraising: remove jenkins.

5e3391dc87-+-miredo: convert into a module

6e07cf9132-+-Cleanup my SSH keys

8c180092da-+-Merge "contint: browsertests needs php5-sqlite" into production

18e1e750ba-+-Updating kafka module to latest commit, modifying kafka role to reflect recent changes there.

4b79f3cd68-+-Add vagrant user to sudoers by default

d79ef7a036-+-contint: fetch slave scripts on slaves

02df35389e-+-contint: browsertests needs php5-sqlite

eb11e1198f-+-labs-vagrant: Ensure that vagrant homedir is created

b104025040-+-memcached: remove redundant hardy check

eaafa1caa2-+-Add LVS setup for new search infrastructure with monitoring

289c6d9b0f-+-cleaning out old and reclaimed hosts

611bc61fac-+-Merge "Add sartoris user with optional secondary groups" into production

c66ae5ccab-+-Fixing lvs4002,4 lvs_balancer_ip assignment

b8c2d453f5-+-Merge "Add .deploy to a system-wide ignore file" into production

0bf32a1870-+-Merge "contint: Apache could not start without IPv6" into production

98e74a2829-+-Removing accidental commit of *lb6 IPs for text-varnish

75fed34e74-+-Specifying ulsfo lvs hosts for high-traffic1 and high-traffic2 in $lvs_class_hosts.

d794107027-+-contint: Apache could not start without IPv6

af7d9ba8e2-+-Adding ulsfo as valid site for lvs_services:text-varnish, bits, upload and mobile.

d83041c0c5-+-contint: fix browsertests dependencies

d9d271afda-+-Merge "contint: puppet class to setup browsertests slaves" into production

3c1d4d62cb-+-Merge "Remove lucid umask setting" into production

80e422099c-+-Adding bacula module rspec tests

d9a53b831f-+-Merge "Nrpe: /usr/lib/nagios/plugins/check_dpkg should be absent everywhere." into production

cdf3ee8a2a-+-Nrpe: /usr/lib/nagios/plugins/check_dpkg should be absent everywhere.

5a22900ef5-+-contint: simplify apache listen template

7d054b4c4f-+-contint::localvhost is really a define

7b8ee65e2a-+-contint: puppet class to setup browsertests slaves

c7460214c8-+-Merge "contint::localvhost easily setup an apache listener" into production

08d0d2eced-+-contint::localvhost easily setup an apache listener

2cc81d1a8a-+-Remove lucid umask setting

e6b763c71d-+-Removed pstack package since bug 48025 is resolved.

1f92ccaee8-+-Add sartoris user with optional secondary groups

17e4bb2d9e-+-Add .deploy to a system-wide ignore file

1cd906cd20-+-Puppetizing lvs400[1-4] in ulsfo.

4b55bb32e2-+-Merge "RT: 5871 tungsten to replace professor" into production

1889cf2283-+-RT: 5871 tungsten to replace professor

fdc0b0c1bf-+-contint: dup Git::Userconfig define (same name)

5bbf2b3b12-+-Merge "contint: generate .gitconfig files for all jenkins users" into production

c7fe310c24-+-Move maven package def into contint module.

08a4e40217-+-ganglia.pp - assignment alignment

49fe616c1e-+-lvs400[13] and cp400[13] are ganglia data sources in ulsfo

d5b78b2f39-+-Puppetizing bits ulsfo varnishes.

f28250b551-+-Merge "Revert "add ironholds to role::analytics::users (RT #5831)"" into production

184af9ec52-+-Revert "add ironholds to role::analytics::users (RT #5831)"

9d78a5a9a8-+-Merge "add ironholds to role::analytics::users (RT #5831)" into production

80941292ac-+-add ironholds to role::analytics::users (RT #5831)

b0c5123c38-+-Revert "EventLogging on vanadium: move MongoDB data from /srv to /a"

e1a7df0e32-+-EventLogging on vanadium: move MongoDB data from /srv to /a

3070240f91-+-tweak memcached limit on beta (89GB -> 15GB)

b80476e32f-+-reassign db1038 to s3

8bb72ef2b0-+-Fix-ups for Gdash module

7a5af604ef-+-Disable broken Varnish monitoring for professor graphite host

75609ac016-+-Merge "Update NavigationTiming StatsD reporter to schema rev. 5832704" into production

bef711a52d-+-Merge "Add Gdash module; remove Gdash source tree from Puppet" into production

7f56137598-+-Update NavigationTiming StatsD reporter to schema rev. 5832704

5fba197645-+-Add Gdash module; remove Gdash source tree from Puppet

c6722193ae-+-Remove generic::pythonpip

1fa5d7a5e1-+-Ensuring package pigz is installed for wikistats parallel gzip processing.

d71b012b0d-+-Abolish generic::packages::locales.

784105146d-+-Add php5-sqlite package to toollabs instances.

146a48c96b-+-Merge "statistics.pp, puppet-lint, fix WARNINGs: string containing only a variable" into production

1c66f6c1ab-+-Merge "statistics.pp - fix unquoted file modes and resource titles. puppet-lint" into production

827ca18d61-+-Merge "since we just touched statistics.pp anyways, sneak in the retabbing as well" into production

48920c9ea1-+-Merge "add etherpad-lite process monitoring via NRPE, RT #5790" into production

8b05b8b9f1-+-add etherpad-lite process monitoring via NRPE, RT #5790

fc584eb407-+-Rename labsvagrant to labs_vagrant

cb3c6e46e8-+-add nrpe to node zirconium so we can monitor etherpad and other processes

7ca5df3c0c-+-bugzilla.pp - fix unquoted resource titles and file modes (puppet-lint)

63f7fa0495-+-planet.pp - wrong quoting, aligned arrows, ensure first and other puppet lint

876ef6e73b-+-retab misc/planet.pp from tabs to 4 spaces, do the cleanup before next attempt to turn into module

5a826c6646-+-Remove role::ceph::*, unused now

ae71d95ed9-+-Switch eqiad's ms-fe & ms-be to Swift

aa18ccf560-+-Add ulsfo to enable_proxy for apt

06527d32a1-+-Allow from ulsfo.wmnet for puppetmasters

b65d3651f9-+-Explicitly reference labsvagrant class from the module

97a1d1a1a6-+-update zeroconfig URL for netmapper

d79a6bc170-+-Merge "Change client id for salt minion to use dc attr" into production

efec9de712-+-Change client id for salt minion to use dc attr

1ad013b584-+-Merge "Puppet certname change for labs" into production

3497a4618a-+-Puppet certname change for labs

329a4b8560-+-reclaiming old hosts, removing cruft from decom list

ca079b2806-+-Merge "reclaiming servers: arsenic, niobium, palladium, strontium" into production

4c4b1b7fa2-+-reclaiming servers: arsenic, niobium, palladium, strontium

d32564aca7-+-Merge "Applying misc::graphite::gdash makes host a gdash deployment target" into production

fe80fd51da-+-Merge "Move and rename the (currently unused) gitconfig module." into production

c7ddf02f89-+-Disable ms-fe.eqiad.wmnet LVS check

ac2d70061c-+-contint: generate .gitconfig files for all jenkins users

3eb96bcf0a-+-Move and rename the (currently unused) gitconfig module.

19d4e55721-+-statistics.pp, puppet-lint, fix WARNINGs: string containing only a variable

d939853a3d-+-statistics.pp - fix unquoted file modes and resource titles. puppet-lint

849de2f7c2-+-since we just touched statistics.pp anyways, sneak in the retabbing as well

1a4abaa5b7-+-Applying misc::graphite::gdash makes host a gdash deployment target

c10fa01e7c-+-Add 'gdash' to git-deploy

42a6feb679-+-Merge "Remove stupid package I don't need" into production

c5509532f2-+-Pull dependencies and deploy all when targeted

a0679283d3-+-Removing analytics100[34] from decom.pp

9e3f10be13-+-adding 1 more file for decom of sq45

49019cf1b8-+-Decommissioning sq45, removing some missed decom entries

a28e7ef39d-+-stats.wm - re-enable loading of Apache SSL module in metrics.wm now that we don't do that with webserver::apache::site anymore. or there is a missing dependency on Webserver::Apache::Module[ssl]

40abc5ae9b-+-Turn off generating geowiki limn files

3aecc6b74c-+-Looks like icinga and ganglia didn't properly decommission analytics100[34] yesterday.

f04611fc8c-+-stats.wm - have an apache/ports.conf with NameVirtualHost *:443 to avoid '_default_ virtualhost overlap on port 443'

b37a8b7b14-+-Merge "stats.wikimedia.org - enable SSL, replace webserver::apache::site and its inline Apache config with apache_site and template in ./sites/apache" into production

9cff8f4def-+-stats.wikimedia.org - enable SSL, replace webserver::apache::site and its inline Apache config with apache_site and template in ./sites/apache

f847748708-+-adding mw1046 back to dsh groups

d5065ec6c9-+-upgrade db1035 to mariadb

fd55388860-+-Add labsbastion role

6f1caf04e8-+-Add labsvagrant role

6292e0ec39-+-Merge "Add labsvagrant module" into production

95c7567cd7-+-Add labsvagrant module

49c3d69810-+-db1018 to precise, mariadb, innodb_file_per_table

63822bb6c2-+-adding ulsfo ip information

b199253fff-+-adding ulsfo in ganglia options

57fa13347d-+-folks complained it wasnt bast4001

d27fd1a7ba-+-analytics1003 and analytics1004 now have public IPs.

94a3d6705b-+-Moving ganglia aggregator for Analytics Ciscos to analytics1009

b173f2c363-+-Decomissioning analytics1003 and analytics1004 in prep for giving them public IPs.

afc182d80d-+-Merge "deployment: abstract out MW_RSYNC_HOST" into production

aafa9eded7-+-set coredb db1002 to mariadb

d214381814-+-add db1036 to s2

a782838224-+-Use static_assets Ganglia view on nickel

5c94ff2ef4-+-Add Ganglia view for static asset payload size

0ee7572b88-+-Merge "Add 'webperf' module; provision asset-check service" into production

7b63d36149-+-toollabs: replace snarky comment

9059aac2bf-+-Merge "Ensure that a matching version of JDK is present for the JRE" into production

52127f7b4b-+-Add 'webperf' module; provision asset-check service

b376f0b6e1-+-Merge "Simplify git-deploy configuration" into production

ec75a2a649-+-Ensure that a matching version of JDK is present for the JRE

74153385e5-+-manual mariadb 10 beta test

2a5bcb2372-+-db1044 prefer mariadb take 2

248bce32c5-+-roll out mariadb to db1044

01b5bac449-+-db1044 precise + mariadb

8b22db65ed-+-Simplify git-deploy configuration

4dd2d5286e-+-apparently class-require does not do what I wish it did

73e99eb7eb-+-apparently class-require does not do what I wish it did

ca34ff8e87-+-netmapper data sync stuff

6e5dc64e55-+-netmapper data sync stuff

2edb2dc5f5-+-Remove stupid package I don't need

eef0487da3-+-Fix misc::maintenance::updatequerypages duplicate cronjobs

604e0ac914-+-rename clamd service to clamav-daemon

9fdcf258c0-+-puppetize clamd.conf

c50584dc38-+-begin puppetizing clamav for otrs

0093f0633d-+-Add missing config for test/testrepo

baa531aab8-+-Use formey for git deploy test repo

50abe7ec73-+-Add a test repo for final tests in production

4b97255bf8-+-adding mw1046 to decom list to remove from monitoring until fixed

f53163c040-+-Merge "Install config files before elasticsearch." into production

59c022c55c-+-Merge "Add DataTypes extension for wikidata singlenode" into production

aad4e73b75-+-Tool Labs: remove the now-redundant mosh

7070646a03-+-Install config files before elasticsearch.

403d0cda40-+-Unsubscribe elasticsearch from changes to config.

52a771633b-+-Compute geowiki data only for full days

b189467c07-+-remove dup stanza for ebernhardson acct

a7016d3d59-+-adding tftpd to bastion4001

ff48216ef8-+-bastion4001 setup

93de225e9e-+-nickel: add self ('olivneh') w/sudo

b979670cc8-+-updating apt-proxy ip range and tftp ip range

4c7d25ba10-+-adding ebernhardson to site.pp/admins.pp rt5717

65bf21ea54-+-contint: typo packages {} -> package {}

4b7f9cfe0e-+-Drop Video Scalers to 5 concurrent jobs

ba128c5890-+-Merge "contint: publish Zuul git over git protocol" into production

e435fcd69d-+-add db1023 to s2 during shard mariadb upgrade

d2a06387c8-+-backup director should backup itself

7f74d481f7-+-directories for gdash

48ba5deb19-+-Merge "Updating kafka module and configuring Kafka ganglia metrics_properties." into production

42aada7c85-+-Updating kafka module and configuring Kafka ganglia metrics_properties.

c767174e11-+-required directories for graphite

66373bba8b-+-Periodical run of disabled special pages: make updates monthly

2d4713995b-+-Periodical run of remaining currently disabled special pages on en.wiki

65d3cc80c6-+-fix db1036 shard

a0a1aad21f-+-move db1036 into s2

6dfdc9df2d-+-Add cronscript to monitor geowiki files

d318321dcc-+-Switch to changes table for gerrit's reviewer count file

8c9068ba68-+-adding labstore1002/labstore3/ssl3004 to decom.pp to remove from monitoring

b2c42f61a7-+-fix db1037 regex

011cca86a3-+-prepare db1037 for s1

be72e7dcd3-+-Make StatsD module backend-agnostic; make NavigationTiming instance Ganglia-only

391c9e4dab-+-Merge "newer eqiad servers really have 16 cores, give them 60 maxclients" into production

deeb6a3f64-+-Setup logrotation for elasticsearch.

cb8dc9baa8-+-newer eqiad servers really have 16 cores, give them 60 maxclients

bcd6f505e8-+-Fix typo in backing up /var/vmail

e415b58776-+-Selectively enable SSL on dynamicproxy via a class param

f3bfdb607d-+-Add mosh to labs bastions

b5310e1606-+-Remove redundant operatingsystem check for Ubuntu

7b85db574a-+-Merge "Tool Labs: packages libdmtx0a, libdmtx-dev" into production

dbea54379d-+-Tool Labs: packages libdmtx0a, libdmtx-dev

94edd2d7f3-+-'gmond' is not a Puppet keyword

b66da27e70-+-'gmond' is not a Puppet keyword

8726dbc670-+-Tool Labs: package libimage-exiftool-perl

4bcaadc5b2-+-Tool Labs: package poppler-utils

df38380b16-+-Tool Labs: package libav-tools

6036ece867-+-Tool Labs: package fabric

49a7fc1aaf-+-50 maxclients for the 12 core boxes!! not the 8 core

f72d4a42b8-+-MaxClients from 40 to 50 in appserver module too, for 8 core boxes

1ce0cd7a0d-+-Installing java openjdk 7 on analytics nodes.

e31b77a7f7-+-Add mosh to bastion hosts

c77c4e049c-+-added all the new network subnets

b5eeddef6c-+-Increase depool threshold of apaches to .9

13b646d09f-+-role/analytics/kafka.pp - changing hostnames of labs kafka instances

f41b2b52ee-+-adding ulsfo.wmnet to search domains on iron

7973e9a7ac-+-Adding nagios/icinga plugin and check for elasticsearch.

502e1d8c36-+-increment graphite pkg version

6c5ac43313-+-Use the star.wmflabs.org certificate for dynamic proxy

5ff89eaf7b-+-Merge "install_certificate: change the behaviour for $privatekey=true/false." into production

ff1cf5215c-+-install_certificate: change the behaviour for $privatekey=true/false.

685b82b5d0-+-Tool Labs: add package python-wikitools

f24dde40dc-+-enumerate unused dbs outside of an ugly regex, testing graphite 0.910 on db1014

a24dc39671-+-Add SSL support to the proxy

d058e36cd3-+-Merge "Rename labsproxy module to dynamicproxy" into production

9d2f6cbea7-+-change jenkins gid to www-data on civicrm server

705a9b560b-+-Turn backup::host to an included class

143ee70f18-+-Ensure changes to ganglia-vhtcpd.py trigger gmond service refresh

5e5b4430dc-+-Ensure changes to ganglia-vhtcpd.py trigger gmond service refresh

30dad03657-+-Resolving $geowiki_path variable correctly in new class misc::statistics::geowiki::mysql::conf::research

4af9a633df-+-Add cronjob to generate and push geowiki's limn files

1dc793d113-+-Extract geowiki's research MySQL config into separate class

1c22d26610-+-Split off geowiki cron job into separate class

2bb6e5aa9d-+-remove db1045 from unused pool

cb01b3446e-+-redeploy OTRS idle_agent_report

efaf18347a-+-Correct Text squids esams gmond port

ef29a39545-+-Add DataTypes extension for wikidata singlenode

faa519fad9-+-Fix typo in misc/graphite.pp ('content', not 'contents')

520a5580e7-+-StatsD: only report medians to Ganglia

b5f86ddd2e-+-Rename labsproxy module to dynamicproxy

dcde4c6352-+-decomming sq42 --another one bites the dust

4d74197e28-+-Remove obsolete sudo setup

1a0d456469-+-Make defaults for StatsD module more sensible

5f04abefc6-+-lint manifests/misc/install-server.pp

4d10573711-+-contint: publish Zuul git over git protocol

c7044c3365-+-Merge "contint: let us configure statsd for Zuul" into production

d17fc9052b-+-StatsD on Hafnium: listen only on loopback interface

4aaeee86aa-+-contint: let us configure statsd for Zuul

366e33ee2e-+-update-ubuntu-mirror fixes

b8348e5e18-+-Move update_special_pages to terbium

dfa562052a-+-Tidy up maintenance jobs on terbium/hume

ca5f33e115-+-decom sq36/removing sq31-36 from site.pp/cache.pp/dhcpd

96aa0ee746-+-RT#5011 bugzilla to use own certificate

6f11cb60b1-+-adding siebrand to stat1 rt5726

40e0d85eb0-+-NavigationTiming StatsD instance: flush every 5 mins

5524f845e3-+-cmjohnson new sshkey

82b9a0a8a1-+-Ganglia: rename 'perceived_latency' view to 'Navigation Timing'

81703ab19b-+-Omit parentheses from metric names

7b130fbe7e-+-Merge "Add Ganglia view for NavigationTiming data" into production

2a09247afd-+-Add Ganglia view for NavigationTiming data

65ff2387ef-+-Merge "retab and quoting in blogs.pp" into production

baccbef540-+-Move a bunch of templates into the 'base' module.

5287529571-+-Move a bunch of module-specific files into the base module.

321acacfdd-+-Tool Labs: opencv (and python bindings to same)

03c62d1dfa-+-Revert "Lots of ruckus to get our apt repo 'signed'."

4e1dd7b92d-+-Revert "Use %transient-key when generating our apt-signing key"

b367f10544-+-Merge "Revert "siebrand access to stat1 RT5726 has not been 3 days-need approval"" into production

98ece6fe76-+-Revert "siebrand access to stat1 RT5726 has not been 3 days-need approval"

6250dbda13-+-Putting kafka log data dir in a subdir of the mount points.

94d239ccc1-+-Merge "siebrand access to stat1 RT5726" into production

3c97cd8fd1-+-siebrand access to stat1 RT5726

9f122e0db7-+-Naming eqiad Kafka cluster /kafka/eqiad in zookeeper

d168c7599b-+-Revert commits 38717f3 4f44a53

ed0f23cd2e-+-Create a definition to facilidate backup sets

13c95f1f8c-+-Remove two seemingly-unused classes, 'joe' and 'tree'.

77d1fde47f-+-public1-ulsfo is a /28 not a /27

77888f6f6a-+-Merge "Add labsvagrant helper script to help manage labsvagrant roles" into production

90403eb460-+-Add labsvagrant helper script to help manage labsvagrant roles

36572e0bc2-+-Merge "Remove the unused git::init define" into production

696d43a76d-+-Merge "Moved git::clone into a new, skeletal 'git' module." into production

bc9a720668-+-Remove the unused git::init define

fca65e43c4-+-Moved git::clone into a new, skeletal 'git' module.

7458bb6b5a-+-Using JBOD Kafka mounts in production

56d5bd5518-+-tabs and lint stuff in outreach.pp

d8378b584b-+-retab and quoting in blogs.pp

2c1ff4195a-+-remove old node marmontel from site.pp

1434f60394-+-Use %transient-key when generating our apt-signing key

f4b7f7da00-+-Adding role/analytics/kafka.pp Also adding modules/kafka

9c8a27f73d-+-Lots of ruckus to get our apt repo 'signed'.

9a2fa7ed96-+-Including role::analytics on an21 and an22.

01498ef169-+-Revert "RT#5010 blog.wikimedia.org getting its own cert"

67f6de7d68-+-RT#5010 blog.wikimedia.org getting its own cert

e3628768a6-+-Merge "Tool Labs: Make tools-proxy infrastructure" into production

e1d9b51742-+-disabling py shell access

8bfb10de0f-+-Tool Labs: Make tools-proxy infrastructure

22b9ad6032-+-Merge "promote manybubbles from admins::restricted to mortals pending approval RT #5691" into production

c2980032cc-+-Merge "Add role to toollabs for generic web proxy" into production

e992f33d74-+-reclaiming manganese -remove site.pp/add decom.pp

fb7efc151f-+-contint: dupe define Iptables_add_exec[gallium]

ed5ef00e57-+-contint: prevents access to Zuul daemon

53383a52f9-+-contint: move iptables under module

0bd7c0398c-+-Moving $ganglia_aggregator declaration above analytics class includes.

b1d4bcfa3b-+-Add role to toollabs for generic web proxy

2179c6085f-+-Tool Labs: fix doubled up package inclusion

380372a28c-+-Tool Labs: User-requested perl packages

f26b18727f-+-Tool Labs: Boost for python

ac3d124050-+-Tool Labs: package python-rsvg

e58d1aedeb-+-Tool Labs: package python-scipy

e76110c125-+-authdns: introduce an authdns::lint class

4f44a534a2-+-Fix wrong package specification of 38717f3

38717f3394-+-Hold puppetmaster version to 2.7.11-1ubuntu2.3

9a11ba126e-+-Clean up sysctl parameters.

fa2208b74c-+-Clean up sysctl parameters.

7c79635fbe-+-Add nfs[12] to backup scheme

280ed93f84-+-Replace position-of-the-moon

33530dc56d-+-Fix typo in template path (mwerrors.pyconf.erb)

adfc74b89a-+-Correct class name (role::logging::mediawiki::ganglia, should be ::errors)

269432d3e7-+-Report MediaWiki exceptions & fatals to Ganglia

05e2400378-+-Remove misc::graphite::statsd from professor, use hafnium instead

9116e2996e-+-Notify navtiming service when its Python code changes

e463f73a42-+-New module: 'statsd'

5b68685481-+-Move run_directory into mysql.pp, the only place it is used.

6ed432675c-+-swift: ms-be5 is H710

e9262c0bc8-+-Merge "Replace Gmetric implementation" into production

6bf8465fc8-+-Replace Gmetric implementation

13e2846eee-+-add percona processlist monitoring, and start migrating to PMP v1.0.4

474cdc1386-+-db maintenance role for terbium

6239c895e7-+-Switch Gerrit from manganese to ytterbium

d9d01ed513-+-Make virt 12-15 compute nodes

428622ed4a-+-Add service IP to production gerrit server

774fb36eb7-+-Bugfixes to StatsD Ganglia backend

5014370925-+-Merge "Turn on pluginsync." into production

9c93fad0d6-+-StatsD on hafnium: load Ganglia backend

f46a568808-+-Turn on pluginsync.

e36c7384fa-+-Log NavigationTiming data to Ganglia

d95afb9500-+-statsd module: provision Ganglia backend support

0be955b848-+-nrpe plugin files need to be executable

e8124806f3-+-Move base class and subclasses into a 'base' module.

5664cf5b02-+-Labsdebrepo fixes:

c0d521e5a6-+-Installing Hive, Oozie and Hue servers on analytics1027

cdfeda2f44-+-+ more comment doc in analytics role classes

17ec51ac99-+-Turn on automatic pulling for geowiki repository

bc92bef768-+-Whitespace cleanup (mostly)

4c82107791-+-dns account not needed on fenari any more

3ace0effd6-+-Only backup /var/lib/mailman if defined

9000ed90e9-+-nginx module should expect enable true, not 'true'

b62fe0ceb6-+-nginx sites with donotify need to use nginx module, not generic defn

6fb9a67b1b-+-one more protoproxy -> nginx change

e930eaa568-+-Delete old 'sysctlfile' module & related detritus

0c14e5c00a-+-removing caesium from site.pp netboot and adding to decom list

cdcee371dd-+-removing netmon1001 for now

1991a7788f-+-Specify push configurations for gerrit's replication in lists

117a4d6944-+-Merge "adding rdb1 and 2 to decom list" into production

8abffbae5f-+-adding rdb1 and 2 to decom list

ca53e4f383-+-table removed from production

c491648388-+-Merge "Allow grains to be set with a single value" into production

610a5d4465-+-Merge "Add redis lua library to labsproxy" into production

07c1cb2f69-+-promote manybubbles from admins::restricted to mortals pending approval RT #5691

8d95fff4e2-+-Tool Labs: make webservers proper submit hosts

9a03085a99-+-Merge "contint: python-sphinx package" into production

dc34248a0f-+-Merge "contint: publish Zuul git repositories" into production

ed2fb387ff-+-contint: publish Zuul git repositories

f9c7743f6d-+-contint: python-sphinx package

17f04ab7a4-+-Merge "require nrpe package before collecting" into production

0e3557f3c7-+-Allow grains to be set with a single value

1220cb12f7-+-Fix host for geowiki's research connection

4e4906c37c-+-disable loading of Apache SSL module in statistics.pp because it's already loaded by webserver::apache::site when used with ssl => true

bcc061bd25-+-fix webserver.pp to also accept ssl => true as a boolean, instead of a string so you don't have to quote it without breaking puppet

8194e65bab-+-Merge "monitor HTTPS on iodine" into production

691a458ded-+-monitor HTTPS on iodine

ac989d5cb0-+-Tool Labs: add IPC::Run to exec environment

d44d1d4fba-+-enable ssl on apache site stats.wikimedia.org on stat1001

c20f181f52-+-install certificate for stats.wikimedia.org

9d7df2cfe9-+-require nrpe package before collecting

a78501f382-+-Adding various servers to backup

500604c11e-+-Including role::analytics on Ciscos

36adde2b82-+-analytics1003 and analytics1011 are ganglia aggregators

49887abd36-+-deployment: abstract out MW_RSYNC_HOST

0e9590323a-+-role::pmtpa-proxy: file[] -> File[]

8df1f737b2-+-Tools: Add python-oursql to exec_environ

94f991ad53-+-Tools: Allow bastions to access other hosts with HBA

e747bb9d0f-+-sudo right for hashar on lanthanum (Jenkins slave)

9d8bd47a29-+-run stats update for wikivoyages at 8pm

0d2a0f0017-+-Merge "remove old RT 3.8 stuff and just keep RT 4.x Apache stuff" into production

3ed5244af4-+-Merge "enable train_spamassassin script on iodine" into production

7c3d66ba60-+-enable train_spamassassin script on iodine

b5ee021924-+-Moving Hadoop JournalNodes to analytics10[123]

c04b263da1-+-Merge "more spamassassin config variables in template" into production

a1bc02d85c-+-more spamassassin config variables in template

6f83b7a353-+-Merge "more OTRS-related mail/spam tweaks" into production

686675c8a2-+-more OTRS-related mail/spam tweaks

a28f436295-+-Merge "various otrs + spamassassin and cron tweaks" into production

7e10315725-+-various otrs + spamassassin and cron tweaks

820e0d138c-+-Merge "Revert "add missing uploadlb6 ips"" into production

e31d17178b-+-prep to make the spamd user configurable, and create spool dir for OTRS spam training

62c886244f-+-Revert "add missing uploadlb6 ips"

5738b7dd5e-+-Make our checks for definitions a bit more explicit.

ac4e1533f9-+-Fix typo

8bc47e4131-+-Log client-side latency measurements in graphite

00fedb97f8-+-remove old RT 3.8 stuff and just keep RT 4.x Apache stuff

7dcfb117da-+-Merge "introduced a typo" into production

fb2cba3137-+-introduced a typo

14230b52dd-+-Merge "include curl in smokeping class" into production

06403f5ee3-+-include curl in smokeping class

233143271e-+-Merge "fixing smokeping to use standard" into production

2e8945747a-+-fixing smokeping to use standard

bfd53a1e79-+-single quote the realm in the labs/prod case

c6ae5c9f15-+-Fix webserver class to use truth value for ssl

85bb964bf7-+-Merge "fix missing quotes in realm case, do not quote booleans" into production

13b75fc994-+-Merge "RT:2640 fixing missed quoting in case statement" into production

00974b60a8-+-fix missing quotes in realm case, do not quote booleans

94317fa49d-+-RT:2640 fixing missed quoting in case statement

7dacb9c162-+-Add self ('olivneh') to professor.pmtpa.wmnet

69cd157d9f-+-Variable should not be in double quotes

8998ad677b-+-Adding blog.wikimedia.org to backup schedule

242bd36fc9-+-Add an archival pool for backup

361cafc1ea-+-Not including analytics1028 as a journalnode until it actually exists.

33585a3f1d-+-Including hadoop classes on NameNodes and DataNodes.

b594dec0bf-+-Don't need role::analytics::common for JournalNodes

a635072ec6-+-Setting dfs_journalnode_edits_dir

13dc325298-+-Fixing typo in role::analytics::common class name

a4ff0cc1dc-+-Setting up analytics102[678] as Hadoop JournalNodes

946e814249-+-Merge "testing smokeping role before modifying it" into production

47c0973a2b-+-testing smokeping role before modifying it

a63ac25142-+-Replace public key for jamesofur

1d7ecd3fb8-+-Merge "Ensure deployment targets have dependencies" into production

c23b2ab66a-+-Ensure deployment targets have dependencies

b8068e8922-+-make OTRS spamassassin even more strict

5baa998c80-+-Remove 'solr::decommission'; qualify 'eventlogging' include

8551ca83a7-+-Merge "Switch ops to passwordless sudo in labs" into production

eb7bdc5674-+-Track event counts in Graphite

6d8d8dbab3-+-Switch ops to passwordless sudo in labs

8443524fa5-+-Merge "Add solr::decommission class & apply it to vanadium" into production

62b5a6b3df-+-Add solr::decommission class & apply it to vanadium

c856b3f545-+-Until we switch over, still replicate all from manganese

10f0f302d2-+-ytterbium, have group wikidev, include accounts then do all the rest (sudo user), attempt to avoid dependency problem for Group[500]

0f9cda0f0a-+-Remove deprecated ircbot param

f676abe1e6-+-Merge "make wikistats cron jobs more readable, add comments" into production

73b337198f-+-Merge "Restructure replication in preparation of moving off manganese" into production

73a6f0a1bd-+-Restructure replication in preparation of moving off manganese

8c6b7ed041-+-Fully-qualify '::pystatsd' in misc::graphite::pystatsd

53a98b2830-+-make wikistats cron jobs more readable, add comments

47a419ac8e-+-Add pystatsd module; provision on hafnium

b861a04cc3-+-Setup metrics collection for elasticserch

1bb0279dac-+-Merge "generic::mysql::server: exec[] -> Exec[]" into production

4d3933a7fa-+-run cronjob for mw stats of wikki.com wiki at 9pm

5bc4a6c9a1-+-puppetized motd of bots project of labs

cf4252ea2b-+-Merge "Add Icinga plug-in & NRPE check for EventLogging jobs" into production

929ebd903d-+-Merge "add missing uploadlb6 ips" into production

1f2e452e2f-+-Add Icinga plug-in & NRPE check for EventLogging jobs

7a60e55b6e-+-netmon1001 to base install for now

b1bf8b0751-+-Merge "replicate Gerrit repos to Jenkins slave gallium" into production

2e55ca8daf-+-Puppetizing Hadoop JournalNode and Standby HA NameNode

c02083fff9-+-replicate Gerrit repos to Jenkins slave gallium

dd564f5af3-+-replicate Gerrit repos to Jenkins slave lanthanum

890dec218e-+-Merge "Remove old ircbot and gitweb cruft" into production

87335d6d02-+-add missing uploadlb6 ips

6ba44c8649-+-Merge "Use nginx module for protoproxy and disable notify" into production

4e42b748c1-+-Allow Christian to sudo -u stats to debug and test stats' automated cron jobs on stat1

6b2073c482-+-for misc-web-lb, just monitor varnish, not services behind it.  no paging for single host services without redundancy.

51707a232d-+-Merge "Tee centralauth wfDebug()s to vanadium for Gangliafication" into production

db0d7f2959-+-tweak spamassassin scoring for otrs

ec0a18ff08-+-role::eqiad-proxy: file[] -> File[]

23456e5892-+-Tools: Manage obsolete files in /usr/local/bin

c0308293a0-+-Merge "Tools: Enable Ganglia monitoring for Redis" into production

c485d737cc-+-Merge "Tools: Enable Ganglia monitoring for Exim" into production

d98b7b27ed-+-Merge "Tools: Puppetize tips.sh" into production

309a050fa6-+-Changing production zookeeper myids to match current values

12b46e7931-+-Slight restructuring of analytics common role classes, including role::analytics::zookeeper::server on analytics102[345]

7480d66e49-+-Tool labs: Fix tcl package installation, add csh

9d4f7b59de-+-Refactoring nrpe module (round 2/??)

f74880af40-+-Merge "authdns: restart gmond when the plugin changes" into production

2decc82894-+-authdns: restart gmond when the plugin changes

5e11999b7f-+-Merge "Making the process of defining host backups easier" into production

53d5ed15dd-+-fix exim/spamassassin config for otrs

ced4ec88f9-+-grr. s/format/template/ typo fixed

a5164aa237-+-change otrs spamassassin report template, reduce spam threshold

71a711fb8b-+-Use nginx module for protoproxy and disable notify

e9cfd390e1-+-Decommission srv281, RT#5647

257fb00538-+-authdns: fix puppet evaluation order

80694991dd-+-Making the process of defining host backups easier

9b31e27e4a-+-ref to misc::statistics::rsync::jobs removed

124caa17e7-+-authdns: fix interface for service IP

8eb5584b58-+-authdns: switch eeden to new ns2 service IP

97d71d1746-+-Add IPv6 mapped address for rubidium/mexia/eeden

0f843d59c0-+-authdns: add IPv6

16edad19b8-+-Cleanup dns::auth-server

6b19542a2d-+-authdns: switch final migration bits

07a1fbdf29-+-Merge "mediawiki_singlenode: exec[] -> Exec[]" into production

619d9a1430-+-Merge "fix system_role for role::protoproxy::ssl::beta" into production

4ddb63d0d1-+-Merge "beta: phase out shell autoupdater" into production

933417f942-+-Tool Labs: Move dev packages to dev_environ

fe2b846e20-+-Adding brewster to new backup system

7de3536c3e-+-authdns: remove IP/dns::authserver from old NS

9eb1cf7dd8-+-authdns: migrate ns2 to eeden

0947e06362-+-Merge "Tab cleanup in site.pp. Also fix vim modeline" into production

9f86a489ab-+-Ceph: tune config knobs in response to mini-outage

dee729f135-+-Preparing to remove private webrequest logs from stat1.

d34d9a07cf-+-Tab cleanup in site.pp. Also fix vim modeline

955c6c8095-+-Prepare rubidium/mexia for authdns migration

c24b22cf1d-+-Add redis lua library to labsproxy

214fd6f578-+-exim: s/content/source/ on DKIM keys

22ed65fa6d-+-exim: add DKIM for wikimedia.org domains

abdbf8e30b-+-Tee centralauth wfDebug()s to vanadium for Gangliafication

400b003d49-+-adding virt1 to decom [rt 5472]

61ffc06012-+-Remove redundant key comment, fix key type

b20222a1fa-+-Added new public key for myself.

8c3eed7ec0-+-lucid libsnmp doesn't create /etc/snmp so we do.

686dddd88a-+-exim: switch sodium non-list mail to its own IP

5cb5d9542f-+-removing sq41 role/cache & ganglia

a8dc3adb4b-+-fix up path of check-raid.py for sudoers

dc068b14d0-+-third time's a charm?

3f44c82ce0-+-correct ensure for /etc/dsh

c254598ba2-+-add virt3,4 to decommissioned list since they are nonexistant

6d2c94fad5-+-create parent directory /etc/dsh for dsh node group files

4539182192-+-force snmp traps to be sent with canonical client ip addr

b29e1d28e4-+-authdns: add Ganglia plugin for gdnsd

d402195cc5-+-Remove old ircbot and gitweb cruft

8a4247ac60-+-Tools: Add python-beautifulsoup to exec_environ

06f050306d-+-Merge "decommissioning sq41" into production

c61165feef-+-decommissioning sq41

cef9f10bdf-+-git::clone: fix clones with unprivileged users

ca83c78b2c-+-authdns: fix private file path

9a6e6a79ee-+-Merge "Temporary setup of new authdns servers" into production

abd5343a48-+-Merge "Add an authdns module & associated role classes" into production

083e8e51c7-+-Temporary setup of new authdns servers

58d71bce53-+-Present our cert to clients, autolabel volumes

858a854a54-+-Add an authdns module & associated role classes

a24614ff2a-+-Merge "Undecom mexia" into production

c1d4ebd6d2-+-Undecom mexia

683388cdfe-+-Restore/Migrate Job templates

56a54cf5e3-+-Fix various typos in bacula module

58130c65f1-+-Tabs vs spaces in site.pp

b47309f4ae-+-Adding helium.eqiad.wmnet as backed-up host

a4e8890fa1-+-Adding Default pool to backup

60bf8cfa97-+-Add Icinga monitoring (critical) for the misc-web cluster

d6b57368a2-+-Switch the role::cache::misc cluster to role::cache::ssl::wikimedia

4fc3c30c52-+-Add role::cache::ssl::wikimedia, factor out common resources

b7a3c1f67a-+-Add nagios group for misc caches

2eb82eb81d-+-Adding a forgotten -1st- stanza

b3362198a3-+-Change bacula SD paths

001203e4cf-+-bacula module fixes

35e15fedbb-+-disabling absent volunteers access (if either of these guys comes back to do stuff, give them their access back.)

21edc0fe66-+-Remove cp3004 from esams upload pool (bad disk)

73598bd12e-+-Route list outbound mail to a separate SMTP transport

ac20610fd6-+-include role::backup::config

f361cbf3c5-+-Add ganglia monitoring for vhtcpd.

aab3b88014-+-Add ganglia monitoring for vhtcpd.

1eac07e0d6-+-initial deploy of ytterbium for eventual gerrit replacement

02cf7fd582-+-bacula::console is a class not a definition

ab0de1fe12-+-Removing duplicate definition in backup.pp

4204d8c3a3-+-helium backup director/storage server

3084d249a3-+-fix up torrus conf file generation for squid/varnish caches

de893371fa-+-Merge "Make SpecialPages Titlecase in misc::maintenance::updatequerypages" into production

2527f1f966-+-sysctlfile: add newline for value invocations

d40b85179c-+-correct parameter name in ganglia_new::configuration for cache_misc

1c22e16f32-+-Revert "vars in ganglia_new::configuration need to be set before aggregator uses them"

99a0826c7f-+-vars in ganglia_new::configuration need to be set before aggregator uses them

853ff70310-+-a couple of hardy hosts out there need timeout package (e.g. erzurumi)

fb818ef073-+-varnish::monitoring::ganglia wants empty params for holmium

4d48151523-+-make sure varnish.pyconf gets created for holmium (was breaking puppet)

86c51a9337-+-Merge "Script to handle purging of query digest data older than 4 weeks." into production

fd2a79490e-+-Make SpecialPages Titlecase in misc::maintenance::updatequerypages

fa5d2f177e-+-Also add groups::wikidev to hafnium/vanadium

6fbf3af971-+-chang wikimedia-lb checks to text-varnish ips

2e147550ff-+-Add accounts::olivneh to vanadium & hafnium

9794b5b72b-+-declare hafnium node in site.pp & grant sudo to myself

f162deee79-+-Merge "Add support for gerrit.wikimedia.org to the misc cluster" into production

4ac1756796-+-Add support for gerrit.wikimedia.org to the misc cluster

f8dd610a4b-+-fix up private aliases class name for mchenry

568a9a3a2a-+-Merge "Configure elasticearch multicast per datacenter" into production

9fc7018f05-+-Using renamed geowiki repo instead of editor-geocoding

a30ec4c8d3-+-aaron handed me a new pubkey, unless it was a pod person...

785c042a22-+-"Add HTTPS service for misc_web""

eb8c76ec2b-+-Revert "Add HTTPS service for misc_web"

76003ce13a-+-Add IPv6 addresses to misc_web service

850f3c8cc9-+-Add Misc Web caching Ganglia cluster

a7a7c56df6-+-Recommission cp104[34]

c2ca500190-+-Add HTTPS service for misc_web

8e3e465bac-+-Move wikimedialb to the text-varnish cluster

08f95f273d-+-puppetizing /etc/lograte.d/squid

8dc77f7e8e-+-Configure elasticearch multicast per datacenter

eceefe1963-+-Fixing name of libdclass0-dev package

648f975fb3-+-Installing dclass libs on gallium for device classification unit tests.

70b9f9f798-+-Script to handle purging of query digest data older than 4 weeks.

e3bbfd4fb6-+-twemproxy for snapshot hosts

e4eaa7fdca-+-Some more etherpad-lite apache config tunings

6dcc3f5c4c-+-Refactor nrpe to a module

49427527d9-+-Revoke Aaron's SSH key

a7a0f8e82d-+-Disallowing all indexing for now

a9ca12dfa6-+-Just the old hostname for etherpad

e286f98391-+-Rewrite etherpad to etherpad-lite URLs for compat

f78a779b52-+-Merge "Introducing bacula module" into production

20dd58ceba-+-Add VIPS / TIFF packages to toollabs exec_environ

1f958b3e58-+-uninstall os-prober from all machines

63766f4183-+-ceph: fix sysctl invocations

0e03a188d2-+-ceph: actually user ceph::key's owner/group/mode

345b0443bf-+-ceph: add ceph::nagios class

481c48d7e7-+-ceph: add ensure param to ceph::key

aebf762e9b-+-Re-enable LVS check for ms-fe.svc.eqiad.wmnet

a041a28cca-+-Tools: Puppetize tips.sh

2a6b294f9f-+-Merge "ferm: move policy decisions to base::firewall" into production

60bc41269d-+-ferm: move policy decisions to base::firewall

5b10f15730-+-Fix certificate dependency

5bcd5bc4e6-+-Setup SSL terminators on the misc Varnish cluster

38053345d7-+-Merge "Include base::firewall to get default definitions" into production

bbcccfb04d-+-Include base::firewall to get default definitions

9b711b8fb9-+-Merge "Firewall GitBlit HTTP port 8080 from the outside world" into production

58218bfe6b-+-ferm: don't automatically add semicolons

b8a2dd2a3d-+-Firewall GitBlit HTTP port 8080 from the outside world

feeb9a064c-+-Add an initial ferm module & base::firewall class

949c691730-+-Merge "Turn down elasticsearch heap usage in production." into production

c3367f31c0-+-Remove iptables stuff

32c8f3ed7d-+-Remove protocol parameter, doesn't exist

028c4b2963-+-Bind GitBlit http service to all interfaces, shield off with iptables

ad443544ab-+-Add IPv4 mapped IPv6 address to sodium

a8ad56960c-+-Correct gitblit file modes

a0684f3f8a-+-Merge "Fix typo" into production

26b53269b9-+-Fix typo

8dc02cc0ba-+-Merge "Connect to gitblit directly, don't run the default VCL for gitblit" into production

a890b229b0-+-Connect to gitblit directly, don't run the default VCL for gitblit

3cfa8881f3-+-Merge "Configure the misc varnish cluster for gitblit" into production

bdfb966706-+-Configure the misc varnish cluster for gitblit

eebd244a77-+-Merge "Set memory_storage_size for the misc cluster" into production

35ca7952ae-+-Set memory_storage_size for the misc cluster

c560e711f0-+-Also disallow blobdiff from indexing

5730870907-+-Merge "Correct LVS service IP name" into production

1d46bb8ffd-+-Correct LVS service IP name

805ca67f74-+-Turn down elasticsearch heap usage in production.

75b1be7ca8-+-Merge "Decommission cp1041-1044" into production

353b1fdb47-+-Merge "Install cp1043/1044 as misc varnish servers" into production

c388594092-+-Merge "Rename role::cache::ssl::text to ssl::unified" into production

412e8a7753-+-Decommission cp1041-1044

c3f3abc1ab-+-Install cp1043/1044 as misc varnish servers

58b631c8dd-+-Rename role::cache::ssl::text to ssl::unified

0deb66bdc5-+-Merge "Setup a misc services varnish cluster" into production

b6a6bd11fd-+-Merge "contint: python dependency for publish-console.py" into production

254d32a3e1-+-Revert "Fixed the path to icinga cmd file all around +file"

732e65cc2f-+-icinga needs logrotate

671178f54d-+-Replicate varnishkafka to a custom destination

4da97bf4cd-+-Setup a misc services varnish cluster

5ffcc205ec-+-cron jobs for otrs

5071ef1473-+-move otrs homedir from /opt/otrs-home to /var/lib/otrs

0f53587c4e-+-Remove obsolete backup stuff

bc1999cac4-+-Merge "svn::server: remove some unused packages" into production

679be6ad87-+-svn::server: remove some unused packages

58da12c262-+-Merge "Rename 'redis.py' to 'redis_monitoring.py' to avoid conflict" into production

afeca0cb7c-+-EventLogging: Specify 'raw=1' in raw logger input stream URIs

4f12521430-+-change shell for user otrs

5086125707-+-fix ensure typo in dump gluster rsync

0d788502cc-+-fix rsync dup package declaration in mirror.pp/download.pp

5a9ce3dc15-+-puppetize and enable production xml dumps rsync to gluster public labs share

cd7f2e0b51-+-re-enable rsync between dump servers

52434beefb-+-wikivoyage-lb using text-varnish so updated checks accordingly (rt 5581)

75c45619f3-+-fix shell for otrs user

31ca0bb397-+-temporarily turn off rsync of dumps between dump servers

8314eff9e7-+-Tools: Enable Ganglia monitoring for Exim

abfa6c1d56-+-don't spamassassin filter at exim for otrs

d5d17aa5bd-+-enable_external_mail for role::otrs

ddeb0e1417-+-site.pp: making search node defs more strict

acac169fda-+-adding testsearch1001-1003 to site.pp

390260967d-+-more exim4.conf template tweaks for otrs

b79942e3bb-+-tweak exim.conf.SMTP_IMAP_MM.erb for otrs

56a045794c-+-remove unneeded exim4.otrs.erb, tweak exim4.conf.SMTP_IMAP_MM.erb for otrs transport

a2752c1d59-+-passwords::exim4 != passwords::exim

627769552a-+-include passwords::exim4 in exim::smtp

81ecd69269-+-merge otrs classes into one, add nrpe since mail::roled breaks without it

8686b8e800-+-Tools: Enable Ganglia monitoring for Redis

0789712a8d-+-finish parameterizing spamassassin, change exim::roled to depend on it without defining it

6af5f07ad2-+-Merge "switch to exim::roled for otrs server" into production

e9aac1bcb8-+-switch to exim::roled for otrs server

1f68c55db3-+-Ganglia: increase tmpfs size from 3G to 4G

afbd6aa451-+-Add Text caches eqiad cluster to Ganglia

e5305f849d-+-Move wikivoyage from the text to the text-varnish LVS group

301504fa1c-+-Rename 'redis.py' to 'redis_monitoring.py' to avoid conflict

709ad92fc2-+-Merge "Add nginx service to labsproxy" into production

5338e771a7-+-Add nginx service to labsproxy

3b578bf6d2-+-Merge "Add labsproxy module for replacing instanceproxy" into production

44d67f2eb6-+-Merge "Add golang compiler / runtime environment to toollabs" into production

57fdae9916-+-Add golang compiler / runtime environment to toollabs

7da1475baf-+-Disable MONITOR command for tools redis

0e4c006bc8-+-Merge "Grid Engine: Link to accounting instead of pulling it" into production

1d6998d52b-+-back out otrs exim4 changes

3a84b06a04-+-more fighting with puppet re. exim variables

d754152a6b-+-fight with puppet re. exim variables

59e4c8e77c-+-Add labsproxy module for replacing instanceproxy

0be946cc97-+-fix use of systemuser

f6f458bab0-+-parameterize spamassassin and use it in role::otrs::mailserver

0c241324f4-+-Grid Engine: Link to accounting instead of pulling it

f9327f6b22-+-grr exim4 != exim

c47eda5c2a-+-Merge "Rm dupe I accidentally created" into production

894b13b3dc-+-Rm dupe I accidentally created

1485fe83bf-+-Merge "otrs gets spamassassin, otrs system user" into production

771da0abfb-+-otrs gets spamassassin, otrs system user

6bcc5a4c87-+-Merge "Update my SSH key" into production

101da102c4-+-more exim config for otrs

8fe08783f1-+-Merge "Provide reviewer counts per patch" into production

46e702e7e7-+-Update my SSH key

e58788e5e1-+-Merge "remove erroneous class call" into production

67b880811d-+-remove erroneous class call

70d383ac83-+-removing colby bellin and blondel entries

275bc4653f-+-Merge "fix class name otrs --> role::otrs" into production

1958b93a8e-+-fix class name otrs --> role::otrs

330f95a7a4-+-Merge "role::nova: package[] -> Package[]" into production

fc119bfca6-+-start puppetizing otrs exim config

7a4fd5c764-+-add needed directory for RT-Shredder plugin to reactivate it (RT #5534)

09ea16e66f-+-Access to stat1 for Kenan Wang.  RT 5520

080cd0a657-+-Add initial classes for dynamic http routing instance in labs

dad0a260af-+-fix OTRS apache vhost, enable ssl for iodine

f03c5751c1-+-iodine switching from webserver::apache2 to webserver::apache

b01960572a-+-add webserver::apache to iodine

eb82b99772-+-Fixing syntax error that broke puppet

5a6a913a57-+-Fix syntax error

74dadc0a3a-+-remove duplicate package in role::otrs

881a15fdaf-+-add role::otrs::webserver to iodine

e13932a0c8-+-new manifest for otrs role

bb3885c376-+-Merge "rt: package[] -> Package[]" into production

6befe939a8-+-adding ssl1007-9 to node

41a9bf2aae-+-Replicating operations/puppet/kafka to github wikimedia/puppet-kafka

6b3a0c4823-+-fixing lvs1001's public-c-eqiad vlan ip

7e9ba4437a-+-Merge "Add hack for using qcow2 ephemeral base images" into production

a91c70446d-+-Merge "Forgot to add Toby to admins::restricted.  RT 5391" into production

c572838a54-+-Add hack for using qcow2 ephemeral base images

72697b8189-+-Forgot to add Toby to admins::restricted.  RT 5391

3df3fafc6d-+-Add a global redis_maxmemory to configure maxmemory of redis instance

03f01892ff-+-Adding account for Subramanya Sastry and adding to admins::parsoid.  RT 5512

040cbbb4dd-+-Adding admins.pp class for Toby Negrin.  RT 5391

39c7f51a68-+-mediawiki_singlenode: exec[] -> Exec[]

c2e434f189-+-role::nova: package[] -> Package[]

eff54d893c-+-generic::mysql::server: exec[] -> Exec[]

654bbe0eb8-+-rt: package[] -> Package[]

2c12aa8569-+-Remove obsolete ubuntu dist version check

3820638675-+-Cleanup, migrate the remaining interface_* stuff out of generic-definitions

332aad6fc8-+-Migrate interface_tun6to4 to interface::tun6to4

6f33613df1-+-Migrate interface_aggregate to interface::aggregate

f6f55ecae5-+-Correct interface::aggregate definition name

e2fce70a04-+-Test interface::aggregate

7799b3d89e-+-Migrate interface_tagged to interface::tagged

37e1d835a9-+-Test interface::tagged

2a3856b5b6-+-Migrate interface_ip to interface::ip

2ccda61698-+-Test interface::ip

d9ac68e8bf-+-Migrate interface_manual to interface::manual

3c78f2927d-+-Migrate all uses to interface::offload, remove old definitions

95f1b4b75d-+-Test interface::offload

e2db11ac51-+-Migrate all uses to interface::add_ip6_mapped, remove old definition

234dfb1ce5-+-Rename ::interface to ::interface::ip

11da42aad1-+-Test add_ip6_mapped in the new interface module

2d72b55b0c-+-Merge "Re-write of MongoDB module" into production

aafebd7374-+-Provide reviewer counts per patch

eabdb474f8-+-Merge "Add python bindings for zeromq to toollabs" into production

c399d7fbe0-+-Add python bindings for zeromq to toollabs

322fa0f19c-+-also adding chad to ES hardware test boxes

968e04416a-+-beta: phase out shell autoupdater

9a39f008b1-+-rewrite beta autoupdater in python

43aa7e9266-+-Don't use absolute URIs for purging

35e24ba005-+-Don't use absolute URIs for purging

c8c521e11a-+-Merge "disable updatequerypages cron on hume, instead enable on new maintenance host terbium" into production

0de139478f-+-disable updatequerypages cron on hume, instead enable on new maintenance host terbium

37c1aa9ab4-+-Merge "let misc::maintenance::updatequerypages use $enabled like the other maintenance jobs, avoid puppet breakage due to Invalid parameter enabled when trying to use $enabled in site.pp" into production

8683a36ef7-+-let misc::maintenance::updatequerypages use $enabled like the other maintenance jobs, avoid puppet breakage due to Invalid parameter enabled when trying to use $enabled in site.pp

646de52849-+-Merge "style for zuul.pp" into production

9788a72893-+-style for zuul.pp

3903e0fffc-+-(bug 15434) Periodical run of currently disabled special pages

118b6e8be0-+-removing $svnkey entries and fixing style errors

0bc33d6182-+-Fixed the path to icinga cmd file all around +file

9caf0b7ff9-+-Merge "style for beta.pp role" into production

3a6dee4b08-+-Merge "gitconfig::user to easily craft .gitconfig user files" into production

f541246e00-+-gitconfig::user to easily craft .gitconfig user files

aaa59ad09d-+-Introducing bacula module

097f0f9c43-+-Add accounts::tstarling to Locke

d3659d55e6-+-Include standard-noexim in role::fundraising::civicrm

303a1e6303-+-Reconcile aluminium with standard-noexim.

99b62babeb-+-Remove payment nodes from site.pp

fef1043883-+-Revert "admins.pp - tabs -> spaces & alignment."

929ef56d26-+-Revert "Ordering admins user classes by uid."

b57e06a48b-+-Ordering admins user classes by uid.

4af9d073a8-+-admins.pp - tabs -> spaces & alignment.

0c2f49d9f1-+-Create an 'interface' module.

c1b94fab9f-+-Merge "style for ipv6relay.pp" into production

657494eff2-+-Merge "cleanup rspec fixtures" into production

e290600776-+-Merge "define ishmael_config() parameters lacked dollar signs" into production

4c61749fcc-+-style for ipv6relay.pp

8e2d8f9ac0-+-cleanup rspec fixtures

c7c656e197-+-define ishmael_config() parameters lacked dollar signs

77dac6e4d3-+-Support modularized private repo.

c7fe4927fd-+-actually get the option right for imagescaler tmp cleanup cron

0ad42ea5e0-+-add vips cruft to imagescaler cron cleanup of /tmp

de9e010831-+-add the svg cruft to the imagescaler cron job that cleans up /tmp

f3a76cbd34-+-Fix XFF handling on all Varnish clusters

2cf90500ef-+-Merge "Give labs elasticsearch better heap." into production

cb34211a04-+-Give labs elasticsearch better heap.

cbf56f1bc4-+-prepare wmf-beta-autoupdate to be launched by Jenkins

2980e5d491-+-style for beta.pp role

ae908d3f6c-+-Merge "remove non-root users from kaulen since it's not used as download server" into production

7678f5c94f-+-removing andrew's old key

e3a60beaa7-+-remove non-root users from kaulen since it's not used as download server

3da10014bd-+-beta: syslog-ng on deployment-bastion host

a70067ac40-+-Merge "Icinga check for host's presence in needed dsh groups" into production

401e2aae3e-+-Merge "Update my SSH key (user 'olivneh')" into production

ac8a6bae22-+-Update my SSH key (user 'olivneh')

654669db81-+-Creating account on stat1 and stat1001 for qchris. RT 5474

7ec89c7038-+-Icinga check for host's presence in needed dsh groups

318c9702f1-+-always collect ssh keys on tin (no more on fenari)

07705c0335-+-Merge "Don't install the Ganglia Apache plugin for now" into production

88cf30a2de-+-Re-write of MongoDB module

9f866900e7-+-including monitoring class

7d646834c3-+-Merge "also include wikidev group" into production

e2ec1006c6-+-also include wikidev group

842ad084f0-+-fix install path for updateinterwikicache

005fe19b86-+-grabbing 4 pmtpa mw boxes for ES testing

7112a9f443-+-remove db1008, it has moved to frack

54f54c0f4f-+-ensure => directory on GlusterFS log dir

68af277727-+-removing unused enwikijobqueue check

ea935a5421-+-Don't install the Ganglia Apache plugin for now

dfe2b2487d-+-Install amssq47 as an SSL relay

a27d9eaf9c-+-Setup NGINX for HTTPS on the Varnish servers

fbea6f84d2-+-Merge "Add a lean definition (and custom template) for SSL proxies to localhost" into production

7716097cb8-+-Fixing another typo

2e6b63f2c1-+-Fixing typo

7faab93ae2-+-Running geowiki-process-data cron daily

051e229dfb-+-Adding misc::statistics::geowiki

e03b56eff2-+-filter and collector might show more processses than 1

fcc47ae7f1-+-contint: python dependency for publish-console.py

533db31155-+-fix system_role for role::protoproxy::ssl::beta

2e2ca63155-+-Fix syntax error in elasticsearch.

da981553b7-+-creates role::ci::{master,slave,website}

c6fb360eec-+-radosgw: don't print 100 Continue

febddb1bc1-+-phase out misc::contint::test::packages

09d4031c21-+-Don't attempt to send beta labs errors/fatals to vanadium

2baf8e83d3-+-getting rid of nagios.wikimedia.org trap

db47a33103-+-Puppetizing analytics1017 as hadoop worker

6d3f257991-+-Adding process icinga nrpe check for webstats collector and filter processes

83559fab41-+-derp. this obviously needs to be a nrpe check

56b9d83d1c-+-move jobqueue check from neon to hume/terbium

755cbeddcc-+-Add a lean definition (and custom template) for SSL proxies to localhost

948405bf12-+-Fix typo, files -> file

85658da84d-+-contint: logs directory to hold Jenkins console logs

c2d910535f-+-Putting erbium in ganglia udp2log view

12182bac6f-+-Merge "get rid of varnishhtcpd upstart job" into production

7e6bcc37d0-+-Merge "get rid of varnishhtcpd upstart job" into production

5da938ccff-+-get rid of varnishhtcpd upstart job

7ecd22764d-+-get rid of varnishhtcpd upstart job

6923e78365-+-Merge "Fix indentation" into production

e3bfb50b1c-+-Fix indentation

d7c95c2b07-+-Including fundraising::udp2log_rotation and accounts::file_mover on erbium.

336bdfd786-+-Virt0 puppet symlinks should point to /root/testrepo/*

b25c114936-+-Install extra VCL files before starting Varnish

2c56fff8b8-+-Generate ganglia plugin conf after starting Varnish

f6bb23a384-+-Remove install of (no longer existing) varnish 3.0.3plus~rc1-wm13 package

921c1f2d08-+-re-enable rsync dumps cron job between dataset hosts

87c5727e27-+-Merge "varnish: backends trust 127.0.0.1 for XFF" into production

c3b80698a2-+-fixing wikidata-lb monitoring ip address

8a74a9f553-+-Merge "Add ssl1005/6 config" into production

534bb2a64a-+-Fixing multi instance hostname issue

0786cf8dc3-+-Add ssl1005/6 config

1c441dd5d7-+-Supporting both short hostnames and fqdn for labs role::puppet::self

4142819fa5-+-Merge "Allow spiders to index gerrit again" into production

29e32d8371-+-Merge "Remove gitweb, we don't use it anymore" into production

3a3a592402-+-Symlinking dclass shared object files into /usr/lib

2f0e6ee8b6-+-Installing libdclass-java on analytics nodes

32e511ea65-+-snapshots with precise get mwbzutils package

33350f8be4-+-what was I thinking. dump servers don't need mwbzutils.

e13d237fe6-+-mwbzutils package for precise snapshots, don't use 'latest' for packages

e2e84e52bd-+-Replace uses of generic::sysctl with sysctlfile module

dfc353e5dd-+-turn off rsync cron for dumps temporarily

71f0544542-+-jenkins: revert access log rotation

e782faa767-+-contint: explicitly require php5-dev

e9886a5e31-+-jenkins: logrotate access.log

4819beee48-+-varnish: backends trust 127.0.0.1 for XFF

f13122f206-+-Add new ns0/ns1 service IPs to dobson & linne

9cac225cf8-+-Undecom cp104[1234]

c58f25bb42-+-Workaround fallout from sysctlfile

368a24dd90-+-(power)dns: support multiple listen addresses

3ee06d5c63-+-Move /etc/puppet symlinks back to a normal place on virt0

29d7e6df8c-+-Merge "Adding role::analytics::hue" into production

90b5022ded-+-Merge "Use the correct Varnish backends" into production

74705845a0-+-Use the correct Varnish backends

21577e8a4a-+-Fix typo, files -> file

287de61933-+-Install extra VCL files before starting Varnish

246c2d3e6a-+-Generate ganglia plugin conf after starting Varnish

00a456a810-+-Install new servers as Text Varnish caches

e4a3a63572-+-Adding role::analytics::hue

ece8b2dcc2-+-On the labs puppetmaster, link to labs private repo

f42c0eeec0-+-Merge "Use grains for deployment targets" into production

f481bcdcdf-+-removing spence from site.pp

3a14fa90b1-+-Use grains for deployment targets

8087d76c94-+-Fix several issues with gitpuppet's keypair

05ad4ac39b-+-Block spiders from indexing archives

ea965e6969-+-Merge "Make config file depend on elasticsearch package." into production

56c3ea2914-+-Make config file depend on elasticsearch package.

a39c8c5bc7-+-Link private repo to /etc/private

efad315ddc-+-Use su instead of sudo

efbb4de745-+-Don't use group 'gitpuppet'

21da3e5d79-+-Move puppet templatedir again.

b978c0125f-+-Move the puppetmaster private link yet again.

93def394e5-+-Actually include gitpuppet class.

4f6fcb4d53-+-Simplify our puppet master setup.

2eea25db54-+-Merge "Add elasticsearch module and role." into production

41ecca97ca-+-Don't need filter dir on erbium

c337b63d7b-+-Using webrequest_log_directory as base erbium udp2log log_directory

732cf1f9a5-+-role/logging.pp: tabs -> spaces

f766ecebd4-+-Fixing location of packet-loss.log on erbium

f85fd4295b-+-erbium is internal name, not .wikimedia.org

40175db03e-+-Add elasticsearch module and role.

7f2da54ec2-+-Merge "Adding init script for gitblit" into production

e257318c36-+-Adding init script for gitblit

7bbcc57996-+-Big ol' commit prepping for erbium udp2log instance.

87e5cd329c-+-flip db1008 to fundraisingdb slave, remove references to db1013

1cb9dd66dc-+-adding zinc as rtt solr host

b8bea91ddb-+-Need webrequest_filter_directory

9862e24f00-+-Need role::cache::configuration class in oxygen logging role

0920e47bcb-+-Moving as many easy filters to oxygen.  gadolinium's socat process is dropping packets with udp2log running.

7856880b2b-+-admin::roots is plural (for lanthanum)

6e6fec1f62-+-Merge "lanthanum as a jenkins slave" into production

9193fd1d87-+-lanthanum as a jenkins slave

7e8466ede0-+-Add (and re-organize) TCL packages for giftpflanze

60cf6f14a7-+-Replace generic::sysctl::lvs

f96f61181f-+-Renaming role::analytics::kraken to role::analytics::common

d937e8c3d1-+-Adding role::analytics::kraken for common kraken client classes

12572aa31d-+-Replace generic::sysctl::ipv6-disable-ra

7fc6d2c58b-+-Replace generic::sysctl::high-bandwidth-rsync

00578f702f-+-Merge "Use the sysctlfile module in base::sysctl." into production

24614d3c50-+-Merge "Use the sysctlfile module in udp2log::sysctl." into production

ba66946ecf-+-Merge "Clean-up of 'eventlogging::monitor' class." into production

44cf18bad8-+-Clean-up of 'eventlogging::monitor' class.

9735d6eb09-+-Replace generic::sysctl::advanced-routing-ipv6

cbfcb67fbd-+-Use the sysctlfile module in udp2log::sysctl.

339d7d67a0-+-Use the sysctlfile module in base::sysctl.

761e872422-+-Replace generic::sysctl::advanced-routing

2e1f163df6-+-Allow spiders to index gerrit again

42cb698f2d-+-Remove gitweb, we don't use it anymore

1e5e7b2020-+-Added notify => Exec["/sbin/start procps"]

f730101b56-+-Kill current gerrit-wm since gerrit-wm's replacement is ready

c074a78d3f-+-Merge "Revert "virt1007 is new aggregator"" into production

700703ac0e-+-Revert "virt1007 is new aggregator"

53043d2b20-+-Merge "Add sysctlfile module and one use case." into production

5b2352ba6d-+-Merge "Use the apache module for mediawiki_singlenode" into production

6ae274a50c-+-Remove 'eventlogging::archive' class.

63a2043318-+-Fix typo in variable name ('ipython_dir' => 'ipythondir')

7086a06384-+-Merge "virt1007 is new aggregator" into production

f92f562316-+-virt1007 is new aggregator

aaded9160a-+-Use the apache module for mediawiki_singlenode

9a67777aab-+-Install Lua on toollabs

ef38d05f5d-+-Add eventlogging::plugin custom resource type

b25de3098b-+-Clean-up: port 'analysis' class to a role class.

c0446c200e-+-moving tfinc from roots to mortals per rt 5485

d04c22f959-+-Merge "Set upload backend default cache TTL to 30d" into production

392f327c36-+-Set upload backend default cache TTL to 30d

3922589b52-+-Merge "Set a default 30d cache ttl on text" into production

dd539ebce4-+-Set a default 30d cache ttl on text

7c3238409a-+-setting bastions domains search & descriptions

e2a0dee4ce-+-Installing java on stat1002

4dbb0a53b7-+-Merge "Granting Christian access to privatedata on stat1002.  RT 5467" into production

742b409fea-+-Granting Christian access to privatedata on stat1002.  RT 5467

d645c9ebe9-+-Split off wikidata into a separate LVS service 'text-varnish'

ad76be1226-+-Merge "Expand documentation of EventLogging module" into production

698135b847-+-Remove paging ms-fe.eqiad.wmnet check

f90adc7b19-+-Expand documentation of EventLogging module

4823d92fed-+-Bind memcached to 127.0.0.1 on openstackmanager nodes

e9365d9f40-+-Use double quotes where dereferencing is needed

7666944946-+-Call apt-get update after adding a new apt repo

6d451e4a07-+-Add sysctlfile module and one use case.

8899591ada-+-Add sysctlfile module and one use case.

ece9db3021-+-Revert "Call apt-get update after adding a new apt repo"

872bdf719f-+-Several minor changes to the openstack manifest (take two):

42dd3408f1-+-Call apt-get update after adding a new apt repo

24695460b4-+-Including role::cache::configuration for gadolinium mobile filter

4827832987-+-Merge "Adding role/analytics/oozie.pp" into production

972963e027-+-Adding role/analytics/oozie.pp

3afdf92194-+-Merge "Add WikibaseDataModel dependency for wikidata singlenode" into production

188598e519-+-Add redis libraries for perl

0cbac1ef61-+-Remove some redundant packages that are included as deps of others

2b6fdee23d-+-Merge "role/analytics/hive.pp - fixing password variable name" into production

9cea4b5476-+-role/analytics/hive.pp - fixing password variable name

d252b805bf-+-Detabify some files (in prevision of real changes)

6832fb35d9-+-Tool Labs: Exec environ needs uwsgi for vassals

74463e476e-+-Remove the LVS service 'dns_auth'

9fa20711d0-+-Revert "Split off wikidata into a separate LVS service 'text-varnish'"

45ec46df73-+-Split off wikidata into a separate LVS service 'text-varnish'

8e11dcd8fb-+-Revert "Split off wikidata into a separate LVS service 'text-varnish'"

e6539ddc52-+-Split off wikidata into a separate LVS service 'text-varnish'

e4d5bfafc6-+-Salt: Fix parameter used to add a key via grain-ensure

8812807f85-+-Make role::eventlogging realm-aware

3f76d7c06d-+-Merge "adding virt0 and virt1000 as ganglia agregators" into production

38d68514fb-+-adding virt0 and virt1000 as ganglia agregators

a9b40f09c8-+-Document 'eventlogging' role

6550ef89da-+-enabling virt1005 and virt1007 as ganglia aggregators

8c3175d51e-+-Merge "Remove uses of the 'firewall' module." into production

d3c91dc708-+-Add LVS monitoring for mobile in esams

85257334d5-+-Add mobile caches esams group to gmetad

58dd4adcf9-+-Add WikibaseDataModel dependency for wikidata singlenode

e987c25786-+-app servers should have php-mail and php-mail-mime for Echo (rt 5338)

fa882b3de3-+-Target pillars and states by grain

2da60ef78a-+-Add sync_hook_link back in for eventlogging

0a22a60a6b-+-Add 'fluoride' git-deploy target.

3a90b1cd4c-+-Merge "Ensure /srv/deployment's group is wikidev" into production

c3c4f3526c-+-Ensure /srv/deployment's group is wikidev

63bf96ee31-+-Merge "s/latest/present/g" into production

a851845abc-+-Drop unsupported write concern parameter from MongoDB URI

e4ac5ab8a7-+-Fix socket ID handling in EventLogging module

cf79c974e9-+-Remove 'mediawiki_errors' class & related files

1f5882b630-+-vanadium: role::logging::eventlogging -> role::eventlogging

51377a2c83-+-Merge "Rewrite of EventLogging module" into production

30d72d0226-+-Adam Baso access on stat1002.  RT 5446

5da67ecb56-+-Adding spetrea to admins::restricted so he has an account on bastion hosts.

e3743967ac-+-remove classes from decommissioned fundraising servers

414c390188-+-Merge "rt 5403 qchris member of restricted for bastion access" into production

e914628d26-+-Merge "Catch tests up with local changes to this module." into production

a9818b204e-+-rt 5403 qchris member of restricted for bastion access

e294ebae5e-+-remove three hosts that were moved to frack puppet

d0bb66fbe6-+-Rewrite of EventLogging module

772a8b4c98-+-Using logrotate_udp2log_analytics.erb for analytics udp2log instances

f206c8a5a6-+-Adding logrotate_template parameter to udp2log::instance

32aae53ec0-+-Removing special treatment of packet-loss.log on analytics udp2log instances.

f69745c1fd-+-Replicate analytics/kraken to kraken on github

3d0e187b4f-+-Replicating operations/puppet/zookeeper to githubc.om/wikimedia/puppet-zookeeper

8df1d58f9b-+-gerrit.pp alignment and s/"/'/g change.

701fdfb529-+-Adding github replication to for jmxtrans  to wikimedia/puppet-jmxtrans

b3a252f7f2-+-Catch tests up with local changes to this module.

3943687810-+-Merge "zirconium apache - fix wrong path to ssl key" into production

0c05eeadab-+-zirconium apache - fix wrong path to ssl key

6d8da7bbde-+-Merge "same for etherpad db_host, db_name" into production

b94d313e74-+-same for etherpad db_host, db_name

da3968af56-+-Merge "add missing $etherpad_db_user after adding it to private repo. the user doesn't have actual grants yet but breaks if it doesn't exist" into production

7cfad0a16c-+-add missing $etherpad_db_user after adding it to private repo. the user doesn't have actual grants yet but breaks if it doesn't exist

9dc7a448a5-+-Merge "comment/FIXME duplicate apache definition when combining classes on a single node" into production

8b724ae8b4-+-comment/FIXME duplicate apache definition when combining classes on a single node

aa435edf2a-+-Merge "comment another apache module for duplicate definition, add FIXME" into production

4fccc1c3a4-+-Remove uses of the 'firewall' module.

2e32754170-+-Add packages to the jenkins slave for puppet rspec.

9bcfe53011-+-Labs: Create /etc/wmflabs-project

d9186db3e8-+-EventLogging module: tabs -> spaces; no significant changes.

3103c6b9a9-+-comment another apache module for duplicate definition, add FIXME

711fe7bed6-+-add comment to srv193 that test has been switched to mw1017

6fdd1032ab-+-Merge "comment mod_rewrite to quick fix duplicate definition when using with another class defining the same" into production

334cdf1804-+-comment mod_rewrite to quick fix duplicate definition when using with another class defining the same

ab73fdba92-+-Merge "set variables for etherpad_lite as suggested in labs docs" into production

c0961db898-+-set variables for etherpad_lite as suggested in labs docs

f9d5d66187-+-if creating /home/mwdeploy/refreshlinks dir, also better create /home/mwdeploy

31daa56d2b-+-moving misc::maintenance::refreshlinks to eqiad.

ceb77a96f9-+-Switch testwiki to mw1017 in Varnish too

ad710406af-+-moving misc::maintenance::update_flaggedrev_stats and misc::maintenance::geodata to eqiad

5c9ca167b1-+-Merge "webserver::apache2 and webserver::php5 are conflicting, can't use both on one node, and we already got the webserver from planet role. This should be separate from web apps." into production

fe7f74f861-+-Some slight restructuring of analytics role classes to adapt for hive server role.

44a5235cd4-+-webserver::apache2 and webserver::php5 are conflicting, can't use both on one node, and we already got the webserver from planet role. This should be separate from web apps.

e72db8bcda-+-Merge "do not remove the Apache 000-default page in here because that is already done in webserver.pp and causes a duplicate definition" into production

e4fe4f3d93-+-do not remove the Apache 000-default page in here because that is already done in webserver.pp and causes a duplicate definition

7ff63ca5b9-+-Merge "environment change for ganglia-conf.py" into production

430c424041-+-environment change for ganglia-conf.py

38af84fc7a-+-s/latest/present/g

2d0bf5488d-+-Merge "use misc::etherpad_lite instead of misc::etherpad on zirconium" into production

5246d1d321-+-replacing dupe mc8 with mc9

70722e6234-+-use misc::etherpad_lite instead of misc::etherpad on zirconium

26c61f5b3e-+-Merge "update to adding mc1-16 to decom.pp" into production

eaebe926be-+-update to adding mc1-16 to decom.pp

208f601d80-+-chamge the title for cmjohnson's new ssh key to avoid dup def issue

4d652d30a8-+-Changing hostname for labs zk

b8351e42a0-+-replace prod ssh key for cmjohnson (rt 5448)

f26edc4662-+-Set wikidata/wikivoyage checks non-critical

d0a93519d7-+-Add monitoring of esams wikidata/wikivoyage LVS services

689b2587d7-+-Rename Varnish storage files for consistency

669df5d167-+-Maintain persistent connections on text cluster redirects

b82cdfac0a-+-use misc::etherpad on zirconium to verify it works, not changing db or DNS yet

71342e2a16-+-Rsyncing zero*.gz to relevant stat servers

147640365e-+-Rsyncing public-datasets to stat1001 every 30 minutes

60946ffa9b-+-require percona toolkit on deployment servers

4984cd068c-+-Don't want to ensure that mounts exist.

9ca9c2e40d-+-Merge "adding spence back to site.pp" into production

27394d0b82-+-adding spence back to site.pp

936e0b8afc-+-Fixing ensure

c0c94d8ff1-+-Ensuring datanode_mounts are created in labs hadoop puppetization.

91ead1c606-+-Allowing configuration of namenode_hostname via $:hadoop_namenode global variable in labs role

880cfc5a9d-+-Ensuring /var/lib/hadoop exists in labs kraken cdh4 puppetization

7b7fce8cf9-+-Merge "decommissioning and removing spence" into production

499a602ad7-+-Merge "Increase Parsoid backend timeout to 5 minutes" into production

207f45c835-+-Increase Parsoid backend timeout to 5 minutes

d1a6a5df17-+-decommissioning and removing spence

7c43dd630f-+-Selecting proper metric in Ganglia kafka view

4863d6b77a-+-Fixing dmax on jmxtrans

498cb5333f-+-Puppetizing jmxtrans for analytics udp2log kafka producers

80e9699f8c-+-Fixing kafka producer process nrpe check on analytics1008

99efb58992-+-Installing nrpe::monitor_service for Kafka producer processes

f5f75ee414-+-Merge "get rid of GlusterFS on deployment-prep labs project" into production

4d8bf11b04-+-get rid of GlusterFS on deployment-prep labs project

abfe0ede40-+-Adding icinga alerts for per topic kafka producers

db6dc73c59-+-Merge "Remove the now unused generic::rsyncd" into production

769fa00151-+-Fixing application of udp2log roles on proper hosts

da5851155a-+-Puppetizing analytics udp2log instances

d1d7f03a5f-+-Fixing copy/paste error in admins.pp

21d9bcbe67-+-Adding Christian Aistleitner account on analytics nodes.  RT 5403

9938c857f5-+-remove misc::download-mediawiki from kaulen because it's either supposed to be on swift or on a new download host in eqiad, but not on the bugzilla server and not in Tampa and it wasn't used anyways. just added download.mediawiki.org to Apache conf so that at least it wasn't just showing an empty directory on kaulen but redirects to mediawiki.org

6619620331-+-move all misc::bugzilla::* to role/bugzilla.pp, less includes in site.pp

7ae19cda51-+-remove the mysql module stuff from fundraising role class

2ceca67b6d-+-grrr.

1a3adfd4f3-+-continuing to fail with mysql module

70a3f782ed-+-another try at fundraisingdb my.cnf via mysql module

7fdbc4408f-+-making icinga reload instead of restart on new confs

4bb533f5b6-+-Adding ezachte and spetrea to stats group on stat1002

5c216384f9-+-add misc::bugzilla::auditlog to kaulen

d06409b240-+-add a script and cron to mail out bugzilla audit log and move bugzilla scripts to files/bugzilla instead of misc

329f8f0d8d-+-Merge "Convert the udp2log rsyncd to use the rsyncd module." into production

043d78f4cf-+-Merge "Convert the nfs rsyncd to the new rsync module." into production

928f025e6a-+-Merge "Convert scap's rsyncd to the new rsync module." into production

6e5c8b499a-+-Merge "Remove misc::deployment::scap_proxy as it appears unused." into production

4338a77f1c-+-Merge "Convert the search rsyncd to the new rsync module." into production

49e2d2a392-+-beta: do not use git-deploy

0134e5bf47-+-activate rsync from dataset1001 to dataset2 of dumps run there

6b2728e4d0-+-slight myisam tuning for labsdbs, enable xtradb's innodb_kill_idle_transaction feature

e73272a660-+-revert didn't do what I expected...

2acfe95f95-+-try setting some variables in my.cnf for fundraising db

82bbadab0a-+-test mysql module my.cnf creation for fundraisingdb take 3

bc3b2a72b8-+-Merge "gerrit-wm: pywikibot/* events to #pywikipediabot" into production

0f9ae10370-+-Fixing param day => weekday

dcf61ce8e2-+-Added cronjob for new mobile pageviews

a21b0ae22a-+-including misc::statistics::wikistats in role::statistics::private.

896bb03e11-+-Installing perl packages for wikistats dependencies

a6fa998f21-+-Merge "changed colors for root prompt, red on production, green on beta" into production

af32eec6eb-+-Tool Labs: Tyrant role, and minimal class config

6d2700f85a-+-Merge "Tool Labs: Add the tyrant class, properly" into production

40ba98e381-+-Remove the now unused generic::rsyncd

d1d8bf3c1c-+-Convert the udp2log rsyncd to use the rsyncd module.

af43860add-+-Convert the nfs rsyncd to the new rsync module.

654c35abd4-+-Convert scap's rsyncd to the new rsync module.

f6841ce693-+-Remove misc::deployment::scap_proxy as it appears unused.

938db94fd2-+-Convert the search rsyncd to the new rsync module.

2a05495f0f-+-Merge "beta: adapt role::cache::varnish::upload" into production

95699aee3c-+-beta: adapt role::cache::varnish::upload

eae5352d35-+-Tool Labs: Add the tyrant class, properly

f2bf3865db-+-Tool Labs: Skeleton puppet class for UWSGI tyrant

8b8520e9b3-+-Merge "Add secondary (fallback) IPs for wikidata/wikivoyage" into production

88b11f0359-+-Add secondary (fallback) IPs for wikidata/wikivoyage

58cd2ef2fc-+-Merge "Reenabling kafka too many produce requests icinga check." into production

a1dea049f8-+-Reenabling kafka too many produce requests icinga check.

5ab6679486-+-Enable protoproxies for wikidata/wikivoyage in esams

b062dbfce0-+-Add wikidata/wikivoyage LVS service IPs

eadc9373e9-+-Merge "contint: file perms for qunit jobs" into production

1201faf7fa-+-contint: file perms for qunit jobs

b9be6c02af-+-Merge "Add php modules installed via user request (from SAL)" into production

3ab7a49ebb-+-Remove dependency on deployment scripts from translationnotifications

e47d26bcfe-+-Re-set common rsync and dsh parameters in mw-deployment-vars

4c6cab282f-+-Merge "Revert "Adding icinga check to make sure kafka brokers aren't getting too many produce requests"" into production

2d6de45825-+-Revert "Adding icinga check to make sure kafka brokers aren't getting too many produce requests"

da0a9476c1-+-Add php modules installed via user request (from SAL)

dddcefe5eb-+-Add python modules installed via user request (from SAL)

fe70c82346-+-Add perl modules installed via user request (from SAL)

75e3774ab3-+-Arrange tool lab packages list in alphabetical order

6e626a9dc3-+-Adding icinga check to make sure kafka brokers aren't getting too many produce requests

3053828dda-+-Add php5-xsl (XSLT processor) on request from Tpt

c0542a4ef4-+-Organized the packages for exec_environ

17dbd47000-+-Pass variable $site

6a924c55f3-+-Migrate class lvs::balancer to the new PyBal module

6084fd501f-+-Create simple PyBal module

7b0c654e6f-+-Merge "Fix mobile IPv6 service IP name" into production

0eab8087d1-+-Fix mobile IPv6 service IP name

8def47cc36-+-Merge "Remove obsolete $ipv6_hosts construct" into production

1fe407da64-+-Remove obsolete $ipv6_hosts construct

629d6f62cc-+-Merge "Enable IPv6 for amslvs1 and amslvs2" into production

9a77304f05-+-Merge "Add wikidata/wikivoyage LVS IPs" into production

5478637b75-+-Enable IPv6 for amslvs1 and amslvs2

7929843f29-+-Add wikidata/wikivoyage LVS IPs

3f1b474217-+-hosts that mount /data will do so from dataset host in same datacenter

71926ce964-+-Add esams mobile HTTPS service IPs

cf375d0a90-+-Add esams mobile LVS service IPs for HTTPS

1152787365-+-enable rsync dumps cronjob for primary dataset host

5d7f226aec-+-Revert "Set common rsync and dsh parameters in mw-deployment-vars"

7eba91549a-+-Set common rsync and dsh parameters in mw-deployment-vars

78ed78069f-+-Tool Labs: New python packages for wikimetrics

21af1f6b94-+-Qualify grain-ensure exec/unless/onlyif

c635bd09e8-+-Refactor salt::grain & related tool

67e50f94e5-+-Merge "locke has been decomissioned, also restricting packet_loss_90th to main metric" into production

aabdb24e43-+-locke has been decomissioned, also restricting packet_loss_90th to main metric

92f1ff03d3-+-Merge "Restricting udp2log ganglia views to only show main packet_loss_average metric" into production

48ecc256ea-+-Restricting udp2log ganglia views to only show main packet_loss_average metric

1f5a987b26-+-Merge "Only showing 'packet_loss_average' in analytics-data view" into production

74d02dd540-+-Only showing 'packet_loss_average' in analytics-data view

4baa757a77-+-Merge "Fixing analytics::data monitoring ganglia view classname" into production

cd9cac66f3-+-Fixing analytics::data monitoring ganglia view classname

18dd035a43-+-Merge "Manually including geoip::data to ensure that proper data_directory is created" into production

9dc869d408-+-Manually including geoip::data to ensure that proper data_directory is created

234f6259f4-+-Merge "Adding an analytics-data ganglia view" into production

28da19cb9b-+-Adding an analytics-data ganglia view

9e511635fa-+-Merge "add AfterForm to RT4 to (re-)enable Password Reset feature on RT" into production

6005b4c0b4-+-Need passwords::geoip for puppetmaster::geoip

bfb916c97c-+-Fully qualifying geoip module class

249e69826d-+-Updating geoip module usage on puppetmaster

2e7d013ac4-+-Using new names for udp2log_kafka_producer metrics in Kafka ganglia view

30ca4391ce-+-Make esams upload cache storage naming consistent with the rest

848e7c9527-+-Support 'ensure => absent' in deployment::target & salt::grain

2897665b50-+-include exim::aliases::private on mchenry to puppetize mchenry alias files (class and files in private repo) RT #5358

7948bf28d3-+-add AfterForm to RT4 to (re-)enable Password Reset feature on RT

6f14d8f628-+-Merge "Replicate operations/puppet/cdh4 to puppet-cdh4 on github" into production

fdf0ae8d9c-+-Add packages for Checkwiki to toollabs's exec_environ

0fb3874bf6-+-Add mariadb-client to toollabs's exec_environ

e1791e6873-+-Fixing geoip include for statistics nodes

8bac2d0949-+-Installing git-review on stat nodes

26352b1c07-+-Move geoip to a module.

3312d2f11f-+-Cleanup

1abaef9189-+-role::cache get rid of unrecognized escape sequences

86cb9548f9-+-Give Gabriel shell on the Parsoid Varnishes again

b6e20106bf-+-Put all old varnish cache servers (temporarily) in decommission list

448bf0449c-+-Set all esams upload frontends to chash weight 100

a2d33edbee-+-Switch cp3007 and cp3008 frontends to chash weight 100

f998cdb293-+-Convert swift's rsyncd to the new rsync module.

9f7f573b90-+-Kill media-storage thumbs server

62c4f98469-+-Keep memcached memory out of swap

a2d8b4a0c0-+-let systemuser l10nupdate have bash as shell so it can run l10nupdate scripts via dsh on new mw* hosts.

fcb9722043-+-Revert "tcpircbot: IPv4 cidr instead of IPv4-mapped IPv6"

2958451d77-+-Merge "giving neon its own gmetad to reduce disk usage" into production

a5c3217b42-+-giving neon its own gmetad to reduce disk usage

2f46944887-+-Merge "Add rsvg to OpenStackManager nodes" into production

31c733867e-+-Add rsvg to OpenStackManager nodes

9014d54272-+-Set cp3006 frontend to use chash weight 100

f15f8d2cee-+-Set cp3005 frontend to use chash weight 100

ab45b47c23-+-Pass $cluster_tier to VCL

46d0cf50a4-+-Pass $default_backend to VCL

817d01a921-+-Tier 2 mobile cache backends should talk to port 3128 upstream

20f3d4e245-+-Support different backends for 1st/2nd mobile tier

389cae2695-+-Switch cp3004 frontend to use chash weight 100 as well

2c4e1054e0-+-Switch cp3003 frontend to use chash weight 100

135e52ae0d-+-Set esams backend director to chash

fcab8b9339-+-Migrate esams upload backends to use new eqiad servers as upstream

a9d6b5d446-+-Tool Labs: install libpoe-perl (user request)

a7562662d8-+-Replicate operations/puppet/cdh4 to puppet-cdh4 on github

9ce46c4055-+-Setup monitoring for Redis on toollabs

5c02d4af12-+-gerrit-wm: pywikibot/* events to #pywikipediabot

39da0df57d-+-Add Python & PHP redis client libraries to exec environs

af1047f8f2-+-Adding AsyncProducerEvents to kafka ganglia view

4f7105c805-+-Creating role::analytics::packages class, installing python-lxml package

09ae10ec7e-+-Restore parts of Andrew's changes to rsync

9bc861140a-+-contint: docroot belong to jenkins-slave now

f56ece06ee-+-Revert "Convert swift's rsyncd from generic::rsyncd to the new rsync module."

ff8051888e-+-Revert "Puppetizing /etc/init.d/rsync and /etc/default/rsync"

6f4e938815-+-Merge "Convert swift's rsyncd from generic::rsyncd to the new rsync module." into production

719983f058-+-Merge "Add support for specifying a global rsyncd log file" into production

bac8229807-+-Add an eventlogging deployment target

82a156421b-+-Add system role and deployment target for parsoid

490fc9c20c-+-Have a target class for deployment to set grain

09f48da9ab-+-Add support for adding salt grains via puppet

a6381f9bc6-+-enable site

f736c2950b-+-ishmael conf/vhost

ae6eb989cf-+-Convert swift's rsyncd from generic::rsyncd to the new rsync module.

7c11d909e9-+-Add support for specifying a global rsyncd log file

fc35e41dd0-+-Adding Adam Baso to stats group on analytics nodes

2d5853059c-+-Merge "Correct regex" into production

0a03796f8d-+-Correct regex

46f87b513c-+-Merge "Use force push when replicating gerrit repos to antimony (gitblit)" into production

a9ec0cf6fa-+-Merge "Update ganglia aggregators for bits & upload caches" into production

c73a1c95b9-+-Update ganglia aggregators for bits & upload caches

5933dc7566-+-Merge "Take advantage of hook-bugzillas new event mechanism" into production

c328057c02-+-Add the new bits servers to the $active_nodes list

d8917f5556-+-Take advantage of hook-bugzillas new event mechanism

e5baaafb49-+-Install cp1056/57, cp1069/70 as bits caches

30bf373ad4-+-Prepare the bits cache manifests for the new eqiad servers

b63678b34c-+-remove stale comments from fundraising.pp

2a7eb484a1-+-pcoombe access to aluminium/grosley per RT #5280

75d56c4dc1-+-Revert "Point the Parsoid cache in labs to parsoid-spof rather than deployment-parsoid2"

c1ee90ef4a-+-new >= 2048 bit key for sahar

86b49a4dc6-+-Dysprosium is part of the "old" cluster

62d0e3992f-+-Merge "zuul: craft a publicly readeable configuration file" into production

d5b35cedca-+-zuul: craft a publicly readeable configuration file

3a308fc365-+-Revert "Revert "Send esams backend traffic via dysprosium frontend for now""

b6810f58cd-+-Merge "Install new servers as upload caches" into production

627553c9a6-+-Install new servers as upload caches

8f8b3c6f7b-+-Revert "Send esams backend traffic via dysprosium frontend for now"

ffe55d74b2-+-Restore esams backend weight

cc25a9ab19-+-Send esams backend traffic via dysprosium frontend for now

4c9b1a141c-+-Rename the persistent storage files on the new servers

ae75aee15b-+-Prepare upload cache manifests for the new servers

fde7fc3ccc-+-Rename upload storage backends to be device name independent

c1138fd353-+-Merge "Remove obsolete nrpe stanzas" into production

b602f41afd-+-Merge "Correct domain" into production

20f88c4de1-+-Correct domain

dfd7459aea-+-Remove obsolete nrpe stanzas

248b83aa50-+-Merge "contint: vary tmpfs conf on master and slaves" into production

0bff39182f-+-contint: vary tmpfs conf on master and slaves

49fef9c5e4-+-Ceph: adjust ceph.conf settings for v0.65

dab1f404d8-+-Set libvirt based on variable for ubuntu specific config

4314b31f10-+-Use force push when replicating gerrit repos to antimony (gitblit)

b4598ca50c-+-Updating monitoring for analytics udp2log hosts.

b94fa2cfeb-+-Make qacct usable

491ef17749-+-Minor documentation fix

24c861b6e5-+-Merge "Update ganglia aggregators for parsoid/mobile caches" into production

02ad290e83-+-Update ganglia aggregators for parsoid/mobile caches

384f3599fa-+-nrpe: don't require/subscribe on the same resource

7206b0463c-+-Merge "Remove unused, empty memcached-sasl class" into production

6c05fdbe99-+-nrpe: revert to the nagios user/paths, clean up

e1c9784130-+-Merge "Add initial role for redis server for tool labs" into production

965de8da1d-+-Merge "Add support for renaming Redis commands to the redis class" into production

b8ea275f8e-+-Temporarily split the mobile cluster in old and new

9a59408071-+-Pass the storage parameter to mobile frontends

2f595989f3-+-Add default selector value

f160e70e2a-+-Install cp104[67] and cp1059/cp1060 as mobile caches

a3f5f92d12-+-Prepare the mobile cache manifests for the new servers

b0bc545c7b-+-Replace the parsoidcache backends with cp1045/cp1058

d2418cc29e-+-Setup cp1045 and cp1058 as Parsoid caches

ddaa755247-+-Prepare Parsoid cache manifests for new servers

c02239c396-+-Merge "Shell access for Sean Pringle" into production

2eda5e3783-+-Add initial role for redis server for tool labs

6129141dd9-+-Add support for renaming Redis commands to the redis class

8e9ad5abed-+-changed colors for root prompt, red on production, green on beta

9371893401-+-Use IPv6 for esams -> eqiad communication

f4dd7a629c-+-Calculate based on number of backends

3ea095bc9f-+-Frontends always use chash, regardless of tier...

416047ed92-+-Set an appropriate number of 'retries' for the chash director

8549e5ac41-+-Use chash for mobile backend cache -> backend cache

c509eb9cfa-+-Configure the esams LVS servers for mobile

9a47a3de49-+-Put the mobile LVS service in the 'high-traffic1' class

ad784f0aa3-+-Ceph: abstract ceph::key from ceph::bootstrap_key

913704d80f-+-Add LVS service IPs for esams mobile

92ed5436d9-+-Add cp3011-3014 as esams mobile caches

b719727e25-+-Send purges to the right port

9694ce62b9-+-Set backend weight to 100 for new mobile servers

1faa94d1ee-+-Use port 3128 for newer mobile backend Varnish servers

7b2ce79b51-+-Shell access for Sean Pringle

c5ef92eb6d-+-Remove unused, empty memcached-sasl class

1ce515b6b9-+-Merge "add a maintenance cronjob to mail the mchenry alias file to OIT (RT #5278)" into production

a53f5f6fd5-+-add a maintenance cronjob to mail the mchenry alias file to OIT (RT #5278)

5ab61c271c-+-revoke comment for deactivated account daniel in admins::restricted

34b73cd4c3-+-Revert "remove Daniel Kinzler's account, he said he doesn't need it and it had the wrong keys, already checked key was nowhere besides fenari, deleting home dirs via salt"

89ed0076bf-+-remove Daniel Kinzler's account, he said he doesn't need it and it had the wrong keys, already checked key was nowhere besides fenari, deleting home dirs via salt

3d975948b4-+-RT 5273 adam baso access to analytics

de9dcebd87-+-RT 5233 aaron halfak access to analytics cluster

b8ec4677dc-+-RT 5017 maryana access to analytics cluster + tab spacing cleanup

0ae4fe4363-+-Provide a sensible resource name for Daniel Kinzler's SSH key

e3f34752c3-+-Tool Labs: Package is actually called qt4-qmake

7fa1407634-+-Tool Labs: Typo fix in bastion.pp

c10c212a82-+-new class for toolsbeta project

5d447a73ae-+-Fix upstart job in role::labsnfs

166fdf04ee-+-Move ldap into a module

db84765654-+-Tool Labs: +qt4-make in dev (user request)

fbe8569e70-+-Tool Labs: Bump max_user_connections to 512

a81f3246d8-+-vary wmerrors.ini 'fatal_log_file' per realm

520cb0b48f-+-PHP fatal destination is now a class parameter

71686b73b3-+-tcpircbot: IPv4 cidr instead of IPv4-mapped IPv6

20c6929575-+-tcpircbot: work with IPv6 & no ACL, clarify option

14bb52f853-+-Allow vanadium to log via logmsgbot

e5fb6b974f-+-RT 5274 shell access for nik everett on search systems

24918214c4-+-Adding role/analytics/hive,pig,sqoop.pp

1b99984216-+-Including role::analytics::hadoop::worker on analytics1019 and analytics1020

30c950e26d-+-Turn off rt/lighttpd on streber.

d7347c2402-+-Merge "Puppetizing analytics1018 as hadoop worker" into production

2caa384499-+-Merge "Moving java package def into a class for analytics role" into production

68c3523507-+-Puppetizing analytics1018 as hadoop worker

ca1f04f519-+-Moving java package def into a class for analytics role

c5bfe0992c-+-Add Nagios group for esams mobile caches

e007fec78f-+-new prod redis servers

956c7b645b-+-make skrillex.py executable by wikidev group

7772544fa1-+-template needs correct name

b1f1063e94-+-adding skrillex db management tool to tin

467cf0b120-+-adding a labsdb management tool and asociated class

d2b6d48ca3-+-add public key for root@barium to backupmover@various_fundraising_hosts

11851d328a-+-reduce bufferpool size on labsdb s1 slave, set max_user_connections = 10 for all labs instances

096397b954-+-Merge "Create a class to sync MediaWiki:Common.css etc on labs with production" into production

0c2260e02d-+-Add user for jforrester and grant access to stat1

42872ae540-+-additional [centralauth] tables to filter at the sanitarium

0cde142984-+-Lowering alert thresholds on kakfa-broker-ProduceRequestsPerSecond

4254757fc3-+-Fixing packet_loss_log file on oxygen udp2log instance

0e70053ffd-+-Create an empty /etc/exim4/defer_domains if it does not exist.

531205f970-+-Refactor exim::rt to use the new exim template.

745bf942a1-+-Revert "Refactor exim::rt to use the new exim template."

1f307e8523-+-Merge "Don't manage eventlogging.conf during upgrade" into production

b86a33d166-+-Refactor exim::rt to use the new exim template.

22d1dfd54b-+-fix puppet error on terbium / when misc::maintenance::refreshlinks is disabled

a1e7cc42cf-+-Don't manage eventlogging.conf during upgrade

6b821d4f12-+-Add AFTv5 archive feedback cron job

a3e1bee9c6-+-setting db66 as pmtpa snapshot host for s3

04d287a7bf-+-Merge "Don't redefine sudo-ldap" into production

50fed69954-+-Remove unused file thumbs.pp

f892137a67-+-Move htcppurger.pp to the right dir

9c62e80fd9-+-Move htcppurger.pp to the right dir

3e40a80249-+-Move manifests/varnish.pp to a module

87b910fdae-+-Move manifests/varnish.pp to a module

e0c927f0a4-+-Rename resources with dashes

26d5940191-+-Convert tab indent to 4-spaces

a60b55ffc0-+-Remove embedding of classes

9bc3587005-+-Use quoted tabs instead of tab characters in the format string

68f2914676-+-Remove default instance instantiation, we don't use it

f64a47c8e2-+-Remove unused upstart version of varnishncsa udploggers

47cf84d397-+-Remove old dependency

6e1411a453-+-Remove resources for the obsoleted Perl HTCP purger daemon

7c6796f02e-+-Move monitor_group statements to the role manifest

ce94bbd94f-+-Don't redefine sudo-ldap

4e80222483-+-labsdb: set innodb_locks_unsafe_for_binlog for s4-5, set high slave_transaction_retries for all shards

728d5e0863-+-Increased the Parsoid job pipeline (to account for non-template edits).

03f9571541-+-Simplify bits VCL configuration options

3b92479aa8-+-Flatten harder

72678a1299-+-Provide a plain array of backend values

812b36720e-+-Fix tier 2 bits backends

b70d828391-+-Typo

20ae7a58dc-+-Fix tier 2 bits backends

4fdf7c20f4-+-Add another level of class hierarchy, descend bits from a 1layer class

a3da69c202-+-Mummy says dashes in puppet names are bad!

989c06b36a-+-Factor out $varnish_directors

ecb33d1e35-+-Factor out addition of localhost IPs to ancestor class

dc29c50fd2-+-Factor out Varnish logging

763989d797-+-Move (commented out) packages version class instance to ancestor

6a8fcde2e6-+-Add warning note

057d638e75-+-Add FIXMEs to be dealt with when configuring the new servers

6fe581bdd2-+-Revert "wikistats packages needed for Jenkins environment"

20349bcd09-+-remove Apache_site[no_default] line, this is now in webserver.pp and creates a duplicate definition

441c960df0-+-Create a class to sync MediaWiki:Common.css etc on labs with production

1598eb26d7-+-appserver: update for newer libmemcached

0becbc3d8e-+-using xenon for testing node

68d87329f8-+-RT 5161 - erosen access to stat1001

da649f768e-+-Move ganglia monitoring into role::cache::varnish::two-tier

6a47b7e520-+-Use role::cache::varnish::two-tier as role::cache::mobile ancestor

fdfb6bee37-+-Use role::cache::varnish::two-tier as role::cache::parsoid ancestor

d67d56cd6a-+-Make upload varnish $varnish_be_directors $cluster_tier based

3d9bb65a88-+-Move upload varnish to a separate class, and inherit from varnish::two-tier

aba1f97f4e-+-Move inclusion of standard/nrpe back to fix ganglia/nagios

3e06deabe9-+-First attempt at refactoring role::cache Varnish clusters

43cdef4cf2-+-Put the Text Varnish code in a separate sub class

ec49eac821-+-Make $varnish_be_directors tier based, not site (for text)

44092ad9b0-+-Remove the now pointless variable $varnish_fe_directors

96c18ec625-+-Let's clutter up the old crap instead

99c70a9cd6-+-Cleanup

32474db9a6-+-Rename $storage_backends var to the more descriptive $storage_partitions

b30c385f55-+-Rename Mobile storage backends, add a second storage backend in beta

de8ce62847-+-Rename Parsoid storage backends, add a second storage backend in beta

dc1abc576f-+-Prevent Puppet from making the Varnish storage files

f7847c0f06-+-Rename text storage backends, add a second one in beta

434ef4ab9f-+-Add 127.0.0.0/8 and ::1/128 to the wikimedia networks Varnish ACLs

ca549f381e-+-Point the Parsoid cache in labs to parsoid-spof rather than deployment-parsoid2

f8c5e7e5d0-+-Merge "Disabled broken ContributionReporting crons that do nothing and clutter dberror.log." into production

c004dff720-+-Merge "jenkins: fix up ganglia monitoring" into production

384352e84e-+-Disabled broken ContributionReporting crons that do nothing and clutter dberror.log.

ecc3d54b4d-+-jenkins: fix up ganglia monitoring

eb0ae28552-+-Add a robots.txt for all labs proxy access

a0fe4c1090-+-Added a basic nginx module and two (labs) use cases.

2d9c2d4b6f-+-jenkins: add in ganglia monitoring

fe3677ba23-+-Single quotes don't expand variables

5e72ace5da-+-Steps towards more uniform varnish storage backends between production and labs

f6ff3d2ebe-+-beta: fill 'rendering' cache backend

2db1f36c8d-+-Ceph: adjust a few OSD settings

9f71b662e4-+-Merge "Added a separate job pipeline for parsoid jobs." into production

f5131c4d8e-+-Ceph: switch 3rd monitor ms-be1005 -> ms-fe1004

739a02ed4b-+-Merge "Fix Puppet path to gridengine file." into production

3d8f1e8092-+-adding restart-twemproxy script to scap

88743ea07e-+-Fix Puppet path to gridengine file.

7c3b4061cd-+-Merge "Add Ganglia statistics to grid engine." into production

479da88459-+-Merge "created a stub for memcache" into production

1f22597fc7-+-Tool Labs: Use the newfangled local packages

00ca778141-+-contint: Disable php-apc on gallium

b02e3a77ac-+-sudo rule for mwdeploy to (re)start twemproxy

cfec340742-+-Merge "Increase ramBufferSizeMB from 32 to 100 and make maximum heap size configurable." into production

3c9facd149-+-Increase ramBufferSizeMB from 32 to 100 and make maximum heap size configurable.

0f963e11c9-+-Merge "Reverting change to install OpenJDK 7 on analytics nodes." into production

10fa22462e-+-Reverting change to install OpenJDK 7 on analytics nodes.

afdfbc041b-+-Merge "Swift rewrite.py: get rid of shard_containers" into production

ac5b62755f-+-Swift rewrite.py: get rid of shard_containers

69dcdffe40-+-Merge "Prepping analytics1020 for reinstall." into production

16327f62ae-+-Prepping analytics1020 for reinstall.

663402c6a5-+-Merge "Installing OpenJDK Java 7 instead of Sun/Oracle Java 6 on newly reinstalled analytics nodes." into production

efb982ecab-+-Installing OpenJDK Java 7 instead of Sun/Oracle Java 6 on newly reinstalled analytics nodes.

46edf5c770-+-Swift: get rid of test setup configs

cfa6dc14f9-+-libcache-memcached-fast-perl on tools

e428ec3477-+-Whitespace removal

c5617b6fa1-+-Disable HTCP daemon for Parsoid caches

58298c706a-+-Merge "Fix it for ganglia_new too" into production

0d414d2963-+-Fix port for Parsoid health check

28c28fbe23-+-Fix it for ganglia_new too

55204af733-+-Added a separate job pipeline for parsoid jobs.

00305f6eb3-+-Fix Parsoid cache entry in Ganglia

c6c1db11b9-+-Forgot to actually remove parsoid and parsoidcache from lvs[34]

cc9dbb201b-+-Merge "get rid of outdated stuff in misc/outreach.pp, adjust the contacts.wm apache site, use it on zirconium." into production

f808ab8c49-+-get rid of outdated stuff in misc/outreach.pp, adjust the contacts.wm apache site, use it on zirconium.

c445736e2b-+-Adding --delete flag to rsync public datasets cron job

bef77ea7bd-+-removing db1013 from dhcpd adding to decommission.pp

12e268188a-+-remove singer from site.pp, it's dead and the old secure site has also been moved to cluster meanwhile. also remove misc/secure.pp and apache site file, it's been replaced by apache-config

fe3f909397-+-decom singer, it's dead dead, the disks are inside colby (RT #5188, RT #5258)

90e19207af-+-Suppress salt logging in cli operations

7b5c37d2f6-+-Merge "inserted syslog to manifest" into production

ae22a23761-+-inserted syslog to manifest

ad9dcd3214-+-Merge "Fix wikidata singlenode manifest" into production

2e830cbe65-+-created a manifest for syslog

c1594714aa-+-Revert "Increase the chash weight to the final value on one frontend only"

70f49122b8-+-Increase the chash weight to the final value on one frontend only

d4d7ecae7d-+-Merge "Revert "Double the backend weight from 20 to 40"" into production

d704100ac3-+-Revert "Double the backend weight from 20 to 40"

2f3880298b-+-Updating CDH4 module, configuring hadoop-metrics2.properties with ganglia aggreagtor hosts

c9303c3339-+-Double the backend weight from 20 to 40

d613bcd970-+-Fix wikidata singlenode manifest

a3caa9bb16-+-Decommission the Parsoid boxes in Tampa

5492c717c1-+-Merge "Kill Parsoid in Tampa" into production

1b567843e0-+-Merge "Actually monitor parsoidcache in eqiad" into production

446261a972-+-Merge "Remove misc::parsoid::cache, unused now" into production

a1486623e0-+-Fixing public-datasets rsync job on stat1001

e6ece40cea-+-Kill Parsoid in Tampa

943c3714fd-+-Actually monitor parsoidcache in eqiad

9a73469aaf-+-Remove misc::parsoid::cache, unused now

427e7f1433-+-Using hash for zookeeper_hosts

d0d7c19d6c-+-Running zookeeper on labs kraken-puppet instance (so we don't conflict with cdh4 zookeeper packages)

1e23478a15-+-Adding role/analytics/zookeeper.pp for Analytics zookeeper puppetization in labs and production

2c99cb8607-+-Renaming role::hadoop classes to role::analytics::hadoop

0e90160149-+-New salt master fingerprint for production

bb9d62a5bd-+-Merge "Set new salt master fingerprint for labs master" into production

e818c6d963-+-Set new salt master fingerprint for labs master

bf1e5ea2f3-+-created a stub for memcache

7881773b90-+-Tool Labs: deploy ruby1.9.3 per user request

60b398eaf9-+-source not content

f8da0aab51-+-Merge "Puppetize gitblit configuration" into production

a27a8da59a-+-Fix monitoring for Parsoid caches

3686f42bf6-+-Merge "Move parsoidcache LVS from port 6081 to port 80" into production

7fed6ab2e9-+-Move parsoidcache LVS from port 6081 to port 80

342d135653-+-RT 2640 netmon1001 as smokeping server in eqiad

0093cc31a7-+-Actually use new Parsoid Varnish puppetization in production

64f2b2d1a6-+-Fix parsoid-common VCL inclusion and references

341a1e28ed-+-New Parsoid Varnish puppetization

068250313c-+-redis: default to pkg ensure present instead of to a specific version

a609f9989c-+-Merge "2 -> 4 spaces" into production

fd6ffc1cee-+-2 -> 4 spaces

e7576a7c94-+-Merge "Adding role/hadoop.pp classes" into production

5163d3dd34-+-Adding role/hadoop.pp classes

c8fe487d93-+-Merge "(bug 47156) Sorted the list of roots" into production

4d84e437e2-+-Puppetize gitblit configuration

52f48b3415-+-Correct variable name

36fa8eeff4-+-Get rid of the default backend 'backend' for 2nd tier sites

871366ee1a-+-Get rid of the default backend 'backend' for 2nd tier sites

c2fa2ebdce-+-(bug 47156) Sorted the list of roots

c50eab939e-+-Ceph: use role::ceph::mon on the new mons

edd5703151-+-Revert "Disable the gmond apache_status module on ceph hosts"

a5553fa2a7-+-Ceph: move monitors to separate rows

2581c26fa8-+-Adding alerts for webrequest data loss in HDFS

acabd38828-+-Using a correct regexp with match groups does help

1aa75046c7-+-Replace the entire string

d878b4bb16-+-Replace '/' separator with a space

aa4d3b54b5-+-Awful hacks to make Puppet work are nothing new...

6df245c031-+-Disable the gmond apache_status module on ceph hosts

4ad9d44028-+-Fix gmetad source list typo

114e66bab6-+-inserted 7z to list of packages on dev

0f4223cf79-+-Revert "Switch tier 2 (esams) upload backends to use chash when talking upstream"

cb34581233-+-r-base on tools project

d4a0198018-+-Merge "Tool Labs: Add more user requested packages to exec_environ." into production

17afd6a6a6-+-Merge "new tool for easy sql replica access" into production

f38044107f-+-Munge and restore Cookie on both frontend and backend

3065565d4c-+-Introduce an $extra_vcl instance parameter, use it for zero

fb3156fc2c-+-new tool for easy sql replica access

7d1d48ae45-+-Varnish: rename image_scalers to rendering

4223f10794-+-Merge "Rename the 'apaches' backend to 'appservers'" into production

d4103b0c0e-+-Rename the 'apaches' backend to 'appservers'

7338933cad-+-Merge "Use the appserver cluster as default backend" into production

c6cc21fd30-+-Use the appserver cluster as default backend

39391f0fae-+-Merge "Switch tier 2 (esams) upload backends to use chash when talking upstream" into production

9cff5bf763-+-Switch tier 2 (esams) upload backends to use chash when talking upstream

3595f8004c-+-Merge "Make role::cache::upload use role::cache::configuration for image scaler backends" into production

3523fbac96-+-Make role::cache::upload use role::cache::configuration for image scaler backends

ba6bc6e30c-+-Merge "Switch role::cache::text to using role::cache::configuration for content backends" into production

7dcce0e629-+-Merge "Specify a 20 connections limit for test" into production

24f03ef42d-+-Switch role::cache::text to using role::cache::configuration for content backends

9fa191fcd5-+-Specify a 20 connections limit for test

8f9413c973-+-Nagios/Varnish HTCP: fix illegal characters

102eb0023b-+-The retry503 parameter now specifies the number of restarts

67c9c664dd-+-Reduce backend timeout to slightly lower than frontend

f78398a35a-+-Tier 2 backends should use the chash director for requesting upstream

9a541c2bef-+-Split off 503 retry in vcl_error from 5xx retry in vcl_fetch

bc5dafe0b9-+-Add IPv6 address to amssq47

003e86ec33-+-Point esams Varnish at eqiad Varnish instead of Squid

d451877286-+-Install cp1037-1040 as text Varnish

5271baf40f-+-s/localhost/127.0.0.1/g for varnish::htcppurger args

232d9cc548-+-Turn on vhtcpd in production

ce2dcb1406-+-Changing site.pp and netboot.cfg for ms-be1 and ms-be4

e536420869-+-No longer run and deploy Parsoid on the Parsoid Varnish machines

2f51cc7e8b-+-Merge "Fixing eventlogging stat1 rsync job puppetization" into production

3711e6f987-+-Fixing eventlogging stat1 rsync job puppetization

edfdb84eac-+-Remove apachebench on wtp1004, we don't need it any more

fb83d33778-+-Adding ganglia monitoring of webrequest data loss in Kraken HDFS

4550cb72d3-+-Tool Labs: Add more user requested packages to exec_environ.

669a443bd9-+-Merge "Varnish: separate Zero-related carrier stuff" into production

5fb0f5f955-+-mistakenly changed out regex

40de22d532-+-comment for bookkeeping

3d55ccdd93-+-claiming db1014 for assignment as netmon1001

1503c9a177-+-Merge "smokeping: fix labs only cert syntax error" into production

895110d33b-+-smokeping: fix labs only cert syntax error

05568b6380-+-Varnish: separate Zero-related carrier stuff

2fda9d9898-+-Merge "smokeping updates" into production

45c53b2325-+-Getting oxygen ready for precise upgrade

af33941755-+-smokeping updates

5ca107a3b1-+-Merge "Add the error page include file to common-vcl" into production

abfb04a669-+-Add the error page include file to common-vcl

a9b1632f5c-+-Merge "twemproxy start=>true, to support reload when upstart twemproxy.conf changes" into production

8df8a7ea2d-+-Merge "smokeping: cannot recurse when file isnt copied down, having to use ugly bracketing" into production

2e995a2707-+-twemproxy start=>true, to support reload when upstart twemproxy.conf changes

9ea2edfcb0-+-smokeping: cannot recurse when file isnt copied down, having to use ugly bracketing

93cd6bac96-+-Merge "smokeping: splitting recuse directory from file link creation & adding dependency chain" into production

fbab1b9c2d-+-smokeping: splitting recuse directory from file link creation & adding dependency chain

607b82804a-+-Merge "Varnish: fix wikimedia.vcl.erb's std.collect()" into production

541f22e10d-+-Varnish: fix wikimedia.vcl.erb's std.collect()

f965970cbb-+-Merge "totally lied, more smokeping!" into production

87c2f869e6-+-totally lied, more smokeping!

d66f187246-+-Merge "more smokeping, if this isnt the last one I am totally swapping to puppetmaster::self" into production

313d1e6de5-+-more smokeping, if this isnt the last one I am totally swapping to puppetmaster::self

4b29067bf3-+-Merge "further tweaking for smokeping" into production

7d32f61cae-+-further tweaking for smokeping

2f043200b0-+-Merge "run twemproxy daemon on mw servers" into production

f4e3db2b58-+-Merge "updating smokeping puppetization" into production

417004b03f-+-Merge "Starting ImageScaler tmp dir move from /a to /tmp" into production

ee41e24c10-+-updating smokeping puppetization

5cf7e1a662-+-Increase backend_weight from 20 to 100, to improve chash distribution

7e439c48c4-+-Identd daemon module

120b470e8d-+-Merge "twemproxy proc monitor, don't run in labs" into production

2189180c09-+-twemproxy proc monitor, don't run in labs

cd495f45ac-+-Rsync public datasets for visualization to stat1001

9da08b28b7-+-Merge "bringing racktables stuff to style guide standard" into production

b3882cafcc-+-bringing racktables stuff to style guide standard

6b8969f031-+-Starting ImageScaler tmp dir move from /a to /tmp

44b09286a7-+-adding oliver's secondary key

80a60ea92e-+-Merge "inserted phpunit on exec nodes because they are needed for development tests" into production

886d20d904-+-Merge "Remove amssq* from decommissioning" into production

c7501d4178-+-Remove amssq* from decommissioning

98704c8339-+-Tool Labs: Revert, mc was already there!

92d3ccb6af-+-Tool Labs: User requested package

c4f6a861dd-+-inserted phpunit on exec nodes because they are needed for development tests

274319476d-+-Merge "Add amssq47 as text varnish server" into production

98ca9f2e99-+-Add amssq47 as text varnish server

44208c6de0-+-run twemproxy daemon on mw servers

bc79231f18-+-Fixing kafka_broker_host_regex for ganglia view

a79b348a09-+-Use the mediawiki primary as the default backend

13672375fa-+-Hack for getting Text Varnish in Beta Labs

e22888d880-+-Merge "Add role::cache::text for Varnish" into production

1ec450bbae-+-Add role::cache::text for Varnish

cc2e56ef1b-+-lanthanum is no more meant to be an IRC relay/server

55c96057de-+-I screwed that up didn't I?

7e48f5c78c-+-Decommission old knsq* servers, and amssq* upload squids

828bd19b46-+-typo fix

a9d19c926c-+-Merge "auto start mysql-multi instances" into production

683ee60cad-+-comment for bookkeeping

2100d0eb80-+-cking out testing stuffs for db77

3b3f97a088-+-Fixing confdir for ganglia::view

0364462681-+-Fixing typo

ccd08facd8-+-Adding ganglia view for Kafka stats

83da073465-+-Tool Labs: install 'dc' package (user request)

d64adb5ce2-+-Changing metrics.wikimedia.org htpasswd

a29ef40d48-+-auto start mysql-multi instances

cf985570ff-+-attempt to make puppet conf db1008 as mysql master once again

67b6105c2e-+-Fixing kafka::server class include

3a4ea94b39-+-Adding monitoring alerts for Kafka brokers on analytics1021 and analytics1022

15c707efab-+-Merge "adapt redis role and redis template for lab use" into production

68c59deee6-+-Fixy silly typo 'readonly' -> 'read_only'

36d2c86e83-+-Labsdb: Make labsdb100? mysqld not read_only

3e22435db3-+-Make id explicit, but also allow it to be unset

a80c7f5b28-+-Properly reference new salt::reactors class

6835ea4b83-+-Simplify salt module

293c3c6a9b-+-Use python-openstack-wikistatus on folsom.

d39a1ec24e-+-labsdbs: don't replicate mysql db

07a294ac08-+-Merge "add ssh keypair for l10nupdate user in deployment.pp for RT-5187" into production

7138b173f2-+-add ssh keypair for l10nupdate user in deployment.pp for RT-5187

45cd89cca8-+-Merge "Give analytics access to Yurik." into production

c9c7ba0753-+-Give analytics access to Yurik.

5e001f6343-+-revert requiring l10nupdate account in misc::deployment::l10nupdate, causes duplicate definition (even though it still seems like it would have made sense to be required where it's actually used) (RT-5187)

c6d115c892-+-of course this is accounts:: not admins::, just in admins.pp

d03b28e741-+- require admins::l10nupdate in misc::deployment::l10nupdate for RT-5187

606b9c0beb-+-oops, miscommunication. pgehres account rises again like a phoenix.

9329d29c7b-+-remove pgehres unix user

09e08c7e52-+-decommissioning db26

c24e264c02-+-Add Ganglia statistics to grid engine.

2586a2f6d8-+-log_bin should default to false

902cec2ef3-+-labsdbs: disable binlogs, relax locking, bufferpool sized for hw

4a6eddcb6b-+-disable linux native aio for multi instances, use unique tmp dirs, fix client socket stanza

6f7f78eed5-+-add binlog control options to mysql_multi_instance

6ddb21dc0a-+-rbr for prelabs

8a29edc25a-+-zinc needs wipe and removal from service for later reuse

9f7f58f99e-+-Bumped job process count to 15.

110c4e77cb-+-Not redefining $base_directory in limn::instance define

feb66fd9e3-+-Ensuring mod proxy_http is enabled for statistics apache

f9895e7295-+-Fixing typo in variable name

401706a909-+-Making misc::limn::instance more configurable

1e7bf68cc6-+-contint: jenkins slave user had no home

a031426c6e-+-Merge "contint: fix openjdk packages names" into production

f1b121f754-+-motd is now project wide

ff715645f5-+-contint: fix openjdk packages names

59dcbcd2b2-+-tweak jenkins slave definition

9f55d19433-+-Merge "contint: java definitions are now in the module" into production

a0a5180e46-+-adapt redis role and redis template for lab use

b68933e5f0-+-adding accountaudit_login to list of private tables

9e96f0d5c4-+-contint: java definitions are now in the module

de5e435ad7-+-Merge "Don't bother replicating to formey anymore" into production

3d0c3cba14-+-jenkins::slave and a basic role applied gallium

d1fbbf3b42-+-Tool Labs: Add procmail to mail handling chain

3dbf85a7db-+-Add generic::mysql::packages::client to tin

6e98ac330d-+-Merge "Several minor changes to the openstack manifest:" into production

77aabb5ad3-+-Tool Labs:  Actually use puppet syntax

f5f132026f-+-Don't bother replicating to formey anymore

03c3af31b4-+-Tool Labs: restore tools.wmflabs.org

3053249207-+-Several minor changes to the openstack manifest:

bb41dbb149-+-use generic::wikidev-umask on tin and terbium to ensure wikidev users have umask 0002 as used on fenari.

a6b7208a58-+-prep for planned s4 master swap

da6f9b7500-+-Add wtp1005-wtp1024 to Parsoid deployment group

0018a8d68e-+-Merge "Fix up deps and unless clause for privacy policy import." into production

5bc6f8fd1d-+-adding parsoid servers to site.pp

405abee1c6-+-Merge "Added per dc / server role breakdown of udp2log packetloss monitoring." into production

9e63b25500-+-contint: install colordiff

9062499366-+-Merge "contint: libs to build udp-filters" into production

a31f78c157-+-Merge "system_role for role::applicationserver::appserver::beta" into production

408b6d5760-+-Merge "beta: change syslog instance" into production

a4ec5ab52a-+-Merge "Ceph: move osd min down reporters to [mon]" into production

782d7c4f30-+-Ceph: move osd min down reporters to [mon]

a34b6e38f1-+-deployment: fix mw source path on beta

0e006e3910-+-beta: enable HTTPS on all projects

d0b881e68c-+-protoproxy: mobile + beta support

bf809b9f8d-+-Merge "protoproxy proxy_addresses is now optional" into production

fe3e13c662-+-Merge "doc for proxy_configuration define" into production

a11ef3f2dc-+-Merge "puppet-lint protoproxy" into production

aee7d33bc7-+-Merge "proxy_configuration $ipv6_enabled is now boolean" into production

a46d69e9bd-+-Update location of find-nearest-rsync in sudoers

6e89949d70-+-Running commands as apache is required for deployment

7a2015c742-+-Remove duplicate of mwversionsinuse

e5f64c204b-+-Move in the remaining scap scripts from wikimedia-task-appserver

f605ba970a-+-Don't put scap scripts in the root directory

f6fbfcd96b-+-Migrate scap-1, scap-2, & sync-common from wikimedia-task-appserver

9120de39fe-+-Add puppetized dsh on fenari and bast1001

b1c95251bb-+-Switch back to fenari agent

f3011e1d61-+-Tool Labs: Email! (@toollabs.org)

dbc2ceec17-+-Merge "Add akosiaris to admins.pp" into production

083f8dfbb7-+-Basic puppetization of dsh

d10d2ffa12-+-Move scap source location from fenari to tin

b0cd081c11-+-Add akosiaris to admins.pp

1eb7009a67-+-Added per dc / server role breakdown of udp2log packetloss monitoring.

ca8cc64346-+-Merge "Update EventLogging destination IP in beta" into production

1790713cb8-+-Update EventLogging destination IP in beta

90e6f00fb9-+-Tool Labs: Stop apt from fighting over mysql

3c179b26c3-+-Setting up analytics1009 as unsampled udp2log producer

3535ed4c47-+-Readd cp3003

01cff94b3e-+-Merge "contint: proxy only enabled on wikimedia.org" into production

062f7a356e-+-contint: proxy only enabled on wikimedia.org

6ae0f52acd-+-Move standard-noexim back out of site.pp and into a role.

648cd9da82-+-Don't use 'standard' on magnesium.

ac9a6225bb-+-Include exim::rt on magnesium

09458fcd94-+-rename nsca_payments.cfg to nsca_frack.cfg since it covers all frack hosts now

fe3912e768-+-db77 -> coredb for testing

37baad2bb9-+-lsetting up db77 as clone of db78 for coredb testing

4b603abcaa-+-beta: fix mediawiki dependency

721baec221-+-beta: appserver should uses /data/project/apache

114df57f20-+-Merge "decom barium, it moved to frack, per talk with Jeff" into production

ce5003e03a-+-decom barium, it moved to frack, per talk with Jeff

f962965c2e-+-fundraisingdb cluster based on credb module

9a8f964bff-+-prelabsdb dbs: redacting tables

b342ac1599-+-Revoke access for Munagala Ramanath (ram)

25df97f22e-+-Tool Labs: Add packages (user requests)

432c7a0358-+-new RT4 on Apache config - enable SSL, redirect http to https, avoid conflict with other sites, use a ports.conf with NameVirtualHost *:443, ...

cf93e14208-+-Merge "Revert "Several minor changes to the openstack manifest:"" into production

c88f51921a-+-Revert "Several minor changes to the openstack manifest:"

fc0c1bf653-+-Merge "Specify db1001.eqiad.wmnet rather than just db1001." into production

35c0682c9a-+-Merge "change pmtpa virt cluster to folsom" into production

6ac7406257-+-change pmtpa virt cluster to folsom

09504ae527-+-Merge "decom ocg1-3, removing eqiad entries that werent decoms" into production

6f12904f81-+-Further twaddling of deps to get request-tracker and racktables on the same box.

5871ce4198-+-Remove some long-since-gone SVN stuff

51a68f8d54-+-Rearranged RT apache includes:

33477f07a3-+-decom ocg1-3, removing eqiad entries that werent decoms

2a13803e59-+-Merge "Added manifest for rt4 running with Apache." into production

341f9a49e8-+-Added manifest for rt4 running with Apache.

61e1c48af6-+-Tool Labs: minor fix

f4a9c30219-+-Tool Labs: Make mailrelay actually listen for mail

e0e617f904-+-Tool Labs: Mail works, redirecting /var/mail

5d48443710-+-Tool Labs: Implement mail relay

51d7543509-+-Specify db1001.eqiad.wmnet rather than just db1001.

30e1acc996-+-Install RT4 on magnesium

73d6f87083-+-Tool Labs: Package request

a1555b5554-+-Tool Labs: Add mosh for non-NA friends.

352bc0660b-+-Tool Labs: Moar comments in the module

3e56ce4278-+-RT manifest: typo fix wikmedia -> wikimedia

025f01064c-+-Tool Labs: Minor fix

ca80398de6-+-Tool Labs: finish with the access.conf

03d29640be-+-Tool Labs: More data in the project store

462a034e49-+-Tool Labs: Minor tweak, still access.conf

15dfdad3cc-+-Tools Labs: Attempt clean override of access.conf

ea53f244a6-+-Tool Labs: HBA apparently only works with RSA

157fb6d528-+-Tool Labs: Fix syntax error in local.list

b91bbfc8dc-+-Tool Labs: More puppetized, part deux!

3318a3a2c7-+-Add locales to Tool Labs (also add fi_FI)

a765c9d12c-+-Tool Labs: Also MOTD for the exec nodes

26fcb26ef4-+-Tool Labs: Actually use debian directory names

4a0bcd26d3-+-Tool Labs: Fix variable substitution.

acf1af3037-+-Tool Labs: typo fix

3a274aec28-+-Tool Labs: A number of configuration bits

bef552e80f-+-Fix: libxml2-dev was included twice

2d289497c1-+-create a link to shared folder

a02bf0b881-+-inserted 2 more packages needed to compile

6ba4df3a10-+-decom bellin and blondel and remove them from site.pp

7d4a2814b1-+-Tool Labs: Add libstring-shellquote-perl to exec_environ.

be781feb3b-+-removed colby and barium from site.pp

de4926d366-+-barium reclaim

524ad37732-+-removing old racktables stuff

3ddc7c6e85-+-Merge "Prevent rt DB setup from running repeatedly." into production

b82a80b5e9-+-Tool Labs: replace outated libpng2 with libpng3

7072152db7-+-Tool Labs: Add missing packages for tools

efe62f64d3-+-Merge "Ensure that all UMAPI files belong to wikidev group" into production

993f276d1c-+-make Zuul query Jenkins directly

803d06691b-+-install pstack on gallium

a9eb5442e6-+-Ensure that all UMAPI files belong to wikidev group

3465743da7-+-Revert "hooper no long racktables host, removing old racktables stuff"

33a5adea60-+-hooper no long racktables host, removing old racktables stuff

dfa665e3c4-+-protoproxy proxy_addresses is now optional

eb4061d011-+-doc for proxy_configuration define

6ebf833490-+-puppet-lint protoproxy

16c84222ec-+-proxy_configuration $ipv6_enabled is now boolean

c12ebb9886-+-Merge "nginx_site now uses boolean values" into production

83199b72b5-+-Revert "kiwix mirror stanza moved to mirror role and added system_role"

cec1ca394b-+-nginx_site now uses boolean values

dbcd26550b-+-kiwix mirror stanza moved to mirror role and added system_role

54e06fb8fd-+-Merge "final steps of racktables puppetization and migration" into production

5fcb922731-+-final steps of racktables puppetization and migration

596f230202-+-Typo fix: Another instance of the same typo.

71aa5bcdbc-+-Typo fix: Puppet doesn't like proper grammar

d95623bfe5-+-Fix: gdb already part of base.pp

3ea3f37c3a-+-Collect Tool Labs' SSH keys into a ssh_known_host

217d500aae-+-Merge "updating racktables role to include php5-mysql" into production

d0b2a02260-+-updating racktables role to include php5-mysql

c909e86885-+-Merge "Inserted some more packages to development set" into production

2aa8dcc894-+-Inserted some more packages to development set

554ad962f6-+-Fix duplicate package definitions in toollabs

7ba2e1d560-+-More tweaks and bugfixes for the Tool Labs

faa029d61e-+-Fix up deps and unless clause for privacy policy import.

8a439906bd-+-Remove explicit requirement for essex from role

21741ff7b4-+-Merge "Redis ganglia metrics: support password param" into production

d1d1aa684d-+-SSH keystore for toollabs class

22552db43a-+-Only bond interface in pmtpa for nova-network

7a5422ecc7-+-Change eqiad to use folsom release

290efa3f7b-+-Merge "Add support for essex and drop support for diablo" into production

c34e13ca16-+-Add support for essex and drop support for diablo

96ae9eb523-+-style cleanup

d9be102ab9-+-Merge "conf file for lucene.jobs.sh (not used yet)" into production

5150a8b1e5-+-Preliminary toollabs module

a26ca8dba1-+-making new racktables host racktables2 for testing

85a6b8daef-+-Add second key for myself

2ba4ab7c57-+-Merge "proxy_configuration had a typo" into production

0a5b95c1a3-+-Redis ganglia metrics: support password param

02ab50468c-+-Merge "Adding Ram on analytics nodes." into production

d68e8918d6-+-Merge "MongoDB on Vanadium: auth => true" into production

8fbdbfb1b6-+-Require the MongoDB password class

c2dc76f9ef-+-Add passwords::mongodb::eventlogging to dummy passwords.pp

6ffea25497-+-MongoDB on Vanadium: auth => true

1018da0364-+-Prevent rt DB setup from running repeatedly.

a034346596-+-moving s4 snapshot host to db1042

6d1c01ffe3-+-Merge "Rework the RT manifests so it can be installed in Labs" into production

4acc3e04f0-+-pull db1025 b/c it moved to frack.eqiad

97cbac9b0d-+-Merge "Specify the correct path to helper script" into production

590f4572cb-+-Deployment rights for Yuri Astrakhan per RT 5069

e080418f88-+-remove db1025 from production puppet, it's in frack.eqiad now

24895c787a-+-proxy_configuration had a typo

39c2790a31-+-Merge "add private wiki iegcom" into production

030adf833a-+-add private wiki iegcom

036b08e5a8-+-Specify the correct path to helper script

f0c068687e-+-A few more tuneups of mediawiki_singlenode:

afd1e58f14-+-fixing customized ports.conf for blog server

e0d7c1a39b-+-New cluster SSH key for me

5395ab1068-+-adding holmium as blog server

3c5dc449b5-+-Merge "tcpircbot: subscribe to (rather than require) config" into production

7147ae215f-+-contint: libs to build udp-filters

073b114ae9-+-reenable rfaulkner round 3

bb61f83341-+-Update Ganglia to 3.5.7

b4450be0da-+-Improvements to mediawiki_singlenode

3588772b04-+-Merge "Remove morebots classes." into production

d2efa0ca05-+-tcpircbot: subscribe to (rather than require) config

9615d30c83-+-Adding Adam Wight on stat1 and stat1002.  Changing his ssh key.

7c4718c0dd-+-Per Roan's request, kill his key

74bbfd9f69-+-Adding mwalker on stat1 and stat1002 (admins::privatedata)

e16b9c352a-+-Creating admins::privatedata class to group users who need access to webrequest access logs.

4ba87e58fb-+-Merge "Migrate amslvs1/2 PyBal BGP peerings from csw1-esams to cr1-esams" into production

e109461682-+-logmsgbot: only allow connections from tin, fenari & localhost

5525c237ca-+-Allow multiple CIDR ranges to be specified

bbc7a08d5b-+-reassigning db1042 so s4 after db1020 hw failure

5e386b5255-+-Merge "zuul: pass puppet-lint (whitespaces)" into production

b7db99f0fb-+-Merge "Add custom init script for multiple aggregators for labs" into production

0a13e880a9-+-Add custom init script for multiple aggregators for labs

4cbc765014-+-Merge "Remove duplicate definition issue with labs ganglia" into production

ac13bd43ab-+-Remove duplicate definition issue with labs ganglia

8528c5e158-+-adding db74 to pmtpa s5 until

01fa4c8d06-+-Add s6 and s7 to user-metrics api.

0caf3a66e7-+-building db1059 - to be the new s4 master which switching to mariadb, upgrading db1020

9c6a0290ea-+-More stuff to set up stat1002 as private data host

8b48cb6d32-+-admins::globaldev, not accounts::globaldev :p

d04d68bb01-+-Missing comma fix

130e5bd7d0-+-Setting up stat1002 for hosting private webrequest access logs

0e5e1dacfd-+-Adding Ram on analytics nodes.

e6eb0dd41a-+-Merge "Removing now unused manual socat relay confs." into production

3cfc03206e-+-Removing now unused manual socat relay confs.

25aeca2e55-+-Merge "Fixing varnishncsa process check now that there are fewer varnishncsa processes." into production

c704fd0c12-+-Fixing varnishncsa process check now that there are fewer varnishncsa processes.

158a6bf90f-+-Merge "Keeping double quotes just in case single quote escaping is different" into production

9f3067b215-+-Keeping double quotes just in case single quote escaping is different

7a227ab135-+-Merge "Just in case escapes are different with single vs double quotes, I'm leaving this as it was before." into production

5fbe7d021a-+-Just in case escapes are different with single vs double quotes, I'm leaving this as it was before.

4e64ac34ca-+-Merge "Removing bits locke varnish logging instance" into production

a547bcd219-+-Removing bits locke varnish logging instance

5ca57c8605-+-Merge "- Sending varnishncsa traffic to gadolinium instead of oxygen for multicast relay. - Removing locke varnishncsa instance.  locke is no longer used." into production

fe21c82876-+-Merge "Sending bits esams EventLogging traffic to gadolinium for vandium relay." into production

fef916fea4-+-Changing Erik Bernhardson's ssh key.

d6275febb8-+-- Sending varnishncsa traffic to gadolinium instead of oxygen for multicast relay. - Removing locke varnishncsa instance.  locke is no longer used.

ea460e6afe-+-Migrate amslvs1/2 PyBal BGP peerings from csw1-esams to cr1-esams

382a59751b-+-Sending bits esams EventLogging traffic to gadolinium for vandium relay.

aa005efe2e-+-Migrate amslvs3/4 PyBal BGP peerings from csw2-esams to cr2-knams

1d12f1db51-+-must... define.. icinga group

b57b097ad9-+-someone else will get to figure out where the 'dialout' group comes from

14b849ba63-+-don't require a group the user type will create for you

130515af3b-+-just one require in icinga user stanza

97003f405f-+-icinga extra groups shouldn't have primary group

4e26414043-+-second try at getting icinga user its nagios group, thanks hashar

a2705ea60f-+-include the new nrpe::user class in nrpe

a02f5967fd-+-try to fix issue on fresh installs where nrpe starts with weird uid

2b48d00682-+-on precise use mysql clent 5.5 for snapshot hosts

5145f8c67e-+-Require a password for Redis

a8c8884d07-+-Merge "changing dependency chain" into production

6ed82f948d-+-changing dependency chain

ba81c98c38-+-Allow logmsgbot connections from anywhere

e8ea23146d-+-lets try it this way

2a52451fcb-+-Move logmsgbot from fenari to neon

74d7168650-+-forgot to include webserver in class call

2c49dbcdca-+-magnesium to be racktables host

5d580a8086-+-creating racktables role for eqiad based server

d3e61207e0-+-deploy db1013 as temporary replacement for db1025

cb666ef07a-+-Merge "Fixing typo in upstart conf" into production

79fba45ebf-+-Fixing typo in upstart conf

8e6f7b6030-+-Merge "Setting up webrequest multicast and eventlogging on gadolinium." into production

39567146c2-+-Setting up webrequest multicast and eventlogging on gadolinium.

eb0b8ae2fb-+-Grab-bag of mediawiki_singlenode tuneups.

a9d5820ec1-+-Chown the 'cache' and 'image' dirs to www-data.

5c8fea05a3-+-Changing git url for user_metrics site on stat1001

f731232313-+-Merge "Lint mediawiki_singlenode module" into production

0c02821dab-+-latest release is wm10 not wm8 in our apt repo

998a6fa04b-+-Lint mediawiki_singlenode module

32fef2690f-+-Firewall off redis on stat1

bb1dd0f338-+-Firewall redis from the outside world on vumi

591e596620-+-Remove morebots classes.

a29bae4dfd-+-beta: change syslog instance

0c44e1c07d-+-removing deploymentscripts from bast1001 Two reasons : 1 it's not a deployment host and 2 - it breaks puppet since timidity is not installed err: /Stage[main]/Mediawiki/Service[timidity]: Could not evaluate: Could not find init script for 'timidity'

0cbe8d2309-+-Decommissioning db10

01a85a3bed-+-Merge "labsnfs: Transition class for switch to Labs NFS" into production

2440c3493c-+-Merge "db51 -> file per table" into production

e71f97ba2c-+-revoke erik b key per rt 5045

2d608eee42-+-db51 -> file per table

2d4271531d-+-labsnfs: Transition class for switch to Labs NFS

840ec24ca9-+-Qualify path to IPython executable

47e0074d32-+-Disambiguate scope of included 'eventlogging' class

eec085557b-+-Provide 'certfile' and 'password' parameters

2e1eb8a8c7-+-Create self-standing IPython Notebook Puppet module

424380b1ac-+-Merge "Use Upstart rather than supervisor to manage IPython" into production

55183a6d71-+-Merge "renaming rfaulk's new key so it doesn't conflict" into production

a34ce4931f-+-renaming rfaulk's new key so it doesn't conflict

41f3944370-+-Avoid using regexps where string literals would do

d47edd4a24-+-Merge "Fix EventLogging fail" into production

9d9dbd47ca-+-Adding rfaulk's new key to admins for stat1 access..rt5040

b27b0aad24-+-system_role for role::applicationserver::appserver::beta

60b65fc372-+-updating s5 topology

f363086104-+-Merge "RDoc for tcpircbot class and tcpircbot::instance resource" into production

6b2ffb0cbc-+-RDoc for tcpircbot class and tcpircbot::instance resource

7ce7e067e1-+-Adding labstore3/4 to gmetad config for Labs NFS

fd48f4a67d-+-Ceph: be more resilient to malfunctioning OSDs

ffc238ee50-+-Fix gridengine puppet manifest syntax

84261772ad-+-Add unicorn logo to labs mediawiki installs.

2d50107950-+-Add robots.txt and a privacy policy to mediawiki_singlenode.

6f40576fc3-+-Enable LVS check for ms-fe.eqiad.wmnet

45297a3f86-+-Merge "Fix gridengine class to be parametrized" into production

ec564ee2e2-+-Fix gridengine class to be parametrized

fe130221f7-+-ms-be2 new mac addr, new disk layout (720xd), remove dup stanza

7a9809c93e-+-Merge "Band-aid patch to get puppet running again on labs." into production

779844d7aa-+-Adding Aaron  Halfakar's new keys:

2aa3c842d6-+-Band-aid patch to get puppet running again on labs.

8673c442b6-+-Merge "Set X-Forwarded-(Port|Proto) so Gitblit knows its on SSL" into production

def71bee41-+-Add 'tcpircbot' Puppet class

1fae202f69-+-zuul: pass puppet-lint (whitespaces)

1bc700c560-+-Ceph: fix start/stop/restart for radosgw Service

c404d7153c-+-Ceph: add meaningful frontend/backend nagios checks

2c48430620-+-Ceph: more radosgw changes, drop apache::mod

e51b3481d8-+-sitting new m1 shard primary site to mw_primary (eqiad)

8cbfaef482-+-Ceph: fix more radosgw order of dependencies

26c11318cf-+-add account and key for ebernhardson and include on stat1

89655becd2-+-Fix echo digest email cron script path

94bdf62592-+-Updating README and comments to indicate that mod_proxy_http must be enabled.

5cd9da8f8f-+-Set X-Forwarded-(Port|Proto) so Gitblit knows its on SSL

46ddca73a8-+-Ceph: fix a bunch of dependencies

a7ba389375-+-Ceph: fix radosgw monitoring

ddea5f2b8d-+-Fix EventLogging fail

fdfaaca899-+-Readd class ganglia to standard

8bf04a51ff-+-Move esams over to the new Ganglia module

d3ba8c28d1-+-Fix capitalization of ceph monitor_group

fc361ffd34-+-Adjust description for media storage LVS config

9483df06b0-+-Move the dirty Ganglia migration logic into ganglia.pp, add hooft

89ac825eb2-+-Make hooft a Ganglia aggregator host for esams

836242d8b3-+-Disable the generic proxy, and add proxying for specific apt repos

93c50b7f00-+-Split gmetad hosts and aggregator hosts

287437e26a-+-Fix order between $ganglia_aggregator and include

4ef49da810-+-Initial Ceph module, role class & site.pp

d9df50138a-+-Merge "wikistats packages needed for Jenkins environment" into production

567d36683b-+-Merge "EventLogging Varnish setup for Labs" into production

6cd597f90e-+-EventLogging Varnish setup for Labs

0ba371ec67-+-Merge "Create role::beta::maintenance, make GeoData scripts work on Labs" into production

8e1ca55565-+-Create role::logging::eventlogging

e442bf5f60-+-Disable the proxy for non pmtpa/eqiad hosts

57e5ea6304-+-Use the new ganglia module for monitors in Labs

a13e8d9f46-+-Include the configuration class

03ab61b7f9-+-Support labs

eaa0ce2c1b-+-wikistats packages needed for Jenkins environment

1e2806ce59-+-Merge "contint: 100% passing puppet-lint" into production

a9526e0e8a-+-Create role::beta::maintenance, make GeoData scripts work on Labs

0e503af9c6-+-Merge "fixing enabled parameterization -" into production

4681659e77-+-Copy+paste fail for replication config

b635177ec8-+-Also install webserver::apache

90e879796d-+-Fixing class names for gitblit

c9971e3708-+-fixing enabled parameterization -

7b6fd8be3d-+-Don't bother restarting Gerrit for replication.config changes

f55bcfd9d2-+-Swap gerrit to new gerrit.wikimedia.org certificate

0fe1652d36-+-Begin replicating all repositories to antimony

596123da62-+-Remove old github detection hack, that's what remoteNameStyle is for

a87afa8373-+-Initial puppetization for git.wikimedia.org

dc10cf07dd-+-Calculate the id/portnr on the monitors matching the aggregators

bef2986009-+-Expressions and selectors do not go along

3be1c9f169-+-Rename $site_port_prefix to $id_prefix, and use it for gmond instance IDs as well

3c2b2c2c30-+-Run aggregator instances for eqiad ganglia clusters on manutius

54bbcedb84-+-Strip the site suffix from the title to retrieve the cluster name

55140dca4e-+-Define $cluster variable before reference

9f490db924-+-Support aggregators responsible for multiple sites

3ec2c86416-+-Resolve ganglia resource conflicts on manutius

efa300a3c3-+-Add a field "sites" to the ganglia cluster configuration

e912d02014-+-Add alias gmond for ganglia-monitor service

0a790c19d6-+-Add file type for /etc/ganglia/conf.d as well

560f5213a9-+-Add file type for python_modules directory

be40f1635c-+-Test the new ganglia monitor classes with pmtpa bits caches

c4455614f1-+-Add nickel as gmetad host

cb1643de19-+-Add pmtpa suffix

5cb31a6e93-+-Use manutius as first ganglia aggregator host on pmtpa bits caches

b109418cfc-+-Spaces to tabs

3957b4fd28-+-Sync new ganglia clusters

df712ebd88-+-contint: 100% passing puppet-lint

a618718ba0-+-Decommissiong sq33..adding to decomission.pp removing dhcpd entry

dcd74076d1-+-Merge "Pester IRC as well when a draft is published" into production

d0b64621d2-+-Merge "delete outdated apache configs for outreachcivi (RT-5002) and ocs.wikimania2009 they still resolve(d) to singer, but they were not enabled apache sites anyways" into production

67732148df-+-rfaulk is no longer with company

686fc9e8b4-+-ms-be9 to correct stanza with new disk layout

81fc2449e6-+-Merge "contint: pin python-voluptuous at 0.6.1-1~wmf1" into production

3e6b3dca5d-+-Fix typo in parameter name

021e97bbbb-+-Move tor_exit_node from hume to terbium now proxy config exists

6f4bb46724-+-delete outdated apache configs for outreachcivi (RT-5002) and ocs.wikimania2009 they still resolve(d) to singer, but they were not enabled apache sites anyways

43ddd8830b-+-really reenabling ahalfak's

60ce177b87-+-reenabling ahalfak's access

be4f71c5ca-+-removing halfak's key as it is on stat1 other keys also on stat1, it appears

b9922ce0fc-+-add new SSH key for halfak (RT-5004)

de5777363f-+-set SSH key for halfak to absent (RT #5004)

fe487c520c-+-Removing rsyncd from locke

b19050a8ae-+-Removing udp2log instance from locke

f873d5e8d8-+-List all needed crons on terbium, even if disabled

19615b1893-+-contint: pin python-voluptuous at 0.6.1-1~wmf1

74ff5c4933-+-Skip purge lookups for upload purges on mobile

1854fb929c-+-Make purging more generic, unbreak purging on mobile cluster

aa0b7ab002-+-Set dysprosium backend weight at 4x

13c395c5f4-+-Revert "decom'ing sq33, fixing role/cache.pp puppet and ganglia.pp puppet ot match standards"

622bbccca6-+-Revert "create jenkins user with systemuser"

9be7123ae7-+-Revert "attempt to shut up gmetric job queue cronspam"

d8ed445b0a-+-attempt to shut up gmetric job queue cronspam

6bdda4b8f5-+-Merge "remove wikibugs from node mchenry for now until issues with the puppetized version are fixed. deliberately not reverting all changes to the class though, we'll still want them" into production

1111cc7ab9-+-Merge "db55 new snapshot host while db44 dead" into production

e19cbee39a-+-remove wikibugs from node mchenry for now until issues with the puppetized version are fixed. deliberately not reverting all changes to the class though, we'll still want them

5689d41e7f-+-Merge "db44 -> mariadb" into production

9a7cfed133-+-db55 new snapshot host while db44 dead

44ab45be25-+-Fix cron for Echo notification email digests/summaries

57e0298352-+-Merge "wikibugs - fix log file path - quick fix" into production

b4e50efb00-+-wikibugs - fix log file path - quick fix

4bcac1e144-+-Make Echo daily cron run against the wikis defined in echowikis.dblist

95e0787879-+-db44 -> mariadb

3fe8bc5417-+-moving mysql query digest collection (for ishmael) from db9 to db1001

6f20e5fa9c-+-db65 and db72 -> mariadb

2caad34a63-+-wikibugs - no don't define /var/lib/wikibugs/bin, git::clone doesn't like it if that already exists

617ae299ae-+-decom'ing sq33, fixing role/cache.pp puppet and ganglia.pp puppet ot match standards

2114339727-+-wikibugs - also need /var/lib/wikibugs/bin summarize needed directories, set File defaults, retab 2-space softtabs, align arrows to make puppet-lint like it more

3920e6162b-+-Use Upstart rather than supervisor to manage IPython

a47e071a28-+-Merge "ensure /var/lib/wikibugs dir exists (home dir for user)" into production

51a22688bf-+-ensure /var/lib/wikibugs dir exists (home dir for user)

943b94ee96-+-db55 and db73 => mariadb

e2b8734d98-+-Merge "Create a role for Solr in Labs" into production

96e8b6dacd-+-Create a role for Solr in Labs

e4daf7f7de-+-Pester IRC as well when a draft is published

cf587b6c4f-+-Finish puppetizing wikibugs bot

d60efef158-+-fundraising/drupal sudoers

60e6de9306-+-drush consistent-user and lockdown scheme

3631fdfef2-+-Set dysprosium backend load at 3x

e951d019ed-+-Set dysprosium backend weight to 6x

eeba713e1f-+-Merge "Revert "Set dysprosium backend load at 4x"" into production

f8287364a3-+-Revert "Set dysprosium backend load at 4x"

4008077b17-+-Merge "Set dysprosium backend load at 4x" into production

335a50afd1-+-Set dysprosium backend load at 4x

91be1ca6e9-+-Merge "Make weights for esams fe -> eqiad be and eqiad fr -> eqiad be equal" into production

554e5c5b82-+-Make weights for esams fe -> eqiad be and eqiad fr -> eqiad be equal

0b72d2b6b9-+-Merge "Double the backend weight on dysprosium" into production

64aacaee42-+-Double the backend weight on dysprosium

3ec8e3eda8-+-Merge "Rename dysprosium's backend to -sda and -sdb" into production

ae813de4b2-+-Rename dysprosium's backend to -sda and -sdb

4225128b0b-+-conf file for lucene.jobs.sh (not used yet)

9f3ffeeb5f-+-Add dysprosium to the eqiad upload pool

864ece9979-+-Sort the backend list to prevent constant reordering

3eb013506f-+-Define the test_wikipedia backend on the mobile backend caches

e31daedaea-+-Remove the upload-specific backend section in upload-backend.inc.vcl

94308e5ace-+-Merge "Parametrize mwerror port" into production

4235228793-+-MongoDB dbpath: /a/mongodb -> /srv/mongodb

a2d1ed66cb-+-Parametrize mwerror port

a4fb2e19ab-+-Merge "Add default Notebook helpers to config" into production

ac3c51215e-+-mysql client on hume and terbium patch 2 - changed class used patch 3 - fixed spacing and comma

734ded353a-+-Add default Notebook helpers to config

944f0cf81b-+-moving db33 and db35 to new pmtpa m1 shard

40142d96c1-+-actually, using db65 as snapshot host for pmtpa s4

f4607e6c18-+-removing drush symlink from aluminium, replacing with wrapper script

55523ce1ec-+-Merge "jenkins systemuser call was invalid" into production

88f77795cc-+-labsdb: don't repl private wikis

fa0f555b17-+-zuul: no fetch from pypi and drop statsd dependency

b2dee5e40e-+-zuul: in labs use the `labs` branch to install Zuul

d9408f6d02-+-Merge "Fully quality ipython path" into production

827841528a-+-zuul: support cloning from a different branch

3f0dd9aa1b-+-Fully quality ipython path

f959cea0dc-+-gerrit-wm: Sends translatewiki events to #mediawiki-i18n

8d59c90fce-+-Parametrize IPython notebook profile configuration

23a8296ab7-+-Merge "Setting up HTTPS for metrics.wikimedia.org" into production

706d0fbd50-+-harmon into production

3737042cc0-+-Setting up HTTPS for metrics.wikimedia.org

c5b896bc5b-+-enable banner log rotation on gadolinium

a508d41c1a-+-antimony.wikimedia.org not antimony.eqiad.wmnet

bbde306b2e-+-adding wikidev group to antimony

979b4fd009-+-Merge "puppetize user file_mover on aluminium/grosley" into production

b7e12bfddc-+-puppetize user file_mover on aluminium/grosley

0e03eb7f09-+-new pub key for tfinc

8a1cb70383-+-assign uid/gid 30001/30001 to file_mover, switch banner logrotation user

0044c4662f-+-Not specifying numeric gid for file_mover group.

bb59418d11-+-Ensuring group file_mover is present for accounts::file_mover.

feddd56fbb-+-jenkins systemuser call was invalid

9b08187c52-+-Monitor MediaWiki fatals and exceptions in Ganglia

dd1e0d18ff-+-Drop extraneous slash from template path

5e6c1873c8-+-Merge "Parametrize and extend IPython Notebook class" into production

22a905b5c9-+-Parametrize and extend IPython Notebook class

cd13e8de80-+-correct jenkins master system role

ae12a5c2ee-+-fixing last non-boolean ganglia_aggregator

00c114096b-+-Swap string "true" for boolean true in $ganglia_aggregator

68cf2e8f38-+-db1004 to mdb, not 1028

e2009ceb70-+-db1028 to mariadb

bff1865e79-+-create jenkins user with systemuser

1a348f0613-+-systemuser learned 'managehome' (default true)

26127ae7fd-+-fixing missing comma

c41402bfce-+-Merge "tell users which username to use for LDAP auth" into production

d22f8536ce-+-tell users which username to use for LDAP auth

4df7b68fd8-+-Base puppet setup for antimony

8fd902ba04-+-Merge "zuul: drop dupe file reference in production" into production

5a809a678d-+-Setting setgid bit on $fundraising_log_directory/logs so that file_mover process can do its thang.

b75a758f86-+-zuul: drop dupe file reference in production

57ef61a514-+-zuul: fix missing git_dir class parameter

a18371d9f6-+-Merge "zuul: migrate git dir in production to the ssd" into production

55423c5d95-+-Merge "zuul: support specifying the git directory" into production

f43aef32fb-+-zuul: migrate git dir in production to the ssd

16737bf360-+-zuul: support specifying the git directory

7db7ade3a1-+-tweak fundraising banner log rotation script

6386ab0835-+-Merge "Add initial 'eventlogging::notebook' class" into production

fe8861805c-+-remove civicrm stock config, no reason to puppetize it

bd6b673d4b-+-preparing to switch s1/s5 masters

d81fb7d15e-+-Merge "do not quote booleans (true/false) or string "false" could actually be true" into production

f9174c77ae-+-Add initial 'eventlogging::notebook' class

6f871d37f3-+-Include webserver::php5 in the lamp role.

83b9c6cb5f-+-Added role::lamp::labs

70544c1d6f-+-Merge "Reverting back to declaring dependencies between compile puppet.conf and puppetmaster::ssl class." into production

99438bcbb9-+-Reverting back to declaring dependencies between compile puppet.conf and puppetmaster::ssl class.

995a669a6b-+-Merge "Ok, trying to require the 10-self.conf file as well" into production

fd9b796a9f-+-Ok, trying to require the 10-self.conf file as well

6c97e59a30-+-Merge "Explicitly defining relationship between cert generate and compile puppet.conf" into production

f948f532ca-+-Explicitly defining relationship between cert generate and compile puppet.conf

578fbae5ca-+-Merge "Move IRC bots from #mediawiki to #wikimedia-dev" into production

127d16f469-+-Merge "MongoDB on vanadium: bind all interfaces" into production

c3088b41f6-+-Merge "Attempting to solve puppet cert generate issue by using my own exec rather than puppetmaster::ssl's." into production

16c8cd8dee-+-MongoDB on vanadium: bind all interfaces

bf84b69b39-+-Attempting to solve puppet cert generate issue by using my own exec rather than puppetmaster::ssl's.

801f817444-+-Merge "Adjust wikibase dispatch batch size" into production

7b48f77291-+-Subscribing puppetmaster::ssl to compile puppet exec.

9d3c0cd466-+-do not quote booleans (true/false) or string "false" could actually be true

f43febc982-+-upgrading db1005

bfe5d2b8fd-+-reprovisioning db1058 as s5 mariadb

f337ed78e1-+-Merge "adding db51 as a snapshot host for s4" into production

a807ff1a95-+-Not generating puppetmaster self certificates until puppet.conf is compiled.

06c7016e75-+-adding db51 as a snapshot host for s4

43c9584144-+-syntax error

505310e6ed-+-forgot to ensure=>absent the old jgreen ssh key

47da5740c8-+-replacing ssh key for jgreen

02be90e95d-+-attempt to fix role::cache::mobile on labs

82f496d4f5-+-fix civi ./files directory privs

ec7c37f11a-+-Adjust wikibase dispatch batch size

58a2682b98-+-switching to stock drupal default.settings.php for test instance

20c2b647c9-+-wikidev is a group, not a user. fail

ca2a2d452a-+-modifying perms for fundraising civicrm & -dev code tree

37c905f989-+-include lvs::configuration in role::cache::configuration

53b13ef1ba-+-(bug 44041) adapt role::cache::mobile for beta

7bbcc6d521-+-mobile always uses role::cache::configuration

ba068b3f00-+-beta: adds ::site to bits_appservers backends

102c279caa-+-Move broken cron jobs back to hume and note what is wrong

0fa5f17aa7-+-Enable terbium cron jobs

aea6121f87-+-remove from singer: account awjrichards, group wikidev, svn client

dcd4d492f6-+-Add manage-nfs-volumes-daemon

f163a07eb2-+-Didn't work.  I'm not yet sure why ssh_authorized_key can't find the dandreescu user declaration :/

b7041d8b76-+-Attempting to set name to a different string for dandreescu's key.

404aa429a5-+-Attempting to properly remove dandreescu's ssh key

b8dbd97077-+-dandreescu ssh_authorized_key needs a different name too

45599b1fdb-+-Using a different $realname for dandreescu to avoid unixaccount conflict

28803c41b2-+-Setting manage_home to false for dandreescu - I don't want to delete the homedir there.

adab890897-+-Replacing Dan's dandreescu account with milimetric.

703d73c60c-+-add account abaso and add to mortals (RT-4956)

f19dd308e6-+-Merge "Set MPLCONFIGDIR env var for Matplotlib" into production

e81fa97b38-+-adding packages on db29 for pgehres

0106f3f46d-+-Merge "Add dysprosium to the eqiad upload pool" into production

1af1fdba2a-+-Merge "Sort the backend list to prevent constant reordering" into production

f3f2116aee-+-stat1 access for bsitu, kaldari, lwelling, mlitn (RT 4959)

a95fbc36c8-+-Luke Welling account info (stat1 access will be in next changeset)

5116026daf-+-Set MPLCONFIGDIR env var for Matplotlib

11ee1f01c9-+-adding db72 to s4 and db73 to s5

0a7240db3f-+-Merge "Ensuring puppet::self::client ssldir exists," into production

8367f4768f-+-Ensuring puppet::self::client ssldir exists,

7116474a5f-+-Merge "Using a different ssldir for self hosted puppet clients." into production

8ec428578f-+-Using a different ssldir for self hosted puppet clients.

08e534f6fa-+-Split labstore[34] from [12] (gluster->nfs)

276eaf06ae-+-Merge "Remove class 'analinterns' it is no longer used." into production

cb6c9e404d-+-Merge "Subscribing self puppetmaster service to class puppet::self::client." into production

c2e1c52f61-+-Subscribing self puppetmaster service to class puppet::self::client.

3280ad136a-+-Remove class 'analinterns' it is no longer used.

02205ad839-+-Remove special storage backend config for esams upload caches

de81ae1231-+-Reload VCL on varnish::common-vcl changes

be086a7b04-+-Double upload frontend cache size to 8 GB, on 96 GB boxes

997c29c27a-+-Add cp3008 to the pool

0444979272-+-dont duplicate wikimedia-task-appserver dependencies

6db630d499-+-Fix system_role title for role::jenkins::master::production

0ea26ca629-+-Ensure 'php5-parsekit' in contint

fbd76983bb-+-Merge "beta: fix sudo rights for mwdeploy user" into production

04d290b299-+-Merge "Refactoring puppetmaster::self to allow for puppet clients." into production

8da9e1b4d9-+-Refactoring puppetmaster::self to allow for puppet clients.

30d453d388-+-Allow jenkins admins to manage replicated git repos

255d9a89fa-+-Disable Fabian Kaelin's account, he no longer works with us.

a075712636-+-contint: jenkins master role + ssd directories

43833c19b5-+-gallium: SSD drive using XFS

edd4a43b2e-+-beta: fix sudo rights for mwdeploy user

97c1363b55-+-Update documentation for /root/.ssh/authorized_keys

e471ccae0a-+-adding db1016 as eqiad m1 snapshot host

e1a3127e49-+-Monitoring the udp2log instance on analytics1008

bad8742ddd-+-Fixing stat1 rsync udp2log module path

0d40692fbf-+-Reduce batch size for wikidata dispatcher

b871a03628-+-Set job dprioprocs back to 12 and iprioprocs to 6

b8e05e1e17-+-Prepping for emery upgrade to precise.

e62519a1e6-+-Merge "Add python-jsonschema & pymongo to EL dependencies" into production

a9a5051ef5-+-zuul: install python-extras module

7c039dc485-+-Add ack-grep to standard packages

9ad0532601-+-zuul: update python modules

16386e0b42-+-Revert "Disable LocalisationUpdate cron job"

61e191e844-+-Move IRC bots from #mediawiki to #wikimedia-dev

023cbb712c-+-Disable LocalisationUpdate cron job

c379456943-+-Getting rid of my fenari SSH agent

81cc300e43-+-comment for record keeping of dbs

3b7fdef412-+-Add python-jsonschema & pymongo to EL dependencies

8ff1288503-+-fix users/groups for civicrm

4dbee61723-+-adding db1001 to eqiad mq shard

df13cf6a37-+-Split openstack manager away from controller

3735c94ea4-+-Merge "including base statistics role in stat1002" into production

15aaf8e5fc-+-including base statistics role in stat1002

982a9e549b-+-Merge "have to include a group since no services are listed that do" into production

31cd5afc7d-+-have to include a group since no services are listed that do

68246e284c-+-finishing up making an rdb eqiad ganglia group

bb36f13707-+-RT 4920 stat1002 deployment

7ea0be9e77-+-Global jobqueue check: mwscript path fix

4a53d15762-+-Revert "make the planet logo a "per language" thing"

6be48a341e-+-comment out enwikijobqueue monitoring on hume til fixed

537051f99f-+-zuul: typo in labs status_url

552e5fb8e9-+-make sure mysql client is availavble for en wp job queue checks

2bf938b306-+-Bits varnish logging: set port correctly

fb86fafc5e-+-Varnish bits logging: set port and instance name

228cd35310-+-NRPE on bits caches

2ac2a77c14-+-Add UDP log to bits

f2264e7a97-+-make the planet logo a "per language" thing

54d5baca9d-+-resource references should now be capitalized

ebd76e02e4-+-remove duplicate definition of locales package

ec09aaefb8-+-turn planet into a puppet module

fb27b76707-+-missed updating class name for mgrover user

372745f087-+-RT 4600 Adding Michelle Grover to cluster access / stat1 access

332e8c1a4f-+-removing old user akhanna from cluster

fa89992689-+-rmeoving db1012 from unused db list

72e7c768dd-+-Install lilypond on Apache nodes (used by Score extension)

e53c8b5119-+-defining labsdbs

ea608b723d-+-RT 4796 adding Matt Flaschen to stat1 and alphabetizing the include accounts on stat1 entry

6b6e599c5c-+-Change 'mongofork' param to false by default

b79a66274d-+-Remove AFT ClickTracking set-up from emery

4bf613adb3-+-Add cp3007 to the pool

4bd8342a8b-+-Remove instance finish scripts

e0b7d541bd-+-MongoDB: don't fork; let upstart drive.

2d4967d6c2-+-move account awight from admins::restricted to admins::mortals (RT-4819)

0007c4866a-+-Remove gluster's broken logrotate script.

e6a10f8b85-+-Rework the RT manifests so it can be installed in Labs

5acf883d50-+-RT 4747 adding matthew walker to deploy access, if you break it, you buy it

21d419f667-+-Set 16 GB malloc storage for dysprosium's frontend

801c9e8953-+-pbuilder: cowbuilder image are prefixed with "base-"

d2640a55d3-+-pbuilder: get rid of `hardy` environnement

8b0e19d0b1-+-Add device detection to mobile ResourceLoader requests

2a246d487c-+-Adding puppet-merge for sockpuppet puppet merges.

a0248f6c6b-+-package-builder learned 'cowbuilder'

346e2a8b4b-+-updating labsdb role class

221329ed83-+-removing replaced hosts from s1

70edf6141f-+-converting db1021 to mariadb, adding db1058 to s1 for testing only

763eb09061-+-Fix paths to getJobQueueLengths.php from g37441

4ba16c3b89-+-converting db1050 (s1 snapshot) to mariadb and file-per-table

ee486ad931-+-including cpufrequtils in the sanitarium/labsdb db class

022cfd1b0b-+-some cleanup for multi_instance mysql

2e8c7d386a-+-Add IPv6 address to dysprosium

2eca8e889f-+-Add configuration for dysprosium (varnish performance test box)

550085096f-+-Add cp3006 to the pool

e941db46a8-+-Puppetize supervisor configs for EventLogging

4883a8d7f2-+-space -> _ in resource name

ad0f2c6dfa-+-different resource require different resource names

ccf157a8e8-+-adding per-node and per-instance monitoring for SANITARIUM

c2ae692dd9-+-cpufrequtils shouldn't be treated as a service, except to start at boot

a92f4b025f-+-lack of status from init.d/cpufrequitls breaks file change -> service refresh

1c64e6cb91-+-setting cpu frequency governor to performance on all coredbs

72ea94cdb2-+-Set up weekly jgit gc operations for all repositories

7af99a618a-+-module sets cpu frequency governor via cpufrequtils

f1fc97daac-+-Adding send stats to udp2log view as well.

b36aeeb8aa-+-Temporarily install apachebench on wtp1004

8cc273bc5c-+-Stacking some more values in udp2log ganglia view

e912896806-+-Add ganglia graph for global jobqueue length

55aa3a760a-+-Adding generic UDP stats to udp2log ganglia view

ab94e9b471-+-Moving inclusion of accounts::datasets to webstatscollector class

a9e7db0b79-+-Missing a /

fcc4dfe9c2-+-Setting up cron to delete old webstats dumps on gadolinium.

49592cf55f-+-Do a full MW clone instead of a shallow one.

766a5e99ca-+-Installing webstatscollector gzip cron on gadolinium.

8ae8303254-+-Revert "Temporarily depool cp1035 for persistent debugging"

1d15fe64aa-+-Now syncing sampled-1000 logs from gadolinium instead of emery.

3d21a4ab79-+-Temporarily depool cp1035 for persistent debugging

e102c7c340-+-Temporarily remove cp3003 from the cache pool

8785da594a-+-no longer decom

db5e78d208-+-Merge "decom xenon" into production

20e235ccb6-+-making caesium standard

ae60ba070c-+-decom xenon

c11cc496e6-+-temp removing caesium

95dba97ea4-+-Remove xenon and caesium from Parsoid service, RobH is reclaiming them

8a92aead59-+-Merge "setting ram to actually possible levels for the sanitarium" into production

192bf3352e-+-Merge "Add cp3005 to the pool" into production

f551402ddd-+-Add cp3005 to the pool

c326b49bec-+-Merge "Add cp3005/3006 to Puppet" into production

c5f9ddca20-+-Add cp3005/3006 to Puppet

fcb909e87e-+-Rsyncing API logs from emery to stat1

5d281f2384-+-contint: install ruby1.9.3

c3ce1d9ced-+-Trim extraneous " ssh-rsa " from SSH key

7190be3053-+-setting ram to actually possible levels for the sanitarium

12aa44cb67-+-Revert "Revert "making cp1021 to cp1036 into 2gig aggregated machines""

2acdf8da8d-+-Revert "making cp1021 to cp1036 into 2gig aggregated machines"

e977da38a7-+-making cp1021 to cp1036 into 2gig aggregated machines

c66afb8126-+-Merge "Don't require a specific version of opendj" into production

96dab5fef4-+-Don't require a specific version of opendj

9f83e4fcac-+-Merge "(RT 4835) Added yurik account for stat1 non-sudo" into production

0a4bfec358-+-(RT 4835) Added yurik account for stat1 non-sudo

805ce619f2-+-Merge "using db1057 for prelabsdb db instead of db1055" into production

815594a00d-+-using db1057 for prelabsdb db instead of db1055

4ad1fbc4df-+-Merge "need to include --defaults-file for init script to actually work" into production

746af70dc0-+-need to include --defaults-file for init script to actually work

dd3df4cb47-+-brandon black added to roots as new ops team member

ec478c8f47-+-Merge "Adding marc (Coren) as root" into production

1aa16d2ba0-+-Merge "Use https for public puppet repo remote" into production

49ff61e8f0-+-Adding marc (Coren) as root

c37f52fa03-+-Merge "can't repeat a key in a hash and expect it to work right" into production

2b07fc1b46-+-can't repeat a key in a hash and expect it to work right

4e16fcf6ee-+-Merge "grr. forgot ensure=>directory..." into production

02acd2c009-+-grr. forgot ensure=>directory...

8b7eea9adc-+-Merge "pre-labsdb dbs: more node defs" into production

d1e2aa1c43-+-pre-labsdb dbs: more node defs

be9d4d4b52-+-fix fundraising log rotation path

3af309e0c1-+-fundraising banner rotation tweaks

d5c731059d-+-move fundraising banner log collection pipeline from locke to gadolinium

ac892607b1-+-Sometimes order makes a difference with $ganglia_aggregator.

0a7cbb97ed-+-Need role::analytics on analytics1003-1006

893a1b63c8-+-Merge "Only analytics1003 and 1011 are ganglia aggregators" into production

83cf14b5cd-+-Only analytics1003 and 1011 are ganglia aggregators

b5fb59b064-+-Merge "Removing inherit on analytics1003-1006" into production

f49da84639-+-Removing inherit on analytics1003-1006

b55909238f-+-Merge "Abstracting out udp2log monitoring into its own define" into production

370f9b324e-+-Abstracting out udp2log monitoring into its own define

7adc154e0a-+-upload varnish: switch everything to Swift

2488e1b985-+-Reduce non-video job queue size from 320 to 144

1ab280c42f-+-Use https for public puppet repo remote

f0339a5237-+-Add script to update the interwiki cache

62a6982d25-+-Merge "trying the binasher namespacing model" into production

d93f6d3710-+-trying the binasher namespacing model

8c3a66b0be-+-Merge "using correct metavariable" into production

8955708990-+-using correct metavariable

232523baa3-+-Merge "correct usage of $title var for multi-instance mysql" into production

b49075ce69-+-correct usage of $title var for multi-instance mysql

6585f1d0a0-+-Merge "(RT 4863) Prune accounts from vanadium's manifest" into production

853c80479d-+-(RT 4863) Prune accounts from vanadium's manifest

e18dbc672b-+-Fixing Juliusz's ssh key

197f9213a0-+-Merge "Setting absent to a public id for chris johnson" into production

60cb1aefc3-+-Merge "really basic module for multiple instance of mysql on a node" into production

73a85788c6-+-Setting absent to a public id for chris johnson

4b995036f1-+-Adding rdb1/2 dhcpd

6fe33c1f4e-+-Merge "Ensuring ruby-json is installed on puppetmasters" into production

e7b827522f-+-Ensuring ruby-json is installed on puppetmasters

99699cbda8-+-Merge "Adding define ganglia::view for abstracting ganglia web views." into production

49334334af-+-Adding define ganglia::view for abstracting ganglia web views.

d188cb5e29-+-revoke tfinc's keys

9f9997c846-+-really basic module for multiple instance of mysql on a node

19c196c9b5-+-Merge "Add labs redis subclassing the main one and setting directory." into production

5e61f58075-+-Merge "Re-enabling htaccess on metrics.wikimedia.org" into production

c274ea06f0-+-Re-enabling htaccess on metrics.wikimedia.org

a429e2befe-+-old key of jgonera: ensure => absent

0935a3a83d-+-Merge "Fix up the mediawiki extension class a bit." into production

35a449c1b5-+-Adding class misc::monitoring::net::udp for generic udp statistics monitoring.

6320a184d7-+-Need single quotes since ${name} is literal

ba838756c4-+-Merge "contint: puppet doc now handled by Jenkins" into production

67fbfafd72-+-contint: puppet doc now handled by Jenkins

79e502a484-+-Merge "Consolidate gallium and formey replication" into production

c3eef047b3-+-Merge "Send analytics repos to #wikimedia-analytics" into production

e50a10d804-+-Merge "Drop "recurse => true" from EventLogging Ganglia resources" into production

3365d7035e-+-Drop "recurse => true" from EventLogging Ganglia resources

b41a98861a-+-eventlogging: fix file path

489360f616-+-Add 'eventlogging' puppet module

6253b69c3e-+-udp2log socket stats into ganglia, yay!

2b34a0753f-+-deactivating ganglios

eb4443bd88-+-Maxing user mod proxy is enabled for reportcard

f5af17c11b-+-Making sure mod rewrite is installed for stat1001 sites

5d7b54af2c-+-Fixing path to limn proxy vhost file since I've removed the dependence on the apache module

9312a7cdd7-+-Requiring that limn::instance is set up before limn::instance::proxy in misc::limn::instance

2aca8af37a-+-Removing logic to install and setup apache from limn::instance::proxy. You must do this yourself

adb0d271df-+-Adding misc/limn.pp to manage setup of WMF hosted limn sites. Installing reportcard.wikimedia.org on stat1001.

f16166d984-+-Fixing some more comments

e0f9d05da0-+-Fixing README and comments

a87d2f8501-+-Merge "Adding puppet Limn module." into production

457ecee55a-+-be more specific about *what* is broken in new search monitoring

c8ba8a691f-+-Merge "monitoring lucene search boxes" into production

46424a54d2-+-monitoring lucene search boxes

d91c63c760-+-terbium tweaking

1c002b3150-+-adding back fixed entries to terbium

482f1a4488-+-Don't use home for maintenance scripts where possible

97e64987f7-+-removing home dependent maint script entry

ac6f8c6a62-+-removal of home mount dependent entry

7a5af0d1f4-+-removing /home from terbium, death to nfs

38df50146f-+-Add labs redis subclassing the main one and setting directory.

a4d4e03b65-+-Add cp3004 to the esams upload pool

13cde88f21-+-Undoing the last change.  fqdn_rand generates the same number on the same host (duh.)

9f2c489694-+-Changing minute on misc::statistics::rsync_job to use fqdn_rand to spread out rsync jobs

2c8a2a8d50-+-Now using varnish hostnames to filter for mobile logs.  Now syncing mobile logs from gadolinium to stat1.

99a2ff46b0-+-Syncing edit logs from gadolinium instead of locke

9c69df29ef-+-Merge "Update cronjobs for wikidata" into production

21817b9aa9-+-Maybe not once per minute from 02:00 to 02:59

bf74fdc308-+-Add a cron job to clean up old MW logs

487942eb27-+-Install python-swiftclient on all Swift boxes

7b32288c7c-+-stupid nrpe can't restart properly, adding restart attr to puppet

405f2ea78d-+-Merge "fixing scope of icinga_config_dir in mysql.pp" into production

50b39ff068-+-fixing scope of icinga_config_dir in mysql.pp

976340e629-+-decom db11 - RT-4828

3d3b4926be-+-Merge "adding new s1 dbs" into production

970b5f331b-+-adding new s1 dbs

009eaf2a4f-+-Merge "removing search::monitoring include" into production

183e6d20ae-+-removing search::monitoring include

0e4fefcc90-+-moving some riad check specific things to be with raid check def

a1a03231ab-+-Merge "check lucene disk space is now redundant with general space mon" into production

05a0fdcc51-+-unlcear why this is still be used, but oh god stop the spam

125b78d436-+-check lucene disk space is now redundant with general space mon

da718c8b70-+-Merge "Puppetizing webstatscollector on gadolinium" into production

0abf021dcd-+-Puppetizing webstatscollector on gadolinium

8cc04454b7-+-only include nrpe checks on internal hosts

eaf812a690-+-Update cronjobs for wikidata

d8378e989b-+-Make the integration/zuul git latest -> present

6d49fda843-+-Merge "Relax checks for translation memory Solr" into production

2c8187890f-+-building db1056 for s1 (will be removing all hosts with 300GB drives from s1)

08dff0f076-+-Merge "Removing htaccess protection from metrics.wikimedia.org" into production

e034a68cb9-+-Removing htaccess protection from metrics.wikimedia.org

b0f9bebc7e-+-killing nagios templates directory

1623e5ed16-+-removing the last files out of the nagios directory

8071ba0b61-+-fixing percona check locations

ad7144409a-+-Merge "fixing percona checks to the correct icinga files / conf space" into production

60dd41ec08-+-Merge "cp/paste error" into production

626e4bb974-+-fixing percona checks to the correct icinga files / conf space

5670f303f6-+-cp/paste error

1f5f839de5-+-more nagios -> icinga cleanup

d390e3d819-+-switched media-storage to require ensure => present for nginx

e7d88828be-+-more moving files and nagios to icinga cleanup

39c2383dc7-+-Merge "adding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icinga" into production

bd1a7f1056-+-adding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icingaadding check_dpkg to files/icinga

2bc28c486a-+-big nagios cleanup, part 2

102e4dec57-+-Merge "part 1 of cleaning up files from nagios to icinga" into production

02f38c98be-+-part 1 of cleaning up files from nagios to icinga

b5f638d21a-+-Merge "check_check_ != check_" into production

d4db4180a9-+-check_check_ != check_

7c0f16b3e4-+-Fix up the mediawiki extension class a bit.

decdc683df-+-Merge "db67 -> mariadb" into production

078a8747c2-+-db67 -> mariadb

7fe7e2c2e6-+-Add httpry to base::standard-packages

5d642ded32-+-/usr/bin/local != /usr/local/bin

2487d9f908-+-re-enabling a lot of our monitoring that fall off the edge

ccf3bcb6de-+-Disabling packet loss monitor for nginx udp2log instance

f8603c6355-+-Adding puppet Limn module.

15846d6d03-+-Merge "Fixing ownership of fundraising log dirs" into production

feafcd0836-+-Fixing ownership of fundraising log dirs

ce18e89536-+-Merge "Saving nginx logs in separate directory to avoid udp2log::instance conflicts" into production

16f90cee94-+-Saving nginx logs in separate directory to avoid udp2log::instance conflicts

14d1a3531f-+-Merge "Fixing udp2log define usage" into production

c15b5152ad-+-Fixing udp2log define usage

ae32d3a213-+-Merge "Sending nginx logs to their own udp2log instance on gadolinium." into production

1f46331fc3-+-Sending nginx logs to their own udp2log instance on gadolinium.

1a16185136-+-Merge "Set default_ttl for esams upload to just 1 day" into production

61192ff0b3-+-Set default_ttl for esams upload to just 1 day

ab83f728a2-+-Disabling gerrit stats for now, it is broken :/

19073ac2e6-+-Upgrade bits Varnish packages to 3.0.3plus-rc1-wm8

f91de0c1b2-+-Don't backup GeoIP databases in the filebucket

7936307076-+-Use tabs as field separators for event logging

abbd856768-+-Merge "Revert "Cache 4xx responses on the mobile backend servers for 5m"" into production

b1a8584ca5-+-Revert "Cache 4xx responses on the mobile backend servers for 5m"

82fab8c6a1-+-Merge "insufficiently abusable, it would seem..." into production

9f98eb8ab9-+-insufficiently abusable, it would seem...

1209dbfb3c-+-Merge "let's see just how abusable puppet is...." into production

0950ee4530-+-let's see just how abusable puppet is....

fbbbdeda94-+-Merge "testing multiple mysql instances per host" into production

5b92c72091-+-testing multiple mysql instances per host

d02ad7ec2b-+-Merge "oh yeah, need the datadir..." into production

92a060f548-+-oh yeah, need the datadir...

058bcadcf3-+-Merge "have to call templates correctly..." into production

3746620a90-+-have to call templates correctly...

d6de086296-+-Merge "invoking mysql::config correctly" into production

25e5c76de7-+-invoking mysql::config correctly

5e78479dd5-+-Merge "also need correct typing" into production

192ef3d53a-+-also need correct typing

303f794959-+-Merge "correcting inline_template for sanitarium db def" into production

b8e35e122d-+-correcting inline_template for sanitarium db def

d70a3c20e7-+-Only 3 varnishncsa instances running, fixing logging_monitor.

55d11c00b8-+-Merge "WIP: first bit of stuff for taming the mysql module and making the SANITARIUM" into production

f54f3a07b5-+-WIP: first bit of stuff for taming the mysql module and making the SANITARIUM

f18191c917-+-Merge "puppetize haproxy (for brewster), the very basics (RT-4660)" into production

8aa0b39a8e-+-making sara enabled = false since she has left

996fe35e50-+-gadolinium now uses udp2log multicast relay.

1bf25ef227-+-puppetize haproxy (for brewster), the very basics (RT-4660)

f09ce7f0a0-+-Consolidate gallium and formey replication

0ef25b4f7c-+-Merge "add a contact group "parsoid" with Roan as member and add it to notifications for parsoid LVS monitoring checks (RT-4318)" into production

8636ac0fd6-+-Merge "setting up terbium, eqiad hume-ish host" into production

fb6091188d-+-setting up terbium, eqiad hume-ish host

32acd2c981-+-zuul: migrate to the new status url

eec5d4718c-+-add a contact group "parsoid" with Roan as member and add it to notifications for parsoid LVS monitoring checks (RT-4318)

b62e50fa09-+-Merge "Add cp3003 to the esams upload pool" into production

a796cdb706-+-Add cp3003 to the esams upload pool

9654adf4ba-+-Merge "proper comparisson for lsbrelease" into production

2dc5b6d135-+-proper comparisson for lsbrelease

e2636edc27-+-Merge "Reduce esams cache size, and compare persistent to file backend" into production

33ed90a184-+-Reduce esams cache size, and compare persistent to file backend

4636f99ab3-+-install timeout on all lucid nodes

d63570e80c-+-adding coreutils to base::puppet

a8f0f68d07-+-Send analytics repos to #wikimedia-analytics

bef86cbb3d-+-Cache 4xx responses on the mobile backend servers for 5m

e34b8e8db9-+-Relax checks for translation memory Solr

db4beb13a5-+-logmsbot is no more in #wikimedia-tech

d95f902769-+-Remove search::apple-dictionary-bridge from ekrem

8773d9dd35-+-Add libjpeg-turbo-progs to imagescalers for image rotation

b485021363-+-class typo

ac0be4d1e2-+-Merge "lanthanum to replace ekrem, after it works" into production

7f97ae27b8-+-Merge "run puppet by cron instead of via the agent" into production

82663099ea-+-run puppet by cron instead of via the agent

49d6d9b900-+-lanthanum to replace ekrem, after it works

fbd3e82cba-+-es100[69] to mariadb

bc8ce3a7d0-+-Merge "fixing logmsgbot to be in #operations and icinga's mysql packages" into production

7cc8d32467-+-fixing logmsgbot to be in #operations and icinga's mysql packages

6475a1c265-+-Revert "run puppet by cron instead of via the agent"

d842cc4b37-+-Merge "Revert "pulling fqdn_rand into class"" into production

f71a5a7d3a-+-Revert "pulling fqdn_rand into class"

85596c11e1-+-Merge "missing curly bracket" into production

e02eab5e10-+-missing curly bracket

03a746922a-+-Merge "pulling fqdn_rand into class" into production

e1feb4810d-+-pulling fqdn_rand into class

2461ed2021-+-Merge "adding db105[12]" into production

b9ce1d39d5-+-adding db105[12]

b942bc0f97-+-Merge "run puppet by cron instead of via the agent" into production

e78727e3c6-+-Merge "db1049 -> mariadb" into production

2b8f5111cf-+-run puppet by cron instead of via the agent

1af46a9468-+-db1049 -> mariadb

38dbb51ff7-+-Merge "Changing handrade's ssh key" into production

37b49b9fbc-+-Changing handrade's ssh key

781fd5f140-+-Merge "Adding Henrique Andrade and giving access on stat1." into production

e4f5a38b74-+-Adding Henrique Andrade and giving access on stat1.

ae74ca7b53-+-Merge "adding new apaches" into production

1352b02ad9-+-adding new apaches

390a0e19f6-+-Merge "(bug 45892) add second cron job for wikidata dispatching changes" into production

9d18e2ec25-+-Merge "converting the reset of s1 pmtpa to mariadb" into production

e6dab2e74f-+-converting the reset of s1 pmtpa to mariadb

f27a653e88-+-run every hour and fix single quotes problems

09a854bd5a-+-Merge "cron job to regenerate mobile apps stats" into production

1c1914298f-+-cron job to regenerate mobile apps stats

a37b134fe5-+-Fixing rsync module name

3590b8fbf4-+-Allowing rsync to /var/www from stat1 for hosting of public data.

9fcd8f0ad7-+-zuul: need python-voluptuous 0.6.1-1

0bb3fde2b7-+-Merge "Give nova a shell on nova-compute" into production

8541d5925f-+-Give nova a shell on nova-compute

1d383ff4ab-+-Merge "remove another requirement for apache2 package and fix unquoted resource names and unquoted file modes" into production

b89187afa1-+-remove another requirement for apache2 package and fix unquoted resource names and unquoted file modes

f4c38f0691-+-Merge "after removing docs generation this require for apache2 package broke puppet runs - remove dependency" into production

4c2f278eb2-+-after removing docs generation this require for apache2 package broke puppet runs - remove dependency

cecb2c7516-+-Merge "Change ownership of nova ssh config to nova" into production

5304164a3e-+-Change ownership of nova ssh config to nova

688bfe907f-+-Merge "Properly reference private repo" into production

97c5627062-+-Properly reference private repo

15ee98afe2-+-Merge "Add ssh key and authorized_keys for nova" into production

af87cf84ec-+-Add ssh key and authorized_keys for nova

beeb63bbd3-+-Merge "svn: Disable mwdocs and redirect to doc.wikimedia.org" into production

d7aa64f8cc-+-Merge "Include package ruby-jsduck on contint server." into production

92655dec73-+-Include package ruby-jsduck on contint server.

f1a6d29fb5-+-Fixing references to fqdn style virt certs

899cbaeb70-+-Update x509 auth for libvirt

dc4ca0c0e1-+-Add bond ip for network node in eqiad

73e40f40f0-+-remove protoproxy::ipv6_labs inclusion from site.pp

11da6b8720-+-Merge "delete ipv6and4.erb nginx site template and class from protoproxy, ipv6and4.labs has been removed" into production

b90d774d50-+-Merge "puppet-lint: fix most "=> on line isn't properly aligned for resource", and all "unquoted file mode" and "ensure found on line but it's not the first attribute"" into production

a526832247-+-Merge "puppet-lint: fix all "double quoted string containing no variables"" into production

c8e1a7e892-+-Merge "puppet-lint: fix "tab character found on line" by using :retab in vim with 2-space soft tabs (tabstop=2,shiftwidth=2,expandtab)" into production

e250a491a6-+-Merge "Upping number of expected varnishncsa instance to monitor (+gadolinium)" into production

b6a2bd66c1-+-puppet-lint: fix "tab character found on line" by using :retab in vim with 2-space soft tabs (tabstop=2,shiftwidth=2,expandtab)

fd6843b342-+-Upping number of expected varnishncsa instance to monitor (+gadolinium)

5e84b5e996-+-Merge "Adding gadolinium as a webrequest udp2log receiver." into production

05a1cf7d0e-+-Merge "puppet-lint: fix "ensure found on line but it's not the first attribute"" into production

a23aae56e9-+-Merge "puppet lint: fix "double quoted string containing no variables" and "quoted boolean value"s" into production

6360febf20-+-Merge "puppet-lint: fix "unquoted file mode" and "unquoted resource title" warnings" into production

741d5cf079-+-puppet-lint: fix most "=> on line isn't properly aligned for resource", and all "unquoted file mode" and "ensure found on line but it's not the first attribute"

70cabd4d51-+-puppet-lint: fix all "double quoted string containing no variables"

5fb7833854-+-Merge "puppet-lint: fix all "ERROR: tab character found", :retab with 2-space soft tabs per puppet style guide" into production

593272927d-+-puppet-lint: fix all "ERROR: tab character found", :retab with 2-space soft tabs per puppet style guide

ee0961a955-+-Adding gadolinium as a webrequest udp2log receiver.

f43db211b1-+-Merge "Turns out gadolinium is hard to type" into production

88e6087453-+-Turns out gadolinium is hard to type

4b020fd8c3-+-Merge "Setting up udp2log instance on gadolinium" into production

75a87d64c4-+-Setting up udp2log instance on gadolinium

1129227003-+-contint: libevent-dev on gallium

7846a8bd9b-+-Add eventlogging repo

2342e9d300-+-fix hostname regex

bd0e669e54-+-woops, incorrect use of quotes

154efced67-+-db69,71 to mariadb

a53ffe8ddb-+-puppet-lint: fix "ensure found on line but it's not the first attribute"

642a74f8ef-+-puppet lint: fix "double quoted string containing no variables" and "quoted boolean value"s

1604e02435-+-puppet-lint: fix "unquoted file mode" and "unquoted resource title" warnings

a3d082849d-+-Installing python-flask-login package for metrics.wikimedia.org

4f0b63ead2-+-Merge "mod. e3_analysis_path for use in metrics api package." into production

f7e3556b07-+-mod. e3_analysis_path for use in metrics api package.

dab60f7999-+-appserver: don't install a particular PHP version

2ed97db76a-+-Merge "followup Ibb454f8883bfa8" into production

4c4a90730a-+-Merge "change all $ircecho_server to use the chat record" into production

cdd41e3cd2-+-followup Ibb454f8883bfa8

7955377f13-+-Merge "make ircecho config sane (not just very long strings)" into production

3fae8b8ee9-+-change all $ircecho_server to use the chat record

defd76802f-+-make ircecho config sane (not just very long strings)

e82f0abb50-+-upgrading one db per core shard in eqiad to mariadb

140283fbb9-+-Merge "add. Some new global settings for metrics-api project." into production

72b3d59fe4-+-add. Some new global settings for metrics-api project.

8d1e862aac-+-add empty password class for eventlogging to passwords, to reflect addition in private repo

6b0cefb7d4-+-Need to include passwords::mysql::research

a83abfb108-+-Fixing email blog pageviews job

5f92e66f31-+-Fix dependency

84f4152c30-+-Install apache2-mpm-prefork instead of letting APT install -worker

921251e01d-+-Revert "Remove ensure => latest from webserver.pp"

34543664fc-+-Remove ensure => latest from webserver.pp

6fb59e38e5-+-security fix for stat1 cron job

c62fac9fee-+-stat1 cron job that emails out aggregate pageviews

78cf5de28e-+-delete ipv6and4.erb nginx site template and class from protoproxy, ipv6and4.labs has been removed

f3259c6ddd-+-Merge "udpprofile should be started at boot" into production

ebb6cfc81e-+-Merge "make redis persistence model configurable, use aof in role::redisdb and rdb for sessions" into production

db81f9d120-+-udpprofile should be started at boot

3734fbe8eb-+-restore integration.mediawiki.org config

3c4bab8595-+-Merge "Added optional wiki_name setting" into production

2b63b26583-+-contint: update codecoverage directory

7d86b20ed7-+-contint: integration.wikimedia.org was missing

3e40a83648-+-contint: dupe /srv/org/wikimedia

1c3f7af2ac-+-Merge "contint: Move integration site to wikimedia.org" into production

03410be1bd-+-Merge "jenkins now creates files group writable" into production

8d2a913c34-+-Merge "misc::docsite: Remove file "doc/index.html"." into production

81d34bc3bd-+-contint: Move integration site to wikimedia.org

ecfcfbd67d-+-Merge "contint: Fix permissions in /srv." into production

d0bdecbf7a-+-misc::docsite: Remove file "doc/index.html".

39abe2fd04-+-contint: Fix permissions in /srv.

74c6d250d4-+-jenkins now creates files group writable

ace5ae828b-+-Added optional wiki_name setting

82114d9b70-+-svn: Disable mwdocs and redirect to doc.wikimedia.org

3316561897-+-Added more extensions and their settings to Wikidata test clients

1ac49de1ac-+-Ensure package 'doxygen' on contint.

dde43aafe2-+-hdfs sync to stats.wikimedia.org on *:15

3c2ac7d92d-+-make redis persistence model configurable, use aof in role::redisdb and rdb for sessions

c61c483e29-+-fix class scoping

8dbe2e6599-+-initial redisdb role config patch set 2: ganglia config Change-Id: I819c79ba048fc14538db06a7aff956a9ca7f6460

6c37f969b5-+-s@node /db@node /^db@g

20261c126c-+-Merge "Revert "Manage aggregator instances through upstart directly"" into production

da4713ab5f-+-Revert "Manage aggregator instances through upstart directly"

4668ade1e4-+-Merge "puppetizing apache-fast-test qa script" into production

38eced6727-+-puppetizing apache-fast-test qa script

0c74f5c541-+-db1009 -> mariadb, max_cons -> 1000

017da50856-+-Merge "Manage aggregator instances through upstart directly" into production

1f1dae0eac-+-Manage aggregator instances through upstart directly

fc535c976e-+-remove contint web material

4a3ac7d6c6-+-migrate testswarm module to contint module

5387ae24be-+-contint: xdebug + code coverage directory

af84696b64-+-Merge "contint: move apache proxy configuration to module" into production

e7e31573b8-+-Merge "contint: move analytics packages to the contint module" into production

82b2e9ac2e-+-Merge "contint: move tmpfs disk to the module" into production

93f7cffe13-+-Merge "contint: get rid of Sun JDK" into production

25460a0603-+-Merge "Include the icinga system user in nrpe" into production

3aa6fd2d2e-+-contint: move apache proxy configuration to module

b36fc06ae5-+-contint: move tmpfs disk to the module

d6907ba891-+-contint: get rid of Sun JDK

c4e54eee8b-+-Include the icinga system user in nrpe

9f83a29782-+-Merge "Refer to inetd for amanda service" into production

6acae4ea20-+-Refer to inetd for amanda service

5118e39182-+-Merge "Deny another beam port and amanda by default" into production

ab434cc796-+-Merge "Fix novaconfig include for labs puppetmaster" into production

399adeb064-+-Fix novaconfig include for labs puppetmaster

bd4fc1e1fe-+-Deny another beam port and amanda by default

654e58aea8-+-Merge "Changing mobile to use the unified cert" into production

62d3dad07b-+-Changing mobile to use the unified cert

3e08891747-+-Merge "Remove the root certificate from the unified chain" into production

f9b265df8c-+-Merge "pushing the updated unified certificate" into production

0060c21ec8-+-Remove the root certificate from the unified chain

dccbe43e64-+-pushing the updated unified certificate

273b52c5b2-+-Fix gmond.conf expansion

aa8c401bcf-+-Fix notification

1501cb5fab-+-include network::constants

a377a19d5d-+-include ganglia_new::configuration

0320922341-+-Rename new Ganglia module again

bf327e56ba-+-Fix variable reference

86bac34da4-+-Fix module structure

85bf838083-+-Add top level init.pp, empty

f6aea1aa59-+-Change paths for file sources as well

d858a673ab-+-Rename instantiation

cc3d904b1b-+-Rename new module temporarily to resolve conflicts

75b97eed47-+-Actually make manutius a new, non-labs style Ganglia aggregator

8155384131-+-Make manutius a new-style Ganglia aggregator

6af1d11902-+-Fix dependencies

3fb4c1fdae-+-Move the upstart job for a normal gmond to ganglia::monitor::service

097b1d44ec-+-Attempt to avoid conflicts with the new Ganglia module

7e149e4278-+-Revert "Attempt to avoid conflicts with the new Ganglia module"

332c5a020c-+-Attempt to avoid conflicts with the new Ganglia module

587a309aca-+-Initial attempt at a new Ganglia module

782f320dc3-+-Outputting integers in python settings.py for metrics api

e0cf65d20c-+-Merge "add mholmquist to jenkins admins / sudo to restart jenkins/psql on gallium (RT-4676)" into production

26c5235a9e-+-Merge "Fix typo in certname" into production

8e96af254e-+-Fix typo in certname

576c4c6da3-+-Merge "Only modify mobile certificate" into production

56b49a1993-+-Only modify mobile certificate

fe4ba7f6c8-+-Merge "Unified is missing *.m.wikipedia.org, use original" into production

37691871fd-+-Unified is missing *.m.wikipedia.org, use original

796914f02b-+-Merge "adding null search shard for log silence" into production

62d347c134-+-Use latest php

841a71a4ac-+-adding null search shard for log silence

249c2e302f-+-Merge "changing ssl cert monitoring to 90 days" into production

d3f672db89-+-changing ssl cert monitoring to 90 days

d6e0b2abc6-+-removing celsus from decom

d6ba95dd62-+-Merge "Name the chain for unified" into production

d2a19425a9-+-Name the chain for unified

fe07cbedc6-+-cert is missing mediawiki.org

2cc90dfef6-+-contint: move analytics packages to the contint module

062848cea3-+-testing the new unified cert

060451520b-+-gadolinium replacing europium/locke

fa22ca24c2-+-reclaiming europium

58a34d1bd5-+-Merge "Prevent packages from getting automatically upgraded during Ganglia rework" into production

4f67525687-+-Prevent packages from getting automatically upgraded during Ganglia rework

5c7255e774-+-fix jenkins::group class

ab2111b722-+-contint::website regroups apache + basic files

a198374fee-+-Merge "Jenkins module created out of contint manifests" into production

32ea5ae066-+-Jenkins module created out of contint manifests

31aedb6c76-+-Create pbuilder images with ubuntu APT components main and universe

06b484ff6b-+-Merge "Initial dump in of puppet forge mysql module" into production

ab27aabb91-+-removing yuvipanda's user on stat1, adding on stat1001

f69ae7eee8-+-Initial dump in of puppet forge mysql module

ba4afe70a8-+-add mholmquist to jenkins admins / sudo to restart jenkins/psql on gallium (RT-4676)

a87aa06ef5-+-Fixing Dan's account

dce07c8f91-+-Merge "$ganglia_aggregator is not top level" into production

71106f1907-+-$ganglia_aggregator is not top level

c44de2a1f3-+-Unpuppetizing udp2log and fundraising stuff from europium until Jeff and I get coordinated.

88bfbc108a-+-Fully qualify global variables

68625c8645-+-Move misc::monitoring to where it belongs

16e114c687-+-varnish.py needs the instances to create the config file

3dae93dc3d-+-Fix path

9d3f2ac7fe-+-Rewrite varnish.py to use the varnishstat JSON interface

354433a645-+-Merge "moving all stuff in the ::mysql namespace to ::mysql_wmf" into production

6d034fb380-+-moving all stuff in the ::mysql namespace to ::mysql_wmf

dc81474a6d-+-Adding standard to formey

fb2efe0f10-+-Merge "We don't actually run any slaves, turn formey into a replicationdest" into production

767c94cce9-+-europium added

ecbd64f933-+-Merge "nrpe changed the IP of master server for labs" into production

e544161c08-+-Renaming metrics-api to metrics.

56d4c91aaf-+-Fixing path to api.wsgi

219a0f9e8d-+-(bug 45892) add second cron job for wikidata dispatching changes

d2c7bd8d7c-+-Disable the restart cron job, for now

b1135ff9f5-+-Merge "Revert "Revert "Restart bits varnish on cache allocation failures""" into production

154b132c68-+-Revert "Revert "Restart bits varnish on cache allocation failures""

aacc8b11a0-+-Merge "Revert "Restart bits varnish on cache allocation failures"" into production

45071cbbad-+-Revert "Restart bits varnish on cache allocation failures"

d24664b81e-+-nrpe changed the IP of master server for labs

d4969022a3-+-remove preilly account from zhen/silver (just cleanup, key was already gone)

51241aa0e5-+-removing include base::decommissioned from streber - it's not decom'ed, it actually runs RT, Observium and Rancid

9a25d78821-+-ensuring /etc/icinga exists

412f9128ad-+-Merge "correcting hash structure mistake" into production

12060ea61b-+-We don't actually run any slaves, turn formey into a replicationdest

d9d213efe0-+-Merge "fixing nrpe to be the new standard everywhere. Huzzah!" into production

e04f9fee88-+-fixing nrpe to be the new standard everywhere. Huzzah!

5a432b7163-+-correcting hash structure mistake

9f36839550-+-Merge "adapts lucene classes for beta" into production

62565d0182-+-Merge "merge ./misc/nagios.pp into icinga.pp" into production

eca1ed0267-+-Merge "icinga nagios cleanup" into production

9762230c79-+-Merge "Adding Babel, Translate, AbuseFilter to Wikidata repo." into production

ac44619ad0-+-icinga nagios cleanup

a6d8fd85e6-+-merge ./misc/nagios.pp into icinga.pp

1ea5a9f05a-+-Merge "Revert "make check_http (80) and check_tcp (8080) on install hosts a critical (paging) service"" into production

9353dad7b5-+-Revert "make check_http (80) and check_tcp (8080) on install hosts a critical (paging) service"

8e551b9f63-+-Merge "fixed typo" into production

261a9927ca-+-fixed typo

9d8a4401fb-+-Merge "derp. need to pass down" into production

6648be1adc-+-derp. need to pass down

ad9e7dac1d-+-Merge "setting 1 node per shard to innodb_file_per_table for conversion" into production

416ca576ef-+-setting 1 node per shard to innodb_file_per_table for conversion

78b55be297-+-Merge "Fix reference to gluster's upstart file" into production

0da2bcd70e-+-Fix reference to gluster's upstart file

eff280a4e2-+-Merge "Switch from upstart to init for glusterd" into production

b794350584-+-Switch from upstart to init for glusterd

6d6ddffc23-+-moving celsus to internal

1caf39cc1a-+-updating upgrade script and moving celsus to internal

9b816bb48b-+-removing cronspam on successful run, subscribing to correct files

0074798a72-+-adapts lucene classes for beta

a0d00facef-+-switching constable to internal ip

c614d0d125-+-Revert "make admins.pp handle additional unix groups, change ownership of script in fundraising.pp". Grr this is going to trip over broken things.

8d096b3215-+-make admins.pp handle additional unix groups, change ownership of script in fundraising.pp

1d1e6be0cd-+-Merge "fix script permissions" into production

3014fb401e-+-fix script permissions

138234a23a-+-Merge "cron for banner pipeline" into production

458dac9ded-+-cron for banner pipeline

f9f546c482-+-Merge "stuff for fundraising banner log pipeline" into production

2f6779bc4b-+-stuff for fundraising banner log pipeline

fc620f7e55-+-Merge "Configure hooks-bugzilla plugin for gerrit" into production

5e631034ba-+-Merge "puppetizing file_mover user for locke, including sudoers" into production

b6a91e859c-+-removing code for broken and no longer used sms dongle

d85fbc509f-+-puppetizing file_mover user for locke, including sudoers

f6fb303d6c-+-removing broken and redundant enwiki jobqueue check

f61f8d27f8-+-annotate disabled root accounts on include

bd6106649b-+-Merge "Ok. I give up trying to do this a sane way." into production

dff5523d02-+-Ok. I give up trying to do this a sane way.

9019963e7e-+-Merge "adding twemproxy to mediawiki::packages" into production

ae3741ee6d-+-Fix nova config for network bonds

b70c68c6f0-+-adding twemproxy to mediawiki::packages

e4438f5c80-+-Merge "site.pp changes for pmtpa x1 shard" into production

73516c7d52-+-site.pp changes for pmtpa x1 shard

8aac9d7283-+-going to reinstall constable as internal host

4984b5df5c-+-Adding parsoidcache ip to lvs and fixing ip on parsoidcache hosts

d8d140800f-+-LVS for Parsoid Varnish

3fc919fe41-+-Removing unused variables in metrics_api in statistics.pp

cdc23122ff-+-Merge "mod. update config info for E3 user metrics deployment." into production

cb70a9c3aa-+-mod. update config info for E3 user metrics deployment.

5fe29a07a9-+-Merge "Add python-pygments as dependency" into production

bbd90305f0-+-Merge "Configure network node differently" into production

53579e4df6-+-Configure network node differently

d581d06309-+-beta: adapt lucene search cron for beta

30fa3819d0-+-Merge "Set tag on bond interface, rather than eth1" into production

dc505dfef7-+-Set tag on bond interface, rather than eth1

46005d0a26-+-Merge "Move the ip into the role and below the bond" into production

bfc6a974d0-+-Move the ip into the role and below the bond

afb486f673-+-Merge "moving db36 and db38 to shard x1" into production

0b0482e381-+-Order bonding before tagging for network node

5834615b6a-+-moving db36 and db38 to shard x1

51353fb3ac-+-Split virt2 away from other virt nodes

300ec7df13-+-bonding virt2's second interface group

e2d5cd28bf-+-make check_http (80) and check_tcp (8080) on install hosts a critical (paging) service

a18e941f30-+-Adding Babel, Translate, AbuseFilter to Wikidata repo.

1fc9037050-+-Merge "using db71 instead of db70" into production

e9947683b6-+-Restart bits varnish on cache allocation failures

8e6c89c3a8-+-using db71 instead of db70

2c632de06a-+-Merge "adding db69 and db70 as pmtpa enwiki slaves" into production

05afd739c9-+-adding db69 and db70 as pmtpa enwiki slaves

9e64e44373-+-Merge "one more fix" into production

d59b32b8ec-+-one more fix

d69a9b8fef-+-making eqiad search pool4 awesome

d92115968e-+-Merge "Adding in nagios monitor classes" into production

8b76536d6f-+-Adding in nagios monitor classes

d69024b743-+-Merge "fixing the rest of the shit I forgot..." into production

03e3e87534-+-fixing the rest of the shit I forgot...

cf49dc763b-+-Merge "rename mediawiki_new to mediawiki" into production

3c550ec38d-+-decom'ing db27

67898bc633-+-rename mediawiki_new to mediawiki

f61cdea94b-+-migration to mediawiki module done!

757efb849d-+-Refactor mediawiki::singlenode and wikidata::singlenode into modules.

b4f3a0d895-+-Merge "correction: hooper is external" into production

75ff94056f-+-correction: hooper is external

b490b76d88-+-Merge "adding hooper and tarin as pmtpa misc ganglia aggregators" into production

76688246c3-+-adding hooper and tarin as pmtpa misc ganglia aggregators

0c10c9f9fd-+-Merge "Fix typo in labs adminbot config" into production

7bff762b58-+-Fix typo in labs adminbot config

d59b2eec06-+-Merge "turn bugzilla_report.php into template" into production

78cac29a1b-+-turn bugzilla_report.php into template

de8fb85570-+-fixing tmh role class to work with new jobrunner defs

9aa0c14ed1-+-Merge "Make pre-login sshd banner optional" into production

1c524ef5b8-+-good night spence

cb65292664-+-Merge "adding search_pool5 to lvs" into production

989e797a8e-+-adding search_pool5 to lvs

ffce8f8c86-+-Merge "change from explicit mariadb version to present while testing multiple versions" into production

47d96f071a-+-change from explicit mariadb version to present while testing multiple versions

41b6a67890-+-setting up search pool5 in pmtpa

54182b08a7-+-Rename labsconsole to wikitech

cbe40acd11-+-internally resharding the main indices of major projects within pool4 to fairly unused spell nodes [pmtpa only - for testing]

5dee4e9757-+-Use LDAP, requiring ops, for icinga admin

a5ecab9f8f-+-Make pre-login sshd banner optional

8543d723b1-+-merging all icinga configurations to one file

0017df8e92-+-adding in icinga-admin site

ecde65897a-+-Merge "Added a second pipeline for more immediate jobs." into production

fab31e74ad-+-fixing icinga-admin site

99b79681b2-+-Merge "(Preliminary) gridengine module" into production

cd11942504-+-turn off ircecho on nagios-wm / spence

9472c7ee54-+-fixed ssh key type for user sahar

a38e89df58-+-update ms-be12 entries in dhcp, site, clean up other ms-be entries

534bd5e737-+-Merge "nrpe-server is taking too long to stop and puppet times out - restart should hopefully work better" into production

a201498741-+-Merge "removing a whole bunch of unused db code" into production

6999427814-+-nrpe-server is taking too long to stop and puppet times out - restart should hopefully work better

d9f1fb1245-+-Merge "fix jenkins and zuul process monitoring (turn into NRPE checks)" into production

6abf681148-+-fix jenkins and zuul process monitoring (turn into NRPE checks)

89e67c2098-+-Merge "move ./templates/nagios/nrpe_local_icinga.cfg.erb to ./templates/icinga/nrpe_local.cfg.erb" into production

c7f48c3758-+-move ./templates/nagios/nrpe_local_icinga.cfg.erb to ./templates/icinga/nrpe_local.cfg.erb

053706bb7d-+-moving mysql nagios group resources to coredb.pp

b864f7499a-+-removing a whole bunch of unused db code

2f8f5d2f79-+-Merge "making nagios no longer page" into production

8859728141-+-(Preliminary) gridengine module

9b7cc6a135-+-add class nrpe to node gallium for jenkins/zuul monitoring via nrpe

14974262a5-+-making nagios no longer page

4c0b46548d-+-Merge "correcting Dan Andreescu account on stat1" into production

bad71b8beb-+-correcting Dan Andreescu account on stat1

acff0e15fb-+-Merge "Fix replication checks" into production

86182e156f-+-disabling duplicate account, seems it was included

bf56454949-+-duplicate key entry for dan's account, but duplicate entry isnt listed in any includes, so simply deleting it.

473605a7c2-+-Merge "change payments URL used in pybal/nagios checks" into production

53f3e94a46-+-change payments URL used in pybal/nagios checks

e269ad502f-+-Merge "adding dan andreescu per RT 4561" into production

e327f4fc3c-+-adding dan andreescu per RT 4561

3ae2c97591-+-fixing contint public ip ranges

33e1c7a429-+-Merge "Disable reactors for now" into production

f40ad2455c-+-Disable reactors for now

15b0b133ff-+-Fix replication checks

ce0a66108b-+-wtp1001 migration hosts, so decom to remove from nagios

7efaf33383-+-Added a second pipeline for more immediate jobs.

6e30f10ead-+-Merge "aluminium/grosley: add user saher, remove pcoombe" into production

ab61cfe042-+-aluminium/grosley: add user saher, remove pcoombe

eee2a3382e-+-Merge "fixing location" into production

5fd9dedd49-+-fixing location

de1583af1a-+-Merge "login def and key for Sahar Massachi (fundraising)" into production

6d656d0d1e-+-login def and key for Sahar Massachi (fundraising)

8fc09da23d-+-Merge "fixing solr plugin location" into production

ebd6671d28-+-fixing solr plugin location

3ab39aaa52-+-setting squid service to reload when notified

d9a82235e9-+-Merge "this too shall be quiet" into production

f65a3264c9-+-this too shall be quiet

035f3ff5c4-+-setting backup=> false on these large often changing configurations

2bdb0bccc7-+-Merge "Not running decom_servers.sh cron on virt0 or virt1000" into production

8da6b8ef0a-+-Not running decom_servers.sh cron on virt0 or virt1000

642025c322-+-dev/nulling some stdout from a couple of noisy crons

25f6331fe9-+-fixing ganglios on icinga

0860f0db9a-+-Merge "limesurvey.pp is dead" into production

6d4fbe416a-+-limesurvey.pp is dead

c86365ba4f-+-Merge "killing argon, as we dont need limesurvey anymore" into production

7b6e00e0bc-+-Merge "more cleanup of old mediawiki class" into production

bec11a7a93-+-killing argon, as we dont need limesurvey anymore

e23b5173aa-+-more cleanup of old mediawiki class

e83245c426-+-Add python-pygments as dependency

9e3d95fe9e-+-Merge "Updated the sharded containers list (added transcoded zone)." into production

2faa74667c-+-Merge "Change new deploy http accept range" into production

ca90fdaee1-+-Change new deploy http accept range

3e1921bf46-+-copper migration

038197c94e-+-Add wtp1002-4 to Parsoid deployment list

5d3084103a-+-Configure hooks-bugzilla plugin for gerrit

87ac57812f-+-Merge "Give the admins::parsoid group shell access to the Parsoid machine" into production

9d0b3d2165-+-I'm thinking that upstart_job regards true and "true" as not equal.

f158081345-+-Updated the sharded containers list (added transcoded zone).

38b1f779c7-+-Merge "Turn manage-volumes into a daemon" into production

59d53f7711-+-moving mediawiki-math package into pdf misc class

a40a4565b1-+-moving udpprofile out of mediawiki.pp into misc/udpprofile.pp

3bbdaebce4-+-more removal of old mediawiki class junk

69d8bfda22-+-another swithc away from old mediawiki::user class

9a8cd28f8a-+-increasing granularity of users in mediawiki_new module and making statistics.pp use module user def

1292d620dc-+-Merge "mariadb test boxes for pmtpa s2-5" into production

f200a26c5d-+-Turn manage-volumes into a daemon

00f5d33225-+-mariadb test boxes for pmtpa s2-5

314f02d4ff-+-wtp1002-1004 additions

de224feecb-+-Fix Solr nagios plugin invocation

7826b0ee29-+-Make check_solr work with Python 2.6

cdce3b85fa-+-Merge "Update gerrit /etc/default/* for init script" into production

543c78de1c-+-de-puppetizing my.cnf for db29 since it's a weird conf & short term use

eadcdbd0c8-+-Update gerrit /etc/default/* for init script

64fe9b848b-+-Merge "beta: lvs fake config for upload caches" into production

3c4ab6f5c2-+-Merge "New cluster key for me" into production

1e46f5c2e1-+-Merge "Changing my production key" into production

224cc7a307-+-Changing my production key

b9f4df34e9-+-Merge "Revoke Ariel's second key" into production

5cce36b032-+-New cluster key for me

a992711515-+-Maybe let the new key work

64fdacd13e-+-Revoke Ariel's second key

5fc7dccbb9-+-New cluster-local key for me

acb9ce8336-+-Revoke preilly's access

e849db1a57-+-db58 mariafication

95c62a0830-+-mariafication of db43

98a864c964-+-Merge "Changes forgotten in https://gerrit.wikimedia.org/r/#/c/49372/" into production

1a99c5f343-+-Fix test.m.wikipedia.org

109b66093d-+-fixing nagios false positive error for tower b in ps1-c3-sdtpa & ps1-d2-sdtpa

763d2794b9-+-Changes forgotten in https://gerrit.wikimedia.org/r/#/c/49372/

b53416568f-+-Merge "Fixing broken dependencies for updating mw-extensions" into production

d2f211de1e-+-Merge "Inline documentation for Wikidata's puppet files" into production

be1640c30d-+-Fixing broken dependencies for updating mw-extensions

41673af2e7-+-beta: lvs fake config for upload caches

2171567058-+-beta: lvs upload IP set to the apache backends

c95ccf9085-+-role::cache::upload now uses varnish on labs

11304fb6a1-+-Merge "giving yuvi panda access to stat1" into production

6e7a93a040-+-giving yuvi panda access to stat1

fcb04a8d52-+-Merge "adapt squid redirector for the beta context" into production

79961c9cba-+-adapt squid redirector for the beta context

fef43c7995-+-Removing include of ldap and nss on analytics nodes.

7eb05e76eb-+-Adding Analytics team members to 'stats' group.

83dd7f1d02-+-Merge "insert 'realm' in role::cache::configuration::active_nodes" into production

1ce704fad0-+-extract squid redirector to its own class

bdf5328837-+-check_solr, attempt 2

ac01203091-+-Add all applicationserver packages to nagios boxes

902fe6037d-+-Restore previous version of solr monitoring

420ca31fb8-+-Kill check_solr (at least in this form)

e44cdce28d-+-Add check_solr to Nagios too

2be8287b18-+-Give the admins::parsoid group shell access to the Parsoid machine

5c58f9c1b0-+-php packages for db29

8887c6f218-+-add roots to db29

67b6ba5c30-+-add gid=500 to db29

10cc4cf694-+-more classes for db29

b9cdf3ac28-+-add pgehres to db29

05eaf6cc6b-+-Fix missing $ca_name in ldap::server definition

3fdaab202e-+-LDAP: configure CA in the Nagios check properly

6fb6b0a970-+-Remove opendj and ldap client from nfs1/2

2b80a75885-+-Merge "adding in mw86-125 & updating decom for servers that are being reclaimed" into production

bd37a05017-+-adding in mw86-125 & updating decom for servers that are being reclaimed

fb1a759ef6-+-Merge "Puppetize the /var/lib/parsoid/Parsoid symlink" into production

4245e77a1d-+-Merge "eqiad half of new x1 (extension) coredb shard" into production

76380dcb32-+-eqiad half of new x1 (extension) coredb shard

e9badb2e51-+-Merge "Solr monitoring fixes" into production

66109b5555-+-Solr monitoring fixes

4115827a03-+-Merge "Adding --delete flag to hdfs::sync rsync command" into production

55d84434f0-+-Adding --delete flag to hdfs::sync rsync command

59640fb79a-+-Merge "Fixing hdfs::sync rsync command" into production

4bd261eca0-+-Fixing hdfs::sync rsync command

22397b07e2-+-building db29 for RT #4518

3339208571-+-Merge "Setting up sync from HDFS /wmf/public directory to stat1001 stats.wikimedia.org site." into production

b1d97ffff4-+-Merge "sync mediawiki only in production" into production

b4df319c71-+-Inline documentation for Wikidata's puppet files

5a79cc2ed9-+-Puppetize the /var/lib/parsoid/Parsoid symlink

7185e3aa50-+-Merge "gallium blessed with misc::package-builder" into production

dd88b2d8e5-+-gallium blessed with misc::package-builder

1a91e4d1e3-+-Setting up sync from HDFS /wmf/public directory to stat1001 stats.wikimedia.org site.

0c8d940201-+-Decomission srv266 & srv278

aea36931f9-+-Merge "mediawiki cgroup: cleanup the manifest" into production

a6438f78c4-+-Merge "Fix stupid copy/paste mistake that broke Nagios checks for Parsoid Varnish" into production

25e07de643-+-insert 'realm' in role::cache::configuration::active_nodes

630c2133fc-+-Merge "beta: /usr/local/apache dupe definition" into production

654c3c911c-+-Remove legacy settings now all mobile varnish servers are precise

d5b312f83d-+-Configure LVS cross row interfaces for row C

b00589a909-+-Fully qualify $hostname

9b5ee80b48-+-Merge "Revert "remove selector / FIXME for mobile varnish backends on lucid after reinstalls with precise"" into production

187fb1428f-+-Revert "remove selector / FIXME for mobile varnish backends on lucid after reinstalls with precise"

ac40af1247-+-Merge "remove selector / FIXME for mobile varnish backends on lucid after reinstalls with precise" into production

1f16e5a3f0-+-remove selector / FIXME for mobile varnish backends on lucid after reinstalls with precise

7f6d7014c1-+-Merge "let cp1043 use /srv/ instead of /a/ for varnish.persist file after reinstall with precise" into production

a327504444-+-let cp1043 use /srv/ instead of /a/ for varnish.persist file after reinstall with precise

6cdc3b6bcb-+-Fix stupid copy/paste mistake that broke Nagios checks for Parsoid Varnish

9effc78773-+-mediawiki cgroup: cleanup the manifest

3dbf40392a-+-Merge "One more s/praseodymium/titanium/ for Parsoid deployment stuff" into production

695c0b605c-+-Fix MW cgroup installation

35e60b9c04-+-Merge "Fix typo for ldap_replication service" into production

cb3b50ca86-+-add cgroup to limit memory of sub processes

f9b22d0f77-+-Fix typo for ldap_replication service

dbb929b7d9-+-Fix reference to moved directory for salt reactors

aa1b855a88-+-Fix salt_reactor argument

2c66f867b8-+-Firewall off ldap replication ports

f6a6cdcd8b-+-Add salt reactors for bootstrapping puppet

baf5bd55cb-+-Fix silly typo with previous commit

d71ba7a766-+-Adjust knsq24 for its broken disk

8d982ffbbe-+-reclaiming copper, magnesium, and zinc for use elsewhere

889cc05604-+-Merge "reviving db29 for use by pgehres" into production

f674289e71-+-reviving db29 for use by pgehres

1c31e028b5-+-db61 in sandbox

055415f273-+-virt1004 isnt presently in service, yanking from nagios checks

26dc1bd7fe-+-virt1001-1003 changed into pc1001-1003

712d95253f-+-storage1 decom, storage2 decom

0a0ddccdf2-+-Merge "Allow upstart jobs to be started after install" into production

ab905fb12a-+-Allow upstart jobs to be started after install

f29a436302-+-Merge "adding in mw1201-1220 into api & apache service" into production

9a4e297260-+-adding in mw1201-1220 into api & apache service

e9e4c52806-+-Merge "explicitly passing maxclients to applicationserver::config::apache" into production

3ddd15a86d-+-Merge "Enable RPS (Receive Packet Steering) on LVS balancers" into production

3faf9dcd06-+-Enable RPS (Receive Packet Steering) on LVS balancers

d7e4ad871a-+-Including stats system user on analytics nodes.

a336798fa1-+-Merge "beta: let mwdeploy run mwscript as the apache user" into production

7991e91b11-+-Remove statically configured test backend in favor of dynamic director

bbc99a6842-+-explicitly passing maxclients to applicationserver::config::apache

33d6657610-+-create a test.w.o role class to increase maxclients

36722c02d8-+-admins.pp: Add new key for 'krinkle'. Invalidate old key.

167bf3e0e5-+-Merge "Allow setting of MySQL bind address in NovaInstance config" into production

7dd0e6c081-+-db1047 => innodb_file_per_table = true

e793703f18-+-torblock script needs --force or it fails after cache expires

3595695150-+-Temp fix duplicate backend test_wikipedia

b252249cda-+-Allow setting of MySQL bind address in NovaInstance config

2d26b5ace6-+-Merge "contint: php-luasandbox to latest version" into production

f9a138ade2-+-remove old planet class from singer, new planet is on zirconium

b541f339fc-+-Merge "correcting thankfully not really disasterous typo in coredb.pp" into production

cac7c99739-+-correcting thankfully not really disasterous typo in coredb.pp

5c30ac0376-+-Merge "Fixing permissions on images folder" into production

cde3251a78-+-left out mw1199 in regex by mistake

173eaca16f-+-Merge "Fixing a typo in mw-extension" into production

efd478ef0a-+-contint: php-luasandbox to latest version

f5e5acfbc3-+-Merge "rfaulkner -> rfaulk. Fixes puppet on vanadium" into production

b217de51a3-+-Merge "adding r-cran-rmysql to stat1 for RT #4470" into production

2592474221-+-adding r-cran-rmysql to stat1 for RT #4470

fb27a2eb58-+-Decommissioning srv226-234 updating site.pp/decommissioning.pp and dhcpd file

1127d911fb-+-Adding Frank Schulenburg user and adding him on stat1.  RT 4475

44c0f3e301-+-Fixing duplicate package declaration on stat1

74d1f4c41b-+-Fixing permissions on images folder

301e5ef43c-+-Fixing a typo in mw-extension

aaf91fe8ee-+-rfaulkner -> rfaulk. Fixes puppet on vanadium

eb81eff400-+-Merge "Make Parsoid Varnish backend IP site dependent" into production

e2784a516d-+-Merge "new jobrunners/bit/image apaches should be apache/api per py" into production

f9368d5780-+-Merge "Lowering receive queue for Vumi udp2log instance" into production

695181661d-+-Lowering receive queue for Vumi udp2log instance

5a0b701ba6-+-Merge "Allowing udp2log instances to configure recv-queue in puppet." into production

02a0ecca06-+-Allowing udp2log instances to configure recv-queue in puppet.

a528642431-+-new jobrunners/bit/image apaches should be apache/api per py

33639d059c-+-Merge "narrowing scope of regex node matching for mw servers, added mw1161-mw1200" into production

cb935e6143-+-Fixing mode of /var/log/vumi/metrics.log

09a5167618-+-Ensuring /var/log/vumi/metrics.log is writeable by udp2log

f3005b9386-+-Merge "Updating to newer version of Vumi packages with metrics support." into production

21bdd22402-+-Updating to newer version of Vumi packages with metrics support.

d15a95a0c7-+-Logging to geoipupdate.log when running geoipupdate command. Ensuring that geoip packages are present, not latest.

09abd365f4-+-Make Parsoid Varnish backend IP site dependent

0f26b3fe4f-+-narrowing scope of regex node matching for mw servers, added mw1161-mw1200

5fd270dbbc-+-Merge "Adding very simple haproxy module." into production

bacd9f56cf-+-Adding very simple haproxy module.

1fb17a5124-+-Merge "Update EventLogging dependencies" into production

ecf86e3cdc-+-mw81-85 added as application servers

83a0b76423-+-Merge "new image scaler ganglia aggregators" into production

78de4855fd-+-new image scaler ganglia aggregators

51959c86e3-+-ms-be11 setup swift partitions sda3/sdb3

c076982999-+-mw75-mw80 new image scalers

7044e1f501-+-passwords.pp - Adding empty passwords::analytics class, s/svn/git/ in comment.

17f7c07550-+-Merge "Remove keystone patches" into production

65068453fa-+-Remove keystone patches

3e8eaf12b4-+-Merge "(bug 44603) Update planets hourly" into production

15a1c3e804-+-Merge "Removing git-core manifest from other servers" into production

f392e49dc0-+-Merge "use a simple Apache ports.conf with SSL (NameVirtualHost *:443) enabled without this being in default the first VirtualHost will take precedence" into production

92ce13bfab-+-use a simple Apache ports.conf with SSL (NameVirtualHost *:443) enabled without this being in default the first VirtualHost will take precedence

c8e2594c63-+-Merge "remove old planet (pre-venus) puppet class" into production

33065ff2a0-+-remove old planet (pre-venus) puppet class

841dab29df-+-Merge "generate separate Apache sites for each planet language from template instead of a single for all" into production

dba2f61cc4-+-generate separate Apache sites for each planet language from template instead of a single for all

70d4c4f342-+-sync mediawiki only in production

46062ebeed-+-beta: /usr/local/apache dupe definition

bb9c9a9974-+-Removing git-core manifest from other servers

8fa8637f76-+-Merge "removing srv190-192 and 194-224 from site.pp and dhcpd adding to decommission.pp Change-Id: I6f1a8986d0f1333a6f11982f6390383820ae39e8" into production

fe8ee18c08-+-removing srv190-192 and 194-224 from site.pp and dhcpd adding to decommission.pp Change-Id: I6f1a8986d0f1333a6f11982f6390383820ae39e8

dae67d3de5-+-adding check_mysql_slave_running for fundraising slave db's

3c230af59c-+-beta: let mwdeploy run mwscript as the apache user

e40f62fe34-+-Merge "Remove some whitespace that was confounding the doc generator." into production

83dd549770-+-Merge "Definition of a function that gets MW extensions with less code" into production

9a0f1db1ba-+-Merge "msfe1002 renamed back to element" into production

cd186f3682-+-msfe1002 renamed back to element

943ae773b1-+-Merge "move contint packages under a submodule" into production

e7af3a633a-+-Merge "Bug 44349 - updateSpecialPages is run twice on small wikis" into production

44e89a63df-+-move contint packages under a submodule

3f4b38c803-+-Definition of a function that gets MW extensions with less code

88db21dfd6-+-Install git on all servers

1a528278f3-+-Merge "cleanout testswarm from the manifests" into production

16c62c2118-+-cleanout testswarm from the manifests

58eb25a255-+-Added documentation to the Wikidata roles

965e9c0a1e-+-Merge "If pam ldap isn't enabled, then ensure it's absent" into production

4ecd8a0730-+-If pam ldap isn't enabled, then ensure it's absent

f54adf0c25-+-In mediawiki::singlenode use a more modest memcached size.

b1c37ccf9f-+-Merge "Replace deprecated pollForChanges.php on Wikidata client with dispatchChanges.php on repo" into production

177f7d3e2b-+-Update EventLogging dependencies

3ae1610d84-+-fix changed planet SSL cert name for relationship from 'Apache_module[rewrite]'

e66515be46-+-install star.planet.wm SSL cert instead of star.wm (RT-4468/3481)

ac88d91b5e-+-Replace deprecated pollForChanges.php on Wikidata client with dispatchChanges.php on repo

abcf4d04f7-+-Merge "planet: Remove obsolete comment." into production

595975e528-+-Fix test.m.wikipedia.org

e19bf277db-+-planet: Remove obsolete comment.

8145707c97-+-Merge "Add a variable to enable/disable experimental Wikidata features in labsconsole" into production

fd3047e5cc-+-stupid ganglios needs all sources.  :(

89aa7f8491-+-Apache logging to specific files for metrics-api vhost. Making these log files readable by wikidev.

b0222e742d-+-Adding $access_log and $error_log arguments to webserver::apache::site define.

e212a3ba0e-+-update gluster client packagename for dataset1001 gluster mount

89bc42bce5-+-contint: fix apache_site definition

8b8ee8b729-+-Merge "contint: enable qunit site" into production

c4a98695cb-+-Merge "pylint on contint server" into production

aa5af1ee3a-+-contint: enable qunit site

8ceccfcd8d-+-(bug 44603) Update planets hourly

0b3b2b5a36-+-Temporarily disable LVS checks for ms-fe.eqiad

5671a6c5a6-+-Make sure that adminbot can write to its logfile.

ce0130b8e1-+-try 2 for getting ganglios working

765a6b4b2e-+-Revert "ganglios requires gmetad.conf -- seeing if it is happy with a mostly empty one"

5a608532ab-+-ganglios requires gmetad.conf -- seeing if it is happy with a mostly empty one

b155af330b-+-Merge "Add Parsoid Varnish clusters to $data_sources as well as $ganglia_clusters" into production

77266ca8b4-+-Add Parsoid Varnish clusters to $data_sources as well as $ganglia_clusters

4c7be8ab9b-+-One more s/praseodymium/titanium/ for Parsoid deployment stuff

b4d3b93583-+-Merge "integration.mediawiki.org: Configure localhost:9412 for QUnit." into production

3f9a884459-+-replace the ugly HTML redirect from the old planet with a proper HTTP redirect ( RT-4410 )

12b8c274b1-+-Reenabling sqstat.

88e87c73f6-+-Merge "Now using tab as field delimiter in webrequest frontend cache logs." into production

6ee63d7111-+-Switch Ganglia to a 3.5.4 + security patches root

c494d29904-+-Now using tab as field delimiter in webrequest frontend cache logs.

47c94f06be-+-Merge "Removing apache_site 000_default* definitions in webserver::apache::site define." into production

5c3c5d247b-+-Removing apache_site 000_default* definitions in webserver::apache::site define.

0b8db5fb2a-+-Merge "switching db1047 to coredb reasearchdb role class" into production

edcf1c49b0-+-switching db1047 to coredb reasearchdb role class

433fc574a0-+-Merge "Ensuring udp2log package is present, not just latest." into production

357defbd27-+-Ensuring udp2log package is present, not just latest.

a644921517-+-Remove some whitespace that was confounding the doc generator.

04dc89aa23-+-Enable dispatch changes script for wikidata, disable pollforchanges

2596db0204-+-Merge "Pin labsconsole memcache to ubuntu version" into production

dd81de4702-+-Use the varnish probe for 2nd tier bits servers

09d59cba15-+-backends parameter is now unneeded for upload-backend

d39fabcfbe-+-Use lvs::configuration::service_ips for role::cache::upload backends

47c122e3fa-+-$::role::cache::configuration::active_nodes is not per-realm yet

898ec2afa1-+-Simplify mobile cache backend configuration

29c66fe48f-+-Apparently mobile frontend contacts test directly, redefine

397286a257-+-Define the API backend for mobile the proper way

3b8e4b9b1d-+-Remove superfluous backends parameters

786edb69cc-+-Calculate the backends parameter from values($directors) if not explicitly given

6040006de4-+-Remove $cluster_options[test_server], always set [test_hostname] as it shouldn't hurt

1fb8dade3b-+-Remove duplicate cluster_options definitions using stdlib merge()

2f91f6d7d1-+-Remove duplicate backends

3d29a8f768-+-Use stdlib values() to calculate varnish backends from directors

c5a63a3cc1-+-Move the logging into its own sub class

3ccf31ec59-+-Cleanup

6a19e399ef-+-Remove backends/director backends duplication

064ffcd3ad-+-$::mw_primary can now be used in realm labs as well

26eac44c10-+-Change to case statements

2769789c39-+-Set $::mw_primary to 'eqiad' in realm production, to $::site elsewhere

9884e377de-+-Simplify $test_hostname definition

d18cc625e0-+-Fix test_wikipedia in beta

dca7b63e97-+-Remove unnecessary $multiple_backends intermediary hash

307c71b29c-+-Define test backends again

9aff991bd7-+-include role::cache::configuration

345ff308f5-+-Replace some backend definitions by $::role::cache::configuration hash counterparts

4ce5fb6ae7-+-Add backends hash to role::cache::configuration

bc52a12b03-+-Use $::mw_primary for bits app servers

c4031a0405-+-Add a variable to enable/disable experimental Wikidata features in labsconsole

236afc9857-+-Pin labsconsole memcache to ubuntu version

397317584a-+-Merge "Split gluster into gluster-client/gluster-server" into production

8eeac4f855-+-Split gluster into gluster-client/gluster-server

490303aa7d-+-Merge "Changes for newer glusterfs packages" into production

eaeb2946da-+-Changes for newer glusterfs packages

db02eaef43-+-cleaning up debug notifies

4084196b7b-+-trying to fix slave monitoring logic for read-only masterless instances

e7e259ba51-+-debug: more notifies for debugging

d750626744-+-some var cleanup per faidon's suggestion

0a4417c8e4-+-Revert "debug: adding some notifies for troubleshooting"

37716a4ace-+-debug: adding some notifies for troubleshooting

e014dcce3e-+-switching es1 shard to coredb module

aa94cdf310-+-testing: swapping db1012 to coredb es1

2b237f226d-+-testing: making db1012 fake es1 host

b4c624a6e8-+-db box bookkeeping

c6b322bd8d-+-sync gdash graph definitions and actually deploy from puppet

cf050a1db9-+-Merge "flipped payments.wikimedia.org lvs monitoring from ptmpa to eqiad" into production

d450b446f5-+-flipped payments.wikimedia.org lvs monitoring from ptmpa to eqiad

825234ff22-+-Add image_scalers as backend also, not just director

72d8fdfe59-+-Add the image_scalers backend to varnish upload backends

2369304e84-+-Merge "Removing Moodbar extension from Wikidata setup" into production

bc8159c767-+-Merge "Create and set $wgCacheDir for Wikidata repo or client" into production

ee7d6d7759-+-pylint on contint server

2683934e02-+-Merge "MediaWiki repository is now offline" into production

5b48b4c6bc-+-Merge "fixing iptables on neon" into production

97fac73ed7-+-Merge "solr monitoring: must escape url for check to actually work..." into production

ffcaf98dd7-+-fixing iptables on neon

a6dc61e8a6-+-solr monitoring: must escape url for check to actually work...

ad68466410-+-i am not smart

7d2cff03e3-+-Merge "i need to read my changeset more closely" into production

68a9727bd4-+-i need to read my changeset more closely

f6b9ac69eb-+-Merge "giving spetrea access to analytics machines per rt4402" into production

8d42a5e842-+-giving spetrea access to analytics machines per rt4402

4c97b362a4-+-Merge "added user ram per rt4387, corrected space vs tab in chris s account stanza" into production

1b08c118d7-+-added user ram per rt4387, corrected space vs tab in chris s account stanza

0826947bfe-+-Merge "solr monitoring: order of options matters..." into production

74c1ce38ac-+-solr monitoring: order of options matters...

fa35e5ee6f-+-Merge "remove one more webserver::apache inclusion" into production

c60ec62786-+-remove one more webserver::apache inclusion

b6216100b8-+-Merge "add -e option and an expected of 200 to solr checks" into production

120b0edb5f-+-add -e option and an expected of 200 to solr checks

8262ead3e9-+-Merge "added sumanah to deployment access on cluster" into production

3b8836c0a9-+-added sumanah to deployment access on cluster

c04ba07041-+-removing webserver from being called multiple times and moving it to be called once

a026b63508-+-granting shell access to stat1001 to ryan faulkner per rt 4258

b260caa02e-+-Added variable to Wikidata client to enable other SiteIDS than "enwiki"

407e6248da-+-Merge "Fixed a copy and paste error" into production

799f10ff18-+-Merge "(bug 44118) contint: install pyflakes on gallium" into production

9ddddf5a95-+-I really am an idiot

7a6143cce8-+-Put cp3009/cp3010 in a standard frontend/backend configuration

9f3227c41f-+-Add cp3007-cp3009

da4bb9ab4f-+-Fixed a copy and paste error

df3d77f57f-+-Add cp3010 as upload varnish

d582540473-+-Removing Moodbar extension from Wikidata setup

ce7bbb08cd-+-Create and set $wgCacheDir for Wikidata repo or client

0ab69a101f-+-Merge "coredb: this should make everything set to migrate es1" into production

17d11524dd-+-coredb: this should make everything set to migrate es1

ecf6088ac3-+-barium & colby to become new dns servers

ccdb469b92-+-Bug 44349 - updateSpecialPages is run twice on small wikis

b8b9baabfc-+-mariadb pacakges. but only for those who really want them

87f0f9dae4-+-Merge "add interface_add_ip6_mapped for zirconium" into production

54cc7e46f0-+-Merge "backing out precise maria db repo" into production

305649a651-+-add interface_add_ip6_mapped for zirconium

336798965d-+-Merge "removing db1036 and db1033 from decom.pp" into production

83c5e875f3-+-ms1-4 are decommissioned

17f9d8c794-+-select mobile apache backend based on $mw_primary instead of hardcoding. this matches how the mobile api backed is selected.

cb078018ce-+-removing db1036 and db1033 from decom.pp

552303e1fd-+-Merge "coredb: removing slave-related nagios checks from shards with no master" into production

6a2717fd6a-+-coredb: removing slave-related nagios checks from shards with no master

3c0bbe27e2-+-Merge "Switching icinga to page us!" into production

763057ab5f-+-temporarily adding db1033 and db1036 to decom.pp to get them out of nagios

2611828a7f-+-Switching icinga to page us!

af13351ff7-+-backing out precise maria db repo

f9f7a30ffb-+-Switch Swift's thumbhost to eqiad

67d5e8a510-+-Removing space in Stefan's ssh key id

8fd5634b34-+-Adding Stefan's laptop ssh key

be0cc5ce2a-+-Kill remaining references to pybaltestfile.txt

467acdc344-+-Unmount upload-related NFS from everywhere

0df8fe17c3-+-MediaWiki repository is now offline

af9adc1abf-+-Merge "Reduce mobile varnish backend connection count to 600 (4x normal use)" into production

b23fa73754-+-Reduce mobile varnish backend connection count to 600 (4x normal use)

a99e396e15-+-Merge "Adding reactor support" into production

8630a40700-+-adding acct pkg to base::standard-packages

40d9f1b7d4-+-removing ill-defined memory check from kaulen

b6b6294ba8-+-Merge "adding user to calcium" into production

3e870a6bd1-+-adding user to calcium

a5c817d8e4-+-Merge "fixing ganglia for eqiad mc boxes" into production

cee1c1da83-+-fixing ganglia for eqiad mc boxes

01f31149a6-+-Merge "calcium not smokeping server for now" into production

5ea681429d-+-calcium not smokeping server for now

2fd4f2e1c3-+-Merge "moveing last role class out of site.pp" into production

dbc9d31c01-+-moveing last role class out of site.pp

e4935a8b26-+-adding colby back into standard installs

5ed195fc2f-+-Merge "removing some decommed boxes from site.pp" into production

75b77ed820-+-removing some decommed boxes from site.pp

b40c27c8ac-+-Merge "Remove legacy svn hooks" into production

5c1f685922-+-Minor fixes related to images

0237a4cc7e-+-Don't remove default apache site.

e9996afb8f-+-Remove legacy svn hooks

d9e82f1974-+-Refactor wikibugs manifest

988dace69b-+-remove the images::rsync(d) classes from use too (see change I8bf98650)

07757f4269-+-Merge "remove ./misc/images.pp with rsync image classes" into production

ac193a1cf7-+-Merge "(bug 42735) gerrit-wm IRC bot to #mediawiki-visualeditor" into production

3c91045ce8-+-Merge "use different CSS for Arabic, use a puppet selector within the file definition. took planet.css from old Arabic planet" into production

9b3d01789b-+-use different CSS for Arabic, use a puppet selector within the file definition. took planet.css from old Arabic planet

26a92a8491-+-fixing syntax error

c9fac364b5-+-removed old style definition of removing generic site

c8e9905dab-+-fixing icinga restart conditions

9408490d4d-+-Merge "modifying apache containing classes to ensure default site is absent" into production

34315e62ef-+-modifying apache containing classes to ensure default site is absent

c6533ca756-+-Moves Wikidata items to main namespace, imports main page to different namespace

6d21e735cb-+-BZ 26784 - Adding process monitoring for ircecho

96058bdcd1-+-Merge "Added variables to configure Wikibase client via labsconsole" into production

64743c4752-+-Merge "Icons for Wikidata demo instances" into production

6f738f7adf-+-adding syste_role to all application server role classes

8f2e593718-+-eqiad migration: setting masterdom by  $mw_primary

71029dc6a0-+-Merge "EQIAD SWITCH: switching job runners and tmh to eqiad" into production

f060fb3cea-+-Merge "EQIAD SWITCH: Migrate mobile backend appservers to eqiad" into production

d3eb14fa4f-+-Merge "EQIAD SWITCH: set $::mw_primary = eqiad (sets mobile api backend, redis+mha conf)" into production

f65bcc82ad-+-Merge "EQIAD SWITCH: Use eqiad bits app servers exclusively." into production

a75833ec6a-+-Merge "EQIAD SWITCH: Use eqiad bits app servers in eqiad (not in pmtpa)" into production

0e5efb8b0a-+-EQIAD SWITCH: switching job runners and tmh to eqiad

443045f08d-+-allowing jobrunners to be enabled or disabled via role class

496019f5f8-+-EQIAD SWITCH: Migrate mobile backend appservers to eqiad

7c572d99a4-+-EQIAD SWITCH: Use eqiad bits app servers exclusively.

ccdf5902ef-+-EQIAD SWITCH: Use eqiad bits app servers in eqiad (not in pmtpa)

21c7e82af1-+-Add misc_pmtpa and misc_eqiad hostgroups

8f832b0e51-+-Split apache off from applicationserver::packages

74aaba6df0-+-Added variables to configure Wikibase client via labsconsole

1ef2d04267-+-Introduce role::applicationserver::maintenance

ca4bb327f3-+-Fix duplicate definition error

8a295298d7-+-Remove apaches.pp

2f795a248f-+-Icons for Wikidata demo instances

e99787db61-+-Tidying up exec to use info direct from puppet

805886e9e9-+-EQIAD SWITCH: set $::mw_primary = eqiad (sets mobile api backend, redis+mha conf)

46a3f0c502-+-Merge "Add more explicit scopes for groups and users" into production

45560cb39e-+-Add more explicit scopes for groups and users

9ea2b08c7a-+-Merge "Use paged results in nslcd and set mininum uid" into production

ed9c6ffd90-+-Use paged results in nslcd and set mininum uid

431eaf9845-+-Since the hostname used in labs is not standard and does not match the one in monitoring snmp traps fail. Fake the hostname using the instancename configured locally and the site the instance is in.

dfc00f1f35-+-Disable thin_storeconfigs on virt0

6086db7206-+-Merge "explicit 0664 mode for /etc/logrotate.d/glusterlogs" into production

3530b74fd0-+-Use /monitoring/backend to monitor Swift

bb6d76e85f-+-Sending blog.wikimedia.org traffic logs to analytics1001 udp2log instance.

033fe5c6a9-+-explicit 0664 mode for /etc/logrotate.d/glusterlogs

f588b9246f-+-(bug 44118) contint: install pyflakes on gallium

2784fc2197-+-Revert "Test Ic5aab665 by temporarily "decommissioning" hume"

9549f28804-+-Test Ic5aab665 by temporarily "decommissioning" hume

bbc08758af-+-Better way to check for array membership

5e67644312-+-Don't use deprecated class apaches::packages for blogs

487f7c472a-+-Merge "Remove unused class "applicationserver_old"" into production

7fddf8a3ea-+-Remove unused class "applicationserver_old"

39cc0cc47f-+-select api backend certain mobile requests are routed to based on $::mw_primary

093b10a115-+-Merge "adding moar lvs checks for eqiad" into production

f3a3a50800-+-adding moar lvs checks for eqiad

722510e335-+-Merge "addingi n minute field to cronjob" into production

2ad235c101-+-addingi n minute field to cronjob

79ccc4782d-+-Merge "cp/paste error for mariadb repo" into production

8b1db56708-+-cp/paste error for mariadb repo

10966f1696-+-Merge "removing duplicate snmpd service entry" into production

8e79e78ab7-+-removing duplicate snmpd service entry

4882eac258-+-Merge "adding mariadb apt repo to mariadb boxes" into production

7247b31582-+-adding mariadb apt repo to mariadb boxes

5fdafafc4b-+-splitting snmpd and snmptrapd init files - pulling these in via puppet on icinga

a2bcd94228-+-Merge "added git-core to marmontel/blog server" into production

8c735f2a9d-+-added git-core to marmontel/blog server

1d6b4b1cc4-+-Merge "fix typo in docs.pp manifest" into production

cc9567fe37-+-fix typo in docs.pp manifest

f25a30585a-+-Dan already had an account on stat1. Adding him to locke, emery and oxygen.  RT 4312.

0a7bca6d42-+-Giving Dan Andreescu access on stat1.  RT 4312.

c8e901c6ba-+-Merge "integration.mediawiki.org: Remove old testswarm routing." into production

d3f7a1f7f2-+-Merge "temp measure to keep all jobrunner in eqiad stopped" into production

3dfb4ecfcb-+-temp measure to keep all jobrunner in eqiad stopped

b9d52db56a-+-Require mw-sync to finish successfully, if it runs at all, before starting Apache

575ec961db-+-Reload apache on initial config pull

c5466d18c7-+-Ensure Apache configuration is complete before attempting to start service

83c93de175-+-Pull in the WMF apache configuration if it doesn't exist yet

432a60468c-+-Merge "(bug 43819) liblua5.1-0-dev on gallium" into production

d576cf3cf8-+-Fix Bits application servers pmtpa group

d1d1e168da-+-Fix new scap sudoers

1f74badb08-+-Network-aware scap

1806e64f2f-+-Moved scap scripts to their own directory

4df272dc93-+-Merge "deploying mha powered db datacenter failover script" into production

6a2ea09ef6-+-finishing up spinup of tmh boxes for eqiad

6a411ace75-+-renaming old servers, added to decom to remove from nagios

b93db8fc8d-+-adding tmh1001 & tmh1002

8c55807746-+-forgot hour 20

08dc3155e7-+-doh, 0, not 24 for cron!

3b51cc1625-+-Merge "Puppet files to install Wikidata repo / client on different labs instances" into production

934e33a9b9-+-Merge "Compute the mysql version only if it's not specified externally." into production

879abb15d8-+-Merge "allowing irc bot to read the proper file for icinga" into production

2c94dd5b12-+-allowing irc bot to read the proper file for icinga

32558334df-+-Merge "snmptt restart" into production

c84648ae65-+-snmptt restart

d146211ca4-+-Compute the mysql version only if it's not specified externally.

bdc19e106e-+-deploying mha powered db datacenter failover script

0aa673e712-+-Merge "RT #2295: Run cleanupUploadStash across all wikis daily" into production

5add2569d5-+-RT #2295: Run cleanupUploadStash across all wikis daily

2fc6c1eec0-+-need git-core installed on mchenry to deploy wikibugs changes

da321fe52e-+-Merge "Add PHP Pear Mail_mime class to Apache manifest" into production

3537ad8366-+-Puppet files to install Wikidata repo / client on different labs instances

e1d4b567a9-+-Use full path in GeoData scripts to fix cron

49974c9886-+-GeoData scripts debugging

256c58107b-+-Merge "adding virt1008 to decom.pp" into production

160ebc7eeb-+-adding virt1008 to decom.pp

f3e28987e0-+-stashing $::mw_primary under /etc/mha/

133f332f63-+-Add PHP Pear Mail_mime class to Apache manifest

aa63312a76-+-adding mha config for the datacenter failover case make configs 0400

cc80242b3c-+-Merge "fix creation of $shards array from the top level keys of $role::coredb::config::topology" into production

dec071bf32-+-Merge "remove potassium from decom.pp" into production

5927685d0a-+-remove potassium from decom.pp

a35f4e4d68-+-both fixing icinga's misccommands to log correctly (and ircbot) and updating init script to use purge script

878179206b-+-fix creation of $shards array from the top level keys of $role::coredb::config::topology

9564ea08a7-+-Merge "more scope fixing" into production

b612647c9f-+-Merge "praseodymium sucks, replacing with titanium" into production

a4d7774157-+-Merge "Mysql version is now computed by the mysql class." into production

6028a0d945-+-Merge "Explicitly include packages in generic::mysql::server" into production

13abe70218-+-praseodymium sucks, replacing with titanium

b89af396ce-+-more scope fixing

badcfb93a0-+-Merge "struggles with scoping in puppet" into production

b5c676f7ec-+-struggles with scoping in puppet

fcd0a3a5ff-+-remove db1013 from fundraisingdb pool

664d38cb88-+-fix typo

d87d5633a4-+-Merge "initial mha config work" into production

e2fcfa6293-+-Add eqiad bits apaches as unused backends

a765e24f34-+-Mysql version is now computed by the mysql class.

13f94a8023-+-Explicitly include packages in generic::mysql::server

0a65c23e1b-+-Bind apaches, api and image scaler LVS service IPs to LVS balancers

7f973a0d2b-+-Correct LVS service IP for eqiad apaches

5f2e68a262-+-Deploy apaches, api and rendering LVS services in eqiad

001bb523b0-+-initial mha config work

d5ec6e2a65-+-Mount upload NFS on hume

be7b76a43d-+-adding $mw_primary to realm.pp, as redis and mha configs needs to be aware of which site is primary

c410dbbd86-+-Add and update variables for dblist locations

0a688b1e99-+-Merge "Widen the allowed deployment targets" into production

4a593d8728-+-Widen the allowed deployment targets

213383d2e1-+-Add the new eqiad Parsoid servers to the salt regex for deployment

e2cc47ab4b-+-eqiad parsoid caches need nagios group

dd172cbb4b-+-Merge "Use proper reference to Parsoid" into production

30c1a8c048-+-Merge "switching mysql.pp to check ubuntu distribution" into production

a7f904011e-+-Use proper reference to Parsoid

814a057d19-+-switching mysql.pp to check ubuntu distribution

3838d1efee-+-Merge "msfe1001/2 never in puppet, so no need to list here, opps" into production

975c1f265d-+-msfe1001/2 never in puppet, so no need to list here, opps

a42e397e46-+-Merge "remove global index.html.tmpl, they are created for every language" into production

c464ddf6ed-+-remove global index.html.tmpl, they are created for every language

a0646fc497-+-msfe1001-1002 to decom, cleaning up decom

d80b48a672-+-Merge "Switch all mw hosts to use tin" into production

2236d1ae0f-+-Switch all mw hosts to use tin

6cf9199279-+-integration.mediawiki.org: Remove old testswarm routing.

f2a919ac7e-+-integration.mediawiki.org: Configure localhost:9412 for QUnit.

0d0a6c2a89-+-replacing titanium role with praseodymium

5a20f7d946-+-Merge "a hat trick of bad regex..." into production

b35352182e-+-a hat trick of bad regex...

13b46fcf82-+-Merge "cerium & titanium deploying as parsoid caching" into production

279a552df6-+-cerium & titanium deploying as parsoid caching

633f2ff2a1-+-Revert "debug fundraisingdb's vs site.pp" to see if notpeter's fix fixed the issue I'm debugging

5370107635-+-debug fundraisingdb's vs site.pp

7f98e85655-+-Merge "fix regex for dbs" into production

560cbd7d61-+-fix regex for dbs

b485b6dd72-+-critical=>true for fundraisingdb nagios replication test

d25f12335e-+-remove fundraising-analytics apache virtualhost from aluminium

fe1fdab0f1-+-(bug 43819) liblua5.1-0-dev on gallium

c807c30a56-+-Merge "migrating pmtpa es3 shard to coredb-based role class" into production

cf348ab78f-+-migrating pmtpa es3 shard to coredb-based role class

1ad8fa3d91-+-Merge "migrating pmtpa es2 shard to coredb-based role class" into production

f31d294bfd-+-migrating pmtpa es2 shard to coredb-based role class

4de03ec0d1-+-Merge "moving all other pmtpa masters to coredb-based role classes" into production

481e3390ed-+-moving all other pmtpa masters to coredb-based role classes

cf55d9908d-+-Merge "moving pmtpa s5 master to coredb-based role class" into production

ee2aed0b6e-+-moving pmtpa s5 master to coredb-based role class

231b9787b0-+-Merge "db67 (researchdb) to coredb-based role class" into production

bd8b0799bb-+-db67 (researchdb) to coredb-based role class

01f42e89fc-+-Merge "switching .pmtpa.wmnet to use fqdn for certificate naming" into production

aef11a6d0e-+-Merge "some cleanup of db boxes in site.pp" into production

df5eb115bd-+-some cleanup of db boxes in site.pp

a35dd822a9-+-Merge "migrating pmtpa otrs dbs to coredb-based role classes" into production

82e7473e7b-+-migrating pmtpa otrs dbs to coredb-based role classes

6b30cf824c-+-Merge "migrating all pmtpa slaves to coredb-based roles" into production

deb6875513-+-migrating all pmtpa slaves to coredb-based roles

58d2708061-+-Merge "Temporarily remove file requirement" into production

47d3b9190c-+-Temporarily remove file requirement

f0e17d2846-+-Merge "Switch beta to new deployment scripts" into production

88a5917100-+-Switch beta to new deployment scripts

79929a4070-+-s2 master was incorrect

0fbd05f277-+-Merge "ganglia aggregator on db51" into production

a0c33db60d-+-ganglia aggregator on db51

6eaed39598-+-switching .pmtpa.wmnet to use fqdn for certificate naming

6d81d11e2d-+-Merge "migrating 1 box in s1-s7 in pmtpa to coredb" into production

79398a689c-+-migrating 1 box in s1-s7 in pmtpa to coredb

a6e64a65fb-+-let planet.css be created in every language subdir, but from the same source (for now)

85f4120e0b-+-clean up users on aluminium

83a5837646-+-Merge "cleanup of pmtpa dbs in site.pp" into production

1c46b13fa6-+-cleanup of pmtpa dbs in site.pp

7d594b0f08-+-deprecating aluminium's community-analytics vhost

025545ed4c-+-Add cron based poll for changes for huwiki deployment

f72e332bcd-+-Merge "white space" into production

6af0bd7c2c-+-white space

5f4f691880-+-Merge "splitting up the per-shard host list by datacenter to aid generation of mha configs" into production

ffc6f43985-+-splitting up the per-shard host list by datacenter to aid generation of mha configs

d3bfd3f5b5-+-Merge "decom storage3 - hardware issues per Chris and out of warranty (RT-4208)" into production

b8c39e0379-+-Merge "puppetize bugzilla_report.php, replace change I19d5da64: Clarify weekly report "top resolvers"" into production

f364f30bf3-+-puppetize bugzilla_report.php, replace change I19d5da64: Clarify weekly report "top resolvers"

7ce1089131-+-Merge "ganglios check requires mysql  !" into production

441a455fc3-+-ganglios check requires mysql  !

2f1fd9253f-+-Merge "rest of eqiad es2 and es3 to coredb roles" into production

3190c6cfe9-+-rest of eqiad es2 and es3 to coredb roles

2e4adf6b77-+-Merge "migrating es1007 and es1010 to coredb roles" into production

05f48f15dc-+-migrating es1007 and es1010 to coredb roles

5d9f6ebc99-+-Merge "moving ganglios to a more proper location" into production

57333fa214-+-moving ganglios to a more proper location

5848b6a0b5-+-Merge "moving m2 nodes in eqiad to coredb" into production

1b4b33aec9-+-moving m2 nodes in eqiad to coredb

f7560b3244-+-Merge "account for master/master case in coredb roles" into production

649af7ec39-+-account for master/master case in coredb roles

69ead1cc4f-+-Merge "arg, whitespace cleanup" into production

6930a456a2-+-arg, whitespace cleanup

7e8775862c-+-Merge "organize eqiad db node defs" into production

f1bf151553-+-organize eqiad db node defs

6a91b9d710-+-Merge "correct master logic for coredb role class" into production

018baea793-+-correct master logic for coredb role class

93ff4ce39d-+-Make github replication config forward compatible

17c121a771-+-Merge "Install plugins on Gerrit hosts" into production

62151a36b3-+-correcting regex

153c0f534a-+-migrating eqiad masters to coredb

0b94446d3c-+-mograting all eqiad slaves to coredb roles

0fb4ed1f16-+-db1001 ganglia aggregator

634743d4cd-+-migrating first round of eqiad DBs to coredb module. woo!

6f2c258045-+-Don't ensure the group as absent, it conflicts with the dependency

c5b7af2efb-+-Remove xinetd service entirely

30bf3b0cb5-+-Allow ensure => absent on systemuser

65654e3457-+-Remove extension distributor mess from fenari

d85a0f49b8-+-Merge "Cronjobs for GeoData" into production

9fcafa1f12-+-Cronjobs for GeoData

a312bb32ef-+-Add localization update as the l10n dep script

e3a4f16fec-+-replace SSH key for mflaschen - RT-4114

a14963339f-+-Delete remote branches when they're deleted in Gerrit

d39f5b1cdb-+-contint: mount dir must exist /var/lib/jenkins/tmpfs

3fba570545-+-Contint requires a 512M tmpfs file fs

65ef40d9ee-+-contint: packages needed to build WMF PHP extensions

bbb1dcfc20-+-Merge "git-deploy: rename slotmaster to beta0" into production

bdcac389c1-+-git-deploy: rename slotmaster to beta0

3d02da2101-+-wikidev group doesn't exist in labs

f0e65e9524-+-attempt to get mediawiki master under git deploy

8a472af2c3-+-(bug 43811) beta: fix autoupdater class

8609e26e46-+-Add private repo and fix reference to common repo

49eab8f659-+-Make secure actually pull its config from puppet

76f08ad03a-+-Don't proxy secure.wikimedia.org to the main apache cluster

27a966c9d7-+-Merge "Remove duplicate def" into production

153e616c0a-+-Remove duplicate def

da7fa38dcf-+-Merge "Add sudo policy to deployment hosts" into production

fee6f31e60-+-Merge "Add redis to deployment hosts" into production

bc179c1b76-+-Add sudo policy to deployment hosts

8f73e38a44-+-Add redis to deployment hosts

1592882568-+-Restart puppet every 4 hours instead of every 24

2e592d5f3e-+-Disable management of the pillars top file

3431c24936-+-Include packages conditionally

0a76cd87cb-+-Remove trailing slash on hostname for common repo

3fa6788a62-+-(bug 43339) deployment roles for beta

d939e56042-+-testing: set db1036 back to noon-module for retest

98a6c33a79-+-coredb: need to pass mariadb to common

907d84edc8-+-coredb: testing: ability to mark hosts as mariadb per node

0532856984-+-Script updates for the new deployment system

95c8154ec7-+-Split scap scripts from other scripts useful on deployment hosts

66293d6412-+-Merge "Added a few inline puppet docstrings." into production

ff21dfc9da-+-Added a few inline puppet docstrings.

5178f06a54-+-Merge "role::applicationserver::appserver::beta" into production

c85f52921c-+-Merge "fixing icinga purges" into production

f862870781-+-fixing icinga purges

4f5f133942-+-role::applicationserver::appserver::beta

ea074f64e4-+-Merge "fixing iptables::purges" into production

60a35bba3a-+-fixing iptables::purges

e09e2c30d0-+-Merge "phase out imagescaler::labs" into production

ed009bb191-+-phase out imagescaler::labs

2a81b6f9b8-+-expanding the eqiad ip range

ca11ac972c-+-beta: fix /dev/vdb mounting

34ad3d6607-+-$::realm is 'labs' not 'wmflabs'

bc74d2f503-+-Merge "(bug 43729) beta mw installs use /dev/vdb mounted on /srv" into production

ac4c7c6e0f-+-(bug 43729) beta mw installs use /dev/vdb mounted on /srv

010eca95d3-+-Move misc::url-downloader out of a completely unrelated file

c3a4e58a6f-+-Merge "Fix reference to l10n dependency script" into production

ff50999899-+-Fix reference to l10n dependency script

25a2078af1-+-Merge "Properly update submodules in a generic way" into production

1ff08c3438-+-Properly update submodules in a generic way

1b3e0f13ad-+-decom storage3 - hardware issues per Chris and out of warranty (RT-4208)

7e7c536f00-+-decom knsq25 - disk fail - RT-2918

73ec0b7a2c-+-Merge "Make /var/lib/parsoid owned by wikidev and g+ws, makes deploying easier" into production

583186d608-+-Merge "Follow up to I56379393" into production

c014bda901-+-Follow up to I56379393

916e46e8de-+-Merge "Add support for dependent repos" into production

86e05091e3-+-Merge "fixing some icinga errors - need libssl.so.0.9.8" into production

5609ab2f4f-+-fixing some icinga errors - need libssl.so.0.9.8

415e397b1c-+-Add support for dependent repos

f39301dbe5-+-Rotate all gluster logfiles, and only keep three weeks' worth.

df26e09ff1-+-Merge "Removing stats user from analytics nodes." into production

a9a52cd4cf-+-Removing stats user from analytics nodes.

bae3b3d4b5-+-ssh key for dab

9238ba2eca-+-ms-be5 moved to stanza for 720xd with ssds

ebaa440224-+-Merge "testing: making db1036 mariadb s4 slave" into production

cda54b0a80-+-testing: making db1036 mariadb s4 slave

657e7daec9-+-Merge "coredb: hacking in temporary mariadb support" into production

84ec839893-+-coredb: hacking in temporary mariadb support

a7db723a16-+-Merge "testing: cleanup from testing" into production

c6ee981cfa-+-testing: cleanup from testing

4623c124b7-+-Merge "coredb: cp/paste error for lucid package" into production

0e344bdaf4-+-coredb: cp/paste error for lucid package

1440536c2f-+-Merge "testing: db1036 set to use coredb s3" into production

ccae02c836-+-testing: db1036 set to use coredb s3

cff79e52da-+-add aaron, maryana, rfaulkner accounts to vanadium (RT-4139)

87547f33d8-+-adding caesium to parsoid eqiad cluster role

25d9edc02f-+-Merge "testing: actually db1036 as fake s3 master (lucid test)" into production

c71e0b1dda-+-testing: actually db1036 as fake s3 master (lucid test)

084d4e5e9d-+-Merge "testing: db61 and db62 with s3 and lucid" into production

5968dc1e27-+-testing: db61 and db62 with s3 and lucid

d9c1b22684-+-Merge "testing: further testing on s2/db62" into production

a384ebe6b4-+-testing: further testing on s2/db62

3ce9123621-+-Merge "Changed the ldap scripts to come from puppet rather than svn." into production

ffb8d4df2d-+-testing: also assinging to s2

7e2e293db6-+-testing: borked my testing. retesting db62

2ffc0cf5f0-+-testing: swapping db61 and db62 to coredb

67b95feee1-+-testing: db61 and db62 to s2 for testing

44d8d13a5a-+-Merge "Cronjob to delete old Solr logs" into production

770b41c172-+-Merge "Enable Solr replication" into production

31e6ea41db-+-Merge "Fixing undefined variable error for Redis module when $redis_replication was not set." into production

38b1fab750-+-Adding stats user to analytics nodes

24f6a1d799-+-Fixing undefined variable error for Redis module when $redis_replication was not set.

818dd4fd84-+-Adding reactor support

b8ab0cdda1-+-coredb: adding lucid support for packages

4c77fcb07e-+-coredb: innodb_log_file_size need to be set to match shard

6d777ce0bd-+-testing: swapping db62 to use coredb::research class

a5993dcd0b-+-testing: set db62 as researchdb

163785f5b6-+-Merge "coredb: addressing researchdb case" into production

9e8e246862-+-coredb: addressing researchdb case

b3d484f9f5-+-Merge "add parser cache purging script as cronjob on hume, per RT-2108" into production

d70e59345a-+-add parser cache purging script as cronjob on hume, per RT-2108

4de369b2bc-+-Merge "coredb: include slow_query_digest in a not ridiculous way" into production

57909ba863-+-Merge "adding no_master array to the db topology, to map to the mysql-master-ha "no_master=1" node config option. snapshot hosts plus hosts defined here will be excluded from consideration for master promotion." into production

4d27e5e672-+-coredb: include slow_query_digest in a not ridiculous way

204906358a-+-adding no_master array to the db topology, to map to the mysql-master-ha "no_master=1" node config option. snapshot hosts plus hosts defined here will be excluded from consideration for master promotion.

5d657ae37f-+-adding cmcmahon to admin.pp

cff110111e-+-fix scoping issue for solr role class

f53f67a775-+-coredb: es shards are now 100% inno.

954b145294-+-planet: have one theme config per language

701c2509e1-+-Merge "Work around a bug with TLS in opendj." into production

a6a40f5771-+-Merge "Fix template location" into production

3447fb163e-+-Fix template location

f26cfcf257-+-Work around a bug with TLS in opendj.

9510fb555c-+-Merge "Fix deploy state directory requirement" into production

451ff2b1fa-+-Fix deploy state directory requirement

29e1549384-+-Merge "Only define the directories if they aren't already" into production

ccb40dff85-+-Only define the directories if they aren't already

ef5d5d1e9f-+-Merge "swapping db61 and db62 to coredb stuffs for testing" into production

4f2bd1a749-+-swapping db61 and db62 to coredb stuffs for testing

b75c9ee5c7-+-Merge "Add the sync_all salt state" into production

60583ca52c-+-node def for pc100[1-3]

176248ead8-+-Add the sync_all salt state

85576afd6b-+-Merge "tarin migrated to pmtpa.wmnet and reinstalled" into production

8b217161a9-+-tarin migrated to pmtpa.wmnet and reinstalled

2bc3de0ea9-+-removing cruft from previous test

21672aad97-+-Merge "Move deploy-info to a non-root path" into production

660fc71251-+-Move deploy-info to a non-root path

eb0ad754fa-+-Merge "setting db61 as fake shard es2 master, and db62 as fake shard es2 slave" into production

88ac6b4857-+-Merge "once more, with feeling" into production

4bf1da88bc-+-once more, with feeling

92cc3c0dd5-+-setting db61 as fake shard es2 master, and db62 as fake shard es2 slave

3637d7e8e6-+-Merge "yttrium and tarin were decom for ip change, removing as both will go back in service" into production

e3b936eada-+-yttrium and tarin were decom for ip change, removing as both will go back in service

541933b107-+-for new icinga server, icinga-nrpe-server instead of nagios-nrpe-server

9f0dd913f8-+-Enable Solr replication

ba7de01469-+-corrected typo related to https://gerrit.wikimedia.org/r/#/c/36353/

a7a0113a23-+-Merge "Followup on 6782d9a, use include - not import" into production

55729ad2cf-+-Followup on 6782d9a, use include - not import

6cc6b5123b-+-Including Dan Andreescu on analytics nodes

8954299edb-+-tarin moving from wikimedia.org to pmtpa.wment

c64adbd249-+-Merge "Add deploy-info script to deployment hosts" into production

a0ce8712aa-+-Add deploy-info script to deployment hosts

6782d9a62f-+-fixing puppet error on certs.pp

36e70e0b6d-+-Merge "Actually deploy deploy_redis" into production

3195a4d4ff-+-Actually deploy deploy_redis

f0ae7d8db1-+-Merge "updating nrpe package" into production

7ade57c3ea-+-updating nrpe package

a519e51935-+-Merge "temp assigning db61 to es1 shard for testing" into production

f187eca44a-+-Merge "Switch to using the deploy_redis returner" into production

f4d881900c-+-temp assigning db61 to es1 shard for testing

86fae1938b-+-Switch to using the deploy_redis returner

f1afa33878-+-Merge "fixup for solr monitoring" into production

53e2226d1a-+-fixup for solr monitoring

799edad071-+-Merge "EventLogging varnishncsa: require query to match" into production

b60d909b86-+-Need to use single quotes for .htpasswd content.

d11ed22809-+-Fixing 'content' parameter name

ad232cbd17-+-Setting up .htpasswd file for E3 and metrics-api.wikimedia.org

66f2dc5440-+-EventLogging varnishncsa: require query to match

4c78c4f6dc-+-Merge "Add MongoDB to vanadium" into production

653ab98783-+-Merge "(RT 4139) vanadium: add 'mflaschen' w/sudo" into production

ab02cf1bca-+-dbtree: cache ganglia xml data every minute

91b25f8df2-+-fixing incorrect syntax in merged change Id4362fdc, jenkins failed to -1

59eb0a63ed-+-missing class parameter

112ce44a3d-+-Merge "memcached package should not be ensure latest" into production

32659eb5cc-+-Add MongoDB to vanadium

4b376ae4bd-+-(RT 4139) vanadium: add 'mflaschen' w/sudo

4fe4fb9395-+-memcached package should not be ensure latest

b9511a0d35-+-Refactor Solr stuff into a role

c2f98bcd56-+-fix for solr monitoring

151b706c7f-+-Merge "Solr monitoring" into production

ea9614a114-+-Merge "adding data sources for eqiad ganglia groups" into production

835a5dfb3a-+-enabling a cron for echo team

6450a736be-+-adding data sources for eqiad ganglia groups

4e32c9599b-+-Merge "Don't need to symlink to E3Analysis/src anymore" into production

9b531c6284-+-Don't need to symlink to E3Analysis/src anymore

a65318bdb8-+-Solr monitoring

7cf38b9663-+-Merge "Need to include passwords::mysql::research class, Also fixing commas in settings.py" into production

85a62da71a-+-Need to include passwords::mysql::research class, Also fixing commas in settings.py

67d02a0ce0-+-Merge "Removing invalid         WSGIRestrictStdout Off from metrics api VirtualHost" into production

07469ce575-+-Removing invalid         WSGIRestrictStdout Off from metrics api VirtualHost

a037a40182-+-Merge "Fixing docroot parameter for webserver::apache::site in metrics-api site" into production

d6f26ce34c-+-Fixing docroot parameter for webserver::apache::site in metrics-api site

8fba2da61f-+-Merge "Puppetizing E3's metrics API on stat1001" into production

14d884af23-+-Puppetizing E3's metrics API on stat1001

09cdeb8b86-+-Merge "Take yttrium out of rotation, everything has been moved to the new servers" into production

52291ebc95-+-Variable substitution between single-quotes doesn't work so well.

1c2d271ae1-+-Merge "lowering cache4xx to 1m (from 5m) for upload varnish instances. transient swift errors result in thumb.php 404's that should be valid, so shorter seems better here" into production

8599506a18-+-lowering cache4xx to 1m (from 5m) for upload varnish instances. transient swift errors result in thumb.php 404's that should be valid, so shorter seems better here

1a6b9f705f-+-Merge "redis replication config" into production

17d08be834-+-redis replication config

502e32f12a-+-fix check_command for fundraising tests

a7a979fdd4-+-fixing puppet+nagios+activemq+fundraising config

d12d15f3ec-+-Merge "removing depooled dbs" into production

9caea33128-+-removing depooled dbs

29f1881cd6-+-Merge "redis replication topology and mc eqiad node defs" into production

911280e839-+-added passive check_donations

f7fe7507a6-+-redis replication topology and mc eqiad node defs

d514ab316f-+-Added install_path param for wikidata.pp, files are affected by (https://gerrit.wikimedia.org/r/#/c/35313/2)

f665af0f09-+-wrong check_command for passive test

2fd2d0b54e-+-attempting to add passive check for activemq cclimbo queue

abdbbbc0bd-+-Changed the ldap scripts to come from puppet rather than svn.

6b979e7f54-+-Cronjob to delete old Solr logs

637021432e-+-recommissioning mw1001-mw1160

d1fcd9a827-+-adding eqiad imagescalers to site.pp

eb68af76dd-+-Merge "removing no longer needed mod to mysql path" into production

dfa4c93706-+-removing no longer needed mod to mysql path

f2312620f1-+-Including ldap on all analytics nodes

277d6d776d-+-Merge "Revert "Revert "Revert "Revert "Revert "flip flopping db61 manifests for another test"""""" into production

b1b381bb9e-+-Revert "Revert "Revert "Revert "Revert "flip flopping db61 manifests for another test"""""

e402a676bf-+-Monitoring analytics webrequest udp2log instances.

14b58f18b2-+-Fixing mediawiki .git url in class misc::statistics::mediawiki.

2b205d24ff-+-Enabling 4 accounts on stat1. See RT 4106

e834cd9084-+-Fixing eventlogging rsync so that there is an rsync module set up on vanadium.

1431219d82-+-Take yttrium out of rotation, everything has been moved to the new servers

c7182321d4-+-Install plugins on Gerrit hosts

ceac3f1bd0-+-ensure /etc/ssh/ssh_known_hosts is world readeable

672c388a53-+-Repurpose eqiad ms-fe/ms-be for Ceph

066e6ebeb8-+-Merge "fix syntax error in bugzilla.pp" into production

d6b30e8136-+-fix syntax error in bugzilla.pp

77b5baedb5-+-Merge "puppetize bugzilla community metrics "active users" stats script RT-3962" into production

a13ad4298e-+-puppetize bugzilla community metrics "active users" stats script RT-3962

89aef66f7b-+-Adding solr servers to yttrium stanza

82c92bfdf4-+-Merge "Use logrotate to archive log files" into production

37af2e5181-+-Use logrotate to archive log files

39d6c2a9f4-+-Merge "Bringing salt master thread count down." into production

dbfa1c0586-+-Bringing salt master thread count down.

b6731d8a4f-+-Oupgraded ganglia-web to latest version

79d041e3fc-+-Merge "add mflaschen and mholmquist keys and to mortals group per RT-4114/4115" into production

9cd0b657c4-+-Rsyncing event logs from vanadium into /a/eventlogging/archive

6c1bc4b47b-+-Merge "rsync eventlogging logs to stat1" into production

862f470f49-+-add mflaschen and mholmquist keys and to mortals group per RT-4114/4115

a1aa3bb31a-+-Adding $template_variables parameter to udp2log::instance.

cbaae54118-+-fix UID for maryana to 624, duplicate UID usage (609/csteipp)

452a8b7b0b-+-fix UID for sbernarding to 623, duplicate UID usage

3bcbc2d316-+-rsync eventlogging logs to stat1

5482612ea4-+-Fix duplicate definition of sudo_user

c6f2a862fb-+-sudo rights for CI admin RT #4101

7a20ec078d-+-Merge "shell access and mortals membership for gwicke per RT-4112" into production

e27d349c8d-+-shell access and mortals membership for gwicke per RT-4112

752d37870a-+-Merge "giving steve dctech access in admins" into production

ea72725d7a-+-Merge "Including event logging classes on stat1" into production

77a22e36a2-+-Including event logging classes on stat1

4959685f02-+-try default php conf files for snapshots for precise

fbbb3a5f68-+-Merge "sort nodes at the end of site.pp alphabetically" into production

3d1d33dd92-+-precise packages for snapshot hosts

6a126f4d87-+-Add eventlogging role; assign it to Vanadium

b3b52452b9-+-Merge "install python pep8 on contint server" into production

668ff899d1-+-sort nodes at the end of site.pp alphabetically

804764de4f-+-Turning replication back on, issue was host fingerprint and non-cloned repos

de6f3d7243-+-Ensuring RT 4106 accounts are absent until approval is given on the RT ticket.

7307b8e7e1-+-Fixing ssh key for jgonera

816c4bb6c1-+-Adding 4 users and giving access to stat1.  See RT 4106.

45473dc8a1-+-fundraising cron hour/min typo fixed

e6b69a513d-+-don't automatically upgrade packages for snapshot hosts

bbf1c4439b-+-Merge "need to remove from icinga def too" into production

4e024849c9-+-need to remove from icinga def too

47c8409c12-+-Merge "removing prototype from nagios" into production

7c26a71b8a-+-removing prototype from nagios

4f2077a19c-+-Merge "decom db62 - it is just a test host, so does not need to be in Nagios" into production

0a7845ef39-+-decom db62 - it is just a test host, so does not need to be in Nagios

72e7d37e8a-+-Gallium replication is not working, disable it for now

2c0f600ab1-+-Zuul role included a non existant class

9e4aa74d2f-+-Merge "replicate Gerrit repositories to contint server" into production

6e8e57bf0e-+-Merge "Forgot to add parsoidcache to ganglia.pp" into production

ac1249e35d-+-Forgot to add parsoidcache to ganglia.pp

ffd7d7627f-+-Merge "Puppetize Varnish on celsus and constable, remove them from the LVS VIP" into production

d41e99685c-+-Merge "Fixed a wrong class comment." into production

56963dd8d6-+-Merge "Disable dns_check for our minions" into production

06b0eeef7d-+-Fixed a wrong class comment.

3877a2e4eb-+-Disable dns_check for our minions

d138e31d78-+-Merge "Revert "Revert "Revert "Revert "flip flopping db61 manifests for another test""""" into production

0e7ec33dca-+-Revert "Revert "Revert "Revert "flip flopping db61 manifests for another test""""

5097052416-+-Merge "setting db61 to snapshot for more testing" into production

fca3c0c0c1-+-Puppetize Varnish on celsus and constable, remove them from the LVS VIP

907c219bc0-+-setting db61 to snapshot for more testing

a05194c46b-+-Merge "Don't restart the salt master on runner changes" into production

82e63718dc-+-Don't restart the salt master on runner changes

5513f9078d-+-Merge "revise master logic for coredb" into production

3a37603be0-+-revise master logic for coredb

5642da160f-+-Base is already included in standard

4659610a7b-+-Add service control to adminbot so it restarts as appropriate.

5e398889ce-+-Merge "Revert "Revert "Revert "flip flopping db61 manifests for another test"""" into production

d3c64f0844-+-Revert "Revert "Revert "flip flopping db61 manifests for another test"""

6088bcef59-+-Merge "Revert "Revert "flip flopping db61 manifests for another test""" into production

4cbebb710e-+-Revert "Revert "flip flopping db61 manifests for another test""

46e71f0d51-+-kill "test-star" cert, not used and now expired, less SSL cert confusion

439c656619-+-Merge "Have the parsoid config repo also restart parsoid" into production

ba6ae48083-+-Merge "decided not to control offhost_backups verbosity from puppet" into production

691b0ffb86-+-decided not to control offhost_backups verbosity from puppet

7005572311-+-install python pep8 on contint server

da6d1c4ea4-+-(bug 42735) gerrit-wm IRC bot to #mediawiki-visualeditor

2b8fa3b28f-+-replicate Gerrit repositories to contint server

982af7517e-+-fix l10nupdate class name

7b0f2979c6-+-Merge "correcting class name" into production

86d0959055-+-remove an old monitor_service for parsoid.pmtpa.wmnet

af2f4e7073-+-correcting class name

cb927315cf-+-fix monitoring parsoid.pmtpa.wmnet (typo)

b6e109502a-+-fix typo in l10nupdate accounts inclusion

779e4a2e28-+-Merge "testing master case for transition to coredb module" into production

f521aa06c8-+-testing master case for transition to coredb module

ba4365403f-+-Merge "Set ensure=>absent to kill the Nagios check for parsoid.svc.pmpta.wmnet (typo)" into production

0738148cfd-+-Have the parsoid config repo also restart parsoid

d44a97648f-+-Merge "Fix syntax error in module." into production

1acc06a857-+-Fix syntax error in module.

0c0c39f5a3-+-Merge "Make parsoid restart after checkout" into production

31a1657d2e-+-Merge "Add a restart function to parsoid module" into production

95dd13597a-+-Make parsoid restart after checkout

969f029d04-+-Add a restart function to parsoid module

69fb1e510d-+-Add a role for an analytics logbot

c05b902c4a-+-Fix minion regex for parsoid/Parsoid

23c5d64476-+-Merge "Make submodule checkout configurable" into production

2b232a5c42-+-Make submodule checkout configurable

390b081277-+-Merge "Add celsus and constable to Parsoid deployment role" into production

180e552c1c-+-Add celsus and constable to Parsoid deployment role

cef9b9a332-+-testing mariadb 5.5 on db59

283b393c56-+-Fix hostnames for celsus and constable

ec73c86242-+-Merge "adjust intervals for fundraising archive sync" into production

3e210ad69d-+-adjust intervals for fundraising archive sync

65669384ba-+-Merge "Puppetize adminbot" into production

eb1a982df1-+-Merge "Deploy Parsoid on celsus and constable" into production

9c02a45f9d-+-Deploy Parsoid on celsus and constable

8a062bb8cf-+-set innodb_version for mariadb 5.5 compat in DBUtil.py

39e1d26ec1-+-more fundraising manifest cleanup

d52a0b2c5e-+-Merge "Turning the wikidata cron back on, for debugging" into production

c9ac2c31da-+-Turning the wikidata cron back on, for debugging

8a20931d8f-+-typo in role/fundraising.pp min != minute

730bbddc91-+-fundraising manifest cleanup, prep archive script for hourly run

aaa6917fb8-+-Merge "coredb cnf to our standard" into production

b3e82c9091-+-coredb cnf to our standard

b90861809b-+-Merge "Increase worker threads for the salt master" into production

7077b1d2bd-+-Increase worker threads for the salt master

f555fd956f-+-Puppetize adminbot

0e848908a5-+-Revert "flip flopping db61 manifests for another test"

5afd6c2f37-+-flip flopping db61 manifests for another test

b7bc62e0bd-+-coredb: a bit more re-merging

ffe202f22b-+-Merge "puppetizing the unpuppetized crons for hume in http://wikitech.wikimedia.org/view/Cron_jobs#manual_cron_jobs" into production

2506ecd2e3-+-puppetizing the unpuppetized crons for hume in http://wikitech.wikimedia.org/view/Cron_jobs#manual_cron_jobs

1a37283bef-+-Merge "l10nupdate user required on these hosts for deployment rt # 4052" into production

a34a646c60-+-Yet another pmpta -> pmtpa

227e068f34-+-l10nupdate user required on these hosts for deployment rt # 4052

d591940a5c-+-Merge "make mobile wikipedia use new SSL cert and kill test-star afterwards" into production

6f86ce8780-+-make mobile wikipedia use new SSL cert and kill test-star afterwards

bc739976e4-+-add conf for civicrm amazon audit script

c241063218-+-Merge "Set up yttrium as a temp Solr server for GeoData" into production

c9c2fc3314-+-Added parsing modules for wikistats testing

4ff631c568-+-Merge "Remove denies from config - it's an incorrect rule" into production

1d0bd7a3ef-+-Remove denies from config - it's an incorrect rule

0684dd29b1-+-Merge "Install git-core for Parsoid, needed for git-deploy" into production

c65d7e9a6b-+-Install git-core for Parsoid, needed for git-deploy

c052b74b7e-+-Merge "Fix parsoid keys" into production

07ba90e8f7-+-Fix parsoid keys

f38bf419bc-+-Merge "Add parsoid module" into production

25cbe6003f-+-Add parsoid module

903dc5b35d-+-Merge "Add minion regex into deployment pillars" into production

6d4d2a4384-+-Add minion regex into deployment pillars

6ee7a0e564-+-Merge "Revert "swapping roles on db61 for testing"" into production

c7d7888441-+-Revert "swapping roles on db61 for testing"

58efd2e5d3-+-Merge "remerging mysql and coredb" into production

d7fbad20bc-+-Merge "fixing config dir" into production

cc93e435b0-+-fixing config dir

0507547479-+-Add missing variable to class

8ceeae9b80-+-Add support for calling modules in checkout

7246203af6-+-remerging mysql and coredb

c80a8a31a3-+-Ensure parsoid is listed in repo regex

75ec13340b-+-Merge "Add parsoid to git-deploy config" into production

21482e6c1a-+-Merge "fixing some directory permissions" into production

2a31153e62-+-fixing some directory permissions

be101131f2-+-Turn deployment minion regex into a hash

1524cd67c7-+-Add parsoid to git-deploy config

6145436750-+-Merge "wikibugs perl dependencies are needed for Jenkins" into production

98bb103b93-+-Disable cron for wikibase client polling

36fea10e13-+-Merge "Adding stopgap measure for testing wikidata client on test2wiki" into production

82e7ad9470-+-Merge "making screen not suck so badly" into production

55a5373f34-+-making screen not suck so badly

57a18b602a-+-Merge "siwtching nagios_config_dir to use /etc/icinga" into production

f7348a6b71-+-Merge "add icinga::nsca package class to icinga to get rid of requirements out of nagios::*" into production

56ff917f5a-+-siwtching nagios_config_dir to use /etc/icinga

4492ef797e-+-add icinga::nsca package class to icinga to get rid of requirements out of nagios::*

79079c7c4d-+-fixing class names again

a01fba403a-+-fixing icinga class name

19a14a70a1-+-Chanigng class name to icinga::monitor:;configuration::variables

fbb36c299b-+-Merge "icinga: fix class relationship after renamed config class" into production

06f9dc88c8-+-icinga: fix class relationship after renamed config class

6fd0f7f5d6-+-changing nagios files to fake ones for testing icinga

c1b1672112-+-icinga sprint: reverse order of config files and variables

a9412691b3-+-Merge "icinga: add some requires" into production

ec400d949f-+-icinga: add some requires

e48c470eb5-+-Setting varnich instance name for blog varnish logging to "".

95c900730b-+-Set ensure=>absent to kill the Nagios check for parsoid.svc.pmpta.wmnet (typo)

20498a2e0a-+-Adding stopgap measure for testing wikidata client on test2wiki

ad378321fc-+-Only prune down to the last day, table grows fast

68d3c772d5-+-add backupmover account to fundraising db dump boxes

9abf015c7d-+-wikibugs perl dependencies are needed for Jenkins

d4fbc7bc9d-+-Merge "Try using check_http_on_port instead of check_lvs_http_on_port for Parsoid monitoring" into production

703fcb9c8e-+-reversing the logic for whether my.cnf should contain facebook-patch only options

7642e7d248-+-var check fix

6b75bba6c6-+-our jenkins puppet test is broken :(

f998eab3fc-+-Merge "mariadb testing" into production

d240ffd163-+-Try using check_http_on_port instead of check_lvs_http_on_port for Parsoid monitoring

f79bbfb498-+-Another pmpta typo

a518b3ea16-+-mariadb testing

fb43b4fa24-+-Merge "swapping roles on db61 for testing" into production

8c8494b0b4-+-swapping roles on db61 for testing

9da76a7caa-+-Merge "add name for mysql user" into production

556be23114-+-add name for mysql user

87e4b7ac0d-+-Merge "coredb monitoring: remove uncalled for conditional" into production

75e7ac00a2-+-coredb monitoring: remove uncalled for conditional

be490c536a-+-Merge "coredb_mysql: attempting laner's hackaround for module/role class issue" into production

ca962b93a0-+-coredb_mysql: attempting laner's hackaround for module/role class issue

1a6ece7333-+-Setup SSL properly for doc.wikimedia.org

f228015304-+-Merge "Not monitoring varnishncsa instances for blog.wikimedia.org." into production

8bf369ab97-+-Attempting to fix Ganglia aggregation on wtp1/wtp1001

9016fff898-+-Not monitoring varnishncsa instances for blog.wikimedia.org.

c0da5f8eb1-+-Fix wtp1001 aggregator config as well

637b3dcbd9-+-Some nagios ganglia and nagios fixes

baccb846fd-+-Use mwdeploy instead of wikidev

59d080e104-+-cron syntax expects an array of values

cbbf8e9fa3-+-Adding wikidata repo prune script to hume's crons

722b1359fe-+-Set up yttrium as a temp Solr server for GeoData

ba5086c9cf-+-Merge "Setting up blog.wikimedia.org to send varnish logs to main udp2log stream." into production

1c2e6b7f16-+-broke with , fixing

281d2d9ea4-+-adding servers celsus and constable

379ddd00e8-+-retasking yttrium to internal vlan

6ba7b25598-+-Make /var/lib/parsoid owned by wikidev and g+ws, makes deploying easier

673b7b60a4-+-Fix nagios groups that are breaking nagios

1d2702eed4-+-adding nagios groups for parsoid

4f87d1cd81-+-Merge "icinga - remove requirement for config in service class (debug)" into production

8c238574aa-+-icinga - remove requirement for config in service class (debug)

e997b008c6-+-Merge "Fix reference to removed resource" into production

6647532808-+-Fix reference to removed resource

04c47eab1e-+-adjusting time for fundraising dump runs

6bf702265b-+-Merge "icinga - try to fix order of classes being applied by using arrow syntax" into production

ffe396cd8e-+-icinga - try to fix order of classes being applied by using arrow syntax

e150efc375-+-comma

3f0e4d7ba1-+-Parsoid puppetization changes:

a4c8bc700c-+-Merge "adding misc servers kuo mexia lardner tola" into production

93b57b40a0-+-adding misc servers kuo mexia lardner tola

56f4f4a167-+-including ldap labs role on an27

31150c5c4d-+-require icinga::monitor::packages in icinga::monitor::service because the package needs to create /etc/icinga before stuff can be put there

b6af528b98-+-re-enabled icinga class on neon

9dd34bd556-+-temp. disable icinga class on neon

26a556ca87-+-add simple index.html for doc.wm site

318d8d9f4b-+-Installing libdb-dev on gallium for webstatscollector build

af172d3f39-+-Merge "Need asciidoc for compiling gerrit" into production

00e96bade9-+-Setting up blog.wikimedia.org to send varnish logs to main udp2log stream.

313427b17a-+-Merge "Limit deployment webserver access to our networks" into production

8f0e1ebc0d-+-Limit deployment webserver access to our networks

5e3911e35b-+-Merge "Add ability to set allows and denies for docroot" into production

08a8bf17a6-+-Add ability to set allows and denies for docroot

16cb11f8d2-+-contint - do not install all of the huge ia32-libs, instead just install what is actually needed by Android SDK on a multiarch system. thanks paravoid

2489877091-+-add a system role for the new misc/docs class

2e3bba3f06-+-Merge "Remove a duplicate declaration" into production

ac9eb7847f-+-Merge "dont need to load Apache module SSL, getting it from parameterized class" into production

ae35a22244-+-dont need to load Apache module SSL, getting it from parameterized class

2a5dd2cb34-+-Merge "Don't add libapache2-mod-php5 here, we're now getting it from webserver::php5." into production

27184da407-+-Merge "Dep host needs appserver packages (like php)" into production

1f509b061d-+-Dep host needs appserver packages (like php)

8da568ffac-+-Merge "Add class for a doc site" into production

81d65d0045-+-Add class for a doc site

fa0a68c76d-+-Don't set up any apache stuff for puppetdocs.

5a8c94defb-+-mysql-client-5.5 for precise hosts

765b5db291-+-Need asciidoc for compiling gerrit

3ab2730a12-+-Merge "mysql::client : using mysqlfb client for precise" into production

f7aa93a428-+-mysql::client : using mysqlfb client for precise

8b3113f48d-+-Merge "Added in pmtpa row C and eqiad row C" into production

5f2aefbb70-+-deprecate fundraising dump config files

83994c2e3f-+-Move the puppetdoc websites out of /

3b00dd7b90-+-Remove a duplicate declaration

ed560529c5-+-Don't add libapache2-mod-php5 here, we're now getting it from webserver::php5.

769339c087-+-Use the slightly-more-modern parameterized def for apache.

0cfe7666c7-+-Install puppet docs on gallium.

f59759cbb0-+-ms-be3 gets new setup as 720xd with ssds

e5120faae2-+-Merge "Set pillar roots for production" into production

a27d335d3c-+-Set pillar roots for production

85462851c8-+-Merge "Allow tin to run deployment runners" into production

207b985c93-+-Allow tin to run deployment runners

42fefc81cc-+-Merge "Move slots out of common" into production

55cd4b1097-+-Move slots out of common

0898da7fca-+-Merge "Various git deploy fixes" into production

d36e8d638f-+-Various git deploy fixes

1f0af8d9ca-+-Merge "add librsvg2-2 package to gallium (integration)" into production

635e12fbe3-+-add librsvg2-2 package to gallium (integration)

d6404432d3-+-Merge "Revert "test hack coredb_mysql module"" into production

6941097557-+-Merge "Add grains for realm, site and cluster" into production

434eb0a81a-+-Revert "test hack coredb_mysql module"

a020459f80-+-Add grains for realm, site and cluster

a33227aee7-+-Merge "test hack coredb_mysql module" into production

81155011e9-+-test hack coredb_mysql module

a224592134-+-Merge "attempt to hack around more coredb issues" into production

0cf452464a-+-attempt to hack around more coredb issues

62fe3989f4-+-Merge "need to change name in role class as well" into production

6db0e97c29-+-Add a class to generate a puppet docs website

fc466b3ff2-+-need to change name in role class as well

bb61dcba4f-+-Merge "renaming coredb module to coredb_mysql to avoid module/role class namespace fuckery" into production

5e681d7468-+-renaming coredb module to coredb_mysql to avoid module/role class namespace fuckery

615debd21c-+-Merge "Fix another pmpta typo" into production

2ff036560d-+-Fix another pmpta typo

410d8f2946-+-Merge "Add the eqiad parsoid VIP to lvs1003/1004 as well" into production

abac2f19f0-+-Add the eqiad parsoid VIP to lvs1003/1004 as well

cc80771c8b-+-Add librsvg to contint puppet manifest

8f775df27c-+-Fix typo that probably broke Parsoid LVS

17efb3bd69-+-Merge "coredb: trying some madness" into production

92a5541927-+-coredb: trying some madness

8d0a79430a-+-Merge "Fix deployment repo locations" into production

c4375960b9-+-Fix deployment repo locations

b38f191755-+-Merge "Also add Parsoid to labs LVS, oops" into production

70084164af-+-Also add Parsoid to labs LVS, oops

8a83c35d22-+-Merge "Change deployment file locations to /srv" into production

ac3dcb24a8-+-Change deployment file locations to /srv

a6de61d36a-+-Merge "Add an LVS group for Parsoid" into production

68db1cb09e-+-Add an LVS group for Parsoid

db7cae18ee-+-Disable firewall for vhost I'm disabling

2d5e27fed1-+-Add required (but useless) variables to vhost

042f7bde22-+-Add apache vhost for deployment system

a700f21699-+-Add upstream apache module

98ab78fb42-+-Remove update-manager-core in labs

f5ced05b9f-+-analytics wants varnishncsa fields to be tab delimited

1115c381ba-+-Merge "Including base::sysctl in misc::udp2log::sysctl to make sure that start procps can be notified." into production

902987955d-+-Including base::sysctl in misc::udp2log::sysctl to make sure that start procps can be notified.

37c5f248fd-+-adding wtp1001 basic install stuff

e28afae45c-+-Add the install_path param for single-mode mediawiki.

f24243e0ea-+-Merge "Replace keep_up_to_date with ensure present/latest." into production

2f1bd8570a-+-Merge "Fix repo urls and module use of urls" into production

9b208bb2cb-+-Fix repo urls and module use of urls

21d3b9ee3a-+-remove ./misc/images.pp with rsync image classes

16d18a6db9-+-Merge "Refresh pillars on top change" into production

61349e8ffe-+-Refresh pillars on top change

26a584666e-+-Merge "Add top file for pillars" into production

acd10e208b-+-Add top file for pillars

8ebcfe8099-+-move rsync image classes to misc/images and DELETE misc-servers.pp ..yay..done (RT-720)

36afb84ebc-+-move misc::udpprofile::collector to mediawiki::udpprofile::collector and into mediawiki.pp (RT-720)

9b5ed447ff-+-Merge "setting db56 as new snapshot host for s7" into production

cf9a8cf322-+-Merge "Fix scope of definition" into production

fe6d85eeaf-+-Fix scope of definition

467d2e2fe2-+-setting db56 as new snapshot host for s7

0d4726f475-+-Merge "Add the linking into the correct class" into production

06e793e3ad-+-Add the linking into the correct class

47d8963f49-+-Merge "Add sync hook links for repos" into production

a3b83c2bb9-+-Add sync hook links for repos

3c69389f8b-+-Merge "Fix hookdir location" into production

935bbe3bbf-+-Fix hookdir location

5b659ba400-+-Merge "rename misc::dc-cam-transcoder to facilities::dc-cam-transcoder and move to facilities.pp (RT-720)" into production

d1f394a0c0-+-rename misc::dc-cam-transcoder to facilities::dc-cam-transcoder and move to facilities.pp (RT-720)

fae451a46f-+-Merge "Change some sync and log directory locations" into production

62bffe6c9e-+-Merge "Add shared sync hook" into production

8626693687-+-Merge "Change git-deploy.conf location" into production

cc8ef5af18-+-Change some sync and log directory locations

1a4d8ac1b2-+-Merge "setting coredb::common to inherit coredb::config" into production

0bb17390bb-+-setting coredb::common to inherit coredb::config

1c9fff8351-+-Add shared sync hook

668ff93a71-+-Merge "de-dupe file def for mysql ganglia" into production

d1380b2fd0-+-de-dupe file def for mysql ganglia

7b699831a7-+-Change git-deploy.conf location

cde0053e3c-+-Merge "Ensure git-core is installed" into production

ffbcae7d35-+-Ensure git-core is installed

ab436ffebc-+-Merge "puppet resources can't be accessed via salt:///" into production

2f47dcb337-+-puppet resources can't be accessed via salt:///

e653afbab2-+-Merge "Make tin the new git-deploy server" into production

f39313adef-+-Make tin the new git-deploy server

663b534ca8-+-Merge "coredb: more reasonable inhritence model" into production

8e62e0769f-+-coredb: more reasonable inhritence model

937ce9b503-+-move misc::survey to ./misc/limesurvey.pp and actuall call it limesurvey (RT-720)

707180d5dc-+-move misc::noc-wikimedia to ./misc/noc.pp (RT-720)

fc67cca9c8-+-Merge "setting db68 to be s7 box" into production

8a869ef0ab-+-setting db68 to be s7 box

14a7c8fe9c-+-No longer using analytics.pp, removing import.

eb326bd4ef-+-Merge "Using udp2log iptables rules on analytics1001" into production

6d278c396d-+-Using udp2log iptables rules on analytics1001

6b906dfa9a-+-Merge "No longer using manifests/analytics.pp" into production

a3e99b17bd-+-No longer using manifests/analytics.pp

006e0e94ff-+-Merge "Add remote host to Vanadium event log stream" into production

ba4ad5e287-+-Merge "event log stream from bits to kraken, in analytic's preferred log format" into production

12c0de9a3a-+-event log stream from bits to kraken, in analytic's preferred log format

2b2278b584-+-INcluding Erik M on analytics nodes

444e2d93c0-+-Add remote host to Vanadium event log stream

28162c4792-+-Merge "remove mysql server from host iron, remove firewall rules for mysql" into production

4c543af31f-+-Merge "move misc::monitoring::htcp-loss to ganglia.pp and misc::zfs::monitoring to ganglia.pp (RT-720)" into production

c4c5e78bec-+-giving steve dctech access in admins

b73f4b3c03-+-regex in salt is now -E, not -P

3dd099e7c4-+-Fix syntax error. How did the lint check miss this?

80bc1d6b2a-+-Fix dependency loop

4c67894083-+-pillar -> pillars

d81c62d5db-+-Fix requirement location for deploy module

aa50733397-+-Salt role fixes

8bb0560304-+-runner_dirs fixes

3c41e6e25e-+-Fix module and pillar refresh

4381f1a667-+-Merge "Add module, runner and add module directory" into production

d7c3bcda43-+-Add module, runner and add module directory

f644e8d34b-+-moving preilly to roots class

1c93601c46-+-lucene-search-2 "present" instead of "latest"

6ea6041e44-+-Replace keep_up_to_date with ensure present/latest.

b24a8f7ca4-+-yttrium moving from external to internal vlan

6362238883-+-Including Ori and Evan on analytics machines

c5384d1622-+-move misc::monitoring::htcp-loss to ganglia.pp and misc::zfs::monitoring to ganglia.pp (RT-720)

95ab238677-+-fixed typo

7153ca6b59-+-Merge "adding aluminium fundraising-ssl apache vhost" into production

24cadc4658-+-adding aluminium fundraising-ssl apache vhost

cf16c7d433-+-Merging duplicated java installation efforts into java module.

0805df4f39-+-convert java::openjdk to a define

d1541518a5-+-Add deployment code to sockpuppet

6d8cdfe795-+-Add a role for the deployment module

e14a1c2379-+-Initial commit of deployment module

05155b2884-+-move apple-dictionary-bridge out of misc-servers into search.pp and rename it from misc:: to search::

f4231e7f33-+-move "kiwix-mirror" from misc-servers.pp to download.pp

29fb7dcb1a-+-Merge "renamed misc::jenkins to misc::fundraising::jenkins" into production

0ccb9a198c-+-renamed misc::jenkins to misc::fundraising::jenkins

73721f824b-+-rename misc::extension-distributor to mediawiki::extension-distributor and move from misc-servers to mediawiki.pp

19fa1c2d7f-+-move misc::jenkins (the other jenkins) to fundraiser.pp

46d533008a-+-remove mysql server from host iron, remove firewall rules for mysql

489d2da156-+-Fixup to gerrit::backup removal. Wasn't unused everywhere.

9eae1adfe7-+-Merge "Removing some old cruft from gerrit manifests" into production

d8f6b25365-+-Merge "(bug 30720) Add links to Special:Code on mw.org" into production

850134ccb0-+-Gerrit notifications for Wikidata to their channel

d64039cbe7-+-adjust time of day for fundraising db dumps

180e61d559-+-Merge "Clean up gerrit's system_role declarations" into production

627027dc88-+-Merge "OpenJDK JRE/JDK on CI host" into production

d2354f39d7-+-Merge "java module and class to install OpenJDK" into production

63612f8769-+-Merge "increase number of concurrent transcoding jobs" into production

2b2245ff3e-+-Clean up gerrit's system_role declarations

bd1ca096e3-+-ms10 and ms1001 in one stanza

0dd376a18f-+-environment vars want = in cron stanza

840b3315f0-+-fix up the mirror classes structure

261c8d5547-+-test mirror role class on ms1001

21f912f2ba-+-add media mirror cron script

2ae04b5ccd-+-start of role class for media, dump mirrors

c94acd755e-+-Merge "move misc::nfs-server::home / misc::nfs-server::home:rsync from misc-servers to nfs.pp (RT-720)" into production

5f606887ff-+-Granting Dario access to Hadoop

2c0569cbc7-+-Merge "Fix gerritslave's environment so he can connect" into production

c892b02a99-+-setting all lucene nodes to latest version of lucene

ae1fe52d80-+-Merge "RT-804, umask for wikidev users, overwritten by /etc/profile on <= lucid" into production

301e9cb520-+-RT-804, umask for wikidev users, overwritten by /etc/profile on <= lucid

1ef44578bd-+-Installing geoip packages on contint server for udp-filter

e50826b67e-+-enable binlog on pc dbs with sync_binlog=0

7c3a25f71c-+-Fix gerritslave's environment so he can connect

c1f1fe1dc7-+-Allow upgrades of Varnish on upload cluster

056bac555f-+-Merge "zuul: support specifying a baseurl" into production

8922c1a8ba-+-zuul: support specifying a baseurl

a79199ec0c-+-ms1001 -> external-facing ip long since, updating stanza

30e46938da-+-OpenJDK JRE/JDK on CI host

ce965e179f-+-java module and class to install OpenJDK

6f1a612f7c-+-/etc/zuul/wikimedia no more belong to root

82c7aca7b9-+-rename zuul monitoring service

2e394a3b0f-+-Merge "deploy zuul on gallium" into production

216ff04ed4-+-ms-be6-8 and 10 in one stanza for 720xds, toss test stanza

e9e42e5294-+-path for mount command

37eba4057f-+-fix when we label swift filesystems, got test condition backwards

c65409958a-+-deploy zuul on gallium

69f1b5bba8-+-separate stanza for ms-be8 for test of fs labeling

827b0f441c-+-ms-be8 as 720xd with ssds last in disk layout

1db2cb8c79-+-Merge "provide for xfs filesystem labels without making the filesystem (ms-bexx)" into production

a58bc22d0d-+-provide for xfs filesystem labels without making the filesystem (ms-bexx)

c3d7bb98c6-+-Merge "Fixing SSLCACertificateFile for Gerrit" into production

c91ce1e5e2-+-Merge "Kill wlm.wikimedia.org with fire" into production

975883a118-+-Kill wlm.wikimedia.org with fire

bb5140cf12-+-Use proper SSH key for replication

5822b2c4f3-+-Fix up more naming issues with gerrit manifest

6ead56573f-+-Merge "Rename groups to extra_groups" into production

d091216a6d-+-Rename groups to extra_groups

ee8c29ce62-+-Merge "Stop using gerrit2 for replication purposes" into production

05e65b1220-+-removing old applicationserver role classes from site.pp

7729215eef-+-Stop using gerrit2 for replication purposes

6c1e300146-+-Removing some old cruft from gerrit manifests

933eab4b1b-+-Merge "Added puppet files for Wikidata on labs" into production

39a3fc379e-+-Merge "zuul: fix url_pattern on labs" into production

0eae5cf296-+-Added puppet files for Wikidata on labs

b2be65a175-+-mount points and fstab for ssds on ms-be hosts

fba0d13b6c-+-typo

dfdccf0f6e-+-last apache upgrades

05974ff7df-+-Merge "ganglia plugin for nginx stats" into production

b44f4d784d-+-ganglia plugin for nginx stats

fa89839da9-+-Merge "yet more apache upgrades" into production

53471722c0-+-yet more apache upgrades

35ada751be-+-Merge "enabling http_stub_status_module on protoproxy nginx servers, for use with ganglia" into production

08693fe1ab-+-enabling http_stub_status_module on protoproxy nginx servers, for use with ganglia

17ecffa19f-+-Re-add upload6

0393b0b279-+-Removing apache analytics proxy configs

9f0ee0e1da-+-Merge "more apache upgrades" into production

7492e5c37c-+-more apache upgrades

74e3a0f0f8-+-Remove "resolves RT" feature that nobody uses

6d856d6fb3-+-Add master_finger fingerprint for salt masters

4c76d45578-+-Add master_finger configuration option

ccb2603683-+-Add salt to production

f953679468-+-move misc::nfs-server::home / misc::nfs-server::home:rsync from misc-servers to nfs.pp (RT-720)

1dbdb3b95c-+-move misc::graphite out of misc-servers into misc/graphite.pp (RT-720)

fac9318235-+-fix owner/privs for fundraising logrotate conf file

bdcca1ea38-+-logrotate config for aluminium/grosley

08670fc7c1-+-Merge "grr. File attribute defaults scope is unpredictable" into production

b380517ac1-+-grr. File attribute defaults scope is unpredictable

4933c968f3-+-Merge "setting last of srv servers to use applicationserver role classes" into production

2a74e03789-+-setting last of srv servers to use applicationserver role classes

c158c72660-+-remove class 'base' from civicrm build, clean up misc/fundraising.pp (typo^2)

76446c442b-+-Merge "Adding db42 to decom list" into production

3263907a3f-+-Adding db42 to decom list

424d1640ce-+-zuul: fix url_pattern on labs

0b8c3e64eb-+-zuul: update url_pattern on labs

36336e6fd0-+-Merge "zuul: learn the ability to set push_change_refs" into production

38ef9f8bbd-+-Merge "new jenkins sudoer: Timo "Krinkle" Tijhof" into production

fc6e1eaf7f-+-zuul: learn the ability to set push_change_refs

36e4771fcc-+-Merge "Unmount /mnt/thumbs" into production

e3735a0c8a-+-swift: remove support for container sync

e1a66d71d9-+-swift: remove unreferenced code/variables

c23a43821a-+-swift: removed copy2() and friends from rewrite.py

fdcd491efe-+-Changes for Score extension deployment

93475673f4-+-new jenkins sudoer: Timo "Krinkle" Tijhof

39feecfcf5-+-setting srv258-srv280 to use applicationserver role classes

c3f9559143-+-setting srv290-srv295 to use applicationserver role classes

c865cd7f34-+-Moving analytics kraken mysql server to analytics1027

b7fdca5415-+-Set ms-be3001/2 as ganglia aggregators

0e2ec6fb55-+-Create new Ganglia cluster(s), and add ms-be300x to it

78924be84e-+-Merge "zuul: setup.py requires python-setuptools package" into production

6249a17545-+-(bug 41183) move beta logs out of /home

1eb0a98e33-+-setting srv214-218 and srv231-247 to use appalicationserver role classes

cc92148361-+-ms-be7 added as 720xd with ssds as sdm/n

4cc072ea33-+-adding awight to restricted for bastion use

c6685c706d-+-add redis ganglia

04fb1e07c7-+-Merge "setting srv 225-srv230 to use applicationserver role classes" into production

07686bd324-+-Merge "making srv190-srv192 regular apaches" into production

5c9bed2e5b-+-setting srv 225-srv230 to use applicationserver role classes

07d745d12e-+-third trie to set key_buffer = 1GB for fundraisingdb, blarhg

68807b7b30-+-second attempt to set key_buffer to 1G for fundraisingdb

74dd7dd61f-+-making srv190-srv192 regular apaches

be7542f259-+-Merge "adding mysql_myisam to fundraisingdb's b/c that gives us 1GB key_buffer" into production

653b0a9204-+-adding mysql_myisam to fundraisingdb's b/c that gives us 1GB key_buffer

7be84fcfaa-+-setting srv250-srv257 to use applicationserver role classes

0931e88a1d-+-Merge "making srv248 and 249 the bits appserver ganglia aggregators" into production

288e3693b2-+-making srv248 and 249 the bits appserver ganglia aggregators

3c675392a3-+-fix redis package

1047c55124-+-repooling srv248 and srv249, depooling srv191 and srv192

df2ac5f4fa-+-new new role classes for srv248-250

e80c707a29-+-Setting up analytics1011.eqiad.wmnet as a data source for ganglia

f7b47b1d99-+-Setting up analytics1011 as a Ganglia aggregator.

81fcd8d080-+-removing srv248 and srv249 from bits backend

98e7b04bcf-+-Merge "Revert "removing mw60 and mw61 from bits backends for reimage"" into production

53fa1524b2-+-Revert "removing mw60 and mw61 from bits backends for reimage"

d1ad35a1c6-+-setting srv200-213 to use applicationserver modules

d1029eae14-+-reprepro: use the Ceph repository as an upstream

3048774239-+-Unmount /mnt/thumbs

5a20e0b278-+-Merge "removing mw60 and mw61 from bits backends for reimage" into production

db62ad72e0-+-removing mw60 and mw61 from bits backends for reimage

4bde3366d3-+-Disable the session leak Varnish restart

974b6c2ef0-+-increase number of concurrent transcoding jobs

e9f2455854-+-zuul: setup.py requires python-setuptools package

b340e0688a-+-move stuff (Etherpad) out of misc-servers.pp (RT-720)

9200c483e5-+-move stuff (IRC-related) out of misc-servers.pp (RT-720)

49749c019e-+-Merge "move stuff (misc::download::*) out of misc-servers.pp (RT-720)" into production

5c6b7e5781-+-adding db66 to s3

7313476f67-+-move stuff (misc::download::*) out of misc-servers.pp (RT-720)

33ed7b8e45-+-Merge "move stuff (racktables & RT) out of misc-servers.pp (RT-720)" into production

59cf7138af-+-move stuff (racktables & RT) out of misc-servers.pp (RT-720)

084093b44e-+-Merge "add account for anomie (Brad), add to mortals (deployers) and some minor tab fixes" into production

a1c7992954-+-add account for anomie (Brad), add to mortals (deployers) and some minor tab fixes

7382ac1d87-+-Merge "change lab instance for Zuul on labs" into production

b816c163ac-+-Creating class misc::contint::analytics::packages to ensure that packages needed to build udp-filter are installed.

f97ce4bbe3-+-change lab instance for Zuul on labs

86075de1fe-+-Merge "ensure existence of xml dump target dir on search indexers" into production

e077b599f0-+-ensure existence of xml dump target dir on search indexers

a7652602a9-+-coredb fix 3: use 'in' correctly and quote correctly

a16ec18d93-+-coredb fix 2: needs moar scope

ab945e6b80-+-coredb fix 1: snapshot needs to inherit role::coredb::common

47ed9c9a89-+-setting db61 to use coredb module

0b2afb4faa-+-Merge "Addin spage to site.pp for Vanadium RT3884" into production

975b4e1b65-+-Addin spage to site.pp for Vanadium RT3884

732c3332b1-+-Add nfs::netapp::thumbs for the new thumbs volume

944f86d22e-+-apt: minor syntax/whitespace fixes

754569f154-+-apt: re-add support for commenting old apt entries

2f5392ecf3-+-Disable bonding for ms1-3

20e792b7ba-+-Kill last references to Solaris

7393cc7887-+-Repurpose ms[1-3]

3d51fe8e6c-+-Merge "Remove spurious notify, doesn't work across stages" into production

bc7e6462f9-+-Remove spurious notify, doesn't work across stages

b81c984e1a-+-Merge "swift: include Ubuntu Cloud archive for folsom" into production

5f38edafe6-+-swift: include Ubuntu Cloud archive for folsom

bb66a44ee3-+-Merge "new coredb module." into production

0ad3436130-+-new coredb module.

337cecec76-+-Merge "re-adding mw60 to bits backends" into production

7d9b5c3213-+-re-adding mw60 to bits backends

1b69a9e0a0-+-Merge "marking mw60 to use applicaitonserver/mediawiki modules" into production

638e1cdc53-+-Merge "move redis ganglia module to its own class" into production

32a014b0c6-+-move redis ganglia module to its own class

0771f9c41d-+-marking mw60 to use applicaitonserver/mediawiki modules

8bf3d65221-+-Merge changes I9d656f54,Ib1387a1c into production

ff0d2e3fb2-+-deploy ganglia plugin for redis

c778babe27-+-removing mw60 from bits apaches pool again :/

ea356ab7d5-+-Revert "removing mw60 from bits apaches pool for upgrade to precise"

0a423ad867-+-removing mw60 from bits apaches pool for upgrade to precise

984f7af7cf-+-gallium:/var/lib/jenkins now belong to jenkins group

4a4bc6d66b-+-Initial attempt for an apt module

4699600a1c-+-Merge "get nodejs on the continuous integration server" into production

4625493d0e-+-Remove a few spurious no-op apt pins

92cb300931-+-Remove apt::ppa-req and apt::key

066d1e5a0d-+-Fixing SSLCACertificateFile for Gerrit

37601908ca-+-get nodejs on the continuous integration server

afa68697de-+-lower pybal depool-thresholds for search pools based on number of hosts

4c02e222c2-+-Merge "having pybal monitor search-pool4 hosts with an search query to one of their indices" into production

f0e51e046c-+-having pybal monitor search-pool4 hosts with an search query to one of their indices

661b11126b-+-(bug 30720) Add links to Special:Code on mw.org

da369f0d4e-+-don't call nginx proxy_configuration class in esams while we don't have ip's - do the same for wikivoyage

6b98b417c1-+-don't call nginx proxy_configuration class in esams while we don't have ip's

e001d895ee-+-Merge "comment wikidata/voyage esams proxy IPs, nginx does not like us using the 127.0.0.1 or just :443 work around" into production

a134de2bbf-+-comment wikidata/voyage esams proxy IPs, nginx does not like us using the 127.0.0.1 or just :443 work around

c69b3492c3-+-allowing new fundraising IP range access to ncsa fun

ab194b9542-+-ms-be6 is a 720xd with different ssd layout, update partman, swift, site files

6a6ef0094b-+-add user awight, add admins::fr-tech, add admins::fr-tech to most fr hosts

9f6c5389ea-+-change default redis pkg version to 2:2.6.3-wmf1

87c2ab2d5f-+-add SSL proxy config for wikivoyage

7f32cb8dfa-+-Merge "sync Zuul module with upstream and update our conf" into production

07039b5506-+-Install upload Varnish on cp3004 as well

c6fa3895b8-+-Make every frontend only talk to its own backend, for now

b8c01961f0-+-Merge "Make sure to set the slave interfaces as up" into production

42d956ab02-+-Make sure to set the slave interfaces as up

db613ed765-+-Merge "Revert "Set bond-master on LACP slave interfaces, as required by Precise"" into production

8abbad14bc-+-Revert "Set bond-master on LACP slave interfaces, as required by Precise"

3fbcb2d7ce-+-Merge "Set bond-master on LACP slave interfaces, as required by Precise" into production

08a0f9ac15-+-Set bond-master on LACP slave interfaces, as required by Precise

5b71473bc2-+-sync Zuul module with upstream and update our conf

afc885970c-+-path fix

7fcbcc2fe9-+-* replace our memcached ganglia plugin with one that works * fix pyconf install directory original source: git://github.com/ganglia/gmond_python_modules.git

269fe96751-+-role::beta::autoupdater

9ce5b6d8fd-+-Simple renaming misc::beta::{scripts,autoupdater}

e063fe4f79-+-Reduce scaler MaxClients to 18

e869556fda-+-Apparently we don't have to_bytes() available

5e2c1c1e41-+-Increase the frontend cache size on servers with a lot of memory

a294785aca-+-Merge "Allow roles to insert arbitary lines into LocalSettings.php." into production

0e23d4e5c9-+-add fundraising archive to db78 since it's the pmtpa host with space

a4a26e4b41-+-redis nagios check

ba1a43a6de-+-create parent to /a/redis/

37a04e5cc5-+-base pidfile on servicename

234ba4dafa-+-Moving github replication to wikimedia account

7942bc1f0d-+-Fix interface_aggregate / interface_add_ip6_mapped deadlock

316852989a-+-Allow roles to insert arbitary lines into LocalSettings.php.

0d48d90959-+-No point in having Squid backends on Varnish frontends

301c1a92a8-+-Don't retry 5xx

1cabcf0476-+-Pass $cluster_tier to frontends as well

2623ba6324-+-Fix the dependencies of base::tcptweaks

e08cd217b8-+-Move generic::tcptweaks to base, where it belongs

79383161ce-+-Fix tcptweaks

c2f6abeae4-+-Fix ganglia aggregators

196d500666-+-Add Ganglia cluster Upload caches esams

f45470e50f-+-Prefer IPv6 when contacting eqiad backends in esams

98591f553e-+-Could not use $extraopts

d1cca6a708-+-Puppet's lack of string concatenation sucks

3af3d9c737-+-Allow extra runtime parameters

9aff0e2693-+-by default, name redis server after package name

d8fa1ced95-+-fnord

ed2535ac09-+-fix default pkg version

833edc6eb1-+-fix typo not caught by puppet parser validate

c44dd863a3-+-remove superfluous variable

921eccefaa-+-adding redis class to mc pmtpa servers

22106e7d5d-+-Merge "a very sketchy start to a redis module" into production

9356e710ee-+-a very sketchy start to a redis module

588850c184-+-Merge "update CA for the new star.wikipedia.org SSL cert" into production

e90779d65f-+-update CA for the new star.wikipedia.org SSL cert

104fd09f4f-+-replace storage3 with db78

e014951351-+-Merge "Can't use default_backend when defining it in the include file" into production

f49ddf1e1f-+-Can't use default_backend when defining it in the include file

7acf1124fe-+-Merge "Revert "Can't use default_backend when defining it in the include file"" into production

d501195aa3-+-Revert "Can't use default_backend when defining it in the include file"

a129477d1d-+-Merge "Can't use default_backend when defining it in the include file" into production

5bff2187e9-+-Can't use default_backend when defining it in the include file

68ae691655-+-Merge "Define pmtpa/eqiad backend/directors in upload-backend.inc instead" into production

09efceac03-+-Define pmtpa/eqiad backend/directors in upload-backend.inc instead

4c8755d7bd-+-Merge "swift: remove proxy restart cronjob" into production

5bae6e87f7-+-Merge "Use vcl_config['default_backend'] to set the default backend" into production

5f270ae840-+-Use vcl_config['default_backend'] to set the default backend

213ed2530d-+-git::clone $group parameter was not used

a9f3f17ba5-+-swift: remove proxy restart cronjob

552c5a15ec-+-Merge "clones zuul configuration as root" into production

fa237c7fe0-+-git::clone now log a message on failure

10a86a87fc-+-clones zuul configuration as root

1aaa9c2a8e-+-Merge "Make the main storage backends use persistent storage" into production

50409595e6-+-Make the main storage backends use persistent storage

c3cf05c18c-+-Merge "Use flatten/values for eqiad frontend's backends as well" into production

ccca5411f1-+-Use flatten/values for eqiad frontend's backends as well

aad8331f9c-+-Merge "Fix backends parameter expression" into production

3a1e6ac8b7-+-Fix backends parameter expression

995f217e43-+-Merge "Add Varnish backends for esams frontends as well as Squid" into production

bd2a032762-+-Add Varnish backends for esams frontends as well as Squid

d768a3cd83-+-Merge "zuul configuration for Wikimedia" into production

cf6fe56335-+-Merge "import zuul module from OpenStack" into production

7c3e1e89ce-+-zuul configuration for Wikimedia

ec651bd63f-+-import zuul module from OpenStack

792259460a-+-Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest

5604d0ef66-+-Revert "Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest"

6d23ee5899-+-Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest

b7c14329cf-+-Merge "Revert "Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest"" into production

d735ae7e6d-+-Revert "Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest"

d74bff5d96-+-Merge "Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest" into production

71b885a3d9-+-Introduce $cluster_tier to distinguish between pmtpa/eqiad and the rest

e48da97ab3-+-Merge "Actually define the backends, not just the directors" into production

fea19d903c-+-Actually define the backends, not just the directors

ca19bff376-+-Merge "Set isGithubRepo = true for github replication" into production

d8a07aee94-+-Merge "Install cp3003 as Varnish upload" into production

980c74a5e3-+-Install cp3003 as Varnish upload

c8696ddcee-+-Merge "Add pmtpa/eqiad Squid/Varnish servers as esams backends" into production

8d8612054f-+-Add pmtpa/eqiad Squid/Varnish servers as esams backends

9505e6c20b-+-configure db78 as fundraising database slave

ddccf3d88a-+-Merge "do not use new SSL cert for mobile, does not include the .m... grrr" into production

a60fe9c0ac-+-do not use new SSL cert for mobile, does not include the .m... grrr

9b895b2869-+-Merge "protoproxy - use star.wp SSL cert rather than "test-star"" into production

52db2eb7b5-+-protoproxy - use star.wp SSL cert rather than "test-star"

0150467aed-+-fixed typo ptmpa to pmtpa

1fa6ce6ad4-+-last bit of fundraising db conf cleanup

f16c226eda-+-more fundraising db config cleanup

ef686d1c85-+-fundraising db config cleanup

7e25134211-+-moving fundraising db config from role/db.pp to role/fundraising.pp (typo)

39027496ab-+-Merge "Solr replication" into production

accd84ea64-+-move fundraising db config to role/fundraising.pp

70bc13d62a-+-Merge "Define backends for upload-backend in esams" into production

1d9d378615-+-Define backends for upload-backend in esams

5f92fd2cb5-+-Merge "Prepare for Varnish upload @ esams: parameterize storage sizes" into production

0b023da00e-+-Prepare for Varnish upload @ esams: parameterize storage sizes

8d882f8d91-+-Set isGithubRepo = true for github replication

a403d38af5-+-Merge "Add missing servers strontium/palladium" into production

f572dbdca5-+-Add missing servers strontium/palladium

cf519706b1-+-/etc/wikimedia-site containing $::site

9715fce8fe-+-Merge "Double bits cache memory to 2 GB" into production

c7d396dd15-+-Double bits cache memory to 2 GB

37fd1951e5-+-Merge "Random director is easier" into production

70b009c7f7-+-Random director is easier

cc1f7700b5-+-Merge "Add bits@eqiad as esams bits backend as well, in round-robin" into production

98a138e13c-+-Add bits@eqiad as esams bits backend as well, in round-robin

7fd37ac206-+-Merge "Puppetise domain-maplist, and add wikidata/wikivoyage" into production

834bc6e0f4-+-Puppetise domain-maplist, and add wikidata/wikivoyage

1b4849d613-+-Merge "Repurpose cp3001/cp3002" into production

a27f2b22a1-+-Repurpose cp3001/cp3002

b491fef643-+-Merge "Swap out ganglia aggregators for Bits caches esams group" into production

bf97bb1391-+-Swap out ganglia aggregators for Bits caches esams group

7ef1eb0d62-+-Merge "Add IPv6 addresses to new bits servers" into production

bc04590a13-+-Add IPv6 addresses to new bits servers

1c0d65fcf4-+-Boo, ganglia doesn't like me with 2 aggregators!

111076b819-+-site.pp - using both an03 and an10 as ganglia aggregator for analytics cluster

fb7a03e1cc-+-Merge "switch fundraising hosts to fundraising ganglia and nagios clusters, additional banner logging" into production

0d75cbf594-+-switch fundraising hosts to fundraising ganglia and nagios clusters, additional banner logging

8a350a4ab9-+-Merge "undo added system_role in role/fundraising.pp" into production

a5c8e6b76d-+-undo added system_role in role/fundraising.pp

82bf54333d-+-admins.pp: annotate the include as disabled

ff46277cf5-+-Solr replication

a66613a20c-+-add system_role for fundraising hosts, attempt to fix nagios fundraiser host groups

e1541e424a-+-moving fundraising config out of site.pp into a new role/fundraising.pp

76db8af2cc-+-adding monitor_group for fundraising_* boxes, temporarily in site.pp

5ae3ff4643-+-Only make the first two hosts Ganglia aggregators

93c9304dbd-+-Add cp3019-3022 as new bits servers

16bd5e5e9c-+-Make cp3019-22 bits servers

9a9ce7189f-+-attempting to put aluminium,grosley,erzurumi,loudon in "fundraising" nagios host group

aa070b83c5-+-Attempt to fix SSL cert usage for wikidata.org

111d94986a-+-add "&contribution_tracking_id=1" to nagios checks to resolve duplication issue

7d6c79c07c-+-Merge "Ensure => present rather than latest for nova" into production

4df306d24d-+-Ensure => present rather than latest for nova

2e9f3fc1ba-+-Merge "Mute the backup crons for labsconsole" into production

768887951f-+-Mute the backup crons for labsconsole

0065c39503-+-Merge "Add backups to labsconsole" into production

91bdaa2019-+-Add backups to labsconsole

377c7d1cb8-+-Merge "adding sudoers defs for code deploy to search indexer role class" into production

9cc876e1d5-+-adding sudoers defs for code deploy to search indexer role class

4e19945286-+-adjusting LVS url test for payments

fbd8342f68-+-patching up ipv6 monitoring for wikidata and wikivoyage

aa9bb70e74-+-fixing monitoring definitions for wikivoyage and wikidata lb's

b2808f4c13-+-Merge "misc::builder requires libcrypt-ssleay-perl package" into production

b42eccbfdb-+-Merge "remove 'configchange' script" into production

8de4d7c969-+-fixing ganglia last-octet snafu, sort hash by last octet

90a9777400-+-Add LVS service monitoring for wikidata/wikivoyage HTTP

fe7f3a9f1a-+-Fix eqiad IPv6 addresses

2af71af793-+-Add IPv6 service IP to wikidata SSL service, enable IPv6

49bf6996a6-+-Add LVS realserver IPs to protoproxy hosts

8c514bbd2d-+-Add IPv6 LVS service IPs for wikidata/wikivoyage

3eec1323f1-+-Fix nagios group description

cc6484fdfc-+-Fix memcached monitoring mess

f296825771-+-Install ngrep on all machines

23d5618198-+-remove duplicate nagios grp

2490983c0e-+-Merge "New, configurable redirector and its config" into production

a5a9ab92c4-+-New, configurable redirector and its config

bdd47b1160-+-disable igbinary.compat_strings

2bdc58e2e7-+-Attempting to use analytics1003 as ganglia aggregator

dd89adea72-+-adding mc1 and mc2 as data sources in ganglia.pp

0dff179a20-+-We manage gerrit's version manually; ensure that

1c92b42fc6-+-Merge "setting srv223 and srv224 to use modules for precise upgrade" into production

77fc91382d-+-setting srv223 and srv224 to use modules for precise upgrade

f0d75851c1-+-Merge "Attempting to get ganglia_aggregator respected!" into production

d9925e7258-+-Attempting to get ganglia_aggregator respected!

f0662efa31-+-fixed class name for user pcoombe

9ca30d1209-+-adding user pcoombe to aluminium+grosley

f9c4fc25eb-+-ganglia.pp - only using analytics1010 as ganglia aggregator (for now)

55f9b0c622-+-Using only an10 as ganglia aggregator for now

ddeb413239-+-Merge "Restart varnishhtcpd on changes" into production

e4a086b0cd-+-Restart varnishhtcpd on changes

eb6a71acee-+-setting srv221 and srv222 to use modules as part of upgrade to precise

e3f4f345a8-+-Collect response headers Via and X-Varnish on delivery

9315649cca-+-Merge "add wikivoyagelb and wikidatalb service IPS to lvs.pp" into production

45f665d5a8-+-Merge "protoproxy.pp config for wikidata.org (SSL/LB)" into production

3511820e8a-+-protoproxy.pp config for wikidata.org (SSL/LB)

03a808bd6b-+-Fix aggregators in gmetad config for virt cluster

39fd615e40-+-Ugh. Apparently I read upside down.

6a75fb6499-+-Change ganglia aggregators for virt cluster

4dbefd748f-+-Fix virt cluster in gmetad

777c222f18-+-Installing tofrodos on stat1 for Stefan

64dab53dbc-+-Add "role::mediawiki-update::labs" for updating labs-MW-installations

265233d405-+-Merge "Roll a new Varnish build which filters duplicate headers Age and Accepted-Ranges" into production

1e7773dabd-+-Roll a new Varnish build which filters duplicate headers Age and Accepted-Ranges

1483cb2620-+-Merge "Install varnish 3.0.3~rc1-wm3 (with duplicate CL header fix), remove workaround" into production

b87fb81f15-+-Install varnish 3.0.3~rc1-wm3 (with duplicate CL header fix), remove workaround

c40c8dd3e4-+-Add a "video scalers" ganglia group

efc46a82da-+-enable videoscaler on tmh1/tmh2

46c51e0b7f-+-Merge "rename ::jobserver to mediawiki_new::jobserver" into production

d6fc4fa6e5-+-rename ::jobserver to mediawiki_new::jobserver

3c90f2ebdb-+-seeting a global mysql PS1 prompt [rt 3091]

c3406dd554-+-adding pecl memcached ext to apaches, removing db22 cruft from mysql.pp

8bc492265a-+-adding db22 to decom list

9364b12986-+-adding db65 to s4

408b68c3a4-+-adding apaches::ganglia to imagescalers, api, bits, and test

c8cd823463-+-replaceing content with source for conf file

f80effb5e4-+-Merge "configure db1013 as a temporary fundraising db slave + fix typo + arghbhabarhaga" into production

40befeed1d-+-configure db1013 as a temporary fundraising db slave + fix typo + arghbhabarhaga

0f3a6c60eb-+-misc::builder requires libcrypt-ssleay-perl package

ee5a2a00a1-+-adding apache scorecard stats to ganglia

11240d58cb-+-removing notify => Service[apache] from all manifests

100dbafb0e-+-setting srv220 as ganglia aggregator for imagescalers

532214e6ca-+-setting srv219 and srv220 to use appalicationserver modules

6aec539902-+-Merge "Correct package version" into production

22c2accb5a-+-Correct package version

ccd5435043-+-Merge "Upgrade Varnish on all upload caches to 3.0.3~rc1-wm2" into production

6c3c5a78bf-+-Upgrade Varnish on all upload caches to 3.0.3~rc1-wm2

8c95002b49-+-Merge "Define separate storage backends for large objects" into production

b255a6fe1d-+-Define separate storage backends for large objects

b07b3206a2-+-Merge "add role::applicationserver::videoscaler" into production

d65340900c-+-add wikivoyagelb and wikidatalb service IPS to lvs.pp

a90c53a8d9-+-Installing mysql on analytics1001 for Oozie and Sqoop

1ae758c327-+-Merge "(Bug 41121) Use upload7 as folder in labs" into production

0a4f55c3e9-+-(Bug 41121) Use upload7 as folder in labs

fbe76e5ccd-+-Remove the health probe on single backend appservers, it's doing more harm than good

d55f6f092c-+-Suppress cron output

749754690a-+-Periodically restart leaky Swift proxies so that I don't have to

5facbb24cf-+-db67 is replacing db42

041936d203-+-add role::applicationserver::videoscaler

8e2107882b-+-adding s page to mortals group

b692130e14-+-Merge "adding rmoen to mortals group" into production

eec72633cb-+-fix incorrect class scop

9bac561739-+-adding rmoen to mortals group

684316d7f5-+-add mecached ganglia group

f56714af1d-+-remove dueling @monitor_groups

0f989d045a-+-memcached conf for new mc servers

77a7c736f1-+-fix rmem tuning for udplog

b0efae9da3-+-remove 'configchange' script

ae20e2e49e-+-Merge "Renaming classes to avoid weird class naming conflict" into production

23fb05e645-+-Renaming classes to avoid weird class naming conflict

9b124cc059-+-Merge "fix sudo rights for wmf-beta-autoupdater" into production

04e78db889-+-fix sudo rights for wmf-beta-autoupdater

319dae0b19-+-Installing MongoDB on stat1

25dde9b5ff-+-add full sudo rights for demon on gerrit hosts per RT-3698

041205e922-+-Merge "manpages for our misc scripts" into production

0bfee8cbec-+-Merge "beta autoupdater requires git-core" into production

a50b6b5a6c-+-Merge "Precise has ant1.8 by default" into production

ffbafbcb29-+-make sure mwdeploy can write to the beta updater log

747d08792a-+-Merge "Adding mongodb module." into production

768383864c-+-Merge "Escaping $1 in analytics::web::proxy RewriteRule" into production

d2eaad8f06-+-Escaping $1 in analytics::web::proxy RewriteRule

26f718695b-+-Merge "Adding analytics.pp and setting up internal proxy for analytics cluster." into production

a31b981dd3-+-Adding analytics.pp and setting up internal proxy for analytics cluster.

34ff7ed59f-+-Merge "misc::contint::test::packages stop pinning php" into production

d8830b0321-+-misc::contint::test::packages stop pinning php

13b630edd4-+-Merge "esams bits event log routing" into production

440ae922ab-+-esams bits event log routing

e07d01a3a8-+-Precise has ant1.8 by default

4ee1fc453e-+-Move noc from /h/w/htdocs to /h/w/c/docroot

7c9d26c2fc-+-Merge "Adding in nscd file to override cache times." into production

bb4f652125-+-Merge "Updated pdns related manifests/templates to support an array of ldap hosts" into production

8cccefab58-+-site.pp - manually specificying ganglia aggregator hostnames

58e266f7f3-+-Need to set $cluster for analytics

9e10537895-+-Setting up ganglia aggregators for Analytics cluster.

b7c0096eb0-+-Adding in nscd file to override cache times.

1f05889588-+-variables asigned as undef in a manifest exist in an erb, oops

b56df67f51-+-when a varnish instance name isn't specified, the hostname is used for shm access

67821b46e4-+-splitting nrpe monitoring out of varnish::logging_config

87ad966d2a-+-bits servers don't run nrpe

114406de82-+-fix syntax error, move log_format override to after default file is parsed

f2686e1d6a-+-Merge "- bits event.gif logging to vanadium - esams traffic needs a bouncer on oxygen, tbd" into production

380679fbca-+-- bits event.gif logging to vanadium - esams traffic needs a bouncer on oxygen, tbd

c0dee36512-+-Merge changes I1390521d,I2ef7a6e1 into production

089a82973d-+-Event logging on bits caches: ØMQ => UDP

47e23d8a5f-+-Merge "planet - adding more translations per meta.wm" into production

14a69b8e5b-+-planet - adding more translations per meta.wm

bca6d49c5c-+-adding db1013 as a potential replacement for db1008 (fundraising db master)

76ebb7d7ce-+-setting extension distributor cron to run at hour 3, not every minute in hour 3

99007fd3de-+-increasing number of threads on jobrunner boxes from 5 to 12

38da68553e-+-removing jobrunner from all apaches but new, precise, jobrunner only boxes

c545719458-+-beta autoupdater requires git-core

2a179fa05b-+-re-adding mw61 to bits backends

9e29bd176b-+-install upstart conf for beta autoupdater

03ec270ce6-+-setting mw61 to use role::applicationserver::appserver::bits

31ef59df72-+-Use --passfile for the original mw admin pass.

bd6eda8653-+-(bug 39701) beta: automatic MediaWiki update

a86da9596b-+-Adding mongodb module.

0565f15c42-+-Installing mercurial on in statistics::packages.

0a63be17fe-+-fix doc for git::clone

cdba81542f-+-Updated pdns related manifests/templates to support an array of ldap hosts

e92470ba0d-+-Merge "fix a minor syntax error and remove a ," into production

e1780cd951-+-fix a minor syntax error and remove a ,

fe8004e6e7-+-Merge "adding account for Steven Walling and adding to stat1 per RT-3653" into production

6efc33461c-+-adding account for Steven Walling and adding to stat1 per RT-3653

317eda5984-+-Include fqdn in the 'DNS name' entry in instance status.

64ffbf13b3-+-re-adding srv191 to bits backends, and removing mw61

0012d79968-+-Generate an admin password during mediawiki install.

3d5e59ce3c-+-Merge "re-enable shell for Brion :)" into production

433e114153-+-re-enable shell for Brion :)

3dcbbf0706-+-Sending logs to logstash

de9df4f753-+-Update the SNMP traps.

5332b925bc-+-removing srv191 from bits backends

fb7e8d3b28-+-Merge "Mount the originals volume on all application servers" into production

bf28819ae2-+-Mount the originals volume on all application servers

df3891b4da-+-planet - and fix Spanish translation too

8aa2da9ba6-+-Merge "planet - adding Arabic, French and Chinese translations." into production

f2c4718810-+-planet - adding Arabic, French and Chinese translations.

f66834c136-+-Merge "Make gerrit service subscribe to secure.config and replication.config" into production

4f2a33e8b9-+-Only replicate branches and tags

a9a781699c-+-Make gerrit service subscribe to secure.config and replication.config

c888b94860-+-Merge "Gerrit doesn't like it when you only want to replicate one project" into production

fdcda0b95a-+-Merge "move logmsgbot from wikimedia-tech to wikimedia-operations" into production

3c2166b131-+-move logmsgbot from wikimedia-tech to wikimedia-operations

b9ee483b2b-+-Gerrit doesn't like it when you only want to replicate one project

9f2e3592b4-+-Merge "Begin replicating mediawiki core to github" into production

9890c158be-+-decom db25

a3dcac9d55-+-Begin replicating mediawiki core to github

8bc938e96e-+-bump php version number for precise jobrunners

c5b98cb685-+-re-enabling precise jobrunners

2581d9ea08-+-re-adding lucid jobrunners on mw* hosts

86532fed62-+-building db64 to replace db25 (dead sun) in s3

20f9f94f19-+-manpages for our misc scripts

e0b18a3752-+-Add the final two varnish servers to the backend pool

65824da833-+-Add cp103[34] to the backends pool

6103a73735-+-Add cp103[12] to the backend pool

9f1f883568-+-Add cp1029 and cp1030 to the backend list

c7ed35651c-+-Apply settings to cp1029 as well

176e2b0a34-+-also exempt db1047 from mysql::conf while testing mariadb

ca413b190e-+-remove db1047 from mysql::packages for mariadb testing

0c0a36209a-+-add root@indium to fundraising archive user backupmover's auth keys

8655951487-+-Installing udp-filter on analytics machines

bfa634cd74-+-Apply Puppet Varnish config to cp1029-1036

14dc6c8b5f-+-add misc::fundraising::backup::archive to aluminium/grosley

0de16fd15d-+-adding root@boron's key to fundraising backupmover's authorized keys

6e3c33a0f3-+-Merge "use keys function from puppetlibs-stdlib instead to get hash keys as an array" into production

0f1fab2d5c-+-use keys function from puppetlibs-stdlib instead to get hash keys as an array

c752142876-+-Merge "Two minor gerrit fixes:" into production

bc3a5d055d-+-Two minor gerrit fixes:

f2f9e8b056-+-Merge "More fixups to gerrit:" into production

8a93447e6c-+-More fixups to gerrit:

121700f3dc-+-Merge "decom db17" into production

2b18374964-+-decom db17

a7e1f5ddce-+-planet: now that planet_languages is a hash with the values for translation, need to split out just the keys and use them to iterate through

9396352c9c-+-Fix I696578f4: Don't need to pass ssh_key to gerrit::jetty anymore

379d462b23-+-Merge "planet: add translations of the index.html, turn index.html.tmpl.erb into a puppet template. add a definition to create planet theme. add hash of translations to role class,..." into production

3902dea4bd-+-planet: add translations of the index.html, turn index.html.tmpl.erb into a puppet template. add a definition to create planet theme. add hash of translations to role class,...

2b65f4462c-+-Merge "Refactor gerrit2 account stuff so we can reuse it on other hosts" into production

87c435e3ac-+-Merge "Redo SSL certs for gerrit" into production

a7b58dab37-+-Merge "Fix two unknown attributes" into production

0ea8317835-+-Merge "Point out that this file shouldn't be used" into production

5e122f8e0d-+-Merge "Configure the math container as sharded." into production

488a4b44b8-+-Merge "role/analytics.pp - including geoip" into production

a72477366f-+-role/analytics.pp - including geoip

b39f568931-+-Removing unused misc/analytics.pp file.

bc813616d1-+-Refactor gerrit2 account stuff so we can reuse it on other hosts

366bfe6e8b-+-Redo SSL certs for gerrit

64d2cfd339-+-Fix two unknown attributes

2907877bf4-+-Configure the math container as sharded.

0028dc6105-+-varnish config for bits.beta.wmflabs.org

11b62f72a4-+-Allow Varnish director options to be set from the manifests

b87e702449-+-Do not run jobs on precise, due to bug 40462

4cc4b8dd3a-+-Allow glustermanager to rmdir.

48da18d851-+-Merge "Fix Labs instance range for puppet" into production

b1d3a795c1-+-Fix Labs instance range for puppet

19b481844f-+-remove deprecated fundraising archiver script

31767c2a1c-+-Merge changes Ifba29c92,Ifbd7aae8 into production

3bc0d277a6-+-Fixing ranges

4d63ac6caf-+-Merge "Move wikiupdates out from nova::common and into nova::compute" into production

d222970586-+-Move wikiupdates out from nova::common and into nova::compute

0dfc3dbf50-+-db62 pulled from db stanza for testing h310 controller

51fa824d85-+-Remove backup stuff from puppet (reverting Ibf2e1d85)

a29d1a0cc0-+-Use unattended-upgrades in Labs

7a1734c99d-+-Point out that this file shouldn't be used

cb1448f81c-+-Restart compute after installing wikinotifier.

4830661b2c-+-Merge "Setting correct compute nodes for pmtpa" into production

1953acf19c-+-Setting correct compute nodes for pmtpa

578c44a5b8-+-Merge "remove webserver::php5 from ./misc/secure.pp, conflicts with same in planet class which is also applied to singer" into production

e4938240f1-+-remove webserver::php5 from ./misc/secure.pp, conflicts with same in planet class which is also applied to singer

829004eb5b-+-Merge "Redo gerrit replication template so we can set any option" into production

ba0164c28e-+-Merge "Perform daily backups of gerrit for amanda to pick up" into production

751d0f8d12-+-Test commit.

53d7b165a5-+-Merge "Creating cron job to rsync edit logs to stat1" into production

a03bef6c10-+-Adding Howie Fung and Stefan Petrea on stat1.

06a96f63e6-+-Merge "Replace explicit paths by variables" into production

2b29dfeb28-+-Replace explicit paths by variables

afc38e7a76-+-Merge "adding new switches and firewalls to torrus" into production

d3f6a82e51-+-adding new switches and firewalls to torrus

f2fa2872bf-+-Merge "Make cadmium standard" into production

58556e1752-+-Make cadmium standard

ada38cf118-+-Merge "Add asw2-d3-sdtpa to Torrus" into production

e2017d11c7-+-Add asw2-d3-sdtpa to Torrus

525c11e096-+-Add some anti-spam extensions to the mediawiki install.

87f118582b-+-* stupid http options varnish health probe for lvs vips where host health is actually monitored by pybal

5df90bbabf-+-add generic::locales::international to pdf server role class (RT-3586)

784f9a5729-+-lowering depool-threshhold on all search pools

d53db0276e-+-set director retries to two for mobile-backend instances

910bbff0a2-+-Creating cron job to rsync edit logs to stat1

d7d5978b04-+-Redo gerrit replication template so we can set any option

c6920aa3f0-+-Merge "reducing the number of threads on precise jobrunners fro m12 to 5" into production

cb0037b2bf-+-reducing the number of threads on precise jobrunners fro m12 to 5

ecde3b5c8c-+-Merge "add the nagios-nrpe-server init.d file" into production

67b6aadc8b-+-Merge "setting srv190 as in imagescaler to test precise build" into production

f221bb67b6-+-setting srv190 as in imagescaler to test precise build

6b7ac45c98-+-fix eqiad es regexes

89e4fcf993-+-redoing pgehres->deploy commit per RT #3143

3a9a5271f8-+-Merge "Add a hard-coded region to the automatic instance status." into production

c9a5a96ab5-+-Add a hard-coded region to the automatic instance status.

5bb40e36e7-+-movnig es2/3 to core db classes, bool cleanup

62df9c45eb-+-Merge "install php redis extension on precise and lucid apaches" into production

473f4592a9-+-Merge "sort useraccounts alphabetically within classes" into production

2059353301-+-Revoke Sara's cluster access

b4b2d2cfaf-+-Move python-mwclient into a generic class.

85c09175a0-+-Perform daily backups of gerrit for amanda to pick up

f8036d6caf-+-install php redis extension on precise and lucid apaches

6d64cbcdf3-+-Define instance_status values in role.

aad27fb8e1-+-Point the autostatus notifier to labsconsole.wikimedia.org

6da156c353-+-ms-be6 disk layout with ssds again

d1423bd106-+-Merge "Update wiki instance-status pages automatically." into production

184201b954-+-Merge "mw logger needs a default directory" into production

296281fcb7-+-jenkins requires an apache2 installation

113195fbc6-+-temporarily disabling lucene logs cron by diederik's request

a52d5af557-+-switch aggregator hosts for eqiad Fundraising ganglia

ed83d4ead4-+-Merge "swift: allow sync between {pmtpa,eqiad}-prod" into production

b738621139-+-swift: allow sync between {pmtpa,eqiad}-prod

bc7074c9dd-+-Move parsoid IRC channel to #mediawiki-parsoid

9d820291aa-+-Merge "extract l10n update from scap" into production

7f93fdf6bb-+-messing with ganglia config for fundraising eqiad

4246ceb15a-+-single ganglia cluster for fundraising

92c2597c78-+-Update wiki instance-status pages automatically.

818615e897-+-swift: allow container sync between labs/labsupgrade

224a486fbe-+-swift: add support for container sync

4f1c829fbc-+-Merge "pin lucene version in eqiad, unpin in pmtpa" into production

313d283eb7-+-pin lucene version in eqiad, unpin in pmtpa

c68e1fc94e-+-Send gerrit-wm notifications for Parsoid to #parsoid

dfabe322ba-+-Explicitly name the deployment host

8ee6e6a8db-+-Fix setting peer runner info for labs

61fdbb4a53-+-Give demo-deployment1 deploy runner rights in labs

5b2a20ad19-+-Merge "explicitly setting package versions for apaches to stop getting ubuntu versions on install" into production

c4456d7574-+-explicitly setting package versions for apaches to stop getting ubuntu versions on install

80a20ac5e4-+-Merge "correcting regex" into production

49d5a811ff-+-correcting regex

392dbe37db-+-add frack hosts to gmetad.conf

67b31b548a-+-Merge "removing excessive ganglia aggregators" into production

05436e4c96-+-removing excessive ganglia aggregators

3b60520716-+-add path for rewrite.py for python 2.7 in precise

9a8d906066-+-rejiggering eqiad mw numbers

2e8a41fc91-+-Merge "setting srv190 and mw55-59 to use apache modules/precise" into production

0c249d04e1-+-adding packages used for fundraising analytics

a5e05b7497-+-setting srv190 and mw55-59 to use apache modules/precise

97ede6f4e5-+-Merge "Giving access to stat1 to Maryana and Dan." into production

8e0bd1e8cb-+-Merge "re-adding dsc and diederik access to vanadium." into production

e1c1a003b7-+-re-adding dsc and diederik access to vanadium.

01d5b06a0e-+-Giving access to stat1 to Maryana and Dan.

d6bafe947d-+-Add NTP client to sodium

dec8c69dc8-+-mw logger needs a default directory

ec90e290d4-+-excluding es clusters from heartbeat monitoring for now

b714d6c6bc-+-Merge "file_per_table for new es clusters" into production

cca1ffba27-+-file_per_table for new es clusters

36f875f537-+-sort useraccounts alphabetically within classes

d43c2d907b-+-change UID for spage to 608, 607 was already used for krinkle

ffca6bcb96-+-add Chris Steipp to admins.pp and class mortals

668e68b74e-+-Merge "Add instanceproject to labs grains" into production

2931662d08-+-Add instanceproject to labs grains

a6a8c49175-+-Merge "adding ganglia aggregator data sources for pmtpa jobrunner group" into production

5747f50d61-+-adding ganglia aggregator data sources for pmtpa jobrunner group

6769e497a6-+-Merge "making number of jobrunner procs configurable and setting role class to spin up 12 procs" into production

b8ab0f7867-+-making number of jobrunner procs configurable and setting role class to spin up 12 procs

cf350e8666-+-Merge "Adding salt master role to virt0" into production

bf8783fb36-+-Merge "Limit access to salt master" into production

08a57d84eb-+-Merge "Add iptables info for salt ports" into production

9237d67e07-+-Limit access to salt master

6fd3a0e42b-+-Add iptables info for salt ports

f951011347-+-Adding salt master role to virt0

edfb2e1888-+-Merge "Add salt roles for master and minion" into production

f8f5e779c1-+-Add salt roles for master and minion

b714b912a4-+-Initial checkin of salt puppet module

18321e01ca-+-yet more classes for job runners

78b81081cf-+-adding other required classes to jobrunners

12d7860fd3-+-include php ini files on jobrunners

5e10bffa8d-+-disable apache on jobrunner boxes

1f2347a950-+-Added in pmtpa row C and eqiad row C

6053b2bf7f-+-jobrunner.pp: hack to deal with migration to mediawiki module

2b7a8ad6eb-+-defining ganglia group/octet for dedicated jobrunner cluster

a8b7b76c69-+-need class default as well.

691d6628ff-+-correctly check for undef var

c8be681b81-+-making mw1-16 jobrunner only boxes. also, upgrading to precise

fd17a96cea-+-Merge "add eqiad mw boxes to site.pp and removed nfs::upload from applicationserver.pp role classes" into production

265e5da493-+-add eqiad mw boxes to site.pp and removed nfs::upload from applicationserver.pp role classes

5496fbdf3c-+-quieting search result mover cron on oxygen

67e6ec2376-+-Remove ms7/ms8 from site.pp

31d5a94653-+-Hey!  gerrit-stats cronjob!  SHHhhhhh!

b89418fcdc-+-Rsyncing lucene logs over to dataset2.

325638cfda-+-Adding --settings flag to gerrit stats cronjob

d021c9d644-+-Merge "log4j for lucene: fixing typo" into production

db3ecf363e-+-log4j for lucene: fixing typo

af80b3ee5d-+-Merge "disabling lucene loggin fro prefix hosts" into production

21bb864036-+-disabling lucene loggin fro prefix hosts

43bb5db4ea-+-ms-be13 disk layout without ssds

3efa66c73d-+-remove misc::fundraising::impressionlog::compress

b2541d3b8f-+-deprecating misc::fundraising::impressionlog::compress

e150ff0f31-+-Remove udp2log instance from vanadium

ed21f2eb80-+-udp2log.pp - ensuring that udp-filter is installed instead of latest.

45ca287c48-+-Merge "Adding php-luasandbox to labsconsole" into production

e8ad35f0a2-+-Merge "allocating ersch as secondary poolcounter server (tampa)" into production

2054cb6a85-+-allocating ersch as secondary poolcounter server (tampa)

b3afe6cb5e-+-Merge "Disabling `git gc` cron for gerrit for now" into production

a415294a18-+-Disabling `git gc` cron for gerrit for now

8e0eae1a87-+-(bug 38299) remove cm-super

5f7ed28036-+-Ungh, RT 3460 is for halfak, not aaron shulz.

128957c0ce-+-adding netapp mount back to locke (again)

7483b8b286-+-Merge "lucene: a couple of small tweaks to get udp2log results up and running" into production

a49cde001d-+-lucene: a couple of small tweaks to get udp2log results up and running

6d54868620-+-Merge "Don't start the loggers until Varnish is running" into production

fe3485c715-+-Don't start the loggers until Varnish is running

811cacf6f8-+-Merge "removing nfs mount from locke" into production

56b0dd6123-+-removing nfs mount from locke

8b26336797-+-Revert "adding account file_mover to aluminium/grosley/storage3" . . .  because our account creation classes are too broken to use--they create inconsistent GIDs across hosts, thwarting sane use of nfs/netapp.

23a6baf251-+-adding account file_mover to aluminium/grosley/storage3

30385297a7-+-fixed include

0128512dc7-+-second attempt to mount netapp to locke for fundraising banner log archiving

cb366b7c8b-+-Adding php-luasandbox to labsconsole

1e4a28f805-+-Merge "changing ms-be6 to NOT use SSDs for testing" into production

51522d1da4-+-changing ms-be6 to NOT use SSDs for testing

784a9e5d55-+-Revert "adding netapp /vol/fr_archive mount for locke"

ee3e662308-+-adding netapp /vol/fr_archive mount for locke

c0e4971002-+-Fixup for Ie79f4dee: Command should be in single quotes

ca2e1917c7-+-(bug 37083) Setup periodic repack of git repositories

0f1bf3f414-+-(bug 38299) Computer Modern fonts for SVG rendering

a2c5a020c4-+-Merge "Only set up SMTP for gerrit production host" into production

9a0a06a48c-+-Merge "Puppetized gerrit replication config" into production

30ddc2a684-+-Merge "set umask 0002 for users in wikidev group, RT-804" into production

673999036e-+-Merge "Change puppet branch to always use production" into production

3b68413222-+-extract l10n update from scap

46aae45511-+-Only set up SMTP for gerrit production host

352e19004a-+-Puppetized gerrit replication config

8f8daa348f-+-Merge "Make SSL unconditional for gerrit" into production

ee1ed22687-+-Make SSL unconditional for gerrit

3b86aa4e1d-+-Merge "Installing required python packages for community-analytics (django) site." into production

0ce420ff8f-+-adding helium and potassium as poolcounter hosts

a3c96f5af6-+-Don't do changes on cp1029-1036 for now

ed9d428838-+-Send originals and thumbs/temps to Swift

7a21cedcdb-+-Temporarily disable cp1029-1036

92a0aeca7d-+-Installing required python packages for community-analytics (django) site.

0a2bdfe870-+-giovanni is now on stat1 - RT 3460

2793ab4e30-+-Precise has libcairo2, not libcairo

6d0dfe6f14-+-Moving hosts_allow to parameter for misc::statistics::rsyncd.

8176a522ba-+-Merge "Now hosting community-analytics.wikimedia.org from stat1001" into production

ed83406b3d-+-Merge "Fixing up gerrit apache config so it'll work on labs" into production

2c010f5bb6-+-Setting up rsync daemons for /a on stat1 and stat1001.

356192a830-+-Now hosting community-analytics.wikimedia.org from stat1001

b906930c33-+-Merge "Puppetizing /etc/init.d/rsync and /etc/default/rsync" into production

a5334ae587-+-Doh, accounts::, not admins::

92163b4b6d-+-Puppetizing /etc/init.d/rsync and /etc/default/rsync

07f768630d-+-Merge "Access on stat1 for giovanni and halfak - RT 3460" into production

9165b63d3d-+-Merge "Access to stat1 for Ori and S Page - RT 3451" into production

19a5be470b-+-Merge "(bug 38841) phase out old testswarm 0.2 install" into production

0e62ad64ba-+-Merge "Install build-essential because g++ and make are needed for npm install" into production

1303ca7951-+-Adding parameter $server_admin to webserver::apache::site define.

2db8a80c56-+-Access on stat1 for giovanni and halfak - RT 3460

e00642aa25-+-Access to stat1 for Ori and S Page - RT 3451

e3e94ba531-+-Merge "mediawiki module: correcting l10nupdate user key" into production

3e9e9ce8c0-+-mediawiki module: correcting l10nupdate user key

06c450445e-+-set umask 0002 for users in wikidev group, RT-804

a5c251149a-+-Removing xinetd support

a0844d988a-+-Manually adding modules/rsync for managing rsyncd modules.

80b032cb45-+-Also add SSH key to the slave host

cc7e0a07b9-+-Merge "Moving gerrit2 directory creation up with jetty" into production

0e7ac38e31-+-Fixing up gerrit apache config so it'll work on labs

9f4da59962-+-Fix fatal error logging also on precise

460121fbc0-+-Install LuaSandbox also on precise

89b318bede-+-create the decomservers cron job only if realm is production.

18e70e74e5-+-Moving gerrit2 directory creation up with jetty

4e2f2e6305-+-Merge "Overhauling gerrit manifest to be a role class" into production

e20a6058cb-+-Overhauling gerrit manifest to be a role class

40348dc13a-+-Change location of wiki to w, rather than version

93c1152b4c-+-Merge "fixing incorrect cluster definition in applicationserver role class" into production

95746d3e69-+-fixing incorrect cluster definition in applicationserver role class

63485a34d1-+-Merge "adding by-site ganglia clusters to applicationserver role class" into production

56834d8654-+-adding by-site ganglia clusters to applicationserver role class

49684904ff-+-Merge "setting srv281 as an apache with the new role class :/" into production

e15fed38e6-+-setting srv281 as an apache with the new role class :/

d20b6207a9-+-Merge "No longer enable nfs server on nfs1/nfs2" into production

7f72eb3fd5-+-No longer enable nfs server on nfs1/nfs2

2f84b231ef-+-(bug 38946) hebrew fonts for SVG rendering

00858d0869-+-Merge "(bug 38299) Computer Modern fonts for math rendering" into production

b0abc23e05-+-Remove admins::dctech from applicationserver role class

ad0ef92419-+-Migrate pmtpa /home to the NetApp

938172dcc4-+-(bug 38299) Computer Modern fonts for math rendering

a510c26721-+-Fix scripts for management of gluster and home directories

f7c93c9d1b-+-Merge "Adding check_ram into nrpe::packages" into production

132779cde4-+-Merge "closing my account" into production

e8cdb66861-+-closing my account

84c6bfb569-+-Adding check_ram into nrpe::packages

d8705cf24e-+-Merge "Correcting nagios hostname for labs." into production

f779965730-+-realname for hashar unix account

829b4b539a-+-Correcting nagios hostname for labs.

9afa73d3c8-+-set $enabled = "false" on austin account, pass $enabled to unixaccount{}, add check for $enabled, add comment to reflect change

afe8656874-+-(RT 3088) Comment to reflect change

9309a6a729-+-All services need python-keystone to talk with keystone.

4290b303b6-+-making David Schoonover a Jenkins admin

fe9d2f7b51-+-(bug 38841) phase out old testswarm 0.2 install

5f41901929-+-`rake` on contint host gallium

6555db9bb9-+-Changing openstack version to essex for all virt hosts

cf3621520a-+-Changing virt0's nova version to essex

0ef88f8198-+-swift changes for the upgrade to 1.5.0

f3d36defa4-+-Hosting stats.wikimedia.org from stat1001.

128b00bfd8-+-Add NetApp monitoring

b978bcc67c-+-Remove admins::dctech

6a69cf292b-+-Decommission bayes

9b2a0b7e77-+-add the nagios-nrpe-server init.d file

307eb65521-+-Merge "Remove star cert on ekrem, it's unused" into production

0ca34c0044-+-Merge "temporarily pinning lucene version number for pmtpa cluster." into production

fe68648558-+-temporarily pinning lucene version number for pmtpa cluster.

2b55844b08-+-misc/statistics.pp - fixing sampled rsync job

9281caebdb-+-Merge "disable austin account and remove from singer" into production

85dc9cc6d4-+-Change puppet branch to always use production

96582df310-+-Set puppet servername and certname based on realm and site

2dfaaea730-+-Revert "Set puppet servername and certname based on realm and site"

e5996a11df-+-Set puppet servername and certname based on realm and site

dbc659492b-+-add /var/cache/planet and /usr/share/planet-venus/theme/common to be owned by planet

1b8ba6b7ac-+-Merge "mobile.pp: upping version number on vumi and vumi-wikipedia" into production

5e719e6546-+-mobile.pp: upping version number on vumi and vumi-wikipedia

979b8455cd-+-decom srv206,srv217 - RT-1422, RT-241

b4c4c7399d-+-add missing coma to solr init.pp

8cceda7d96-+-Merge "Symlink should be fixed after jetty installation" into production

d768a87470-+-Merge "Updating java.pp for Precise." into production

470a319398-+-Symlink should be fixed after jetty installation

840ec2fe63-+-Allow access to spence by admins::mortals

5934369e1f-+-create cronjobs from array of languages, away with the bash script, just have language config in one place, use a definition, fix typo

787f36b8be-+-Adding eqiad instance ip range to site list

595d1edc93-+-s5 master swap to db45

da60f95416-+-get the dependecies in the right order, first webserver, then modules..

e13def8690-+-Expand hosts.allow for labs puppet access

9424c175fa-+-s3 master -> db34

072fc5b4ec-+-Adjust firewall rule for puppet access in eqiad

6c36e2159d-+-Allow access to labs puppet master based on realm

7597ca75b5-+-Merge "mobile.pp: increasing version on vumi and vumi-wikipedia packages" into production

1850b8d467-+-mobile.pp: increasing version on vumi and vumi-wikipedia packages

9c8c14f753-+-Merge "misc/statistics.pp - setting up cronjob to rsync clicktracking logs to stat1" into production

a76aae2b1e-+-Merge "Moving AFT logs from /var/log/aft into /var/log/squid/aft." into production

874450ca54-+-Merge "Pointing udp2log machine rsync modules at ./squid/ rather than ./squid/archive" into production

ff0f36b5ae-+-update system role description, add some comments

7e3eee50b3-+-Merge "cron to clear gerrit logs" into production

4e5f396bfc-+-Merge "adding ttm solr backend instance to vanadium" into production

7e7878a9fa-+-adding ttm solr backend instance to vanadium

a7bae77260-+-Add a configurable timeout to the git-clone exec.

9d56904ba4-+-upgrading srv193 to new role class/precise

54cf591878-+-misc/statistics.pp - setting up cronjob to rsync clicktracking logs to stat1

2f9a85aa75-+-Moving AFT logs from /var/log/aft into /var/log/squid/aft.

f121acf127-+-Pointing udp2log machine rsync modules at ./squid/ rather than ./squid/archive

b12d0a2f0e-+-Let's try using the standard Linux NFS mount performance options again

7e845ad6dd-+-db63 is the new s1 master

86ac953c07-+-Change bind address for NAT for eqiad network node

0ab6727dae-+-fix Could not find dependency File issue

eceb87691d-+-move supervisord.wikipedia.conf

c5548907c0-+-add supervisor class

64339e3c1d-+-The program 'supervisord' is currently not installed. So adding it...

e9e7391360-+-Change network settings in eqiad for labs

4206f3d170-+-Merge "misc/statistics.pp - setting up rsync job for sampled-1000 logs" into production

cad9e36a11-+-Merge "misc/statistics.pp - installing python-yaml for gerrit-stats" into production

3204512523-+-misc/statistics.pp - setting up rsync job for sampled-1000 logs

b97e5ae2d9-+-Merge "Add labs subnets" into production

b5a136d653-+-Add labs subnets

0bf4677b94-+-production vumi settings

2df7983034-+-disable austin account and remove from singer

4bb31a2d84-+-fix syntax error

b42f4cb44a-+-move index.html, add resource for wmf planet logo

deb7918c06-+-add template files, reduce code length, have some file permission defaults, do not specify path if equal to resource name

6e612c485e-+-Merge "updating public key for cmjohnson" into production

4cb5dfdc08-+-misc/statistics.pp - installing python-yaml for gerrit-stats

3227033058-+-updating public key for cmjohnson

ed6420e94d-+-Updating java.pp for Precise.

f1d7a75228-+-adding public and temp containers to the shard list since mediawiki expects all three, not just thumbs.

3c549dc5d0-+-swapping keys for myself (py)

73187d31b8-+-upping required versions for mobile::vumi class

1e53dcefdf-+-removing dupe def of vumi config file.

6901901488-+-remove unneeded line

b0c11db41f-+-Point eqiad nova keystone references to eqiad keystone config, and fix auth IP for keystone pmtpa.

5f7e968912-+-Vumi production settings

bbc3335492-+-updating versions to match new vumi packages

78c95321c4-+-Merge "adding new public key for chris johnson" into production

f289a081f8-+-adding new public key for chris johnson

75c57a818a-+-Merge "Revert "changing copper swift cluster to not shard containers"" into production

7d021dfd6f-+-Revert "changing copper swift cluster to not shard containers"

aeb13e4b2a-+-Merge "changing copper swift cluster to not shard containers" into production

4fc9722f43-+-changing copper swift cluster to not shard containers

9e99b11085-+-fluorine dhcpd update & recomed from decom file

6ea8425acb-+-fluorine moved from wikimedia.org to eqiad.wmnet

bbdfe5721b-+-decommissioning fluorine to pull from nagios, as its ip is changing

86e2559214-+-Merge "Add FIXMEs" into production

9d9fb9b132-+-Add FIXMEs

3ad809b72e-+-Merge "Move misc::translationnotifications into misc::maintenance" into production

35d2169c9c-+-Move misc::translationnotifications into misc::maintenance

0b0211031b-+-Merge "Rename misc::l10nupdate into misc::deployment::l10nupdate" into production

0c91138b19-+-Rename misc::l10nupdate into misc::deployment::l10nupdate

848b9daeaf-+-Merge "Rename misc::deployment-host to ::deployment, merge misc::scripts and password scripts into it" into production

460582ce88-+-Rename misc::deployment-host to ::deployment, merge misc::scripts and password scripts into it

289f313436-+-Add tenant_name and user_name attribute config to keystone

0020315d2e-+-Add keystone_service and keystone_admin protocols

9d180dda00-+-Block keystone ports, but open them to needed services

41bb06e209-+-Adding in patched code for keystone

3b4c41e772-+-Add policy.json to restrict actions to proper roles

42f979fd74-+-Merge "Disabling live-migration configuration" into production

797c645cea-+-duh, fix syntax error in dependency definition

2823420957-+-Disabling live-migration configuration

a15eb4636a-+-load mod_rewrite

2a40ca8b7e-+-Fix naming of virt hosts in eqiad

5908e77097-+-Event logging via varnishlog over ZeroMQ

3b185ca824-+-Restrict a region to its own services

b90f4f82d1-+-Initial config for eqiad labs region compute, api and network nodes

eda437592e-+-Fix glance db host for eqiad

1139f756e3-+-Merge "puppet classes for new es servers" into production

96397844f2-+-puppet classes for new es servers

723cf8860f-+-Merge "correcting scoping on nagios group def in appserver role class" into production

72d19a5a9c-+-correcting scoping on nagios group def in appserver role class

2308a5f2d3-+-Merge "udp2log: also ensure that logging dirs are owned by udp2log user, not root" into production

c70f2a241b-+-udp2log: also ensure that logging dirs are owned by udp2log user, not root

2a5f9cf75c-+-Merge "Make virt1000 an openstack nova controller" into production

d7050fa7e2-+-add zirconium to site.pp, standard, admins, role::planet

613cd2914d-+-Make virt1000 an openstack nova controller

090c0471b1-+-Up the user-management ldap tools version

c29dad1dae-+-Change LDAP iptables rules to allow all of our network

df3369d409-+-Merge "appserver module: making nagios group defined by $::group, (was $::cluster )" into production

ab6af279d3-+-added es1005-1010 into files

4af50134c0-+-appserver module: making nagios group defined by $::group, (was $::cluster )

d48de6bcac-+-Merge "Fix volume paths" into production

429e844d8d-+-Fix volume paths

046a70a3f5-+-Merge "Need to mount the othersite NFS volumes readonly" into production

a529be9994-+-Need to mount the othersite NFS volumes readonly

356cf9e95a-+-Merge "deprecate manual replication of gzipped fundraising udplogs, instead netapp replication" into production

47de77ba94-+-deprecate manual replication of gzipped fundraising udplogs, instead netapp replication

ec098ec484-+-Merge "Correct eqiad hostname" into production

139bacc4c0-+-Correct eqiad hostname

2ddb8590c2-+-Merge "Mount NFS home_pmtpa on bast1001:/srv/home_pmtpa" into production

4488bebf02-+-Merge "Add some classes for NFS mounts from the NetApps" into production

f1018b8f3b-+-Mount NFS home_pmtpa on bast1001:/srv/home_pmtpa

6475d481af-+-Add some classes for NFS mounts from the NetApps

1568f220c0-+-remove fetch_udplogs from aluminium/grosley, it's handled by netapp replication now

ddf03c2513-+-add nagios monitoring group "misc_pmtpa" because Nagios is broken without it

67e6ffdc58-+-followup Iec13c027653f21d0

ccb157395d-+-labs puppetmasters should be cas...

7987284e3c-+-Fixing script user info

9f913d92df-+-Fix ldap client settings for nfs1/2

d9996e3e43-+-Fix puppet db host setting for labs

0dfcc8c2aa-+-Make zones based on datacenter name

766d9809b8-+-Fix labs controller hostname in pmtpa

ce5f15d96a-+-Fix template location for libvirt info

7494b90962-+-Making virt0 and virt1000 most minimal ldap clients

3d78d4aef2-+-Switch dns ldap config to use new ldap hash

45890d8ad8-+-Rework openstack and ldap manifests

f20c4e1365-+-Revert "Rework openstack and ldap manifests"

18b217624d-+-Rework openstack and ldap manifests

f6f992faed-+-Reconfigure mysql after changing the config.

c3dff901b7-+-Merge "refixing page triage cron" into production

df796b3dc8-+-refixing page triage cron

e5f6bb59c0-+-Merge "on faidon's advice, include not require." into production

af33541dde-+-Merge "Add Git on yttrium" into production

c4032a4526-+-on faidon's advice, include not require.

acae54cd65-+-Merge "appserver/mediawiki module: sadly, more cross-module deps are needed" into production

4f759f4b8c-+-appserver/mediawiki module: sadly, more cross-module deps are needed

9aa790a3b8-+-Merge "Add the upstream stdlib module to the repo" into production

c93c369ed9-+-Merge "fix for dependency cycle" into production

e840cefde7-+-fix for dependency cycle

babb45fcb8-+-Merge "appserver module: smooshing sync back into server to avoid circular deps" into production

1d10501757-+-appserver module: smooshing sync back into server to avoid circular deps

8c80d02c88-+-Merge "appserver module: no inits in subdirs. rejiggering" into production

05461ef006-+-appserver module: no inits in subdirs. rejiggering

cb674fa005-+-Send wmerrors logs to fluorine and notify apache

27779edd04-+-Use standard iptables rules for mw loggers

1835a3c15c-+-Add the upstream stdlib module to the repo

5255a0c58d-+-Make fluorine an MW log host

f8a590ce2f-+-Fix linking of CA certs by using an unless that will match

6fa40b4dec-+-Merge "updating the swift-drive-audit version with local enhancements" into production

df9474c450-+-updating the swift-drive-audit version with local enhancements

20edc7a961-+-Merge "removing dependency that's already filled by the dependency on the storage service" into production

82a4d30d87-+-removing dependency that's already filled by the dependency on the storage service

13b43a1dbe-+-Merge "adding swift-drive-audit cronjob to monitor failed disks on swift storage nodes." into production

165114840b-+-adding swift-drive-audit cronjob to monitor failed disks on swift storage nodes.

ecc82567a4-+-recommissioning zirconium (RT-3401)

2813d9e7a8-+-Removing dataset2 mount from misc::statistics::base

18a25b11a0-+-Merge "Adding stat1001 to site.pp.  Reorganizing role::statistics into ::cruncher and ::www." into production

e4a25dbb74-+-Merge "vumi: include password class" into production

c087dd6dd2-+-vumi: include password class

eb9a5911bc-+-Merge "vumi: correcting password lookup" into production

3ec279fdd3-+-vumi: correcting password lookup

2aeb3985e7-+-Adding stat1001 to site.pp.  Reorganizing role::statistics into ::cruncher and ::www.

98facbb1e2-+-Merge "silver and zhen: wikidev group needed to have a user." into production

94d9d9ab8c-+-silver and zhen: wikidev group needed to have a user.

79e4eb7f34-+-Merge "fixing transitional nagiso breakage" into production

b339ab7064-+-fixing transitional nagiso breakage

37a128df36-+-Install LuaSandbox extension on MW apaches

33fdd1656c-+-more unbreaking of puppet due to switch to mediawiki module

5e4599c5e0-+-fixing broken puppet on hume

bbc67de2a5-+-install star SSL cert in role class, dependency using new arrow syntax

e6e8c557a2-+-Install build-essential because g++ and make are needed for npm install

da1e013eb1-+-sudo::group : allowing for multiple priv. definitions for one group

4e29c09bcf-+-mediawiki module namespace stuff: must rename dir as well.

822f0ec256-+-another namespace hack. mediawiki module is now mediawiki_new

48840d24a0-+-changing scoping on include in mediawiki module

3bcbe1dd58-+-temp hack to differentiate applicationserve module and the old applicationserver role class

f9c33227a2-+-added fluorine to site.pp

a6060c80ad-+-ms10 to public hostname

b632b12530-+-ensure /usr/share/planet-venus/wikimedia and all the subdirs exist

799eec3246-+-use template for planet config and apache site config

a53aaf5a51-+-planet - add apache site config

1e897cda7c-+-planet - add webserver to role class, define document root dir

d699f39b60-+-moving eqiad enwiki snapshot host from db1033 to db1050

22748f885e-+-Merge "moving sudo definitions from sudo::applicationserver into the correct modules" into production

bb4d65b827-+-moving sudo definitions from sudo::applicationserver into the correct modules

571340c81d-+-adding labs1-c-eqiad subnet

cf8fcd8e58-+-Merge "Put the config::apache inclusion in the webserver role class" into production

7aa855aad1-+-Merge "Kill $cluster, it conflicts with the global $::cluster." into production

ac697b9ede-+-Merge "Cleanup" into production

a43487e0ae-+-Merge "What kind of messed up indentation was that?" into production

a67fed5058-+-Merge "Try a different way of configuring apache" into production

3916a86e50-+-Merge "Cleanup" into production

74fa79eaf4-+-Merge "Add videoscaler class" into production

26ef1e0ab9-+-Add a missing import for poolcounter.pp

7864bae866-+-Split PoolCounter off into a separate class

69fc10553e-+-new eqiad dbs

a494d27e35-+-Add videoscaler class

d2e023f362-+-adding db10(49-50) to s1

87dfadd8ff-+-Put the config::apache inclusion in the webserver role class

105f65dc62-+-update of andrew otto's key without == at the end.

ff7748dc32-+-Kill $cluster, it conflicts with the global $::cluster.

c4a1e35d7d-+-Cleanup

ecd09392a0-+-What kind of messed up indentation was that?

b2b4cb64e8-+-Merge "Initial version of solr for ttmserver" into production

aad00b6a0d-+-Try a different way of configuring apache

95c99867da-+-Cleanup

9aa97989eb-+-add new key for ottomata

b46d69e58d-+-Add cr1-esams to Nagios

a1d1c1fb1f-+-Add cr1-esams to Torrus

f98f4e066a-+-Add partial RANCID manifest

d9ae3fb2db-+-Initial version of solr for ttmserver

f73ffc081c-+-Merge "Remove unused and obsolete techblog class" into production

528f48dfb6-+-Merge "Actually monitor the survey.wm.o cert on argon" into production

2a4575d501-+-Merge "Actually use misc::secure to run secure.wikimedia.org on singer" into production

59e7dfb54c-+-switching to new jobrunner class in applicationserver role class.

b803d216d6-+-some cleanup for the mediawiki module

79dc1d7087-+-didn't mean to commit this. not nearly done.

810ddbd94f-+-mediawiki and application server modules.

826c2fc6f8-+-(RT 3325) olivneh restricted => mortals

d5216be8a5-+-Fix a couple of jobrunner puppet errors

3784e15c26-+-Merge "migrate wikimedia-job-runner to puppet" into production

000886ca6f-+-Merge changes I3ea61476,I5e30b2cc into production

cf1901f8d2-+-rebuilt swift upgrade cluster

44305b533c-+-Add Git on yttrium

084d8fe15c-+-Add user accounts to the WLM host

7d7bc03c43-+-Install Parsoid on wtp1

aebd5e03a5-+-Add a service class for Parsoid

4521d624ec-+-Merge "cp1042 is not a wm.o host, only eqiad.wmnet" into production

35c16f1584-+-Switch bits.esams backend from eqiad to pmtpa

8626fb69a9-+-cp1042 is not a wm.o host, only eqiad.wmnet

48fa991fe0-+-Merge "add account for krinkle to mortals and jenkins admins per RT-2997" into production

c54a2a8652-+-add account for krinkle to mortals and jenkins admins per RT-2997

7dabb4077c-+-planet - new configs compatible with planet-venus, add index.html, include locals, rebased, fix path conflict, rename templates to erb, parameterized classes, ...

daaaa54d98-+-adding eqiad swift cluster to lvs

a86d6b7ea0-+-updating account info for eqiad swift cluster.  telling it to write thumbs and call image scalers directly.

b418098755-+-Merge "Further UI fixes to Gerrit, courtesy of Timo and Trevor" into production

a050ba5174-+-migrate wikimedia-job-runner to puppet

0dd74bf8ff-+-Make the labs service IPs follow the correct hash structure

2229c0ae80-+-Remove stupid labs LVS workarounds, remove duplicate lvs::realserver invocation

9a3aaf1a66-+-Get rid of $lvs_realserver_ips completely, only the param is now supported

4ef4dbf0fc-+-Make all lvs::realserver invocations parameterized

8ffa4a0fa4-+-Fix lvs::balancer::runcommand dependency

6191b9c53b-+-Properly parameterize lvs::balancer, remove labs hack

926f2f42ee-+-Further UI fixes to Gerrit, courtesy of Timo and Trevor

f43818a52f-+-Merge "turning off the swiftcleaner" into production

16b07d5907-+-turning off the swiftcleaner

6b6e553474-+-Merge "Ensure we don't accidentally upgrade" into production

0095f59d62-+-Ensure we don't accidentally upgrade

a676c8f35f-+-Fixup to I90fc1c45, couple of other UI fixes

d358d5274e-+-Merge "Bunch of Gerrit UI fixes" into production

90a68c2463-+-Bunch of Gerrit UI fixes

007ad5c6b6-+-Use 'undef' instead of 'false' in a couple of puppet case statements.

9d556cb861-+-Merge "Revert "Restart the NTP client if hit by the leap second bug"" into production

f21cae7e8c-+-Revert "Restart the NTP client if hit by the leap second bug"

40424ad42e-+-calcium tasked in site.pp

0d378bf229-+-updates for smokeping

58134f68bd-+-let Jenkins update the integration.mw.org root dir

367429fb7b-+-adding db12 to decom list

ddda2acf43-+-Merge "include misc servers in ishmael" into production

160961959e-+-include misc servers in ishmael

1e3670f4e6-+-Merge "addin an es_eqiad nagios group" into production

1d5f2eb04d-+-Merge "moving db role classes to role/db.pp." into production

e8041f1e1e-+-addin an es_eqiad nagios group

e4d45d5671-+-run query analysis if a cluster is defined, vs. if in tampa

392cb98cb0-+-moving db role classes to role/db.pp.

acf9d5f7df-+-Wiki Loves Monuments API server, RT#3221

37cf7a2960-+-Merge "page triage cleanup: use correct syntax for mwscript" into production

2c0877b894-+-Revert "certs: use c_rehash instead of manually symlinking"

99ed702be7-+-Merge "Revert "Follow up to change 17065, adding the rapidssl ca source back in"" into production

49728765ca-+-page triage cleanup: use correct syntax for mwscript

c3eb307bed-+-Revert "Follow up to change 17065, adding the rapidssl ca source back in"

2e3dbf96f3-+-Restart the NTP client if hit by the leap second bug

fbe2c84671-+-adding db63 to s1

98ef635bbb-+-Follow up to change 17065, adding the rapidssl ca source back in

8f830f0681-+-Merge "certs: use c_rehash instead of manually symlinking" into production

d40c06dbb9-+-Merge "changing ganglia's idea of the swift eqiad cluster from the test cluster to the to-be-prod cluster." into production

dae2e3e61f-+-changing ganglia's idea of the swift eqiad cluster from the test cluster to the to-be-prod cluster.

b4fa8998a9-+-Merge "changing swift pmtpa-prod cluster to use the image scalers directly instead of ms5" into production

fa8bfacb7d-+-changing swift pmtpa-prod cluster to use the image scalers directly instead of ms5

c6838e5342-+-Merge "amending swift's rewrite.py to allow it to talk directly to mediawiki image scalers instead of ms5" into production

54dd29982a-+-Move cp1042 internal

513c9738fb-+-certs: use c_rehash instead of manually symlinking

5608f74661-+-Add keystone config import to nova's api-paste

228680db2a-+-amending swift's rewrite.py to allow it to talk directly to mediawiki image scalers instead of ms5

ff8768647d-+-wlm.wm.org is a CNAME, use yttrium instead

28cd58f576-+-Merge "Adding wlm.wikimedia.org to site.pp" into production

d1775e00a7-+-settings for high network usage for ms10

bb538a851c-+-cron to clear gerrit logs

034735af23-+-structure for WLMMobile nightly builds

59c52c2b3a-+-Adding wlm.wikimedia.org to site.pp

e41ed84250-+-Merge "swapping potassium and zirconium to internal vlan & adding to decom to remove invalid data from nagios" into production

a5bea7c5f4-+-swapping potassium and zirconium to internal vlan & adding to decom to remove invalid data from nagios

f774da565a-+-Merge "Revert "Adds WLM api host config in misc-servers"" into production

b71c6cd4fe-+-Revert "Adds WLM api host config in misc-servers"

d60e684bbb-+-Merge "Fix bits VLC when enable_geoiplookup is disabled" into production

0540998a7c-+-lvsrealserver is no more a parameter

4d5779b7c2-+-Merge "Adds WLM api host config in misc-servers" into production

a1076d6791-+-Merge "claiming calcium for smokeping use" into production

d8f9a83acc-+-claiming calcium for smokeping use

8d2dedf850-+-Adds WLM api host config in misc-servers

73559439b6-+-adding in the basic support for smokeping, will be using local puppetmaster in labs to further refine

e424d5280c-+-cp1041 (Precise) mobile disk cache back to 100G

c52e5a36f1-+-Add asw-c-eqiad to Torrus

74758cbccc-+-Merge "(bug 38084) uses /data/project instead of NFS instance" into production

9dfd23e87f-+-Merge "include nfs::upload if $upload, not $lvsrealserver" into production

6d26a1d341-+-removing dependency on another class's files

60b064e4a8-+-importing nfs.pp so class knows where File/home/wikipedia is

c5a84a396d-+-include class nfs::home::wikipedia check in nfs::home

80e8b3ebc7-+-Also wrap the cron job in an if

53f0bac24f-+-Wrap the monitor_service call too

b6297654d0-+-Don't try to do ensure=>absent, seems to be broken

10c308bdd3-+-Add description and split the other one too

82a006650d-+-Make nrpe::monitor_service conditional rather than using present/absent

6eb77fd97d-+-Fix double inclusion of misc::udp2log on nfs2

ea6577b48f-+-Merge "Changes for essex" into production

c231660b69-+-Changes for essex

f3f79ebdf3-+-Merge "Change analytics1-c-eqiad subnet to address plan" into production

ab02140fcb-+-Merge "Update subnets hash" into production

76ef928a9b-+-Change analytics1-c-eqiad subnet to address plan

25195772c3-+-Update subnets hash

80b91fe009-+-(bug 38084) uses /data/project instead of NFS instance

8a3a690e2f-+-statisics.pp - Renaming some variables, fixing undefined $gerrit_stats_data_path.

f9f740c4e2-+-include nfs::upload if $upload, not $lvsrealserver

99c65844af-+-Fix bits VLC when enable_geoiplookup is disabled

f04306e975-+-Merge "Revert "include nfs::upload if $upload, not $lvsrealserver"" into production

efedf2b787-+-Revert "include nfs::upload if $upload, not $lvsrealserver"

3fc507359a-+-Merge "updating eqiad cluster hash.  adding ms-be1009-12 to dhcp" into production

6cc9480df3-+-updating eqiad cluster hash.  adding ms-be1009-12 to dhcp

6ece81f965-+-apaches::monitoring::labs wraps to apaches::monitoring

cc1e6f4863-+-include nfs::upload if $upload, not $lvsrealserver

95013dba16-+-Merge "Fixing cron spam" into production

2e0748a68b-+-Fixing cron spam

7165ee04c0-+-xtrabackup is now percona-xtrabackup, precise hosts don't need a separate mysql repo

a9654d8d2d-+-fixing mysqlatfacebook package names for precise

49dff60023-+-precise mysql pkgs

7d65604dae-+-Merge "varnish::instance learned 'cluster_options'" into production

127a7a23c2-+-varnish::instance learned 'cluster_options'

b95cc34447-+-Actually move LVS to their own Ganglia group

48f34a23ee-+-Remove timedmediahandler.pp

a9e3b560aa-+-Scope with root all $lsb* fact variables

5527672a8c-+-armor an escape to have it ignored by puppet

2ee1fa5574-+-Another syslog fix: use double quotes

0fbd8668c7-+-syslog: do not use a localhost remote

58df37a673-+-Fix reassignment of $syslog_remote_server

473b623aff-+-Merge "rsyslog should send logs to $::syslog_server" into production

5864a5f06b-+-Merge "planet: comment that update-planets need to be changed too" into production

f14e3a5ab0-+-Merge "disabling eqiad swift cluster stats until the cluster is functional." into production

a9c0d876e6-+-disabling eqiad swift cluster stats until the cluster is functional.

dcc8817e7f-+-Fix another hostname typo in Ganglia

f6631a8a4c-+-Merge "Fix hostnames for esams LVS Ganglia aggregators" into production

e162b48c23-+-Fix hostnames for esams LVS Ganglia aggregators

ed58907b52-+-significantly increase timeout on mw-sync.

2aeb0d3f81-+-nrpe: add a missing requires

189a1f5c85-+-Merge "adding puppet rules for eqiad prod swift cluster" into production

02bb16ec4b-+-adding puppet rules for eqiad prod swift cluster

8dabf086fb-+-Fix a non-capitalized resource reference

d3d02c56ea-+-Reource references should now be capitalized

960a558c51-+-role::logging::mediawiki needs misc::udp2log and utilities

0ea6372046-+-disabling puppet swift configs on test cluster for local perf testing changes

a0d03e7c02-+-Merge "fix system_log entry in role::logging" into production

85afcebfb3-+-Merge "abstract out udp2log for MediaWiki logging" into production

a7cecb86fd-+-fix system_log entry in role::logging

3bc4ae656f-+-Remove OWA manifests

581c053bcd-+-Remove owa1/2/3 from decom, still in use

18f1344e3f-+-abstract out udp2log for MediaWiki logging

e29a9ee157-+-run lvm snapshots on db49 and db1046 (otrs/gerrit)

56a2b27f2c-+-Merge "misc::maintenance::pagetriage : added this class to hume" into production

ce1c4b655f-+-misc::maintenance::pagetriage : added this class to hume

bb17c7c8cb-+-setting ms-fe1 and ms-fe2 as ganglia agregators for pmtpa swift group

956da3699f-+-adding db28 to decom

6eec11a6bb-+-Switch db and ldap host for gerrit

b39e222ec3-+-Add msfe1001 to decommissioned hosts

5c540c3f29-+-Add all of mw10[0-9][0-9].eqiad.wmnet to decom

bf54c58588-+-Enable BGP announcement for all IPv6 (nginx backed) services

bf3f414704-+-Add a few decommissioned hosts

c401273eed-+-Fix file paths

718c9a76ee-+-Puppetize reprepro configuration

ac2639cb85-+-Adding missing puppet config for nova essex puppetmaster

2c5e1e0507-+-Merge "Adding patches for metadata queries" into production

db9aeeb9d1-+-Adding patches for metadata queries

fb14cc7dd2-+-role/apache.pp cleanup: only need apaches::monitoring once...

09c5a5e03b-+-role/apache.pp: adding in lvs_pool support

8b40165368-+-(bug 37076) `lint` tool require php5-lint

7610cfae1d-+-Merge "+geoip for applicationserver::labs" into production

54c0fbe60c-+-fix syntax errors

aa72477f27-+-Merge "enabling https on ganglia" into production

6312889037-+-enabling https on ganglia

13398d2ff9-+-giving srv194 an apache role class for testing

c17ede463f-+-prevents icinga from overwriting config files

6167f5997f-+-reactivating icinga files

bc90bf63d4-+-smtp is tcp

856b8668ea-+-telling iptables what smtp is

5cb59620a0-+-temporarily blocking smtp out so that I can fix icinga without paging everyone

00014465f1-+-Merge "ntp: cleanup, parameterize, enforce style" into production

6a18f2a62a-+-Merge "ntp: move to a module" into production

3be9ec04c8-+-Merge "stafford: add puppetmaster config for modules" into production

48aa9dfa7a-+-Merge "puppetmaster::self: initial support for modules" into production

f1fe3aefdb-+-stafford: add puppetmaster config for modules

7b2e2024b9-+-Merge "role/apache.pp making realm a qualified var and cleaning up some stuff that's no longer used" into production

bad0185b4f-+-role/apache.pp making realm a qualified var and cleaning up some stuff that's no longer used

dddf660880-+-rsyslog should send logs to $::syslog_server

57f3df3361-+-Enable IPv6 for lvs4

166f6eb1a5-+-Remove Precise test for eqiad LVS servers

61e0014f94-+-Convert lvs1002 configuration to new-style, with IPv6, for after reinstallation.

caa21524aa-+-Cleanup eqiad LVS configuration, use a selector

1065271c73-+-Make lvs1001 configuration new-style, with IPv6, for after reinstall

2ed2518a7e-+-Enable IPv6 for lvs1003 and lvs1006

2451892138-+-Cleanup esams lvs configuration now all servers are Precise

52cb336b47-+-Make amslvs1 config new-style, IPv6 disabled, for after reinstall

9f419e238f-+-Move amslvs2 configuration to new-style, but IPv6 disabled, for after reinstall

0a7e192a55-+-ntp: cleanup, parameterize, enforce style

de6be0cd8c-+-ntp: move to a module

c608696b93-+-puppetmaster::self: initial support for modules

4b15754c3e-+-Enable IPv6 for lvs3, after reinstall

5070ddec85-+-Clean up old style LVS service IP configuration Use a selector instead of if-statements

cf553d10bf-+-Move lvs5 configuration to new-style with IPv6, for after reinstall

38083ea353-+-Move lvs6 configuration to new-style with IPv6, for after reinstall

6efb305d84-+-moving ganglia-web directory to new install

61622e1f25-+-Merge "creating jobrunner nagios group" into production

96db4c0c77-+-Merge "renaming imagescaler nagios group so that it's consistent with all the others" into production

ef35fb7612-+-Merge "cleanup of apache.pp role file. merging labs and proc common role class." into production

0813bb61d9-+-creating jobrunner nagios group

a0a91dad97-+-Merge "muting all config changes from puppet to prevent pages" into production

cced479393-+-muting all config changes from puppet to prevent pages

82f22bd82f-+-Merge "Revert "RT #1424 (Set up log rotation for wmerrors log)"" into production

4df78304bc-+-renaming imagescaler nagios group so that it's consistent with all the others

40a5968b23-+-create icinga rw directory

f8a8ddf45f-+-cleanup of apache.pp role file. merging labs and proc common role class.

2d37232921-+-Merge "icinga::monitor::apache class added" into production

191b594acf-+-icinga::monitor::apache class added

3c1fc76385-+-Merge "Use the chash director for the mobile servers" into production

3782215f97-+-Use the chash director for the mobile servers

5cb4ee1033-+-Merge "Use much smaller disk caches to test the new LRU code" into production

93ca162731-+-Use much smaller disk caches to test the new LRU code

6209f035b7-+-Merge "Move php5 Apache module out of site.pp into misc::noc-wikimedia" into production

fc54d59243-+-Merge "varnishhtcpd depends on certain perl dependencies installed" into production

e438cca77a-+-varnishhtcpd depends on certain perl dependencies installed

27d4eaa1f8-+-renaming otrsdb cluster name to m2, adding db1046 as as slave and db1048 as a master

cc85095c5e-+-otrs is stuffing large email attachemnts into blobs, which was breaking replication

55bd783dac-+-Actually use misc::secure to run secure.wikimedia.org on singer

41eb7cc8d5-+-Merge "get the lost wikistats class back in, add a role class and case for prod/labs, do not wrap classes, define instead of include, apache ports.conf file,..." into production

b312a26780-+-Remove unused and obsolete techblog class

16bb78a40e-+-Move php5 Apache module out of site.pp into misc::noc-wikimedia

99dbbedd9c-+-Merge "Use the new persistent storage code for cp1041" into production

e5105530b3-+-Use the new persistent storage code for cp1041

da5f63dd3c-+-Merge "Update mobile backends" into production

88721f7614-+-Update mobile backends

d9bea9cf6d-+-Merge "Fix persistent storage paths for Precise reinstalls" into production

6d76f7c964-+-Fix persistent storage paths for Precise reinstalls

b3d3279e1b-+-Merge "Setup cache file systems" into production

61c3885686-+-Setup cache file systems

9e1c9a4b6e-+-Revert "Temporarily decommission cp1041"

ff65debdda-+-Temporarily decommission cp1041

76b600decc-+-Support both public and internal varnish servers for mobile

b82821f341-+-get the lost wikistats class back in, add a role class and case for prod/labs, do not wrap classes, define instead of include, apache ports.conf file,...

8c6a67294d-+-statistics.pp fixing gerrit stats cron job to push

dc98a4359c-+-base.pp - emacs23, not emacs32

3f728097c1-+-Merge "site.pp - accounts::haithams, not admins::haithams" into production

3ebaed538f-+-site.pp - accounts::haithams, not admins::haithams

5b54969499-+-make blondel writeable

f2386653df-+-Merge "statistics.pp - rsyncing arabic-banner logs to stat1 for Haitham Shammaa." into production

6b7c7dc9cf-+-Merge "Giving access to Haitham Shammaa on stat1 for wikipedia arabic fundraiser analysis." into production

f456f47f40-+-Merge "statistics.pp - gerrit-stats now uses cli options for data file location and pushes generated stats to gerrit-stats/data" into production

6ae6de0960-+-Remove star cert on ekrem, it's unused

2b173521f8-+-removing mailq.cfg from icinga

cd746e7921-+-Actually monitor the survey.wm.o cert on argon

24c0cd55da-+-removing dupe definition

1c5a5213e5-+-Merge "base.pp,site.pp - parameterizing contact_group for base::monitoring::host" into production

f5b38ea664-+-base.pp,site.pp - parameterizing contact_group for base::monitoring::host

480c0ea6c9-+-cleanup of apache.pp, mediawiki, roles/apache, etc

234637652f-+-Giving access to Haitham Shammaa on stat1 for wikipedia arabic fundraiser analysis.

0292ab230a-+-statistics.pp - rsyncing arabic-banner logs to stat1 for Haitham Shammaa.

0700cb24f1-+-Precise: get rid of php5-fpm

132b85d6ad-+-Merge "adding ms-fe3 and 4 (new frontend servers) into the memcache rotation for swift production cluster" into production

bb49b708a2-+-adding ms-fe3 and 4 (new frontend servers) into the memcache rotation for swift production cluster

b97f7f2dff-+-Merge "adding ms-fe4" into production

80fe96535b-+-adding ms-fe4

84e16200cc-+-shell access for Matt Walker

504fdd8391-+-Merge "adding new ms-be hosts to the swift backend cluster" into production

16db17a085-+-adding new ms-be hosts to the swift backend cluster

f62e870871-+-statistics.pp - gerrit-stats now uses cli options for data file location and pushes generated stats to gerrit-stats/data

2e1b8d9136-+-adding db30 to decom list

24654ddc24-+-Make hydrogen a DNS server instead of helium

ac8ac389ba-+-Make helium a DNS recursor

206b80701e-+-Specify a full path for git::clone:  srv/mediawiki

d03f883742-+-updated icinga config files to latest format

1348debc0d-+-removing service (temporarily)

0e9d9dab0d-+-commenting out a few files for new install and then including packages

5af760f67b-+-with no gammu on this, no need for gammu group

2d299d4e72-+-RT #2841: decommission gilman and remove from site.pp

13a85c5ffc-+-Merge "statistics.pp - installing python-mysqldb on stat1 for gerrit-stats" into production

f3f2b54fa1-+-moving pc1 from coredb (for comparitive benchmarks) to pcachedb conf

8c912077d4-+-fix pc host regex

26c2e232d8-+-initial config for new parsecache db

e0a14fe8e2-+-giving ori sudo access (approved by ct RT3152)

0744aa3c8a-+-Merge "switching fqdn to internal for vanadium" into production

a897891cfe-+-switching fqdn to internal for vanadium

295b4d7319-+-Merge "Change nrpe address for labs" into production

d97d06b4f6-+-Change nrpe address for labs

43a7e22bf8-+-reverting commenting of users

074e414c53-+-testing commenting out more accounts

49dc2623bd-+-Revert "trying commenting out groups on vanadium"

6157235751-+-trying commenting out groups on vanadium

c9da2ebabd-+-Merge "Revert "added Ori for access to vanadium"" into production

7847fc4256-+-Revert "added Ori for access to vanadium"

86a4fcee4c-+-Merge "added Ori for access to vanadium" into production

ed8720d177-+-added Ori for access to vanadium

350ef8bdbb-+-Merge "Add dns_rec LVS service IP to lvs1002" into production

0bedc3c846-+-Add dns_rec LVS service IP to lvs1002

f03be2143b-+-statistics.pp - installing python-mysqldb on stat1 for gerrit-stats

a386b3bca1-+-Merge "ganglia: separate LVS servers into their own group" into production

1e3e3a269c-+-Merge "moving swift ring files to volatile storage to get them out of git" into production

2375b0ad78-+-setting up vanadium like oxygen

828052fbcf-+-moving swift ring files to volatile storage to get them out of git

da9be0ef4d-+-Add DNSQuery monitor to dns_rec LVS service

3408445383-+-Some hosts don't have eth0

5e5eab7bbe-+-Fix lvs manifest on hosts that don't have IPv6

25f71c6704-+-Diablo ppa is gone, removing

ac93bd5b70-+-Add email key to gerrit config class

ea87db1868-+-Couple of fixes for Gerrit:

f7871f303d-+-Merge "Convert remaining $nameservers changes to $nameservers_prefix, install recursor on all LVS servers again" into production

f746dd62a2-+-Convert remaining $nameservers changes to $nameservers_prefix, install recursor on all LVS servers again

156201f007-+-Merge "Install a DNS recursor on new LVS servers after all" into production

604e0700bc-+-Install a DNS recursor on new LVS servers after all

7c12e41ace-+-Merge "Allow servers to prefix nameservers (e.g. LVS)" into production

139d921b4b-+-Allow servers to prefix nameservers (e.g. LVS)

29941b1d1b-+-planet: comment that update-planets need to be changed too

4ce6e196d6-+-nagios authdns now check nagiostest.beta.wmflabs.org

f758a5d220-+-Set apache nice level to 0

bf6ada330a-+-Adjust sshd and apache nice levels per RT #664

310b5142b4-+-Revert "RT #1424 (Set up log rotation for wmerrors log)"

31c128da94-+-Merge "last puppet commit for labsupgrade cluster setup" into production

e7e120f82e-+-last puppet commit for labsupgrade cluster setup

f355ba4308-+-Merge "setting up labs swift cluster to test upgrades" into production

99e46791ef-+-setting up labs swift cluster to test upgrades

cb88341bc7-+-Merge "Use cron.php symlink at /home/wikipedia/common/wmf-config/extdist/cron.php so that we have a consistent location for both the files, and the svn-invoker.conf that goes with it" into production

bee32fbbf2-+-Merge changes I562036b5,I8014889f into production

42086d9df8-+-Merge "Quote resource title" into production

87ae897003-+-Quote resource title

56e505e562-+-Merge "Installing emacs on stat1 (per request from Global Dev)." into production

1af0af1645-+-Merge "geoip.pp - sshhhhhing stdut of geoipupdate cron" into production

a325b682fc-+-Merge "Fix DNS monitoring" into production

8813d0df91-+-Fix DNS monitoring

b1ce76bbda-+-Merge "misc/statistics.pp - adding -t flag to rsync log command to preserve mod times" into production

a81bb87e2d-+-Merge "Let eqiad servers use their local resolver cluster, pmtpa as backup" into production

4cc940230e-+-Let eqiad servers use their local resolver cluster, pmtpa as backup

f1352b906f-+-Merge "Give chromium a static IPv6 address" into production

a03463acff-+-Give chromium a static IPv6 address

fa0a411c3c-+-Merge "Allow DNS queries from all WMF networks" into production

eb67d61f89-+-Allow DNS queries from all WMF networks

56c0d4bc56-+-Merge "Add IP address to monitoring title" into production

096fa8352b-+-Add IP address to monitoring title

190f443a87-+-Merge "Fix monitor_host in dns::recursor::monitor" into production

1decf0a325-+-Merge "Fix dependency of dns::recursor::metrics" into production

86772b225a-+-Fix monitor_host in dns::recursor::monitor

a489598fee-+-Fix dependency of dns::recursor::metrics

11a0889076-+-Merge "Parameterize allow-from in recursor.conf" into production

9264427d96-+-Parameterize allow-from in recursor.conf

756d045da6-+-Merge "Setup monitoring of recursive DNS realservers" into production

8da74871d6-+-Setup monitoring of recursive DNS realservers

fa49fcffd1-+-Merge "Fix recursive DNS monitoring" into production

2cd95ae6c3-+-Fix recursive DNS monitoring

8185848ff4-+-Merge "Process name is pdns_recursor, init script remains pdns-recursor" into production

ed5dc0ae26-+-Process name is pdns_recursor, init script remains pdns-recursor

dccb162de4-+-Merge "Fully qualify dns::realserver" into production

bf831b24c2-+-Fully qualify dns::realserver

190b776112-+-Merge "Bind LVS service IPs in role::dns::recursor" into production

dcba8e1cc1-+-Bind LVS service IPs in role::dns::recursor

36615419b1-+-Merge "Make dns::recursor accept multiple addresses to listen on" into production

e49b0a556c-+-Merge "Add IPv6 LVS service IPs for dns_rec" into production

15b905910c-+-Make dns::recursor accept multiple addresses to listen on

8a06eeb715-+-Add IPv6 LVS service IPs for dns_rec

0ab944de4e-+-Merge "Make chromium a DNS recursor" into production

5ab45f9972-+-Merge "Make a role::dns::recursor role class" into production

6f1a63e4bb-+-Make chromium a DNS recursor

5a96975442-+-Make a role::dns::recursor role class

dedb21976f-+-Merge "Reuse chromium" into production

d197044423-+-Reuse chromium

9125732535-+-Merge "Make dns::recursor a parameterized class" into production

53bab1d72e-+-Make dns::recursor a parameterized class

27d0359ed4-+-Merge "Revert "notify Service[apache2] when its conf changes"" into production

c8c3448ba6-+-Revert "notify Service[apache2] when its conf changes"

6a548896de-+-Merge "Use chromium for eqiad DNS" into production

5aa627786b-+-Use chromium for eqiad DNS

b0d1d21787-+-/etc/wmflabs-instancename containing instancename

96fd2c789f-+-comment closing brace in long cases switch

6ee375c343-+-ganglia: separate LVS servers into their own group

583f46dd8a-+-Installing emacs on stat1 (per request from Global Dev).

3bb98eaf91-+-Merge "php5-memcache isn't used" into production

424e85d8c7-+-php5-memcache isn't used

604a27e690-+-+geoip for applicationserver::labs

a7287bfc37-+-misc/statistics.pp - adding -t flag to rsync log command to preserve mod times

abdbe7bffd-+-disable geoip on labs for now

2670714e1f-+-Merge "appsudoers is not a puppet class" into production

3a13ae2b54-+-notify Service[apache2] when its conf changes

b4b88f3a8f-+-copying roles from site.pp to role/apache.pp plus cleanup

94f0627a4d-+-adding olivneh to admins::restricted per RT 3116

f424d1f224-+-ensure snmpd running

8900d8d1e7-+-Merge "trying to fix snmptt restarts on neon" into production

f795ea98f4-+-trying to fix snmptt restarts on neon

38f0411793-+-Use cron.php symlink at /home/wikipedia/common/wmf-config/extdist/cron.php so that we have a consistent location for both the files, and the svn-invoker.conf that goes with it

17a2407dbc-+-puppetmaster: split geoip into a subclass

f4e2108a10-+-puppetmaster:self clone puppet prod branch

9ffda75f5b-+-Merge "Disable IPv6 privacy extensions on all servers (takes effect on reboot)" into production

69e457208b-+-Disable IPv6 privacy extensions on all servers (takes effect on reboot)

0cdb6c7ac8-+-puppetmaster::self: fix git::clone target

1ac65e1298-+-Re-add ssh parameter to git::clone

fd47f4225c-+-Merge "puppetmaster: another fix for ::self" into production

797feedba8-+-puppetmaster: another fix for ::self

b693251857-+-Merge "puppetmaster: fix ::self" into production

c1d9bb2cba-+-Attempt to fix the inline_template

5f6d8deb78-+-Add bgp-nexthop-{ipv4,ipv6} global variables to pybal.conf, as is now required

31e0ecb8fd-+-puppetmaster: fix ::self

495c112025-+-Merge "/etc/wikimedia-realm containing $::realm" into production

2f449a63e3-+-/etc/wikimedia-realm containing $::realm

c7ff1a8f98-+-Merge "Stop robots from trying to index gerrit." into production

9651143e2e-+-Stop robots from trying to index gerrit.

c3bfd95ef7-+-Merge "changing xfs inode size for swift to 512, the default suggested" into production

ca4ba27542-+-changing xfs inode size for swift to 512, the default suggested

67d2f52365-+-switching erosen account with admins::globaldev

4a59b1ea49-+-Merge "updating ms-be5 with the correct listing  of disks" into production

d4b885602c-+-updating ms-be5 with the correct listing  of disks

deb884ba84-+-Merge "adding shell on fenari for erosen RT 3119" into production

e091515b11-+-adding shell on fenari for erosen RT 3119

e0212eeee5-+-Merge "removing access to DBs for erosen" into production

8d8747f630-+-removing access to DBs for erosen

a7d5a16b2b-+-Merge "adding a second swift cluster to labs to test the swift upgrade process." into production

25c367c249-+-adding a second swift cluster to labs to test the swift upgrade process.

81134aec07-+-Disable GRO for esams LVS servers

5882f15fd3-+-puppetize pdftk, tool for manipulating pdf, was installed on pdf servers

68c59fcc11-+-oops, modified wrong filename . . .

38d22fcc39-+-Merge "add mediawiki-math package class (installed on pdf servers), add to pdf role, ..and single quotes for strings without variables." into production

a824aec384-+-setting up for host-specific /root/.dump_fundraisingdb config files

793c2df834-+-add mediawiki-math package class (installed on pdf servers), add to pdf role, ..and single quotes for strings without variables.

9e3a56e8bd-+-adding new host entries

b0b588bbc0-+-Make mysql role work for 12.04 and clean up syntax

ef4b5b50e7-+-Merge "openstack: fix typo in apt pin" into production

253f6c7e70-+-openstack: fix typo in apt pin

9a98cd4216-+-fixing kaulen (again)

434fa68abb-+-openstack: pin python-eventlet to PPA

a5fc92f7b4-+-adding bugzilla server class to kaulen

9a50078e67-+-fixing bugzilla site

bb5608195e-+-Didn't work, need to import classes, bigger change Revert "allowing certs.pp to import passwords.pp"

5db9235113-+-allowing certs.pp to import passwords.pp

4fb2e69332-+-fixing bugzilla site

b364b3a8dd-+-removing transcode1 from site.pp (since it's decommissioned)

33d38f3e43-+-puppetizing site for bugzilla.wikimedia.org and switching to new cert

0846bb3fbe-+-adding new machines removing lily (decommissioned) some alphabetizing

d438c4826d-+-openstack: set tagged interface up on boot

2327b20c7d-+-cleanup: removing very old search class definitions from site.pp

1e16f22b75-+-Merge "openstack: remove gluster from compute nodes" into production

5750f14cfb-+-openstack: remove gluster from compute nodes

f731d5758d-+-Merge "Putting erosen in admins::globaldev class that includes group wikidev." into production

bb96e840ff-+-Merge "Adding patch for nova-compute" into production

675cd00f13-+-Adding patch for nova-compute

b7e0bed4f1-+-Merge "Gerrit CSS tweak: word-wrap commit summaries." into production

b46414ccda-+-geoip.pp - sshhhhhing stdut of geoipupdate cron

424aefdc92-+-Fix sysctl.d inclusions

5f9ba1ba99-+-Fix typo

b09587cf8b-+-Adding in nova-network patch

a12485e0ed-+-Another temporary fix for network nodes

5db5b847c6-+-Moving ip address addition to the nodes, rather than the network service

1be29fe28e-+-unduplicate sync-apache-simulated and sync-apache

7fdc3eecc2-+-Merge "Disable Zak Greants account. No longer an employee" into production

00ccf9ade8-+-Wrong variable name.  Should be 'hosts_allow', not 'allow_hosts'.

58438c5835-+-Adding rsync jobs for stat1.

8c31a0d79c-+-generic::rsyncd now allows content for use of ERb template config files.

d329eba2da-+-Disable Zak Greants account. No longer an employee

90432acb88-+-moving data to different drives for swift hosts with ssds

a7fdd31206-+-Putting erosen in admins::globaldev class that includes group wikidev.

4841f27573-+-Merge "Allow the labs mysql role to be more configurable" into production

8d8be8f8c5-+-Allow the labs mysql role to be more configurable

b5279eb659-+-Merge "Ensure the apparmor profile is added before mysql is reconfigured." into production

a30e67bb50-+-Ensure the apparmor profile is added before mysql is reconfigured.

2e3d4d2e0c-+-changing the swift username and password for pmtpa-prod

8f78445506-+-adding access for john dickinson to the hardware swift test cluster removing the 'update most recently used UID' because nobody does it.

a5dca67c7f-+-Merge "moving options for swift global ganglia stats to a config file. round 2" into production

ad457dd86f-+-Merge "Adding Evan Rosen.  RT 3119" into production

8f442f9136-+-moving options for swift global ganglia stats to a config file. round 2

b6ecf74ef2-+-Merge "moving options for swift global ganglia stats to a config file." into production

3e6cc77547-+-moving options for swift global ganglia stats to a config file.

5697540db5-+-Merge "udp2log instance to listen for lucene logs" into production

764388e02d-+-udp2log instance to listen for lucene logs

4e579d2f62-+-Seems nova, glance, and keystone are nogroup

7bcbd85ccc-+-Only load keystone config in essex

d455cce4fe-+-Add the openstack version to the hosts

a168c8686e-+-Fix file ownership and permissions of some config files

6b4653283f-+-Using false instead of undef for default $multicast setting, so ruby can evalutate if multicast how I intend it to.

8612829b48-+-Merge "removing global read from swift config files" into production

d55b09ca29-+-removing global read from swift config files

ac45b38566-+-oxygen's packet-loss.log file is not in the default location

dd91c943e4-+-Adding Evan Rosen.  RT 3119

90fc2e11b3-+-More udp2log refactoring.

3dfd551d30-+-Merge "Adding quilt to package-builder" into production

13fa5079ae-+-Merge "Move udpmxircecho.py into the public repo" into production

0202dccf9c-+-Adding quilt to package-builder

b429032430-+-Move udpmxircecho.py into the public repo

bd3fe4686c-+-Merge "site.pp - need to require Class["misc::udp2log"], not Class["udp2log"]" into production

9de43632c1-+-base.pp - removing trailing / on $run_directory

8f3877a201-+-site.pp - need to require Class["misc::udp2log"], not Class["udp2log"]

26c485ad6c-+-Merge "mysql.pp - removing duplicate class definitions." into production

c8390645a5-+-Merge "udp2log.pp - found a boo boo.  Template is at 'udp2log/logrotate_udp2log.erb'." into production

17707c1522-+-Merge "Added updated key for abogott." into production

06b20d7891-+-udp2log.pp - found a boo boo.  Template is at 'udp2log/logrotate_udp2log.erb'.

3155f37652-+-Merge "Refactoring udp2log classes and defines." into production

65abbb2ef8-+-mysql.pp - removing duplicate class definitions.

6583a6dc54-+-/var/run has been moved to /run in Ubuntu Precise.  Updating generic::mysql::server accordingly.

f0698cc877-+-Add virt6-8 to site.pp

4a2f979d4b-+-Replace lily with lists as a backup relay

993140250f-+-Comment ganglia manifest to improve maintainability. Remove obsolate ganglia gmetad.conf file.

385a6630ca-+-appsudoers is not a puppet class

339aa64702-+-Merge "inserted back the ram check" into production

566e2e5019-+-Remove labs specific fact from production

6835289668-+-Not setting config options based on a version of something is a bad idea

e66ec82a1c-+-Remove duplicate

ae56285c19-+-Merge test into production

5da24334bb-+-inserted back the ram check

f3d016699a-+-Removed redundant "Apaches 8 CPU" data source

c77738baa2-+-Merge "fixing ipv6 monitors for lvs" into production

d7d8d721e9-+-fixing ipv6 monitors for lvs

7a6201e40c-+-Merge "Apply ganglia gmetad changes from test branch to production branch. gmetad will now use a template. manutius will monitor only "Upload caches eqiad"." into production

9d375bb383-+-Apply ganglia gmetad changes from test branch to production branch. gmetad will now use a template. manutius will monitor only "Upload caches eqiad".

658cef346b-+-Ensure jobs are run on labsconsole.

2ed2c06873-+-Merge "production doesn't write thumbs anymore." into test

2ac7a940df-+-production doesn't write thumbs anymore.

581a30ca56-+-Merge "trying to remove incorrectwikinews-lb.wikimedia.org monitors" into production

5a63d9139e-+-trying to remove incorrectwikinews-lb.wikimedia.org monitors

bb60d8dd7d-+-Merge "fixing monitoring for wikinews-lb.esams.wikimedia.org" into production

2fd05ea36b-+-Merge "Add apt2xml & apt fact to handle package updates" into production

194bc64896-+-fixing monitoring for wikinews-lb.esams.wikimedia.org

0679f09d5b-+-Add apt2xml & apt fact to handle package updates

72fcb19294-+-Merge "Apply many ganglia changes from test branch to production branch: apply all gmond changes and add (but do not yet reference) new files and templates used for gmetad and the webfrontend." into production

9d06dd5cc9-+-Merge "adding a per-project debian repo for labs" into test

c3b533e90a-+-adding a per-project debian repo for labs

48fc0e31d1-+-Apply many ganglia changes from test branch to production branch: apply all gmond changes and add (but do not yet reference) new files and templates used for gmetad and the webfrontend.

d1ad7edf44-+-Change soa_name for labs eqiad NS

4d82a853c6-+-removing hardy-specific stuff for apaches, adding precise

391d540b14-+-remove jpostlethwait from aluminium/grosley

c8846fd0e8-+-Trying again to fix the dependency cycle

550bb4cd5b-+-Removing dependency cycle

999b6397a3-+-generic-definitions.pp - fixing generic::pythonpip so that pip can be found in /usr/local/bin (where it seems to be in Precise).

289188c0c9-+-Fixing duplicate variable definition

5748f8c18d-+-Merge remote-tracking branch 'origin/production' into test

fcfbc75d13-+-added a few old dbs to decom list

56d3fae372-+-Refactoring udp2log classes and defines.

28a6e8af03-+-Add second master for labs

94a9114d54-+-Add second master for labs

d7b9692969-+-statistics.pp - Fixing duplicate require

3f9b785767-+-Giving access to Ryan Faulkner on stat1.

d21d06694d-+-Creating new user Jonathan Morgan, including him on stat1.

069c4baa07-+-Added updated key for abogott.

a0f7851b77-+-Merge "Revoke Andrew Bogott's key" into production

0511073986-+-Merge "statistics.pp - ensuring that gerrit-stats repo is at the latest head" into production

a8b1723a96-+-Merge "reenable fundraising banner log compression on hume, as secondary processor" into production

a3c18d5c49-+-Revoke Andrew Bogott's key

3d7fe7b880-+-reenable fundraising banner log compression on hume, as secondary processor

8a8f00d528-+-statistics.pp - including nfs::common

d1b7d95448-+-added log creation to fundraising impression log compression class

d4b553eaa0-+-Fix ip address for labs-ns1 on virt1000

c0cc8acea1-+-Setting query-local-address for labs eqiad

6fc3fbe5bf-+-Add a new variable dns_auth_query_address

afaf8f8b3c-+-Merge "Revert "Add a new variable dns_auth_query_address"" into production

264b108fb7-+-Revert "Add a new variable dns_auth_query_address"

2608918f81-+-Merge "Add a new variable dns_auth_query_address" into production

9bf234c53c-+-Add a new variable dns_auth_query_address

64188e2c80-+-Merge "Add service IP to labs dns servers" into production

5f8925bdcf-+-Add service IP to labs dns servers

f492e50f38-+-fixed definition naming conflict in fundraising.pp

f5d62ce7e6-+-statistics.pp - ensuring that gerrit-stats repo is at the latest head

1aff599ee2-+-Merge "misc::fundraising::impressionlog::compress" into production

939f56ed87-+-misc::fundraising::impressionlog::compress

ee5b8d0234-+-Added ffmpeg2theora to the imagescaler package list.

1a8b63c235-+-Merge "Enable multiple LDAP servers for gerrit" into production

0b5af694d8-+-Enable multiple LDAP servers for gerrit

dd0e028433-+-Merge "Add ldap rules for virt0/virt100" into production

51ff640429-+-Add ldap rules for virt0/virt100

4783c6630a-+-Merge "Remove unneeded class" into production

1c19164ca7-+-Remove unneeded class

9aafbe65f9-+-Merge "Add required ssl-cert package" into production

eb04cbd0f0-+-Merge "Adding firewall rules for new controller" into production

2e048ec5d9-+-Add required ssl-cert package

e9708297ba-+-Adding firewall rules for new controller

da8614136b-+-Merge "Turn parameterize auth::dns::ldap and make a role" into production

c75bc69752-+-Turn parameterize auth::dns::ldap and make a role

b17da8820a-+-cronspam sprint - srv222 - use -ignore_readdir_race with find to avoid errors for missing files

c51669807f-+-some cleanup of search code

885267c976-+-RT #3117 phase out wikimedia-fonts package

3a6d7bb3e2-+-Explicitly define fonts package for Precise

a6684f47de-+-'gs' package renamed 'ghostscript' in Precise

d9ac6d0b39-+-Merge "make spacing consistent" into production

ce257b3549-+-Merge "puppetize wikibugs (irc bot for bugzilla)" into production

acdfe7c0da-+-Merge "trying this one more time" into production

6d56400c6f-+-trying this one more time

61fe6f4b68-+-Merge "moving some es conf variants from base mysql to mysql::conf class" into production

48db4363b6-+-moving some es conf variants from base mysql to mysql::conf class

7fca42f044-+-Merge "set default innodb_file_per_table value at the top of the conf class" into production

bc3b68952c-+-set default innodb_file_per_table value at the top of the conf class

ac4c8a3adf-+-Merge "changing pmtpa mysql ganglia aggregators to db50 and db51" into production

823e941e1a-+-changing pmtpa mysql ganglia aggregators to db50 and db51

4673dfad30-+-setting innodb_file_per_table for es hosts

9722c0d3a6-+-'gs' package renamed 'ghostscript' in Precise

f2bec771c6-+-Merge "changing s6 master to db47 in mysql.pp" into production

3903fc53f2-+-changing s6 master to db47 in mysql.pp

2d04bd236b-+-enable imagescaler classes on Precise hosts.

b509fe4297-+-Merge "mysql.pp - can't include classes in an array like you can other resource types (?)" into production

0f6ca6addd-+-Merge "Decommission transcode1 for now, it needs a subnet move and reinstall" into production

852d4ffc4c-+-Decommission transcode1 for now, it needs a subnet move and reinstall

b5c3b56898-+-mysql.pp - can't include classes in an array like you can other resource types (?)

8ade4fc628-+-mysql.pp - parameterizing mysql version. statistcs.pp -  installing mysql 5.5 on stat1 Change-Id: Ic3ee9cac9f24f5687d28af9f80612d366bcd63db

08f9d1c60b-+-make spacing consistent

46a2d4a948-+-Setting up udp2log logrotate on oxygen

5c6ec12d53-+-Merge "RT #1424 (Set up log rotation for wmerrors log)" into production

518685b4e2-+-Merge "admins.pp: comment includes of disabled accounts" into production

e0712f6498-+-Fixing virt0's address in another spot

24fabd459a-+-Merge "Changing virt0's address" into production

f82d67d9b4-+-Changing virt0's address

bdfa55ec22-+-disable shell access for raindrift per RT-3088

bb4f22ce11-+-added loudon root public key to backupmover@{various hosts}

5391753cab-+-adding fundraising::backup::archive to storage3

ce69b31d54-+-grr, actually don't want silicon key authd by logmover account

577117a2ae-+-added key for root@silicon-->logmover@{various fr hosts}

a3ebcbf841-+-adjusting cron user for hume's impression_log_rotator

a73fed4e5b-+-Merge "Precise and above dislike AuthorizedKeysFile2" into test

cd2d8775eb-+-fixed cron minute syntax

7c4f815aab-+-Precise and above dislike AuthorizedKeysFile2

a1e99f1900-+-adding cron job to fetch fundraising udplogs for archiving

76ef6b0964-+-Merge "change cronjob back to system user - was work-around for BZ 36206 which should be resolved" into test

59309a34bc-+-change cronjob back to system user - was work-around for BZ 36206 which should be resolved

754651c9cb-+-key type typo

587a49955e-+-ben's thir^H^H^H^Hsecond prod ssh key

b09589f14a-+-es1 = master

616ac49108-+-statistics.pp - need to cd to $gerrit_stats_path to run cron job

6972ac91e6-+-statistics.pp - ensuring that $gerrit_stats_path is a directory owned by $gerrit_stats_user

0d4af6e899-+-Puppetizing gerrit-stats on stat1

8f932efc25-+-puppetize wikibugs (irc bot for bugzilla)

14e553b474-+-Merge "Add a second location for ssh keys" into test

419b3d25cb-+-Add a second location for ssh keys

db0a305b97-+-Merge "Use central ssh key location in Labs" into test

c6869c188e-+-Use central ssh key location in Labs

ebf2bae38f-+-Gerrit CSS tweak: word-wrap commit summaries.

f494607035-+-Setting up amanda backups for /a and /home on stat1

e72969de59-+-adding offhost backups back to storage3

9faa5c036c-+-fixed typo in ssh key, add job to storage3's offhost backups

6b8cabbd2c-+-adding root@storage3 to the hosts that can access logmover@various_hosts

0734e61f39-+-Log output for mediawiki install.sh on failure.

07d1c96e4c-+-Disable htcpseqcheck.

dc38e01442-+-Reload autofs on creation of /public and /data in labs

cff6fd8c25-+-Adding /public

438bf71553-+-Adding /public

98a7362d14-+-Use version 115488 of the ldap tools.

5e6b708db7-+-Use version 115488 of the ldap tools.

3f9d7a30c4-+-Partially revert "Don't create LocalSettings.php if install.php failed."

00550bdb3e-+-Don't create LocalSettings.php if install.php failed.

0be495eaf6-+-disabling cron scripts on storage3 for now

4e28b0866c-+-stupid permissions fix

44a4e45b41-+-change aluminium/grosley default mysql client charset from latin1 to binary

aeeab26ede-+-Explicitly restart Apache once sites-enabled is set up.

7db31382ce-+-Revert "Restart Apache after we create our site."

109d225094-+-admins.pp: comment includes of disabled accounts

eee4abf58b-+-Try to set up mysql in order so it works the first time.

2b67bf0480-+-Restart Apache after we create our site.

b253f49ff5-+-One more valiant attempt to get short URLs working.

706046a890-+-Finished testing ganglia gmetad.conf templates in labs.

100fdba00a-+-Continue testing ganglia gmetad.conf data_sources.

458513abfb-+-Test data_sources in ganglia gmetad.conf template.

314a3a02f1-+-Add authority_url to ganglia gmetad.conf template.

fa5dd3ca8b-+-fix perms

747147a48a-+-Fix path to ganglia gmetad.conf template.

bb003c8b95-+-Templatize ganglia gmetad.conf.

a94693423e-+-Merge "Fix duplicate key in LVS service IP hash" into production

fabb93a5b3-+-Fix duplicate key in LVS service IP hash

b32b2eaa93-+-Merge "Fix LVS service IP lookup" into production

4ba6600ed1-+-Fix LVS service IP lookup

8d9884a76b-+-Merge "Bind IPv6 LVS service IPs to lvs1" into production

d7967be159-+-Bind IPv6 LVS service IPs to lvs1

2b9693c060-+-Merge "Add 'ipv6' LVS service for ipv6 protoproxies" into production

b705234d18-+-Add 'ipv6' LVS service for ipv6 protoproxies

8a97f60075-+-Merge "Add Squid IPv6 IPs to a special 'ipv6' LVS service, similar to https" into production

bf623b02e3-+-Add Squid IPv6 IPs to a special 'ipv6' LVS service, similar to https

4faf1a4b3c-+-Merge "Add IPv6 LVS service IPs for upload.pmtpa" into production

18dd9bf806-+-Add IPv6 LVS service IPs for upload.pmtpa

8307fe5016-+-Fix bug that was causing gmetad servers to hang on boot (on lucid): Mount and populate /mnt/ganglia_tmp/rrds.pmtpa when gmetad starts.

08092816a0-+-Merge "Allow IPv6 LVS services on lvs1" into production

83a3a9212e-+-Allow IPv6 LVS services on lvs1

afa35c88dc-+-Merge "Add IPv6 addresses on reinstalled (Precise) LVS servers" into production

928e31ecfa-+-Add IPv6 addresses on reinstalled (Precise) LVS servers

35620c5122-+-Merge "Enable ipv6 on the ssl hosts for all datacenters" into production

6375bdc8e9-+-Enable ipv6 on the ssl hosts for all datacenters

e89f50dc34-+-Make interface_setting to work when having inet6 too

d68400ab67-+-LVS: remove dependency on Linux 2.6.36

800a7dbb14-+-Merge "Adding ipv6 support for all sites for protoproxy" into production

cb957f0ceb-+-Merge "Define the IPv6 LVS service IP for bits.pmtpa in the LVS hash" into production

e613e1275c-+-Define the IPv6 LVS service IP for bits.pmtpa in the LVS hash

519d154031-+-Merge "Add variable $ipv6_hosts to enable/disable IPv6 on certain PyBal hosts" into production

93314cec58-+-Add variable $ipv6_hosts to enable/disable IPv6 on certain PyBal hosts

4b7308b745-+-Adding ipv6 support for all sites for protoproxy

581ddb0f3d-+-Merge "Add IPv6 service IP to pmtpa bits servers for testing" into production

95e21e1dbd-+-Add IPv6 service IP to pmtpa bits servers for testing

1b6644b6c2-+-Merge "Revert "Don't upgrade wikimedia-lvs-realserver while I test it"" into production

e6147698e6-+-Revert "Don't upgrade wikimedia-lvs-realserver while I test it"

6382a03dc7-+-Facter prefers the lo ipv6 address for ::ipaddress6

fb964bf376-+-Don't upgrade wikimedia-lvs-realserver while I test it

c2bd1c521d-+-Decommission sq40

601430e978-+-Multiple interface stanzas for the same interface name and different families are allowed

7d15247629-+-Add IPv6 addresses to pmtpa SSL servers

75afebb308-+-Merge "The existing test is broken, just try to add every time" into production

3d247327a8-+-actually try myisam table recovery after a crash on the external store (this has been off since the es server migration..)

0684a6b932-+-Merge "rsyslog did not reload on config change" into production

e054db73b1-+-The existing test is broken, just try to add every time

5e5c7735eb-+-Facter ensure => latest

5381a43e78-+-Merge "Fix template" into production

ce224054db-+-Fix template

a7dbbf4799-+-Merge "Fix inline_template" into production

e844bb1b4e-+-Fix inline_template

bbd5c2e3cc-+-Merge "Add IPv6 addresses to sq67-70" into production

4a71852265-+-Merge changes I2133b77a,Ie5016ee8 into production

1570c65dbf-+-Add IPv6 addresses to sq67-70

e2fdae58ee-+-Create definition for binding a (v4 mapped) IPv6 address to an interface

9f2afa04ee-+-Revoking Ben's key

bed2bcf6df-+-Merge "add irc notifications for the #wikimedia-wikidata and #semantic-mediawiki channels" into production

d45f5531dc-+-And so on...

4d5e6a34a6-+-Rename new mw class.

6ec4ce52f6-+-Further apache/mediawiki flailings.

ca3fb8253c-+-Merge "ability to change thumbnail server name" into test

f67b327726-+-puppet voodoo to rename user mmullie-->mlitn per RT 3080

714a19bccb-+-Merge "selective-answer.py: support prefix matches" into production

1ce512a95e-+-Merge "Make IPv6 LVS service monitoring critical" into production

4f47903568-+-Make IPv6 LVS service monitoring critical

997e1e23f6-+-Merge "Fix check_command name" into production

f8f657cfbc-+-Fix check_command name

3127777591-+-selective-answer.py: support prefix matches

bcd77d8ccb-+-Merge "Combine IPv6 HTTP/HTTPs monitoring, monitor HTTPS as well" into production

14c85c2638-+-Combine IPv6 HTTP/HTTPs monitoring, monitor HTTPS as well

3ed26702f0-+-Merge "Rename mobile service IP" into production

734863afbf-+-Rename mobile service IP

e62f924aa3-+-Merge "Add remaining non-SSL LVS service monitoring" into production

f6c2269570-+-Add remaining non-SSL LVS service monitoring

4997e339a3-+-Merge "Add monitoring for the mobile v4 site as well" into production

988b644e1e-+-Merge "Add mobile site v6 monitoring in eqiad" into production

db9c2f03b5-+-Add monitoring for the mobile v4 site as well

782ae9b0db-+-Add mobile site v6 monitoring in eqiad

b4252ec752-+-Merge "Add mobile IPv6 LVS service IP to lvs1004" into production

06e54159bb-+-Add mobile IPv6 LVS service IP to lvs1004

ceda74325a-+-Merge "Fix ordering of includes so that ipv6 will work on ssl3001" into production

38823ecfbf-+-Fix ordering of includes so that ipv6 will work on ssl3001

887f780e48-+-Merge "Fix LVS checks" into production

20451654b7-+-Merge "Make nitrogen a role::ipv6relay" into production

c21f53bd01-+-Fix LVS checks

f92a4db3df-+-Make nitrogen a role::ipv6relay

8d114fcd3f-+-Monitor the same IPv6 LVS services for eqiad and esams

bdd85f1de7-+-Fix LVS checks

cf02b36371-+-Handle IPv6 LVS monitoring a bit differently, add bits/upload.pmtpa

9fafd814db-+-Add first IPv6 LVS service monitoring to Nagios for testing

0bc33dae6a-+-Add all remaining IPv6 LVS service IPs and services to the LVS balancers

6d14b9155b-+-Merge "role::ipv6relay: add system_role" into production

1ffba66e47-+-role::ipv6relay: add system_role

62d66c1422-+-Merge "Add IPv6 squid relay service IPs to both LVS classes" into production

bae62f5d7c-+-Add IPv6 squid relay service IPs to both LVS classes

c5c72e98dc-+-Merge "Add mediawiki.org IPv6 LVS service IP" into production

f4332061e4-+-Add mediawiki.org IPv6 LVS service IP

5b8b908427-+-misc::miredo init script does not have "status"

0f099ca222-+-misc::miredo: fix a minor typo

1d0d6b56bc-+-Fix misc::miredo, didn't work

9af7825c40-+-Merge "Adding miredo to the ipv6relay role" into production

1840b35d81-+-Adding miredo to the ipv6relay role

6d893888d7-+-Merge "Add 6to4relay role to capella" into production

87de54d9ee-+-Add 6to4relay role to capella

55a8cdc082-+-Merge "Add IPv6 addresses on all LVS balancers" into production

83e8dd5cd4-+-Add IPv6 addresses on all LVS balancers

5f56126ac5-+-Merge "adding lily (long gone) to decom.pp" into production

9a1f196d50-+-adding lily (long gone) to decom.pp

57850b3290-+-Merge "Allow recursive DNS queries from our IPv6 subnets" into production

3c310ef0be-+-Allow recursive DNS queries from our IPv6 subnets

932ef10776-+-Merge "Configure amslvs3 and amslvs4 for IPv6 duty" into production

ae7bb3a17f-+-Configure amslvs3 and amslvs4 for IPv6 duty

570d3ddf1b-+-Merge "Configure IPv6 LVS service IPs on amslvs3 and 4" into production

990bad369d-+-Configure IPv6 LVS service IPs on amslvs3 and 4

0397879ab2-+-Merge "Configuring lvs1004 for IPv6 duty" into production

4ca7e74715-+-Configuring lvs1004 for IPv6 duty

155a757fce-+-Merge "giving bellin the db-related classes" into production

c55f0afe47-+-giving bellin the db-related classes

05b666fd17-+-Configure lvs1005 for IPv6 duty

95605cd770-+-Add new LVS services IPs to lvs1005

f4c65e5bd4-+-Add IPv6 LVS service IPs to eqiad balancers

539cea762f-+-Add IPv6 server IPs to upload.eqiad servers

771e99bcc1-+-Fix reassignment of the $interface variable

cf5d46385a-+-Add IPv6 server IPs to eqiad and esams SSL proxies

494be0a6e9-+-Merge "redeploying db1042 as s1 slave" into production

a40bfe824f-+-redeploying db1042 as s1 slave

d163649584-+-Configure lvs2 for IPv6 duty

e6d842fb14-+-Add IPv6 main server IPs to the mobile realservers

593d0ffe59-+-Add IPv4 mapped main IPv6 server IPs to all bits realservers

59f9314545-+-Assigning IPv6 LVS service IPs to LVS balancers for upload and mobile

8f2c5a66c6-+-Add IPv6 LVS service IPs to bits realservers

7f8ff01fde-+-Don't install PDNS recursors on Precise LVS balancers

3033e2bf85-+-giving searchdix2 new indexer class

2274f479b6-+-followup change 9759 (snaprotate params for db26)

f955dfdca7-+-removing sumanah from manganese's sudo list after confirming with her that she does not need access.

24c06b3a1b-+-Merge "adding orion's ssh key for access to the swift hardware cluster" into production

28353bbba2-+-adding orion's ssh key for access to the swift hardware cluster

aa05058336-+-Merge "Revert "making all apt files be in place before apt-get update runs"" into production

0304979d97-+-Revert "making all apt files be in place before apt-get update runs"

662a49c451-+-Merge "making all apt files be in place before apt-get update runs" into production

63cc3891c7-+-removing cron/snaprotate from db10 b/c it lacks space to snapshot

cb156c3d8e-+-Merge "removing some old karmic-related code" into production

576aa6bd14-+-making all apt files be in place before apt-get update runs

9bedf4c60a-+-removing some old karmic-related code

f96e8e3c81-+-Merge "specifying full path to htcp.pph" into production

e1ab2d00ed-+-specifying full path to htcp.pph

44672f2bef-+-reduce lvm snapshot count to 1, (-c 1) for db10 b/c it lacks space for more

61d335e165-+-modifying snaprotate job for db26 b/c it lacks space for snapshots, so we're keeping fewer now

f3cbfb19b0-+-Merge "Remove br1-knams (decommissioned)" into production

54b05785d5-+-Remove br1-knams (decommissioned)

966eef7f46-+-Merge "cronspam sprint - srv222 - use -ignore_readdir_race with find to avoid errors for missing files" into production

6b09c36455-+-Cron Spam sprint: silence varnish restart cron job

a037a56d2a-+-adding db16 to decom

1bc7d0a911-+-cronspam sprint - srv222 - use -ignore_readdir_race with find to avoid errors for missing files

3728467098-+-Merge "generic-defintions.pp - fixing lighttpd reload" into production

0ff7d254dd-+-subscribing snmptt to all its config files

d259419e4c-+-adding in snmptt init file

32dd8878cf-+-Allow git-clone to clone to a different dir than the repo name.

cc3f8a15ec-+-Merge "inserting smerritt's key for access to the hw swift test cluster" into production

29f7ab759f-+-inserting smerritt's key for access to the hw swift test cluster

0807d0d64a-+-Set up apache url-rewrite for labsmw.

22cb665f9d-+-one more try to get SwiftStack user accounts on the hw test cluster.

9e16861719-+-damned duped identifiers.

b61aa777fb-+-inserting darrell's key

821fb6d1dc-+-Link /var/www/core to /var/www/wiki

5f6f7f59ce-+-(bug 36996) ability to change exim4 route list

02bc3ed805-+-force fixing external command file permissions

7543c1633a-+-db41 has changed to manutius

18c0fbc8f5-+-fixing snmptrapd.conf in icinga (i hope)

cce50e8d7d-+-fixing submit_check_result for passive checks

daed825145-+-removing analytics1001 from decom

3986878b70-+-adding analytics1001 into decom to prevent duplicates

1a9d8aaf5f-+-removing old classes from searchindexer

43b5d27a30-+-opening ssh to the public internet to the swift pmtpa and eqiad test clusters

eba9dd39b1-+-creating accounts for SwiftStack contractors, giving them access + sudo to pmtpa-test swift cluster.  Note these accounts are missing ssh keys so won't work yet.

ad840b531c-+-making the owa servers join the pmtpa-test swift cluster

2ffda91bb6-+-Merge "fixing typo in mobile.pp" into production

39f1de9224-+-fixing typo in mobile.pp

f2cda6040c-+-Added imagemagick to labsmw.

0468eab579-+-Merge changes Ica59fb0c,I41755699,I51978cf7 into test

63f686a8b8-+-rename monitor_service in apaches::monitoring::labs

f02f03ca4d-+-(bug 37046) fix apache monitoring on deployment-prep

49fdbd0de3-+-Rename the wikimedia core git definition.

733eb42ddb-+-Don't do a git-clone if the rep is already present.

e780309755-+-Qualify the path to true.

2069ab6744-+-Move socket and pid_file for labs.

057e4b5ff0-+-Merge "use sudo_user only for distributions newer than hardy" into production

46249755a9-+-Merge "Don't bother applying ganglia::collector role to hooft.esams or streber, as neither of these actually run gmetad. (Change 9265 is the corresponding change in the test branch.)" into production

b43abf008c-+-use sudo_user only for distributions newer than hardy

b43f2906f1-+-Don't bother applying ganglia::collector role to hooft.esams or streber, as neither of these actually run gmetad. (Change 9265 is the corresponding change in the test branch.)

af76390579-+-adding mobile::vumi to silver and zhen

abec757ac9-+-Merge "Add new mobile puppet manifest with simple vumi class * provides ussd application server" into production

5d93b7e6fd-+-Add new mobile puppet manifest with simple vumi class * provides ussd application server

b5e4f39c8f-+-Merge "Ensure only one of the gmond and ganglia-monitor init scripts is in production." into production

59dad77452-+-Merge "decom of all srv boxes lower than 190" into production

1c5830e181-+-decom of all srv boxes lower than 190

11842cf85a-+-Revert " giving those with sudo access acclogin access as well." I didn't see that ldap::client::wmf-cluster is already there.

4e198135a6-+- giving those with sudo access acclogin access as well.

3af41f555d-+-Revert "Rearrange dependencies a bit."

e644ae15a3-+-Rearrange dependencies a bit.

bde4e82a63-+-Try to tidy up the order of db dir creation so this works the first time.

e5caab0cbb-+-Merge "Don't bother applying ganglia::collector role to hooft.esams or streber, as neither of these actually run gmetad." into test

53361205ec-+-Don't bother applying ganglia::collector role to hooft.esams or streber, as neither of these actually run gmetad.

18810b6799-+-Qualify/the/path/to/test.

32aa849e13-+-Move mysql datadir to /mnt/mysql, and try to actually move the data there.

952e6d268f-+-Merge changes I6d89488f,Icba47ab6 into test

d722ad86a9-+-puppetmaster::self: add a few requires

8623f72110-+-Merge "puppetmaster::self: hack around a git/SSH issue" into test

f9f7b7a225-+-puppetmaster::self: hack around a git/SSH issue

85b07e5dc7-+-Add a puppetmaster::self class

9bd670708e-+-puppetmaster: abstract SSL setup into a subclass

09087a7f13-+-Add ssh parameter to git::clone

0a1538582a-+-revert unmounting /dev/vdb to mount it on /tmp

b211b24947-+-Yet another stab at correct puppet syntax.

535d27bb18-+-I'm pretty much just trying random stuff now.

701fd3ccab-+-As I said.

e52ae8c32c-+-I will be making quite a few more basic mistakes like this one before the night is out.

e0effe7ae8-+-I long for the day when I can test crap like this without having to publish it for the whole world to see.

b67ffb03f4-+-Reorder masters to be ordered by cluster. Note: db48 is otrs master.

a4b4d6a7c1-+-Mster switch for s4 from db51 to db31 after db51 failed.

cc0669e5b1-+-Revert "Update masters definition in mysql.pp from db.php"

5ca565dff0-+-Update masters definition in mysql.pp from db.php

d7ac9d93fa-+-Merge "bumping the threshold based on normal usage" into production

0685e758a6-+-bumping the threshold based on normal usage

59b31488fa-+-Merge "adding check for memory usage and retabbing the file" into production

ec96cfec46-+-adding check for memory usage and retabbing the file

50023ef7fe-+-Ensure only one of the gmond and ganglia-monitor init scripts is in production.

8bd5fd9fbc-+-Merge "fix maxsem's ssh public key" into production

53b50a3f15-+-fix maxsem's ssh public key

a8fc239ad1-+-Merge "yay typos" into production

7ff60a6004-+-yay typos

5e0d0912cd-+-Merge "adding ganglia metrics to pds recursors" into production

c8cb5906c7-+-adding ganglia metrics to pds recursors

554ab8d1b4-+-Install ganglia-webfrontend deb on labs ganglia::web server.

4487fff6b7-+-Added a role for a simple labs mysql db.

af41d34fa5-+-Ensure that the init script exists for only one of gmond and ganglia-monitor.

9ca6e07c5f-+-Creating generic::mysql::server class that installs packages and sets up my.cnf and starts mysqld.

610f4b1820-+-Ensure that /a exists on imagescalers

3c4bc17e9c-+-Turn on the translationnotifications class on Hume.

6c6ca22652-+-Merge "Cron entries for TranslationNotifications" into production

efbc7441ad-+-fixed dupe uid, added maxsem and mmullie

af6c2b8888-+-Merge "role/analytics.pp - allowing analytics sudoers to sudo -u to any user" into production

7cb0ce0753-+-Merge "java.pp - ah, there is no default to these.  Just a comment doc change" into production

a79d42ab87-+-geoip.pp - passing environment parameter to cron and exec for geoipupdate command.

f9516c96c8-+-Import geoip.pp

6fb6c6907c-+-Rewrote geoip.pp to be more modular and to use the licensed Maxmind GeoIP data files.

0ea5065006-+-adding cron job for offhost backups of db1025

116737ce3a-+-setting up db1025 to copy fundraising db dumps to tridge

ca064e08b7-+-role/analytics.pp - allowing analytics sudoers to sudo -u to any user

bd29819899-+-use valid mount parameter: type -> fstype

d1c0f7acf1-+-jobrunner::labs did not specify /tmp mount  FS type

e8bc9deb43-+-(bug 37048) labs jobrunner needs a large tmp directory

34c51fe89d-+-easily umount labs /dev/vdb on /mnt

1e3eaef90f-+-Merge "decom of db13 and storage2" into production

bbe9c43b56-+-decom of db13 and storage2

807b49f3b1-+-java.pp - ah, there is no default to these.  Just a comment doc change

90c8ac512c-+-java.pp - need to accept license before installing sun-java6 packages

d4cead5160-+-Merge "Allow sudoers on gerrit box(es) to stop|start|restart gerrit" into production

461eecab42-+-Adding new java class to generically manage JRE and JDK installation.

29fb331358-+-settting swift to write thumbs to no wikis; mediawiki will write thumbs for all wikis.

3c6a598f94-+-Added ffmpeg2theora to the imagescaler package list.

9db47a1af9-+-generic-defintions.pp - fixing lighttpd reload

c78255d1b1-+-class to install the 'tree' utility

094b82dc83-+-(bug 37014) udp2log needs write access to /h/w/log

8f412dcbb3-+-adding khorn to deploy group, remove deprecated users from erzurumi

1ca37227a8-+-fix puppet runs on brewster, typo, one : too much and you get "Cannot user opaque URLs.."

941f81a98b-+-adding kaldari and bsitu to the list of people that can deploy software RT-2957 RT-2958

438005faf8-+-third try to get nagios to do what we want for the logging check interval

c6742fb925-+-the data this check uses is only refreshed every 2 minutes; no need to check every 1.  also whitespace changes.

1b8d9a9e98-+-it takes longer than a minute to run the ganglia_parser.  slowing it down to once every 2.

6eb6e03901-+-revoking nimish's cluster access

eb91214cbb-+-Creating generic::mysql::server class that installs packages and sets up my.cnf and starts mysqld.

1aeaac6716-+-Merge "Reloading sysctl when rmem_max file changes." into production

4696a94cda-+-Merge "Reloading lighttpd whenever a lighttpd_config file changes." into production

8c4a6240b2-+-Merge "logging.pp - Upping number of retries for packetloss notices to 6." into production

5384b5bc81-+-Merge "add monitoring group analytics-eqiad and set in analytics role class" into production

f9c43aac4c-+-Merge "full sudo privs for diederik,dsc and otto on analytics hosts" into production

33eeb29ac2-+-add irc notifications for the #wikimedia-wikidata and #semantic-mediawiki channels

c99901d6cd-+-add monitoring group analytics-eqiad and set in analytics role class

78dfd8939f-+-Merge "add logrotate config for lighttpd on install-server (RT-2753), rebased" into production

6fdbba6acc-+-full sudo privs for diederik,dsc and otto on analytics hosts

b96a6a0da0-+-adjust path to update file now in /usr/lib/...

40fc73cbbd-+-Merge "adding dsc,diederik and otto accounts to analytics role class" into production

46fd5dab2d-+-account setup for fundraising backup archiving

7c353aa06d-+-well well well, there *is* no accounts::logmover, removing from storage3 node definition as well . . .

678f9ae5e5-+-adding logmover account to aluminium/grosley

f3f2000b43-+-Merge "adding analytics server nodes and role class skeleton" into production

8f6f9e2066-+-add up missing nfs::home::wikipedia

77f2c9313a-+-adding dsc,diederik and otto accounts to analytics role class

40c7e3607d-+-adding analytics server nodes and role class skeleton

8d241ad06e-+-Merge "disabling thumbnail writes for commons wiki (tests passed) to go with gerrit change r7890" into production

51b40fb440-+-disabling thumbnail writes for commons wiki (tests passed) to go with gerrit change r7890

b0ef34fa39-+-Merge "reverting disabling thumbnail writes for it wiki (tests passed) to go with gerrit change r7890" into production

2c0d64a29c-+-reverting disabling thumbnail writes for it wiki (tests passed) to go with gerrit change r7890

308e85ea81-+-Merge "adding if statement for precise to install oracle java instead of sun java" into production

ca9dfc7b3a-+-disabling thumbnail writes for it wiki (tests passed) to go with gerrit change r7890

c1ace08e71-+-disabling thumbnail writes for test wikis and mediawiki to go with gerrit change r7890

2350f5a4db-+-logging.pp - Upping number of retries for packetloss notices to 6.

9edf0d2d1c-+-ability to change thumbnail server name

03a10aab37-+-role/statistics.pp - don't need to include mysql::client.

f266ca8bf7-+-typoed stat class

f1f8e6620a-+-Merge "{role,misc}/statistics.pp - installing generic mysqld on stat1." into production

0c055857ec-+-Another silly syntax error

6ebaa2b73e-+-Ensure File['/home/wikipedia'] exists on labs too

ba2134e14c-+-misc::mediawiki-logger needs nfs::home::wikipedia

66212c7493-+-Merge "removing old search classes from searchidx2" into production

b0d4c4d968-+-removing old search classes from searchidx2

3dac4e08ab-+-Fix a silly syntax error (dependency on a class)

29967720b2-+-adding r-base to aluminium/grosley per RT #2972

6ab5967ffd-+-adding db61 and 62 as s1 slaves

95c55ccefe-+-Merge "adding in configuration option to only write thumbs to some containers" into production

7b523a6800-+-(bug 36872) logrotate require archive dir to be created!

8d3655790c-+-{role,misc}/statistics.pp - installing generic mysqld on stat1.

6ad90f77f2-+-adding in configuration option to only write thumbs to some containers

2dd7ae9a5a-+-adding in configuration option to only write thumbs to some containers

cc9e8e527a-+-Reloading sysctl when rmem_max file changes.

62bdd2045e-+-adding if statement for precise to install oracle java instead of sun java

29729a2d30-+-Merge "adding ganglia collector to carbon in site.pp" into production

0a92e0668b-+-adding ganglia collector to carbon in site.pp

306d3e0a28-+-Allow sudoers on gerrit box(es) to stop|start|restart gerrit

288b35a666-+-s4 master -> db51

9039b107d5-+-remove old s2 dbs

f2fd060cd0-+-fix time specification

6ea0c829a4-+-run tcpdump based query analysis on prod cluster dbs for 90 seconds per hour (30 sec at a time, every 20 minutes)

86e86d422f-+-replace "*.wikimedia.org" with "star.wikimedia.org" per RT-2512 | get rid of star_wikimedia_org

bc7f451356-+-change freq of pqd slow log injest from every 10 to 20m

f69c95ac23-+-admins.pp - enabling Fabian's account.

a28ca1a937-+-Removing some monitoring classes as they duplicate themselves

e244ca1661-+-changing variable names

e58ca3f851-+-really fixing the variable name this time

349cee6128-+-minor variable name fix

8567c89fbc-+-fixing variable subscription on line 631

954a3d8f04-+-minor spelling, etc fixes

bb426c7da2-+-fixing ncsa class import

33ec23c0d6-+-Cleaning up icinga configuration

2984a8a3f7-+-Merge "reducing search cronspam by a factor of 60" into production

084dec4e01-+-reducing search cronspam by a factor of 60

59c268449c-+-Merge "site.pp - Adding Fabian on stat1.wikimedia.org" into production

053b4dad9d-+-Merge "making nrpe check for udp2log procs retry 10 times" into production

7d323cc2db-+-making nrpe check for udp2log procs retry 10 times

c69e921b71-+-syslog-server requires /home/wikipedia/syslog

75df1cc3df-+-PDF servers: add/change to role class, add font class, install indic fonts on pdf1-3

ec1fa5744b-+-add logrotate config for lighttpd on install-server (RT-2753), rebased

5f4be3c459-+-Merge "giving db29 generic puppet definition" into production

529ad04765-+-giving db29 generic puppet definition

42bf845230-+-/mnt/{thumbs,upload} for labs

5ee7275b09-+-Refactoring some geoip classes.

93a6a7b50b-+-adding admins::dctech to all hosts

33214782a5-+-more testing of admins.pp b0rk

4db24a5bbc-+-testing theory that admins.pp is broken with scoping issues

8d7cd79bfb-+-still fighting with account creation

b67fd9274f-+-fighting with login gid assignment

3cd62a1c1e-+-fixed typo in admins.pp, added admins::dctech to ocg* hosts for testing

43be15a27f-+-created new group and class for dctech, moved cmjohnson from 'restricted' to 'dctech'

dd17014962-+-mount apache docroot for taskservers and imagescaler

38086afedd-+-labs has Apache docroot mounted from NFS

4154a1e09f-+-sigh, Could not find dependency Group[500] for User[cmjohnson] on mobile cache

4e20d64a69-+-adding user cmjohnson to base host build

6e8f418dd8-+-remove logmover from admins.pp, now installed by systemuser instead fixed missing comma in site.pp

3a2a65efa7-+-redo the way puppet manages logmover account which is used to move around fundraising proxy logs

f42d4f6e47-+-adding logmover account to hume so we can store fundraising impression logs there while storage3 is dead

5ba023562c-+-site.pp - Adding Fabian on stat1.wikimedia.org

255cf5fcbc-+-Setup APT preferences in Puppet instead of in package wikimedia-base

15e1aee07e-+-we want the file to be present (exist create a symlink)

cd3c1a0fe4-+-on labs: placeholders for squid configuration files

55a209d697-+-Merge "removing search1-13 stuff, adding search21-36" into production

4d1d0e0d26-+-removing search1-13 stuff, adding search21-36

0791ce3f43-+-skip deploying squid conf on labs

da13013c67-+-umount /mnt (/dev/vdb) on labs squid

5573a73ded-+-For labs, disable LVS when setting up a cache

d57db7595b-+-setting up fundraising banner impression log collection/compression on hume while storage3 is dead

1f89c3d8cc-+-enabling fundraisingdb dumps on db1025 since storage3 is dead

c7cd9a55cb-+-rsyslog did not reload on config change

e0ebe4ca8e-+-Merge "Define appropriate directories to install ganglia-webfrontend 3.3.5 in labs." into test

c506b1d078-+-/home/wikipedia is only created on production

77733e5cf0-+-Add imagescaler::labs role class

2a10515bec-+-Define appropriate directories to install ganglia-webfrontend 3.3.5 in labs.

c756e89ed4-+-Merge "removing temporary civicrm database from hume, removed unused fundraising entries from deprecated host" into production

ab54f7d7a7-+-Merge "introducing sharding to all wikis with more than 25k objects" into production

19b3b7fbe8-+-removing temporary civicrm database from hume, removed unused fundraising entries from deprecated host

6709384e2d-+-fixed typo mediwiki-->mediawiki

f95e392014-+-introducing sharding to all wikis with more than 25k objects

8606d2bb5a-+-run ptqd in 10m increments on prod dbs, add safeguards

82e3d19f7f-+-Merge "re-enabling slow query collection cron, just on pmtpa dbs" into production

55ad49a064-+-adding sudoers rules for datacenter techs

7ff1feb9f8-+-giving ayush shell on stat1 per rt 2888

d4b6502fe9-+-re-enabling slow query collection cron, just on pmtpa dbs

a9d80defc5-+-readding blondel to mysql.pp and site.pp to start as db9 slave

bd9f1595af-+-Reloading lighttpd whenever a lighttpd_config file changes.

8499caf652-+-Revert "notify (+ do a reload) on lighttpd when its config changes"

368305e950-+-notify (+ do a reload) on lighttpd when its config changes

7c279ba0d6-+-Merge "add missing cron jobs for lx,re,ro,pa..." into test

5ef5a45100-+-removing send_query_digest cron before i take it out back..

8cf40818d8-+-- cron to update query review tables on all core dbs every 10 minutes - exit quietly if slow log doesn't exist or is zero bytes

f649eea1f7-+-install slow_digest script

2584bcb6f6-+-add missing cron jobs for lx,re,ro,pa...

a67583d6e2-+-initial work to start collecting slow query digests and histories from all core dbs

8f682f716d-+-Follow up to I024289f6

127ec2e361-+-changing s2 master from db13 to db52

8b937fe963-+-adding db24 to decom list

bbe0d32aac-+-Wrap version in quotes

2f155370d0-+-Merge "Change gerrit manifests to use and require the gerrit package, rather than installing it from puppet." into production

9a01166e19-+-Revert "Bind new LVS service IPs to the correct LVS hosts"

aa470924bd-+-Bind new LVS service IPs to the correct LVS hosts

347ac6425a-+-Add LVS services OSM and Misc Varnish

9e7eeeded5-+-Reorder LVS services

54d8fb7c2c-+-Add DNS LVS services

8f4cc60eac-+-Add the new LVS service IPs to the load balancers

a17e1b75ac-+-Add LVS service IPs for authoritative and recursive DNS, OSM and the misc varnish cluster

eb6f3e6cb7-+-Merge "256 MB of (frontend) malloc storage is rather puny, especially when you're trying to squeeze 700 MB objects through it." into production

7e9149be6e-+-256 MB of (frontend) malloc storage is rather puny, especially when you're trying to squeeze 700 MB objects through it.

70cc900b0d-+-nfs::home::wikipedia describe /home/wikipedia

aa17ddb8fb-+-moving ms1-3 to be part of the test cluster instead of prod.

3bbd601ed1-+-Moving gitweb config to its own class, adding blame support (bug 36234)

a8e561f4fc-+-revoking accounts on fundraising boxes for users who no longer do fundraising work

d40393e9ed-+-avoid syslog loop in labs

99d7c6b199-+-Merge "decommisioning search1-12" into production

b40e8ab42e-+-decommisioning search1-12

d48dbcd763-+-Merge "call swift proxy http monitoring from role class, remove hostname condition" into production

21a83bfe47-+-rsyslog: ability to send logs to a custom server

901f0533b9-+-Restart varnishncsa processes on init scripts and default file changes

5ca1786bbf-+-Qualify global variables in base.pp

0813c05ebc-+-Use the default Ubuntu squid packages on the install server

c481b1df35-+-Install vim and sysstat on all servers

720c308e91-+-Do things the Puppet way

33b94c1ea8-+-Manage root's .bashrc in Puppet

dd5c4a23cd-+-Fix logic for grub quiet option removal

3cd26785cd-+-Don't try to use Upstart jobs on Hardy

eaab428e6c-+-Setup vim as the default editor

a8fb285fde-+-Merge "Typo" into production

f2b8d01b81-+-Typo

1fcaa6136f-+-Merge "Remove 'quiet' kernel option in Puppet instead of in package wikimedia-base" into production

c3f00a1630-+-Remove 'quiet' kernel option in Puppet instead of in package wikimedia-base

51698fbe4e-+-Merge "change working refreshLinks crons to monthly schedule originally requested. leave s1 deactivated." into production

0fc1410c6c-+-Merge "Setup APT preferences in Puppet instead of in package wikimedia-base" into production

3ef1c14fbc-+-Setup APT preferences in Puppet instead of in package wikimedia-base

c0eec48374-+-class to install the Joe editor

8adeec2726-+-change working refreshLinks crons to monthly schedule originally requested. leave s1 deactivated.

4b88097c3e-+-backporting arparse due to python 2.6! yay!

07b856af8a-+-Change gerrit manifests to use and require the gerrit package, rather than installing it from puppet.

7dd9611817-+-fixed ip_address field

50cce258d5-+-Merge "making db53 a snapshot host" into production

194dbe4376-+-making db53 a snapshot host

19d4ea890d-+-Adding condition for the wildcard ssl cert - this cannot be installed in labs and thus breaks the class

824769937b-+-Use the new pam configuration, when pam is enabled

81dd8e6576-+-Merge "Create Swift filesystems with inode size 1024, as suggested in the docs" into production

71c28b4333-+-Merge "Cache bits 4xx for 1m" into production

06aa95fa97-+-Cache bits 4xx for 1m

d53adbd83b-+-Merge "Resubmit "correecting ian baker's pubkey."" into production

b8a8a163f4-+-Resubmit "correecting ian baker's pubkey."

5f6ab09d64-+-Add precise to the default list of pbuilder distributions

da79213a17-+-Add precise to the default list of pbuilder distributions

359a18011b-+-Revert "correecting ian baker's pubkey." No idea how I'm supposed to verify whether this is genuine.

215b946050-+-correecting ian baker's pubkey.

7d171585bb-+-Dell R300 uses serial speed 57600

e698662733-+-Add the Dell R300 platform to base::platform

754fb70de9-+-Don't install dashboard on sockpuppet, it scales very badly

63966e8d67-+-Merge "Remove requirement for removed file resource" into production

958d286a86-+-Remove requirement for removed file resource

ccbd81442d-+-Merge "git::clone define improvements." into production

28bf8ba52a-+-git::clone define improvements.

56d46c19d4-+-Merge "Change around nova config some and fix keystone database usernames" into test

bf1a321a78-+-Change around nova config some and fix keystone database usernames

c247ed3e13-+-fix package dependency order issue, remove hardy bits

28e2ee33f9-+-Merge "Use the right variables and remove needless subscribes" into test

66a62d5176-+-Use the right variables and remove needless subscribes

7d57879c94-+-Merge "The variable definitions were flipped and slightly redundant" into test

6136ae766d-+-The variable definitions were flipped and slightly redundant

c5c8b829d2-+-Merge "More followup to Ida74297b" into test

f6cfbcc822-+-More followup to Ida74297b

33e7bb5ed6-+-fixing up files according to package requirements

30aeb05af9-+-Merge "Yet more followup on Ida74297b" into test

e2269879f4-+-Yet more followup on Ida74297b

8eddfdb0b0-+-Merge "More followup on Ida74297b" into test

64281e72e1-+-More followup on Ida74297b

0be63e6c45-+-new firewall site plus fixing firewall builder cron job

917c32e223-+-Merge "Follow up to Ida74297b" into test

6ed113f73a-+-Follow up to Ida74297b

a60bb6d1b2-+-adding in ssl

b46250e2c3-+-Merge "Further update openstack manifests for essex" into test

367d4c9bc4-+-Further update openstack manifests for essex

f069c0d4f0-+-fixing hostname

547154c778-+-pushing new firewall builder to streber

b161aec93a-+-Revert "git::clone define improvements."

36f85391b9-+-git::clone define improvements.

c555eeeb97-+-Merge "Only change kernel parameters on Ubuntu >= 12.04" into production

5b7c422521-+-Only change kernel parameters on Ubuntu >= 12.04

425afbf195-+-Merge "Apply base::grub on all hosts" into production

36d35d0ebc-+-Apply base::grub on all hosts

9a3b145dc4-+-Merge "Support grub1 as well" into production

2dba82d193-+-Support grub1 as well

56e7603640-+-Merge "Ensure that the deadline I/O scheduler is used on upgrades as well" into production

dcba067dbd-+-Ensure that the deadline I/O scheduler is used on upgrades as well

29fe6cef9c-+-Merge "admins.pp - removing aotto user.  This has been replaced by 'otto' and is no longer needed." into production

b602a2218e-+-Merge "Increase puppetmaster db connection limit" into production

2792cfef73-+-Increase puppetmaster db connection limit

1cc063ccf6-+-Merge "moving db52 and db53 from s1 to s2" into production

2fdb409359-+-moving db52 and db53 from s1 to s2

c61edefa99-+-Merge "Up the mysql connection limit for puppetmaster from the default 5 to 50" into production

eecf2aa574-+-Up the mysql connection limit for puppetmaster from the default 5 to 50

fbb2085f45-+-Merge "disk space monitoring for lucene nodes" into production

f8c3c06c1b-+-disk space monitoring for lucene nodes

a09850e0b2-+-Merge "Revert "add misc::statistics::geoip to statistics role class. RT-2164"" into production

baf166fde8-+-Revert "add misc::statistics::geoip to statistics role class. RT-2164"

aa9a5415ce-+-silence cronjobs - that other way to redirect output is a Bash 4 thing

64add2a3ea-+-nslcd will fail to start with improper permissions

a41adb17d2-+-nslcd will fail to start with improper permissions

785dd08bfb-+-Merge "forgot to add per-instance naming for nrpe checks in last commit" into production

1dcb791d37-+-forgot to add per-instance naming for nrpe checks in last commit

d09dbf518c-+-Merge "adding per instance logging for udp2log" into production

e6f2932e8b-+-adding per instance logging for udp2log

88e3ce4b78-+-misc/statistcs.pp - changing paths to correct htpasswd protected directories

6160eb53ab-+-RT #1424 (Set up log rotation for wmerrors log)

487fc472f2-+-adding in firewall config builder information

e9b434bfdd-+-Iteration of adding ganglia webfrontend for labs.

fc0f389aa1-+-Merge "Renaming mediawiki_clone to mediawiki::clone." into production

ab95cf04d9-+-Merge "removing bellin and blondel from mysql.pp and site.pp" into production

dcccaa40ce-+-removing bellin and blondel from mysql.pp and site.pp

c9690b4573-+-Merge changes Id165dc4c,I12d25789 into production

031ae3206f-+-Merge "puppetizing ezachte's sudo on bayes for better visibility" into production

7b22c723f8-+-puppetizing ezachte's sudo on bayes for better visibility

e1ad3b3c61-+-misc/statistics.pp - fixing stats.wikimedia.org site.

f2b57350e0-+-misc/statistics.pp - fixing cron timing on mediawiki git pull.

c7233e3f31-+-statistics.pp - adding subversion to base stat packages

e35146c859-+-Merge "giving otto sudo on bayes" into production

4b241d31c8-+-giving otto sudo on bayes

b41dc98091-+-Merge "add timedmediahandler manifest" into test

70df5354a1-+-Merge "Take payments out of esams LVS" into production

03d4e49ac1-+-Take payments out of esams LVS

9227107400-+-Merge "Add a 'sites' LVS service parameter, which determines for which sites it's active" into production

687ef98a3f-+-Add a 'sites' LVS service parameter, which determines for which sites it's active

e0c5e312af-+-Merge "Setting up virtual host for stats.wikimedia.org on stat1.  RT 2162." into production

7107c0a0f1-+-giving dario shell on stat1

fa43efbc6e-+-Renaming mediawiki_clone to mediawiki::clone.

75ceb66404-+-Setting up virtual host for stats.wikimedia.org on stat1.  RT 2162.

3caece2707-+-Merge "adding a cron to compliment log4j log rotation on search hosts. log4j rotation is good because it is easier on the system, but it does not yet have the ability to delete old logs :/ someday..." into production

4b4fa2ba4e-+-adding a cron to compliment log4j log rotation on search hosts. log4j rotation is good because it is easier on the system, but it does not yet have the ability to delete old logs :/ someday...

908042c538-+-Cron entries for TranslationNotifications

4c0f690ed1-+-Manage tftpboot from Puppet, import PXE config files from Precise

986b30d47a-+-Set file size at 100G for all upload caches now

b0562e47c3-+-misc/statistics.pp - agh, wrong name on the require => Mediawiki_clone, fixed.

eb28dc0e51-+-Merge changes I619a73a4,I73941485 into production

376536b660-+-adding halfak to admins::mortals RT 2707

b8eef63284-+-Cloning mediawiki into /a/mediawiki on stat1.  This uses the new mediawiki_clone and depends on the parent commit.

cc742873cc-+-mediawiki.pp - added define for mediawiki_clone.

5353f756c7-+-statistics.pp - Ah, need libxt-dev in order for R to build and install Cairo R library.

a2a9f34e3a-+-Merge "site.pp - adding otto user on bayes." into production

2d9367c9ee-+-Merge "Amending.  Don't need xorg or wdm.  Do need libcairo (Diederik checked this on bayes)." into production

5939ff8c71-+-Merge "testswarm: log slow queries (bug 35028)" into production

cb56e42ca1-+-Merge "testwarm: set innodb buffer pool size to 256M" into production

089fcf2d2a-+-adding db58 to s7, pulling db16

d66eec4848-+-Amending.  Don't need xorg or wdm.  Do need libcairo (Diederik checked this on bayes).

a8f3d5e755-+-adding some stuffs for db59,60

f4f7d6720e-+-adding db6[0-9] to site.pp

f6ab13b213-+-site.pp - adding otto user on bayes.

a28b1bf473-+-Merge "adding db57 to s2" into production

75b0b4b2ea-+-adding db57 to s2

02ba04ee38-+-Merge "Add support for sending to an https backend by default" into production

5fa4e5c745-+-Merge "Shell access for Ian Baker" into production

2cbf3b258b-+-Merge "giving otto root on locke, emery, oxygen, and stat1 per rt 2856. ct gave approval." into production

519dd61dca-+-Add support for sending to an https backend by default

ff0fcfbe17-+-admins.pp - removing aotto user.  This has been replaced by 'otto' and is no longer needed.

ef93e13fd9-+-allowing halfak access to emery, RT2707

65ba4e17d8-+-giving otto root on locke, emery, oxygen, and stat1 per rt 2856. ct gave approval.

2d66f1d83d-+-arg. cp paste error

70d868775c-+-de-borking puppet on nfs1/2

f88b6b3157-+-adding in some monitoring for varnishncsa procs

0b7d16ea0d-+-testswarm: log slow queries (bug 35028)

49b1770c76-+-testwarm: set innodb buffer pool size to 256M

14a42b6d18-+-add misc::statistics::geoip to statistics role class. RT-2164

0d90860549-+-Merge "The Varnish persistent storage backend doesn't handle eviction when out of space" into production

30b62b6b32-+-The Varnish persistent storage backend doesn't handle eviction when out of space

e2e3075002-+-Merge "remove ezachte as file owner, files should not be owned by real people users. he is in wikidev" into production

a49bfaf816-+-Merge "add FIXME to mounts on stat1 and there is no group "ezachte" to own /a (and shouldn't)" into production

ca79603d82-+-Merge "remove aotto from stat1 now that there is otto" into production

39a24a14dd-+-Merge "admins.pp Disabling aotto account.  'otto' has replaced it, and I want to delete the aotto puppet configs.  I will do this in another commit after puppet has removed aotto from stat1.wikimedia.org (the only place where aotto currently exists)." into production

db838f3d4a-+-remove ezachte as file owner, files should not be owned by real people users. he is in wikidev

4f079d3a43-+-add FIXME to mounts on stat1 and there is no group "ezachte" to own /a (and shouldn't)

f32272d7b0-+-remove aotto from stat1 now that there is otto

4400f48df3-+-Merge "manifests/admins.pp - adding myself to the admins::restricted group so that I can have access to udp2log machines locke, emery, and oxygen." into production

2ef3a00f5b-+-Removing nimish and awjrichards from sudo on locke and emery.

357611979e-+-Merge "Adding per-project sudo" into test

37e179e2a4-+-Merge "Adding per-project sudo" into production

044e2156a1-+-Remove project groups from sudo, add ops group

51dc1230cb-+-Remove project groups from sudo, add ops group

db632cf174-+-fixed conflicts add role class for statistics server, move includes from site.pp to role class and add plotting class

fa29b018c4-+-Merge "now that i added the memcached group also need to use @monitor_group to unbreak icinga" into production

1893369deb-+-reenabling new varnishncsa for eqiad upload varnish instances now that mobile is looking good.

d59aceb6db-+-re-enabling new varnishncsa setup on mobile varnish boxxies to see if it will push out the right init file this time...

4ce2f61183-+-now that i added the memcached group also need to use @monitor_group to unbreak icinga

c055262735-+-let human user do the cron jobs until cron for system users is fixed

77ac26c81a-+-add timedmediahandler manifest

88592db623-+-refreshLinks, just run the s1 cron job alone which failed yesterday, others have just been refreshed succsecfully

8b4937256d-+-remove searchidx1 from site.pp, long dead and in decom.pp already. having it in both breaks puppet on spence

82579dd3db-+-Merge "use the project- labs groups to allow puppet-created user to execute cron jobs" into test

572977453a-+-use the project- labs groups to allow puppet-created user to execute cron jobs

598fad3bd3-+-Merge "wikistats - define a logdir" into test

07c9c0ef46-+-wikistats - define a logdir

af9f64a757-+-something ain't right. leaving ina stable state until monday

bc1ff880d7-+-perms

d81ee729a8-+-this should do

848cbd5db0-+-need to comment out. they keep spawning...

3e58a47081-+-everything gets its own name

084f515809-+-moving out a file so it's only deployed once.

cea21c548c-+-Merge "cleanin'" into production

2865d80385-+-cleanin'

7b0bb7c3fd-+-Merge "part 1 of getting multicast relay going" into production

102a61e432-+-part 1 of getting multicast relay going

0bcc0507fd-+-Create Swift filesystems with inode size 1024, as suggested in the docs

f693a5723f-+-Merge "add $nagios_group memcached to memcached monitoring" into production

0d2ff89e25-+-Merge "Add the pmtpa Squids as a thumbnail backend to help Swift out of its misery" into production

8f058977cb-+-Add the pmtpa Squids as a thumbnail backend to help Swift out of its misery

236e479635-+-Move Swift iptables inclusion to the role classes

4d5316bd14-+-Halve the number of proxy workers to reduce memory usage

7cfa631b0b-+-add $nagios_group memcached to memcached monitoring

64702ccc51-+-refreshlinks - move log dir creation out of the definition

dfdad3c8e2-+-write logs for refreshLinks cron jobs to mwdeploy home, ugh, capitalization

6906dad9a0-+-Merge "Move Swift iptables inclusion to the role classes" into production

c26e8faa7e-+-Merge "Halve the number of proxy workers to reduce memory usage" into production

c5eae5a378-+-install our current prod mysql pkgs on es hosts

abc78591e3-+-Minor iteration for adding ganglia to labs.

38ae948062-+-notifications for all udp2log related alerts going to analytics peeps, plus adding otto and robla

a60a8ae544-+-admins.pp Disabling aotto account.  'otto' has replaced it, and I want to delete the aotto puppet configs.  I will do this in another commit after puppet has removed aotto from stat1.wikimedia.org (the only place where aotto currently exists).

168c142dfb-+-manifests/admins.pp - adding myself to the admins::restricted group so that I can have access to udp2log machines locke, emery, and oxygen.

5e17e32a38-+-Still another iteration of adding ganglia for labs.

8ebd62d687-+-Merge "need that gone" into production

a8db0fc9d2-+-need that gone

b91a41afe2-+-added install of few more stock packages to mwlib.pp

c6530ff48d-+-Merge "another little fix for udp2log" into production

af6dcdfd45-+-another little fix for udp2log

17c0a48a83-+-Actually double the backend weights this time

cd57050ec3-+-Double the backend weights to improve chash distribution

69f6e3f8e2-+-add refreshlinks cronjobs to hume and verify

140864d7da-+-Merge "class for mw cronjobs to run refreshLinks.php per cluster - flexible hours" into production

f9f51d47ee-+-class for mw cronjobs to run refreshLinks.php per cluster - flexible hours

babc7cbd56-+-cronjobs - fix project name in command

36de0461e8-+-test multiple cronjob creation in labs where i need it anyways

cecf64d83f-+-decommission srv189 - server removed from rack by cmj - RT-2413

4752ba836f-+-Merge "Revert "Temporarily place bits.pmtpa behind bits.eqiad to test if sess leakage occurs"" into production

ae6973f43f-+-Revert "Temporarily place bits.pmtpa behind bits.eqiad to test if sess leakage occurs"

b1278998ae-+-Shell access for Ian Baker

cd8776f4c6-+-no longer need mobile wap group, it's all in varnish

505c2184e1-+-Merge "Updating neon to irc spam and be more complete" into production

d23e3f7277-+-Updating neon to irc spam and be more complete

9e3991ee57-+-Merge "stop the spammening" into production

49d5677b2c-+-stop the spammening

6f2ff974d0-+-escaping "$2"

20f34143da-+-Merge "Cron executes with /bin/sh" into production

1fe0996a20-+-Cron executes with /bin/sh

36d2b0c08e-+-Merge "Escaping" into production

538fd2398c-+-Escaping

b8ed87be79-+-Merge "Automatically restart varnish" into production

0f1b69901c-+-Automatically restart varnish

40e8c18a23-+-Merge "decom sq39 sq40 & sq46 per ticket http://rt.wikimedia.org/Ticket/Display.html?id=2581" into production

739cdd2492-+-decom sq39 sq40 & sq46 per ticket http://rt.wikimedia.org/Ticket/Display.html?id=2581

0d87950c78-+-Merge "incompatible (and useless) on nfs1/2" into production

845e89a032-+-incompatible (and useless) on nfs1/2

a01f8b2ae0-+-forgot nfs1/2 :/

502f8d8771-+-decommission sq34

d9f0ee502c-+-Setting the bind address properly

a3bf08df74-+-Merge "fixing puppetmaster templating" into production

039c975c0f-+-fixing puppetmaster templating

6ceefdcc70-+-Temporarily place bits.pmtpa behind bits.eqiad to test if sess leakage occurs

7368a17624-+-logging.pp - update class name in system_role, remove nonexistent misc::mediawiki-logger from nodes nfs[12]

e0706d2dab-+-Merge "Temporarily place bits.pmtpa behind bits.eqiad to test if sess leakage occurs" into production

29956db236-+-Merge "add misc::statistics::plotting to install 'ploticus' per RT-2163" into production

c62d06a323-+-Up svn tools

89bc822dbd-+-Up svn tools

d18cef1e1a-+-Adding per-project sudo

5f0e92fe4e-+-Adding per-project sudo

09174e1b63-+-commenting out until monday

6c22f3f9d8-+-commenting out decom_servers script until monday

3d04bdfd03-+-fixing template

1db825bdd7-+-Switching nonworking exec command to cron, generated shell script

da6a09860a-+-Up ldap script version again

89306b9871-+-Up ldap script version again

4b50140688-+-Up version of ldap scripts

d02a8a8554-+-Up version of ldap scripts

0f4ff096bc-+-add diederik to oxygen, remove arthur's sudo, per rt 2430

8d074f9c84-+-trying provider => shell

a99c4e4408-+-Fix global project check

d64a33739b-+-Incorrect project was added

c02ef92d33-+-Adding default parameter for privileges

bf1793b4d3-+-Adding missing parameter

229b350860-+-Merge "Change to move projects into another OU rename groups" into production

ed10f2c056-+-Merge "Don't up or downgrade varnish right now" into production

47c9b53e50-+-Don't up or downgrade varnish right now

d90a026ea1-+-"true" does not parse

a3ee38be1e-+-Fixing git directories and geoip

d2b3a692b5-+-Merge "got a little over zealous there" into production

6b41a0e0db-+-got a little over zealous there

8b16de6b8d-+-Merge "one final test before letting it loose" into production

9896eb2186-+-one final test before letting it loose

326b2e02ee-+-Merge "once more to the breach" into production

62eae3b778-+-once more to the breach

2256016cc1-+-Merge "I am so upset with myself right now..." into production

dfb523e359-+-I am so upset with myself right now...

71b252670c-+-Merge "regression testing" into production

59865ac97a-+-regression testing

1576350267-+-Merge "will title work?" into production

0b344a9613-+-will title work?

ce20dd85b2-+-Merge "wrong place?" into production

907fdb0020-+-wrong place?

cc6603ce7a-+-Merge "Make backend upload varnish servers talk directly to Swift again" into production

48d8373767-+-Make backend upload varnish servers talk directly to Swift again

e42331f896-+-Merge "back to built in type;" into production

b802024810-+-back to built in type;

62450a3b22-+-Merge "gotta type it" into production

da5deab240-+-gotta type it

bb7fcccc0e-+-Merge "what kind kind of error is that?" into production

596f22ede1-+-what kind kind of error is that?

95fa4e3d23-+-Merge ""one last cleanup" he sez..." into production

d2bd79a5d9-+-"one last cleanup" he sez...

cd5cab88a7-+-Merge "will it blend?" into production

ca874e03bc-+-will it blend?

399b6ee6fb-+-Merge "Upgrade all varnish instances to 3.0.2-2wm4" into production

d3f4870312-+-Upgrade all varnish instances to 3.0.2-2wm4

2c27b01e51-+-Merge "Upgrade varnish on the noneven eqiad upload hosts" into production

f9fd197696-+-Upgrade varnish on the noneven eqiad upload hosts

a46a7004da-+-Merge "udp2log cleanup, new instance" into production

a0840ced4a-+-udp2log cleanup, new instance

36293dd30a-+-fix variable concatenation

8102021db5-+-document fenari symbolic links

d1a19b4d5a-+-Enable persistent storage on all even numbered hosts, and upgrade Varnish

27ec2ef858-+-Automatically restart varnish on package upgrades The package scripts do this for the main instance anyway

400d72a282-+-Change to move projects into another OU rename groups

38b571603c-+-Change to move projects into another OU rename groups

4bbec7e82c-+-fixing icinga files

cc170a244e-+-Revert "Fix double scoping of files"

02bf13e266-+-Fix double scoping of files

c7fb34b12c-+-fixing fundraising db nrpe checks

b8b01ad4c4-+-moving permission fixing

226491c9ea-+-Adding in naggen to /usr/local/bin on puppetmasters

75c5f14fcf-+-Merge "installing htop on all servers" into production

a5cc56fc9d-+-installing htop on all servers

1394d56a12-+-Fix generate() calls for naggen

bfe5af85fa-+-Switching new icinga(nagios) box to use naggen to generate conf files

4557208019-+-Yet another iteration of adding ganglia for labs.

3c77907ad3-+-pushing udp-filter on stat1 to analyze old data

84ff620a24-+-making swift not monitor test clusters

a31abd7f8e-+-Merge "Fixing mysql fundraising checks to use nrpe" into production

f51b9abe3f-+-testswarm: restore /etc/testswarm

4909e41dca-+-Merge "testswarm: publish MediaWiki clone to a new dir" into production

d969574210-+-Fixing mysql fundraising checks to use nrpe

a1bdbc1864-+-craete a class for swift clients

a9c5e754a0-+-testswarm: publish MediaWiki clone to a new dir

a3ec83276b-+-Adding Faidon as root

0ad4d5c902-+-Merge "get ride of old Testswarm fetching script" into production

6642652b25-+-Slightly nicer naming

a60194c8e3-+-Make restart gmond names unique

83e0a765da-+-Automatically restart gmond if varnish was started later

6d81f877de-+-Switch to the persistent storage backend on cp1036 for testing

dffef85e4b-+-Merge "moving check from icinga.pp to nagios.pp" into production

a3949bd19e-+-moving check from icinga.pp to nagios.pp

0b42ac7f23-+-Merge "adding in check_nrpe command (turns out, not default)" into production

616262ff1f-+-adding in check_nrpe command (turns out, not default)

9e665a3f4f-+-Merge "adding a log files size for m1" into production

f4a6d69ac3-+-adding a log files size for m1

a2b438a3f4-+-Merge "adding bellin and blondel and shard m1 to mysql.pp" into production

a327e8684f-+-fixing realm.pp

628518d6a8-+-adding bellin and blondel and shard m1 to mysql.pp

1c1a71a5c3-+-Merge "fixing up icinga's nrpe_local.cfg file" into production

5ffd3311c6-+-fixing up icinga's nrpe_local.cfg file

140003b7b6-+-Merge "adding bellin and blondel to site.pp" into production

ac7307780e-+-adding bellin and blondel to site.pp

521f3e21d0-+-Merge "Revert "Temporary hack to disable extension list cron for the next 24 hours so I can unbreak Translatewiki" like I promised I would." into production

25a316d062-+-Add some eqiad LVS services to Nagios monitoring

c17769b21a-+-Add the remaining upload servers to the pool

4bfcd6723f-+-Add cp1030-1032 to the pool

0ebd3d62a7-+-Add cp1029 to the pool

dbf03fe54b-+-Configure cp1029-1036 as eqiad Varnish servers

0a20790593-+-Allow 3.0.2-2wm3 in the repository without upgrading existing installs

8342f3d12a-+-Merge "moving iron to the new generic mysql class and throwing up a firewall." into production

7c41342d8d-+-moving iron to the new generic mysql class and throwing up a firewall.

da1ec53350-+-Merge "removing lvs monitors :(" into production

354f53b183-+-removing lvs monitors :(

4402a69439-+-Merge "removing facilities" into production

a5ff5e7deb-+-removing facilities

36e718f63d-+-Merge "removing dupes" into production

fc17d1fae1-+-removing dupes

a23a3d6f32-+-Merge "Fixing up snmp monitoring for new icinga" into production

e0f734fcba-+-Fixing up snmp monitoring for new icinga

bb6e911b2f-+-Going about this the wrong way.

cece00f444-+-mysql class requires but doesn't pull in stuff for nrpe via the percona files class.  try pulling in the nrpe class.

a32afbe522-+-Merge "installing mysql on iron to use for testing and development." into production

77751a7f3e-+-installing mysql on iron to use for testing and development.

13463123f9-+-Merge "Adding virt5 into compute cluster" into production

d861c279cf-+-Adding virt5 into compute cluster

49aeac3f23-+-Merge "/me sighs. fix the require too." into production

f4d38b659b-+-/me sighs. fix the require too.

63a6670edd-+-Merge "Seems this hasn't been tested... Making the upstart end with .conf" into production

4811a2a84b-+-Seems this hasn't been tested... Making the upstart end with .conf

4f6d8779d1-+-Merge "Fix typo and the typo i copy/pasted" into production

7b5f0c66ff-+-Fix typo and the typo i copy/pasted

3428a6ed50-+-Merge "Adding in cisco hardware" into production

64bb7ca464-+-Adding in cisco hardware

2c75a38688-+-fixing gsb monitoring and moving to nagios

59dbd69848-+-fixing monitoring class

f036ebc505-+-i hate your sometimes explicit sometimes not variables puppet

538c06a24f-+-fixing lvs monitoring

0d9270fc29-+-fixing for newmonitor

3733a66fc4-+-once again, trying to fix facilities.pp

f4b331bec3-+-trying to fix facilities.pp line 53

81a9824a10-+-putting ubuntu.png in

bdaf267064-+-Merge "changing spence specific nagios checks to use variable" into production

0726a4245c-+-moving es monitoring to nrpe

aec91c23ef-+-Another iteration of adding ganglia for labs.

a450019c52-+-nth iteration of adding ganglia for labs.

bdbb374aa3-+-adding in ubuntu logo

bd4e2379c5-+-Merge "endless corrections of tabulation and spacing, updating dhcp related files for install server Change-Id: I0a41915af9982819d19766df1747daff6f9f82bd" into production

8e491156fc-+-Merge "labs - make common syslogs readable by normal users per RT-2712" into test

39497456bd-+-fixing icinga nrpe

7df75203d2-+-Merge "NRPE include_dir configs need to be named .cfg" into production

0ae2d3a054-+-NRPE include_dir configs need to be named .cfg

5786adc0c1-+-Revert "Temporary hack to disable extension list cron for the next 24 hours so I can unbreak Translatewiki" like I promised I would.

2f0c2ecbec-+-Merge "Add NRPE dependencies" into production

2493258ac9-+-Add NRPE dependencies

025154b562-+-Merge "Fix erroneous }" into production

7bba95e06b-+-Fix erroneous }

1943280726-+-Merge "Need to qualify one more reference" into production

4b5a485e0b-+-Need to qualify one more reference

5dd67a98a7-+-Merge "I'm proud of you Peter." into production

24ac06f3ed-+-I'm proud of you Peter.

3786a65552-+-Merge changes I17f1e082,Ic5047f15 into production

8544bf64f6-+-Merge "Setup process monitoring for varnishhtcpd" into production

bc4e912eab-+-Two new definitions for dealing with NRPE checks in a nice way, monitor varnishhtcpd with it

52d6a644be-+-Merge "jenkins: minimal git CLI config" into production

8a1062c8f1-+-Setup process monitoring for varnishhtcpd

db4bf14bad-+-should have added 2>&1 after >/dev/null not before

bdc33a3479-+-endless corrections of tabulation and spacing, updating dhcp related files for install server Change-Id: I0a41915af9982819d19766df1747daff6f9f82bd

f62c05c3b5-+-redirect labs ldap manage-exports stderr to /dev/null, death to cronspam

31e1933120-+-Merge "install => true doesn't work" into production

62526bf9bf-+-install => true doesn't work

82ce7edb58-+-Merge "upstart_job will overwrite the init.d file" into production

ea8e3b1bb9-+-upstart_job will overwrite the init.d file

1bfcd61cb6-+-Merge "Use Upstart for varnishhtcpd" into production

acbf36c18e-+-Use Upstart for varnishhtcpd

a655a8b8f0-+-Merge "grumble.  overlapped option letters." into production

5d31e17673-+-grumble.  overlapped option letters.

d2b5d52048-+-Merge "enabling saving deleted files in the swift cleaner" into production

e48a1ea70e-+-enabling saving deleted files in the swift cleaner

bde707bba3-+-changing spence specific nagios checks to use variable

19377f08a6-+-Merge "decom for db15" into production

331219ecd2-+-decom for db15

9ff43e547f-+-get ride of old Testswarm fetching script

f8b635cfeb-+-Merge "Add a director_type parameter to varnish::instance (default: hash), use it for eqiad upload" into production

197068ef8f-+-Add a director_type parameter to varnish::instance (default: hash), use it for eqiad upload

df1c554cdd-+-Merge "We were hitting a Puppet bug #7422. Let's see if it works without the relationship." into production

361b71ff16-+-We were hitting a Puppet bug #7422. Let's see if it works without the relationship.

54b37f21d4-+-Merge "Install (or keep) varnish 3.0.2-2wm2 on the eqiad upload caches" into production

174adddb2b-+-Install (or keep) varnish 3.0.2-2wm2 on the eqiad upload caches

d3fcb87782-+-Temporary hack to disable extension list cron for the next 24 hours so I can unbreak Translatewiki.

b35732c497-+-oh it was puppet that was broken (old version), not manifests

b70cddd600-+-looks like systemuser may be broken in generic-definitions.pp skipping user creation step for now

422ff9859a-+-ocg1 wouldn't compile, uninformative puppet barf, flailing ...

84948ccb88-+-adding basic manifest for ocg/mwlib hosts typo fix

b54c91f9e8-+-Merge "Revert "Revert "Update udp-filter config to 0.2 Deploy Wikipedia Zero and Teahouse filters Comment out Teahouse filter Change-Id: I4b8f35a7bc71eb740cba01286be46ad4f06a0ff6""" into production

1476916ccb-+-Revert "Revert "Update udp-filter config to 0.2 Deploy Wikipedia Zero and Teahouse filters Comment out Teahouse filter Change-Id: I4b8f35a7bc71eb740cba01286be46ad4f06a0ff6""

f0914cef92-+-Change the controller name for labs instances

78fa43551a-+-Change the controller name for labs instances

a9043c4f87-+-Use the rrdns entries for the glusterfs clusters

c2018d3773-+-Merge "Use the rrdns entries for the glusterfs clusters" into production

849a103775-+-Use the rrdns entries for the glusterfs clusters

d774add5a7-+-Removing differences in how purge-nagios-resources runs

e6578872e4-+-adding mhernandez account to grosley/aluminium, sudoers cleanup

eb14400d3e-+-jenkins: minimal git CLI config

a270377512-+-Merge "disabling ganglia packet loss reporting cron job on oxygen for now, it's not properly configured yet" into production

e2bb7437a6-+-disabling ganglia packet loss reporting cron job on oxygen for now, it's not properly configured yet

863f39dee1-+-Merge "current backup scheme doesn't work; removing from es1004" into production

0e9f9ecac4-+-current backup scheme doesn't work; removing from es1004

e8604bf42d-+-move jenkins/gerrit fetcher to integration/jenkins

b922509072-+-updating admins, revoking outdated access, commenting file for easier reference

6a4a3f531a-+-Revert "Update udp-filter config to 0.2 Deploy Wikipedia Zero and Teahouse filters Comment out Teahouse filter Change-Id: I4b8f35a7bc71eb740cba01286be46ad4f06a0ff6"

3f9b726785-+-Update udp-filter config to 0.2 Deploy Wikipedia Zero and Teahouse filters Comment out Teahouse filter Change-Id: I4b8f35a7bc71eb740cba01286be46ad4f06a0ff6

1b3d1b8e78-+-labs - make common syslogs readable by normal users per RT-2712

3526b4a54b-+-Merge "scopin' more vars, cleaning up white space" into production

6739b3b488-+-scopin' more vars, cleaning up white space

b46d17dd3d-+-Merge "putting toe in to test the waters of scoped var. if doesn't blow up, will change rest in this conf" into production

2bda57cafd-+-putting toe in to test the waters of scoped var. if doesn't blow up, will change rest in this conf

0b0437af10-+-Merge "oh, dependencies..." into production

38475629cc-+-oh, dependencies...

b77dd58a1e-+-install search qa scripts on iron

0fc299e6fe-+-Revert "Add notify and change conf file mode"

8d21eb6c45-+-Add notify and change conf file mode

0f527014f6-+-Split apache out of local syslogs and limit file sizes

47c78de7ef-+-Merge "Revert "Deploy Wikipedia Zero and Teahouse filters, upgrade package to 0.2.0 Uninstall old package Change-Id: Ie4951a567b5bb9d7b5c06c3dc17f217f1caa59ba"" into production

c25ddbfde8-+-Revert "Deploy Wikipedia Zero and Teahouse filters, upgrade package to 0.2.0 Uninstall old package Change-Id: Ie4951a567b5bb9d7b5c06c3dc17f217f1caa59ba"

19f6406c94-+-Merge "a bit much on the quotes front." into production

e408b89f55-+-a bit much on the quotes front.

ebc65623af-+-Merge "adding some lvs IPs to the lvs servers as well..." into production

87e5c14479-+-adding some lvs IPs to the lvs servers as well...

aa3c5f8b02-+-Deploy Wikipedia Zero and Teahouse filters, upgrade package to 0.2.0 Uninstall old package Change-Id: Ie4951a567b5bb9d7b5c06c3dc17f217f1caa59ba

50c4271e79-+-reenabling contact groups

4c93e467d5-+-Merge "trailing commas?" into production

12390dab1e-+-trailing commas?

992eaa3e87-+-Merge "ruby can be... frustrating..." into production

203fdc71a1-+-ruby can be... frustrating...

08db655d96-+-Merge "Change doxygen checkout of core to checkout/update via git" into production

58f9dd78f7-+-Merge "first pass at dynamic conf generation for lucene" into production

0a6ddc5725-+-Merge "adding some hashes for with which to generate some confs" into production

cb6126334a-+-make gallium "standard"

d9fa6313f3-+-first pass at dynamic conf generation for lucene

de26db5aa2-+-allow gallium to send mails (for Jenkins notifications)

929e889a3e-+-removing nagios_config_dir from neon

a5b72b8f9f-+-Merge "Revert "TESTING icinga stuff"" into production

49573ba541-+-Merge "Revert "TESTING seeing if relative variables make a difference to icinga"" into production

fc4b7602da-+-Revert "TESTING icinga stuff"

583473e3c2-+-Revert "TESTING seeing if relative variables make a difference to icinga"

4710729b0d-+-telling sanger what IP to bind to for opendj ldap

2fe303dc57-+-Merge "let java do the logrotation! (working well in testing.)" into production

f895d112ef-+-let java do the logrotation! (working well in testing.)

de4efa00dc-+-adding some hashes for with which to generate some confs

19e31c28e8-+-set a different nagios hostname for snmp traps in labs realm / fix puppet freshness monitoring in labs nagios

1e66b33298-+-TESTING icinga stuff

6262c2ca98-+-TESTING seeing if relative variables make a difference to icinga

4301fbbae6-+-deleting br1-knams

f6d32a1669-+-decommissioning old servers

0115f4c14c-+-granting zexly non-root shell access on storage3 for banner impression logs

e9092edaf6-+-Revert "jenkins: add existing users to existing group"

985b21aa9a-+-jenkins: add existing users to existing group

bc8accab96-+-Merge "adding in a check to spence that is useful for checking that paging works." into production

cda44a0eb4-+-adding in a check to spence that is useful for checking that paging works.

001aa47539-+-create jenkins using user() and crafted group

429d0d7c34-+-Merge "simplifying some search" into production

cc2a9779dd-+-simplifying some search

222a9fa8fc-+-Merge "adding dsc to shell access on bastions and analytics hosts" into production

1d9a0c1cb2-+-adding dsc to shell access on bastions and analytics hosts

e069057f57-+-try 20 to fix jenkins

17ed0b66fd-+-fixing jenkins

29e6bd9030-+-trying to fix again

eccf703ae4-+-Fixing jenkins group

d7217c8e64-+-Merge "jenkins group for continuous integration" into production

3898326271-+-Trying changing nagios-config dir to prevent the rewriting 50 times

5971d4aed8-+-updating labs config with the correct AUTH key for the mw:thumbnail account

2517c899e2-+-turn off swift container sharding for labs

c5bfc2c79c-+-changing backend for labs' swift instance from inaccessible ms5 to reachable upload.

233e229449-+-Merge "removed rainman user from operations loop after creating lsearch user system user. also made things a little cleaner (no -, actual booleans, etc)" into production

e1f66e7e53-+-correcting forgotten number typo

a412097e7f-+-if assigning to a specific group, that group will, in fact, be defined somewhere else...

ea922130ba-+-Merge "making lsearch user on search hosts." into production

32fbddd62f-+-removed rainman user from operations loop after creating lsearch user system user. also made things a little cleaner (no -, actual booleans, etc)

701cc95748-+-don't configure iptables in labs for swift

27bfde67c4-+-adding stanza for labs swift role, adjusting ganglia stats collector to spoof the cluster name instead of always pmtpa prod

1d5673253f-+-Merge "gerrit IRC bot now join #wikimedia-dev" into production

2720989c6d-+-making lsearch user on search hosts.

d7dc0febe9-+-Merge "well, that explains some things" into production

a280dbbb12-+-well, that explains some things

8681b0b043-+-gerrit IRC bot now join #wikimedia-dev

5f292e9691-+-avoid bnx2 alloc issues on emery tweaking vm.min_free_kbytes

5891a3dff0-+-copying over swift files from production

8995bd667b-+-Merge "gerrit.pp warned about invalid escape sequence" into production

8063b838f5-+-Merge "remove nagios bot from #wikimedia-tech" into production

add01724e5-+-Merge "makes puppet file mode always 4 digits" into production

878dfd2cf0-+-remove +x bits from files of /srv/org/mediawiki/integration

61747d0aee-+-ms1001 gets tweaks for high-bandwidth rsync

9a822707df-+-makes puppet file mode always 4 digits

816b310a52-+-gerrit.pp warned about invalid escape sequence

dd79644742-+-jenkins group for continuous integration

f196a0f9aa-+-remove nagios bot from #wikimedia-tech

b71bc5a93b-+-Add new router cr2-knams to Torrus monitoring

dd99a9d8ab-+-Merge "specifying user and group for all swift::base files; without this they're getting set to root:root" into production

7be287d8ec-+-specifying user and group for all swift::base files; without this they're getting set to root:root

8ca65d9885-+-Merge "moving swift ring files into puppet" into production

8d4751d1af-+-moving swift ring files into puppet

571faa03ab-+-Seventh iteration of adding ganglia for labs.

d59befae8c-+-Sixth iteration of adding ganglia for labs.

77f6c405a7-+-Merge "adding log rotation for search indexer. how novel." into production

600566433d-+-adding log rotation for search indexer. how novel.

a1c2d076eb-+-Fifth iteration of adding ganglia for labs.

e2da75a8f5-+-Adding andrewb as a root

fb65921c01-+-Fourth iteration of adding ganglia for labs.

75c68b2f00-+-Change doxygen checkout of core to checkout/update via git

21f342ade4-+-add misc::statistics::plotting to install 'ploticus' per RT-2163

9b487c8d8c-+-call swift proxy http monitoring from role class, remove hostname condition

e4f38df4e2-+-Merge "2 more lvs pools for search" into production

23a4389f92-+-Merge "Second iteration of adding ganglia for labs." into test

28276f6471-+-Second iteration of adding ganglia for labs.

28c6bb2905-+-Revert "First iteration of adding ganglia for labs."

cc4bebcea8-+-First iteration of adding ganglia for labs.

3317cf0557-+-2 more lvs pools for search

8d8acc79da-+-Merge "Revert "Adding roots and demon manganese"" into production

2c2744f02c-+-Revert "Adding roots and demon manganese"

b2fe9ad8a9-+-Merge "Adding roots and demon manganese" into production

4516cff4b3-+-Adding roots and demon manganese

f3d92cb315-+-updated AUTH token for rebuilt eqiad-test cluster

3572e5a87b-+-increasing the multicast range to allow both pmtpa and eqiad configs to work.  using memcached on all three eqiad swift hosts.

3859c6fe62-+-increasing the multicast range to allow both pmtpa and eqiad configs to work.  using memcached on all three eqiad swift hosts.

c9eedea2a0-+-bumping full scan speed again.  Current rate would take about 1mo to do a full scan.  This should drop that to ~3 weeks.

ef037e0faf-+-Added the openstack tip as an optional repo.

a3583dd710-+-Ensure that /etc/puppetd exists before sticking a file there.

0f3141e913-+-Turn off nova-volume for now.

1cede293d1-+-Switch a bunch of ls -s commands to ls -sf.

23b3042f58-+-Typotastic!

f9a9f3b3ff-+-Change the set of nova services required for essex.

caa186c6ca-+-Adding a proxy for wikimania videos

6690b4e38d-+-Added ppa key, switched to oneiric rep for openstack-ppa/latest-milestone-test.

e6b31bae34-+-Make systemuser make system users

f5a8e56872-+-undoing inadvertent edit on generic-definitions.pp

0f0a838999-+-forgot to remove inherits misc::mwlib::groups from misc::mwlib::users class

0e34c6480a-+-Merge "switching to systemuser" into test

50cb3ea1df-+-switching to systemuser

d213310195-+-The noca-core ppas are deprecated; switch to openstack-ppa.

0462362e6c-+-manages_homedir does not equal managehome . . .

330c49562b-+-adding manages_homedir

86c4fba73b-+-ah ha, gid not groups . . .  yay.

3475af35bb-+-Changing mountpoint to new volume for instances

b5d346a0f0-+-more icinga tweaks

ffdbf929b2-+-Fixing icinga init file

6498f1b6de-+-Merge "fixing temp file permissions" into production

0eaaad997d-+-fixing temp file permissions

31976ed241-+-Merge "Revert "limit swift process monitoring to ms-be hosts because the testing machinges do not have nrpe installed"" into production

0bb97b0fbb-+-Revert "add the nagios-nrpe-server init file"

61ffbb40d3-+-Revert "limit swift process monitoring to ms-be hosts because the testing machinges do not have nrpe installed"

3d91efcecd-+-Merge "Add review comments" into production

dce3edd731-+-Fixing labs/production split in gerrit reporting

6f35d2ccb1-+-Merge "The role classes are actually called role::lucene instead" into production

ab8887d4ef-+-Merge "Retab search.pp" into production

e1c1c40df3-+-Merge "Rename role/seach.pp to role/search.pp" into production

d5a6e42adc-+-Move labs hosts subnet to private

c170e16343-+-Merge "hash of all subnets in network constants" into production

4b1788f5bf-+-Add review comments

25253b9ae3-+-The role classes are actually called role::lucene instead

273ca005d1-+-Retab search.pp

920eaef974-+-Rename role/seach.pp to role/search.pp

9aa55d27aa-+-Merge changes I4b6aefdf,I9209b95d into production

641e945825-+-Package varnish is now installed everywhere instead of varnish3

7f720dbb3c-+-Fix dependencies of varnish::logging

9d87ec4ead-+-vanilla stanza for ms1001 for a start

6ef0e278b9-+-Added a (possibly incorrect) apt-key for nova-core/trunk

bcaccf0c01-+-First stab at making the openstack version configurable.

8d2c9d6335-+-sigh, pure puppet trial and error, waste of revision control and notification packets more rcs . . . wasted.

f13dc3afbb-+-I'm sure this won't work, but at least it looks like existing manifests . . .

58a80fa428-+-let's try that again

c81fd52d1b-+-puppet doesn't like my syntax, stolen from another manifest. oh well

819d600760-+-decommission project2 per RT-2637

5daa684264-+-decommission dataset1, as it's dead per RT-1345

932032b4f0-+-limit swift process monitoring to ms-be hosts because the testing machinges do not have nrpe installed

7498031c75-+-Merge "add the nagios-nrpe-server init file" into production

a22e6efde6-+-add the nagios-nrpe-server init file

a638c50822-+-Merge "swift process monitoring (RT-2593)" into production

9363d803c2-+-Merge "needed to escape the %s for cron to play nice." into production

a49b0a5726-+-needed to escape the %s for cron to play nice.

e4a2192399-+-Merge "Removing gerrit bot from wikimedia-tech" into production

8020dbb79e-+-Removing gerrit bot from wikimedia-tech

8abc545dc2-+-Merge "attempt to get a timestamp into the swiftcleaner log name" into production

af1b25c95f-+-Merge "no lucene monitoring for indexers, as it does not work properly..." into production

1c33f2dff3-+-no lucene monitoring for indexers, as it does not work properly...

dcaf2cf508-+-attempt to get a timestamp into the swiftcleaner log name

3f11aa47cf-+-Merge "increasing speed of the swiftcleaner so it has a chance to finish its scan in a reasonable amount of time" into production

23bf79c4f0-+-increasing speed of the swiftcleaner so it has a chance to finish its scan in a reasonable amount of time

cb40f66ad2-+-added misc::mwlib::users and misc::mwlib::groups

212700381d-+-adding in all old nagios groups to purge

6c41b6841a-+-starting to puppetize the pediapress project

ce3ab78ecf-+-added sq39 to decom due to pci training error

06b85f836b-+-Merge "Temporarily disable varnish package installation during package name migration" into production

34d9d7791b-+-Temporarily disable varnish package installation during package name migration

451eb38e40-+-Merge "Fix creates file name" into production

92857dc59f-+-Fix creates file name

52be91e261-+-Fix creates file name

09b4c90867-+-fixing collection

86069e0bff-+-fix perms and purge decommissioned AFTER collecting resources

f436baf48b-+-trying to make exported files world readable

e7942d3292-+-Making sure all config files are readable

2f55c7d409-+-Fix othermirrors, setup default dist link

f0c8a61053-+-Fix dependency cycle

49db1e8d3a-+-Fix othermirrors, setup default dist link

94a98fe73c-+-Fix dependency cycle

dbdf90406b-+-Merge package-builder changes into test

710e88efb6-+-Puppetize pbuilder

ac2cb5ddb5-+-Move misc::package-builder into a separate file

78dae0f076-+-mount gluster publicdata volume on dataset1001 (dumps)

128a69ebcf-+-bonded interfaces for dataset1001

2a4d0c907e-+-removing misc::udpprofile::collector from spence

db04629844-+-vcl_config, not vcl_options

15597673a9-+-Merge "comment out Swift HTTP monitoring on non-production hosts again, this used to work for a day now they socket timeout, so i expect they have been stopped deliberately" into production

ba519da8c0-+-comment out Swift HTTP monitoring on non-production hosts again, this used to work for a day now they socket timeout, so i expect they have been stopped deliberately

e1839b656d-+-Merge "allow virt[1-5] subnet to access spence" into production

63d0cb168c-+-allow virt[1-5] subnet to access spence

41f85c7cf2-+-Merge "Revert "Fixing apache config for gerrit to work with labs"" into production

71414c20fb-+-Revert "Fixing apache config for gerrit to work with labs"

f7d051bafc-+-Merge "Fixing apache config for gerrit to work with labs" into production

e2d2d249e5-+-Fixing apache config for gerrit to work with labs

b72b11f8b4-+-Merge "added option to ignore previous state when running swiftcleaner, fixed bug in pidfile detection" into production

6348a2bb43-+-added option to ignore previous state when running swiftcleaner, fixed bug in pidfile detection

c12d4235b0-+-Merge "correcting variable scope in template file, correcting path to conf file in cron invocation." into production

34e9f98d08-+-correcting variable scope in template file, correcting path to conf file in cron invocation.

34106bf730-+-Merge "installing the swift cleaner on iron" into production

f375670129-+-installing the swift cleaner on iron

ee3765f9d8-+-Merge "trying to puppetize a cronjob to run the swift cleaner changed swiftcleanermanager to only allow one instance at a time (using a pidfile)" into production

7c398f81f4-+-trying to puppetize a cronjob to run the swift cleaner changed swiftcleanermanager to only allow one instance at a time (using a pidfile)

6768627896-+-Merge "removing icinga default conf" into production

897719715e-+-removing icinga default conf

1ce4a6fe26-+-Changing ls one-liner to only output extension names, rather than directory contents

b9cec16196-+-Upping tools again

604f6a7907-+-publicly list mediawiki extensions git repo

987f33a4a9-+-Merge "db18,19 decom" into production

514d13b854-+-Remove default icinga conf file from apache

5ae56512c7-+-making check all spelled out for purging nagios resources

cec80da50c-+-more icinga fixes

45687ec494-+-more icinga tweaks

f0c309a325-+-making sure conf.d exists

85de89a89b-+-db18,19 decom

7ba86993fd-+-Allowing icinga in sudoers as with nagios + group gammu

c44935214b-+-also allow public esams net (91.198.174.0./25), not just private, snmp access

0d731eaa8e-+-fixing paths

5acf8e0d2e-+-fixing the nagios checkcommands template again

f48fddc1b5-+-swift process monitoring (RT-2593)

f723f1d7d6-+-Upping svn rev for ldap tools to update manage-volumes

1e1a561bbe-+-removing unneeded /etc/icinga check

bf5db748b0-+-explicitly calling out nagios_mysql_check_pass

5b49bd5c61-+-Moving icinga specific files to own class

731a0723ae-+-Merge "trying another commenting out" into production

a63358a4e8-+-trying another commenting out

ce62002ed4-+-Merge "Trying to ignore this as a requirement" into production

63649fd4e7-+-Trying to ignore this as a requirement

6155c4f531-+-Merge "Putting service definition after files installed" into production

094a7c1eee-+-Putting service definition after files installed

da24ad6f85-+-Merge "using these would be smart!" into production

1bd113bfe5-+-using these would be smart!

75b59282e5-+-inserting icinga config file

fc8330993c-+-Merge "updated ipmi script to work a bit better, added iron into site.pp" into production

8cff549e61-+-Merge "Reenabling icinga install on neon" into production

01f07b9aba-+-Reenabling icinga install on neon

6c0623cf16-+-updated ipmi script to work a bit better, added iron into site.pp

1c6720b66d-+-changing lvs and nagios to check for a file in swift directly rather than going through the swift rewrite stuff for thumbnails to protect against the thumbnail getting deleted (second try)

6fe514315a-+-pgehres storage3 shell access per RT 2610

932d020c13-+-Cleaning up icinga config Moved files from nagios3 directory, notify proper service, etc

9446217b22-+-Fix LVS setup of payments

a0772196dd-+-hash of all subnets in network constants

05e4a03f9e-+-Subscribe to upstart job changes

ed312e2665-+-Install socat for unicast->multicast relaying

48a955f6de-+-Try a dynamic lookup, global is not working

66f7614403-+-include nagios::configuration so $master_hosts can be referenced

3794f98afe-+-Do HTCP loss monitoring on the upload eqiad servers

9fdb7bb78f-+-fixing network::checks

ed2b765ea5-+-including nagios configuration group

e1eb07c767-+-Adding in customized init file, preparing icinga for initial install Removing contact groups so that we don't get deluged by email in initial install

56df6eca68-+-You suck puppet. I hate you so much.

7893562143-+-This seems silly, but let's try it.

c4086812aa-+-Merge "Throw cp1022-1028 into the upload eqiad pool" into production

a8bf812c0b-+-Throw cp1022-1028 into the upload eqiad pool

460dfa312e-+-Merge "Setup dependency for varnish::logging" into production

9e21d34d16-+-Setup dependency for varnish::logging

0ed70ec0d0-+-Fixing fixme's from previous change https://gerrit.wikimedia.org/r/#change,2936

4fd9691dca-+-Merge "Modifying nagios config files for icinga" into production

88e69de71c-+-Create a separate vcl_config hash, as retry5x/cache4xx are not backend options

a8a12be95b-+-Merge "Monitor both frontend and backend varnish instances for mobile as well" into production

e6a912f366-+-Monitor both frontend and backend varnish instances for mobile as well

3d66c9e018-+-Merge "Support multiple varnish instances in the ganglia metrics module" into production

007d32e316-+-Support multiple varnish instances in the ganglia metrics module

4f745f2abd-+-make check_http_swift flexible for different ports and add an if-statement on hostname

917aeb0f97-+-meh, duplicate def from including standard, add nagios hostgroup in base definition then and do this in role::swift

846e034ca9-+-swift prod servers to monitoring group, that didnt appear to work because they dont include base

d7d5d6568e-+-oops, what did i do there, fix the exec for nagios to exim group, meh, get rid of whitespace too

4279f1347c-+-Merge "add nagios to the Debian-exim group to allow it to check_disk the tmpfs mount - should fix CRIT on sodium" into production

7aa4f1b342-+-Merge "put swift production servers into a nagios hostgroup" into production

8a084a6020-+-put swift production servers into a nagios hostgroup

18f8e53bf1-+-Make Puppet automatically restart the varnish loggers on changes

b44327037d-+-Specify cache4xx as a time period

81d56f012f-+-Cache 4xx on upload

c9c224230e-+-Let's not have Varnish writing to the same file concurrently, shall we

10ac999470-+-Convert mobile servers to new htcppurger class, purging both varnish instances

477fb0c831-+-Purge both Varnish instances

6dae5a142c-+-Typo

15db1cf314-+-Test modified varnishhtcpd with inline http port

00c7a2230a-+-Don't use probes for upload backend, use upload squids as backend

06aa339b4a-+-Merge "More troubleshooting" into production

373d760372-+-More troubleshooting

c3664a54cd-+-Merge "More grasping" into production

fe693dc7c0-+-More grasping

0438de8579-+-Merge "Grasping at straws here." into production

7aa96ee240-+-Grasping at straws here.

277f872247-+-Merge "I hate you puppet" into production

daddf58328-+-I hate you puppet

ebed1f79c8-+-Merge "1-2 not 12" into production

40b3124fe8-+-1-2 not 12

a3ede14aef-+-Merge "Ensure glustermanager can run mkdir -p, not just mkdir" into production

9dd7f00e69-+-Ensure glustermanager can run mkdir -p, not just mkdir

d74bb0c265-+-Merge "Pass realserver IPs as a hash, not an array" into production

a305d3c490-+-Pass realserver IPs as a hash, not an array

4f1a229aaa-+-Merge "Add upload service IP to lvs1002/lvs1005" into production

9efa28db47-+-Add upload service IP to lvs1002/lvs1005

12043ef465-+-Merge "Just test on cp1021 for now" into production

725d7dbd76-+-Just test on cp1021 for now

0c9f595439-+-adding wmf/fb mysql to hume for civicrm/drupal upgrade testing

184ce58791-+-Merge "Make xff_sources parameter a normal array without hash" into production

104ecef000-+-Make xff_sources parameter a normal array without hash

6c778e8fc7-+-Merge "Syntax, missing include" into production

8edcca6453-+-Syntax, missing include

14381a4354-+-Merge "Make varnish work for upload thumbs" into production

02b02f5b6f-+-Make varnish work for upload thumbs

8d348cb747-+-Merge "Change parameter defaults" into production

f028e0a1d3-+-Change parameter defaults

9a19493b03-+-Merge "Hate Puppet's assignment rules too" into production

3465a52e1d-+-Hate Puppet's assignment rules too

ecde1411e9-+-Merge "Hate Varnish persisting usage of ACLs and backends" into production

e67a75b7d0-+-Hate Varnish persisting usage of ACLs and backends

c3ed5279f3-+-Merge "Create a Varnish VCL consisting of all Wikimedia networks" into production

42e2a95375-+-Create a Varnish VCL consisting of all Wikimedia networks

5732833466-+-nagios monitoring for mw profiling collector and graphite (RT-2367)

1c0c138050-+-Merge "Placing the script properly on labstore2" into production

1484a289da-+-Placing the script properly on labstore2

c36bc25902-+-Merge "Add manage-volume cron on labstore2, and add an ircecho bot for the logfile" into production

9dd1ad4d1d-+-Add manage-volume cron on labstore2, and add an ircecho bot for the logfile

b7e821c32e-+-Merge "typo: snmaptrap :p we aren't portscanning here .. and let's remove all "-" just in case" into production

5171f89aa1-+-typo: snmaptrap :p we aren't portscanning here .. and let's remove all "-" just in case

51b6cb6446-+-Adding manage-volumes script link

43999421ec-+-Up the version of user-management scripts

cd96a10e8b-+-Up version of user-management tools

140a606b49-+-iptables_add_exec{ "${hostname} would also be a duplicate .. we need 2 of them though, right?

456001e3fb-+-can't use Iptables_add_service[lo_all] etc. twice, duplicate definition, so merging nsca and nrpe iptables rules into one nagios::monitoring::firewall class instead of repeating everything all over with different names, also disallow nsca from labs

5519c68d8f-+-Merge "nagios,snmp,iptables: allow private IP ranges, but not labs 10.4.0.0/24 and 10.4.16.0/24" into production

6f8c0b51b7-+-nagios,snmp,iptables: allow private IP ranges, but not labs 10.4.0.0/24 and 10.4.16.0/24

88380aa2c4-+-Merge "add nagios::monitor::snmp to spence" into production

3e9f165d69-+-add nagios::monitor::snmp to spence

bbc45db949-+-Adding gluster options for autofs

fe11a4917f-+-Adding gluster options for autofs

db0bd051af-+-Adding base directory for labs automounts

26373eaf7d-+-Adding base directory for labs automounts

2fff2a1de5-+-Add gluster to instances by default

8b0d944179-+-Add gluster to instances by default

9a8b8abf85-+-damned typo added other locke items to oxygen as it is the locke replacement

8faab12598-+-Modifying nagios config files for icinga

58bf1c93d6-+-Dashes are ILLEGAL!

a53016f240-+-Fix storage file name

a16ea559d6-+-Add fstype

2a31dfc111-+-Add text/upload cache groups to ganglia

73df645740-+-Initial puppetization of varnish upload cluster in eqiad

0c36fbea70-+-Bug 28469 - Make SVN Documentation be indexed

e6b8884022-+-add groups::wikidev to cadmium, puppet broke due to dependency Group[500] for User[catrope] without it

ea9da73e69-+-sort iptables ports and protocols alphabetically

94e15ad5f0-+-add iptables rules - let only production network send snmp-traps to nagios

da7f8475bf-+-nagios - move snmp stuff into it's own class

c3717bea26-+-Merge "Ensure a run directory exists for the glustermanager" into production

29909de418-+-Ensure a run directory exists for the glustermanager

b95741000c-+-Add sudo rights needed to manage gluster

f19479b6ce-+-changed the name of the ganglia logtailer from being proxy specific to being http specific since it works for the backend stoarge nodes too.  moved the puppet config from proxy-specific to swift::base to include it on all nodes.

3c29797191-+-Merge "that's a bit better" into production

270a8d9640-+-that's a bit better

ca507306a2-+-Remove csw5-pmtpa from monitoring

bd86dc28c0-+-Merge "looks like xff_sources is required for varnish defs now to avoid an unused acl fatal error" into production

24aaffe5e2-+-looks like xff_sources is required for varnish defs now to avoid an unused acl fatal error

6ea817553c-+-Merge "testing a varnish instance in front of gdash" into production

9339e41e0f-+-testing a varnish instance in front of gdash

e77f45a358-+-Merge "easy way." into production

4f60059fda-+-easy way.

f8fe311c1e-+-Merge "well that's a weird dependency loop..." into production

4378cd035d-+-well that's a weird dependency loop...

62a4f2d4ef-+-attempt at fixing missing passwords

db4cd35c20-+-removing the use of an unqualified global variable, fixing file source

e14fb25575-+-puppet couldn't find the swift-ganglia-report-global-stats file, trying to use a different identifier from the cronjob.

da1c42a573-+-adding cronjob to calculate global swift stats to ms-fe1

e1eefcf69e-+-fixing exec

2936435c96-+-notifying nrpe-server when config file changes

3e0feb5794-+-Adding neon into all spence exceptions for monitoring

f72137aeb7-+-..and another duplicate..Apache_module[ssl] already defined in the generic class

45ba18478a-+-ugh, need to remove duplicate service definition for apache2 as well then (hooper/racktables)

f37e2aebc5-+-include class {'webserver::php5': ssl => 'true'; } in misc::racktables to fix broken puppet dependency on hooper

898b79625a-+-add nagios to the Debian-exim group to allow it to check_disk the tmpfs mount - should fix CRIT on sodium

3300151c68-+-removing nagios monitor from neon doing manual changes, prevent overwriting

d215478029-+-Merge "Adding python-paramiko to openstack::project-storage" into production

e291d4cc41-+-Adding python-paramiko to openstack::project-storage

6280d24ae3-+-Merge "Giving glustermanager a shell" into production

fef78486a7-+-Merge "making a routers group" into production

36a40c15ec-+-Merge "Commenting out nagios site in new server" into production

905feecf16-+-making a routers group

6c279fabb5-+-Giving glustermanager a shell

feca2bdacb-+-Adding a glustermanager system user for project-storage

694ba5e010-+-Commenting out nagios site in new server

e0cbbd2aa8-+-rsyslog and syslog-ng conflict

477b37cf2c-+-Setup a syslog-ng server on streber for network gear

8c159f5a5a-+-Rudimentary multi-config support for syslog-ng

3dd997e0c7-+-Merge changes I5ba28f45,I1bf8f28a into production

908f4927ac-+-Merge "Revert "added in simply mysql server call for labs testing of blog"" into test

69708590b5-+-Revert "added in simply mysql server call for labs testing of blog"

fd5b7c934d-+-I hate our apache manifests, so, so much.

22272fe615-+-Checking for no-apache gerrit config properly

c811c5f702-+-Removing non-ldap accounts from formey and manganese

d561ff63ae-+-Add a way to avoid installing apache

53a9a64d37-+-Seems wikidev *is* required

00804e84f0-+-No need for gid 550 on manganese, or wikidev

3bbb02fcfc-+-Merge "Ensure replica is readonly" into production

28667b8224-+-Ensure replica is readonly

4a956674b9-+-Adding python-paramiko to gerrit manifests

a745ed6f06-+-Merge "changing the user for swift's rewrite stuff so I can use a new password" into production

19b2294919-+-changing the user for swift's rewrite stuff so I can use a new password

7ed3d7bfdc-+-Fix mode of /srv/autoinstall

4df29eb823-+-Move misc::install-server into a separate misc/ file

27fcd38bf6-+-download host kernel settings for eth buffer allocs

2086a4ea20-+-move rsync to external mirrors off to download mirror host

5c1d0ee7d6-+-Merge "Adding sumanah back onto manganese" into production

993bbe637c-+-Adding sumanah back onto manganese

e0efd29f89-+-Merge "Add manganese to ldap firewall rules on virt0" into production

0e67b791f5-+-Add manganese to ldap firewall rules on virt0

764b7716b9-+-Merge "Ensure default site is gone." into production

f5b015f06b-+-Ensure default site is gone.

4b5b5f4df0-+-Merge "Fix stupid requirement copy/paste" into production

c246b2e4e4-+-Fix stupid requirement copy/paste

afd909d43d-+-Merge "Fix requirement chain" into production

84d9fc7b93-+-Fix requirement chain

841d87cad6-+-Merge "Adding an apache server to the gerrit proxy" into production

3a5b470f40-+-Adding an apache server to the gerrit proxy

93a1e90893-+-Merge "Removing sumanah from manganese, for now." into production

d5e97f276f-+-Removing sumanah from manganese, for now.

f57143df79-+-Merge "Adding manganese as a new gerrit server." into production

dc1815addf-+-Adding manganese as a new gerrit server.

f58a2698b0-+-removing default site

432afc8b60-+-Fixing file paths

7313caa92a-+-Adding in proper cgi.cfg for nagios3 and moving all nagios3 specific files to their own folder

2a82d97889-+-amending neon search path

781a38d2be-+-Merge "switching to exec whenever (as does not trigger if nagios is not running already)" into production

e2c733e9c8-+-switching to exec whenever (as does not trigger if nagios is not running already)

fcc2e74564-+-Merge "Ensuring conflicting files absent Also fixing some indenting" into production

8f4fc189bc-+-Ensuring conflicting files absent Also fixing some indenting

8fa9c531da-+-Make strontium and palladium internal rightaway, and prepare for converting the others

9b76140b7d-+-Add strontium and palladium as bits servers

a85bceb030-+-Merge "added in simply mysql server call for labs testing of blog" into test

afd6b767ff-+-added in simply mysql server call for labs testing of blog

6d10b9c834-+-adding class to install pip for stat1 - dev use only.

1b6cd67f9e-+-ensure sample config file removed

db0f4b3a6e-+-Merge "Installing ssl module and certificate" into production

d9a443accb-+-Installing ssl module and certificate

b112621f92-+-Making the default repo channel #mediawiki

4843ec6b14-+-changing some nagios3 config files to uniques

f68aee28a0-+-switching s4 master to db31

c8784b740d-+-s1 master swap

6dadd447da-+-giving andrew a different real name so his two user accounts don't conflict.

5bd6f99ac8-+-Revert "removing aotto from stat1 so it doesn't barf when it hits the account ensure => absent"

1eb21f8eaa-+-removing aotto from stat1 so it doesn't barf when it hits the account ensure => absent

20aca43f92-+-Merge "new s6 master" into production

86a8a9d3e7-+-new s6 master

c29e008646-+-Amending previos commit: installing python-mysqldb from deb.  Not requiring mysql client class, this should be installed by the .dev if needed manifests/misc/analytics.pp - some comments

f6e2c3a507-+-Merge "Renaming my user 'otto'.  Deleting 'aotto'. I'm currently only installed on stat1.wikimedia.org, so it is better to do this now rather than later. I hope this doesn't piss anyone off.  Thank you!" into production

42a3c0b546-+-Merge "Adding David Schoonever account 'dsc', including dsc on stat1.wikimedia.org" into production

870f0feea2-+-s5 master changing from db45 to db35

0dcdee15d9-+-Merge "hooper is no longer a blog server" into production

34821345ba-+-hooper is no longer a blog server

9631ce7efb-+-Merge "require unzip for blog server" into production

d9bd583a0a-+-require unzip for blog server

389fbc1bc3-+-Merge "switched /etc/nagios-plugins to /etc/nagios-plugins/config" into production

cbd2e2ba1d-+-switched /etc/nagios-plugins to /etc/nagios-plugins/config

d5c88922f9-+-jenkins: git preparaton script for gerrit

ff3d056f12-+-Ensuring /etc/nagios-plugins directory exists

cfd09d8ade-+-Adding in plugin-config files to puppet and new nagios manifest

c55dee74d6-+-Merge "puppetizing some indexer stuffs" into production

3908803ce0-+-puppetizing some indexer stuffs

3a010a3858-+-chris changed keys, updated admins file

f52dd064c3-+-harumph dynamic typing...

69db893ba9-+-don't want generic

bbeac5eb26-+-Merge "search lvs" into production

8aef154e3a-+-Fix the broken cron job mail bombing me

958d1703e2-+-Puppet was making no attempt to start Swift

dfbfdeec6b-+-Break up swift::storage into subclasses for dependencies

73bc04b21e-+-Added manifests/misc/analytics.pp - misc::analytics::packages: class to install packages analytics needs to process data

f8dbb85d0f-+-Changing static /etc/nagios to variable of config directory needed for nagios3 compatibility

30449c7e47-+-ensuring directory exists + a bit of cleanup

dfb4e74da6-+-ensuring /usr/local/nagios exists

f7b26d008f-+-changing /usr/lib/nagios to /usr/lib/nagios3

04bf5d8460-+-Renaming my user 'otto'.  Deleting 'aotto'. I'm currently only installed on stat1.wikimedia.org, so it is better to do this now rather than later. I hope this doesn't piss anyone off.  Thank you!

9586b101f7-+-Adding David Schoonever account 'dsc', including dsc on stat1.wikimedia.org

2e9af5212a-+-Fixing type in nrpe.pp

b40708727f-+-Removing ensure => absent

5cbfc38d6c-+-Fixing neon cronspam and neon nagios

ab752e2377-+-Changing neon to public machine

51d220976d-+-Merge "Bringing neon back to life" into production

faf9d48b99-+-Merge "trying to remove 4700 lines of spam as stat1 tries to manage /a for ezachte." into production

d25f5e39dd-+-trying to remove 4700 lines of spam as stat1 tries to manage /a for ezachte.

d39a9e2379-+-Merge "puppet exec enforces full paths; that's cool." into production

8fd5f17add-+-puppet exec enforces full paths; that's cool.

cce4f148b0-+-Merge "adding class to install pip for stat1 - dev use only." into production

8d07fb8447-+-adding class to install pip for stat1 - dev use only.

527063551f-+-Merge "Adding geoip libraries to ensure it's managed by puppet" into production

515a9be970-+-Adding geoip libraries to ensure it's managed by puppet

f7c3d28533-+-Merge changes I136d43ff,I3d90bc38 into production

0d53f566b2-+-Adding git and mysql-client to stat1

6305abc2fa-+-Making labstore1-4 LDAP clients

9f0d004d39-+-Bringing neon back to life

244b997e77-+-Putting neon in decomissioned (reinstalling as public)

259400847d-+-fixing reference to nagios3

4deacae3fc-+-Revert "Trying to move exported resources in new nagios host"

a02c343313-+-Trying to move exported resources in new nagios host

6fb904d2bd-+-Making tweaks for nagios3 installation

d784960078-+-removing defunct ganglia1001

860390a6d9-+-Merge "Fixing nagios service to nagios3 in newmonitor class" into production

4b16610ed1-+-Fixing nagios service to nagios3 in newmonitor class

821b80bff5-+-Revert "Only pushing standard package as stafford is overloaded"

9f82d6b4fc-+-Only pushing standard package as stafford is overloaded

e1031327f5-+-commenting out aggregator Attempt to make puppet compile the directory before timeout

d7e229fb24-+-Applying LDAP fix to all instances

99e6f3a3b2-+-adding cron to search hosts to occassionally poll for new mediawiki config files

60eba2af4d-+-Applying LDAP fix to all instances

c39792ddb9-+-Merge "Creating new class for new nagios host (aka neon)" into production

f36485e40a-+-Creating new class for new nagios host (aka neon)

47858b9f3a-+-Merge "searchidx wants this too" into production

663705f522-+-searchidx wants this too

ed7afb93f5-+-do sites properly

da91478af4-+-search lvs

b9714c0212-+-well, that sure doesn't exist...

db2645d53c-+-regex

51d8abea3c-+-clean up requires

9906227359-+-that hostname so doesn't exist...

b87a750ffd-+-get the password to the file. boop boop

ff75dc3db3-+-some more indexer bits and pieces

a57877da05-+-adding mediawiki install to search indexers

99a805ebf6-+-new conf for eqiad

ee98d378f2-+-Merge "adding searchidx1001 to site.pp" into production

8051e7edca-+-adding searchidx1001 to site.pp

d922366b30-+-Revert "Remove Ryan's ssh key"

f6359eefea-+-Remove Ryan's ssh key

07bb75f7b9-+-Merge "RAWR. How did this upstart job not get fixed?" into production

cab12f1fd6-+-RAWR. How did this upstart job not get fixed?

c4f2b16e73-+-Merge "Fix labstore node syntax" into production

ed822a04f2-+-Fix labstore node syntax

4d02792a2b-+-Merge "Add gluster cluster" into production

78ab957d7b-+-Add gluster cluster

09365e5d0e-+-Merge "Remove dependency on file we're already removed." into production

c4337251c5-+-Remove dependency on file we're already removed.

2930fab66b-+-Merge "Also remove system-specific uuid" into production

971fe1169e-+-Also remove system-specific uuid

5d88d04168-+-Merge "ensuring directory structure for nagios machines" into production

fc29243e70-+-ensuring directory structure for nagios machines

9b9f33f52c-+-Merge "Removing gluster peering support" into production

218f274cd2-+-Removing gluster peering support

05bb7b04fc-+-Adding in more requirements for new nagios box

b63beccb87-+-Remove gluster peering support

ce20d16377-+-Revert change 2651

cf8d041af1-+-fixing nagios::monitor and nrpe conflict

ef5d3dc212-+-Add cluster info for gluster clusters

f4deeaa84c-+-Removing nagios-plugins from nagios::monitor directly

f70ad0fc0a-+-Making a 2nd nagios server

0d649b0ff6-+-assigning neon as a ganglia aggregator

812a2503fe-+-Migrating to libnss-ldapd: remove libnss-ldap configs/init script.

1d7febd496-+-Fix puppet manifest for testing migration to libnss-ldapd.

6f35146ee5-+-Test migration from libnss-ldap to libnss-ldapd.

ba6e02d8da-+-Minor whitespace cleanup For purposes of triggering git post-merge hook on sockpuppet

536ce71e42-+-requiring facter files before running tcp tweaks

71ff075bcd-+-Moving generic::tcptweaks to "standard" server class

4167329623-+-Merge "new logrotate for search nodes" into production

df5f396e79-+-new logrotate for search nodes

0db0ba9cf5-+-Merge "misc::contint::jenkins now install jenkins" into production

81e98d4f59-+-mystery solved, stupid typo on new apache vhost config

129311d718-+-should make sure we don't get openjdk in there too

f4ea53d362-+-perms: they matter

b43596f797-+-added candium and roan to access it to site.pp

b02a1ebd2c-+-Comment again, until I have time to look at it

e09aefe7bc-+-Prepare oxygen for multicast relaying

2a98934e34-+-misc::contint::jenkins now install jenkins

23ae83f432-+-Merge "fix pubkey for aengels" into production

ba8fa2632c-+-fix pubkey for aengels

3a1f41ecf4-+-yay more typos boo no lint checks

ac2fc21f8a-+-typoed semicolon should be comma

f0acf32992-+-Merge "some loggin for the lsearchz" into production

5d0270b652-+-some loggin for the lsearchz

f6d652eac8-+-Merge "upgrading db31, new s2+s4 masters" into production

21de89ffaf-+-upgrading db31, new s2+s4 masters

a024c22467-+-reenabling ifup script

2e73a6d33b-+-upgrading db34, db39 new s3 master

a98d6c5e5c-+-upgrading mysql on db16, db37 is new s7 master

01c842f53b-+-argg, fix whitespace in ssh key

e4e900e87a-+-Merge "Add job name" into production

0e863970d2-+-Merge "add account for aengels, add to stat1, fix last UID counter" into production

4fe51499c8-+-Add job name

d7d9f96717-+-Make start-stop-daemon work with multiple instances

73dae8f4de-+-add account for aengels, add to stat1, fix last UID counter

32666e546b-+-Apparently Puppet doesn't do string concatenation with +

1e6627496c-+-Syntax error

a98e5724a6-+-Pass the environment as arguments

9cd58b52cc-+-Working upstart job varnishncsa

2f3b8316ba-+-Merge "fix lower-precision longer term storage of stats data" into production

39716821bd-+-fix lower-precision longer term storage of stats data

6e9bd41eac-+-temp commenting out config file until new facter script propogates

e4bd4a62f2-+-Merge "Ensuring tcp setting tweaks are on all serving platforms" into production

0c846144bc-+-Ensuring tcp setting tweaks are on all serving platforms

a4cce60486-+-Ben made default_gateway.rb report default_interface

27dab1cf03-+-ruby is one hell of a language...

8053115cc3-+-small fix and redoing one of my worst naming decisions ever

0afe16654c-+-Beginning slash!

6d89435c92-+-Adding in new facter fact of default interface This is the interface bound to default gw

135172a705-+-making new lucene classes and configs

ae1e1d0bfb-+-Comment for now

230995ce15-+-Remove status

f9b4777f54-+-Specify path

a4731c0374-+-Fix status command

97ba397e89-+-Make varnish_instance default undefined, never mind pid files

ee5c19d5a5-+-Don't start if already running

159b40a080-+-Fix dependency

c08dcb4066-+-Using a service type causes conflicts, try exec instead

08ecb8a259-+-Move out upstart_job dependency

f09e0422f7-+-Use an upstart manifest for managing varnish udp loggers

25756b16ac-+-Use class parameters

0798664e80-+-Make varnish_xff_sources a class parameter

c3062ec918-+-Pull in LVS service IPs from lvs.pp

666e1061c8-+-Pull LVS service IPs from lvs.pp

a25c5b82b4-+-Move monitor_service to the service class

555200fdca-+-Cleanup

f429ff0534-+-Merge "let the LVS HTTP check on api cluster check a real api.php URL instead of Main_Page" into production

b52962c60a-+-Merge "Give the API apaches a higher MaxClients setting" into production

ab0a96dade-+-let the LVS HTTP check on api cluster check a real api.php URL instead of Main_Page

28be3ae81d-+-Give the API apaches a higher MaxClients setting

e259c360e7-+-more capable and efficient version of sqstat

b1876e3506-+-Script to change initcwnd to 10 packets see http://wikitech.wikimedia.org/view/TCP_Tuning#initcwnd_10

2d195f104e-+-adding in a if-up script that changes initcwnd

851b04fb92-+-Adding in default gateway fact for puppet

5bf785adad-+-inserted a missing slash

33033bd842-+-ensuring directory for facter

da8f0642ee-+-recursing file to make it create directories

6ba3badb86-+-Adding in default gateway fact for puppet

e354b0bea2-+-/etc/init.d/torrus-common restart has proven unreliable

af7903ec6f-+-Turn on KeepAlive on application servers

0ca70929e3-+-generic::webserver -> webserver, class has been renamed

1b7ac0b98d-+-Automatically clear the cache on Torrus config changes

1f9658f687-+-Corrections

500484f8f3-+-Remove decommissioned servers from api list

5c3e6a3ef8-+-Remove old nagios host/service groups for squid

6f01be0350-+-Merge "Decommission sq35" into production

8dd1f47f61-+-Decommission sq35

a13a85974f-+-Merge "Decommission sq31" into production

417ebb6906-+-Decommission sq31

9997d554e1-+-Merge "Decommission sq38, sq46, sq47" into production

3bd1b24e5a-+-Decommission sq38, sq46, sq47

8aa71ff99f-+-http setup for gdash

56a7a57036-+-enabled community-analytics virtual server

86ee729419-+-removing references to puppet:///files/nagios/nrpe_local.fundraising.cfg which was removed

a518d9e0b3-+-added community-analytics vhost for aluminium/grosley

643ce5b045-+-Unbreak LVS by allocating eqiad swift svc ip

5a5a0cd286-+-Attempt to unbreak LVS in eqiad

0da4d45122-+-ok that worked, now ensure document root dirs exist, config languages in single place, system role

db1b8ac0c6-+-back to using definiton, but do _not_ use - in definition names, may think i want to do some maths

4d5646d1f1-+-$name instead of $title, $title has the class name

af19d365c2-+-using that definition didnt work as expected, (why?), then just a more direct way..

c5321aaa45-+-fix typo in file path breaking dependency

29e3403c49-+-add planet configs using a custom definition to avoid repetition, add mode

0890c12e93-+-require user and script for cronjob

3b14e633bb-+-planet - update script,cron,systemuser,logdir,..

c459a40359-+-Automatically generate cachemgr.conf content from active_nodes Puppet list

ae8a8ea30c-+-Using the 'enable' service resource type parameter is a better way

cdcdca247f-+-Make sure Squid doesn't automatically start at boot

36ffad1114-+-Merge "Make squid.xml generated by a template as well" into production

8662462cf9-+-Make squid.xml generated by a template as well

d6f4dcf114-+-Merge "Corrections" into production

7bd2cdbaee-+-Corrections

d47c1b2644-+-Merge "Generate all varnish nodes in varnish.xml from a function" into production

0bccdb251b-+-Generate all varnish nodes in varnish.xml from a function

c01087f585-+-Merge "taking owa out of the prod swift cluster until we need them." into production

5265f1c5a0-+-taking owa out of the prod swift cluster until we need them.

2d56e93574-+-Merge "More domain name corrections" into production

f3bdde5600-+-More domain name corrections

8bb2c12283-+-Merge "knsq* use .knams.wikimedia.org still" into production

44bf08eea8-+-knsq* use .knams.wikimedia.org still

c1d3a2b097-+-Merge "Correct esams host names" into production

2438127a67-+-Correct esams host names

408b7443ae-+-Merge "Allow difference between path and node list" into production

8ef0ad0a0d-+-Allow difference between path and node list

d21668d67a-+-Merge "Add missing 'api' key to decommissioned nodes hash" into production

4b2ff58485-+-Add missing 'api' key to decommissioned nodes hash

6586f3224c-+-Merge "Convert all aggregate RPN lists to functions and puppet hashes" into production

7787ce9154-+-Convert all aggregate RPN lists to functions and puppet hashes

c30a2f339e-+-Merge "Refactor" into production

6aed6c2324-+-Refactor

dfcc4ab758-+-Merge "Wrong file name" into production

044e1d9fa3-+-Wrong file name

4931ba894e-+-Merge "Attempt to generate RRD expression with erb" into production

f55caa9718-+-Attempt to generate RRD expression with erb

9406ca31ce-+-Merge "Actually include role::cache::configuration" into production

826d2a74a1-+-Actually include role::cache::configuration

c98e55cddc-+-Merge "Automatically generate squid list for eqiad text squids" into production

17e0aa640c-+-Automatically generate squid list for eqiad text squids

71571ce2f3-+-Merge "Add node lists to role/cache.pp" into production

3c223df962-+-Add node lists to role/cache.pp

69e1a6def5-+-Merge "add the existing index.html of noc.wm, as i changed it per bz 23004.." into production

5f5ed0c0c1-+-geoip support for stats1 per RT 2164

947b9df21a-+-ensure mountpoints exist (btw, puppet feature req. 5015)

202b0f9274-+-add class for stat server per ezachte (RT 2162), apply on stat1, rebased

3e41c6c33e-+-Fixing lvs puppet config

c3c77b4e77-+-backing out mysql from stat1 until it moves to an internal IP or something else

568543447f-+-taking stat1 out of a pseudo-analytics cluster.  reverts changes 2377 and 2378

423efd93b6-+-one more change to really make stat1 part of a 'cluster' (also some whitespace changes)

b2e974bc1b-+-adding stat1 to a db 'cluster' so it gets the percona stuff

0de28e20fb-+-Merge "adding mysql to stat1" into production

dd8cccbee1-+-adding mysql to stat1

cf70b7304a-+-Install wikimedia.css file

61de404339-+-Saving streber from its misery as a full fledged ganglia collector

d2deb6f000-+-Temp fix gmetad for torrus usage

7f61c60699-+-Setup a ganglia collector (for torrus aggregated stats) on manutius

5bef333e8b-+-Better subclassing, dependencies

25e9e07462-+-Add dependency

61449cb092-+-Torrus is now completely in Puppet

26998e6bf7-+-Add support for adding custom config lines to apache vhost configs

205479992c-+-Generate missing site-global.xml

aa77c8b9f6-+-Make sure discovery is done before compilation

b6f765e04a-+-Small fixes, torrus-discovery already does a torrus compile

3b3f5405e2-+-Simply process all .ddx files automatically

d3e360cbe5-+-Small torrus discovery fixes

9c17b4bf04-+-Fix exec name

04d4fa6e9a-+-Add Torrus automatic discovery/DDX support

1be9315fc3-+-Notify the apache service on config changes

3e999fe757-+-Fix redirect->rewrite, apache enabled sites link

6175ba4bfd-+-Fix mod perl's package name

8b7a66cfaf-+-Add standard apache modules

560a50cb72-+-Logic for mismatching apache module / deb package names

3f69794a93-+-Fix $mpm variable reference

537155e0a2-+-Fix resource dependency

fb6c33031a-+-Fix SSL certificate paths

02b5aa8964-+-Oops, two definitions should be classes

60403d361e-+-Webserver::Apache::Site[torrus.wikimedia.org] depends on package torrus-apache2

b566ab461f-+-Deploy new style apache configuration on manutius

7ad943c2ea-+-virtual_module couldn't be defined twice, so let's make module virtual instead

de231c8560-+-add the existing index.html of noc.wm, as i changed it per bz 23004..

4d3930630a-+-making db1021 a ganglia aggregator in place of 1001

519ddfb383-+-adding db1043 to s1 eqiad

de7b2f1e5e-+-Merge "Remove inclusion of nonexistant class" into production

2213b4a5a8-+-Remove inclusion of nonexistant class

804c25b8ce-+-Merge "changing swift's backend to ms5 in prep for deploying it to production" into production

744bece737-+-Disable misc::torrus on streber for now, add on manutius

297d955fbf-+-changing swift's backend to ms5 in prep for deploying it to production

0805fb0d92-+-Experimental attempt of restyling misc web server setup

24b6e147d5-+-Move misc::torrus to a separate file

0c587ba0f5-+-updated list of server for nrpe to include nagios server

0a7b3958b1-+-Merge commit 'origin/production~14^2' into test

c9fbeeead3-+-Merge "running logtailer every minute instead of every 5 for more detailed stats.  fixing typo." into production

ea8fb21214-+-running logtailer every minute instead of every 5 for more detailed stats.  fixing typo.

b701ab8f90-+-Merge "Changed xmit_hash_policy to a variable so that we can set it to any policy desired" into production

92c7dfe98b-+-wrong array

62b50e8044-+-more db upgrades

04cabd943a-+-Merge "adding http monitoring to swift proxy servers" into production

dbbdab109c-+-adding http monitoring to swift proxy servers

6d05bca97c-+-Merge "allow nagios (and everybody else) to get into swift stuff to check usage for check_disk" into production

788d1ffe8d-+-allow nagios (and everybody else) to get into swift stuff to check usage for check_disk

2a87350a6c-+-Merge "changed URL for nagios check to ms-fe to something that exists" into production

6d46206515-+-changed URL for nagios check to ms-fe to something that exists

6ac1316378-+-Merge "upgrading dbs 13,18,25,33" into production

2124b4359b-+-add nagios to iptables, enable nagios to talk to swift via nrpe

4806c348d1-+-upgrading dbs 13,18,25,33

4b1f20ae68-+-Changed xmit_hash_policy to a variable so that we can set it to any policy desired

e329233b92-+-Revert "Merge remote-tracking branch 'origin/production' into test"

8c50ffb373-+-Merge remote-tracking branch 'origin/production' into test

ebb24049ec-+-Merge "Fix indentation, modes of ganglia.pp" into production

c645a189a9-+-Fix indentation, modes of ganglia.pp

35e180cfaf-+-Merge "add account for Andrew Otto, add to host stat1 per RT 2375 (alphabetical)" into production

615da696d8-+-Merge "gmetad's init script doesn't support status" into production

6bc15fc5e4-+-gmetad's init script doesn't support status

9b7d1a2f02-+-Merge "Fix remaining file modes in ganglia::web" into production

a21928bf21-+-Fix remaining file modes in ganglia::web

c7e16f4418-+-Merge "Make gmetad restart upon config file changes" into production

a6144ec9d0-+-Make gmetad restart upon config file changes

c665ff099b-+-add account for Andrew Otto, add to host stat1 per RT 2375 (alphabetical)

28b78b2f5e-+-Merge "Assign new ganglia aggregators" into production

54a63c895b-+-Assign new ganglia aggregators

c3b9db9481-+-Merge "Decommission knsq1-15" into production

02abfb0883-+-Decommission knsq1-15

4a4efda1f5-+-Merge "simple SMS pager script as a starter, missed a /" into production

1af4b80d2f-+-It's kinda useful to know that db40 is not "just" a core db

7a3b4d4722-+-Don't run setup-aufs-cachedirs on squids that don't use aufs

bd6a490290-+-Make mount volatile readable for the puppetmaster

6604173aca-+-Merge "Add support for squid config file serving by Puppet" into production

10b2cec508-+-move kiwix mirror contents to public/other directory for mirroring

7d49cc7757-+-Add support for squid config file serving by Puppet

3734046473-+-Create a [volatile] puppet fileserver module for volatile files

30095ec2d0-+-Fully qualify manifests/swift.pp includes

3f940f6997-+-Test what was up with include squid

8976312dfd-+-Merge "Migrate swift cluster role classes into role/swift.pp with role::prefix" into production

a449ba6f6d-+-Merge "redirect http://irc.wikimedia.org to IRC meta page (currently "it works" page)" into production

46f60ec982-+-shush!

1d55b009c4-+-suppressing ganglia-logtailer messages until they're less spammy and specfiying full path because /usr/sbin is not in cron's search path

68d1121731-+-whoops, copy/paste error

4c291d8824-+-Merge "upgrading db12" into production

62f9d52741-+-Merge "adding ganglia logtailer and a log tailing module to swift proxy servers" into production

9da148246d-+-adding ganglia logtailer and a log tailing module to swift proxy servers

3ae5cafae3-+-upgrading db12

7df76e74fa-+-Merge "upgrading db24" into production

8b607959d3-+-upgrading db24

70e90b351a-+-Merge "attempting to force absolute lookup of class per mr. feldman's suggestion" into production

4fbb251e2c-+-attempting to force absolute lookup of class per mr. feldman's suggestion

a383060511-+-and fix the expression for dataset2/1001

6011d0928f-+-add dataset1001 to the dataset2 stanza in site.pp

3a0c83d0e5-+-squid class not getting included for some reason. maybe this is a workaround?

f907534962-+-simple SMS pager script as a starter, missed a /

edee07c288-+-Merge remote-tracking branch 'origin/production' into test

621c9fe43d-+-Migrate swift cluster role classes into role/swift.pp with role::prefix

68ec3b2997-+-Cleanup: remove obsolete old role classes text-squid and upload-squid

3c458d899a-+-Merge "web holder for WiktionaryMobile nightly builds" into production

c8b96fc9f0-+-Let's not convert live text squids into upload squids

a98855671c-+-Revert "Revert "Migrate remaining squids to new role classes""

782413587e-+-Revert "Migrate remaining squids to new role classes"

d0f6d265ff-+-Migrate remaining squids to new role classes

ae4b13883a-+-Merge "Migrate esams squids to new role classes" into production

eaa42cf6cf-+-Merge "Migrate esams text squids to new role classes" into production

5d84f03902-+-Migrate esams squids to new role classes

c1a4560396-+-Migrate esams text squids to new role classes

b3a380dfeb-+-Merge "Qualify all $site references in lvs.pp" into production

30032b4381-+-Merge "Remove old payments LVS service as well, rename the new one" into production

38f4ee8f69-+-redirect http://irc.wikimedia.org to IRC meta page (currently "it works" page)

d15e56e9b0-+-Qualify all $site references in lvs.pp

94e707bee5-+-Remove old payments LVS service as well, rename the new one

3a1f25301e-+-Merge "Remove old LVS services and old service IPs" into production

eaf37c489d-+-Remove old LVS services and old service IPs

86bb950182-+-Merge "Split ridiculously long lines in lvs.pp" into production

31d8796d4d-+-Split ridiculously long lines in lvs.pp

a048e8f0d1-+-Merge "GraphViz needed for Jenkins installation" into production

298801f95f-+-Merge "move puppetmaster monitoring out of site.pp into puppetmaster.pp" into production

b3cbbfad58-+-Migrate varnish cache::bits and cache::mobile classes to role::cache in role/cache.pp

344475f2f9-+-Rename squid role caches and nagios groups for consistency with varnish

4cc79f6a0d-+-Cleanup Squid monitoring

39d548d335-+-Remove old system roles, preparing for migration of role classes

da124b9f23-+-Refactor, remove duplication

3affe9adf8-+-Use a dynamic lookup for now

053782a679-+-Merge LVS changes from test into production

db5111a70b-+-Fix syntax errors

02c5ad7a42-+-Make all $realm references in lvs.pp fully qualified

ecfbe3653d-+-Simplify role::cache::squid:: by passing a hash to lvs::realserver

8f50239f95-+-Fix reassignment of realserver_ips

d725d11292-+-Make lvs::realserver a parameterized class

a4eb368a80-+-Fix swift lvs service in labs

ed5aa5adcf-+-GraphViz needed for Jenkins installation

e420739faa-+-Merge branch 'production' into test

f91dfead55-+-Add TODO

1b4d6b0c34-+-Rename service IPs to be consistent

1b71770cbd-+-Add new role::cache::squid::upload class

a34ae005b0-+-Add removal support for system roles

4bf4116bfa-+-Merge "disabling 'check-apache' command for swift since it actually checks ssh, not apache." into production

dd21fd773e-+-disabling 'check-apache' command for swift since it actually checks ssh, not apache.

5c8a4ca007-+-adding two new dbs

50cb63f030-+-adding the new package for udp-filters for diederik

2c7c5bc31e-+-web holder for WiktionaryMobile nightly builds

fa4c1ac181-+-Fix mode on /aufs dir

cb9f43ad30-+-xfsprogs is installed on all servers, in base.pp

c1ad5b1375-+-Remove usage of old wikimedia-task-squid package, do everything in Puppet

8a11deffc9-+-Fix modes, simplify file definitions

1b1a3ec232-+-Retab squid.pp

e81d975d8b-+-Test if puppet can reference hashes multiple levels deep when not using quotes

27317d7378-+-Simplify lvs_realserver_ips configuration in role/cache.pp

657b4f8ec7-+-move puppetmaster monitoring out of site.pp into puppetmaster.pp

e18ddba9d2-+-adding the puppetmaster http(s) monitoring to sockpuppet

441ca9342c-+-add https monitoring for puppetmaster on stafford (RT 2361)

c0771626ec-+-adding the IP for ms-fe to the lvs node definition so it will listen on that IP

bb3fe329b9-+-changed health check URL for swift's lvs to something small that I know exists

43a36ca676-+-Wrap true in quotes to see if it fixes the upstart job.

dffb96908b-+-adding support for other paging groups into our nagios. testing with the udp2log alerts. maybe also breaking nagios ;)

f3fb05a42f-+-adding index.html for planet test site

59ecab81b1-+-moving pmtpa swift cluster to treat upload as its backend while populating the cache

3e2b86db7e-+-adding iptables rules to allow connections to port 80 for anybody that wants to talk to swift

356f8b43b3-+-adding in accept all traffic from localhost

8dee272933-+-inserting real AUTH key for pmtpa prod swift cluster

d75527e310-+-db54 -> s2

1b01d0b6a7-+-adding cp1001 and 1002 as ganglia agregators for eqiad text squids

0242c5ca0f-+-monitoring for all core dbs

9def240408-+-Merge "correcting container name for eqiad test swift cluster" into production

e8db666f0a-+-correcting container name for eqiad test swift cluster

cb22df6778-+-Merge "adding LVS addresses to ms-fe boxen.  Removing ms-be as ganglia aggregators." into production

df7453e54b-+-adding LVS addresses to ms-fe boxen.  Removing ms-be as ganglia aggregators.

d85356ddff-+-Merge "renaming to more easily read misc::management::ipmi added in sockpuppet to role of ipmi mgmt Change-Id: I828cf708396493e413580839bc6fc1fde5314d4f" into production

4194ff6855-+-renaming to more easily read misc::management::ipmi added in sockpuppet to role of ipmi mgmt Change-Id: I828cf708396493e413580839bc6fc1fde5314d4f

62b0edd718-+-typo

d46626eaf0-+-Merge "fix typo" into production

e23c7075b2-+-fix typo

8bd57333ac-+-Merge "removing my change to site.pp" into production

2aa7594437-+-removing my change to site.pp

5d6942fe9a-+-Merge "new mysql monitoring, test on two dbs" into production

325b9c08c3-+-new mysql monitoring, test on two dbs

5f016fd1aa-+-Merge "moving all of the misc:: and generic:: webserver classes to own class" into production

dfef725e53-+-added in ipmi mgmt host misc to sockpuppet

10f51ce6fc-+-Merge "upated added new simple shell script for ipmi mgmt updated Change-Id: I33e6afa9b9d34e8bead610f7a2d4cb713065b88b" into production

cdb0707ce0-+-moving all of the misc:: and generic:: webserver classes to own class

5871713e4e-+-Merge "moving tampa swift cluster from test to prod configuration" into production

23b41a91a3-+-moving tampa swift cluster from test to prod configuration

e31faac123-+-adding mysql::packages to storage3's config, plus a comma so puppet stops chundering

3d4c9a7dde-+-upated added new simple shell script for ipmi mgmt updated Change-Id: I33e6afa9b9d34e8bead610f7a2d4cb713065b88b

ad2dac8baf-+-upgrading mysql on db37

aba7b35b05-+-Merge "Work around Puppet bug" into production

8797677522-+-Work around Puppet bug

4779c5fdab-+-Merge "Fix variable name" into production

e19eb08d81-+-Fix variable name

ff0ff1e0f0-+-Merge "Copied text-squid role class into role/cache.pp, renamed to role::cache::squid::text" into production

cc9e82cd02-+-Copied text-squid role class into role/cache.pp, renamed to role::cache::squid::text

a5aeb35d81-+-Merge "Added eqiad service IPs for lvs realservers" into production

97c3d724a4-+-Added eqiad service IPs for lvs realservers

5bbf78490a-+-trying a second port

6fce97b105-+-snapshot db32

fc213f6c6d-+-copy/paste error

d90414c023-+-trying moving the git clone to last

b88a734288-+-fixing software repo for puppetmaster in prod

815afa19e4-+-snapshot db26

69d60c17d2-+-Merge "put in a default so things don't break on new servers" into production

26d025ab24-+-put in a default so things don't break on new servers

bdf3293e27-+-Merge "Make test puppet repo act like production (pull from git)" into production

b595ab377c-+-Make test puppet repo act like production (pull from git)

457c87f979-+-Merge "nagios monitoring group and also some realphebitizing" into production

0890a4eb99-+-nagios monitoring group and also some realphebitizing

3d51875543-+-Add platform support for Dell PowerEdge C2100 in base.pp

84fd761387-+-Fix purge exec

7c8b770e0b-+-Merge "first stab at getting ms-be into puppet" into production

9c0b97da18-+-Merge "adding cp1001-cp1020 as text squids" into production

31621eddd8-+-first stab at getting ms-be into puppet

b28a3dab7c-+-adding cp1001-cp1020 as text squids

98ea78783b-+-changing nagios service to nagios3 service

a41e3e5992-+-Removed payments file from labs as no payments cluster

9c62218fad-+-restoring odl nrpe.pp to pre-merge state

42a76dda35-+-Merge "thread_pool_max was way too high (setting changed meaning in 3.0, became max * pools) try to catch backend failures quicker and better serve stale content mobile frontend probes now test backend varnish, not apaches" into production

4ddac4412d-+-configuring lvs to front swift

9ee94d012c-+-thread_pool_max was way too high (setting changed meaning in 3.0, became max * pools) try to catch backend failures quicker and better serve stale content mobile frontend probes now test backend varnish, not apaches

53c79f6fbc-+-Merge "Revert "addingin cron job to sync software repo in labs"" into production

679653742f-+-Merge "Revert "Pushing labs configuration into the main config module + making labs mirror the prod puppet repo configuration"" into production

927bad9234-+-Revert "addingin cron job to sync software repo in labs"

0c458d837c-+-Revert "Pushing labs configuration into the main config module + making labs mirror the prod puppet repo configuration"

7e177b6306-+-Revert "removing conflicting apachesite definition"

b17f4b2bb8-+-removing conflicting apachesite definition

b0df93ae0c-+-Merge changes I7af8a214,Ia6969d0b into production

0fd2b1714d-+-Pushing labs configuration into the main config module + making labs mirror the prod puppet repo configuration

bdde079a7c-+-moving db26 from s1 to s7

40b73378cb-+-creating configs for the production swift cluster on ms-fe1 and 2

a3949ca59c-+-moving swift passwords from the public to private git repos

4849d66ad6-+-addingin cron job to sync software repo in labs

2d568043d1-+-Adding in the sw repo as well as making it available via fileserver.conf

f2cfa030d0-+-Merge "Adding in the sw repo as well as making it available via fileserver.conf" into production

468d98ba0c-+-Adding in the sw repo as well as making it available via fileserver.conf

acff90b7f9-+-rethinking db26 as a snapshot host

52ce7c2b07-+-rebuilding db26 - enwiki pmtpa snapshot host

360fd8fcb4-+-move db43 to fully puppetized mysql conf

5830f50e17-+-db43 -> s6

ba4abe706d-+-hmm, guess I like */5 better

fecc7d5484-+-clean up tmp on imagescalers more aggressively

4c498667c9-+-Merge "invalid param :/" into production

2da7ec531e-+-invalid param :/

8d66986d8c-+-more servers to decom

3fb5ac5745-+-some cleanup and adding diederik/analytics group to alerts for udp2log

7b0785e9b5-+-adding check commands for udp2log. if this works correctly, I will add a contact group for consumers of this who have shells

7d781e9f68-+-Merge "gallium: allow postgre restart" into production

66990d5846-+-Fix nrpe issue

8dec120819-+-One more bad merge fix.

f1b29cc336-+-Another fix for a bad merge

35960a877c-+-Removing duplicate package definition after incorrect merge

1647e6bb5b-+-use all servers in srv250-257 range for memcached

d0a60dcb58-+-Merge "Merge branch 'production' into test" into test

accc4f07b6-+-Merge branch 'production' into test

01cd2202c0-+-Add atop to all servers

f0f0f56b04-+-changing created file name in firewall.pp

7bbc93a425-+-nesting exported acl rule inside open_port definition

897204305c-+-reordering resources in firewall.pp

bb5b8115e2-+-creating test case 1 for firewall creator

b4a83c7865-+-Merge "changing file resource to a definition and making hostname automatically configured from facter info" into test

782f28a72f-+-changing file resource to a definition and making hostname automatically configured from facter info

8c6996cf80-+-Ensuring this returns true

a227206b28-+-This dependency is needed

2563022ca7-+-Only add jenkins user in production

7018648c90-+-Explicitly pin the Wikimedia version of php-wikidiff2 to prevent problems in the future

bb0b7b1444-+-trying test class 2

d272416d72-+-fixing file name

156b000c7f-+-fixing title

faf3eef360-+-fixing title again

c2dfd7e3cf-+-fixing $title

7f134ec0ca-+-adding firewall testing

148d9da216-+-trying to create a firewall auto exporter (v1!!)

2f65091d7e-+-updating AUTH string for a newly created account for the eqiad swift cluster

df655a9c52-+-Merge "fix path" into production

420b2d9aa6-+-adding in the bonding xmit-hash-policy to interface commands

02c1e8d264-+-fix path

e74f6a5222-+-Merge "running pt-heartbeat daemon on core cluster dbs" into production

7d19fd72e8-+-running pt-heartbeat daemon on core cluster dbs

29956d2767-+-Merge "Changing default bonding xmit_hash_policy to layer2+3" into production

7dd1658e1a-+-Changing default bonding xmit_hash_policy to layer2+3

b34b87e479-+-ensure nrpe.d directory exists

f1c7d3f1d2-+-attempt to fix db22 puppet breakage

18a552f6d5-+-adding sharding to proxy config, sharding two containers in the eqiad cluster

5f0cab66b2-+-root .my.cnf on all cluster dbs

69b4b553b3-+-Merge "Making ipv6 enabled or disabled per domain" into production

a11919ea14-+-Making ipv6 enabled or disabled per domain

16661a5516-+-em.. the new snaps are at equid, add to regexp in site.pp

6981058667-+-add snapshot1001-4 to site.pp and to download exports list

38cc91ad07-+-removing extra frontend cache capacity from mobile

4379de2f29-+-Removing virt1.wikimedia.org and adding virt1.pmtpa.wmnet

19bb6b2c31-+-adding db52/53 to s1

15973cf192-+-upgrading db32

e1148210d4-+-Merge "db36 is now the s1 master" into production

244317912d-+-db36 is now the s1 master

78f736a249-+-Merge "Adding diederik to stat1" into production

82a26f41b8-+-Adding diederik to stat1

13a14e1980-+-fix typo for db36

9bb55eb53b-+-puppet is being tricky about overlapping node defs

fed66a2308-+-fix regex

3a950f2af9-+-preparing to upgrade two enwiki db's

06a978a7fd-+-adding in curl package

5270ba22ab-+-Disable holding all mail on sodium

71b98c8434-+-gallium: allow postgre restart

71555fb7e9-+-this adds cp1039 and cp1040 to the varnish backend pool (add to pybal conf to also add frontend)

a7fd43da44-+-"fixing cp hosts so they will properly alert"

24d2e5d3e3-+-for comrade robh

8f99b5b7de-+-another var fix

eb9de1eb32-+-fixing var

a7fb868a57-+-Merge "use mod_rpaf on blog server" into production

3d7696b37e-+-use mod_rpaf on blog server

dea30b45c0-+-reverting everything

f061642bbe-+-another ganglia test

f2911670bb-+-tryuing to see where ganglia chokes

c2ca322d18-+-trying to put machine in multiple clusters

9c0a58917f-+-testing puppet to make multiple files

159afa96e6-+-Revert "Seeing if puppet will autogenerate differently named files"

b896296402-+-Seeing if puppet will autogenerate differently named files

24e75d2ef0-+-Merge "fixing ganglia-monitor permissions" into production

ce588bc2a4-+-Merge "blog: swap varnish and apache between ports 80, 81" into production

4344542149-+-blog: swap varnish and apache between ports 80, 81

aae2418e83-+-Merge "reorg probes to prevent error on unused bits probe" into production

43996b666c-+-reorg probes to prevent error on unused bits probe

f8abf7fe00-+-Merge "Adding support to modify memcached's bind ip, and adding memcached to marmontel" into production

dacdb7f716-+-prep for throwing varnish in front of single server blog

b277f51e20-+-Adding support to modify memcached's bind ip, and adding memcached to marmontel

662527e0e3-+-adding file_mover@emery to logmover account class (used on storage3)

e069958b8e-+-try out planet-venus package in labs

a7af0313c3-+-testswarm: explicitly set cron schedule

3104618116-+-testswarm: job to wipe clients idling

2ca43be35e-+-Adding blog to marmontel and allowing .htaccess in blogs

540b1331ad-+-Fix nrpe.pp

6e0dbd3ac2-+-script to determine the sever_id of the top master in any cluster

0479abdcfd-+-fixing ganglia-monitor permissions

8ad94f4c8e-+-adding in aggregator class to ganglia1001

2595303f4b-+-adding in startup script so that gmond can start up multiple instances

efe34d520a-+-Merge "Fix mchenry's ldap client config" into production

e22b84832f-+-Fix mchenry's ldap client config

7a6ac2c8c6-+-Fixing cp1044

1e91d94dde-+-Merge "changing match condition for ganglia_aggregator" into production

2feb7c847c-+-changing match condition for ganglia_aggregator

beef0b7983-+-Making virt0 the new controller. Moving all nova config to point to it.

b31fc55516-+-further cluster def cleanup, write a marker file on dbs

7f9351752f-+-Merge changes If1814965,I59860ce9 into production

bc5b2e6599-+-separating out the cp machines to make them try and realize they are collectors

d04bee3a2a-+-Fixed some formatting and ensure gmond.conf present

3d7e773084-+-Notify service exim4 on config changes

d99b88716d-+-Enable v6 for outbound as well

502f4349e1-+-Add IPv6 service IP for lists.wikimedia.org on sodium

e3cee9724b-+-Rename relay_domains file

6a0960a736-+-Add exim::roled class documentation

02d13e0377-+-Ensuring this returns true

712c2faa46-+-This dependency is needed

5d4b85a447-+-Merge "Making virt0 the new controller. Moving all nova config to point to it." into production

0b6bde0efd-+-Making virt0 the new controller. Moving all nova config to point to it.

51ba34f9bd-+-Merge "Decommissioning mobile2" into production

f7d3a70a63-+-Decommissioning mobile2

696ca9064d-+-mysql conf reorg, define clusters and masters for all prod clusters

d5ec954489-+-Merge "Revert "mysql conf reorg, define clusters and masters for all prod clusters s1-7" - var scope issue" into production

f168939288-+-Revert "mysql conf reorg, define clusters and masters for all prod clusters s1-7" - var scope issue

25a612385b-+-Merge "mysql conf reorg, define clusters and masters for all prod clusters s1-7" into production

ba0d59e112-+-mysql conf reorg, define clusters and masters for all prod clusters s1-7

841f97e164-+-putting ganglia1001 in puppet

6b1f12420b-+-Decommissioning mobile1

26c84ac2a0-+-Merge "adding khorn shell access to storage3" into production

1ba6a68c66-+-adding khorn shell access to storage3

de0652a066-+-install percona nagios scripts on all dbs

04cf86a422-+-install percona-toolkit on hardy db's

33b0e0a1cc-+-adding shell access for diedrik rt 2256

1d6190b655-+-and include the pw class

3001b68e06-+-fix password scope

766dc7f497-+-remove duplicate file definition

e1e28558d3-+-Merge "require lighttpd to be installed before mailman" into production

5b1cf2df83-+-require lighttpd to be installed before mailman

bba02f0991-+-Merge "include network::constants" into production

6ebe8dc60c-+-include network::constants

ccabd6470d-+-Merge "Convert spamassassin's local.cf to a template" into production

2380053d97-+-Convert spamassassin's local.cf to a template

614817d835-+-offhost backups crons, adjustments

a84b9f3587-+-removing stale root@grosley ssh key

29d40da54b-+-adding root@grosley's key to logmover authorized_keys

c3237c34f9-+-Merge "adding one-size-fits-all offhost_backups script for aluminium, grosley, storage3" into production

66248ebcf7-+-adding one-size-fits-all offhost_backups script for aluminium, grosley, storage3

5b185e0505-+-Merge "Install files in web docroot" into production

e077b4538d-+-Install files in web docroot

a803a9c312-+-Merge "Install a DNS recursor on sodium" into production

bebe073750-+-Install a DNS recursor on sodium

331cbe1346-+-Merge "Add quotes" into production

bcc2f626c4-+-Add quotes

50a29095c1-+-Merge "Simplify test again" into production

d5ed40c374-+-Simplify test again

1d61313d8b-+-Merge "Attempt to get the debconf test to work" into production

eb9d3ad922-+-Attempt to get the debconf test to work

329731bc76-+-Merge "Add newline in comparison string" into production

8e279fc6c6-+-Add newline in comparison string

1db0cafb38-+-Merge "Correct mailman default_server_language" into production

a50400b9cd-+-Correct mailman default_server_language

b3b7e9c2cf-+-Merge "Use the noninteractive debconf frontend" into production

fb8d5604ac-+-Use the noninteractive debconf frontend

2004e2a406-+-Merge "Escape value var" into production

9020c8ae53-+-Escape value var

feacbb1010-+-Merge "gallium: allow postgreSQL administration" into production

452283912e-+-Merge "Install all Mailman languages" into production

5885e21330-+-Install all Mailman languages

3abee1bde7-+-Merge "Add generic::debconf::set definition for preseeding" into production

ae866cc5f1-+-Add generic::debconf::set definition for preseeding

2d65067c76-+-install just the new mysql check files on eqiad dbs

79da563ace-+-changing traceroute-nanog to traceroute due to perm issues

7c151e3b6f-+-Adding in traceroute to bastion hosts

16e8a71226-+-gallium: allow postgreSQL administration

d7926d0137-+-user class for dartar + adding to admins::restricted

412b4cf9e8-+-Enable CGI module for Mailman

5528762df2-+-Use a service IP for lists.wikimedia.org

ed80bfaece-+-Fix private file path

3dcdc89365-+-Puppetize htdigest file

a3d09c453e-+-Hold all mails on sodium for testing

a17ce0e53b-+-Add hold_domains class parameter for easier debugging

d1b7e5e608-+-Use private key file which also contains the public SSL cert

4dda36da1c-+-special.cfg was removed a while ago, do not require it any longer, broken dep.

495cd1f328-+-add the nagios apache site config as it is now and enable it

acef06165e-+-changing name of ganglia redirect making the tmpfs mount puppetized

6360c98a46-+-use varnish 3.0.2 on all hosts

aefea28d4c-+-varnish3 pkg wants to restart with the varnish3 init, while puppet installs to just init.d/varnish breaking pkg upgrades on hosts that reference geoip libs in their vcl this is a hackish workaround that should work on a second puppet run, until the pkg is rebuilt

f61a848cd3-+-testing varnish 3.0.2 on cp3001 (esams bits)

3cb9a500a9-+-testing new varnish on cp1043

28ff4b1ced-+-fix HTTP monitoring on noc.wm / fenari (RT 2218)

3beda0da6e-+-wikistats - remove unneeded exec and fix some tabs

328f47a9e2-+-mariadb - add a check if realm is labs, dont setup repo otherwise

a50bb1e117-+-Adding generic check for user's last edit time + adding 2 checks for the bots-cb server along with some package requirements.

cb873e36f7-+-Enabling ipv6 proxy on ssl3001 to re-enable upload ipv6 proxy.

1dd0091626-+-removed statically spec'ed cluster from nickel

52d692a46b-+-upgrading db22 to new pkgs / fully puppetized config

1a69dd56b2-+-db51 -> s4

b94800eaaa-+-For the last time, fixing my public key. I swear this is it. (With a new comment too)

dbb32405da-+-Fix my public key, was off-by-one

681cde04b1-+-require Class varnish::packages, instead of Package[varnish3] in Mount, because this broke puppet fe. on sq67

978ceeff7c-+-fixing type in ganglia.pp

af6e331cdb-+-Merge "Puppetizing ganglia and gangliaweb Puppetizing automatic saving and restoration of rrd's from tmpfs to disk Modifying gmetad startup to import rrd's" into production

4af9379de4-+-Puppetizing ganglia and gangliaweb Puppetizing automatic saving and restoration of rrd's from tmpfs to disk Modifying gmetad startup to import rrd's

f0cd0a99b7-+-putting backend instances of new mobile varnish servers into production

5631b552ce-+-fix for varnish pkg testing

0b7817d13c-+-test new varnish pkgs on mobile cp servers out of production

ff2f4b6fd8-+-Make a ganglia cluster for the virt cluster.

811240bcc9-+-Adding requires to all services.

ef40997129-+-We aren't using nova-volume right now, and it throws errors since it's not configured. Remove it.

3ed803f4c2-+-Adding requires to all services.

6bc9e1ac7a-+-adding in rrdtool to ganglia::web

2116c52462-+-We aren't using nova-volume right now, and it throws errors since it's not configured. Remove it.

19eb006fdd-+-Adding in ganglia apache file temporarily using nickel.wikimedia.org in file for testing purposes

1e9eb9febf-+-install percona-nagios-checks in the right place, add nrpe template

729b5d12d0-+-Clean up banner content

c14e56c908-+-refactoring banner impression log handling scripts for easier maintenance

ce4e27d717-+-Adding in a pre-login banner for labs

c50796401f-+-Adding in a pre-login banner for labs

f20455d9b5-+-Merge "Add Apache Maven to gallium" into production

0ea9e11e7b-+-Merge "class to install Apache Maven" into production

7c6f27b731-+-Merge "Fixing ganglia web installation on nickel" into production

cc45dd7484-+-Fixing ganglia web installation on nickel

1bd89243ba-+-puppetizing impression log collection scripts

23abd8541a-+-Updated IP address for upload-lb on ms6.esams

2c966faa2c-+-Creating ganglia frontend class, gmetad.conf added

47276b1d71-+-Adding in gangliaweb class and putting on nickel

f4cb57c68f-+-Add Apache Maven to gallium

6a5192d3d8-+-class to install Apache Maven

efd2c906ca-+-Merge "give sudo access to khorn on grosley/aluminium per RT 2196" into production

24e1aeee51-+-fundraising mail config for aluminium/grosley (typofix)

c72ab0b5b7-+-give sudo access to khorn on grosley/aluminium per RT 2196

f733378013-+-puppetizing fundraising jenkins maintenance cron (oh the irony) scripts typofix

affbb58a82-+-job_queue: tweak retry check interval

d79b0ce4e4-+-moving misc::fundraising out of misc-servers and into its own file

41f4d9bbcc-+-do not install index.php via puppet anymore - fix permission exec

e1ca4d7d8f-+-add an exec to ensure file permissions in doc root

f6a4a55773-+-do not require generic::mysql::client - this removes MariaDB now

261caeba2c-+-wikistats - get php5-mysql from generic class

1ff1ce6fa3-+-minor fix in system_role for MariaDB repo

e41896c91e-+-configurable version for MariaDB - different approach

8926561efb-+-add SSLCACertificateFile to Apache config for valid SSL certificate chain

57685ec357-+-%s in this context is the short hostname, not the FQDN. This causes a certificate error.

b3a92722ee-+-Work around upstart_job's failure.

7f5f5f0d13-+-Weirdness with -'s?

265e8c562a-+-libvirt-bin's upstart script is rediculous, and doesn't let you change daemon options in the default file. So, let's update it's upstart to appease its stupidity.

a3ff1f3f68-+-Missed .key in the location

98c461f6a2-+-That's actually libvirt-bin

a2d48af08f-+-Add libvirt as a service so that we can notify it on config file change.

60890356b3-+-Enable libvirt tls remote access

16f268f00d-+-Install hostname certificate on compute nodes

e66ace782b-+-added conf file for fundraisingdb dump script

04b4e731b8-+-Merge "added role::db::fundraising::dump class and applied to storage3" into production

b1f26a5fe5-+-added role::db::fundraising::dump class and applied to storage3

43acb41ace-+-Update for diablo

47af2b552b-+-Adding initial live migration support

6a0784f3ac-+-attempting to establish a role class and start by moving fundraising db stuff there

d5c10b4cfb-+-Merge "mariadb: set version in subclasses, require classes with package" into test

4c7cefb7e1-+-mariadb: set version in subclasses, require classes with package

d909e7cad1-+-Merge "mariadb - put repo setup into it's own class, require that for package installs" into test

c5e7940e3c-+-mariadb - put repo setup into it's own class, require that for package installs

fbecdf4551-+-Merge "mariadb - subscribe apt exec to sources.list file" into test

8c0ab2257e-+-mariadb - subscribe apt exec to sources.list file

364e221f7c-+-Merge changes Ia272411d,I0834ad89 into test

a577d4d191-+-wikistats - fix apache server names and ssl certs

dd1b17ccce-+-fix duplicate definition of monitor_service for mobile traffic loggers

4e4c0c74cd-+-add nrpe to tarin and cp104[1-4] for process checks

3362588348-+-nagios proc checks - use nrpe commands, this just seemed to work..duh

306b7a95de-+-additional generic check_procs with -C option & fix "mobile traffic logger" checks

cedba4da4b-+-Adding ssl-cert package, so that the ssl-cert group will exist.

503b535b28-+-Removing star from planet as it is already defined

082748c1b7-+-class to install percona nagios monitors (just the files so far)

981105097d-+-Ugh. How do I keep getting this wrong? Actually hash to the location.

708657295e-+-Adding missing .pem

eeb9ca7a50-+-I had versioncmp flipped...

570105c951-+-fixing purge rule

7df0e8aff5-+-Re-adding localhost allow rule to iptables for udp2log machines

26627ad385-+-Revert "adding in accept all from localhost to logging fw"

366690d67d-+-adding in accept all from localhost to logging fw

0011b1c0e1-+-add MariaDB for labs

47da6b9c89-+-Merge "that way the variable aren't expanded in the template anymore" into test

bfdc7fc316-+-that way the variable aren't expanded in the template anymore

63a3117f14-+-Merge "style fixes per guide - single quotes, represent file modes as 4-digits and quote them, ensure attribute always first.." into test

e23ea30af8-+-style fixes per guide - single quotes, represent file modes as 4-digits and quote them, ensure attribute always first..

510726a8d2-+-Merge "add an initial index.php for wikistats, require dir, indent one more level,.." into test

bdc3703b57-+-add an initial index.php for wikistats, require dir, indent one more level,..

c2f702f5ef-+-Merge "fix file path / syntax error, this is not a template" into test

cf06e1664e-+-fix file path / syntax error, this is not a template

96244d1035-+-Merge "now use that ports.conf on wikistats instance" into test

ed903944cb-+-now use that ports.conf on wikistats instance

b47a666cd1-+-Merge "disable apache_site 000-default" into test

f26b919d63-+-disable apache_site 000-default

170973fa38-+-Merge "load Apache rewrite module" into test

a81e384c4a-+-load Apache rewrite module

129665d5c2-+-Merge "remove Service[apache2] - duplicate definition, already in generic class" into test

f1ffc6ce4a-+-remove Service[apache2] - duplicate definition, already in generic class

de8c651687-+-move varnishncsa monitoring to cache::mobile, combine mobile cache node defs

4e0b840771-+-specifying source of 0/0

f922e729c0-+-Changing source => all to blank

aca538d097-+-Merge "adding in UDP iptables service" into production

0f9dbe40df-+-adding in UDP iptables service

16fe985853-+-add mysql::packages to a db40-43

f5aa36b5c3-+-Merge "Moving all logging types of servers in new file" into production

fb0654ae8f-+-Moving all logging types of servers in new file

a7ded72c9f-+-Merge "making owa storage bricks for containers to test" into production

87ecb89f75-+-making owa storage bricks for containers to test

b92cf5b1df-+-Removing my borked ganglia-webfrontend package from the server

bf3a0a53da-+-Merge "Disable reporting because Puppet Dashboard ain't web-scale." into production

fb28bd5d38-+-Disable reporting because Puppet Dashboard ain't web-scale.

c7738047b3-+-fix db writeable assignment for research db's

4eb9788eaa-+-do not use /home/ for home dirs, it's bad practice per Ryan

1d284a3b0f-+-upload doesn't accept domain upload.pmtpa.wikimedia.org, so use upload.wmorg instead

a6e0f2c3db-+-Try if fetching from the squids instead of ms5 is faster

a40ae683e2-+-Merge "bug 33301, bad SSL cert at integration.mediawiki.org" into production

38b3044230-+-Up the version of the instance scripts.

93f6626e2e-+-Merge "swithcing to bash logic for binasher" into production

4832f40b08-+-swithcing to bash logic for binasher

747e2e04fd-+-Merge "adding recommended tcp settings to swift hosts." into production

ad1c2517ec-+-adding recommended tcp settings to swift hosts.

476de9d95e-+-fix template name for varnishncsa.init

a24859b691-+-Merge "adding udplogging capabilites for varnish mobilez" into production

8d77aec104-+-adding udplogging capabilites for varnish mobilez

4c62ea2783-+-Set proxy worker count to 2x # CPU cores

c9d00d7dd1-+-Fix paths

3e2f00d42c-+-bug 33301, bad SSL cert at integration.mediawiki.org

da07514b78-+-Restart swift processes on config changes

367c5aa06d-+-Experimentally raise worker counts on account/container/object servers to processorcount

ea95c6831c-+-Template swift storage server configurations

e44fa7ad52-+-allowing swift hosts to hear their peers' multicast traffic

9fc161517e-+-initial wikistats class for labs instance

808ee84abf-+-Allow gmond access

4b14bb98a1-+-Setup ganglia aggregators for swift clusters

2050112556-+-Create separate Ganglia cluster(s) for Swift

625d043da6-+-testswarm-checkouts.conf is not needed

73ae701184-+-testswarm: fix /etc/testswarm permissions

3309254f50-+-testswarm: make sure we have a system user

6dfc276d1b-+-Merge "planet - use star.wmf ssl cert, move to own file, remove hard-coded IP, add locales" into production

b22c0eee67-+-Merge "gallium: avoid duplicate sudo_user definitions" into production

457d243122-+-gallium: avoid duplicate sudo_user definitions

2ffbc3ebba-+-Merge "move misc::bugzilla::crons to misc/bugzilla.pp" into production

c3233ef4f6-+-script to fetch mediawiki + puppetization

1d5e909b14-+-enable testswarm on gallium

92e8845f71-+-Merge "nightly mobile build dir was duplicated" into production

ab510cb901-+-Merge "make the process check on mobile traffic loggers a bit more relaxed" into production

05fe04969a-+-nightly mobile build dir was duplicated

9d4d4831a5-+-make the process check on mobile traffic loggers a bit more relaxed

9ffdd4fc3d-+-Attempting to fix l10nupdate on the image scalers. Everything in the mediawiki-installation dsh node group should be able to get LU updates. Hume is also broken and should probably be in applicationserver::home-no-service, but I'll leave that for another time.

ff556c5da5-+-Merge "WikipediaMobile: add css/html for nightly builds" into production

2e18c3b076-+-new class for misc::maintenance stuff, cronjobs for hume typofix: semicolons to commas

943162ea83-+-planet - use star.wmf ssl cert, move to own file, remove hard-coded IP, add locales

062c2c6b79-+-process monitoring for mobile traffic loggers

f764cca487-+-WikipediaMobile: add css/html for nightly builds

21149507d7-+-Create WikipediaMobile/nightly parent directory

99b042df9e-+-move misc::bugzilla::crons to misc/bugzilla.pp

597003411a-+-comment about ant => latest not being latest ant!

06fce80b8b-+-Merge "generic::packages::ant18 to ensure we have ant1.8" into production

fde0b188d7-+-new pmtpa dbs

8a9ecbddbb-+-Included check_ram.sh to nrpe

167bbeda60-+-Inserted ram check to nagios

b6c91dee7b-+-Revert "install new mysql pkgs on db9/10"

98b1a5ce3c-+-install new mysql pkgs on db9/10

94e7c9be94-+-generic::packages::ant18 to ensure we have ant1.8

1cff050be6-+-make service retry and check intervals configurable - still missing a line

2a34f77bf8-+-Merge "blogs - consistent class names" into production

6451de340d-+-directory to host WikipediaMobile nightly builds

f0df66e0ee-+-basic class to install Android SDK prerequisites

ab9f27f7cd-+-Merge "Put mysql::client in its own class, and install it on bastion hosts too." into production

e4c46aa403-+-Merge "Fix for r1516: also remove files from manifest" into production

c61da0ef1f-+-Merge "move misc::contint::* to misc/contint.pp" into production

71856572ea-+-Put mysql::client in its own class, and install it on bastion hosts too.

6e70dc9e71-+-Remove stray slash

fe9f6a0ee4-+-Fix for r1516: also remove files from manifest

fd69398957-+-fixing up ganglia.pp

c1c05da953-+-move misc::contint::* to misc/contint.pp

b7925be5dd-+-setting real auth tokens for pmtpa test cluster

e532a8cdd3-+-Merge "correcting copper and zinc's swift class" into production

0a82e60b9d-+-correcting copper and zinc's swift class

a8d23f1cd0-+-Merge "pulling out some of the inheretence and default + override stuff in swift config due to puppet bug 6539" into production

dfddff45f7-+-pulling out some of the inheretence and default + override stuff in swift config due to puppet bug 6539

1bd7ea428f-+-Adding libswt into jdk bundle for android development

c1603b51e3-+-blogs - consistent class names

124bdc296e-+-do not include nagios-plugins-basic here as it conflicts with class "nrpe" - real fix should be to have "nrpe" and "nrpe-light" or something, then

0abe247b0b-+-fully puppetize check_job_queue with custom check interval

af78d79cca-+-Merge "Fold interface_setting into interface_offload" into production

44009d9ee3-+-Fold interface_setting into interface_offload

a7c6cc5b7d-+-Merge "add secure.wm apache site_config + basic puppet class, add proxy and proxy_http modules, fix tabs, move to secure.pp instead" into production

94857f733c-+-Escape the dollar sign

175abe63c5-+-Remove superfluous ethtool -k parameter

f1036bc4cb-+-add secure.wm apache site_config + basic puppet class, add proxy and proxy_http modules, fix tabs, move to secure.pp instead

c8c43c58f4-+-Fix syntax error

abfd72720c-+-Enforce interface gro offloading in Puppet

276d35ece2-+-Merge "First step in cleaning up site.pp: folding node entries" into production

462700d1f4-+-add outreachcivi to outreach.pp

de0c291134-+-sure, fix class name in system_role and rename wikimanias.pp to wikimania.pp

28e97659fd-+-merge contacts.wm into a single apache config as well, move from misc-servers to outreach.pp, fix tabs, admin email

65dfa0e0d7-+-First step in cleaning up site.pp: folding node entries

797f17259c-+-wm09schols, wm10schols, wm10reg apache_sites,rebase, move to wikimanias.pp, nicer class name structure, fix admin email

aa738843b0-+-Merge "add ocs.wikimania2009 apache_site configs - and basic puppet class - move to wikimanias.pp (wikimania special sites)" into production

24bdfc4430-+-add ocs.wikimania2009 apache_site configs - and basic puppet class - move to wikimanias.pp (wikimania special sites)

23e0b1439f-+-fix apache_site name of techblog

94ff815f8f-+-move blog.wm to blogs.pp, together with techblog - remove duplicate apache_site in techblog after merging configs

7f5cf0d25d-+-Merge "add techblog apache_site configs - rebased - move to /misc/blogs.pp" into production

583709c16d-+-add techblog apache_site configs - rebased - move to /misc/blogs.pp

061eb0cd57-+-Adding in sun JDK to contint servers

ecde7a2e0a-+-I swear, this is the last commit for this. If not, you'll find me hanging somewhere.

13cff25b29-+-Fix typo. Please kill me now.

d22eac924f-+-Put this in the right spot, this time

7f999c56c7-+-Adding hack for array in ldap

74d46736ca-+-lvs for labs #5.

b3f9583d46-+-lvs for labs #4.

0686866f36-+-Third attempt at lvs for labs.

8bf37462ab-+-Second attempt at testing lvs for labs.

6397c606c4-+-Testing lvs for labs.

6bb9adff8c-+-Merge "Testing lvs for labs." into production

9dd54420b7-+-Testing lvs for labs.

96e299d4f4-+-Making planet.wikimedia.org owned by puppet

61175eaec1-+-Merge "start minimal bugzilla class, move to own file, existing bz config, fixed tabs" into production

40913bc2ba-+-Merge "can we have nagios-plugins-basic installed on all monitoring::hosts via base?" into production

2e9cef5bfc-+-Remove useless $roles variable

130e7f61b5-+-testwarm: append cron output instead of replacing

6feb8dcf2b-+-Fix requirements, Definition[] does not work

9311e068fe-+-Get rid of the noop hack by using virtual resources in swift::proxy::config

8337bec86b-+-Correct class inheritance syntax

7653ca5774-+-Ensure no one has root on bastion instance

9688a07304-+-filling in the last of the variables with a placeholder, overridden elsewhere

954d3eda04-+-adding default proxy address, overridden later

ed7a607588-+-My proposal for handling swift configuration with role classes

b1183f6d08-+-testswarm: only provide a sample .ini file

aa5a92f051-+-start minimal bugzilla class, move to own file, existing bz config, fixed tabs

831d057c3d-+-can we have nagios-plugins-basic installed on all monitoring::hosts via base?

ec18adab9e-+-Merge "handle locales via puppet" into production

1897204aa7-+-handle locales via puppet

4f15a00704-+-Merge "Rename varnish3 classes to varnish" into production

85273a62d2-+-Revert "Move misc::contint into its own file under misc/"

88676d0df4-+-update testswarm fetcher and fix installation

33f213fe6a-+-Move misc::contint into its own file under misc/

f6849399d2-+-First pass at organizing misc-servers.pp as individual files in misc/ RT #720 Used misc::bastionhost as a proof of concept (rebased with one minor doc tweak)

4c53a3ab71-+-Rename varnish3 classes to varnish

9135d2a423-+-Merge remote-tracking branch 'origin/production' into test

d60c8e3932-+-Merge "make check and retry intervals configurable via monitor_service" into production

56c064f52c-+-Merge "Make sure the old l10nupdate cron job is really removed." into production

aece68b331-+-Merge remote-tracking branch 'origin/production' into test

e263a06d81-+-gar, wrong file location

933258b774-+-install collect_exim_stats_via_gmetric on misc::fundraising servers

e9689040b3-+-Merge "trying to get rid of the global variable" into production

6a37b60dcc-+-trying to get rid of the global variable

490b495054-+-Merge "backing out just the memcache servers to a local varibale" into production

5236f96443-+-backing out just the memcache servers to a local varibale

039f52fd64-+-Merge "Created a hash with all the variables necessary for a swift cluster. Passed this hash around so various templates will have access to it. Changed the templates to read from the hash rather than plain variables." into production

e22bf1380e-+-Created a hash with all the variables necessary for a swift cluster. Passed this hash around so various templates will have access to it. Changed the templates to read from the hash rather than plain variables.

d5f07e02e7-+-Merge "adding https to noc.w.o" into production

8c1c8aea32-+-adding https to noc.w.o

46e6659b59-+-db48 is now a masterdb48 is now a masterdb48 is now a masterdb48 is now a master

8a224112a8-+-also populate /srv/org/mw/integration

419902efc6-+-integration.mw.org use a new subclass now

846d711820-+-turning ms1-3 and owa1-3 into swift nodes

6944062c14-+-modifying ganglia web

da68486530-+-enabling DKIM and bounce collection for aluminium

1ec48213ff-+-integration.mw.org is commont to jenkins/testswarm

74721ca3a8-+-testswarm www conf now depends on integration.wm.org

a0624cb4ea-+-Merge "Creating a ganglia::web group for the frontend" into test

16af5f6c00-+-Creating a ganglia::web group for the frontend

4a260b214b-+-Merge "Fix group of lighttpd files" into production

75e918437c-+-Fix group of lighttpd files

7000098675-+-Merge "For some reason lighttpd_config won't install..." into production

8e20785e46-+-For some reason lighttpd_config won't install...

24e5ae0866-+-Merge "adding variable to trigger fundraising exim config block to route incoming bounce-* mail to an mbox" into production

21703438a1-+-Fix sodium node definition again

296056afb1-+-adding variable to trigger fundraising exim config block to route incoming bounce-* mail to an mbox

39acebb3ea-+-testswarm: override apache conf from package

b8fdffce3f-+-Fix ntp::server on dobson

5c0e485cfc-+-Merge "Actually include the class before requiring it" into production

c750343f7d-+-Actually include the class before requiring it

38ced64649-+-Merge "Fix dependencies" into production

55eb64d908-+-Fix dependencies

739732dd21-+-Merge "Why are two star certs installed?" into production

7cba38903a-+-Why are two star certs installed?

b837f83668-+-Move the SVN checkout used by l10nupdate from /home to /var/lib

7a2e7942f2-+-Merge "Relax requirements further to fix dependency cycle" into production

9cc683bea3-+-Relax requirements further to fix dependency cycle

4f122c7744-+-Merge "Fix AFT log rotation, was pointing to the wrong file" into production

f512d45376-+-Fix AFT log rotation, was pointing to the wrong file

4792770e34-+-Merge "Relax dependencies" into production

b16bde82cd-+-Relax dependencies

17aedd018d-+-cleanup of unnecessary variable definition

928ee357dd-+-Include mailman class on sodium

f9b8780c24-+-Don't recreate mount dirs...

426c18ade0-+-Fix tmpfs mount options

19e018249b-+-Fix tmpfs mounts

73138db6c3-+-Create /var/spool/exim4/scan (for Spamassassin)

4c10716c0b-+-Mount /var/spool/exim4/{scan,db} as tmpfs to improve performance

e89833d2e1-+-testswarm: let Apache access our files

8a0e756c5f-+-Install cron job on puppetmasters to clean up old reports

5401f703ea-+-Fix dependency

ed5e17187b-+-Make sure the old l10nupdate cron job is really removed.

77e88e5989-+-betting it helps to define variables before calling the class that uses them . . . one more attempt at firing up DKIM in grosley's exim conf

33f4d87eac-+-Merge "Fix definition name" into test

0bef8e5a48-+-Fix definition name

afba9f095b-+-Replacing many packages with class standard merging this into test from production

643f34b0e1-+-Replacing many packages with class standard

0551246da6-+-Ensure popularity-contest isn't installed anywhere.

4ce47a0db6-+-manifest variable pass-through to trigger DKIM block in exim template

2c424ecc3c-+-apparently need the $exim_signs_dkim = "no" case as well

6f4057b53a-+-adding optional dkim-signing to exim config for fundraising hosts (currently only grosley)

74b3903b40-+-grr wrong path for the source file

a3f623ff80-+-directive to tweeze DKIM private key for aluminium/grosley

d8ae31838a-+-Fix reassignment of $home

ce7654a5a0-+-Make the spamd user using the proper way

78f4f4b57f-+-Implement default home dir for systemuser

d0774ce407-+-Make sure mailman does not get started again by Puppet on every run

9dd41fbab0-+-Further exim.conf template simplification

d119493d9e-+-Use $ipaddress as outbound interface by default

2c91b27024-+-Fix interface option

168e0ba24e-+-Fix typo in package requirement

2157af9f71-+-Pull in exim::listserve::private unconditionally

b924a0d4ae-+-Check if $outbound_ips is set before adding to the config

36a2e1c4db-+-Make the system filter a template, pull private data

3c3312a771-+-Further cleanup of mail.pp

28a4536394-+-Move all mailman config into one file

21e6560f57-+-make check and retry intervals configurable via monitor_service

10f3b90d9c-+-make skip-name-resolve optional in my.cnf, don't use on new otrs dbs

4e3b959028-+-Fixing eqiad and esams

7757815222-+-Add fake configuration for pmtpa and esams for mobile

18fa55c748-+-Merge "Adding mobile svc address to lvs servers" into production

8f8394d779-+-Adding mobile svc address to lvs servers

3bc8f70c7e-+-Renamed digicert and required its installation

2e71141f6d-+-adding in mobile service

5da4790099-+-install latest version of xtrabackup / percona-toolkit in our repo, added new libaio dependency

6425dfb945-+-puppet classes for db48/49

7758dfebf9-+-For the last time, fixing my public key. I swear this is it. (With a new comment too)

7e7023521b-+-thumbs class to fix thumbs writing perms issues

8df451e204-+-Merge "testswarm: cron require testswarm user and home" into test

e505936aea-+-Second try at making a simple puppet manifest. Adding it inside generic-definitions.pp per review.

bb2a3ab664-+-testswarm: cron require testswarm user and home

4da7eb13da-+-Merge "adding mysql cli to singer for troubleshooting" into production

e2d562305b-+-Fixing definition

12b3dbc4cb-+-adding mysql cli to singer for troubleshooting

7946ef2b27-+-fix snaprotate path

2d7d262669-+-manage db lvm snapshots via puppet now that all prod cluster db's there use lvm

ee7fd3338c-+-added mono to generic defs

5dd79dbd87-+-testswarm: no need to specify user group

efc7145903-+-script to fetch mediawiki + puppetization

c0ab10c1dc-+-add a command to monitor poolcounter process for RT 1327 - generic check_procs for all process checks - fix path conflict

5e76549e92-+-Ditch the $name parameter of lighttpd_config, convert existing usage

e6ed420865-+-Partial cleanup of mailman classes

2aa8857d3f-+-Add support for installing lighttpd configs

196adac43f-+-Cleanup spamassassin and mailman classes

e746ea2471-+-start class for contacts.wm (CiviCRM) - minor formatting

53499510f4-+-kick-off puppetization of planet aggregator (re-add) - add apache site config

79cb2126b5-+-Doh. Need the device, not the partition

8a2e33ab53-+-Add missing device name for parted

36b9db9bc7-+-trying to make service[apache] work

9865d993df-+-defining apache service in production

6a018531b3-+-Make hash generation a definition, and vary the hash flag by distro (as the hashing algorithm changed).

b4ae258522-+-removing apache:proxy from racktables TODO - make it into a separate class

24e4e1c2b3-+-Adding conf.d into production (from labs)

d6b0b00042-+-removing unneeded mysql password script

6a834793c8-+-Fixing hash for wmflabs-ca

f314d2967a-+-pushing php5-gd to a class

77e37acf6b-+-moving php5-gd to its own class

a848d08b2e-+-fixed php5-gd

a6e2cc8734-+-Fixing generic::mysql::client class

41b059524f-+-adding in mysql::client (already exists in labs)

20baceb2f5-+-removing php5-mysql from racktables definition since hooper has this defined in other classes.  Made a note to make sure that other classes are included

0c8ac530ef-+-removing generic::webserver::php5 from racktables

af987cd44b-+-Adding racktables to production and hooper

d251aa859c-+-accept all private traffic to make the ruleset work on internal hosts as well.

3d5418607b-+-re-enabling iptables rules.  adding rule to allow NTP

27b02d6161-+-Fix node definition for sodium

08cf99026f-+-exim.conf.erb template fixes

fd0c7fdae5-+-Attempt to fix the restart of exim on every Puppet run

d39a70e378-+-Fold exim::packages into exim::config, simplify class dependencies

f3f803e943-+-Rename exim::roled parameters, some cleanup

895a8ffd31-+-Wrap all exim subclasses in a exim class

d559c2bf33-+-Simplify and cleanup existing exim classes

0ed2a9121d-+-Cleanup of old exim/mailman manifests

a3696c14e3-+-Commented firewall rules in swift::base - causing problems now.

09deb718ca-+-Move create_swift_filesystem into swift.pp now it's generic enough

837a4a62b4-+-Align partitions for performance

9ba400b17d-+-Unbreak puppet on hardy DBs, percona-toolkit doesn't exist in hardy

56fc38c3ce-+-Create partitions with the correct device labels

a66a63e4ea-+-Create /srv/swift-storage in swift::base

00ac9c2bd0-+-Require the swift package to be installed, to create the user

1c3d7e12a4-+-Ruby sucks. Just hardcode for now.

b9739e49de-+-Remove erroneous =

6e74cff13e-+-Debugging

53485d6bef-+-Fix all_drives generation

697eaad13f-+-Debugging

a897842785-+-Require base::platform

fa0790fe50-+-Qualify startup_drives for now

5c5037d0f8-+-Can't evaluate $all_drives from base, so define it in the node definition

1b0ac6c496-+-Fix negative membership test

8f2c95bc55-+-Manage swift file system mounts in Puppet

fd23191e10-+-install percona-toolkit on all databases

2e76face70-+-adding in mysql server for testing (not needed for prod)

eb02141858-+-Merge "generic class is rsyncd, not rsync" into production

ca9122b1e0-+-generic class is rsyncd, not rsync

674ab2c256-+-adding mysql client to racktables

8d222a9384-+-Requiring racktables to have php5-gd

e41dc872a0-+-Changing generic::webserver::php5 to use unpinned version of php5

991bc6cdb8-+-Merge "need the include" into production

083244f4d8-+-need the include

1051f1c123-+-Merge "Changing generic::webserver::php5 to use unpinned version of php5" into production

dc7e657982-+-Changing generic::webserver::php5 to use unpinned version of php5

030a845e0c-+-typo

dec2014b8e-+-need conent, not source

b55558a1a6-+-typo

934c54914e-+-adding in php5-mysql to racktables

234ceb321a-+-Merge "removing dupe cert def for sodium" into production

db456b00f1-+-removing dupe cert def for sodium

ab6052098e-+-Merge changes If6bcafea,If4a429cd,I74dfd86d into production

8942aee3a5-+-switch to using http instead of https

be457bddc1-+-Merge "First pass at organizing misc-servers.pp as individual files in misc/ RT #720 Used misc::bastionhost as a proof of concept (rebased with one minor doc tweak)" into test

4f107eaecc-+-First pass at organizing misc-servers.pp as individual files in misc/ RT #720 Used misc::bastionhost as a proof of concept (rebased with one minor doc tweak)

597a5a8079-+-Merge "Install mysql-client on hume" into test

efedd55bd9-+-Merge "Make sure the old l10nupdate cron job is really removed." into test

00a5766d33-+-Simplify swift::storage

baa8afd8d7-+-Fold SwiftMedia files into one recursive file definition

4a839f2cdc-+-Parameterize swift::proxy::config, use install_cert

ed8e75691c-+-Fix dns stats on dobson

2b5976a49b-+-Fix lighttpd init script on Hardy

50ff211412-+-Fix Puppet on dobson

b82e78f439-+-removing duplicate service in racktables

e96d00eadb-+-removing redefining service apache2

cba182445f-+-fixing webserver for racktables

0677518127-+-adding in php server requirement

4cdec69d9a-+-removing extraneous '{' from racktables

150a10315b-+-adding swauth package for a non-test authentication system for swift

3445c548a7-+-addingi n apache2 to racktables class

3e399c4cb2-+-Also need g++, natty package lied

17611ade66-+-Merge "Also need g++, natty package lied" into test

6cd2e25520-+-Merge "adding first version of preseed conf for mobile CPs as well as adding new boxes to site.pp" into production

b0143fecd6-+-Merge "switching from exim.pp and mailman.pp to mail.pp" into production

0371435246-+-adding first version of preseed conf for mobile CPs as well as adding new boxes to site.pp

15ba9a673b-+-switching from exim.pp and mailman.pp to mail.pp

3453ce84c0-+-adding in racktables mysql passwords

93751aa07e-+-Merge "Reload udev" into production

eab25d6781-+-Reload udev

fd6d815261-+-Merge "tag virtual resource" into production

350a03ce03-+-tag virtual resource

782fd1b31b-+-Merge "Create /etc/udev/scripts" into production

702fe82e95-+-Create /etc/udev/scripts

b468404011-+-Merge "Fix fact name" into production

899aaaeba3-+-Fix fact name

16b7d3f902-+-Merge "redo. hoepfully passes lint check." into production

1a3ab89c1e-+-pin all PHP packages requried by contint

296b9eb204-+-install php5-cli before php-pear

bc264b5591-+-Also need g++, natty package lied

05a460e060-+-Setup interface aggregates on ms1-3

6f71a9b035-+-Fix tabbing of bast1001 node entry

b227000728-+-Fix puppet on brewster

f815bab325-+-Fix kaulen's sudo_user definitions

d484a8ec60-+-Small fixes

532804b1c7-+-Remove the default apache site

f744db968e-+-Manage ports.conf in production as well

4ca8c888dc-+-Use the puppet files from the git repo directly

8a601ca6be-+-Install hooks in the private repo as well

663e0afbbd-+-Can't clone into an already existing git repo, so don't init

7fbbcc44ae-+-Initialize the private git repository

b2f963d2fd-+-Check the right directory

ddc762fad8-+-Install git hooks

67d3ffd549-+-Setup a git clone of the operations/puppet repo

45ed62a128-+-Fix another dependency issue

1cfdfaad32-+-Fix dependency issue of puppetmaster postinst script

80bee9a6c5-+-Add configuration for stafford as a CA-less puppetmaster

4802ef1bd2-+-Merge "adding racktables in to test" into test

dbd659f6e7-+-adding racktables in to test

ce846398b0-+-redo. hoepfully passes lint check.

e6b5d769bc-+-Adding ipv6 support to labs

45263f536a-+-Adding ipv6 support to labs

5e0e6ccae3-+-Fix packages I need to build svn-all-fast-export

75f1802723-+-Merge "Fix packages I need to build svn-all-fast-export" into test

be2edc5424-+-install php5-cli before php-pear

742770c1c7-+-Apply udev rules for Thors as well

e6bcc29ae9-+-pin all PHP packages requried by contint

039ddb5f87-+-duplicate packages pinning

eecc593a7e-+-Add Solaris style device names udev rules

b1ecc65a74-+-generic::webserver::php5 for contint::test

5007ce5a56-+-Add hw platform support to base.pp in Puppet

d41bd805bc-+-Merge "retab generic-definitions.pp - fix indentation" into production

2533604ddc-+-Merge "adding node tarin.wikimedia.org" into production

c9a0ffb5ce-+-Merge "testswarm need a properly configured php5 server" into test

58c6c0f794-+-testswarm need a properly configured php5 server

62d3d6452b-+-Since all appservers are lucid now, move this sudo definition to /etc/sudoers.d

fceb1df666-+-Ensuring system users don't use /home

f46dc01aeb-+-updated list of server for nrpe to include nagios server

39881fec7d-+-Make packages top level

1f2eb193a1-+-Include the parent class, so that the children can be added

94c9132f90-+-Reorganize nagios packages, so that we can install nagios server on a node that also has nrpe.

bdb38931a8-+-Making ircecho more generic

ca8bae04fa-+-Merge "Use the puppetized version of logmsgbot now that fenari runs lucid" into test

2ab60b21c6-+-Use the puppetized version of logmsgbot now that fenari runs lucid

c30f672838-+-Making ircecho more generic

ba07ac87ce-+-Merge "moving varnish_backends up so it will be defined before it is called" into production

2e1cd4a2f0-+-moving varnish_backends up so it will be defined before it is called

67a28d51d2-+-avoid conflict for package subversion

a2e333c65e-+-Merge "avoid conflict for package subversion" into test

f7a3c41452-+-avoid conflict for package subversion

4abb641401-+-Adding a new SSH key for myself (Roan).

f21e193ae7-+-Merge "Adding a new SSH key for myself (Roan)." into test

f84992750d-+-wrap contint::test jenkins in a new subclass

dce8382cac-+-contint::test prepare testswarm deployement

424eaa39a6-+-wrap contint::test packages in a new sub class

feccdef590-+-contint::test prepare testswarm deployement

c8e2f91775-+-wrap contint::test jenkins in a new subclass

45166c572a-+-wrap contint::test packages in a new sub class

a65c56c206-+-class to install new fb mysql pkgs apply to eqiad dbs

c5f9365b78-+-rmem_max and default for mw prof collector (and max for udp2log - new version sets its own size)

1a23d4b8cf-+-Adding Sara Smollett as root; she's a new Labs contractor.

f73cddeddc-+-Use ms1-3 for swift testing

7afb41dfbe-+-add wikimedia mysql apt repo to dbs

6728d4a28e-+-Manage brewster:/srv/autoinstall from Puppet (resolves: RT#1857)

1cde52e284-+-contrib isn't working on at least Karmic for some reason. Also add -updates

7944c4aca6-+-Point servers with unsupported Ubuntu releases to the old dists mirror

7d805ed8fe-+-Create system group (now we have puppet 2.7), and fix modes

b796882e0b-+-creating ganglia aggregators for the 'Application Server' class

2079a02f6c-+-creating another config class for the pmtpa swift cluster.  eventually, these will be parameterized.

5eb5844358-+-varnish: allow stale objects to be served and retry 503's up to 4 times

bfb1954cb1-+-Fixing requirements for gluster

d231810a30-+-include for ldap bind pw

d5c21d446c-+-graphite web fronted proxy

d01a30a4e6-+-Unbreak puppet on emery

d765734e57-+-A few safety measures for production realm

8131edc548-+-class to install new fb mysql pkgs apply to eqiad dbs

bc2318dea1-+-rmem_max and default for mw prof collector (and max for udp2log - new version sets its own size)

18ac866974-+-Adding Sara Smollett as root; she's a new Labs contractor.

8efad268b9-+-Use ms1-3 for swift testing

2da8e9b22e-+-Merge "add wikimedia mysql apt repo to dbs" into production

f1daea6708-+-add wikimedia mysql apt repo to dbs

3d101c5076-+-add libio-socket-ssl-perl to misc::package-builder

29060e95ce-+-add libio-socket-ssl-perl to misc::package-builder

e3a6d63567-+-retab generic-definitions.pp - fix indentation

1671182212-+-adding node tarin.wikimedia.org

b9a63953d6-+-Fix packages I need to build svn-all-fast-export

0b5525c9e0-+-Install mysql-client on hume

4c3d64312e-+-Manage brewster:/srv/autoinstall from Puppet (resolves: RT#1857)

75fdc4ef99-+-contrib isn't working on at least Karmic for some reason. Also add -updates

912f1d47da-+-Point servers with unsupported Ubuntu releases to the old dists mirror

5895f1a179-+-Merge "Create system group (now we have puppet 2.7), and fix modes" into production

19af398316-+-Create system group (now we have puppet 2.7), and fix modes

ea028aeebd-+-Merge "creating ganglia aggregators for the 'Application Server' class" into production

a0a534f3a4-+-creating ganglia aggregators for the 'Application Server' class

2f40751bbc-+-Merge "varnish: allow stale objects to be served and retry 503's up to 4 times" into production

7ce1ab3eba-+-Merge "creating another config class for the pmtpa swift cluster.  eventually, these will be parameterized." into production

f676e3d5d2-+-creating another config class for the pmtpa swift cluster.  eventually, these will be parameterized.

c6004cfd3f-+-Fix dependencies for autofs

3ece58d2f1-+-Fix dependencies for autofs

38d90e42a3-+-varnish: allow stale objects to be served and retry 503's up to 4 times

37075097ce-+-Fixing requirements for gluster

ef493ccd25-+-Re-attempting qt4-make package, adding to svn.pp instead

499d8d0497-+-Re-attempting qt4-make package, adding to svn.pp instead

f1080e651d-+-include for ldap bind pw

c303fb5db8-+-Merge "graphite web fronted proxy" into production

e88fdf136e-+-graphite web fronted proxy

49c2d857fc-+-Merge "Fix my public key, was off-by-one" into test

d1852bc05a-+-Fix my public key, was off-by-one

c30b38b007-+-Unbreak puppet on emery

54ae551d24-+-Merge "Put mysql::client in its own class, and install it on bastion hosts too." into test

9bf3165280-+-Put mysql::client in its own class, and install it on bastion hosts too.

8c27a67473-+-A few safety measures for production realm

e7d48319a7-+-Merge branch 'production' into test

97c0a443ea-+-Merge "Adding myself and Sam as mwdeploy sudoers on BZ" into test

c39eee0c37-+-Merge "Revoke my old keys, only use my new one for cluster access" into test

53ad58bc35-+-Merge "Fix up download.mediawiki.org" into production

f97c54efb6-+-Fix up download.mediawiki.org

658efff2ea-+-Merge "Install php5-cli and php5-mysql on nagios hosts" into production

81e6fd4682-+-Cleanup broken OWA nodes

b3c8f9c98a-+-Only create a group on hardy systems

ff51f04085-+-Don't try to install nonexisting packages on lucid

d757b6cba0-+-Remove group parameter system... not present in 2.6.1 Puppet?

830bc70a17-+-Fix typo

c6b797e699-+-Create system group ssl-cert on hardy systems

57107ad5c6-+-Maerlant was test host for protoproxy, just include standard now

05aafc6275-+-Fix dependencies of protoproxy

7913083817-+-The eqiad ipv6 protoproxy config is completely broken right now, so disable

c0a408dedd-+-Readd mysql-client to the package list, needed for initial database creation

fe6bd6d738-+-gerrit's init script doesn't have a status command. Use check instead.

e63672a807-+-Fix memcached::disabled

4e08c91568-+-Automatically purge decommissioned hosts from the exported resources db (nightly)

91c8259208-+-Add exported resources purge script

e8a1a2896f-+-Remove node entries for srv151..srv186 to make Puppet not fail on them

1b127ed5b6-+-Add srv151..186 to decommissioning.pp

d1b450f374-+-Adding a new SSH key for myself (Roan).

5791a0dbbf-+-apache conf for graphite dashboard

5161f0e83e-+-Update puppet config for diablo version of nova

a447cf8ce1-+-Add pinning for mysql packages for openstack

92aabf7526-+-Upgrade Puppet on all Lucid servers to 2.7.7rc2 (updates: RT#2031)

9021269d69-+-puppetizing a couple jenkins and backup scripts for aluminium

0d0811eb69-+-APT pinning php5-pgsql on CI test server

e6a3c9e924-+-gallium: add star certificate

80d549b1d9-+-Merge remote-tracking branch 'origin/production' into test

ce9c7dace3-+-Finishing touches of dashboard configuration: settings.yml and deps

007ec1f503-+-We do need puppet-dashboard-workers to be configured and running

381c6e6846-+-Enable puppetmaster reporting

391acd0654-+-Fix content of patch

d03a814d52-+-Fix typo in sockpuppet puppet.conf settings

809ff1d097-+-Fix puppetmaster::dashboard class name

90c0ecd2dc-+-Install Puppet Dashboard on sockpuppet (resolves: RT#75)

27bf3a6b90-+-Fix openstack puppetmaster settings

a23cadf4d2-+-Move base URL to /, fix gem-dependency.rb

8da25a20da-+-Puppet dashboard fixes

e66012cc6b-+-Run rake commands from /usr/share/puppet-dashboard

f8a2f0cded-+-Need to include openstack::nova_config

0b6e02c59e-+-Give $config a default empty hash, add documentation

2817328075-+-Apparently relative class includes don't work

1fefa6aa92-+-Replace the broken variable based puppet.conf setting, use a hash

619522df36-+-Can't redefine variables, so only init if not done before

7724f22d55-+-Move is_(labs_)?puppet_master assignments to top-level scope

f5d9e6b5f8-+-Puppet class for installing Puppet Dashboard

ecdb408aab-+-Move base URL to /, fix gem-dependency.rb

c6a1a73b8f-+-Revoke my old keys, only use my new one for cluster access

b2d36da919-+-Puppet dashboard fixes

14d02a7fbe-+-Run rake commands from /usr/share/puppet-dashboard

2fd662f865-+-Need to include openstack::nova_config

4edf55fb14-+-Give $config a default empty hash, add documentation

4a6e02da29-+-Apparently relative class includes don't work

917f2fb6c5-+-Replace the broken variable based puppet.conf setting, use a hash

a20031d17d-+-Can't redefine variables, so only init if not done before

586dbf36fc-+-Move is_(labs_)?puppet_master assignments to top-level scope

8c6a7cd580-+-Puppet class for installing Puppet Dashboard

8eb9298118-+-Merge remote-tracking branch 'origin/production' into test

6eeff390b6-+-Make sure /etc/puppet.conf exists with the right permissions

c2ec870014-+-Compile puppet.conf out of puppet.conf.d files, to compile config in different classes

c3ccac37ab-+-Use SSLCARevocationPath to fix an SSL issue, and setup the CRL dir

f557dae931-+-Make the puppetmaster server name configurable, default 'puppet'

baa5b9fac1-+-Move hashes out of selectors

b7c0896014-+-Work around puppet 2.7 bug with hashes defined in selectors

1bba38ee70-+-Assign deep hashes indirectly to attempt to please puppet 2.7

0e368d00cc-+-lvs.pp doesn't parse in Puppet 2.7. Hashes are too deep.

6b53c18488-+-Make default deny_from empty, and remove wildcard in apache conf

891021a20a-+-Convert puppetmaster invocation of sockpuppet to new style

1b25208e41-+-Squash commit of relevant changes to puppetmaster in test

b03e63a3c1-+-Add deny_from parameter, and set defaults as empty lists

c5f874703f-+-Add fileserver.conf

5b56c9b460-+-Unbreak sudo.pp

e1088d6f57-+-Use variable scopes in templates, and add class documentation

7862064c96-+-Actually pass class parameters in puppetmaster

5dbf71c607-+-Make puppetmaster class allow_from parameter a proper list

a4560cb8fa-+-Upgrade puppet agent to 2.7.7rc2

f9515f4660-+-The server-to-client SSL links are harmful and unneeded

6f2f0fb3d8-+-Fix sudo_group

6e4b2f231d-+-Fix duplicate definition created during a merge conflict

7acfa34c14-+-Install php5-cli and php5-mysql on nagios hosts

1b3408729d-+-Move hashes out of selectors

573ddbaa2b-+-Work around puppet 2.7 bug with hashes defined in selectors

7424a0e42b-+-Assign deep hashes indirectly to attempt to please puppet 2.7

07ff140cc8-+-lvs.pp doesn't parse in Puppet 2.7. Hashes are too deep.

07dd98fe99-+-Need rails for storedconfigs

c2ebd81aa2-+-Fix up puppetmaster vhost, create symlinks for host certs

9fb7ea091e-+-Doh. s/Directory/File/

7412ac9022-+-Let's generate the host cert ourselves

7d229746d3-+-Add ssl subdirs, but don't change modes/owners. Require puppet.conf to be in place before puppetmaster install.

be4e19a73b-+-Create all puppetmaster SSL subdirs

51753096a4-+-Rename puppet config files

89b1825cda-+-Create a separate puppetmaster SSL dir

4ae46a3524-+-Merge branch 'production' into test

ddb7190f3f-+-dupload configuration

8b9d76617f-+-Need rails for storedconfigs

dcb7c63047-+-Fix up puppetmaster vhost, create symlinks for host certs

6cc028e44e-+-Doh. s/Directory/File/

f6d03b402d-+-Let's generate the host cert ourselves

6b700c7d43-+-Add ssl subdirs, but don't change modes/owners. Require puppet.conf to be in place before puppetmaster install.

202292d1d4-+-Create all puppetmaster SSL subdirs

615228c5a9-+-Rename puppet config files

2c302ee24f-+-Create a separate puppetmaster SSL dir

341781f4d5-+-Move Package[git-core] into a generic-definitions class

8b9020db40-+-Convert openstack puppetmaster as well, using parameterized classes

e15a9cc5ab-+-Refactor puppetmaster.pp, and integrate misc::puppetmaster

f10e85fe63-+-Convert openstack puppetmaster as well, using parameterized classes

2e7e6c38ce-+-Refactor puppetmaster.pp, and integrate misc::puppetmaster

82c64a8522-+-Merge "added a warning about a hidden dependency" into production

d0c9fd9bd8-+-added a warning about a hidden dependency

304f408f10-+-Merge "switching to use standard instead of base per mark's recommendation. this also pulls in ganglia, which should fix memcached's dependency chain." into production

0e97ed498d-+-switching to use standard instead of base per mark's recommendation. this also pulls in ganglia, which should fix memcached's dependency chain.

99e2b98be5-+-Merge "Revert "define the python_modules direttory for all distros, not just hardy." this was for hardy because it's defined in ganglia.pp for lucid." into production

9a641f9a60-+-Revert "define the python_modules direttory for all distros, not just hardy." this was for hardy because it's defined in ganglia.pp for lucid.

24c7f1f8dc-+-Merge "define the python_modules direttory for all distros, not just hardy." into production

2564b80805-+-define the python_modules direttory for all distros, not just hardy.

fd0daa13d2-+-Merge "switching swift to use the templatized memcached setup" into production

1defefbbac-+-switching swift to use the templatized memcached setup

4b0d493315-+-Merge "moops - variable substitution suppressed by single quotes?" into production

7894c1c461-+-moops - variable substitution suppressed by single quotes?

2c9a973f70-+-Merge "templatizing memcached configs" into production

cfbc4b8a5c-+-templatizing memcached configs

e4f87e0c2f-+-We want to require a password in labs...

41a803553b-+-Merge "allowing igmp traffic to swift hosts." into production

62f5c24833-+-allowing igmp traffic to swift hosts.

55659117b5-+-Merge "copy/paste ID fix" into production

7de9df5b9b-+-copy/paste ID fix

4dc0738d74-+-Merge "testingc ryan's fix to the established rule" into production

8e39e1f1f4-+-testingc ryan's fix to the established rule

7500aeb22f-+-Merge "Set the correct match" into production

869e42c042-+-Set the correct match

039ea9a844-+-Merge "reverting back to broken config to get a ruleset to work with." into production

dbf7b6a34e-+-reverting back to broken config to get a ruleset to work with.

2ba90c656f-+-Merge "Set Wikimedia devscripts.conf defaults, and add gdb.conf (git-buildpackage)" into test

99371456ce-+-Set Wikimedia devscripts.conf defaults, and add gdb.conf (git-buildpackage)

174703b13d-+-Merge "Remove activerecord packages, no longer included in Lucid and above" into test

dbd10390de-+-Remove activerecord packages, no longer included in Lucid and above

db33dbaaaa-+-Merge "Fix debhelper package name" into test

f9cb91f148-+-Fix debhelper package name

764a65f929-+-Merge "Fix template path" into test

41d9eeede4-+-Merge "Upping version of ldap scripts" into test

9ac04036c5-+-Fix template path

8a415c379f-+-Upping version of ldap scripts

ff0ffcdfd3-+-Whoops. definition needs to be a class.

bb3177e595-+-Add generic-definitions.pp import to puppetmaster.pp

b34b8e14d2-+-Add back the import of generic-definitions.pp in site.pp

8352fd1488-+-Move Package[git-core] into a generic-definitions class

01c9056134-+-Initial class for package builders. Includes Ubuntu default devscripts.conf

c03b96664f-+-Merge "ok, trying with only tcp." into production

b5c0a196d5-+-ok, trying with only tcp.

7c02d0ee00-+-Merge "more required arguments to add_rule" into production

a52a20e4bc-+-more required arguments to add_rule

291aa7ad7f-+-Merge "second try at accepting established connections" into production

1bdebc8a26-+-second try at accepting established connections

407453b8fb-+-Merge "allowing established rules" into production

9ae73feb8e-+-allowing established rules

caaf740b43-+-Merge "changing rsync from all to tcp and udp separately so that ports work." into production

da2244d584-+-changing rsync from all to tcp and udp separately so that ports work.

d857816f07-+-Merge "enabling iptables rules" into production

831ad695d0-+-enabling iptables rules

709ac5a3d3-+-Merge "collapsing iptables rules to combine storage and proxy nodes until they no longer share hardware" into production

51da195bfe-+-collapsing iptables rules to combine storage and proxy nodes until they no longer share hardware

40258c97a3-+-Merge "reordering, correcting typos in swift iptables configs" into production

b3b46407fa-+-reordering, correcting typos in swift iptables configs

aad0b8c36a-+-Merge "split up iptables rules into common, proxy, and storage.  added rules to each class.  I think this won't work because some hosts are both storage and proxy, but we'll see." into production

e92f5c8b61-+-split up iptables rules into common, proxy, and storage.  added rules to each class.  I think this won't work because some hosts are both storage and proxy, but we'll see.

9b5d5b6e03-+-Merge "we actually want icmp from anywhere, not just our network." into production

ad9eabbef7-+-we actually want icmp from anywhere, not just our network.

261f6fa51f-+-Merge "Adding firewall rules to allow ssh, all icmp traffic, and services needed for swift.  Drop everything else. Not yet enabling the rules - only creating them to see what the resulting ruleset looks like" into production

af193ac523-+-Adding firewall rules to allow ssh, all icmp traffic, and services needed for swift.  Drop everything else. Not yet enabling the rules - only creating them to see what the resulting ruleset looks like

672e61e8ca-+-Merge "Change gerrit to use db9" into production

76f63dc7a9-+-Change gerrit to use db9

ecdf935e63-+-Merge "the bits must flow..." into production

7da5ffd7e1-+-the bits must flow...

e2b5c97d86-+-fixed spacing issue

7cc939b3ff-+-changed "day" to weekday (proper language). was causign error on kaulen err: Could not retrieve catalog from remote server: Error 400 on SERVER: Invalid parameter day at /etc/puppet/manifests/misc-servers.pp:2068 on node kaulen.wikimedia.org

0102516b56-+-Merge "doing it right. (want to make fun of me for this one too, ben?)" into production

5b76bd751e-+-doing it right. (want to make fun of me for this one too, ben?)

fa0136ee55-+-Merge "correcting filename typo" into production

6732d20fdb-+-correcting filename typo

f1a93d90e0-+-correcting tabbing

39b0013c34-+-ok, I'll do this right now

d44c409d90-+-Simplify sudo_user and sudo_group

9d21ac0fda-+-Add a paranoia check to ensure this only ever happens in labs.

466648b25f-+-Give project members sudo access, excluding specific projects

ae91d8ca1b-+-Give permissions to Reedy to give out commit access

4e8a1773ae-+-Make sudo_user calls on formey multi-line

bc39cdd64a-+-Make sudo_user calls on formey multi-line

4bea4d8198-+-Add a paranoia check to ensure this only ever happens in labs.

b26b863a04-+-Merge "Preparing a puppet upgrade, do not upgrade automatically yet." into production

1c1f0f6f05-+-Preparing a puppet upgrade, do not upgrade automatically yet.

394f8a1c05-+-Make sure the old l10nupdate cron job is really removed.

c88a19397a-+-Adding myself and Sam as mwdeploy sudoers on BZ

dde9c8d1bd-+-rename bugzilla crons class to use colons

21b5036773-+-enables SSL on integration.mw.org

5513a443ca-+-add hashar account to kaulen (bugzilla)

86f4d14b3c-+-Add FIXMEs to swift.pp

74db6ba57b-+-Use upstart_job

8ed3b04e3d-+-Instances need to include the default sudoers file

f56b4299c0-+-Give project members sudo access, excluding specific projects

9f8b9cdda2-+-Merge "adding SwiftMedia middleware to swift" into production

6082668cd5-+-adding SwiftMedia middleware to swift

d9436c6241-+-Merge "creating a bastion machine class changing to remove nfs::home as the cross colo traffic may make for unpleasant slowness" into production

51dafdcf62-+-creating a bastion machine class changing to remove nfs::home as the cross colo traffic may make for unpleasant slowness

b2cfa0212f-+-Merge "gid too? what a country...." into production

0e1be03db0-+-gid too? what a country....

2cd9c55dd1-+-Merge "god damn typo" into production

3a8e4b82aa-+-god damn typo

79db54ecc5-+-Merge "while I'm looking at admins.pp, I want to lock out my personal laptop from the cluster" into production

5fe7547b1e-+-while I'm looking at admins.pp, I want to lock out my personal laptop from the cluster

ff8a78334f-+-Merge "copy/paste error" into production

cc20ea8558-+-copy/paste error

00b1f905f8-+-Merge "adding iperf into standard-packages adding iperf to base package" into production

ebe2f69bcc-+-whatever

ef4d056370-+-adding iperf into standard-packages adding iperf to base package

0d279ac332-+-Merge "adding in stuff to allow hooft and carbon to rsync from brewster" into production

e6e5d1c043-+-adding in stuff to allow hooft and carbon to rsync from brewster

fdc2832dca-+-Merge "updating wiki deploy scripts to ping graphite (ameneded deploy2graphite per feedback)" into production

4f31b362b1-+-updating wiki deploy scripts to ping graphite (ameneded deploy2graphite per feedback)

8cb6f8bbce-+-include package mysql-client-5.1 instead of unversioned one

1b713ad9db-+-All snapshot hosts in one stanza in site.pp, includes sn3

f9a842d83c-+-add smtp and http monitoring for aluminium and grosley (RT 2003)

befc9b2937-+-Implement log rotation for l10nupdate

47f448ad03-+-correct graphite dasboard.conf name

8af68d7a87-+-more graphite configs

0da61d6974-+-restoring ganglia to erzurumi's conf

47cf29b13c-+-removed lame/broken ganglia config for erzurumi (8.04.2) fixing by hand

9ff21958c3-+-Add environment files to management, customize for labs

169f241e24-+-getting the hostname right

f5c8326886-+-Merge "misc class for graphite pkgs built with pypi-install" into production

e35cb51da3-+-misc class for graphite pkgs built with pypi-install

e8a40f0849-+-ok, adding custom swift config files back in - I need to override bind_ip and devices

26c80a683e-+-Ensure git is installed for the crons that pull git repos

e4c8e735bd-+-Ensure git is installed for the crons that pull git repos

061d8fc27a-+-Set libvirt_type conditionally based on realm

0545d2ba49-+-Set libvirt_type conditionally based on realm

7ba623e1e8-+-Ensure that not all clients require nscd

5ab2e3a7c7-+-Ensure that not all clients require nscd

2e03a0c6dc-+-Everything is installed on one system for openstack in labs, let's use localhost for everything.

b3528a9326-+-db20 to decomissioned, adding professor

501d68a831-+-Revert "adding swift storage configs", aka removing storage configs   because the defaults installed by the package are actually   ok as is.

5fe3755615-+-adding swift storage configs

6b049199ff-+-more enable / enabled typos.  checked all this time...

b8e0f1477d-+-typo enabled / enable

5fd2f146bb-+-setting up rsync on the swift storage nodes

03bbb85588-+-taught puppet to kick memcached when the configuration changes

ae21fe1145-+-grr, storage3 should have been slave not master

f918195f30-+-attempting to add class db::fundraising as part of getting nagios mysql replication monitoring going

1f8d711a5c-+-added config file for fundraising-misc for RT #1898

da44537c7b-+-I hate puppet stages. Only run these for labs.

52db3c48b9-+-I hate puppet stages. Only run these for labs.

e67627a066-+-Merge "adding in cluster config for the test cluster" into production

3dec3fd55b-+-Merge "all files in /etc/swift are suposed to be owned by swift" into production

b6bb417484-+-adding in cluster config for the test cluster

b5a4d856bb-+-Merge branch 'test' into production

ae4c46e4df-+-Merge branch 'production' into test

cf029a7ccf-+-Follow up to change #915.

721ab287f1-+-bug 29203 run collectstats.pl on bugzilla server

74688c639f-+-ugh, ok, commenting this out for now on sec concerns

502e172697-+-redo. that gen-def no worky...

2905e2a7dc-+-all files in /etc/swift are suposed to be owned by swift

1076604a30-+-Merge "allowing hooft to actually rsync from brewster...." into production

5394afe504-+-allowing hooft to actually rsync from brewster....

990583b677-+-Merge "puppet takes three slashes, not two.  moops." into production

65298766d3-+-puppet takes three slashes, not two.  moops.

b0920cf885-+-Merge "Give permissions to svn account creators to link labs accounts." into production

458ec5add3-+-Give permissions to svn account creators to link labs accounts.

049ce49da4-+-alphabetized the list of included files to make it easier to visually scan. corrected missing commas in swift.pp corrected missing colon in swift.pp

78c2d9eaf8-+-Merge "correcting , for ; typo" into production

89777fb110-+-correcting , for ; typo

f7b94ad788-+-migrating db11 to new newness

5b5a1b5341-+-Merge changes Ia0d8c8ec,Icafefe0d,Ibca05068,I4972ed3f,I51bcb520 into production

d63add688f-+-assigning swift classes to my three test hosts, zinc, magnesium, and copper.

f37f2749d5-+-fixing the grammar of the system role message

49f496b189-+-upgrading db19, added warning re: mysql classes

b32a4ddeee-+-passive checks nagios master config for payments servers

c797d47811-+-Merge branch 'swift' into swift-merge

82dbe4b0be-+-adding in the "temporary hack" to get these checks back into nagios

06964f1a24-+-Merge "adding some junk as part of destroying testing.cfg" into production

e0eac18323-+-adding some junk as part of destroying testing.cfg

1b8505e1ed-+-Implement log rotation for the AFt logs

0e5c86e5cd-+-Use the nginx.conf template instead of a static file

f4a8023f52-+-Actually increase the number of nginx workers on the nginx servers that needed it the most :P

581721e810-+-Setup interface aggregates on sq69 and sq70 as well

5cc970f847-+-Merge changes I7f8cdffb,I3899bedf,I0059cd31,Iaeaf3449 into test

b75076b286-+-Merge "Implement log rotation for the AFt logs" into test

2c936448fa-+-Merge "retab base.pp" into production

8e4338bdb7-+-Merge "retab backups.pp" into production

e44090bcfc-+-retab base.pp

4e0beae872-+-retab mediawiki.pp

053fec2b47-+-retab backups.pp

f8305b2e53-+-Change this to the opendj user, not root

263422422d-+-Remove tls check on localhost

a71374798f-+-Add an override for ca cert for root when using labs

7b2c99511c-+-Ensure the opendj package is installed before we try to put a cert in its home directory.

1581b3f6c4-+-Set labs db host to localhost

890ce5e4b6-+-Ensure 000-default is disabled.

946d10a382-+-Add missing ca cert

743af89604-+-Puppet host is always the same for labs

da83f189c2-+-Add support for openstack in labs

63857af9aa-+-Telling puppet (and nagios) that es3 is the new master for the ES clusters.

f3282ebe16-+-Merge "need this line too" into production

ca5a728b3d-+-Remove varnish2 classes, configuration and files

9bc1bf1a0d-+-Always act as an aggregator when decommissioned

5a6a95a154-+-Decommission knsq1-7

c77841cd4a-+-Automatically move decommissioned servers to a special ganglia cluster

4982392e60-+-Deploy new-style varnish bits configuration in pmtpa

315c65cc2e-+-Temporarily disable pmtpa as esams bits backend

e88fa0a52d-+-Setup interface aggregate on cp3001/cp3002

4048601cbd-+-Use IP addresses for esams backends

faed550207-+-Add eqiad as esams backend

148364fa9a-+-Rename Mobile Varnish ganglia cluster

6c023b22a6-+-Varnish3 compatibility fixes

29daf529a8-+-Clean up ganglia clusters

048e1a83ca-+-Remove site specific ganglia clusters

92fe403d1c-+-Use the pre-made certs for labs

6161a0a714-+-Changes for etherpad-lite's apache config

97d951610f-+-Followup 686, Duplicate path not needed (and is wrong) says Ryan

b01e6c713b-+-Followup 686, changed source to content

8513447e39-+-Followup to 686, needs to have a different key(?) name

931aa2bdea-+-Implement log rotation for the AFt logs

e45d1d9726-+-Tweaks to SVN, mainly moving the apache config with the other sites. Also killed the link to my user directory, no longer needed

67805eabd8-+-Custom resolv.conf for hooft (esams bastion)

2a8cd009d3-+-Enabling mount point for gluster

156148bafa-+-That's supposed to be glusterd, not gluster

9ab5eb0736-+-Make gluster use an upstart, rather than its init script

805e6f603e-+-add datasets account to locke

80a3881feb-+-add datasets account to the snapshots hosts

ff4e018220-+-add datasets user for rsyncs of data to web server

be118cb1db-+-Revert "add datasets user for rsyncs of data to web server"

f6520925de-+-add datasets user for rsyncs of data to web server

83aa453f9f-+-added srv172 for decomissioning

04c161e242-+-decommissioning srv157

5d06819178-+-Merge "Add newline to content" into production

ddb0fb3a04-+-Add newline to content

38358fd74f-+-Merge "Another stab at working around this weird puppet bug" into production

5c942ccdb7-+-Another stab at working around this weird puppet bug

881ba9a6be-+-Merge "Try to work around a weird puppet issue" into production

ce54757409-+-Try to work around a weird puppet issue

414fce6676-+-Merge "Restart the gluster process when a peer is added." into production

d030487f49-+-Restart the gluster process when a peer is added.

ffa536af31-+-Merge "Ensuring host_uuid in the exported resource isn't overridden" into production

9dbaf32fc1-+-Ensuring host_uuid in the exported resource isn't overridden

3978ecb0e3-+-Merge "Trying again with tags" into production

2276093a2d-+-Trying again with tags

524b51c4e0-+-Merge "Generate peer list and host uuid for gluster nodes" into production

f79f531207-+-Generate peer list and host uuid for gluster nodes

0da9110c00-+-added in mobile3-5 as they have been renamed

f04e598567-+-Merge "Another one" into production

71c88e0cde-+-Another one

1fb0f13f28-+-simpler rule b/c the last attempt misbehaved.

4bd7b879f7-+-Merge "Attempt to fix duplicate package definition error" into production

1eba1f7c59-+-Attempt to fix duplicate package definition error

c9aa3dfd56-+-grr. forgot to give the iptables directive a specific name

ca61d9386a-+-added an iptables rule to allow a broader subnet to reach nsca currently used only on spence

40d45c7151-+-Merge "enable, not enabled" into production

2431ae9c9c-+-enable, not enabled

1cf2121d81-+-Merge "Gluster, not glance." into production

285c67cda2-+-Gluster, not glance.

19441b2941-+-Fix the worst problems in the old nagios.pp

32e8c8a4ac-+-Temporarily wrap some local monitoring statements to speedup

0737019d43-+-Revert Nagios changes, will be for another day

4f3d479e36-+-Merge "Additional ordering" into production

14f5711498-+-Additional ordering

3f3f27577b-+-Adding gluster support to openstack

d821f1c5b8-+-Merge "Fix broken monitor" into production

3554dd073b-+-Fix broken monitor

29afd1c7d9-+-Merge "Move notify => Service[nagios] out of defaults" into production

c5045926ee-+-Move notify => Service[nagios] out of defaults

e22e68d2a3-+-Merge "Fix chmod" into production

b59f37f087-+-Fix chmod

a8f6854f8c-+-need this line too

dd61792a14-+-Merge "Fix directory mode" into production

a9ed76681f-+-Fix directory mode

1468f6f3bb-+-Merge "Change decommissioning" into production

ae4fb2849f-+-Change decommissioning

7521159c84-+-Merge "Fix wrong variable" into production

bc08ddc327-+-Fix wrong variable

aa7df30df9-+-Merge "Include the service as well" into production

7631a8cf2a-+-Include the service as well

cc9303086e-+-Merge "nagios.pp is a complete mess and broken, attempt to fix out of necessity." into production

75cbb96836-+-nagios.pp is a complete mess and broken, attempt to fix out of necessity.

d5f2f46cb1-+-Merge "Add internal service IPs to lvs1001 and lvs1004" into production

7a720df478-+-Add internal service IPs to lvs1001 and lvs1004

08b1923f15-+-Merge "Fix discrepancy between 10.2.4.* and 10.2.2.* eqiad internal service IPs" into production

1c1cb0d2a1-+-Fix discrepancy between 10.2.4.* and 10.2.2.* eqiad internal service IPs

76ad63ed52-+-Remove all statements installing wikimedia-task-appserver from misc-servers.pp and replace them with require mediawiki::packages

5d39f80868-+-Merge "Create a role class for the SSL proxy servers" into production

d6d9c01a80-+-Create a role class for the SSL proxy servers

f517c583de-+-Merge "Add TODO" into production

59b00ff7d8-+-Add TODO

6a7f6b9065-+-Merge "Further puppetization of torrus" into production

4780af76db-+-Further puppetization of torrus

5b91b72de1-+-Merge "Add /etc/torrus/templates to puppet management" into production

aef3ebf47e-+-Merge "Add /etc/torrus/conf as well." into production

e9ff649dbd-+-Add cache_bits_eqiad nagios group

c06a6135b1-+-Add /etc/torrus/templates to puppet management

a279879127-+-Add base::puppet FIXME

bd11cb79b2-+-Add /etc/torrus/conf as well.

e914906365-+-Merge "lighttpd_config enables configs but does not make sure they are available, shouldnt it?" into production

e21d0437c6-+-lighttpd_config enables configs but does not make sure they are available, shouldnt it?

28bfd0e842-+-Merge "then we also dont need the service here, and neither monitoring, comes from generic class" into production

dba4521923-+-then we also dont need the service here, and neither monitoring, comes from generic class

ebf9606d00-+-Merge "use existing lighttpd_config to add configs" into production

cfea6e7c1a-+-Merge "Do not set modes on unmanaged files" into production

e642886001-+-Do not set modes on unmanaged files

28adc816e7-+-use existing lighttpd_config to add configs

b00860b197-+-Merge "This ugly snmp trap command hurts my eyes in my otherwise beautiful Puppet runs... ;-p" into production

4b5b5eb65a-+-This ugly snmp trap command hurts my eyes in my otherwise beautiful Puppet runs... ;-p

4748f23f1e-+-Merge "use generic lighttpd installer" into production

842aaeb0e6-+-use generic lighttpd installer

1fa9c177f7-+-Merge "For ExtensionDistributor, use the new cron script that I just wrote instead of plain subversion commands." into production

05fd0b74fc-+-Merge "/etc/aliases not specific to mailman and not needed here" into production

aa5a7ea7af-+-/etc/aliases not specific to mailman and not needed here

5a197bf116-+-Merge "do not require webserver in mailman base class, fix minor formatting shown red in gerrit" into production

a8eae00936-+-do not require webserver in mailman base class, fix minor formatting shown red in gerrit

108f56d3fc-+-Merge "Initial puppetization of Torrus, config files & compile only." into production

af2f8fc060-+-Initial puppetization of Torrus, config files & compile only.

0efb849b6b-+-change lighttpd conf to look for ssl cert in the right place, adjust cert monitoring

2448686e83-+-use install_certificate instead of file to install SSL certs

2ee6ec3be8-+-For ExtensionDistributor, use the new cron script that I just wrote instead of plain subversion commands.

0a002463ce-+-Merge "that is defined elsewhere" into production

a374869ac2-+-Merge "some little changes. now ready for review of exim stuffs" into production

d90836cba8-+-Make cache_mobile ganglia cluster non-site specific

bcb5cd03b4-+-Remove esams specific ssl ganglia cluster

4ae6589ff2-+-Remove site specific ganglia clusters for cache_bits

61414012bc-+-Add warning comments near the ganglia hash, as I even fooled myself...

9e2d30a4e9-+-We no longer need to make distinction between sites for Ganglia

033006b7e4-+-Fix dependency of dpkg-reconfigure wikimedia-lvs-realserver

e49050ceb5-+-Retab lvs.pp

fae9000d56-+-Fix dependencies of varnish service

9abd9d720f-+-Add varnish bits eqiad ganglia group

fb32c41a77-+-Deploy arsenic and niobium as eqiad bits cache servers

f807270a31-+-Add interface aggregate for ms6

8f53a9fe6a-+-Fix duplicate definition

84b2180349-+-that is defined elsewhere

6dd374321d-+-some little changes. now ready for review of exim stuffs

03fe3f92c9-+-Merge "Setup interface aggregate on sq67 as well" into production

421edbacdb-+-Setup interface aggregate on sq67 as well

18aa0efa8e-+-Merge "Use ip addr flush instead of ifdown" into production

aa0cc6b4a6-+-Use ip addr flush instead of ifdown

e0e12afa9b-+-Merge "moving civimail_send to files/misc/fundraising" into production

a4ccb5fd14-+-moving civimail_send to files/misc/fundraising

0183dc458b-+-Merge "added a couple scripts for grosley/aluminium" into production

02ee73aa3a-+-added a couple scripts for grosley/aluminium

c0c5f9e1a4-+-Merge "Use ifup --force and ifdown --force" into production

9d09215066-+-Use ifup --force and ifdown --force

9ac2ed7924-+-added (grosley|aluminium):/etc/php5/cli/php.ini per RT 1899

1c7953bf5a-+-Merge "Change lacp_rate default from slow to fast, setup for sq68" into production

8cac9ce69b-+-Change lacp_rate default from slow to fast, setup for sq68

5798c07398-+-Merge "adding mysql to storage3, minor cleanup around db1008 config" into production

564cedc96c-+-Merge "Support slow & fast LACP rates" into production

c7786dc2af-+-adding mysql to storage3, minor cleanup around db1008 config

c53331f562-+-Support slow & fast LACP rates

5ec25bbb37-+-Merge "Notify ifup on running ifdown, just in case." into production

b34c6dcbd6-+-Merge "Only execute /sbin/ifup on actual changes to /etc/interfaces" into production

2f5930b3c1-+-Notify ifup on running ifdown, just in case.

f9a6cce67f-+-Only execute /sbin/ifup on actual changes to /etc/interfaces

221b0c6f45-+-Merge "first in a series of checkins related to refactoring exim/mailman" into production

10ee2c8110-+-Try joining a puppet list with an inline_template

957f475757-+-Use bond-slaves instead of bond-master to avoid kernel bugs

f87cb65fed-+-first in a series of checkins related to refactoring exim/mailman

f1f88d86ec-+-Upping ldap svn version again

86393720bf-+-Upping ldap script svn versions.

29affead95-+-Add hack to ensure nscd and autofs are properly running after instance creation.

a84a0c6200-+-Fix template file to include.erb

7e59b4caa1-+-Pushing johnduhart's etherpad-lite -> etherpad_lite changes back in.

d7f504d57f-+-Ensure labs logs only go to #wikimedia-labs channel.

664fb9dce9-+-Ensure labs logs only go to #wikimedia-labs channel.

c2a2d59f68-+-Remove all puppet configuration for the old RoR mobile gw

01b66390dd-+-Merge branch 'testlabs/roanl10nupdate3' into production

c828ae30b2-+-Merge branch 'testlabs/roanl10nupdate3' into test

aa76ed5abe-+-Merge "added es1 and es2" into production

771813cfac-+-Install sudoers.appserver on fenari too

0d52f37601-+-added es1 and es2

7db02e6b7b-+-Merge "Install sudoers.appserver on fenari too" into test

c5aa8f9a5b-+-Fix reference to sync-common in scap

43b92be0b3-+-Merge "Fix reference to sync-common in scap" into test

5a62f0ca5e-+-correcting gobs of typos; eg : to =>

1e168e5c96-+-Don't convert eth0 multiple times.

98cd35f494-+-Fix missing ,

bc15f4ff1f-+-Break up bond interface creation and configuration

e73771bfca-+-Fix dependency cycle, subscription implies order of execution

95e90d695f-+-Only shutdown the old interface if it's going to be converted.

7dc08c99ef-+-When using interface bonding, eth0 doesn't exist.

a70541ee44-+-Bring down the old interface before conversion

3c8581b884-+-Merge "Work around an ifenslave script bug which fails if the bond interface is the first listed in the interfaces file" into production

440499192f-+-Work around an ifenslave script bug which fails if the bond interface is the first listed in the interfaces file

e279b62841-+-add nagios packages for monitoring host itself

7b65e94220-+-Set proper LACP options for bonding

477f6b9801-+-Two new generic definitions to set up aggregated interfaces ("bonding")

b192fdb0bb-+-Merge "Adding Etherpad-lite puppet files" into test

123ec65e78-+-Adding Etherpad-lite puppet files

523d5ddc2d-+-adding es[3-4] to puppet

22eaa89715-+-Screw restarting nscd, let's just invalidate things directly.

db4c29160b-+-I hate poorly written init scripts that make me put in dirty hacks like this.

5616dc201b-+-Fix cron spam again

77dfc39515-+-Merge "More cron spam fixes" into production

ede9cd9b18-+-More cron spam fixes

2996840ba9-+-More cron spam fixes

8685ef92d1-+-Initial review of new lists server configuration

d167577bab-+-Making test branch changes go to #wikimedia-labs too

5956ac2325-+-Making test branch changes go to #wikimedia-labs too

541451861a-+-import apache and memcache properly

ada3f156eb-+-Ensure nscd gets restarted after the nsswitch.conf is modified

80b46aa24e-+-excluding grosley from misc::jenkins

7b57a2e740-+-initial checkin of some swift classes - not yet used.

4f3acf9bba-+-backing out temporary changes made for fundraisingdb split

fb9baf7003-+-Add automount as the pattern, since the process isn't autofs

312ea4938c-+-Add automount as the pattern, since the process isn't autofs

d73908384c-+-Comment out misc::logmsgbot and put old-style UDP logging back

086c78170d-+-Comment out misc::logmsgbot and put old-style UDP logging back

af21590e9c-+-part of moving around certs for mailman

fcdd00a3ab-+-Make autofs restart, not refresh

6471a5a5b8-+-add SSL cert expiry monitoring to payments boxes

03d6e6bb00-+-Merge "add mailman proc monitoring and shorten spamd description" into production

e94e737ed1-+-add mailman proc monitoring and shorten spamd description

b4c59676e6-+-Merge "hrmf. only fundraising master ignores replicating otrs,faulkner" into production

4db1c5a4e5-+-hrmf. only fundraising master ignores replicating otrs,faulkner

cf8ca6b854-+-Merge "adding replication ignores to facilitate splitting fundraising db off of misc cluster" into production

55cc3e728e-+-adding replication ignores to facilitate splitting fundraising db off of misc cluster

8854ac11c9-+-Merge "mailman: move lighttpd stuff into its own class and require that in base" into production

95ac8e4886-+-mailman: move lighttpd stuff into its own class and require that in base

8ba534e834-+-Merge "mailman: add missing dir /etc/lighttpd/ssl, ensure directory" into production

e061073504-+-mailman: add missing dir /etc/lighttpd/ssl, ensure directory

937804fecb-+-Merge "adding packages for Nagios itself,plugins,images (re: RT #34)" into production

e817caafc6-+-Merge "Adding imagemagick so labsconsole can make thumbs" into production

2f582d008a-+-Merge "monitor https connect and SSL cert expiry of *.wikimedia.org on ssl[1-4]" into production

74a85f1e8f-+-Adding imagemagick so labsconsole can make thumbs

ad2835f658-+-Including memcached properly on virt1

c30a24cf8a-+-Adding imagemagick so labsconsole can make thumbs

be9cf5689e-+-adding packages for Nagios itself,plugins,images (re: RT #34)

a62d1ae6e5-+-monitor https connect and SSL cert expiry of *.wikimedia.org on ssl[1-4]

4414cf3e40-+-Fix service name

bc43ced417-+-reload nscd on changes to ldap.conf

180bc8563d-+-Reload autofs on changes to it's default file

ffb086a5d8-+-reload nscd on changes to ldap.conf

c51835861e-+-Reload autofs on changes to it's default file

5cd63f1f90-+-Make the default for floating IPs in a project 0

67ea73607c-+-Make the default for floating IPs in a project 0

0aeff4e25b-+-added a few packages used in fundraising

f3bb3cd7da-+-Fix reference to sync-common in scap

458fb71bff-+-Merge "spamd - removed dependency of service on package" into production

4dd7864800-+-spamd - removed dependency of service on package

bbce650946-+-fix for new version of php-wikidiff2

b4d9c094e3-+-Merge "monitor SSL cert expiry on svn.wm" into production

aa4d20b992-+-monitor SSL cert expiry on svn.wm

d77583a988-+-Merge "add missing spamd user / ensure /var/spamd dir exists" into production

e0884dec16-+-add missing spamd user / ensure /var/spamd dir exists

0d8982792a-+-Merge "adding ganglia class to aluminium/grosley in site.pp" into production

7f0ebbfb7e-+-adding ganglia class to aluminium/grosley in site.pp

bdc1e16d48-+-add monitoring for SSL cert expiry to mailman class

10f429e053-+-puppetizing php.ini used on civicrm/fundraising server

a86402820d-+-Up ldap tools version again

c7b5f6d0ec-+-Up ldap tools version again

45fb51bd72-+-Upping version of the ldap user-management tools

c1bedca7c3-+-Upping version of the ldap user-management tools

bbeced2d36-+-Deny memcached access from anywhere except localhost

531b0e2143-+-Including memcached properly on virt1

f367c872f8-+-Make sure that /var/log/logmsg is present, needed for logmsgbot

5d743f35e0-+-Merge "Make sure that /var/log/logmsg is present, needed for logmsgbot" into test

e8f128cecc-+-Adding robla to kaulen. Resolves RT #1838.

3027db8f9e-+-Adding robla to kaulen. Resolves RT #1838.

7c838b96b5-+-Removing LDAP config from kaulen

7f5a01328b-+-Removing LDAP config from kaulen

d0d23c0b72-+-Change authdns check to allow for more than just www.wikipedia.org

1ba274476b-+-Change authdns check to allow for more than just www.wikipedia.org

26ac099993-+-Merge branch 'production' of ssh://gerrit.wikimedia.org:29418/operations/puppet into production

04feb1327a-+-added system_role definition for NSCA so motd will be informative

531da060c3-+-spence nsca iptables rules are tested, enabling puppet to auto-load them

3ab830195f-+-Make sure that /var/log/logmsg is present, needed for logmsgbot

fa98ed3195-+-added new contacts.pp file to private for contacts in the udp2log templates pulled in udp2log configs

200726bfe0-+-Ensure managed home directories only exists for labs, also ensure manage-exports only exists on the nfs node

25c1588e58-+-Ensure managed home directories only exists for labs, also ensure manage-exports only exists on the nfs node

fa707a0811-+-Get rid of log spam from the home directory management

0a48a205b2-+-Get rid of log spam from the home directory management

857566c657-+-Merge branch 'testlabs/bindir' into production

bfcd653b80-+-Merge branch 'bindir' into test

8459a31439-+-Merge branch 'production' of ssh://gerrit.wikimedia.org:29418/operations/puppet into production

8c63b107fe-+-switching back to 5 minutes

79447fc45b-+-cleaning up old no-long-used mobile confs

a66a192d6c-+-added back the rest of the rules

c2ed483090-+-added service nsca

ed2e239540-+-adding back one rule

345ca99c81-+-removing all nagios iptables rules for spence

f3adcc5673-+-removing loopback fw rule to see if it's the culprit for the logged vague missing value error

bcd2b4e0f7-+-Merge branch 'bindir' into roanl10nupdate3

178cff49bc-+-Reorganization galore

551f5c247e-+-Move the l10nupdate scripts to the misc::l10nupdate package

1f4365c3c4-+-Puppetize the l10nupdate cron job

3377e76f89-+-Merge branch 'testlabs/logmsgbot2' into test

24ba68d869-+-Merge remote-tracking branch 'origin/production' into test

f86b1dac4a-+-additional config bits for grosley/aluminium

525d2c93f3-+-oops. removed incoherent iptables nonrule.

7ab9edf1bd-+-temporarily prevent puppet from loading firewall rules for spence so we can inspect the ruleset

d559f20d54-+-Put password scripts in the repo too

23a16e89ae-+-Puppetize logmsgbot

720dd24165-+-added nagios::nsca::daemon to spence

2ca3548cff-+-Move l10nupdate to l10nupdate-1 and add wrappers

5e1c1acc2b-+-Move sync-l10nupdate to sync-l10nupdate-1

4ed4d24ed1-+-Put password scripts in the repo too

8b5dd95111-+-add classes for Nagios NSCA (passive checks) - add iptables to deny access to 5667/TCP

7005e57788-+-Put all the bin files in misc::scripts and install it on fenari and hume

35595233ef-+-Install sudoers.appserver on fenari too

2ee240806a-+-Fix rsync failure, add -r or --delete won't work

096ae5773e-+-Fixing syntax error.

89cdb492dc-+-Ensuring autofs is running if it is included

c0c1d779fa-+-Revert last change, and remove include that was causing issues

c233c11681-+-Ensuring proxypass can be used

c51fee3d16-+-Fixing file permissions

b9c9732e7a-+-Fixing file permissions

9a855f721f-+-Removing home directory management from most nodes

63c2e0f9f7-+-Removing home directory management from most nodes

d385f4bc99-+-Add support for automount based on projects

b198f06b8b-+-Add support for automount based on projects

2644b5e368-+-Fix permissions like Ryan suggested on Id1805ee7

125fadff57-+-Update hooks based on whats currently on formey and properly manage them with puppet. Also fix bug 31826 (https urls in commit emails)

3ce5545496-+-changed monitoring interval to every 10 minutes for packet loss

993e34e5de-+-adding nagios checks to packet loss

72072271e5-+-fixed bugs in packet loss log tailer

bad3097bba-+-Merge "Adding packetloss logtailer for logs and updated puppet to run this as a cronjob on emery and locke" into production

7cfd59b0b1-+-Run LU cronjob as mwdeploy and drop -a

7190d867d7-+-Adding packetloss logtailer for logs and updated puppet to run this as a cronjob on emery and locke

85ae80589b-+-Fix permissions like Ryan suggested on Id1805ee7

a952bf7094-+-addin' some .pems for mailman lighttpd

6256d04180-+-Merge "Run LU cronjob as mwdeploy and drop -a" into test

6a59fd0f95-+-Run LU cronjob as mwdeploy and drop -a

000179f606-+-Add class for nfs server with optional static ports

0a668c3293-+-Add class for nfs server with optional static ports

4d654455ee-+-Added myself to kaulen for access to mw tarballs at download.mediawiki.org

9d103af860-+-Merge "adding working /etc/default/spamassassin to spamassassin class" into production

efc9d3072c-+-Merge "commenting broken nagios service check command, will fix" into production

4e56e7d245-+-commenting broken nagios service check command, will fix

7a7ae7e25a-+-adding working /etc/default/spamassassin to spamassassin class

37b8a89455-+-Merge "adds HTTPS monitoring to lighttpd for mailman" into production

2b596c32fa-+-adds HTTPS monitoring to lighttpd for mailman

62db80b0b2-+-Merge "Update hooks based on whats currently on formey and properly manage them with puppet. Also fix bug 31826 (https urls in commit emails)" into test

aa9f5c30f0-+-Merge "adding mailman-private-archives.conf to lighttpd for mailman, subscribe and require file" into production

cd25f11e43-+-adding mailman-private-archives.conf to lighttpd for mailman, subscribe and require file

856f283711-+-add Exim STMP port monitoring to exim::listserve, like exim::rt

e156b540dc-+-adds spamassassin proc monitoring

83fcc34793-+-Revert "adds monitoring for mailman and lighttpd into mailman class"

b9f88731e9-+-adds monitoring for mailman and lighttpd into mailman class

95ccac5af7-+-Merge "adding lighttpd config for mailing list server into mailman class" into production

27457274d0-+-Merge "adds process check for spamd to upcoming mail server" into production

48ca900607-+-adds process check for spamd to upcoming mail server

230658aedc-+-Merge changes I05293338,I80a60771 into test

cbee180c82-+-adding lighttpd config for mailing list server into mailman class

01d451da38-+-Merge "Dropping jobs configuration from puppet. This will be done by the integration/jenkins repo from now on" into test

41cc246bd6-+-Merge changes I0d7d7e27,Ic5ad123a into test

7d036e5f46-+-Merge branch 'production' into test

c10c6414a5-+-Setting lvs addresses for labs

2b27a7a159-+-Update hooks based on whats currently on formey and properly manage them with puppet. Also fix bug 31826 (https urls in commit emails)

c7785b8d71-+-Dropping jobs configuration from puppet. This will be done by the integration/jenkins repo from now on

2210dffa0d-+-adds php5-pgsql package to gallium

5b7d2a223e-+-Moving aft logger from locke to emery

f68135cb08-+-add postgresql to gallium

0f1a37b791-+-Merge "grosley and aluminium should get the same config, having separate node blocks makes them likely to drift" into production

507964a15b-+-grosley and aluminium should get the same config, having separate node blocks makes them likely to drift

74565c4566-+-ah, monitoring should already be included in the web-server class, not necessary to add again

98410bb534-+-changing name of services to spamassassin

c6460c8b5f-+-adding spamassassin class to sodium

ada4609e2f-+-Adding IPs statically for labs lvs

5404299999-+-Merge "Add my account to gallium, and also for jenkins sudo" into production

c13fbb15e0-+-Add my account to gallium, and also for jenkins sudo

c0512440a6-+-Add my account to gallium, and also for jenkins sudo

54925dc3eb-+-Pull proxypass directly from the private repo

0e36179ff8-+-Include ldap::client::wmf-cluster, fixes LDAP on mchenry

9189830e0b-+-Also pin package squid-common in misc::url-downloader

3261f9d31e-+-Also pin the php package to the default Ubuntu one

87220bb7e0-+-Explicitly install php5-cli, needed by the svn hooks

65193ea79d-+-Small dns::auth-server-ldap fixes

ef110e0b7f-+-Set dns auth ip addresses now the old variable is gone.

fb72d6ec0f-+-Parameterize class dns::auth-server

130440301f-+-Retab dns.pp

58f9f4e8a9-+-Set read-only file modes

fdada0b616-+-Restyle, add missing PDUs

4468ca2ff7-+-Restyle, ensure openssh-server package is always latest

d7fe911407-+-Retab

1d00042a1a-+-Remove (currently) useless sudo::sudoers

2f84f1dddc-+-Break out CIA into separate sub class, make generic class for removing Apache2's default site

d895dbb62a-+-s/packages/package/

dd4d3b23cc-+-Break out viewvc into a separate sub class

8a64c52a73-+-Break out svn dumps into a sub class

85c3e808a2-+-Install apache/php packages in a more generic way

0ebd3334f0-+-Remove svn::server::notify, now unnecessary as svn is no longer used on sockpuppet

98470cbfc1-+-Use proper method for mwdocs user creation

20714fdec2-+-adding amanda backups to sodium

7d54cde855-+-Cleanup/review of svn.pp

8c180926a1-+-Allow prefixes to site config aliases in apache_site

b705ab9de5-+-Move udpprofile to misc-servers.pp

9fa3c50d70-+-Make storage1 a standard install

bab9cdd57b-+-Disable access of accounts which should no longer have it

cac34c1abb-+-Ensure varnish runs before running the reload-VCL script

d8acee1eee-+-Added myself to kaulen for access to mw tarballs at download.mediawiki.org

f90248db24-+-Fix hostname for labs lvs system

f03963609c-+-Adding realm info

fc762a73fb-+-diederik gets account on bayes so he can work with dataset2 filesystem

45e702c1e6-+-added '-type f' to apache /tmp cleaner cron job so it'll stop cronspamming about failing to rm directories

eb633cd7a3-+-fixing a require

e23cd363d1-+-adding queuerunner type for exim::packages::heavy class

dac451cdcd-+-adding exim::listserve and mailman::base to sodium

1020396923-+-changing authorized_keys for logmover, rmv root@locke add file_mover@locke

3c8885053a-+-added authorized_key for root@locke-->logmover@storage3

f8e17108fd-+-added authorized keys to user logmover (used only on storage3) for root@hume and root@aluminium

26993ad50d-+-Adding hack for arrays in ldap in puppet

076fc2c37f-+-Set realm for text lvs config

6630527bf8-+-Decide text addresses by realm

b796d9729a-+-Change cluster_env to realm

3f673f65cc-+-Squash merge from production

9139c94fc5-+-Add hack for arrays in LDAP for coss disks in squid

6cbc754249-+-Add hack for arrays in LDAP for coss disks in squid

363ecc7777-+-allow hashar sudo rights for Jenkins

f9accdd363-+-allow hashar sudo rights for Jenkins

5291fe139d-+-Adding hashar to gallium users

761413d009-+-renamed db cluster "fr" to "fundraisingdb" switched db1008 to writable in prep for it to be come fundraising master db added db cluster "otrsdb" for otrs databases allocated at eqiad sigh. double sigh.

d5d14ae175-+-Merge "Damn varnish can't stand unused backends/directors" into production

1836cd1d95-+-Damn varnish can't stand unused backends/directors

f8ec9a2c25-+-sq47 died, decommissioning per rt1597

443a8c6951-+-Limit changes to new servers

fa8ec8d94c-+-change quote style

74a771cde2-+-Merge "Do not use new style for old servers" into production

a864ddce9b-+-Do not use new style for old servers

612f6db4d6-+-Merge "Setup test_wikipedia backend" into production

62ceb80e52-+-Setup test_wikipedia backend

5e1f914cd2-+-Merge "Fix bits.esams backends" into production

13e8f771d8-+-Fix bits.esams backends

e810dc7662-+-Merge "Require varnish3::common to have run before geoip VCL" into production

d993608eaa-+-Require varnish3::common to have run before geoip VCL

8d99debf28-+-Merge "Deploy bits on new esams cp servers" into production

63ddfc9584-+-Deploy bits on new esams cp servers

6d9402ccf7-+-Merge "Add new-style varnish3 configuration for bits, add nodes for cp3001/3002" into production

5e8b1323c8-+-Add new-style varnish3 configuration for bits, add nodes for cp3001/3002

e8a007b8fa-+-RT #1475: Give Niklas Laxström (Nikerabbit) shell and deploy access

bb03822344-+-Run varnishhtcpd not as root

c88405d076-+-fix vcl reload, generic instance monitoring

850e5ab361-+-Increase tmpfs size

8062b0344b-+-Fix remaining Varnish VCL syntax errors

5ec12f110f-+-Fix known VCL compile issues

b717213b71-+-Fix duplicate varnish3.vcl file definitions, and dependencies

1078f9931c-+-Fix varnish3.vcl file type

716d4ebe9e-+-Make role include function calls unconditional

e1e13ed3d6-+-Merge all existing Varnish3 VCL files into one new master file, with include files.

a0a075130c-+-Adding environment for git on virt1

9fd7328310-+-Adding crons to update labs puppet repos automatically.

9a5b07c06e-+-Adding crons to update labs puppet repos automatically.

bbf2761167-+-Squash merge from production

dc8c25cda3-+-Merge "adding in the file for apache sites-available" into production

f723710801-+-adding in the file for apache sites-available

c7056c2f59-+-Merge "once more with feeling, had to add individual entries for each directory in the path for srv/org/mediawiki" into production

6a5ded3aa9-+-once more with feeling, had to add individual entries for each directory in the path for srv/org/mediawiki

4f52f424f7-+-Merge "removed the trailing slash for directory setup," into production

510c8a46fe-+-removed the trailing slash for directory setup,

e6b345c996-+-Merge "adding in a test for creating the file path for jenkins landing page for CI server" into production

94420dfb65-+-adding in a test for creating the file path for jenkins landing page for CI server

b58a7b9591-+-Merge "Cleanup of varnish.pp, removed the old mobile class" into production

f1c54896cc-+-Cleanup of varnish.pp, removed the old mobile class

4e22fc4a43-+-Manage jenkins apache config how Ryan told me to

93f5b94b1b-+-Use parameters for varnish backends and directors

5b5bd20bec-+-Merge "fix vcl path" into production

2074ff8f3a-+-fix vcl path

7125dfe3d9-+-Oops, changed file into template

53b945e307-+-unique reload exec name

9493157127-+-Merge "service name maps to instance name" into production

89f1db4c7a-+-service name maps to instance name

6a9d20f783-+-Merge "Add LDAP access to virt1 from jenkins" into production

db168e9fba-+-Add LDAP access to virt1 from jenkins

6f4e200a1b-+-fixed chad's user permissions line, bad syntax

9ff650f660-+-Need root access to the stupid init script

0df9bcddca-+-Need root access to the stupid init script

bc7c8ff4a5-+-Merge "Templify varnish init script" into production

3821bcb1b9-+-Templify varnish init script

342f53d51f-+-move reload-vcl to common

4941d2000b-+-Merge changes I7e2fc025,I8e995e25 into production

3977945ac5-+-Fix sudo syntax. 3 ops reviewed this and nobody caught it ;-)

fa89b00ab6-+-Fix sudo syntax. 3 ops reviewed this and nobody caught it ;-)

c857b8c8fe-+-one reload script for all instances

d0e3ead040-+-Remove test.pp, since it was an example

97ca5730aa-+-Test

8fd56ced6e-+-templify reload-vcl

eb793b04fb-+-Sudo conf for gallium so I can restart jenkins

8578b062b2-+-Merge remote-tracking branch 'origin/production' into varnish

5593cb46ab-+-Typo, s/vlc/vcl/

d7c12a273b-+-Initial support for multiple varnish instances with defines

edf82aa750-+-Retab

4194fee879-+-fix domain name for private dns in pmtpa

ad0be7eb5c-+-Sudo conf for gallium so I can restart jenkins

d739d73957-+-Merge "Adding hashar to gallium users" into test

6fc35b8152-+-Manage jenkins apache config how Ryan told me to

b6f37d5be2-+-Squash merge from production.

df5d1dbc43-+-Merge "Restrict ssh access to to project members in instances." into production

23ab320a62-+-Restrict ssh access to to project members in instances.

f4ac35bbcb-+-Merge "Adding ldap-backend package for pdns." into production

50a26bfdd0-+-Adding ldap-backend package for pdns.

daf0f1dba3-+-Merge "adding 'svn-group' command to sudo commands for sumanah on formey" into production

0cbf48ac69-+-adding 'svn-group' command to sudo commands for sumanah on formey

edb08998b6-+-Using correct package name

caeb65e88b-+-Add pdns package, and add requirements for it

51ce1a3239-+-Change private dns name

cee0f8c4c8-+-Removing unneeded dependencies

6b38b18e92-+-Adding in missing variables

0d6e7e5073-+-Break out ldap stuff into separate class, add server to virt1

ada46ad947-+-Changes to use dns with an ldap backend

d6571bb1d4-+-Squash merge from production to test

6097da53d5-+-Remove autofs from instances.

e65d2150de-+-Merge "Actually add lcarr to the roots list" into production

d2227f1ca3-+-Actually add lcarr to the roots list

95087048c7-+-Merge "Add an account for Leslie Carr" into production

81a08a6c52-+-Add an account for Leslie Carr

f694e0d4a2-+-Split up the package list into multiple lines

0f8b2af145-+-Merge "adding two new bits boxes" into production

882cd1a325-+-adding two new bits boxes

79b3c6b7f6-+-replacing sumanah's SSH key by her request

e41959fe95-+-Added libvips-tools for command line vips

2194eb3c7e-+-Install libvips15 on the (lucid) image scalers (resolves RT #1696)

1d169c9c3d-+-turning off jobrunners on the rest of the 4 gig apaches (why didn't I do this earlier!??!)

2b1606740b-+-Adding hashar to gallium users

f45712f07c-+-install star cert on spence

c03ed370b0-+-Merge "updating ssh key for cmjohnson - RT #1436" into production

015fbfa236-+-putting the ganglios cron back in.  the package didn't install it.

15925fdbc9-+-updating ssh key for cmjohnson - RT #1436

07bdfc76ff-+-removing puppet's cronjob in anticipation of the package installing its own cronjob instead.

b4c34ff1e5-+-puppetization for mw60-74 (and this time I mean it)

36d80bf5d1-+-Merge remote-tracking branch 'origin/iptables' into production

3537e70570-+-Add empty classes to satisfy geppetto

c613f60590-+-Break up ridiculously long lines

795a05edf2-+-Remove {hostname} from all iptables definition titles

00d14294cc-+-Resolve conflict

bb2ae71a88-+-Merge changes I29f1d07c,I06fc6afb,I21116ea1 into production

b43fb0e678-+-Merge "Small improvements and style fixes" into production

2f2d9633b0-+-Merge "Copy paste error?" into production

4df48cf0ef-+-Review the rest of misc-servers.pp

334b9b6796-+-Clean up part of misc-servers.pp

762beb3467-+-Remove irssi from fenari.

084b466f1a-+-Small improvements and style fixes

22f305e47f-+-Add FIXME to move this to ganglia.pp

aa8112a7cd-+-Fix duplicate definitions

9533cc2fb7-+-Actually use the misc::contint::test iptables classes

d5d76d6cb9-+-Copy paste error?

1c97977632-+-Fix and restyle

c1dc9f942b-+-added 'restricted' accounts for jamesofur (RT #1546), pgehres (RT #1566)

01b87461ad-+-Fix whitespace

65db68b18d-+-First stab at implementing realms

6d04a48f1d-+-Change class of new-payments

e3befa76c0-+-Add new LVS service new-payments, with BGP Add newly allocated BGP LVS service IPs for mobile-lb.pmtpa, payments-lb.pmtpa and payments-lb.eqiad

861fadca2d-+-Deinstall mlocate, runs updatedb on our storage servers...

6a3b30bae8-+-Retab, restyle

d34a680b71-+-Break up lines

3a67e067b4-+-Set read-only permissions on Puppet managed files

3d7533dd47-+-Retab

cdf91cca76-+-Tune sysctl settings for many HTTP connections

a65de996cf-+-adding another accept for 208.80.154.128/26 and removing file with former rules

af8465abeb-+-replacing "manual" iptables rules with puppet classes

aaedef24d8-+-adding "http-alt" as 8080/tcp as per IANA assigned ports

9a719e5138-+-The ganglios package doesn't create the cached dir with the correct permissions.  Fix that.

8d8661d2dc-+-Adding cronjob to enable ganglios

6739c4f89c-+-missed closing brace

eb82dfabe4-+-remove "Duplicate parameter 'notify'.."

0da9d63362-+-ensure permissions on all individual service files in puppet_checks.d are also correct

7ff8e3aba1-+-Give account cmjohnson a UID which wasn't in use yet

206c159c33-+-Package lldpd doesn't exist in Hardy

0a919bd998-+-Rename new-mobile to mobile

673b84ae42-+-Remove old LVS service IPs under HTTPS service as well

a26520be42-+-Move lvs_realserver_ips out of node definitions into text-squid and upload-squid

ca56615143-+-Remove old LVS service IPs from realservers for text.esams, upload.esams, bits.pmtpa and upload.pmtpa

0e286fda11-+-Alphabetic order is HARD

61311511f5-+-Remove old bits LVS service IP from the service, and remove very old esams text IP

85acee73d7-+-Remove old bits service IP

7d241bc193-+-Announce the internal service IPs using BGP on lvs1/2 as well, not statically bound to the Interface

2ad4fb8f3c-+-Cleanup of old LVS services

4244f981e2-+-Various etherpad fixes

e10f8f83e6-+-Fix typo in certificate

5e792b6e17-+-Removing gmaxwell, as it's causing problems for now

b6bab87b95-+-Adding gid in to fix error

dc3606b3a7-+-Adding ipv6and4 labs to ssl3001

70006f660c-+-Adding mediawikisecurelb using text's IP address

7bed800eb3-+-putting new mw* boxes (28-58) under puppet control

5486a1776c-+-move the iptables rules into a file, to avoid running into puppet bug with tabs in command defs

d8bff5ec83-+-Merge "adding files and config to run Jenkins behind Apache" into production

3328037e2c-+-adding files and config to run Jenkins behind Apache

1655f8e7fd-+-removed db1048 from the limesurvey bastard host list

745900ecc8-+-Rename Amsterdam SSL hosts using new naming scheme, where 3xxx == esams

3c7e9e4c56-+-added fundraising-analytics virtualhost to the fundraising apache config

ae67c4b846-+-Removing ssl proxy config from yvon and gurvin

881861251a-+-Merge "Putting a cronjob on es1004 to take daily snapshots of its mysql db (replica of ms3) The script itself is not yet in puppet; it needs a few changes.  I'll put it in after one more day testing. Identifying es1001 as a master in puppet's eyes (and therefore nagios's eyes)" into production

c9e2a8c018-+-Putting a cronjob on es1004 to take daily snapshots of its mysql db (replica of ms3) The script itself is not yet in puppet; it needs a few changes.  I'll put it in after one more day testing. Identifying es1001 as a master in puppet's eyes (and therefore nagios's eyes)

692e36e996-+-disabling memcache on all apaches with less than 8 GB ram in accordance with RT 1550

85eebbea75-+-Merge "Add ssl nodes. Move system_role stuff to class." into production

dc2ee73bf6-+-Add ssl nodes. Move system_role stuff to class.

f539de5dc8-+-removing jobrunner class from all apaches that have external stores on them

6df64036f8-+-Merge "Removing python-rtkit and using API manually." into production

8f1379e179-+-Removing python-rtkit and using API manually.

18db4b5d87-+-Merge "adding some amazing .ini files. now with no # comments!" into production

a2f712af76-+-adding some amazing .ini files. now with no # comments!

5987289817-+-Fix gerrit pass in hookconfig

fb51b3f7b7-+-Adding the hookhelper library

3f534e05bd-+-Adding in support for updating rt.

ab51439d48-+-same edit, this time with the right hostname

b273de9286-+-added more informative comment on some authorized keys

8c69c92739-+-grrr, stupid me put the key under the wrong user. corrected

bf2a5bc6f2-+-added root@loudon public key to logmover@storage3's authorized_keys file

fd15922238-+-Fix range.

0463a6dc86-+-Several racks in pmtpa/sdtpa support LLDP now, so let's run lldpd everywhere

a1497b801e-+-aaaaaand, typo

c0ee412048-+-less complex,slightly less precise regex for selecting mw servers

27905fcb84-+-Notify ircecho when its config changes and add mobile channel and a mobile file.

db6438f856-+-Log actions of different branches to different files

f4b859089c-+-Various gerrit modifications

584f4ebb83-+-Merging chad's jenkins changes from test branch

67ec2fcadf-+-Actually put them in puppet, Change-Id: I05d3ead314f2f911143208b15820ba4ddf1e50b9

c2ec3156d0-+-Fixing syntax error

1486efefae-+-Squashed commit of the following:

281af129b2-+-Move the cluster_env setting into the global scope

97b986f6f7-+-Another followup to I88b820de; I despise you puppet.

06c2a3060b-+-Followup to I88b820de; fix undef check

01b39964fe-+-Check for undef cluster_env

86e437230d-+-Moving package addition outside the define to avoid duplicate inclusions.

47b8347cbb-+-Ensuring tagged port is set to manual

5d86cd46e6-+-Move ethernet tagging to common, and remove vlan package, as it is already included by the tagging.

14bee2e501-+-Follow up to I52704f63

a6225c100a-+-Fixing conflict

5deacc2794-+-Merge "Add public ip bound to eth0" into production

19358cc570-+-Add public ip bound to eth0

044bc67f54-+-Merge "adding mw1-27 boxes in tampa as apaches/memecaches/jobrunners" into production

eb16362698-+-adding mw1-27 boxes in tampa as apaches/memecaches/jobrunners

5b7a8244db-+-Merge changes I433281bb,I6d5bb51d into production

179bd45beb-+-adding nagios monitoring for jenkins service - fix command_name and indentation

64e8f29e12-+-invalid parameter "has_restart" should be "hasrestart"

e3fdeb7723-+-adding a service def for jenkins - attempt to ensure its always running in response to RT#1548

c22e143942-+-Add FIXME to remove third party repository for jenkins

e13569b949-+-Setup interface tagging for compute nodes, add some comments for discussion

778f71d1c8-+-Use generic advanced-routing sysctl instead of just enabling IP forwarding

1726fda1da-+-Move pparepo out of ppa.pp into generic-definitions.pp, add some warnings

8328c02d2d-+-cli php.ini based on our apache version disable url_fopen

d044746007-+-fix php conf perms

282d5b4541-+-Merge "Revert "Use 10.4.0.1 instead of 10.4.16.3"" into production

760d3e01cb-+-Revert "Use 10.4.0.1 instead of 10.4.16.3"

fc050d1176-+-ganglia has been unable to access the mysql password.  hopefully this fixes that.

56f48b3806-+-Use 10.4.0.1 instead of 10.4.16.3

e8ff45cd96-+-adding memcached::config to the memcached class in puppet and removing dupes in site.pp

209726c25b-+-Add floating range to LDAP rules

c46c5454f6-+-Remove erroneous }

176047921f-+-Explicit configuration of LVS on standard app servers in Puppet should not hurt on Hardy either, right?

5a087717e4-+-Correct comments on LVS interface setup

84b5cff9ba-+-Rename $network_pass to the more descriptive $snmp_ro_community

2167b98311-+-Add interface monitoring for mr1-pmtpa and mr1-eqiad

674e78eecf-+-Changing url for labs console in mail script

e2c7ee94e4-+-Upping the version of the user-management tools

4992fa524f-+-Ensure nova config gets loaded on labs puppet master

2aec7f6554-+-Separating out cluster_env from puppetmaster stuff

c336156721-+-adding php5-intl to apache packages for lucid to resolve rt 652 when upgrades to lucid are done

765ecb9c67-+-Fix name of git-svn package

d5f9b34518-+-Fixes for labs:

fb1506967a-+-Removing bad dependency

f02c31c266-+-Don't add scriptuser config if environment is labs

79c6529a32-+-Add node for arsenic/niobium

ba61c08a31-+-updated erik z public key

7a0e538698-+-Merge "adding sumanah's account to formey and adding sudo for ldap commands (RT #840)" into production

a476ab6286-+-Fixing permissions of position-of-the-moon

95facf0384-+-Adding position of the moon script to puppet, and adding to puppet manifest

5bb38c4008-+-adding sumanah's account to formey and adding sudo for ldap commands (RT #840)

8f8ff3c850-+-manage apc ini via puppet, may need to tune while running 1.17+18 during rollout

4a710a8d9d-+-Attempt to fix Puppet on amslvs*

cd27ac0490-+-Correct service IP of pmtpa's search_pool3

b58b617873-+-Set appropriate depool thresholds for the search LVS services

8526dce7bc-+-Putting demon's change back in

310ebf6a9f-+-Adding a longer session timeout to gerrit.

9211d13647-+-Fixing the file location

acc66b60cb-+-Adding a key to the gerrit user

274db0cb35-+-Adding the ircbot to formey

170e8ce905-+-ircecho changes

1a824b03a2-+-Fixing syntax of Chris's account again

f0fe4b1ada-+-Fixing syntax error in chris's user account

18c2622186-+-Merge "retab ftw!" into production

66739d6199-+-retab ftw!

2b6a46cb9b-+-Merge "Added in the three new pdu's in row D to facilities.pp" into production

ad3f033aa9-+-Added in the three new pdu's in row D to facilities.pp

5f8289cbf9-+-Merge "retabbed sudo.pp to test git commits" into production

59e818e28b-+-Added in Chris Johnson, our Tampa datacenter contractor, to restricted logins to fenari for bastion host use when working with us on items.

2ee505c5b6-+-retabbed sudo.pp to test git commits

0c28eefa02-+-upgrade varnish3 to version with latest udplog format patch

2e238bd864-+-Changing system role title to class

633a19ea8c-+-Moving system role from formey to svn

90e26b6667-+-Move system role to gerrit jetty

6201fbd154-+-Last import from SVN

44303c5d95-+-Add a FIXME comment

a37414c73a-+-import from svn

a3e5fabca8-+-Another sync from the svn repo

f8724e6066-+-Update from svn repo

de05922893-+-Initial commit of public puppet repo.
